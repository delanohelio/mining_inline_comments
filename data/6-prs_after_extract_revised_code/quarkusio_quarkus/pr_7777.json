{"pr_number": 7777, "pr_title": "fix: container-image integration with knative", "pr_createdAt": "2020-03-11T14:36:51Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7777", "timeline": [{"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891", "url": "https://github.com/quarkusio/quarkus/commit/0a877f88f0a106d8bcc08c5dfa945b5bda673891", "message": "fix: container-image integration with knative", "committedDate": "2020-03-12T07:24:40Z", "type": "commit"}, {"oid": "0a877f88f0a106d8bcc08c5dfa945b5bda673891", "url": "https://github.com/quarkusio/quarkus/commit/0a877f88f0a106d8bcc08c5dfa945b5bda673891", "message": "fix: container-image integration with knative", "committedDate": "2020-03-12T07:24:40Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTU3NzE0Mw==", "url": "https://github.com/quarkusio/quarkus/pull/7777#discussion_r391577143", "bodyText": "Nice improvement :)", "author": "geoand", "createdAt": "2020-03-12T12:09:06Z", "path": "extensions/kubernetes/vanilla/deployment/src/main/java/io/quarkus/kubernetes/deployment/KubernetesProcessor.java", "diffHunk": "@@ -374,14 +374,13 @@ private void applyBuildItems(Session session,\n         String openshiftName = openshiftConfig.name.orElse(name);\n         String knativeName = knativeConfig.name.orElse(name);\n \n-        containerImageBuildItem.ifPresent(\n-                c -> session.resources().decorate(KUBERNETES, new ApplyContainerImageDecorator(kubernetesName, c.getImage())));\n-        containerImageBuildItem\n-                .ifPresent(c -> session.resources().decorate(OPENSHIFT,\n-                        new ApplyContainerImageDecorator(openshiftName, c.getImage())));\n-        containerImageBuildItem\n-                .ifPresent(c -> session.resources().decorate(KNATIVE,\n-                        new ApplyContainerImageDecorator(knativeName, c.getImage())));\n+        session.resources().decorate(KNATIVE, new AddMissingContainerNameDecorator(knativeName, knativeName));\n+\n+        containerImageBuildItem.ifPresent(c -> {\n+            session.resources().decorate(OPENSHIFT, new ApplyContainerImageDecorator(openshiftName, c.getImage()));\n+            session.resources().decorate(KUBERNETES, new ApplyContainerImageDecorator(kubernetesName, c.getImage()));\n+            session.resources().decorate(KNATIVE, new ApplyContainerImageDecorator(knativeName, c.getImage()));\n+        });", "originalCommit": "0a877f88f0a106d8bcc08c5dfa945b5bda673891", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}