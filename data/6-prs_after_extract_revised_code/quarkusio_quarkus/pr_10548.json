{"pr_number": 10548, "pr_title": "Exit in dev mode if port is in use", "pr_createdAt": "2020-07-08T04:40:18Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10548", "timeline": [{"oid": "560e7ec2ef8ffd55ab3e5b8f35a461e72c2cb8ec", "url": "https://github.com/quarkusio/quarkus/commit/560e7ec2ef8ffd55ab3e5b8f35a461e72c2cb8ec", "message": "Exit in dev mode if port is in use\n\nIf it is not possible to start a HTTP endpoint to listen\nfor changes we just immediatly exit with a non-zero exit\ncode.\n\nFixes #8416", "committedDate": "2020-07-08T04:40:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM2NDIwNw==", "url": "https://github.com/quarkusio/quarkus/pull/10548#discussion_r451364207", "bodyText": "Maybe move the two lines above to the if too?\nBTW, this change seems unrelated to the issue at hand. Just checking it was meant for this patch?", "author": "gsmet", "createdAt": "2020-07-08T08:14:46Z", "path": "extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/VertxHttpRecorder.java", "diffHunk": "@@ -154,7 +154,13 @@ public static void startServerAfterFailedStart() {\n         }\n         VertxConfiguration vertxConfiguration = new VertxConfiguration();\n         ConfigInstantiator.handleObject(vertxConfiguration);", "originalCommit": "560e7ec2ef8ffd55ab3e5b8f35a461e72c2cb8ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM4OTQ2Mg==", "url": "https://github.com/quarkusio/quarkus/pull/10548#discussion_r451389462", "bodyText": "This stops an extra vert.x hanging around, before I resorted to the System.exit() blunt instrument I was looking for a normal JVM shutdown, but this extra vert.x was stopping it.", "author": "stuartwdouglas", "createdAt": "2020-07-08T08:55:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTM2NDIwNw=="}], "type": "inlineReview", "revised_code": {"commit": "6fe0f2a6879f0069523c564525785491f3300e37", "chunk": "diff --git a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/VertxHttpRecorder.java b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/VertxHttpRecorder.java\nindex f9dd6b9d9c..88402c3cd9 100644\n--- a/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/VertxHttpRecorder.java\n+++ b/extensions/vertx-http/runtime/src/main/java/io/quarkus/vertx/http/runtime/VertxHttpRecorder.java\n\n@@ -152,11 +152,11 @@ public class VertxHttpRecorder {\n             // the server start to fail\n             hotReplacementHandler = prevHotReplacementHandler;\n         }\n-        VertxConfiguration vertxConfiguration = new VertxConfiguration();\n-        ConfigInstantiator.handleObject(vertxConfiguration);\n         Supplier<Vertx> supplier = VertxCoreRecorder.getVertx();\n         Vertx vertx;\n         if (supplier == null) {\n+            VertxConfiguration vertxConfiguration = new VertxConfiguration();\n+            ConfigInstantiator.handleObject(vertxConfiguration);\n             vertx = VertxCoreRecorder.initialize(vertxConfiguration, null);\n         } else {\n             vertx = supplier.get();\n"}}, {"oid": "6fe0f2a6879f0069523c564525785491f3300e37", "url": "https://github.com/quarkusio/quarkus/commit/6fe0f2a6879f0069523c564525785491f3300e37", "message": "Exit in dev mode if port is in use\n\nIf it is not possible to start a HTTP endpoint to listen\nfor changes we just immediatly exit with a non-zero exit\ncode.\n\nFixes #8416", "committedDate": "2020-07-08T08:58:18Z", "type": "commit"}, {"oid": "6fe0f2a6879f0069523c564525785491f3300e37", "url": "https://github.com/quarkusio/quarkus/commit/6fe0f2a6879f0069523c564525785491f3300e37", "message": "Exit in dev mode if port is in use\n\nIf it is not possible to start a HTTP endpoint to listen\nfor changes we just immediatly exit with a non-zero exit\ncode.\n\nFixes #8416", "committedDate": "2020-07-08T08:58:18Z", "type": "forcePushed"}]}