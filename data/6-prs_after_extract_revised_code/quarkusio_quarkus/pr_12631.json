{"pr_number": 12631, "pr_title": "Reconcile \"old\" and \"new\" S2I config properties", "pr_createdAt": "2020-10-09T13:30:15Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12631", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ4OTA0NA==", "url": "https://github.com/quarkusio/quarkus/pull/12631#discussion_r502489044", "bodyText": "I don't understand why we want to add to docker related stuff to S2iConfig.\nI assume that this is because the container-image-s2i variant has them (which IMHO is wrong and I am to blame).\nI would expect that this PullRequest would remove them from container-image-s2i instead of introducing them to container-image-openshift if that makes sense.\nIn the end of the day both S2iConfig should be the same but with different defaults (as we already chatted about).", "author": "iocanel", "createdAt": "2020-10-09T14:57:26Z", "path": "extensions/container-image/container-image-openshift/deployment/src/main/java/io/quarkus/container/image/openshift/deployment/S2iConfig.java", "diffHunk": "@@ -15,6 +15,15 @@\n     public static final String DEFAULT_BASE_NATIVE_IMAGE = \"quay.io/quarkus/ubi-quarkus-native-binary-s2i:1.0\";\n     public static final String DEFAULT_NATIVE_TARGET_FILENAME = \"application\";\n \n+    public static final String DEFAULT_JVM_DOCKERFILE = \"src/main/docker/Dockerfile.jvm\";", "originalCommit": "4a1abd80db91ca1df9cd672ea7f2d5a133f7376b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ5MDEwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/12631#discussion_r502490105", "bodyText": "Yea I'm adding it to the new S2I config, because the old S2I config has it (and is presumably used).", "author": "Ladicek", "createdAt": "2020-10-09T14:59:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ4OTA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ5MTQ4OA==", "url": "https://github.com/quarkusio/quarkus/pull/12631#discussion_r502491488", "bodyText": "Also the new OpenShift container image config has these properties.\nMy assumption is that the old S2I (quarkus-container-image-s2i) is going away (soon?) and the new S2I config (quarkus.s2i.* config properties as provided by quarkus-container-image-openshift) is only there for migration. Ideally everyone would move to the OpenShift container image config (quarkus.openshift.* config properties as provided by quarkus-container-image-openshift).\nRight?", "author": "Ladicek", "createdAt": "2020-10-09T15:01:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ4OTA0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjUwMDkyOQ==", "url": "https://github.com/quarkusio/quarkus/pull/12631#discussion_r502500929", "bodyText": "OK, just read the Zulip message -- clearly some config properties were added to the \"old\" S2I config recently by mistake. Indeed those should be removed, and I've just done that.", "author": "Ladicek", "createdAt": "2020-10-09T15:15:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjQ4OTA0NA=="}], "type": "inlineReview", "revised_code": {"commit": "8e5a348f83246ce182507414810374c6f5cddd4d", "chunk": "diff --git a/extensions/container-image/container-image-openshift/deployment/src/main/java/io/quarkus/container/image/openshift/deployment/S2iConfig.java b/extensions/container-image/container-image-openshift/deployment/src/main/java/io/quarkus/container/image/openshift/deployment/S2iConfig.java\nindex 93dfd12691..2f961800e8 100644\n--- a/extensions/container-image/container-image-openshift/deployment/src/main/java/io/quarkus/container/image/openshift/deployment/S2iConfig.java\n+++ b/extensions/container-image/container-image-openshift/deployment/src/main/java/io/quarkus/container/image/openshift/deployment/S2iConfig.java\n\n@@ -15,15 +15,6 @@ public class S2iConfig {\n     public static final String DEFAULT_BASE_NATIVE_IMAGE = \"quay.io/quarkus/ubi-quarkus-native-binary-s2i:1.0\";\n     public static final String DEFAULT_NATIVE_TARGET_FILENAME = \"application\";\n \n-    public static final String DEFAULT_JVM_DOCKERFILE = \"src/main/docker/Dockerfile.jvm\";\n-    public static final String DEFAULT_NATIVE_DOCKERFILE = \"src/main/docker/Dockerfile.native\";\n-\n-    /**\n-     * The build config strategy to use.\n-     */\n-    @ConfigItem(defaultValue = \"binary\")\n-    public BuildStrategy buildStrategy;\n-\n     /**\n      * The base image to be used when a container image is being produced for the jar build\n      */\n"}}, {"oid": "8e5a348f83246ce182507414810374c6f5cddd4d", "url": "https://github.com/quarkusio/quarkus/commit/8e5a348f83246ce182507414810374c6f5cddd4d", "message": "reconcile \"old\" and \"new\" S2I config properties\n\nThis commit removes some pieces from the \"old\" S2I config that\nwere added recently (by mistake). It also reverts the default\nvalue of `s2i.jar-directory` in the \"old\" S2I config, because\nthe `container-image-s2i` extension still builds the image\nso that application files are in `/deployments`.\n\nIn addition, this commit also fixes the way how `S2IConfig`\n(the \"new\" S2I config) and `OpenshiftConfig` are merged.", "committedDate": "2020-10-09T15:12:40Z", "type": "commit"}, {"oid": "8e5a348f83246ce182507414810374c6f5cddd4d", "url": "https://github.com/quarkusio/quarkus/commit/8e5a348f83246ce182507414810374c6f5cddd4d", "message": "reconcile \"old\" and \"new\" S2I config properties\n\nThis commit removes some pieces from the \"old\" S2I config that\nwere added recently (by mistake). It also reverts the default\nvalue of `s2i.jar-directory` in the \"old\" S2I config, because\nthe `container-image-s2i` extension still builds the image\nso that application files are in `/deployments`.\n\nIn addition, this commit also fixes the way how `S2IConfig`\n(the \"new\" S2I config) and `OpenshiftConfig` are merged.", "committedDate": "2020-10-09T15:12:40Z", "type": "forcePushed"}]}