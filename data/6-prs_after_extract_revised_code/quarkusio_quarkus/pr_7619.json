{"pr_number": 7619, "pr_title": "Set a proper temp directory for Amazon Lambda", "pr_createdAt": "2020-03-06T00:36:56Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/7619", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODk4MDI0Ng==", "url": "https://github.com/quarkusio/quarkus/pull/7619#discussion_r388980246", "bodyText": "I'm not sure this will work in Windows environments", "author": "gastaldi", "createdAt": "2020-03-06T15:47:58Z", "path": "extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java", "diffHunk": "@@ -195,6 +195,12 @@ void ipv4Only(BuildProducer<SystemPropertyBuildItem> systemProperty) {\n         systemProperty.produce(new SystemPropertyBuildItem(\"java.net.preferIPv4Stack\", \"true\"));\n     }\n \n+    @BuildStep\n+    void tmpdirs(BuildProducer<SystemPropertyBuildItem> systemProperty) {\n+        systemProperty.produce(new SystemPropertyBuildItem(\"java.io.tmpdir\", \"/tmp\"));", "originalCommit": "315a27ef50ae0adf9a5e5a834b2f7fc1403084ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODk5NDYyOA==", "url": "https://github.com/quarkusio/quarkus/pull/7619#discussion_r388994628", "bodyText": "Lambda doesn't run on Windows.  But, good point, I should not do this if its test mode.", "author": "patriot1burke", "createdAt": "2020-03-06T16:11:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODk4MDI0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODk5NjczMg==", "url": "https://github.com/quarkusio/quarkus/pull/7619#discussion_r388996732", "bodyText": "Ok, I just set the properties if we're not in dev or test mode.", "author": "patriot1burke", "createdAt": "2020-03-06T16:14:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODk4MDI0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "711ca4d8e8ca29746eb7785d6a0598a40aad3e4c", "chunk": "diff --git a/extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java b/extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java\nindex 2916e9b8c1..051c124434 100644\n--- a/extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java\n+++ b/extensions/amazon-lambda/deployment/src/main/java/io/quarkus/amazon/lambda/deployment/AmazonLambdaProcessor.java\n\n@@ -196,7 +196,12 @@ public final class AmazonLambdaProcessor {\n     }\n \n     @BuildStep\n-    void tmpdirs(BuildProducer<SystemPropertyBuildItem> systemProperty) {\n+    void tmpdirs(BuildProducer<SystemPropertyBuildItem> systemProperty,\n+                 LaunchModeBuildItem launchModeBuildItem) {\n+        LaunchMode mode = launchModeBuildItem.getLaunchMode();\n+        if (mode.isDevOrTest()) {\n+            return; // just in case we're on windows.\n+        }\n         systemProperty.produce(new SystemPropertyBuildItem(\"java.io.tmpdir\", \"/tmp\"));\n         systemProperty.produce(new SystemPropertyBuildItem(\"vertx.cacheDirBase\", \"/tmp/vertx\"));\n     }\n"}}, {"oid": "711ca4d8e8ca29746eb7785d6a0598a40aad3e4c", "url": "https://github.com/quarkusio/quarkus/commit/711ca4d8e8ca29746eb7785d6a0598a40aad3e4c", "message": "tmpdir system properties\n\nturn off echo\n\necho delete\n\nwindows", "committedDate": "2020-03-06T16:14:00Z", "type": "forcePushed"}, {"oid": "57ce2b5f5177a8524b18814c7a6c2ea3e8cd3ea9", "url": "https://github.com/quarkusio/quarkus/commit/57ce2b5f5177a8524b18814c7a6c2ea3e8cd3ea9", "message": "tmpdir system properties\n\nturn off echo\n\necho delete\n\nwindows", "committedDate": "2020-03-06T17:18:05Z", "type": "forcePushed"}, {"oid": "c5816f3eae800261ab4cfc5190b81b47108ed571", "url": "https://github.com/quarkusio/quarkus/commit/c5816f3eae800261ab4cfc5190b81b47108ed571", "message": "tmpdir system properties\n\nturn off echo\n\necho delete\n\nwindows\n\nformat", "committedDate": "2020-03-06T17:24:52Z", "type": "forcePushed"}, {"oid": "e375f37e6dec7238117b44b7b49045b6af85d365", "url": "https://github.com/quarkusio/quarkus/commit/e375f37e6dec7238117b44b7b49045b6af85d365", "message": "tmpdir system properties\n\nturn off echo\n\necho delete\n\nwindows\n\nformat", "committedDate": "2020-03-07T13:44:03Z", "type": "forcePushed"}, {"oid": "87fd0946e9e8eeb6574b5fe1efe21e7d8e53fb8f", "url": "https://github.com/quarkusio/quarkus/commit/87fd0946e9e8eeb6574b5fe1efe21e7d8e53fb8f", "message": "tmpdir system properties\n\nturn off echo\n\necho delete\n\nwindows\n\nformat", "committedDate": "2020-03-07T14:13:10Z", "type": "commit"}, {"oid": "87fd0946e9e8eeb6574b5fe1efe21e7d8e53fb8f", "url": "https://github.com/quarkusio/quarkus/commit/87fd0946e9e8eeb6574b5fe1efe21e7d8e53fb8f", "message": "tmpdir system properties\n\nturn off echo\n\necho delete\n\nwindows\n\nformat", "committedDate": "2020-03-07T14:13:10Z", "type": "forcePushed"}]}