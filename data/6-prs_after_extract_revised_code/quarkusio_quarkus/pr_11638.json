{"pr_number": 11638, "pr_title": "Added option to save the generated OpenAPI schema document on build.", "pr_createdAt": "2020-08-26T10:15:33Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/11638", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIxNjM0NA==", "url": "https://github.com/quarkusio/quarkus/pull/11638#discussion_r477216344", "bodyText": "I would prefer if we used Directory rather than Dir.", "author": "gsmet", "createdAt": "2020-08-26T11:03:47Z", "path": "extensions/smallrye-openapi-common/deployment/src/main/java/io/quarkus/smallrye/openapi/common/deployment/SmallRyeOpenApiConfig.java", "diffHunk": "@@ -10,4 +13,11 @@\n      */\n     @ConfigItem(defaultValue = \"/openapi\")\n     public String path;\n+\n+    /**\n+     * If set, the generated OpenAPI schema documents will be stored here on build.\n+     * Both openapi.json and openapi.yaml will be stored here if this is set.\n+     */\n+    @ConfigItem\n+    public Optional<Path> storeSchemaDir;", "originalCommit": "6b87acff64d63f6259983e786241ebf2fa9d59b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIyMDk2Ng==", "url": "https://github.com/quarkusio/quarkus/pull/11638#discussion_r477220966", "bodyText": "Cool. Changed to Directory", "author": "phillip-kruger", "createdAt": "2020-08-26T11:12:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzIxNjM0NA=="}], "type": "inlineReview", "revised_code": {"commit": "14cf55edd2ddff72b837184a7a1eca45082abc73", "chunk": "diff --git a/extensions/smallrye-openapi-common/deployment/src/main/java/io/quarkus/smallrye/openapi/common/deployment/SmallRyeOpenApiConfig.java b/extensions/smallrye-openapi-common/deployment/src/main/java/io/quarkus/smallrye/openapi/common/deployment/SmallRyeOpenApiConfig.java\nindex 821563b9c7..5879bd6299 100644\n--- a/extensions/smallrye-openapi-common/deployment/src/main/java/io/quarkus/smallrye/openapi/common/deployment/SmallRyeOpenApiConfig.java\n+++ b/extensions/smallrye-openapi-common/deployment/src/main/java/io/quarkus/smallrye/openapi/common/deployment/SmallRyeOpenApiConfig.java\n\n@@ -19,5 +19,5 @@ public final class SmallRyeOpenApiConfig {\n      * Both openapi.json and openapi.yaml will be stored here if this is set.\n      */\n     @ConfigItem\n-    public Optional<Path> storeSchemaDir;\n+    public Optional<Path> storeSchemaDirectory;\n }\n"}}, {"oid": "14cf55edd2ddff72b837184a7a1eca45082abc73", "url": "https://github.com/quarkusio/quarkus/commit/14cf55edd2ddff72b837184a7a1eca45082abc73", "message": "Added option to save the generated OpenAPI schema document on build\n\nSigned-off-by: Phillip Kruger <phillip.kruger@gmail.com>", "committedDate": "2020-08-26T11:12:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyMzQ4OA==", "url": "https://github.com/quarkusio/quarkus/pull/11638#discussion_r482823488", "bodyText": "When specifying a relative path this appears to be relative to the working directory of where the build is running. I would instead have expected it to be relative to the Maven project's basedir. See issue #11846.", "author": "knutwannheden", "createdAt": "2020-09-03T09:04:24Z", "path": "extensions/smallrye-openapi/deployment/src/main/java/io/quarkus/smallrye/openapi/deployment/SmallRyeOpenApiProcessor.java", "diffHunk": "@@ -331,6 +341,21 @@ LogCleanupFilterBuildItem logCleanup() {\n                 \"OpenAPI document initialized:\");\n     }\n \n+    private void storeGeneratedSchema(byte[] schemaDocument, Format format) throws IOException {\n+        Path directory = openApiConfig.storeSchemaDirectory.get();\n+        if (!Files.exists(directory)) {\n+            Files.createDirectories(directory);", "originalCommit": "14cf55edd2ddff72b837184a7a1eca45082abc73", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgzMjIyMQ==", "url": "https://github.com/quarkusio/quarkus/pull/11638#discussion_r482832221", "bodyText": "I'll changes this. Thanks :)", "author": "phillip-kruger", "createdAt": "2020-09-03T09:17:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjgyMzQ4OA=="}], "type": "inlineReview", "revised_code": null}]}