{"pr_number": 13691, "pr_title": "Spring Data JPA @Modifying(clearAutomatically and flushAutomatically)", "pr_createdAt": "2020-12-04T07:51:06Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13691", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyMjI4Mg==", "url": "https://github.com/quarkusio/quarkus/pull/13691#discussion_r535922282", "bodyText": "Please remove the star import", "author": "geoand", "createdAt": "2020-12-04T08:32:22Z", "path": "extensions/spring-data-jpa/deployment/src/test/java/io/quarkus/spring/data/deployment/LoginEvent.java", "diffHunk": "@@ -0,0 +1,44 @@\n+package io.quarkus.spring.data.deployment;\n+\n+import java.time.ZonedDateTime;\n+\n+import javax.persistence.*;", "originalCommit": "4b2e288ebcf112f15e4105782e44c50380668079", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkzMDI0MA==", "url": "https://github.com/quarkusio/quarkus/pull/13691#discussion_r535930240", "bodyText": "Sorry, I can't figure out what part of Intellj does this again, now that I setup the Eclipse formatter. I'll fix it.", "author": "renegrob", "createdAt": "2020-12-04T08:45:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyMjI4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkzMDgyOA==", "url": "https://github.com/quarkusio/quarkus/pull/13691#discussion_r535930828", "bodyText": "No problem :)", "author": "geoand", "createdAt": "2020-12-04T08:46:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyMjI4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "f23fa4f691deaf37964bca44f40e028da8cc473f", "chunk": "diff --git a/extensions/spring-data-jpa/deployment/src/test/java/io/quarkus/spring/data/deployment/LoginEvent.java b/extensions/spring-data-jpa/deployment/src/test/java/io/quarkus/spring/data/deployment/LoginEvent.java\nindex 0524f44e6f..1e777d8923 100644\n--- a/extensions/spring-data-jpa/deployment/src/test/java/io/quarkus/spring/data/deployment/LoginEvent.java\n+++ b/extensions/spring-data-jpa/deployment/src/test/java/io/quarkus/spring/data/deployment/LoginEvent.java\n\n@@ -2,7 +2,10 @@ package io.quarkus.spring.data.deployment;\n \n import java.time.ZonedDateTime;\n \n-import javax.persistence.*;\n+import javax.persistence.Entity;\n+import javax.persistence.GeneratedValue;\n+import javax.persistence.Id;\n+import javax.persistence.ManyToOne;\n \n @Entity\n public class LoginEvent {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyMjk3NA==", "url": "https://github.com/quarkusio/quarkus/pull/13691#discussion_r535922974", "bodyText": "Do we need this as the same operation was added in RepositorySupport?", "author": "geoand", "createdAt": "2020-12-04T08:33:40Z", "path": "extensions/panache/hibernate-orm-panache/runtime/src/main/java/io/quarkus/hibernate/orm/panache/runtime/AdditionalJpaOperations.java", "diffHunk": "@@ -53,6 +53,16 @@\n         return new CustomCountPanacheQuery(em, jpaQuery, findQuery, countQuery, params);\n     }\n \n+    /**\n+     * Calls EntityManager.clear()\n+     * \n+     * @param jpaOperations\n+     */\n+    public static void clear(AbstractJpaOperations<?> jpaOperations) {", "originalCommit": "4b2e288ebcf112f15e4105782e44c50380668079", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyOTUwNA==", "url": "https://github.com/quarkusio/quarkus/pull/13691#discussion_r535929504", "bodyText": "We only need one. I was not sure which one to prefer. But I'll remove this one then.", "author": "renegrob", "createdAt": "2020-12-04T08:44:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyMjk3NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkzMDQzNw==", "url": "https://github.com/quarkusio/quarkus/pull/13691#discussion_r535930437", "bodyText": "I would say let's keep the RepositorySupport version as this will only be used in the Spring Data support.", "author": "geoand", "createdAt": "2020-12-04T08:46:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTkyMjk3NA=="}], "type": "inlineReview", "revised_code": {"commit": "f23fa4f691deaf37964bca44f40e028da8cc473f", "chunk": "diff --git a/extensions/panache/hibernate-orm-panache/runtime/src/main/java/io/quarkus/hibernate/orm/panache/runtime/AdditionalJpaOperations.java b/extensions/panache/hibernate-orm-panache/runtime/src/main/java/io/quarkus/hibernate/orm/panache/runtime/AdditionalJpaOperations.java\nindex f4b21cb9a7..da94ab5daf 100644\n--- a/extensions/panache/hibernate-orm-panache/runtime/src/main/java/io/quarkus/hibernate/orm/panache/runtime/AdditionalJpaOperations.java\n+++ b/extensions/panache/hibernate-orm-panache/runtime/src/main/java/io/quarkus/hibernate/orm/panache/runtime/AdditionalJpaOperations.java\n\n@@ -53,16 +53,6 @@ public class AdditionalJpaOperations {\n         return new CustomCountPanacheQuery(em, jpaQuery, findQuery, countQuery, params);\n     }\n \n-    /**\n-     * Calls EntityManager.clear()\n-     * \n-     * @param jpaOperations\n-     */\n-    public static void clear(AbstractJpaOperations<?> jpaOperations) {\n-        EntityManager em = jpaOperations.getEntityManager();\n-        em.clear();\n-    }\n-\n     public static long deleteAllWithCascade(AbstractJpaOperations<?> jpaOperations, Class<?> entityClass) {\n         EntityManager em = jpaOperations.getEntityManager();\n         //detecting the case where there are cascade-delete associations, and do the the bulk delete query otherwise.\n"}}, {"oid": "f23fa4f691deaf37964bca44f40e028da8cc473f", "url": "https://github.com/quarkusio/quarkus/commit/f23fa4f691deaf37964bca44f40e028da8cc473f", "message": "Implement @Modifying(clearAutomatically and flushAutomatically) for Spring Data JPA", "committedDate": "2020-12-04T10:22:37Z", "type": "forcePushed"}, {"oid": "df8beca65b477226e05d2d49a84a6892265bacef", "url": "https://github.com/quarkusio/quarkus/commit/df8beca65b477226e05d2d49a84a6892265bacef", "message": "Implement @Modifying(clearAutomatically and flushAutomatically) for Spring Data JPA", "committedDate": "2020-12-04T13:55:54Z", "type": "commit"}, {"oid": "df8beca65b477226e05d2d49a84a6892265bacef", "url": "https://github.com/quarkusio/quarkus/commit/df8beca65b477226e05d2d49a84a6892265bacef", "message": "Implement @Modifying(clearAutomatically and flushAutomatically) for Spring Data JPA", "committedDate": "2020-12-04T13:55:54Z", "type": "forcePushed"}]}