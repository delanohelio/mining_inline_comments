{"pr_number": 12206, "pr_title": "Adds new property to configure \"hibernate.format_sql\" in the application.properties", "pr_createdAt": "2020-09-19T09:37:57Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12206", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1ODUyMA==", "url": "https://github.com/quarkusio/quarkus/pull/12206#discussion_r491358520", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    @ConfigItem(defaultValueDocumentation = \"true\")\n          \n          \n            \n                    public Optional<Boolean> formattedSql;\n          \n          \n            \n                    @ConfigItem(defaultValue = \"true\")\n          \n          \n            \n                    public boolean formatSql;", "author": "gsmet", "createdAt": "2020-09-19T09:55:27Z", "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java", "diffHunk": "@@ -361,6 +361,12 @@ public boolean isAnyPropertySet() {\n         @ConfigItem\n         public boolean sql;\n \n+        /**\n+         * Format the SQL logs if SQL log is enabled\n+         */\n+        @ConfigItem(defaultValueDocumentation = \"true\")\n+        public Optional<Boolean> formattedSql;", "originalCommit": "90528badf88ce1761b366bdfa07cff957e0e60d7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "636ca491344a9899bc29e31e66fb37c18d15bbc0", "chunk": "diff --git a/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java b/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java\nindex 615a48792f..e1206d3aa0 100644\n--- a/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java\n+++ b/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java\n\n@@ -364,8 +378,8 @@ public class HibernateOrmConfigPersistenceUnit {\n         /**\n          * Format the SQL logs if SQL log is enabled\n          */\n-        @ConfigItem(defaultValueDocumentation = \"true\")\n-        public Optional<Boolean> formattedSql;\n+        @ConfigItem(defaultValue = \"true\")\n+        public boolean formatSql;\n \n         /**\n          * Whether JDBC warnings should be collected and logged.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1ODc5Nw==", "url": "https://github.com/quarkusio/quarkus/pull/12206#discussion_r491358797", "bodyText": "This will need to be adjusted in respect to the other change I suggested.", "author": "gsmet", "createdAt": "2020-09-19T09:56:19Z", "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmProcessor.java", "diffHunk": "@@ -807,7 +807,9 @@ private static void producePersistenceUnitDescriptorFromConfig(\n         // Logging\n         if (persistenceUnitConfig.log.sql) {\n             descriptor.getProperties().setProperty(AvailableSettings.SHOW_SQL, \"true\");\n-            descriptor.getProperties().setProperty(AvailableSettings.FORMAT_SQL, \"true\");\n+\n+            Boolean formattedSql = persistenceUnitConfig.log.formattedSql.orElse(true);\n+            descriptor.getProperties().setProperty(AvailableSettings.FORMAT_SQL, formattedSql.toString());", "originalCommit": "90528badf88ce1761b366bdfa07cff957e0e60d7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "636ca491344a9899bc29e31e66fb37c18d15bbc0", "chunk": "diff --git a/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmProcessor.java b/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmProcessor.java\nindex 1b001039e8..d17262f18c 100644\n--- a/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmProcessor.java\n+++ b/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmProcessor.java\n\n@@ -808,8 +812,9 @@ public final class HibernateOrmProcessor {\n         if (persistenceUnitConfig.log.sql) {\n             descriptor.getProperties().setProperty(AvailableSettings.SHOW_SQL, \"true\");\n \n-            Boolean formattedSql = persistenceUnitConfig.log.formattedSql.orElse(true);\n-            descriptor.getProperties().setProperty(AvailableSettings.FORMAT_SQL, formattedSql.toString());\n+            if (persistenceUnitConfig.log.formatSql) {\n+                descriptor.getProperties().setProperty(AvailableSettings.FORMAT_SQL, \"true\");\n+            }\n         }\n \n         if (persistenceUnitConfig.log.jdbcWarnings.isPresent()) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1ODg4OQ==", "url": "https://github.com/quarkusio/quarkus/pull/12206#discussion_r491358889", "bodyText": "Same here.", "author": "gsmet", "createdAt": "2020-09-19T09:56:42Z", "path": "extensions/hibernate-reactive/deployment/src/main/java/io/quarkus/hibernate/reactive/deployment/HibernateReactiveProcessor.java", "diffHunk": "@@ -243,7 +243,9 @@ private static ParsedPersistenceXmlDescriptor generateReactivePersistenceUnit(\n         // Logging\n         if (persistenceUnitConfig.log.sql) {\n             desc.getProperties().setProperty(AvailableSettings.SHOW_SQL, \"true\");\n-            desc.getProperties().setProperty(AvailableSettings.FORMAT_SQL, \"true\");\n+\n+            Boolean formattedSql = persistenceUnitConfig.log.formattedSql.orElse(true);\n+            desc.getProperties().setProperty(AvailableSettings.FORMAT_SQL, formattedSql.toString());", "originalCommit": "90528badf88ce1761b366bdfa07cff957e0e60d7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "636ca491344a9899bc29e31e66fb37c18d15bbc0", "chunk": "diff --git a/extensions/hibernate-reactive/deployment/src/main/java/io/quarkus/hibernate/reactive/deployment/HibernateReactiveProcessor.java b/extensions/hibernate-reactive/deployment/src/main/java/io/quarkus/hibernate/reactive/deployment/HibernateReactiveProcessor.java\nindex 38df2c4d4f..4b22c85f38 100644\n--- a/extensions/hibernate-reactive/deployment/src/main/java/io/quarkus/hibernate/reactive/deployment/HibernateReactiveProcessor.java\n+++ b/extensions/hibernate-reactive/deployment/src/main/java/io/quarkus/hibernate/reactive/deployment/HibernateReactiveProcessor.java\n\n@@ -244,8 +244,9 @@ public final class HibernateReactiveProcessor {\n         if (persistenceUnitConfig.log.sql) {\n             desc.getProperties().setProperty(AvailableSettings.SHOW_SQL, \"true\");\n \n-            Boolean formattedSql = persistenceUnitConfig.log.formattedSql.orElse(true);\n-            desc.getProperties().setProperty(AvailableSettings.FORMAT_SQL, formattedSql.toString());\n+            if (persistenceUnitConfig.log.formatSql) {\n+                desc.getProperties().setProperty(AvailableSettings.FORMAT_SQL, \"true\");\n+            }\n         }\n \n         // Statistics\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTM1OTA1MA==", "url": "https://github.com/quarkusio/quarkus/pull/12206#discussion_r491359050", "bodyText": "It needs to be taked into account in isAnyPropertySet.", "author": "gsmet", "createdAt": "2020-09-19T09:57:18Z", "path": "extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java", "diffHunk": "@@ -361,6 +361,12 @@ public boolean isAnyPropertySet() {\n         @ConfigItem\n         public boolean sql;\n \n+        /**\n+         * Format the SQL logs if SQL log is enabled\n+         */\n+        @ConfigItem(defaultValueDocumentation = \"true\")\n+        public Optional<Boolean> formattedSql;\n+", "originalCommit": "90528badf88ce1761b366bdfa07cff957e0e60d7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "636ca491344a9899bc29e31e66fb37c18d15bbc0", "chunk": "diff --git a/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java b/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java\nindex 615a48792f..e1206d3aa0 100644\n--- a/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java\n+++ b/extensions/hibernate-orm/deployment/src/main/java/io/quarkus/hibernate/orm/deployment/HibernateOrmConfigPersistenceUnit.java\n\n@@ -364,8 +378,8 @@ public class HibernateOrmConfigPersistenceUnit {\n         /**\n          * Format the SQL logs if SQL log is enabled\n          */\n-        @ConfigItem(defaultValueDocumentation = \"true\")\n-        public Optional<Boolean> formattedSql;\n+        @ConfigItem(defaultValue = \"true\")\n+        public boolean formatSql;\n \n         /**\n          * Whether JDBC warnings should be collected and logged.\n"}}, {"oid": "636ca491344a9899bc29e31e66fb37c18d15bbc0", "url": "https://github.com/quarkusio/quarkus/commit/636ca491344a9899bc29e31e66fb37c18d15bbc0", "message": "Add new property to configure SQL log formatting for Hibernate ORM", "committedDate": "2020-09-30T14:29:09Z", "type": "commit"}, {"oid": "636ca491344a9899bc29e31e66fb37c18d15bbc0", "url": "https://github.com/quarkusio/quarkus/commit/636ca491344a9899bc29e31e66fb37c18d15bbc0", "message": "Add new property to configure SQL log formatting for Hibernate ORM", "committedDate": "2020-09-30T14:29:09Z", "type": "forcePushed"}]}