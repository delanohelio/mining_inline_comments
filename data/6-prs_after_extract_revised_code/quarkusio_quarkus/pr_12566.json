{"pr_number": 12566, "pr_title": "Change default media type to JSON", "pr_createdAt": "2020-10-06T23:13:02Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/12566", "timeline": [{"oid": "81122f3fd289522e99c98ef0c8b6e48fd86fd078", "url": "https://github.com/quarkusio/quarkus/commit/81122f3fd289522e99c98ef0c8b6e48fd86fd078", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-07T23:09:36Z", "type": "forcePushed"}, {"oid": "18456a9c07cab100c643118b04c42fd8c0e71501", "url": "https://github.com/quarkusio/quarkus/commit/18456a9c07cab100c643118b04c42fd8c0e71501", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-07T23:30:22Z", "type": "forcePushed"}, {"oid": "c2b19b22a9acbae9e62c6bea008a7655a8cd855a", "url": "https://github.com/quarkusio/quarkus/commit/c2b19b22a9acbae9e62c6bea008a7655a8cd855a", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-08T07:02:04Z", "type": "forcePushed"}, {"oid": "ecef387445b6684976220db5e3b2d9ab14f3372d", "url": "https://github.com/quarkusio/quarkus/commit/ecef387445b6684976220db5e3b2d9ab14f3372d", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-08T07:06:59Z", "type": "forcePushed"}, {"oid": "1c7e3215bcca0b5a08c86a778299519ce16ab3fb", "url": "https://github.com/quarkusio/quarkus/commit/1c7e3215bcca0b5a08c86a778299519ce16ab3fb", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-08T07:08:18Z", "type": "forcePushed"}, {"oid": "6dd700049e95aae5f94e6d59892772b6f7d2bf79", "url": "https://github.com/quarkusio/quarkus/commit/6dd700049e95aae5f94e6d59892772b6f7d2bf79", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-08T07:44:08Z", "type": "forcePushed"}, {"oid": "ed67977f0da535d0cd90c425b38fd2b99be4d2fa", "url": "https://github.com/quarkusio/quarkus/commit/ed67977f0da535d0cd90c425b38fd2b99be4d2fa", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-09T04:51:21Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDg2NDczMw==", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r500864733", "bodyText": "Should be called QuarkusJsonbSerializer for consistency with other classes.", "author": "gsmet", "createdAt": "2020-10-07T09:21:37Z", "path": "extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package io.quarkus.resteasy.jsonb;\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.OutputStream;\n+import java.io.Reader;\n+import java.lang.annotation.Annotation;\n+import java.lang.reflect.Type;\n+import java.util.Arrays;\n+import java.util.HashSet;\n+import java.util.Set;\n+import java.util.concurrent.CompletionStage;\n+\n+import javax.activation.DataSource;\n+import javax.annotation.Priority;\n+import javax.ws.rs.Consumes;\n+import javax.ws.rs.Priorities;\n+import javax.ws.rs.Produces;\n+import javax.ws.rs.WebApplicationException;\n+import javax.ws.rs.core.HttpHeaders;\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.MultivaluedMap;\n+import javax.ws.rs.core.StreamingOutput;\n+import javax.ws.rs.ext.Provider;\n+\n+import org.jboss.resteasy.plugins.providers.FileRange;\n+import org.jboss.resteasy.plugins.providers.jsonb.JsonBindingProvider;\n+import org.jboss.resteasy.spi.AsyncOutputStream;\n+import org.jboss.resteasy.spi.AsyncStreamingOutput;\n+\n+/**\n+ * provider that can produce JSON by default, removing the need for @Produces and @Consumes everywhere\n+ */\n+@Provider\n+@Produces(MediaType.WILDCARD)\n+@Consumes(MediaType.WILDCARD)\n+@Priority(Priorities.USER - 200)\n+public class QuarkusJSONBSerializer extends JsonBindingProvider {", "originalCommit": "c5c997659f366062f27a5e785466be00b0b3f76b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "chunk": "diff --git a/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java b/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/runtime/QuarkusJsonbSerializer.java\nsimilarity index 96%\nrename from extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java\nrename to extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/runtime/QuarkusJsonbSerializer.java\nindex 400d73efcf..1862e0a54d 100644\n--- a/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java\n+++ b/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/runtime/QuarkusJsonbSerializer.java\n\n@@ -1,4 +1,4 @@\n-package io.quarkus.resteasy.jsonb;\n+package io.quarkus.resteasy.jsonb.runtime;\n \n import java.io.File;\n import java.io.IOException;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDg2NDg4Mg==", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r500864882", "bodyText": "It's not API so it should be in the runtime package.", "author": "gsmet", "createdAt": "2020-10-07T09:21:52Z", "path": "extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java", "diffHunk": "@@ -0,0 +1,77 @@\n+package io.quarkus.resteasy.jsonb;", "originalCommit": "c5c997659f366062f27a5e785466be00b0b3f76b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzM0NDc4MA==", "url": "https://github.com/quarkusio/quarkus/pull/12566#discussion_r503344780", "bodyText": "And same for the Jackson one.", "author": "gsmet", "createdAt": "2020-10-12T14:44:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDg2NDg4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "chunk": "diff --git a/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java b/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/runtime/QuarkusJsonbSerializer.java\nsimilarity index 96%\nrename from extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java\nrename to extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/runtime/QuarkusJsonbSerializer.java\nindex 400d73efcf..1862e0a54d 100644\n--- a/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/QuarkusJSONBSerializer.java\n+++ b/extensions/resteasy-jsonb/runtime/src/main/java/io/quarkus/resteasy/jsonb/runtime/QuarkusJsonbSerializer.java\n\n@@ -1,4 +1,4 @@\n-package io.quarkus.resteasy.jsonb;\n+package io.quarkus.resteasy.jsonb.runtime;\n \n import java.io.File;\n import java.io.IOException;\n"}}, {"oid": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "url": "https://github.com/quarkusio/quarkus/commit/f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-13T00:13:00Z", "type": "commit"}, {"oid": "f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "url": "https://github.com/quarkusio/quarkus/commit/f0a4c7c9dd4a5757e5d0310c81797569e121b4ca", "message": "Change default media type to JSON\n\nThis adds a new RESTEasy provider that will produce\nJSON by default. This removes the need to add\n@Produces(MediaType.APPLICATION_JSON) and\n@Consumes(MediaType.APPLICATION_JSON) everywhere.\n\nThe old behaviour can be retained by setting:\n\nquarkus.resteasy-json.default-json=false\n\nin application.properties.", "committedDate": "2020-10-13T00:13:00Z", "type": "forcePushed"}]}