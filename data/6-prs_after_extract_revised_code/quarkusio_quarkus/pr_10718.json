{"pr_number": 10718, "pr_title": "Properly determine classpath locations in Flyway", "pr_createdAt": "2020-07-14T13:57:08Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10718", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDM3ODQwMg==", "url": "https://github.com/quarkusio/quarkus/pull/10718#discussion_r454378402", "bodyText": "Done because you can end up with multiple copies of the same file (especially since there is some inferring of file names going on)", "author": "geoand", "createdAt": "2020-07-14T14:00:55Z", "path": "extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java", "diffHunk": "@@ -192,13 +192,16 @@ ServiceStartBuildItem createBeansAndStartActions(FlywayRecorder recorder,\n \n     private List<String> discoverApplicationMigrations(Collection<String> locations) throws IOException, URISyntaxException {\n         try {\n-            List<String> applicationMigrationResources = new ArrayList<>();\n+            LinkedHashSet<String> applicationMigrationResources = new LinkedHashSet<>();", "originalCommit": "3e5357ccefa860e5ae21cef2100e62c0d7cd8c89", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d32d028af23b9b7ca99691dbe8af9af742458c87", "chunk": "diff --git a/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java b/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java\nindex 79659f2acc..571b16f3b0 100644\n--- a/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java\n+++ b/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java\n\n@@ -190,7 +189,8 @@ class FlywayProcessor {\n         return migrationLocations;\n     }\n \n-    private List<String> discoverApplicationMigrations(Collection<String> locations) throws IOException, URISyntaxException {\n+    private Collection<String> discoverApplicationMigrations(Collection<String> locations)\n+            throws IOException, URISyntaxException {\n         try {\n             LinkedHashSet<String> applicationMigrationResources = new LinkedHashSet<>();\n             // Locations can be a comma separated list\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1NDc2MQ==", "url": "https://github.com/quarkusio/quarkus/pull/10718#discussion_r454454761", "bodyText": "Change the return type of this method to Collection<String> and you don't need to wrap the LinkedHashSet into another collection", "author": "gastaldi", "createdAt": "2020-07-14T15:44:10Z", "path": "extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java", "diffHunk": "@@ -223,7 +226,7 @@ ServiceStartBuildItem createBeansAndStartActions(FlywayRecorder recorder,\n                     }\n                 }\n             }\n-            return applicationMigrationResources;\n+            return new ArrayList<>(applicationMigrationResources);", "originalCommit": "3e5357ccefa860e5ae21cef2100e62c0d7cd8c89", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1NTg5OQ==", "url": "https://github.com/quarkusio/quarkus/pull/10718#discussion_r454455899", "bodyText": "Sure, but then I need to change all the rest as well. I don't think it's worth it TBH", "author": "geoand", "createdAt": "2020-07-14T15:45:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1NDc2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1ODU3Mw==", "url": "https://github.com/quarkusio/quarkus/pull/10718#discussion_r454458573", "bodyText": "Well, if you look what calls it you'll see it's already expecting Collection<String> so it's not a huge change", "author": "gastaldi", "createdAt": "2020-07-14T15:49:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1NDc2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1OTYwMg==", "url": "https://github.com/quarkusio/quarkus/pull/10718#discussion_r454459602", "bodyText": "I'll give it another look, but I thought it was List everywhere.", "author": "geoand", "createdAt": "2020-07-14T15:50:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1NDc2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ2NTE0Mg==", "url": "https://github.com/quarkusio/quarkus/pull/10718#discussion_r454465142", "bodyText": "Fixed", "author": "geoand", "createdAt": "2020-07-14T15:59:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDQ1NDc2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "d32d028af23b9b7ca99691dbe8af9af742458c87", "chunk": "diff --git a/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java b/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java\nindex 79659f2acc..571b16f3b0 100644\n--- a/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java\n+++ b/extensions/flyway/deployment/src/main/java/io/quarkus/flyway/FlywayProcessor.java\n\n@@ -226,7 +226,7 @@ class FlywayProcessor {\n                     }\n                 }\n             }\n-            return new ArrayList<>(applicationMigrationResources);\n+            return applicationMigrationResources;\n         } catch (IOException | URISyntaxException e) {\n             throw e;\n         }\n"}}, {"oid": "d32d028af23b9b7ca99691dbe8af9af742458c87", "url": "https://github.com/quarkusio/quarkus/commit/d32d028af23b9b7ca99691dbe8af9af742458c87", "message": "Properly determine classpath locations in Flyway\n\nFixes: #10041", "committedDate": "2020-07-14T15:58:29Z", "type": "commit"}, {"oid": "d32d028af23b9b7ca99691dbe8af9af742458c87", "url": "https://github.com/quarkusio/quarkus/commit/d32d028af23b9b7ca99691dbe8af9af742458c87", "message": "Properly determine classpath locations in Flyway\n\nFixes: #10041", "committedDate": "2020-07-14T15:58:29Z", "type": "forcePushed"}]}