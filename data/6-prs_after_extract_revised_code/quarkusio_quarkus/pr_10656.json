{"pr_number": 10656, "pr_title": "fix from pattern in CommonPanacheQueryImpl class", "pr_createdAt": "2020-07-11T19:50:09Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/10656", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMyMzUzOA==", "url": "https://github.com/quarkusio/quarkus/pull/10656#discussion_r453323538", "bodyText": "I think it would be better to use the DOTALL flag.", "author": "gsmet", "createdAt": "2020-07-12T14:29:30Z", "path": "extensions/panache/hibernate-orm-panache-common/runtime/src/main/java/io/quarkus/hibernate/orm/panache/common/runtime/CommonPanacheQueryImpl.java", "diffHunk": "@@ -32,7 +32,7 @@\n             Pattern.CASE_INSENSITIVE);\n \n     // match FROM\n-    static final Pattern FROM_PATTERN = Pattern.compile(\"^\\\\s*FROM\\\\s+.*\",\n+    static final Pattern FROM_PATTERN = Pattern.compile(\"^\\\\s*FROM\\\\s+(.|\\\\n|\\\\r)*\",", "originalCommit": "651f767a993faaaa5eb360ca26241ba234e2ddd9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1309a6b688f82050183323a4b6eba22db96cddad", "chunk": "diff --git a/extensions/panache/hibernate-orm-panache-common/runtime/src/main/java/io/quarkus/hibernate/orm/panache/common/runtime/CommonPanacheQueryImpl.java b/extensions/panache/hibernate-orm-panache-common/runtime/src/main/java/io/quarkus/hibernate/orm/panache/common/runtime/CommonPanacheQueryImpl.java\nindex 892a2f0c63..b9c82510ba 100644\n--- a/extensions/panache/hibernate-orm-panache-common/runtime/src/main/java/io/quarkus/hibernate/orm/panache/common/runtime/CommonPanacheQueryImpl.java\n+++ b/extensions/panache/hibernate-orm-panache-common/runtime/src/main/java/io/quarkus/hibernate/orm/panache/common/runtime/CommonPanacheQueryImpl.java\n\n@@ -29,11 +29,11 @@ public class CommonPanacheQueryImpl<Entity> {\n     // match SELECT DISTINCT? id (AS id)? (, id (AS id)?)*\n     static final Pattern SELECT_PATTERN = Pattern.compile(\n             \"^\\\\s*SELECT\\\\s+((?:DISTINCT\\\\s+)?\\\\w+(?:\\\\.\\\\w+)*)(?:\\\\s+AS\\\\s+\\\\w+)?(\\\\s*,\\\\s*\\\\w+(?:\\\\.\\\\w+)*(?:\\\\s+AS\\\\s+\\\\w+)?)*\\\\s+(.*)\",\n-            Pattern.CASE_INSENSITIVE);\n+            Pattern.CASE_INSENSITIVE | Pattern.DOTALL);\n \n     // match FROM\n-    static final Pattern FROM_PATTERN = Pattern.compile(\"^\\\\s*FROM\\\\s+(.|\\\\n|\\\\r)*\",\n-            Pattern.CASE_INSENSITIVE);\n+    static final Pattern FROM_PATTERN = Pattern.compile(\"^\\\\s*FROM\\\\s+.*\",\n+            Pattern.CASE_INSENSITIVE | Pattern.DOTALL);\n \n     private interface NonThrowingCloseable extends AutoCloseable {\n         @Override\n"}}, {"oid": "1309a6b688f82050183323a4b6eba22db96cddad", "url": "https://github.com/quarkusio/quarkus/commit/1309a6b688f82050183323a4b6eba22db96cddad", "message": "Allow for new lines in Panache queries regexp patterns\n\nFixes #10617", "committedDate": "2020-07-13T10:35:28Z", "type": "commit"}]}