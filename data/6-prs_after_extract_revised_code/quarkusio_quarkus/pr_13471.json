{"pr_number": 13471, "pr_title": "Qute: implement strategies if a property is not found in an expression", "pr_createdAt": "2020-11-25T15:53:08Z", "pr_url": "https://github.com/quarkusio/quarkus/pull/13471", "timeline": [{"oid": "b4f2d95d40c9cb66685cf7f83843edd77bdac937", "url": "https://github.com/quarkusio/quarkus/commit/b4f2d95d40c9cb66685cf7f83843edd77bdac937", "message": "Qute: implement strategies if a property is not found in an expression\n\n- resolves #12933", "committedDate": "2020-11-25T15:51:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDk2OTEwNQ==", "url": "https://github.com/quarkusio/quarkus/pull/13471#discussion_r530969105", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            builder.addResultMapper(new PropertyNotFoundOutputExpression());\n          \n          \n            \n                            builder.addResultMapper(new PropertyNotFoundOutputOriginal());", "author": "gastaldi", "createdAt": "2020-11-26T11:39:32Z", "path": "extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/EngineProducer.java", "diffHunk": "@@ -76,14 +76,30 @@ public EngineProducer(QuteContext context, Event<EngineBuilder> builderReady, Ev\n         builder.addValueResolver(ValueResolvers.logicalAndResolver());\n         builder.addValueResolver(ValueResolvers.logicalOrResolver());\n \n+        // If needed use a specific result mapper for the selected strategy  \n+        switch (runtimeConfig.propertyNotFoundStrategy) {\n+            case THROW_EXCEPTION:\n+                builder.addResultMapper(new PropertyNotFoundThrowException());\n+                break;\n+            case NOOP:\n+                builder.addResultMapper(new PropertyNotFoundNoop());\n+                break;\n+            case OUTPUT_ORIGINAL:\n+                builder.addResultMapper(new PropertyNotFoundOutputExpression());", "originalCommit": "b4f2d95d40c9cb66685cf7f83843edd77bdac937", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "be44922458a0eaa8ae4d90771300fda12be2a8a2", "chunk": "diff --git a/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/EngineProducer.java b/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/EngineProducer.java\nindex a3ecd72ba7..cac6c7c051 100644\n--- a/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/EngineProducer.java\n+++ b/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/EngineProducer.java\n\n@@ -85,7 +85,7 @@ public class EngineProducer {\n                 builder.addResultMapper(new PropertyNotFoundNoop());\n                 break;\n             case OUTPUT_ORIGINAL:\n-                builder.addResultMapper(new PropertyNotFoundOutputExpression());\n+                builder.addResultMapper(new PropertyNotFoundOutputOriginal());\n                 break;\n             default:\n                 // Use the default strategy\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDk2OTM4OA==", "url": "https://github.com/quarkusio/quarkus/pull/13471#discussion_r530969388", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            class PropertyNotFoundOutputExpression implements ResultMapper {\n          \n          \n            \n            class PropertyNotFoundOutputOriginal implements ResultMapper {", "author": "gastaldi", "createdAt": "2020-11-26T11:40:08Z", "path": "extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/PropertyNotFoundOutputExpression.java", "diffHunk": "@@ -0,0 +1,25 @@\n+package io.quarkus.qute.runtime;\n+\n+import io.quarkus.qute.Expression;\n+import io.quarkus.qute.ResultMapper;\n+import io.quarkus.qute.Results.Result;\n+import io.quarkus.qute.TemplateNode.Origin;\n+\n+class PropertyNotFoundOutputExpression implements ResultMapper {", "originalCommit": "b4f2d95d40c9cb66685cf7f83843edd77bdac937", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "be44922458a0eaa8ae4d90771300fda12be2a8a2", "chunk": "diff --git a/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/PropertyNotFoundOutputExpression.java b/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/PropertyNotFoundOutputExpression.java\nindex e3c9b11bfe..0d8e1ba684 100644\n--- a/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/PropertyNotFoundOutputExpression.java\n+++ b/extensions/qute/runtime/src/main/java/io/quarkus/qute/runtime/PropertyNotFoundOutputExpression.java\n\n@@ -5,7 +5,7 @@ import io.quarkus.qute.ResultMapper;\n import io.quarkus.qute.Results.Result;\n import io.quarkus.qute.TemplateNode.Origin;\n \n-class PropertyNotFoundOutputExpression implements ResultMapper {\n+class PropertyNotFoundOutputOriginal implements ResultMapper {\n \n     @Override\n     public int getPriority() {\n"}}, {"oid": "be44922458a0eaa8ae4d90771300fda12be2a8a2", "url": "https://github.com/quarkusio/quarkus/commit/be44922458a0eaa8ae4d90771300fda12be2a8a2", "message": "Apply suggestions from code review\n\nCo-authored-by: George Gastaldi <gegastaldi@gmail.com>", "committedDate": "2020-11-26T11:50:31Z", "type": "commit"}]}