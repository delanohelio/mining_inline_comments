{"pr_number": 2892, "pr_title": "NMS-12505: Provide ID and IpInterface in JSON results", "pr_createdAt": "2020-02-18T09:54:34Z", "pr_url": "https://github.com/OpenNMS/opennms/pull/2892", "timeline": [{"oid": "ae82dd747eb4548e10e3346a1eb730dc23417094", "url": "https://github.com/OpenNMS/opennms/commit/ae82dd747eb4548e10e3346a1eb730dc23417094", "message": "NMS-12505: Provide id and ipInterfaceId in api/v2/ifservices JSON results", "committedDate": "2020-02-12T10:25:49Z", "type": "commit"}, {"oid": "748071294522e1e818e1c7f51ae5253c98d97ab4", "url": "https://github.com/OpenNMS/opennms/commit/748071294522e1e818e1c7f51ae5253c98d97ab4", "message": "NMS-12505: Fixed tests", "committedDate": "2020-02-12T14:48:08Z", "type": "commit"}, {"oid": "16bf3a31830c47e49ad2feae8b40d44747242420", "url": "https://github.com/OpenNMS/opennms/commit/16bf3a31830c47e49ad2feae8b40d44747242420", "message": "NMS-12505: Fixed tests", "committedDate": "2020-02-13T07:42:45Z", "type": "commit"}, {"oid": "5855e070c97a53d8b1bc1ae0af35a45e61fae70d", "url": "https://github.com/OpenNMS/opennms/commit/5855e070c97a53d8b1bc1ae0af35a45e61fae70d", "message": "Merge branch 'release-25.2.1' into jira/NMS-12505", "committedDate": "2020-02-14T07:05:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3MTg3NQ==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380571875", "bodyText": "Fu und Fara oder was?\nShould probably be named differently :D", "author": "mvrueden", "createdAt": "2020-02-18T10:05:02Z", "path": "opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java", "diffHunk": "@@ -416,14 +421,20 @@ public void removeMetaData(final String context) {\n      * @return a {@link org.opennms.netmgt.model.OnmsIpInterface} object.\n      */\n     @XmlIDREF\n-    @JsonBackReference\n+    @JsonIgnore\n     @XmlElement(name=\"ipInterfaceId\")\n     @ManyToOne(optional=false, fetch=FetchType.LAZY)\n     @JoinColumn(name=\"ipInterfaceId\")\n     public OnmsIpInterface getIpInterface() {\n         return m_ipInterface;\n     }\n \n+    @JsonProperty(\"ipInterfaceId\")\n+    @Transient\n+    public Integer getFoo() {", "originalCommit": "5855e070c97a53d8b1bc1ae0af35a45e61fae70d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3NTIyNg==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380575226", "bodyText": "Yes, of course.", "author": "christianpape", "createdAt": "2020-02-18T10:10:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3MTg3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7e7ce7869a0f98a81125707f627ef21e8a7cf2c1", "chunk": "diff --git a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java\nindex f89f2d7b18d..398dbe8bb25 100644\n--- a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java\n+++ b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java\n\n@@ -431,7 +431,7 @@ public class OnmsMonitoredService extends OnmsEntity implements Serializable, Co\n \n     @JsonProperty(\"ipInterfaceId\")\n     @Transient\n-    public Integer getFoo() {\n+    public Integer getIpInterfaceId() {\n         return m_ipInterface.getId();\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3MjI2NQ==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380572265", "bodyText": "Can m_ipInterface ever be null?", "author": "mvrueden", "createdAt": "2020-02-18T10:05:40Z", "path": "opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java", "diffHunk": "@@ -416,14 +421,20 @@ public void removeMetaData(final String context) {\n      * @return a {@link org.opennms.netmgt.model.OnmsIpInterface} object.\n      */\n     @XmlIDREF\n-    @JsonBackReference\n+    @JsonIgnore\n     @XmlElement(name=\"ipInterfaceId\")\n     @ManyToOne(optional=false, fetch=FetchType.LAZY)\n     @JoinColumn(name=\"ipInterfaceId\")\n     public OnmsIpInterface getIpInterface() {\n         return m_ipInterface;\n     }\n \n+    @JsonProperty(\"ipInterfaceId\")\n+    @Transient\n+    public Integer getFoo() {\n+        return m_ipInterface.getId();", "originalCommit": "5855e070c97a53d8b1bc1ae0af35a45e61fae70d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3NTM0MA==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380575340", "bodyText": "I don't think so.", "author": "christianpape", "createdAt": "2020-02-18T10:11:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3MjI2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7e7ce7869a0f98a81125707f627ef21e8a7cf2c1", "chunk": "diff --git a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java\nindex f89f2d7b18d..398dbe8bb25 100644\n--- a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java\n+++ b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredService.java\n\n@@ -431,7 +431,7 @@ public class OnmsMonitoredService extends OnmsEntity implements Serializable, Co\n \n     @JsonProperty(\"ipInterfaceId\")\n     @Transient\n-    public Integer getFoo() {\n+    public Integer getIpInterfaceId() {\n         return m_ipInterface.getId();\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3MjY3OA==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380572678", "bodyText": "Do we need to store this as a field, can't we just return that in the getIpinterfaceId() method?", "author": "mvrueden", "createdAt": "2020-02-18T10:06:23Z", "path": "opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java", "diffHunk": "@@ -73,6 +75,7 @@ public OnmsMonitoredServiceDetail(OnmsMonitoredService service) {\n         m_statusCode = service.getStatus();\n         m_status = service.getStatusLong();\n         m_id = service.getXmlId();\n+        m_ipInterfaceId = service.getIpInterface().getId();", "originalCommit": "5855e070c97a53d8b1bc1ae0af35a45e61fae70d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3NTQ1Mw==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380575453", "bodyText": "done", "author": "christianpape", "createdAt": "2020-02-18T10:11:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3MjY3OA=="}], "type": "inlineReview", "revised_code": {"commit": "7e7ce7869a0f98a81125707f627ef21e8a7cf2c1", "chunk": "diff --git a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java\nindex 04b03039d63..4c150b3bd75 100644\n--- a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java\n+++ b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java\n\n@@ -75,7 +75,7 @@ public class OnmsMonitoredServiceDetail implements Serializable, Comparable<Onms\n         m_statusCode = service.getStatus();\n         m_status = service.getStatusLong();\n         m_id = service.getXmlId();\n-        m_ipInterfaceId = service.getIpInterface().getId();\n+        m_ipInterfaceId = service.getIpInterfaceId();\n     }\n \n     @XmlElement(name=\"status\")\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3Mjc3OQ==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380572779", "bodyText": "Should be getIpInterfaceId() instead.", "author": "mvrueden", "createdAt": "2020-02-18T10:06:32Z", "path": "opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java", "diffHunk": "@@ -140,6 +143,11 @@ public void setId(String id) {\n         m_id = id;\n     }\n \n+    @XmlAttribute(name=\"ipInterfaceId\")\n+    public Integer getIpinterfaceId() {", "originalCommit": "5855e070c97a53d8b1bc1ae0af35a45e61fae70d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3NTQ5OA==", "url": "https://github.com/OpenNMS/opennms/pull/2892#discussion_r380575498", "bodyText": "done", "author": "christianpape", "createdAt": "2020-02-18T10:11:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDU3Mjc3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "7e7ce7869a0f98a81125707f627ef21e8a7cf2c1", "chunk": "diff --git a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java\nindex 04b03039d63..4c150b3bd75 100644\n--- a/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java\n+++ b/opennms-model/src/main/java/org/opennms/netmgt/model/OnmsMonitoredServiceDetail.java\n\n@@ -144,7 +144,7 @@ public class OnmsMonitoredServiceDetail implements Serializable, Comparable<Onms\n     }\n \n     @XmlAttribute(name=\"ipInterfaceId\")\n-    public Integer getIpinterfaceId() {\n+    public Integer getIpInterfaceId() {\n         return m_ipInterfaceId;\n     }\n \n"}}, {"oid": "7e7ce7869a0f98a81125707f627ef21e8a7cf2c1", "url": "https://github.com/OpenNMS/opennms/commit/7e7ce7869a0f98a81125707f627ef21e8a7cf2c1", "message": "NMS-12505: Review changes", "committedDate": "2020-02-18T10:12:19Z", "type": "commit"}]}