{"pr_number": 1153, "pr_title": "DPC-948 ability to differentiate BFD headers when requesting patient everything vs bulk data", "pr_createdAt": "2020-12-22T06:39:54Z", "pr_url": "https://github.com/CMSgov/dpc-app/pull/1153", "timeline": [{"oid": "f3d765b8b89c9ca03496283f6fdf68e5825a6011", "url": "https://github.com/CMSgov/dpc-app/commit/f3d765b8b89c9ca03496283f6fdf68e5825a6011", "message": "ability to differentiate BFD headers when requesting patient everything vs bulk data", "committedDate": "2020-12-22T06:35:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzEwOTE4MQ==", "url": "https://github.com/CMSgov/dpc-app/pull/1153#discussion_r547109181", "bodyText": "Should the order matter? To ensure the values match the correct header keys.", "author": "MrMorie", "createdAt": "2020-12-22T07:18:36Z", "path": "dpc-aggregation/src/test/java/gov/cms/dpc/aggregation/engine/AggregationEngineBFDClientTest.java", "diffHunk": "@@ -84,22 +85,53 @@ void testHeadersPassedToBFD() {\n                 Collections.singletonList(ResourceType.Patient),\n                 null,\n                 MockBlueButtonClient.BFD_TRANSACTION_TIME,\n-                \"127.0.0.1\"\n-        );\n+                \"127.0.0.1\",\n+                true);\n \n         engine.run();\n \n         // Look at the result\n         final var completeJob = queue.getJobBatches(jobID).stream().findFirst().orElseThrow();\n         assertEquals(JobStatus.COMPLETED, completeJob.getStatus());\n \n-        Assertions.assertThat(headerKey.getAllValues()).containsExactlyInAnyOrder(Constants.INCLUDE_IDENTIFIERS_HEADER, Constants.BULK_CLIENT_ID_HEADER, Constants.BULK_JOB_ID_HEADER, HttpHeaders.X_FORWARDED_FOR);\n-        Assertions.assertThat(headerValue.getAllValues()).containsExactlyInAnyOrder(\"mbi\", providerID.toString(), jobID.toString(), \"127.0.0.1\");\n+        Assertions.assertThat(headerKey.getAllValues()).containsExactlyInAnyOrder(Constants.INCLUDE_IDENTIFIERS_HEADER, Constants.BULK_CLIENT_ID_HEADER, Constants.BULK_JOB_ID_HEADER, HttpHeaders.X_FORWARDED_FOR, Constants.BFD_ORIGINAL_QUERY_ID_HEADER);", "originalCommit": "f3d765b8b89c9ca03496283f6fdf68e5825a6011", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "fbb6e3ddc92198bde115813856e493a4b40cb172", "url": "https://github.com/CMSgov/dpc-app/commit/fbb6e3ddc92198bde115813856e493a4b40cb172", "message": "Merge branch 'master' into wh/DPC-948-update_bfd_headers_for_patient_everything", "committedDate": "2020-12-23T22:57:09Z", "type": "commit"}]}