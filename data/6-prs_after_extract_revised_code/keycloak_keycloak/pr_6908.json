{"pr_number": 6908, "pr_title": "[KEYCLOAK-10675] - Deleting an Identity Provider doesn't remove the associated IdP Mapper for that user", "pr_createdAt": "2020-03-19T22:21:36Z", "pr_url": "https://github.com/keycloak/keycloak/pull/6908", "timeline": [{"oid": "519c11cbecaceec2a8c4c8a4c22e33dfecdd77b4", "url": "https://github.com/keycloak/keycloak/commit/519c11cbecaceec2a8c4c8a4c22e33dfecdd77b4", "message": "[KEYCLOAK-10675] - Deleting an Identity Provider doesn't remove the associated IdP Mapper for that user", "committedDate": "2020-03-19T22:23:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwMzg1Ng==", "url": "https://github.com/keycloak/keycloak/pull/6908#discussion_r397703856", "bodyText": "Just minor concern, but from the name of this method, it is not obvious what is is doing... Is it possible to change the method signature to \"preRemove(RealmModel, IdentityProviderModel)\" to be compatible with all the other similar methods on the UserProvider interface (methods which intercepts removing on some realm object) ? WDYT?", "author": "mposolda", "createdAt": "2020-03-25T09:14:13Z", "path": "server-spi/src/main/java/org/keycloak/models/UserProvider.java", "diffHunk": "@@ -40,6 +40,7 @@\n \n     void addFederatedIdentity(RealmModel realm, UserModel user, FederatedIdentityModel socialLink);\n     boolean removeFederatedIdentity(RealmModel realm, UserModel user, String socialProvider);\n+    void removeFederatedIdentity(RealmModel realm, String socialProvider);", "originalCommit": "519c11cbecaceec2a8c4c8a4c22e33dfecdd77b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Nzg4NTM3NQ==", "url": "https://github.com/keycloak/keycloak/pull/6908#discussion_r397885375", "bodyText": "Sure", "author": "pedroigor", "createdAt": "2020-03-25T14:13:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwMzg1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzkwNjEyNA==", "url": "https://github.com/keycloak/keycloak/pull/6908#discussion_r397906124", "bodyText": "@mposolda I've also added more assertion to tests.", "author": "pedroigor", "createdAt": "2020-03-25T14:38:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcwMzg1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "c421c6083521b9658ae5688f2f56f3e2ae934cbe", "chunk": "diff --git a/server-spi/src/main/java/org/keycloak/models/UserProvider.java b/server-spi/src/main/java/org/keycloak/models/UserProvider.java\nindex 15d1a740d7..c3c5bb1939 100755\n--- a/server-spi/src/main/java/org/keycloak/models/UserProvider.java\n+++ b/server-spi/src/main/java/org/keycloak/models/UserProvider.java\n\n@@ -40,7 +40,7 @@ public interface UserProvider extends Provider,\n \n     void addFederatedIdentity(RealmModel realm, UserModel user, FederatedIdentityModel socialLink);\n     boolean removeFederatedIdentity(RealmModel realm, UserModel user, String socialProvider);\n-    void removeFederatedIdentity(RealmModel realm, String socialProvider);\n+    void preRemove(RealmModel realm, IdentityProviderModel provider);\n     void updateFederatedIdentity(RealmModel realm, UserModel federatedUser, FederatedIdentityModel federatedIdentityModel);\n     Set<FederatedIdentityModel> getFederatedIdentities(UserModel user, RealmModel realm);\n     FederatedIdentityModel getFederatedIdentity(UserModel user, String socialProvider, RealmModel realm);\n"}}, {"oid": "c421c6083521b9658ae5688f2f56f3e2ae934cbe", "url": "https://github.com/keycloak/keycloak/commit/c421c6083521b9658ae5688f2f56f3e2ae934cbe", "message": "[KEYCLOAK-10675] - Deleting an Identity Provider doesn't remove the associated IdP Mapper for that user", "committedDate": "2020-03-25T14:37:59Z", "type": "forcePushed"}, {"oid": "2fe8d8a4b4280538770f03301c613eed8cb3e28f", "url": "https://github.com/keycloak/keycloak/commit/2fe8d8a4b4280538770f03301c613eed8cb3e28f", "message": "[KEYCLOAK-10675] - Deleting an Identity Provider doesn't remove the associated IdP Mapper for that user", "committedDate": "2020-03-25T17:25:33Z", "type": "commit"}, {"oid": "2fe8d8a4b4280538770f03301c613eed8cb3e28f", "url": "https://github.com/keycloak/keycloak/commit/2fe8d8a4b4280538770f03301c613eed8cb3e28f", "message": "[KEYCLOAK-10675] - Deleting an Identity Provider doesn't remove the associated IdP Mapper for that user", "committedDate": "2020-03-25T17:25:33Z", "type": "forcePushed"}]}