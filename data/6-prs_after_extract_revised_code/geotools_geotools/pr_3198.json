{"pr_number": 3198, "pr_title": "[GEOT-6733] Add new expression functions to support And && Or operators", "pr_createdAt": "2020-11-05T07:55:32Z", "pr_url": "https://github.com/geotools/geotools/pull/3198", "timeline": [{"oid": "373556699743d3fa7dd00a0841fa0188e6775b0d", "url": "https://github.com/geotools/geotools/commit/373556699743d3fa7dd00a0841fa0188e6775b0d", "message": "Start to implement logical functions", "committedDate": "2020-11-04T14:21:07Z", "type": "commit"}, {"oid": "8f5dec5d82967fb91d370bf4408840cbdedf9eca", "url": "https://github.com/geotools/geotools/commit/8f5dec5d82967fb91d370bf4408840cbdedf9eca", "message": "Add AndFunction", "committedDate": "2020-11-04T15:15:05Z", "type": "commit"}, {"oid": "bbe105f8f7e4535c38d5b8a37dbba94f39aaabe3", "url": "https://github.com/geotools/geotools/commit/bbe105f8f7e4535c38d5b8a37dbba94f39aaabe3", "message": "Add OrFunction", "committedDate": "2020-11-04T15:44:02Z", "type": "commit"}, {"oid": "7a64d5bf7db3583860e3af39eac65707b8a0f03d", "url": "https://github.com/geotools/geotools/commit/7a64d5bf7db3583860e3af39eac65707b8a0f03d", "message": "Unnecessary cast", "committedDate": "2020-11-04T16:04:56Z", "type": "commit"}, {"oid": "2440d21c16f4c60243c0544a7e4d8892141f0b0a", "url": "https://github.com/geotools/geotools/commit/2440d21c16f4c60243c0544a7e4d8892141f0b0a", "message": "Add test for if_then_else", "committedDate": "2020-11-05T07:42:02Z", "type": "commit"}, {"oid": "5d87f5599e48dfe3be60f1962eb672c1bcf2b447", "url": "https://github.com/geotools/geotools/commit/5d87f5599e48dfe3be60f1962eb672c1bcf2b447", "message": "Run mvn fmt:format", "committedDate": "2020-11-05T08:52:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NDM3OA==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519684378", "bodyText": "Dates here should be all just \"2020\", e.g.:\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n             *    (C) 2002-2008, Open Source Geospatial Foundation (OSGeo)\n          \n          \n            \n             *    (C) 2020, Open Source Geospatial Foundation (OSGeo)", "author": "aaime", "createdAt": "2020-11-09T09:59:05Z", "path": "modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ *    GeoTools - The Open Source Java GIS Toolkit\n+ *    http://geotools.org\n+ *\n+ *    (C) 2002-2008, Open Source Geospatial Foundation (OSGeo)", "originalCommit": "5d87f5599e48dfe3be60f1962eb672c1bcf2b447", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "65ccc9cbcc51b2fc0392c95c6937e078344b2619", "chunk": "diff --git a/modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java b/modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java\nindex 51bb3113ed..12d45d51f2 100644\n--- a/modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java\n+++ b/modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java\n\n@@ -2,7 +2,7 @@\n  *    GeoTools - The Open Source Java GIS Toolkit\n  *    http://geotools.org\n  *\n- *    (C) 2002-2008, Open Source Geospatial Foundation (OSGeo)\n+ *    (C) 2020, Open Source Geospatial Foundation (OSGeo)\n  *\n  *    This library is free software; you can redistribute it and/or\n  *    modify it under the terms of the GNU Lesser General Public\n"}}, {"oid": "65ccc9cbcc51b2fc0392c95c6937e078344b2619", "url": "https://github.com/geotools/geotools/commit/65ccc9cbcc51b2fc0392c95c6937e078344b2619", "message": "Update modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java\n\nCo-authored-by: Andrea Aime <andrea.aime@gmail.com>", "committedDate": "2020-11-09T10:00:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NjA2MA==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519686060", "bodyText": "I think you commented on it already, and it's just for talking, not a request, but ... what about having a varying number of inputs, allow the user to pass as many arguments as they want? Should make setting up complex expressions easier.\nIn case you're interested, the \"in\" function can be used as a template to implement this behavior:\n\n  \n    \n      geotools/modules/library/main/src/main/java/org/geotools/filter/function/InFunction.java\n    \n    \n         Line 77\n      in\n      41ac131\n    \n    \n    \n    \n\n        \n          \n           public static FunctionName NAME = \n        \n    \n  \n\n\nI'm happy to merge as it is now though, as said, not a requirement.", "author": "aaime", "createdAt": "2020-11-09T10:01:35Z", "path": "modules/library/main/src/main/java/org/geotools/filter/function/AndFunction.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ *    GeoTools - The Open Source Java GIS Toolkit\n+ *    http://geotools.org\n+ *\n+ *    (C) 2002-2008, Open Source Geospatial Foundation (OSGeo)\n+ *\n+ *    This library is free software; you can redistribute it and/or\n+ *    modify it under the terms of the GNU Lesser General Public\n+ *    License as published by the Free Software Foundation;\n+ *    version 2.1 of the License.\n+ *\n+ *    This library is distributed in the hope that it will be useful,\n+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ *    Lesser General Public License for more details.\n+ *\n+ */\n+package org.geotools.filter.function;\n+\n+import static org.geotools.filter.capability.FunctionNameImpl.parameter;\n+\n+import org.geotools.filter.FunctionExpressionImpl;\n+import org.geotools.filter.capability.FunctionNameImpl;\n+import org.opengis.filter.capability.FunctionName;\n+\n+/**\n+ * This function is used to evaluate a And operator with a left and right operands\n+ *\n+ * @author Erwan Bocher, CNRS, 2020\n+ */\n+public class AndFunction extends FunctionExpressionImpl {\n+\n+    public static FunctionName NAME =\n+            new FunctionNameImpl(\n+                    \"And\",\n+                    Boolean.class,\n+                    parameter(\"left\", Boolean.class),", "originalCommit": "5d87f5599e48dfe3be60f1962eb672c1bcf2b447", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY5MDA5MA==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519690090", "bodyText": "I can check the In logic. Can you point me the resource ?", "author": "ebocher", "createdAt": "2020-11-09T10:07:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY5MjA1MA==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519692050", "bodyText": "The previous comment contains a link to it, follow it, it's the entire InFunction:\n\n  \n    \n      geotools/modules/library/main/src/main/java/org/geotools/filter/function/InFunction.java\n    \n    \n         Line 77\n      in\n      41ac131\n    \n    \n    \n    \n\n        \n          \n           public static FunctionName NAME =", "author": "aaime", "createdAt": "2020-11-09T10:11:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY5NjUyNQ==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519696525", "bodyText": "Ok it seems InFunction ;-)\nBy the way I have a question.\nWhat about  this expression\ntype = 'geotools' or version > 20 and language = 'it'\nIs geotools internal function evaluator is able to manage precedence between  or and and op ?\nor should I build a  tree to manage that ?", "author": "ebocher", "createdAt": "2020-11-09T10:17:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTcwMzkxOQ==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519703919", "bodyText": "Functions do not have precedence, they are applied in the order they are called.", "author": "aaime", "createdAt": "2020-11-09T10:29:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NjA2MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc4MjQwMA==", "url": "https://github.com/geotools/geotools/pull/3198#discussion_r519782400", "bodyText": "So after looking on Function mechanism, I think you can merge this PR. The setting up of the function precedence should be left to the developer's appreciation.", "author": "ebocher", "createdAt": "2020-11-09T12:50:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTY4NjA2MA=="}], "type": "inlineReview", "revised_code": null}]}