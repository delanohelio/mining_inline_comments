{"pr_number": 866, "pr_title": "Merge master to preview and move pnp helper to device only", "pr_createdAt": "2020-07-22T22:54:42Z", "pr_url": "https://github.com/Azure/azure-iot-sdk-java/pull/866", "timeline": [{"oid": "b8f40ddfd83c96099b0861732caf897b15655718", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/b8f40ddfd83c96099b0861732caf897b15655718", "message": "refactor(e2e): Remove validation of file upload notifications from e2e tests (#846)\n\nThis step in the test has never been reliable from the service side, so there is no reason to keep testing it", "committedDate": "2020-07-10T01:00:53Z", "type": "commit"}, {"oid": "6d09663374e3e0e544d089bcdae6b787af4393c2", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/6d09663374e3e0e544d089bcdae6b787af4393c2", "message": "doc(samples): Add readme for pnp device samples (#857)", "committedDate": "2020-07-10T18:02:13Z", "type": "commit"}, {"oid": "ca2881abb57c7dc58117f60918dd77610454fc29", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/ca2881abb57c7dc58117f60918dd77610454fc29", "message": "refactor(e2e): Add sdk logging to all test runs (#859)\n\nWhile system.out will get very busy thanks to our tests running in parallel, Azure Devops is smart enough to allow you to view the logs for each individual test run without other test run's logs getting in the mix.", "committedDate": "2020-07-10T20:08:48Z", "type": "commit"}, {"oid": "fc2ed8189b341e4df47d49a07269067a88a123ab", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/fc2ed8189b341e4df47d49a07269067a88a123ab", "message": "fix(iot-dev): Fix issue with ordering of queue within amqp layer (#858)\n\nIf two messages are queued, one for subscribing to twin, and one for getting a twin, and the latter is queued first, then the SDK gets stuck trying to send the get twin request repeatedly without trying to send the subscribe message first.\r\n\r\nThis change ensures that any message that is failed to send is placed at the back of the queue and that the next message stays at the front of the queue", "committedDate": "2020-07-11T15:32:51Z", "type": "commit"}, {"oid": "0efbf95e9085ac5bac64e1f285034208e8a45406", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/0efbf95e9085ac5bac64e1f285034208e8a45406", "message": "doc(readme): Update main readme with latest LTS pointers", "committedDate": "2020-07-16T23:48:26Z", "type": "commit"}, {"oid": "96c3dc8649c771fba82c7921973c6ca7ae64447c", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/96c3dc8649c771fba82c7921973c6ca7ae64447c", "message": "fix(vsts): Fix smart gate not ignoring iothub/provisioning tests when told to skip them", "committedDate": "2020-07-16T23:48:26Z", "type": "commit"}, {"oid": "52cf1b0182a30aa9ea31d41225536f0d026bd329", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/52cf1b0182a30aa9ea31d41225536f0d026bd329", "message": "refactor(iot-dev): Remove unused executor service\n\nIt spawned no threads and wasn't used anywhere, so it should be removed", "committedDate": "2020-07-17T01:04:42Z", "type": "commit"}, {"oid": "aae4ae3d4b1b19a3eed35003f957b5d85d19c311", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/aae4ae3d4b1b19a3eed35003f957b5d85d19c311", "message": "refactor(vsts): longer timeout for waiting on android emulator to start", "committedDate": "2020-07-17T01:04:42Z", "type": "commit"}, {"oid": "139a989fc085d0ef5f139607180ab959774bdee2", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/139a989fc085d0ef5f139607180ab959774bdee2", "message": "docs(sample) : Move pnp helper to device", "committedDate": "2020-07-22T16:46:23Z", "type": "commit"}, {"oid": "7051f017a19da8cb1eb8a604fb8970c55e3eccf5", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/7051f017a19da8cb1eb8a604fb8970c55e3eccf5", "message": "Merge branch 'master' of https://github.com/Azure/azure-iot-sdk-java into HEAD", "committedDate": "2020-07-22T22:33:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjgwNA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/866#discussion_r459132804", "bodyText": "Can you add the comment we had in the helper which was showing how the patch json should look like?", "author": "vinagesh", "createdAt": "2020-07-22T23:06:27Z", "path": "service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java", "diffHunk": "@@ -61,7 +64,10 @@ private static void GetAndUpdateTwin() throws IOException, IotHubException {\n         String propertyName = \"targetTemperature\";\n         double propertyValue = 60.2;\n         String componentName = \"thermostat1\";\n-        twin.setDesiredProperties(PnpHelper.CreateComponentPropertyPatch(propertyName, propertyValue, componentName));\n+        JsonObject patchJson = new JsonObject();", "originalCommit": "c4458d1b092054dbe374706ce200db4817fd10d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzODY2MA==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/866#discussion_r459138660", "bodyText": "coming in next commit", "author": "prmathur-microsoft", "createdAt": "2020-07-22T23:24:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjgwNA=="}], "type": "inlineReview", "revised_code": {"commit": "26cb521b6a2cd330215c5b6d0eea44d425715f60", "chunk": "diff --git a/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java b/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java\nindex 531f4cc04..d834de70e 100644\n--- a/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java\n+++ b/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java\n\n@@ -64,6 +64,13 @@ public class TemperatureController {\n         String propertyName = \"targetTemperature\";\n         double propertyValue = 60.2;\n         String componentName = \"thermostat1\";\n+        /* The property patch should be in the below format:\n+         *   \"componentName\": {\n+         *      \"__t\": \"c\",\n+         *      \"propertyName\": {\n+         *        \"value\": \"hello\"\n+         *      }\n+         */\n         JsonObject patchJson = new JsonObject();\n         patchJson.addProperty(PROPERTY_COMPONENT_IDENTIFIER_KEY, PROPERTY_COMPONENT_IDENTIFIER_VALUE);\n         patchJson.addProperty(propertyName, propertyValue);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjk0Nw==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/866#discussion_r459132947", "bodyText": "Can you add the comments we had for this as well in the helper earlier?", "author": "vinagesh", "createdAt": "2020-07-22T23:06:51Z", "path": "service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java", "diffHunk": "@@ -89,7 +95,7 @@ private static void InvokeMethodOnRootLevel() throws IOException, IotHubExceptio\n     }\n \n     private static void InvokeMethodOnComponent() throws IOException, IotHubException {\n-        String methodToInvoke = PnpHelper.CreateComponentCommandName(\"thermostat1\", \"getMaxMinReport\");\n+        String methodToInvoke = \"thermostat1\" + \"*\" +  \"getMaxMinReport\";", "originalCommit": "c4458d1b092054dbe374706ce200db4817fd10d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzODcyOQ==", "url": "https://github.com/Azure/azure-iot-sdk-java/pull/866#discussion_r459138729", "bodyText": "coming in next commit", "author": "prmathur-microsoft", "createdAt": "2020-07-22T23:25:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEzMjk0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "26cb521b6a2cd330215c5b6d0eea44d425715f60", "chunk": "diff --git a/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java b/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java\nindex 531f4cc04..d834de70e 100644\n--- a/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java\n+++ b/service/iot-service-samples/pnp-service-sample/temperature-controller-service-sample/src/main/java/samples/com/microsoft/azure/sdk/iot/service/TemperatureController.java\n\n@@ -95,6 +102,7 @@ public class TemperatureController {\n     }\n \n     private static void InvokeMethodOnComponent() throws IOException, IotHubException {\n+        /* The command to invoke for components should be in the format: \"componentName*commandName\" */\n         String methodToInvoke = \"thermostat1\" + \"*\" +  \"getMaxMinReport\";\n         System.out.println(\"Invoking method: \" + methodToInvoke);\n \n"}}, {"oid": "26cb521b6a2cd330215c5b6d0eea44d425715f60", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/26cb521b6a2cd330215c5b6d0eea44d425715f60", "message": "docs(samples) : Remove service sample dependency on pnp helper", "committedDate": "2020-07-22T23:25:49Z", "type": "commit"}, {"oid": "26cb521b6a2cd330215c5b6d0eea44d425715f60", "url": "https://github.com/Azure/azure-iot-sdk-java/commit/26cb521b6a2cd330215c5b6d0eea44d425715f60", "message": "docs(samples) : Remove service sample dependency on pnp helper", "committedDate": "2020-07-22T23:25:49Z", "type": "forcePushed"}]}