{"pr_number": 13487, "pr_title": "[WFLY-13150] Create a Galleon layer for distributable web", "pr_createdAt": "2020-08-17T11:06:57Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13487", "timeline": [{"oid": "31209a386c91bc0c1f36e9f99a386d6485833167", "url": "https://github.com/wildfly/wildfly/commit/31209a386c91bc0c1f36e9f99a386d6485833167", "message": "[WFLY-13150] Create a Galleon layer for distributable web", "committedDate": "2020-08-17T13:16:37Z", "type": "forcePushed"}, {"oid": "af46a733ee9237d3f403a4737f1f0e878efd266c", "url": "https://github.com/wildfly/wildfly/commit/af46a733ee9237d3f403a4737f1f0e878efd266c", "message": "[WFLY-13150] Create a Galleon layer for distributable web", "committedDate": "2020-10-19T15:33:20Z", "type": "forcePushed"}, {"oid": "5cbcff3fa477486b9fda25004a58c720e84f5141", "url": "https://github.com/wildfly/wildfly/commit/5cbcff3fa477486b9fda25004a58c720e84f5141", "message": "[WFLY-13150] Create a Galleon layer for distributable web", "committedDate": "2020-10-26T16:55:02Z", "type": "forcePushed"}, {"oid": "1105bcbce7d70ba1eb1788853e2c80589af4f8d3", "url": "https://github.com/wildfly/wildfly/commit/1105bcbce7d70ba1eb1788853e2c80589af4f8d3", "message": "WIP", "committedDate": "2020-11-04T09:21:46Z", "type": "forcePushed"}, {"oid": "e8469708c53968ecacda64e8ab31625bb9f09045", "url": "https://github.com/wildfly/wildfly/commit/e8469708c53968ecacda64e8ab31625bb9f09045", "message": "WIP", "committedDate": "2020-11-04T09:24:34Z", "type": "forcePushed"}, {"oid": "e15985f8133624beb3cb66a8f263287447439300", "url": "https://github.com/wildfly/wildfly/commit/e15985f8133624beb3cb66a8f263287447439300", "message": "WIP", "committedDate": "2020-11-04T11:43:07Z", "type": "forcePushed"}, {"oid": "5e3685fceb1e021138bd0b40554c3ac81679dc16", "url": "https://github.com/wildfly/wildfly/commit/5e3685fceb1e021138bd0b40554c3ac81679dc16", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache", "committedDate": "2020-11-04T16:53:21Z", "type": "forcePushed"}, {"oid": "148b2e1a951860decb766aee03162d4516123a5c", "url": "https://github.com/wildfly/wildfly/commit/148b2e1a951860decb766aee03162d4516123a5c", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache", "committedDate": "2020-11-09T11:27:26Z", "type": "forcePushed"}, {"oid": "d07123e4e6597224cbb470375fe4f8c3734574d8", "url": "https://github.com/wildfly/wildfly/commit/d07123e4e6597224cbb470375fe4f8c3734574d8", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache", "committedDate": "2020-11-12T09:12:33Z", "type": "forcePushed"}, {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c", "url": "https://github.com/wildfly/wildfly/commit/25556c65189cf2968a0e50aedaca9402cf643c4c", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache", "committedDate": "2020-11-13T09:27:11Z", "type": "commit"}, {"oid": "25556c65189cf2968a0e50aedaca9402cf643c4c", "url": "https://github.com/wildfly/wildfly/commit/25556c65189cf2968a0e50aedaca9402cf643c4c", "message": "[WFLY-13150] Create a Galleon layer for distributable web subsystem configured with a local container cache", "committedDate": "2020-11-13T09:27:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzMDc4MQ==", "url": "https://github.com/wildfly/wildfly/pull/13487#discussion_r535430781", "bodyText": "Hi @yersan - I might be missing something here, but IIUC the deployment is operated by Arquillian only when ts.bootable is set. What happens for Galleon - i.e. when ts.layers is set?", "author": "fabiobrz", "createdAt": "2020-12-03T17:20:02Z", "path": "testsuite/integration/clustering/src/test/java/org/jboss/as/test/clustering/single/web/NonHaWebSessionPersistenceTestCase.java", "diffHunk": "@@ -99,8 +103,11 @@ public void testSessionPersistence(@ArquillianResource(SimpleServlet.class) @Ope\n             Assert.assertFalse(Boolean.valueOf(response.getFirstHeader(\"serialized\").getValue()));\n             response.getEntity().getContent().close();\n \n-            stop(CONTAINER_SINGLE);\n-            start(CONTAINER_SINGLE);\n+            NodeUtil.stop(this.controller, CONTAINER_SINGLE);\n+            NodeUtil.start(this.controller, CONTAINER_SINGLE);\n+            if (Boolean.getBoolean(\"ts.bootable\")) {", "originalCommit": "25556c65189cf2968a0e50aedaca9402cf643c4c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ0MDM4MA==", "url": "https://github.com/wildfly/wildfly/pull/13487#discussion_r535440380", "bodyText": "Hi @fabiobrz This test requires a server restart to later validate the session information is correctly recovered. This test is used for a bootable JAR, Galleon trimmed or bare metal server. The deployment is always managed by the test itself, I mean Arquillian will not automatically deploy the application, we deploy it manually on @before and @after methods, but the deployment survives to a server restart when we are not in the Bootable JAR scenario.\nWhen we are testing the Bootable JAR we need to redeploy it after stopping the server, hence this if.", "author": "yersan", "createdAt": "2020-12-03T17:33:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzMDc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyMDMxMA==", "url": "https://github.com/wildfly/wildfly/pull/13487#discussion_r535520310", "bodyText": "Thanks @yersan you\u2019re right, the jar must be redeployed to the hollow bootable jar server.", "author": "fabiobrz", "createdAt": "2020-12-03T19:27:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQzMDc4MQ=="}], "type": "inlineReview", "revised_code": null}]}