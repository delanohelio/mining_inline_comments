{"pr_number": 13744, "pr_title": "[WFLY-14025] Don't create default binding injections if they are not \u2026", "pr_createdAt": "2020-11-27T12:47:41Z", "pr_url": "https://github.com/wildfly/wildfly/pull/13744", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYyMTgyNA==", "url": "https://github.com/wildfly/wildfly/pull/13744#discussion_r531621824", "bodyText": "Should it be getJmsConnectionFactory() ?", "author": "gaol", "createdAt": "2020-11-27T14:07:07Z", "path": "messaging-activemq/src/main/java/org/wildfly/extension/messaging/activemq/deployment/DefaultJMSConnectionFactoryResourceReferenceProcessor.java", "diffHunk": "@@ -47,8 +48,11 @@ public void deploy(DeploymentPhaseContext phaseContext) throws DeploymentUnitPro\n         final DeploymentUnit deploymentUnit = phaseContext.getDeploymentUnit();\n         if(deploymentUnit.getParent() == null) {\n             final EEResourceReferenceProcessorRegistry eeResourceReferenceProcessorRegistry = deploymentUnit.getAttachment(Attachments.RESOURCE_REFERENCE_PROCESSOR_REGISTRY);\n-            if(eeResourceReferenceProcessorRegistry != null) {\n-                eeResourceReferenceProcessorRegistry.registerResourceReferenceProcessor(RESOURCE_REFERENCE_PROCESSOR);\n+            if (eeResourceReferenceProcessorRegistry != null) {\n+                final EEModuleDescription eeModuleDescription = deploymentUnit.getAttachment(Attachments.EE_MODULE_DESCRIPTION);\n+                if (eeModuleDescription != null && eeModuleDescription.getDefaultResourceJndiNames().getDataSource() != null) {", "originalCommit": "5f54845c7e7d0e470bfb875410d5cb25b9cb36fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzA1MDI5Ng==", "url": "https://github.com/wildfly/wildfly/pull/13744#discussion_r533050296", "bodyText": "Yes, it should be getJmsConnectionFactory().", "author": "bstansberry", "createdAt": "2020-12-01T03:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYyMTgyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMzI1MDQxMA==", "url": "https://github.com/wildfly/wildfly/pull/13744#discussion_r533250410", "bodyText": "fixed", "author": "tadamski", "createdAt": "2020-12-01T09:53:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTYyMTgyNA=="}], "type": "inlineReview", "revised_code": {"commit": "b8577d07b398b5cffe1b26f4aa6a872a2fbbac1d", "chunk": "diff --git a/messaging-activemq/src/main/java/org/wildfly/extension/messaging/activemq/deployment/DefaultJMSConnectionFactoryResourceReferenceProcessor.java b/messaging-activemq/src/main/java/org/wildfly/extension/messaging/activemq/deployment/DefaultJMSConnectionFactoryResourceReferenceProcessor.java\nindex f8a7d4d46d..d2e8c3cd21 100644\n--- a/messaging-activemq/src/main/java/org/wildfly/extension/messaging/activemq/deployment/DefaultJMSConnectionFactoryResourceReferenceProcessor.java\n+++ b/messaging-activemq/src/main/java/org/wildfly/extension/messaging/activemq/deployment/DefaultJMSConnectionFactoryResourceReferenceProcessor.java\n\n@@ -50,7 +50,7 @@ public class DefaultJMSConnectionFactoryResourceReferenceProcessor implements De\n             final EEResourceReferenceProcessorRegistry eeResourceReferenceProcessorRegistry = deploymentUnit.getAttachment(Attachments.RESOURCE_REFERENCE_PROCESSOR_REGISTRY);\n             if (eeResourceReferenceProcessorRegistry != null) {\n                 final EEModuleDescription eeModuleDescription = deploymentUnit.getAttachment(Attachments.EE_MODULE_DESCRIPTION);\n-                if (eeModuleDescription != null && eeModuleDescription.getDefaultResourceJndiNames().getDataSource() != null) {\n+                if (eeModuleDescription != null && eeModuleDescription.getDefaultResourceJndiNames().getJmsConnectionFactory() != null) {\n                     eeResourceReferenceProcessorRegistry.registerResourceReferenceProcessor(RESOURCE_REFERENCE_PROCESSOR);\n                 }\n             }\n"}}, {"oid": "b8577d07b398b5cffe1b26f4aa6a872a2fbbac1d", "url": "https://github.com/wildfly/wildfly/commit/b8577d07b398b5cffe1b26f4aa6a872a2fbbac1d", "message": "[WFLY-14025] Don't create default binding injections if they are not specified", "committedDate": "2020-12-01T09:52:08Z", "type": "forcePushed"}, {"oid": "1039349882018116185f1b74eeb8c8c80ac05799", "url": "https://github.com/wildfly/wildfly/commit/1039349882018116185f1b74eeb8c8c80ac05799", "message": "[WFLY-14025] Don't create default binding injections if they are not specified", "committedDate": "2020-12-01T15:33:41Z", "type": "commit"}, {"oid": "1039349882018116185f1b74eeb8c8c80ac05799", "url": "https://github.com/wildfly/wildfly/commit/1039349882018116185f1b74eeb8c8c80ac05799", "message": "[WFLY-14025] Don't create default binding injections if they are not specified", "committedDate": "2020-12-01T15:33:41Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTUyNTgwMA==", "url": "https://github.com/wildfly/wildfly/pull/13744#discussion_r535525800", "bodyText": "Instead of a temporary change that needs cleaning up we should just aim to get the WildFly Core change through and use it after the next tag.", "author": "darranl", "createdAt": "2020-12-03T19:33:21Z", "path": "ee/src/main/java/org/jboss/as/ee/subsystem/DefaultBindingsAdd.java", "diffHunk": "@@ -36,6 +36,8 @@\n  */\n public class DefaultBindingsAdd extends AbstractBoottimeAddStepHandler {\n \n+    public static final int STRUCTURE_EE_DEFAULT_BINDINGS_CONFIG = 0x1B01;", "originalCommit": "1039349882018116185f1b74eeb8c8c80ac05799", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}