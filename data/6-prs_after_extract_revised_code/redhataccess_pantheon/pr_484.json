{"pr_number": 484, "pr_title": "Search Beta fixes2", "pr_createdAt": "2020-12-04T01:42:41Z", "pr_url": "https://github.com/redhataccess/pantheon/pull/484", "timeline": [{"oid": "50640b5a0d8c2f3e7f1686a1aa55ed404dd288ec", "url": "https://github.com/redhataccess/pantheon/commit/50640b5a0d8c2f3e7f1686a1aa55ed404dd288ec", "message": "Fix jackrabbit excpetion when repo name contains space", "committedDate": "2020-12-04T01:41:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDMzNQ==", "url": "https://github.com/redhataccess/pantheon/pull/484#discussion_r536090335", "bodyText": "Just one query - what is the intent behind using ISO9875.encode rather than UTF-8? Other than that LGTM.", "author": "aprajshekhar", "createdAt": "2020-12-04T13:13:40Z", "path": "pantheon-bundle/src/main/java/com/redhat/pantheon/servlet/ModuleListingServlet.java", "diffHunk": "@@ -99,9 +100,15 @@ protected String getQuery(SlingHttpServletRequest request) {\n \n         StringBuilder queryBuilder = null;\n         if (repoParam != null) {\n-            log.info(\"[\" + ModuleListingServlet.class.getSimpleName() + \"] contentTypeParam: \" + contentTypeParam);\n-            String repos = String.join(\" | \", repoParam);\n-            log.info(\"[\" + ModuleListingServlet.class.getSimpleName() + \"] repos: \" + repos);\n+            // encode if repo name contains space\n+            String repos = Arrays.stream(repoParam)\n+                    .map( repo -> {\n+                        if (repo.contains(\" \")) {\n+                            return ISO9075.encode(repo);", "originalCommit": "50640b5a0d8c2f3e7f1686a1aa55ed404dd288ec", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE1MDY0Mw==", "url": "https://github.com/redhataccess/pantheon/pull/484#discussion_r536150643", "bodyText": "jackrabbit uses ISO9075.encode to handle the spaces.\nhttps://www.mail-archive.com/users@jackrabbit.apache.org/msg05782.html", "author": "xdavidson", "createdAt": "2020-12-04T14:46:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDMzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjE1ODY3Ng==", "url": "https://github.com/redhataccess/pantheon/pull/484#discussion_r536158676", "bodyText": "That is an excellent find, bravo for being able to dig up this relatively obscure internet artifact.\nWould you mind adding this link as a comment in the source code?\nAlso, do we need the if (repo.contains(\" \")) statement? Can we just encode the string unconditionally?", "author": "benradey", "createdAt": "2020-12-04T14:57:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA5MDMzNQ=="}], "type": "inlineReview", "revised_code": {"commit": "493f5e076cf6b629a4e6e434412ccfdc81e07624", "chunk": "diff --git a/pantheon-bundle/src/main/java/com/redhat/pantheon/servlet/ModuleListingServlet.java b/pantheon-bundle/src/main/java/com/redhat/pantheon/servlet/ModuleListingServlet.java\nindex 2e255f7..61367e1 100644\n--- a/pantheon-bundle/src/main/java/com/redhat/pantheon/servlet/ModuleListingServlet.java\n+++ b/pantheon-bundle/src/main/java/com/redhat/pantheon/servlet/ModuleListingServlet.java\n\n@@ -100,13 +100,11 @@ public class ModuleListingServlet extends AbstractJsonQueryServlet {\n \n         StringBuilder queryBuilder = null;\n         if (repoParam != null) {\n-            // encode if repo name contains space\n+            // encode if repo name contains space.\n+            // https://www.mail-archive.com/users@jackrabbit.apache.org/msg05782.html\n             String repos = Arrays.stream(repoParam)\n                     .map( repo -> {\n-                        if (repo.contains(\" \")) {\n-                            return ISO9075.encode(repo);\n-                        }\n-                        return repo;\n+                        return ISO9075.encode(repo);\n                     })\n                     .collect(Collectors.joining(\" | \"));\n             String contentType = contentTypeParam != null ? contentTypeParam : \"pant:document\";\n"}}, {"oid": "493f5e076cf6b629a4e6e434412ccfdc81e07624", "url": "https://github.com/redhataccess/pantheon/commit/493f5e076cf6b629a4e6e434412ccfdc81e07624", "message": "code review fix", "committedDate": "2020-12-04T15:19:48Z", "type": "commit"}]}