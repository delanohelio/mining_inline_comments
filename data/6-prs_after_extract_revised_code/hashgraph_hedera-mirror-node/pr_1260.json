{"pr_number": 1260, "pr_title": "Bump sdk and update token and crypto transfer transactions", "pr_createdAt": "2020-11-12T17:31:53Z", "pr_url": "https://github.com/hashgraph/hedera-mirror-node/pull/1260", "timeline": [{"oid": "fba3fd4f6fab9b2f439ffc26375280bebfd78278", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/fba3fd4f6fab9b2f439ffc26375280bebfd78278", "message": "Bump sdk and update token and crypto transfer transactions\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-11-12T17:26:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM3NDY3Mw==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1260#discussion_r522374673", "bodyText": "I think each class should map one to one with a HAPI service. So we should remove this class and its entry in TransactionType. Then make it an option (off by default) to add token transfers to the cryptotransfer supplier", "author": "steven-sheehy", "createdAt": "2020-11-12T19:42:07Z", "path": "hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/token/TokenTransferTransactionSupplier.java", "diffHunk": "@@ -30,12 +30,12 @@\n import com.hedera.datagenerator.sdk.supplier.TransactionSupplier;\n import com.hedera.datagenerator.sdk.supplier.TransactionSupplierException;\n import com.hedera.hashgraph.sdk.account.AccountId;\n+import com.hedera.hashgraph.sdk.account.TransferTransaction;\n import com.hedera.hashgraph.sdk.token.TokenId;\n-import com.hedera.hashgraph.sdk.token.TokenTransferTransaction;\n \n @Builder\n @Value\n-public class TokenTransferTransactionSupplier implements TransactionSupplier<TokenTransferTransaction> {\n+public class TokenTransferTransactionSupplier implements TransactionSupplier<TransferTransaction> {", "originalCommit": "fba3fd4f6fab9b2f439ffc26375280bebfd78278", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY4NzcxNg==", "url": "https://github.com/hashgraph/hedera-mirror-node/pull/1260#discussion_r522687716", "bodyText": "Makes sense.  I've removed it and added an optional tokenId to append a token transfer to the CryptoTransferTransactionSupplier", "author": "ijungmann", "createdAt": "2020-11-13T06:42:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjM3NDY3Mw=="}], "type": "inlineReview", "revised_code": {"commit": "e602fc2a9819ea120a153ef44a1faae30d138711", "chunk": "diff --git a/hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/token/TokenTransferTransactionSupplier.java b/hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/token/TokenTransferTransactionSupplier.java\ndeleted file mode 100644\nindex c9aa51e2..00000000\n--- a/hedera-mirror-datagenerator/src/main/java/com/hedera/datagenerator/sdk/supplier/token/TokenTransferTransactionSupplier.java\n+++ /dev/null\n\n@@ -1,70 +0,0 @@\n-package com.hedera.datagenerator.sdk.supplier.token;\n-\n-/*-\n- * \u200c\n- * Hedera Mirror Node\n- * \u200b\n- * Copyright (C) 2019 - 2020 Hedera Hashgraph, LLC\n- * \u200b\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- * \u200d\n- */\n-\n-import java.util.Arrays;\n-import java.util.List;\n-import lombok.Builder;\n-import lombok.Value;\n-import org.apache.commons.lang3.StringUtils;\n-\n-import com.hedera.datagenerator.common.Utility;\n-import com.hedera.datagenerator.sdk.supplier.TransactionSupplier;\n-import com.hedera.datagenerator.sdk.supplier.TransactionSupplierException;\n-import com.hedera.hashgraph.sdk.account.AccountId;\n-import com.hedera.hashgraph.sdk.account.TransferTransaction;\n-import com.hedera.hashgraph.sdk.token.TokenId;\n-\n-@Builder\n-@Value\n-public class TokenTransferTransactionSupplier implements TransactionSupplier<TransferTransaction> {\n-\n-    private static final List<String> requiredFields = Arrays\n-            .asList(\"recipientAccountId\", \"senderAccountId\", \"tokenId\");\n-\n-    //Required\n-    private final String recipientAccountId;\n-    private final String senderAccountId;\n-    private final String tokenId;\n-\n-    //Optional\n-    @Builder.Default\n-    private final int amount = 1;\n-\n-    @Builder.Default\n-    private final long maxTransactionFee = 1_000_000;\n-\n-    @Override\n-    public TransferTransaction get() {\n-\n-        if (StringUtils.isBlank(recipientAccountId) || StringUtils.isBlank(senderAccountId) || StringUtils\n-                .isBlank(tokenId)) {\n-            throw new TransactionSupplierException(this, requiredFields);\n-        }\n-\n-        TokenId token = TokenId.fromString(tokenId);\n-        return new TransferTransaction()\n-                .addTokenTransfer(token, AccountId.fromString(recipientAccountId), amount)\n-                .addTokenTransfer(token, AccountId.fromString(senderAccountId), Math.negateExact(amount))\n-                .setMaxTransactionFee(maxTransactionFee)\n-                .setTransactionMemo(Utility.getMemo(\"Mirror node transferred test token\"));\n-    }\n-}\n"}}, {"oid": "e602fc2a9819ea120a153ef44a1faae30d138711", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/e602fc2a9819ea120a153ef44a1faae30d138711", "message": "Remove TokenTransferTransactionSupplier\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-11-13T06:40:39Z", "type": "commit"}, {"oid": "c1e8a0d0e96e22af5c1ce34fc12d4382cb5c2502", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/c1e8a0d0e96e22af5c1ce34fc12d4382cb5c2502", "message": "Fix TokenFeature\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-11-13T06:47:59Z", "type": "commit"}, {"oid": "4a884519e8a7cfdcbfa428fe4c9c870341a548e3", "url": "https://github.com/hashgraph/hedera-mirror-node/commit/4a884519e8a7cfdcbfa428fe4c9c870341a548e3", "message": "Merge with master\n\nSigned-off-by: Ian Jungmann <ian.jungmann@hedera.com>", "committedDate": "2020-11-16T16:55:57Z", "type": "commit"}]}