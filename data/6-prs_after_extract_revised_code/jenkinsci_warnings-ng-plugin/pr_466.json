{"pr_number": 466, "pr_title": "JENKINS-62102: Remove UI assertions from MiscIssueRecorderITest", "pr_createdAt": "2020-05-07T20:47:26Z", "pr_url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/466", "timeline": [{"oid": "584087592bc8e8073668ea65dceebf38f7ed7fa8", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/584087592bc8e8073668ea65dceebf38f7ed7fa8", "message": "remove ui assertions", "committedDate": "2020-05-07T20:38:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAwNTU4NQ==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/466#discussion_r425005585", "bodyText": "@uhafner Wie k\u00f6nnen wir das AGE-Attribut im neuen Integrationstest noch \u00fcberpr\u00fcfen?", "author": "kevinric", "createdAt": "2020-05-14T09:40:28Z", "path": "plugin/src/test/java/io/jenkins/plugins/analysis/warnings/recorder/MiscIssuesRecorderITest.java", "diffHunk": "@@ -468,100 +448,67 @@ public void shouldFindNewCheckStyleWarnings() {\n     }\n \n     private void verifyDetails(final AnalysisResult result) {\n-        HtmlPage details = getWebPage(JavaScriptSupport.JS_ENABLED, result);\n-\n-        PropertyTable categories = new PropertyTable(details, \"category\");\n-        assertThat(categories.getTitle()).isEqualTo(\"Categories\");\n-        assertThat(categories.getColumnName()).isEqualTo(\"Category\");\n-        assertThat(categories.getRows()).containsExactly(\n-                new PropertyRow(\"Blocks\", 2, 100),\n-                new PropertyRow(\"Design\", 1, 50),\n-                new PropertyRow(\"Sizes\", 1, 50));\n-\n-        PropertyTable types = new PropertyTable(details, \"type\");\n-        assertThat(types.getTitle()).isEqualTo(\"Types\");\n-        assertThat(types.getColumnName()).isEqualTo(\"Type\");\n-        assertThat(types.getRows()).containsExactly(\n-                new PropertyRow(\"DesignForExtensionCheck\", 1, 50),\n-                new PropertyRow(\"LineLengthCheck\", 1, 50),\n-                new PropertyRow(\"RightCurlyCheck\", 2, 100));\n-\n-        TablePageObject issues = new TablePageObject(details, \"issues\");\n-        assertThat(issues.getColumnHeaders())\n-                .containsExactly(DETAILS, AFFECTED_FILE, CATEGORY, TYPE, SEVERITY, AGE);\n-\n-        List<TableRowPageObject> rows = issues.getRows();\n-        assertThat(rows).hasSize(4);\n-        assertThat(rows.get(0).getValuesByColumnLabel()).contains(\n-                entry(AFFECTED_FILE, \"CsharpNamespaceDetector.java:22\"),\n-                entry(CATEGORY, \"Design\"),\n-                entry(TYPE, \"DesignForExtensionCheck\"),\n-                entry(SEVERITY, \"Error\"),\n-                entry(AGE, \"2\"));", "originalCommit": "584087592bc8e8073668ea65dceebf38f7ed7fa8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjQyNDY3Nw==", "url": "https://github.com/jenkinsci/warnings-ng-plugin/pull/466#discussion_r426424677", "bodyText": "Statt auf dem Report m\u00fcssten Sie auf dem TableModel validieren:\n        IssuesRow firstRow = getIssuesModel(result, 0);\n        assertThat(firstRow.getFileName().getDisplay())\n                 .isEqualTo(\"CsharpNamespaceDetector.java:29\");\n        assertThat(firstRow).hasAge(\"1\");\n        ...\n\n   private IssuesRow getIssuesModel(final AnalysisResult result, final int rowNumber) {\n        IssuesDetail issuesDetail = (IssuesDetail) result.getOwner().getAction(ResultAction.class).getTarget();\n        Object row = issuesDetail.getTableModel(\"issues\").getRows().get(rowNumber);\n\n        return (IssuesRow) row;\n    }\n\nBeispiele finden sich in der Klasse IssuesModelTest.\nDamit es keine NPE gibt, muss noch die Dependency aktualisiert werden:\nhttps://github.com/jenkinsci/plugin-util-api-plugin/releases/tag/plugin-util-api-1.2.1", "author": "uhafner", "createdAt": "2020-05-18T07:38:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTAwNTU4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "08ca461a4dcce79e02cbc185910aae1e406b65e8", "chunk": "diff --git a/plugin/src/test/java/io/jenkins/plugins/analysis/warnings/recorder/MiscIssuesRecorderITest.java b/plugin/src/test/java/io/jenkins/plugins/analysis/warnings/recorder/MiscIssuesRecorderITest.java\nindex 4bfa97c00..f3f74ace2 100644\n--- a/plugin/src/test/java/io/jenkins/plugins/analysis/warnings/recorder/MiscIssuesRecorderITest.java\n+++ b/plugin/src/test/java/io/jenkins/plugins/analysis/warnings/recorder/MiscIssuesRecorderITest.java\n\n@@ -458,29 +464,30 @@ public class MiscIssuesRecorderITest extends IntegrationTestWithJenkinsPerSuite\n         assertThat(issuesReport.findByProperty(Issue.byType(\"LineLengthCheck\"))).hasSize(1);\n         assertThat(issuesReport.findByProperty(Issue.byType(\"RightCurlyCheck\"))).hasSize(2);\n \n-        assertThat(issuesReport.get(0)).hasBaseName(\"CsharpNamespaceDetector.java\");\n-        assertThat(issuesReport.get(0)).hasLineStart(29);\n-        assertThat(issuesReport.get(0)).hasCategory(\"Sizes\");\n-        assertThat(issuesReport.get(0)).hasType(\"LineLengthCheck\");\n-        assertThat(issuesReport.get(0)).hasSeverity(Severity.ERROR);\n-\n-        assertThat(issuesReport.get(1)).hasBaseName(\"CsharpNamespaceDetector.java\");\n-        assertThat(issuesReport.get(1)).hasLineStart(30);\n-        assertThat(issuesReport.get(1)).hasCategory(\"Blocks\");\n-        assertThat(issuesReport.get(1)).hasType(\"RightCurlyCheck\");\n-        assertThat(issuesReport.get(1)).hasSeverity(Severity.ERROR);\n-\n-        assertThat(issuesReport.get(2)).hasBaseName(\"CsharpNamespaceDetector.java\");\n-        assertThat(issuesReport.get(2)).hasLineStart(37);\n-        assertThat(issuesReport.get(2)).hasCategory(\"Blocks\");\n-        assertThat(issuesReport.get(2)).hasType(\"RightCurlyCheck\");\n-        assertThat(issuesReport.get(2)).hasSeverity(Severity.ERROR);\n-\n-        assertThat(issuesReport.get(3)).hasBaseName(\"CsharpNamespaceDetector.java\");\n-        assertThat(issuesReport.get(3)).hasLineStart(22);\n-        assertThat(issuesReport.get(3)).hasCategory(\"Design\");\n-        assertThat(issuesReport.get(3)).hasType(\"DesignForExtensionCheck\");\n-        assertThat(issuesReport.get(3)).hasSeverity(Severity.ERROR);\n+        assertThatIssuesRowValuesAreCorrect(getIssuesModel(result, 0),\n+                \"CsharpNamespaceDetector.java:29\",\n+                \"Error\",\n+                \"Sizes\",\n+                \"LineLengthCheck\",\n+                \"1\");\n+        assertThatIssuesRowValuesAreCorrect(getIssuesModel(result, 1),\n+                \"CsharpNamespaceDetector.java:30\",\n+                \"Error\",\n+                \"Blocks\",\n+                \"RightCurlyCheck\",\n+                \"1\");\n+        assertThatIssuesRowValuesAreCorrect(getIssuesModel(result, 2),\n+                \"CsharpNamespaceDetector.java:37\",\n+                \"Error\",\n+                \"Blocks\",\n+                \"RightCurlyCheck\",\n+                \"1\");\n+        assertThatIssuesRowValuesAreCorrect(getIssuesModel(result, 3),\n+                \"CsharpNamespaceDetector.java:22\",\n+                \"Error\",\n+                \"Design\",\n+                \"DesignForExtensionCheck\",\n+                \"2\");\n     }\n \n     private void verifyBaselineDetails(final AnalysisResult baseline) {\n"}}, {"oid": "2e2ec1d7256d5bb832748f609e10261f63c3e60a", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/2e2ec1d7256d5bb832748f609e10261f63c3e60a", "message": "update Plugin Utilities to version 1.2.1", "committedDate": "2020-05-18T08:02:15Z", "type": "commit"}, {"oid": "08ca461a4dcce79e02cbc185910aae1e406b65e8", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/08ca461a4dcce79e02cbc185910aae1e406b65e8", "message": "use issues row to check correct values", "committedDate": "2020-05-18T09:13:31Z", "type": "commit"}, {"oid": "ea7c164265c46ca2ebfcf331c26360fe93edf927", "url": "https://github.com/jenkinsci/warnings-ng-plugin/commit/ea7c164265c46ca2ebfcf331c26360fe93edf927", "message": "improve variable names", "committedDate": "2020-05-18T09:26:05Z", "type": "commit"}]}