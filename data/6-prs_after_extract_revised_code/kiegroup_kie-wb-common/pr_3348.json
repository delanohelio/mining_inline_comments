{"pr_number": 3348, "pr_title": "DROOLS-5458 : Project broken after test scenario run with possibly a class-loading issue", "pr_createdAt": "2020-07-01T09:29:59Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3348", "timeline": [{"oid": "fa6ecab860e601d786f76741fa5c4ab25fb3968a", "url": "https://github.com/kiegroup/kie-wb-common/commit/fa6ecab860e601d786f76741fa5c4ab25fb3968a", "message": "more", "committedDate": "2020-07-02T09:48:01Z", "type": "forcePushed"}, {"oid": "c9c99048ad831f9d40e5c98aae67a77e5d5c4bd2", "url": "https://github.com/kiegroup/kie-wb-common/commit/c9c99048ad831f9d40e5c98aae67a77e5d5c4bd2", "message": "DROOLS-5458 : Project broken after test scenario run with possibly a class-loading issue", "committedDate": "2020-07-02T14:52:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYwOTk5Nw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3348#discussion_r449609997", "bodyText": "@Rikkola It could have sense to put here a comment explaining why we need to clone it? eg. Cloning is required to guarantee synchronization of the Buider info? WDYT?", "author": "yesamer", "createdAt": "2020-07-03T14:27:01Z", "path": "kie-wb-common-services/kie-wb-common-services-backend/src/main/java/org/kie/workbench/common/services/backend/session/SessionServiceImpl.java", "diffHunk": "@@ -67,4 +70,13 @@ public KieSession newDefaultKieSessionWithPseudoClock(final KieModule project) {\n \n         return kieContainer.getKieBase().newKieSession(conf, null);\n     }\n+", "originalCommit": "c9c99048ad831f9d40e5c98aae67a77e5d5c4bd2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4b63598b3e73af349aa4b942c639dbe6ef84c11d", "chunk": "diff --git a/kie-wb-common-services/kie-wb-common-services-backend/src/main/java/org/kie/workbench/common/services/backend/session/SessionServiceImpl.java b/kie-wb-common-services/kie-wb-common-services-backend/src/main/java/org/kie/workbench/common/services/backend/session/SessionServiceImpl.java\nindex 28d2618ac6..715b009103 100644\n--- a/kie-wb-common-services/kie-wb-common-services-backend/src/main/java/org/kie/workbench/common/services/backend/session/SessionServiceImpl.java\n+++ b/kie-wb-common-services/kie-wb-common-services-backend/src/main/java/org/kie/workbench/common/services/backend/session/SessionServiceImpl.java\n\n@@ -72,8 +72,9 @@ public class SessionServiceImpl\n     }\n \n     private KieContainer getKieContainer(final KieModule project) {\n-        BuildInfo buildInfo = buildInfoService.getBuildInfo(project);\n+        final BuildInfo buildInfo = buildInfoService.getBuildInfo(project);\n         if (buildInfo instanceof BuildInfoImpl) {\n+            // The kie builder needs to be cloned so that the original does not get altered.\n             final Builder clone = ((BuildInfoImpl) buildInfo).getBuilder().clone();\n             return clone.getKieContainer();\n         }\n"}}, {"oid": "4b63598b3e73af349aa4b942c639dbe6ef84c11d", "url": "https://github.com/kiegroup/kie-wb-common/commit/4b63598b3e73af349aa4b942c639dbe6ef84c11d", "message": "DROOLS-5458 : Project broken after test scenario run with possibly a class-loading issue", "committedDate": "2020-07-06T08:53:15Z", "type": "forcePushed"}, {"oid": "04764c519223089c0fc16c6824e0d1a94ceeeee6", "url": "https://github.com/kiegroup/kie-wb-common/commit/04764c519223089c0fc16c6824e0d1a94ceeeee6", "message": "DROOLS-5458 : Project broken after test scenario run with possibly a class-loading issue", "committedDate": "2020-07-08T15:42:14Z", "type": "commit"}, {"oid": "04764c519223089c0fc16c6824e0d1a94ceeeee6", "url": "https://github.com/kiegroup/kie-wb-common/commit/04764c519223089c0fc16c6824e0d1a94ceeeee6", "message": "DROOLS-5458 : Project broken after test scenario run with possibly a class-loading issue", "committedDate": "2020-07-08T15:42:14Z", "type": "forcePushed"}]}