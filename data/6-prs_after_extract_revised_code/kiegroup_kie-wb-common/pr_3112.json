{"pr_number": 3112, "pr_title": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error", "pr_createdAt": "2020-01-14T22:23:21Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3112", "timeline": [{"oid": "1d1f8b71af761245a7d7fc95607e131482050c8d", "url": "https://github.com/kiegroup/kie-wb-common/commit/1d1f8b71af761245a7d7fc95607e131482050c8d", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error", "committedDate": "2020-01-21T02:48:29Z", "type": "forcePushed"}, {"oid": "3a2c400e21a63055e84de0551d336939f6e63dde", "url": "https://github.com/kiegroup/kie-wb-common/commit/3a2c400e21a63055e84de0551d336939f6e63dde", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error", "committedDate": "2020-01-21T05:03:13Z", "type": "forcePushed"}, {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb", "url": "https://github.com/kiegroup/kie-wb-common/commit/18ee9ed1036baa58fe0cd922f470a841524717eb", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error", "committedDate": "2020-01-21T23:02:53Z", "type": "commit"}, {"oid": "18ee9ed1036baa58fe0cd922f470a841524717eb", "url": "https://github.com/kiegroup/kie-wb-common/commit/18ee9ed1036baa58fe0cd922f470a841524717eb", "message": "JBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error\n\nJBPM-8977: BPMN Editor removes output variables from task without alerting or throwing error", "committedDate": "2020-01-21T23:02:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2MDc4MA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112#discussion_r369860780", "bodyText": "All code inside the forEach is exaclly the same for backend as for client side marshallers, right? If so, would be possible to move it to some util class, in the bpmn-api module, so will be available on both sides, and we'll be able to write it just once. Makes sense?", "author": "romartin", "createdAt": "2020-01-22T23:24:29Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-sets/kie-wb-common-stunner-bpmn/kie-wb-common-stunner-bpmn-marshalling/src/main/java/org/kie/workbench/common/stunner/bpmn/client/marshall/converters/customproperties/ParsedAssignmentsInfo.java", "diffHunk": "@@ -196,15 +197,30 @@ public AssociationList getAssociations() {\n     }\n \n     public List<InitializedOutputVariable> createInitializedOutputVariables(String parentId, VariableScope variableScope) {\n-        return getOutputs()\n+        List<InitializedOutputVariable> initializedOutputVariables = new ArrayList<>();\n+\n+        getOutputs()\n                 .getDeclarations()\n-                .stream()\n-                .map(varDecl -> InitializedVariable.outputOf(\n-                        parentId,\n-                        variableScope,\n-                        varDecl,\n-                        associations.lookupOutput(varDecl.getTypedIdentifier().getName())))\n-                .collect(Collectors.toList());\n+                .forEach(varDecl -> {\n+                    if (associations.lookupOutputs(varDecl.getTypedIdentifier().getName()).isEmpty()) {", "originalCommit": "18ee9ed1036baa58fe0cd922f470a841524717eb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTMzMTAyNg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3112#discussion_r371331026", "bodyText": "@romartin I worked on moving the code to a bmpn-api. However,  in this specific case there are a few classes consumed by the method that also need to be moved to get the method working. I could't get it working without creating more duplicated code. I believe the code is good to go as is. Anyway I'm opened to new ideas.", "author": "handreyrc", "createdAt": "2020-01-27T16:06:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTg2MDc4MA=="}], "type": "inlineReview", "revised_code": null}]}