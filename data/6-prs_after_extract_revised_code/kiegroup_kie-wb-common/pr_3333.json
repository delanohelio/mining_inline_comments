{"pr_number": 3333, "pr_title": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests", "pr_createdAt": "2020-06-16T13:20:12Z", "pr_url": "https://github.com/kiegroup/kie-wb-common/pull/3333", "timeline": [{"oid": "eff2edc40eea2e9b0b183945fe5220b6d600a25c", "url": "https://github.com/kiegroup/kie-wb-common/commit/eff2edc40eea2e9b0b183945fe5220b6d600a25c", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2020-06-17T15:37:46Z", "type": "forcePushed"}, {"oid": "3657d4fb278288ee7c16af7f08cb2cb1ee9f8236", "url": "https://github.com/kiegroup/kie-wb-common/commit/3657d4fb278288ee7c16af7f08cb2cb1ee9f8236", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2020-06-17T15:38:27Z", "type": "forcePushed"}, {"oid": "da1577a376880fa346157cd18974e2772b3ce8b4", "url": "https://github.com/kiegroup/kie-wb-common/commit/da1577a376880fa346157cd18974e2772b3ce8b4", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2020-06-17T15:39:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTcwNjExNQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r441706115", "bodyText": "I wouldn't prefix with 'qe-' to make this shorter - the data-ouia prefix of attribute says it all - for use during testing.", "author": "jstastny-cz", "createdAt": "2020-06-17T17:22:31Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java", "diffHunk": "@@ -71,4 +77,19 @@ public void addClickHandler(final Command command) {\n                               (e) -> command.execute(),\n                               false);\n     }\n+\n+    @Override\n+    public OuiaComponentTypeAttribute ouiaComponentType() {\n+        return new OuiaComponentTypeAttribute(\"qe-dmn-grid-context-menu-item\");", "originalCommit": "da1577a376880fa346157cd18974e2772b3ce8b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk3OTM1OQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r441979359", "bodyText": "@jstastny-cz yes, I was not sure if to prefix or not. In final I decided to prefix as in past similar initiative using 'qe-' prefix was done. However that time 'class' attribute was used.\nI agree with you this time attribute name explains the purpose and the 'qe-' prefix is not needed anymore.", "author": "jomarko", "createdAt": "2020-06-18T05:39:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTcwNjExNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk4MTYxMQ==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r441981611", "bodyText": "changes are in", "author": "jomarko", "createdAt": "2020-06-18T05:47:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTcwNjExNQ=="}], "type": "inlineReview", "revised_code": {"commit": "a40a6de5f57487873d9ec648abb11e1f6fc0cc7a", "chunk": "diff --git a/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java b/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java\nindex cd24004e43..33417607c9 100644\n--- a/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java\n+++ b/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java\n\n@@ -80,12 +80,12 @@ public class ListSelectorTextItemViewImpl implements ListSelectorTextItemView {\n \n     @Override\n     public OuiaComponentTypeAttribute ouiaComponentType() {\n-        return new OuiaComponentTypeAttribute(\"qe-dmn-grid-context-menu-item\");\n+        return new OuiaComponentTypeAttribute(\"dmn-grid-context-menu-item\");\n     }\n \n     @Override\n     public OuiaComponentIdAttribute ouiaComponentId() {\n-        return new OuiaComponentIdAttribute(\"qe-dmn-grid-context-menu-item-\" + text.getTextContent());\n+        return new OuiaComponentIdAttribute(\"dmn-grid-context-menu-item-\" + text.getTextContent());\n     }\n \n     @Override\n"}}, {"oid": "a40a6de5f57487873d9ec648abb11e1f6fc0cc7a", "url": "https://github.com/kiegroup/kie-wb-common/commit/a40a6de5f57487873d9ec648abb11e1f6fc0cc7a", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2020-06-18T05:45:35Z", "type": "forcePushed"}, {"oid": "614b4a0f32f2d0a1b4ecb3f2d5433255a2ba64ee", "url": "https://github.com/kiegroup/kie-wb-common/commit/614b4a0f32f2d0a1b4ecb3f2d5433255a2ba64ee", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2020-06-18T05:45:52Z", "type": "forcePushed"}, {"oid": "89bb08e3001b0d384beb3f57a59bfa560dfd1dac", "url": "https://github.com/kiegroup/kie-wb-common/commit/89bb08e3001b0d384beb3f57a59bfa560dfd1dac", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2020-06-18T18:52:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk5NDg2Mg==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r491994862", "bodyText": "Is it ok to return \"dmn-graph-navigator-expression\" if getItem() == null?", "author": "caponetto", "createdAt": "2020-09-21T12:12:29Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/docks/navigator/tree/DecisionNavigatorTreeView.java", "diffHunk": "@@ -260,10 +266,33 @@ public TreeItem setup(final DecisionNavigatorItem item,\n             updateCSSClass();\n             updateLabel();\n             updateSubItems(children);\n-\n+            initOuiaComponentAttributes();\n             return this;\n         }\n \n+        @Override\n+        public Consumer<OuiaAttribute> ouiaAttributeRenderer() {\n+            return ouiaAttribute -> getElement().setAttribute(ouiaAttribute.getName(), ouiaAttribute.getValue());\n+        }\n+\n+        @Override\n+        public OuiaComponentTypeAttribute ouiaComponentType() {\n+            return new OuiaComponentTypeAttribute(componentType());\n+        }\n+\n+        @Override\n+        public OuiaComponentIdAttribute ouiaComponentId() {\n+            return new OuiaComponentIdAttribute(componentType() + \"-\" + getItem().getLabel());\n+        }\n+\n+        private String componentType() {\n+            if (getItem() != null && !getItem().getChildren().isEmpty()) {\n+                return \"dmn-graph-navigator-node\";\n+            } else {\n+                return \"dmn-graph-navigator-expression\";", "originalCommit": "89bb08e3001b0d384beb3f57a59bfa560dfd1dac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyMjkwMw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r536122903", "bodyText": "@caponetto good point, thank you, I agree this way is not ideal and could confuse other developers. I tried to rewrite this logic to make more understandable. Please re-review once I push the changes.", "author": "jomarko", "createdAt": "2020-12-04T14:05:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk5NDg2Mg=="}], "type": "inlineReview", "revised_code": {"commit": "e5808d6d55de51f0885d015e642100dc201e93d0", "chunk": "diff --git a/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/docks/navigator/tree/DecisionNavigatorTreeView.java b/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/docks/navigator/tree/DecisionNavigatorTreeView.java\nindex 2db4a0cefa..b2332e95b4 100644\n--- a/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/docks/navigator/tree/DecisionNavigatorTreeView.java\n+++ b/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/docks/navigator/tree/DecisionNavigatorTreeView.java\n\n@@ -286,10 +288,10 @@ public class DecisionNavigatorTreeView implements DecisionNavigatorTreePresenter\n         }\n \n         private String componentType() {\n-            if (getItem() != null && !getItem().getChildren().isEmpty()) {\n-                return \"dmn-graph-navigator-node\";\n+            if (getItem() != null) {\n+                return \"dmn-graph-navigator-\" + getItem().getType().name().toLowerCase();\n             } else {\n-                return \"dmn-graph-navigator-expression\";\n+                throw new IllegalStateException(\"Decision Navigator item can not be null\");\n             }\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk5NzA3OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r491997078", "bodyText": "Shouldn't this init call be in a setup method or something like this? It seems weird to me an init inside setText.", "author": "caponetto", "createdAt": "2020-09-21T12:16:40Z", "path": "kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java", "diffHunk": "@@ -53,6 +58,7 @@ public ListSelectorTextItemViewImpl(final ListItem item,\n     @Override\n     public void setText(final String text) {\n         this.text.setTextContent(text);\n+        initOuiaComponentAttributes();", "originalCommit": "89bb08e3001b0d384beb3f57a59bfa560dfd1dac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEyNTI1Mw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r536125253", "bodyText": "@caponetto good point, I will move this initOuiaComponentAttributes() into constructor; However still on this line I will need to update ouiaComponentId because it depends on the text. Please rereview once I push the changes. Thank you.", "author": "jomarko", "createdAt": "2020-12-04T14:09:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTk5NzA3OA=="}], "type": "inlineReview", "revised_code": {"commit": "e5808d6d55de51f0885d015e642100dc201e93d0", "chunk": "diff --git a/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java b/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java\nindex 33417607c9..4577b2c221 100644\n--- a/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java\n+++ b/kie-wb-common-dmn/kie-wb-common-dmn-client/src/main/java/org/kie/workbench/common/dmn/client/widgets/grid/controls/list/ListSelectorTextItemViewImpl.java\n\n@@ -53,12 +53,13 @@ public class ListSelectorTextItemViewImpl implements ListSelectorTextItemView {\n                                         final Span text) {\n         this.item = item;\n         this.text = text;\n+        initOuiaComponentAttributes();\n     }\n \n     @Override\n     public void setText(final String text) {\n         this.text.setTextContent(text);\n-        initOuiaComponentAttributes();\n+        ouiaAttributeRenderer().accept(ouiaComponentId());\n     }\n \n     @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAwMDMzNw==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r492000337", "bodyText": "Isn't the responsibility of the item calling its own initOuiaComponentAttributes internally?\nAt least, this is what I have been observing on the other ouia components.", "author": "caponetto", "createdAt": "2020-09-21T12:22:31Z", "path": "kie-wb-common-stunner/kie-wb-common-stunner-client/kie-wb-common-stunner-widgets/src/main/java/org/kie/workbench/common/stunner/client/widgets/explorer/tree/TreeExplorerView.java", "diffHunk": "@@ -195,6 +195,7 @@ private TreeItem buildItem(final String uuid,\n                                            icon);\n         item.setUserObject(uuid);\n         item.getElement().getStyle().setCursor(Style.Cursor.POINTER);\n+        item.initOuiaComponentAttributes();", "originalCommit": "89bb08e3001b0d384beb3f57a59bfa560dfd1dac", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjEzMDA0OA==", "url": "https://github.com/kiegroup/kie-wb-common/pull/3333#discussion_r536130048", "bodyText": "true, will try to move it directly into TreeItem, thank you", "author": "jomarko", "createdAt": "2020-12-04T14:16:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjAwMDMzNw=="}], "type": "inlineReview", "revised_code": {"commit": "e5808d6d55de51f0885d015e642100dc201e93d0", "chunk": "diff --git a/kie-wb-common-stunner/kie-wb-common-stunner-client/kie-wb-common-stunner-widgets/src/main/java/org/kie/workbench/common/stunner/client/widgets/explorer/tree/TreeExplorerView.java b/kie-wb-common-stunner/kie-wb-common-stunner-client/kie-wb-common-stunner-widgets/src/main/java/org/kie/workbench/common/stunner/client/widgets/explorer/tree/TreeExplorerView.java\nindex 90001b67b0..8d57d0f421 100644\n--- a/kie-wb-common-stunner/kie-wb-common-stunner-client/kie-wb-common-stunner-widgets/src/main/java/org/kie/workbench/common/stunner/client/widgets/explorer/tree/TreeExplorerView.java\n+++ b/kie-wb-common-stunner/kie-wb-common-stunner-client/kie-wb-common-stunner-widgets/src/main/java/org/kie/workbench/common/stunner/client/widgets/explorer/tree/TreeExplorerView.java\n\n@@ -195,7 +195,6 @@ public class TreeExplorerView extends Composite implements TreeExplorer.View {\n                                            icon);\n         item.setUserObject(uuid);\n         item.getElement().getStyle().setCursor(Style.Cursor.POINTER);\n-        item.initOuiaComponentAttributes();\n         return item;\n     }\n \n"}}, {"oid": "e5808d6d55de51f0885d015e642100dc201e93d0", "url": "https://github.com/kiegroup/kie-wb-common/commit/e5808d6d55de51f0885d015e642100dc201e93d0", "message": "peer feedback: ouia attributes initialization simplification", "committedDate": "2020-12-04T16:18:41Z", "type": "forcePushed"}, {"oid": "bfc36850863a8e2a15554cf6dd741666231ab9d6", "url": "https://github.com/kiegroup/kie-wb-common/commit/bfc36850863a8e2a15554cf6dd741666231ab9d6", "message": "peer feedback: ouia attributes initialization simplification", "committedDate": "2021-01-05T11:30:02Z", "type": "forcePushed"}, {"oid": "cd7da354cb657e28898aebfa6efb0ea2365559e0", "url": "https://github.com/kiegroup/kie-wb-common/commit/cd7da354cb657e28898aebfa6efb0ea2365559e0", "message": "KOGITO-204: Introduce OUIA attributes to unify kogito integration tests\n\nFor more details see: https://issues.redhat.com/browse/KOGITO-204", "committedDate": "2021-01-13T15:56:57Z", "type": "commit"}, {"oid": "88fb92358252c1d7e6ddcfcfb42890ffa6e58372", "url": "https://github.com/kiegroup/kie-wb-common/commit/88fb92358252c1d7e6ddcfcfb42890ffa6e58372", "message": "peer feedback: ouia attributes initialization simplification", "committedDate": "2021-01-13T15:56:58Z", "type": "commit"}, {"oid": "8480283648356a6ec5d0e7893345e1e25fd9a176", "url": "https://github.com/kiegroup/kie-wb-common/commit/8480283648356a6ec5d0e7893345e1e25fd9a176", "message": "fix selenium tests", "committedDate": "2021-01-13T15:56:58Z", "type": "commit"}, {"oid": "8480283648356a6ec5d0e7893345e1e25fd9a176", "url": "https://github.com/kiegroup/kie-wb-common/commit/8480283648356a6ec5d0e7893345e1e25fd9a176", "message": "fix selenium tests", "committedDate": "2021-01-13T15:56:58Z", "type": "forcePushed"}]}