{"pr_number": 7486, "pr_title": "IGNITE-12733: TransmissionHandler can now notify user listeners when it ends", "pr_createdAt": "2020-03-02T13:40:43Z", "pr_url": "https://github.com/apache/ignite/pull/7486", "timeline": [{"oid": "921054ecfb8d425a12923fdbc909885f68dcd513", "url": "https://github.com/apache/ignite/commit/921054ecfb8d425a12923fdbc909885f68dcd513", "message": "IGNITE-12733: TransmissionHandler can now notify user listeners when it ends", "committedDate": "2020-03-02T13:39:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc5OTY0Mg==", "url": "https://github.com/apache/ignite/pull/7486#discussion_r387799642", "bodyText": "\"session is freed\"", "author": "xtern", "createdAt": "2020-03-04T16:53:47Z", "path": "modules/core/src/main/java/org/apache/ignite/internal/managers/communication/TransmissionHandler.java", "diffHunk": "@@ -40,6 +40,15 @@\n  * {@link TransmissionPolicy#CHUNK} the <em>#chunkHandler()</em> will be picked up.\n  */\n public interface TransmissionHandler {\n+    /**\n+     * The end of the handled transmission. This means that all resources associated with previously opened\n+     * session are freed and can be reused. Generally, it means that transmission topic from now can", "originalCommit": "921054ecfb8d425a12923fdbc909885f68dcd513", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0NjI5MQ==", "url": "https://github.com/apache/ignite/pull/7486#discussion_r387846291", "bodyText": "fixed", "author": "Mmuzaf", "createdAt": "2020-03-04T18:17:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc5OTY0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "54e4621343f841a4649ac4904334d66f24011ca0", "chunk": "diff --git a/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/TransmissionHandler.java b/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/TransmissionHandler.java\nindex bdff415fa7..6ac0737ac6 100644\n--- a/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/TransmissionHandler.java\n+++ b/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/TransmissionHandler.java\n\n@@ -42,7 +42,7 @@ import java.util.function.Consumer;\n public interface TransmissionHandler {\n     /**\n      * The end of the handled transmission. This means that all resources associated with previously opened\n-     * session are freed and can be reused. Generally, it means that transmission topic from now can\n+     * session is freed and can be reused. Generally, it means that transmission topic from now can\n      * safely accept new files.\n      *\n      * @param rmtNodeId Remote node id from which the source request comes from.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgwNTg2MQ==", "url": "https://github.com/apache/ignite/pull/7486#discussion_r387805861", "bodyText": "Why not name this variable simply \"rcv\" (instead of rcv0)?", "author": "xtern", "createdAt": "2020-03-04T17:03:58Z", "path": "modules/core/src/main/java/org/apache/ignite/internal/managers/communication/GridIoManager.java", "diffHunk": "@@ -2835,7 +2835,11 @@ private void receiveFromChannel(\n                 boolean exit = in.readBoolean();\n \n                 if (exit) {\n-                    rcvCtxs.remove(topic);\n+                    ReceiverContext rcv0 = rcvCtxs.remove(topic);", "originalCommit": "921054ecfb8d425a12923fdbc909885f68dcd513", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzg0NjM1Nw==", "url": "https://github.com/apache/ignite/pull/7486#discussion_r387846357", "bodyText": "fixed", "author": "Mmuzaf", "createdAt": "2020-03-04T18:17:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzgwNTg2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "54e4621343f841a4649ac4904334d66f24011ca0", "chunk": "diff --git a/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/GridIoManager.java b/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/GridIoManager.java\nindex 81a2edf450..df353ded72 100644\n--- a/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/GridIoManager.java\n+++ b/modules/core/src/main/java/org/apache/ignite/internal/managers/communication/GridIoManager.java\n\n@@ -2835,11 +2835,11 @@ public class GridIoManager extends GridManagerAdapter<CommunicationSpi<Serializa\n                 boolean exit = in.readBoolean();\n \n                 if (exit) {\n-                    ReceiverContext rcv0 = rcvCtxs.remove(topic);\n+                    ReceiverContext rcv = rcvCtxs.remove(topic);\n \n-                    assert rcv0 != null;\n+                    assert rcv != null;\n \n-                    rcv0.hnd.onEnd(rcv0.rmtNodeId);\n+                    rcv.hnd.onEnd(rcv.rmtNodeId);\n \n                     break;\n                 }\n"}}, {"oid": "54e4621343f841a4649ac4904334d66f24011ca0", "url": "https://github.com/apache/ignite/commit/54e4621343f841a4649ac4904334d66f24011ca0", "message": "IGNITE-12733: fix review comments", "committedDate": "2020-03-04T18:16:52Z", "type": "commit"}, {"oid": "1c4514a1ceda83c8f16e7c15ef92fafedb8ad5a6", "url": "https://github.com/apache/ignite/commit/1c4514a1ceda83c8f16e7c15ef92fafedb8ad5a6", "message": "IGNITE-12733: sort handler methods", "committedDate": "2020-03-06T13:26:13Z", "type": "commit"}]}