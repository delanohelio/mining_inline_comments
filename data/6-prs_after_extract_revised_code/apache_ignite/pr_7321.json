{"pr_number": 7321, "pr_title": "IGNITE-12590 fix (remove) check KEY at the MERGE command", "pr_createdAt": "2020-01-28T11:16:51Z", "pr_url": "https://github.com/apache/ignite/pull/7321", "timeline": [{"oid": "3fcbd85e295f6bc0297ea0a0c06be94023976157", "url": "https://github.com/apache/ignite/commit/3fcbd85e295f6bc0297ea0a0c06be94023976157", "message": "IGNITE-12590 fix (remove) check KEY at the MERGE command", "committedDate": "2020-01-28T11:16:20Z", "type": "commit"}, {"oid": "48d1f920ae9b7f04e3b6e5dd762766311afe8498", "url": "https://github.com/apache/ignite/commit/48d1f920ae9b7f04e3b6e5dd762766311afe8498", "message": "Merge branch 'apache-master' into ignite-12590", "committedDate": "2020-02-07T10:15:20Z", "type": "commit"}, {"oid": "e509783c846f806f7a3f53ced46285e67a999c13", "url": "https://github.com/apache/ignite/commit/e509783c846f806f7a3f53ced46285e67a999c13", "message": "fix import", "committedDate": "2020-02-07T10:15:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE2NTY5Ng==", "url": "https://github.com/apache/ignite/pull/7321#discussion_r378165696", "bodyText": "Looks like indentation is broken.", "author": "pavlukhin", "createdAt": "2020-02-12T10:32:58Z", "path": "modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java", "diffHunk": "@@ -416,9 +416,9 @@ private QueryParserResult parseH2(String schemaName, SqlFieldsQuery qry, boolean\n                 throw new IgniteSQLException(\"Failed to get parameters metadata\", IgniteQueryErrorCode.UNKNOWN, e);\n             }\n \n-            // Do actual parsing.\n-            if (CommandProcessor.isCommand(prepared)) {\n-                GridSqlStatement cmdH2 = new GridSqlQueryParser(false).parse(prepared);\n+                // Do actual parsing.\n+                if (CommandProcessor.isCommand(prepared)) {\n+                    GridSqlStatement cmdH2 = new GridSqlQueryParser(false, log).parse(prepared);", "originalCommit": "e509783c846f806f7a3f53ced46285e67a999c13", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "eaa84c7dc775447e1e209ad1237217ae986a9b1d", "chunk": "diff --git a/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java b/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java\nindex 25d11415e5..22b4114c65 100644\n--- a/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java\n+++ b/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java\n\n@@ -416,9 +416,9 @@ public class QueryParser {\n                 throw new IgniteSQLException(\"Failed to get parameters metadata\", IgniteQueryErrorCode.UNKNOWN, e);\n             }\n \n-                // Do actual parsing.\n-                if (CommandProcessor.isCommand(prepared)) {\n-                    GridSqlStatement cmdH2 = new GridSqlQueryParser(false, log).parse(prepared);\n+            // Do actual parsing.\n+            if (CommandProcessor.isCommand(prepared)) {\n+                GridSqlStatement cmdH2 = new GridSqlQueryParser(false, log).parse(prepared);\n \n                 QueryParserResultCommand cmd = new QueryParserResultCommand(null, cmdH2, false);\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE2NTc5OQ==", "url": "https://github.com/apache/ignite/pull/7321#discussion_r378165799", "bodyText": "Looks like indentation is broken.", "author": "pavlukhin", "createdAt": "2020-02-12T10:33:11Z", "path": "modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java", "diffHunk": "@@ -463,8 +463,8 @@ else if (!prepared.isQuery()) {\n                     IgniteQueryErrorCode.UNSUPPORTED_OPERATION);\n             }\n \n-            // Parse SELECT.\n-            GridSqlQueryParser parser = new GridSqlQueryParser(false);\n+                // Parse SELECT.\n+                GridSqlQueryParser parser = new GridSqlQueryParser(false, log);", "originalCommit": "e509783c846f806f7a3f53ced46285e67a999c13", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "eaa84c7dc775447e1e209ad1237217ae986a9b1d", "chunk": "diff --git a/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java b/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java\nindex 25d11415e5..22b4114c65 100644\n--- a/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java\n+++ b/modules/indexing/src/main/java/org/apache/ignite/internal/processors/query/h2/QueryParser.java\n\n@@ -463,8 +463,8 @@ public class QueryParser {\n                     IgniteQueryErrorCode.UNSUPPORTED_OPERATION);\n             }\n \n-                // Parse SELECT.\n-                GridSqlQueryParser parser = new GridSqlQueryParser(false, log);\n+            // Parse SELECT.\n+            GridSqlQueryParser parser = new GridSqlQueryParser(false, log);\n \n             GridSqlQuery selectStmt = (GridSqlQuery)parser.parse(prepared);\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODE2NzU4Mw==", "url": "https://github.com/apache/ignite/pull/7321#discussion_r378167583", "bodyText": "Were these test classes added to two test suites intentionally? (here and IgniteBinaryCacheQueryTestSuite)", "author": "pavlukhin", "createdAt": "2020-02-12T10:36:35Z", "path": "modules/indexing/src/test/java/org/apache/ignite/testsuites/IgniteBinaryCacheQueryTestSuite2.java", "diffHunk": "@@ -82,6 +84,9 @@\n  */\n @RunWith(Suite.class)\n @Suite.SuiteClasses({\n+    SqlMergeTest.class,\n+    SqlMergeOnClientNodeTest.class,", "originalCommit": "e509783c846f806f7a3f53ced46285e67a999c13", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "eaa84c7dc775447e1e209ad1237217ae986a9b1d", "chunk": "diff --git a/modules/indexing/src/test/java/org/apache/ignite/testsuites/IgniteBinaryCacheQueryTestSuite2.java b/modules/indexing/src/test/java/org/apache/ignite/testsuites/IgniteBinaryCacheQueryTestSuite2.java\nindex f28625110c..35b57b9460 100644\n--- a/modules/indexing/src/test/java/org/apache/ignite/testsuites/IgniteBinaryCacheQueryTestSuite2.java\n+++ b/modules/indexing/src/test/java/org/apache/ignite/testsuites/IgniteBinaryCacheQueryTestSuite2.java\n\n@@ -84,9 +82,6 @@ import org.junit.runners.Suite;\n  */\n @RunWith(Suite.class)\n @Suite.SuiteClasses({\n-    SqlMergeTest.class,\n-    SqlMergeOnClientNodeTest.class,\n-\n     SqlCacheStartStopTest.class,\n \n     SqlIndexConsistencyAfterInterruptAtomicCacheOperationTest.class,\n"}}, {"oid": "784cee97a259d3ff2c5ed5c3e0f0b92b05d4357a", "url": "https://github.com/apache/ignite/commit/784cee97a259d3ff2c5ed5c3e0f0b92b05d4357a", "message": "Merge branch 'apache-master' into ignite-12590", "committedDate": "2020-02-13T09:04:32Z", "type": "commit"}, {"oid": "eaa84c7dc775447e1e209ad1237217ae986a9b1d", "url": "https://github.com/apache/ignite/commit/eaa84c7dc775447e1e209ad1237217ae986a9b1d", "message": "fix review issues", "committedDate": "2020-02-13T09:09:32Z", "type": "commit"}]}