{"pr_number": 7542, "pr_title": "IGNITE-12768: MetricRegistryMBean doesn't show histogram values in case when histogram name contains underscore character", "pr_createdAt": "2020-03-17T16:55:34Z", "pr_url": "https://github.com/apache/ignite/pull/7542", "timeline": [{"oid": "cfe85e3b207261d934764d51049fef89a83ba4e1", "url": "https://github.com/apache/ignite/commit/cfe85e3b207261d934764d51049fef89a83ba4e1", "message": "IGNITE-12768: MetricRegistryMBean doesn't show histogram values in case when histogram name contains underscore character", "committedDate": "2020-03-17T16:53:47Z", "type": "commit"}, {"oid": "3593c32256c9146653d3ef660f66f92692d2d9f6", "url": "https://github.com/apache/ignite/commit/3593c32256c9146653d3ef660f66f92692d2d9f6", "message": "IGNITE-12768: MetricRegistryMBean doesn't show histogram values in case when histogram name contains underscore character", "committedDate": "2020-03-17T17:06:34Z", "type": "commit"}, {"oid": "39575a149fd944733d5269a9e4352e83a1c07acd", "url": "https://github.com/apache/ignite/commit/39575a149fd944733d5269a9e4352e83a1c07acd", "message": "IGNITE-12768: MetricRegistryMBean doesn't show histogram values in case when histogram name contains underscore character", "committedDate": "2020-03-17T17:07:14Z", "type": "commit"}, {"oid": "d1c3fe9eaa7b81d118ca16e2394c8f6e814eb23b", "url": "https://github.com/apache/ignite/commit/d1c3fe9eaa7b81d118ca16e2394c8f6e814eb23b", "message": "IGNITE-12768: MetricRegistryMBean doesn't show histogram values in case when histogram name contains underscore character", "committedDate": "2020-03-17T17:10:39Z", "type": "commit"}, {"oid": "8731b30f6ddea4ea664048b19430b028f1e04212", "url": "https://github.com/apache/ignite/commit/8731b30f6ddea4ea664048b19430b028f1e04212", "message": "IGNITE-12768: NumberFormatException handling.", "committedDate": "2020-03-18T06:23:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE4NDk1Ng==", "url": "https://github.com/apache/ignite/pull/7542#discussion_r394184956", "bodyText": "Unnecessary brackets", "author": "NSAmelchev", "createdAt": "2020-03-18T08:47:20Z", "path": "modules/core/src/main/java/org/apache/ignite/spi/metric/jmx/MetricRegistryMBean.java", "diffHunk": "@@ -155,12 +155,26 @@ else if (metric instanceof ObjectMetric)\n      * @see MetricUtils#histogramBucketNames(HistogramMetric, Map)\n      */\n     public static Long searchHistogram(String name, ReadOnlyMetricRegistry mreg) {\n-        Scanner sc = new Scanner(name).useDelimiter(\"_\");\n+        int highBoundIdx;\n \n-        if (!sc.hasNext())\n+        boolean isInf = name.endsWith(INF);\n+\n+        if (isInf) {", "originalCommit": "8731b30f6ddea4ea664048b19430b028f1e04212", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE5MzA1Nw==", "url": "https://github.com/apache/ignite/pull/7542#discussion_r394193057", "bodyText": "fixed.", "author": "nizhikov", "createdAt": "2020-03-18T09:02:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE4NDk1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "7a2f98f07fb19f4627a3e873e12b3ca58b86df02", "chunk": "diff --git a/modules/core/src/main/java/org/apache/ignite/spi/metric/jmx/MetricRegistryMBean.java b/modules/core/src/main/java/org/apache/ignite/spi/metric/jmx/MetricRegistryMBean.java\nindex 02f9b5b427..d1d348a5da 100644\n--- a/modules/core/src/main/java/org/apache/ignite/spi/metric/jmx/MetricRegistryMBean.java\n+++ b/modules/core/src/main/java/org/apache/ignite/spi/metric/jmx/MetricRegistryMBean.java\n\n@@ -159,9 +159,8 @@ public class MetricRegistryMBean extends ReadOnlyDynamicMBean {\n \n         boolean isInf = name.endsWith(INF);\n \n-        if (isInf) {\n+        if (isInf)\n             highBoundIdx = name.length() - 4;\n-        }\n         else {\n             highBoundIdx = name.lastIndexOf(HISTOGRAM_NAME_DIVIDER);\n \n"}}, {"oid": "7a2f98f07fb19f4627a3e873e12b3ca58b86df02", "url": "https://github.com/apache/ignite/commit/7a2f98f07fb19f4627a3e873e12b3ca58b86df02", "message": "IGNITE-12768: code style fixes.", "committedDate": "2020-03-18T08:59:54Z", "type": "commit"}]}