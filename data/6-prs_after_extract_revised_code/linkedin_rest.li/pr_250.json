{"pr_number": 250, "pr_title": "Add support for custom properties on anonymous complex schemas.", "pr_createdAt": "2020-04-03T21:06:40Z", "pr_url": "https://github.com/linkedin/rest.li/pull/250", "timeline": [{"oid": "dee9d18c97b4e39ab54c916aced8e7bc9aa7ea09", "url": "https://github.com/linkedin/rest.li/commit/dee9d18c97b4e39ab54c916aced8e7bc9aa7ea09", "message": "Add support for custom properties on anonymous complex schemas.", "committedDate": "2020-04-03T21:09:08Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NTAzMQ==", "url": "https://github.com/linkedin/rest.li/pull/250#discussion_r403345031", "bodyText": "can setDocAndProperties reuse this?", "author": "junchuanwang", "createdAt": "2020-04-03T21:28:20Z", "path": "data/src/main/java/com/linkedin/data/schema/grammar/PdlSchemaParser.java", "diffHunk": "@@ -756,6 +760,26 @@ private RecordDataSchema parseRecord(\n     return properties;\n   }\n \n+  /**\n+   * Sets properties on the provided {@link ComplexDataSchema} using data parsed from the provided\n+   * {@link AnonymousTypeDeclarationContext}.\n+   *\n+   * @param source source to read properties from\n+   * @param target target on which to set properties\n+   */\n+  private void setProperties(AnonymousTypeDeclarationContext source, ComplexDataSchema target)", "originalCommit": "dee9d18c97b4e39ab54c916aced8e7bc9aa7ea09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQyOTcyOQ==", "url": "https://github.com/linkedin/rest.li/pull/250#discussion_r403429729", "bodyText": "@junchuanwang No, since AnonymousTypeDeclarationContext and NamedTypeDeclarationContext are separate classes with no inheritance relationship. The only other option would be to pass in the parent TypeDeclarationContext object, but that would still require that the anonymous and named types have their properties extracted separately.", "author": "evanw555", "createdAt": "2020-04-04T05:48:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NTAzMQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQyOTQ5OQ==", "url": "https://github.com/linkedin/rest.li/pull/250#discussion_r403429499", "bodyText": "Might be overkill, but I'd test to make sure the fields themselves have no properties.", "author": "evanw555", "createdAt": "2020-04-04T05:45:00Z", "path": "data/src/test/java/com/linkedin/data/schema/grammar/TestPdlSchemaParser.java", "diffHunk": "@@ -237,6 +236,32 @@ public void testNamedDataSchemaWithAliases()\n \n   }\n \n+  @Test\n+  public void testComplexTypeWithProperties()", "originalCommit": "dee9d18c97b4e39ab54c916aced8e7bc9aa7ea09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU0NjU0OA==", "url": "https://github.com/linkedin/rest.li/pull/250#discussion_r404546548", "bodyText": "done", "author": "karthikbalasub", "createdAt": "2020-04-07T05:37:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzQyOTQ5OQ=="}], "type": "inlineReview", "revised_code": {"commit": "81caf2b5a59eb9fb2e21e1b324bfbecf60b67192", "chunk": "diff --git a/data/src/test/java/com/linkedin/data/schema/grammar/TestPdlSchemaParser.java b/data/src/test/java/com/linkedin/data/schema/grammar/TestPdlSchemaParser.java\nindex e8e9e2c9f..fbc4e1a6f 100644\n--- a/data/src/test/java/com/linkedin/data/schema/grammar/TestPdlSchemaParser.java\n+++ b/data/src/test/java/com/linkedin/data/schema/grammar/TestPdlSchemaParser.java\n\n@@ -247,15 +247,18 @@ public class TestPdlSchemaParser\n     DataMap validate = new DataMap();\n     validate.put(\"minSize\", 1);\n     expectedProperty.put(\"validate\", validate);\n+    Assert.assertTrue(arrayField.getProperties().isEmpty());\n     Assert.assertEquals(arrayField.getType().getProperties(), expectedProperty);\n \n     RecordDataSchema.Field mapField = mainRecordSchema.getField(\"mapField\");\n     Assert.assertNotNull(mapField);\n+    Assert.assertTrue(mapField.getProperties().isEmpty());\n     Assert.assertFalse(mapField.getType().getProperties().isEmpty());\n     Assert.assertEquals(mapField.getType().getProperties(), expectedProperty);\n \n     RecordDataSchema.Field unionField = mainRecordSchema.getField(\"unionField\");\n     Assert.assertNotNull(unionField);\n+    Assert.assertTrue(unionField.getProperties().isEmpty());\n     Assert.assertFalse(unionField.getType().getProperties().isEmpty());\n     validate.clear();\n     validate.put(\"minValue\", 0);\n"}}, {"oid": "6ed3f765aaaf506f31e16a83094f405dda385bf5", "url": "https://github.com/linkedin/rest.li/commit/6ed3f765aaaf506f31e16a83094f405dda385bf5", "message": "Add support for custom properties on anonymous complex schemas.", "committedDate": "2020-04-07T05:31:36Z", "type": "commit"}, {"oid": "81caf2b5a59eb9fb2e21e1b324bfbecf60b67192", "url": "https://github.com/linkedin/rest.li/commit/81caf2b5a59eb9fb2e21e1b324bfbecf60b67192", "message": "Address review comments", "committedDate": "2020-04-07T05:35:12Z", "type": "commit"}, {"oid": "81caf2b5a59eb9fb2e21e1b324bfbecf60b67192", "url": "https://github.com/linkedin/rest.li/commit/81caf2b5a59eb9fb2e21e1b324bfbecf60b67192", "message": "Address review comments", "committedDate": "2020-04-07T05:35:12Z", "type": "forcePushed"}]}