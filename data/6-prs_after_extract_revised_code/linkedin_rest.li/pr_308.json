{"pr_number": 308, "pr_title": "add protobuf stream data codec and use in PROTOBUF2", "pr_createdAt": "2020-05-22T09:07:46Z", "pr_url": "https://github.com/linkedin/rest.li/pull/308", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk5Mzc3OQ==", "url": "https://github.com/linkedin/rest.li/pull/308#discussion_r430993779", "bodyText": "Update this codec also.", "author": "karthikbalasub", "createdAt": "2020-05-27T09:47:37Z", "path": "restli-common/src/main/java/com/linkedin/restli/common/ContentType.java", "diffHunk": "@@ -107,10 +111,12 @@\n         new SymbolTableBasedContentTypeProvider(PROTOBUF,", "originalCommit": "094e8efaabbf599d7774b2d38d3d4c167736493b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTEzMzIxMA==", "url": "https://github.com/linkedin/rest.li/pull/308#discussion_r431133210", "bodyText": "updated, left it initially since it is deprecated.", "author": "aman1309", "createdAt": "2020-05-27T13:32:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDk5Mzc3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "656f18a38ce2a4010ad3cc8fcf4cc68bf4e5ef25", "chunk": "diff --git a/restli-common/src/main/java/com/linkedin/restli/common/ContentType.java b/restli-common/src/main/java/com/linkedin/restli/common/ContentType.java\nindex 07a84c359..ecbaa9acd 100644\n--- a/restli-common/src/main/java/com/linkedin/restli/common/ContentType.java\n+++ b/restli-common/src/main/java/com/linkedin/restli/common/ContentType.java\n\n@@ -110,7 +113,10 @@ public class ContentType\n     SUPPORTED_TYPE_PROVIDERS.put(PROTOBUF.getHeaderKey(),\n         new SymbolTableBasedContentTypeProvider(PROTOBUF,\n             (rawMimeType, symbolTable) -> new ContentType(rawMimeType,\n-                new ProtobufDataCodec(new ProtobufCodecOptions.Builder().setSymbolTable(symbolTable).build()), null)));\n+                new ProtobufDataCodec(new ProtobufCodecOptions.Builder().setSymbolTable(symbolTable).build()),\n+                new ProtobufStreamDataCodec(R2Constants.DEFAULT_DATA_CHUNK_SIZE,\n+                    new ProtobufCodecOptions.Builder().setSymbolTable(symbolTable)\n+                        .setEnableASCIIOnlyStrings(false).build()))));\n     SUPPORTED_TYPE_PROVIDERS.put(PROTOBUF2.getHeaderKey(), new SymbolTableBasedContentTypeProvider(PROTOBUF2,\n         (rawMimeType, symbolTable) -> new ContentType(rawMimeType, new ProtobufDataCodec(\n             new ProtobufCodecOptions.Builder().setSymbolTable(symbolTable).setEnableASCIIOnlyStrings(true).build()),\n"}}, {"oid": "656f18a38ce2a4010ad3cc8fcf4cc68bf4e5ef25", "url": "https://github.com/linkedin/rest.li/commit/656f18a38ce2a4010ad3cc8fcf4cc68bf4e5ef25", "message": "address review comments", "committedDate": "2020-05-27T16:16:37Z", "type": "forcePushed"}, {"oid": "53f4f85c171fe8555d0b220ef8d1ea19b8b22911", "url": "https://github.com/linkedin/rest.li/commit/53f4f85c171fe8555d0b220ef8d1ea19b8b22911", "message": "address review comments", "committedDate": "2020-05-27T18:55:52Z", "type": "forcePushed"}, {"oid": "ffd995a5dbd495fc75e785725bc29d9409fb38bc", "url": "https://github.com/linkedin/rest.li/commit/ffd995a5dbd495fc75e785725bc29d9409fb38bc", "message": "add unit tests for stream codecs", "committedDate": "2020-05-28T20:17:24Z", "type": "forcePushed"}, {"oid": "c26208f373365e2eb5cc6648aca4f91e993bafe4", "url": "https://github.com/linkedin/rest.li/commit/c26208f373365e2eb5cc6648aca4f91e993bafe4", "message": "add protobuf stream data codec and use in PROTOBUF2\nexpose interface required to extend protocodec\nadd unit tests for stream codecs", "committedDate": "2020-05-30T17:01:32Z", "type": "commit"}, {"oid": "c26208f373365e2eb5cc6648aca4f91e993bafe4", "url": "https://github.com/linkedin/rest.li/commit/c26208f373365e2eb5cc6648aca4f91e993bafe4", "message": "add protobuf stream data codec and use in PROTOBUF2\nexpose interface required to extend protocodec\nadd unit tests for stream codecs", "committedDate": "2020-05-30T17:01:32Z", "type": "forcePushed"}]}