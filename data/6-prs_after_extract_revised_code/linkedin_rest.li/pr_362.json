{"pr_number": 362, "pr_title": "Add gradle property to skip generateRestModel task", "pr_createdAt": "2020-08-03T21:47:56Z", "pr_url": "https://github.com/linkedin/rest.li/pull/362", "timeline": [{"oid": "cd21df22aacbab46546b0834cd40343e448e1957", "url": "https://github.com/linkedin/rest.li/commit/cd21df22aacbab46546b0834cd40343e448e1957", "message": "Add gradle property to skip generateRestModel task", "committedDate": "2020-08-03T21:43:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxNTI0MQ==", "url": "https://github.com/linkedin/rest.li/pull/362#discussion_r464715241", "bodyText": "Would this automatically skip the checkRestModel task as it depends on this?", "author": "karthikbalasub", "createdAt": "2020-08-03T23:32:46Z", "path": "gradle-plugins/src/main/java/com/linkedin/pegasus/gradle/PegasusPlugin.java", "diffHunk": "@@ -1226,6 +1229,8 @@ protected void configureRestModelGeneration(Project project, SourceSet sourceSet\n               task.setEnableArgFile(true);\n             }\n \n+            task.onlyIf(t -> !isPropertyTrue(project, SKIP_GENERATE_REST_MODEL));", "originalCommit": "cd21df22aacbab46546b0834cd40343e448e1957", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxNTcyOQ==", "url": "https://github.com/linkedin/rest.li/pull/362#discussion_r464715729", "bodyText": "It will not ( I tested with --rerun-tasks)\n> Task :datarealm-restaurants-codegen:generateRestModel SKIPPED\nSkipping task ':datarealm-restaurants-codegen:generateRestModel' as task onlyIf is false.\n:datarealm-restaurants-codegen:generateRestModel (Thread[Execution worker for ':' Thread 7,5,main]) completed. Took 0.0 secs.\n:datarealm-restaurants-codegen:checkIdl (Thread[Execution worker for ':' Thread 7,5,main]) started.\n\n> Task :datarealm-restaurants-codegen:checkIdl SKIPPED\nSkipping task ':datarealm-restaurants-codegen:checkIdl' as task onlyIf is false.\n:datarealm-restaurants-codegen:checkIdl (Thread[Execution worker for ':' Thread 7,5,main]) completed. Took 0.0 secs.\n:datarealm-restaurants-codegen:checkRestModel (Thread[Execution worker for ':' Thread 7,5,main]) started.\n\n> Task :datarealm-restaurants-codegen:checkRestModel\nCustom actions are attached to task ':datarealm-restaurants-codegen:checkRestModel'.\nBuild cache key for task ':datarealm-restaurants-codegen:checkRestModel' is 1c367c32613257037a337f7ab4000298\nTask ':datarealm-restaurants-codegen:checkRestModel' is not up-to-date because:\n  Executed with '--rerun-tasks'.\nChecking interface compatibility with API ...\nStarting process 'command '/export/apps/jdk/JDK-1_8_0_172/bin/java''. Working directory: /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen Command: /export/apps/jdk/JDK-1_8_0_172/bin/java -Dfile.encoding=UTF-8 -Duser.country=US -Duser.language=en -Duser.variant -cp /home/juncwang/ws/oncall/datarealm-restaurants_trunk/build/datarealm-restaurants-codegen/checkRestModel/datarealm-restaurants-codegen-pathing.jar com.linkedin.restli.tools.snapshot.check.RestLiSnapshotCompatibilityChecker --compat backwards --report /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.reviews.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.reviews.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.entityMedias.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.entityMedias.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.ingredients.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.ingredients.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.restaurants.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.restaurants.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.members.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.members.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.menuItems.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.menuItems.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.miniMenuItems.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.miniMenuItems.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.chefs.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.chefs.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-models/src/main/snapshot/com.linkedin.datarealm.orders.snapshot.json /home/juncwang/ws/oncall/datarealm-restaurants_trunk/datarealm-restaurants-codegen/src/mainGeneratedRest/snapshot/com.linkedin.datarealm.orders.snapshot.json\nSuccessfully started process 'command '/export/apps/jdk/JDK-1_8_0_172/bin/java''\nANTLR Tool version 4.5 used for code generation does not match the current runtime version 4.7.2ANTLR Runtime version 4.5 used for parser compilation does not match the current runtime version 4.7.2ANTLR Tool version 4.5 used for code generation does not match the current runtime version 4.7.2ANTLR Runtime version 4.5 used for parser compilation does not match the current runtime version 4.7.2[checker] [RS-COMPAT]: true\n[checker] [MD-COMPAT]: true\n[checker]\nStored cache entry for task ':datarealm-restaurants-codegen:checkRestModel' with cache key 1c367c32613257037a337f7ab4000298\n:datarealm-restaurants-codegen:checkRestModel (Thread[Execution worker for ':' Thread 7,5,main]) completed. Took 0.618 secs.\n:datarealm-restaurants-codegen:checkSnapshot (Thread[Execution worker for ':' Thread 7,5,main]) started.", "author": "junchuanwang", "createdAt": "2020-08-03T23:34:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxNTI0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxODEzNw==", "url": "https://github.com/linkedin/rest.li/pull/362#discussion_r464718137", "bodyText": "I think we need a flag to disable the entire chain of tasks starting from generate -> check -> publish. Otherwise, it can result in unpredictable results. Also, since this flag is needed for improving build speed, skipping these additional tasks would make it better.", "author": "karthikbalasub", "createdAt": "2020-08-03T23:42:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxNTI0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxOTU3NA==", "url": "https://github.com/linkedin/rest.li/pull/362#discussion_r464719574", "bodyText": "Do you mean one additional flag to actually combines SKIP_IDL_CHECK && IDL_NO_PUBLISH && SNAPSHOT_NO_PUBLISH && SKIP_GENERATE_REST_MODEL? But one can do this on his own through combination of existing flags.\nRight now, there are already SKIP_IDL_CHECK, IDL_NO_PUBLISH, SNAPSHOT_NO_PUBLISH three Flags\nIf we want to keep the current noPublish flag behaving the same as before, and also add another flags, I am just afraid there will be too many flags.", "author": "junchuanwang", "createdAt": "2020-08-03T23:47:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxNTI0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxOTk2Mw==", "url": "https://github.com/linkedin/rest.li/pull/362#discussion_r464719963", "bodyText": "Okay, good point.", "author": "karthikbalasub", "createdAt": "2020-08-03T23:48:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDcxNTI0MQ=="}], "type": "inlineReview", "revised_code": null}]}