{"pr_number": 6338, "pr_title": "Refactor registry center instance", "pr_createdAt": "2020-07-13T10:22:08Z", "pr_url": "https://github.com/apache/shardingsphere/pull/6338", "timeline": [{"oid": "a760e0e4d527ec2fe226d470aadc6ceb5c938ec3", "url": "https://github.com/apache/shardingsphere/commit/a760e0e4d527ec2fe226d470aadc6ceb5c938ec3", "message": "refactor registry center instance", "committedDate": "2020-07-13T10:17:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU3NDEzMw==", "url": "https://github.com/apache/shardingsphere/pull/6338#discussion_r453574133", "bodyText": "use a special key and make it constants", "author": "kimmking", "createdAt": "2020-07-13T11:10:24Z", "path": "shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java", "diffHunk": "@@ -32,7 +35,9 @@\n     private String instanceId;\n \n     private OrchestrationInstance() {\n-\n+        String tag = Strings.isNullOrEmpty(System.getProperty(\"port\"))", "originalCommit": "a760e0e4d527ec2fe226d470aadc6ceb5c938ec3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "60c0dcbd8895e44beba314d64be8048da19abf65", "chunk": "diff --git a/shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java b/shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java\nindex 761b7ec557..ee223d6e55 100644\n--- a/shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java\n+++ b/shardingsphere-control-panel/shardingsphere-orchestration/shardingsphere-orchestration-core/shardingsphere-orchestration-core-registrycenter/src/main/java/org/apache/shardingsphere/orchestration/core/registrycenter/instance/OrchestrationInstance.java\n\n@@ -32,10 +32,12 @@ public final class OrchestrationInstance {\n \n     private static final OrchestrationInstance INSTANCE = new OrchestrationInstance();\n     \n+    private static final String PORT_KEY = \"shardingsphere.port\";\n+    \n     private String instanceId;\n \n     private OrchestrationInstance() {\n-        String tag = Strings.isNullOrEmpty(System.getProperty(\"port\"))\n+        String tag = Strings.isNullOrEmpty(System.getProperty(PORT_KEY))\n                 ? ManagementFactory.getRuntimeMXBean().getName().split(DELIMITER)[0] : System.getProperty(\"port\");\n         instanceId = IpUtils.getIp() + DELIMITER + tag + DELIMITER + UUID.randomUUID().toString();\n     }\n"}}, {"oid": "60c0dcbd8895e44beba314d64be8048da19abf65", "url": "https://github.com/apache/shardingsphere/commit/60c0dcbd8895e44beba314d64be8048da19abf65", "message": "revise properties key", "committedDate": "2020-07-14T05:36:43Z", "type": "commit"}, {"oid": "c7a2ffdbcd49aa458561f02f961d4485fc82b912", "url": "https://github.com/apache/shardingsphere/commit/c7a2ffdbcd49aa458561f02f961d4485fc82b912", "message": "revise properties key", "committedDate": "2020-07-14T06:16:17Z", "type": "commit"}]}