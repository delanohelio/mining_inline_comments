{"pr_number": 4065, "pr_title": "Fix  #4062 to allow more than one proxy server running by start scripts with different config directories.", "pr_createdAt": "2020-01-21T10:30:30Z", "pr_url": "https://github.com/apache/shardingsphere/pull/4065", "timeline": [{"oid": "2b4270078c47a930b058eafbfb27736122d5cb41", "url": "https://github.com/apache/shardingsphere/commit/2b4270078c47a930b058eafbfb27736122d5cb41", "message": "modify start-script to support proxy config path and jta config file", "committedDate": "2020-01-21T08:16:06Z", "type": "commit"}, {"oid": "e5dd08dbc1cb756fcb5c22c7ee257d232e524528", "url": "https://github.com/apache/shardingsphere/commit/e5dd08dbc1cb756fcb5c22c7ee257d232e524528", "message": "add path param to support config path", "committedDate": "2020-01-21T08:29:56Z", "type": "commit"}, {"oid": "0170022c04725f6c93d3f826eaf559355b569fa7", "url": "https://github.com/apache/shardingsphere/commit/0170022c04725f6c93d3f826eaf559355b569fa7", "message": "rename jta.properties to transactions.properties to fix #4602", "committedDate": "2020-01-21T08:33:01Z", "type": "commit"}, {"oid": "a8da2416c96ae7ced9281f24d76eb3c2821b6b74", "url": "https://github.com/apache/shardingsphere/commit/a8da2416c96ae7ced9281f24d76eb3c2821b6b74", "message": "remove pid check in start.sh and add echo statement in start.bat", "committedDate": "2020-01-21T10:15:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODkyODgwNQ==", "url": "https://github.com/apache/shardingsphere/pull/4065#discussion_r368928805", "bodyText": "We should remove useless blank line.", "author": "terrymanu", "createdAt": "2020-01-21T10:45:57Z", "path": "sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java", "diffHunk": "@@ -74,9 +76,12 @@\n      * @throws SQLException SQL exception\n      */\n     public static void main(final String[] args) throws IOException, SQLException {\n-        ShardingConfiguration shardingConfig = new ShardingConfigurationLoader().load();\n-        logRuleConfigurationMap(getRuleConfiguration(shardingConfig.getRuleConfigurationMap()).values());\n         int port = getPort(args);\n+        String path = getConfigPath(args);\n+", "originalCommit": "85858ae8a05b49f17f445aa0538af16f97f82c53", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODk0NjU5Mg==", "url": "https://github.com/apache/shardingsphere/pull/4065#discussion_r368946592", "bodyText": "We should remove useless blank line.\n\ndone.", "author": "kimmking", "createdAt": "2020-01-21T11:25:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODkyODgwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "c67ec7ea12f99a39d587ebd84b8e73faa71b7f71", "chunk": "diff --git a/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java b/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java\nindex 4c2df9b39f..83ce543eac 100644\n--- a/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java\n+++ b/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java\n\n@@ -77,11 +77,8 @@ public final class Bootstrap {\n      */\n     public static void main(final String[] args) throws IOException, SQLException {\n         int port = getPort(args);\n-        String path = getConfigPath(args);\n-\n-        ShardingConfiguration shardingConfig = new ShardingConfigurationLoader().load(path);\n+        ShardingConfiguration shardingConfig = new ShardingConfigurationLoader().load(getConfigPath(args));\n         logRuleConfigurationMap(getRuleConfiguration(shardingConfig.getRuleConfigurationMap()).values());\n-\n         if (null == shardingConfig.getServerConfiguration().getOrchestration()) {\n             startWithoutRegistryCenter(shardingConfig.getRuleConfigurationMap(), shardingConfig.getServerConfiguration().getAuthentication(), shardingConfig.getServerConfiguration().getProps(), port);\n         } else {\n"}}, {"oid": "c67ec7ea12f99a39d587ebd84b8e73faa71b7f71", "url": "https://github.com/apache/shardingsphere/commit/c67ec7ea12f99a39d587ebd84b8e73faa71b7f71", "message": "fix testcase for ShardingConfigurationLoaderTest and polish codes", "committedDate": "2020-01-21T11:12:18Z", "type": "commit"}, {"oid": "c67ec7ea12f99a39d587ebd84b8e73faa71b7f71", "url": "https://github.com/apache/shardingsphere/commit/c67ec7ea12f99a39d587ebd84b8e73faa71b7f71", "message": "fix testcase for ShardingConfigurationLoaderTest and polish codes", "committedDate": "2020-01-21T11:12:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODk3ODgzMw==", "url": "https://github.com/apache/shardingsphere/pull/4065#discussion_r368978833", "bodyText": "name of str maybe arg", "author": "terrymanu", "createdAt": "2020-01-21T12:44:57Z", "path": "sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java", "diffHunk": "@@ -91,6 +93,18 @@ private static int getPort(final String[] args) {\n         Integer paredPort = Ints.tryParse(args[0]);\n         return paredPort == null ? DEFAULT_PORT : paredPort;\n     }\n+\n+    private static String getConfigPath(final String[] args) {\n+        if (args.length < 2) {\n+            return DEFAULT_CONFIG_PATH;\n+        }\n+        return paddingWithSlash(args[1]);\n+    }\n+\n+    private static String paddingWithSlash(final String str) {", "originalCommit": "c67ec7ea12f99a39d587ebd84b8e73faa71b7f71", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4dc37ab0afe39d4b80194938acfc0354fbf82c9c", "chunk": "diff --git a/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java b/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java\nindex 83ce543eac..705e104c80 100644\n--- a/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java\n+++ b/sharding-proxy/sharding-proxy-bootstrap/src/main/java/org/apache/shardingsphere/shardingproxy/Bootstrap.java\n\n@@ -101,8 +101,8 @@ public final class Bootstrap {\n         return paddingWithSlash(args[1]);\n     }\n \n-    private static String paddingWithSlash(final String str) {\n-        String path = str.endsWith(\"/\") ? str : (str + \"/\");\n+    private static String paddingWithSlash(final String arg) {\n+        String path = arg.endsWith(\"/\") ? arg : (arg + \"/\");\n         return path.startsWith(\"/\") ? path : (\"/\" + path);\n     }\n     \n"}}, {"oid": "4dc37ab0afe39d4b80194938acfc0354fbf82c9c", "url": "https://github.com/apache/shardingsphere/commit/4dc37ab0afe39d4b80194938acfc0354fbf82c9c", "message": "rename a method parameter", "committedDate": "2020-01-21T13:15:43Z", "type": "commit"}, {"oid": "4dc37ab0afe39d4b80194938acfc0354fbf82c9c", "url": "https://github.com/apache/shardingsphere/commit/4dc37ab0afe39d4b80194938acfc0354fbf82c9c", "message": "rename a method parameter", "committedDate": "2020-01-21T13:15:43Z", "type": "forcePushed"}]}