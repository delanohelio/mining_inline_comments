{"pr_number": 7263, "pr_title": "Refactor DCLStatement to MySQL, Oracle, PostgreSQL, SQL92 and SQLServer DCLStatement", "pr_createdAt": "2020-09-05T08:00:29Z", "pr_url": "https://github.com/apache/shardingsphere/pull/7263", "timeline": [{"oid": "a154d2870b445a01f3b77f24eddb43c859ae8e02", "url": "https://github.com/apache/shardingsphere/commit/a154d2870b445a01f3b77f24eddb43c859ae8e02", "message": "Refactor some MySQL DCLStatement & SQLServer DCLStatement", "committedDate": "2020-09-04T14:09:00Z", "type": "commit"}, {"oid": "6662e8d1b753b09a71b3b1d01fa42d7c45a5e0ff", "url": "https://github.com/apache/shardingsphere/commit/6662e8d1b753b09a71b3b1d01fa42d7c45a5e0ff", "message": "Refactor DCLStatement to MySQL, Oracle, PostgreSQL, SQL92 and SQLServer DCLStatement", "committedDate": "2020-09-05T07:55:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkzMjIxMQ==", "url": "https://github.com/apache/shardingsphere/pull/7263#discussion_r483932211", "bodyText": "I suppose other database SQL  Statements except for MySQL are not wanted here. See the name of this class.", "author": "tristaZero", "createdAt": "2020-09-05T09:27:29Z", "path": "shardingsphere-proxy/shardingsphere-proxy-frontend/shardingsphere-proxy-frontend-mysql/src/test/java/org/apache/shardingsphere/proxy/frontend/mysql/command/query/binary/prepare/MySQLComStmtPrepareCheckerTest.java", "diffHunk": "@@ -81,12 +98,17 @@\n     @Test\n     public void assertIsStatementAllowed() {\n         List<SQLStatement> statementList = Arrays.asList(\n-            new AlterTableStatement(mock(SimpleTableSegment.class)), new AlterUserStatement(), new MySQLAnalyzeTableStatement(), new MySQLCacheIndexStatement(),\n+            new AlterTableStatement(mock(SimpleTableSegment.class)), new MySQLAlterUserStatement(), new OracleAlterUserStatement(), \n+            new PostgreSQLAlterUserStatement(), new SQLServerAlterUserStatement(), new MySQLAnalyzeTableStatement(), new MySQLCacheIndexStatement(),\n             new CallStatement(), new ChangeMasterStatement(), new MySQLChecksumTableStatement(), new CommitStatement(), new CreateIndexStatement(), new DropIndexStatement(),\n-            new CreateDatabaseStatement(\"\"), new DropDatabaseStatement(\"\"), new CreateTableStatement(mock(SimpleTableSegment.class)), new DropTableStatement(), new CreateUserStatement(),\n-            new RenameUserStatement(), new DropUserStatement(), new CreateViewStatement(), new DropViewStatement(), new DeleteStatement(), new DoStatement(), new MySQLFlushStatement(),\n-            new GrantStatement(), new InsertStatement(), new MySQLInstallPluginStatement(), new MySQLKillStatement(), new MySQLLoadIndexInfoStatement(), new MySQLOptimizeTableStatement(),\n-            new RenameTableStatement(), new MySQLRepairTableStatement(), new MySQLResetStatement(), new RevokeStatement(), new SelectStatement(), new SetStatement(), new MySQLShowWarningsStatement(),\n+            new CreateDatabaseStatement(\"\"), new DropDatabaseStatement(\"\"), new CreateTableStatement(mock(SimpleTableSegment.class)), new DropTableStatement(), ", "originalCommit": "6662e8d1b753b09a71b3b1d01fa42d7c45a5e0ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk1MTgzMA==", "url": "https://github.com/apache/shardingsphere/pull/7263#discussion_r483951830", "bodyText": "I suppose other database SQL Statements except for MySQL are not wanted here. See the name of this class.\n\n@tristaZero I am very sorry for this mistake, and I will check this logic again. \ud83e\udd23", "author": "strongduanmu", "createdAt": "2020-09-05T13:36:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzkzMjIxMQ=="}], "type": "inlineReview", "revised_code": {"commit": "b2a298fb3728695b1a4ab87ff6a22ff8126f6092", "chunk": "diff --git a/shardingsphere-proxy/shardingsphere-proxy-frontend/shardingsphere-proxy-frontend-mysql/src/test/java/org/apache/shardingsphere/proxy/frontend/mysql/command/query/binary/prepare/MySQLComStmtPrepareCheckerTest.java b/shardingsphere-proxy/shardingsphere-proxy-frontend/shardingsphere-proxy-frontend-mysql/src/test/java/org/apache/shardingsphere/proxy/frontend/mysql/command/query/binary/prepare/MySQLComStmtPrepareCheckerTest.java\nindex c6edc35c17..8dbb9c2fcd 100644\n--- a/shardingsphere-proxy/shardingsphere-proxy-frontend/shardingsphere-proxy-frontend-mysql/src/test/java/org/apache/shardingsphere/proxy/frontend/mysql/command/query/binary/prepare/MySQLComStmtPrepareCheckerTest.java\n+++ b/shardingsphere-proxy/shardingsphere-proxy-frontend/shardingsphere-proxy-frontend-mysql/src/test/java/org/apache/shardingsphere/proxy/frontend/mysql/command/query/binary/prepare/MySQLComStmtPrepareCheckerTest.java\n\n@@ -98,17 +81,13 @@ public final class MySQLComStmtPrepareCheckerTest {\n     @Test\n     public void assertIsStatementAllowed() {\n         List<SQLStatement> statementList = Arrays.asList(\n-            new AlterTableStatement(mock(SimpleTableSegment.class)), new MySQLAlterUserStatement(), new OracleAlterUserStatement(), \n-            new PostgreSQLAlterUserStatement(), new SQLServerAlterUserStatement(), new MySQLAnalyzeTableStatement(), new MySQLCacheIndexStatement(),\n+            new AlterTableStatement(mock(SimpleTableSegment.class)), new MySQLAlterUserStatement(), new MySQLAnalyzeTableStatement(), new MySQLCacheIndexStatement(),\n             new CallStatement(), new ChangeMasterStatement(), new MySQLChecksumTableStatement(), new CommitStatement(), new CreateIndexStatement(), new DropIndexStatement(),\n-            new CreateDatabaseStatement(\"\"), new DropDatabaseStatement(\"\"), new CreateTableStatement(mock(SimpleTableSegment.class)), new DropTableStatement(), \n-            new MySQLCreateUserStatement(), new OracleCreateUserStatement(), new PostgreSQLCreateUserStatement(), new SQLServerCreateUserStatement(),\n-            new MySQLRenameUserStatement(), new MySQLDropUserStatement(), new OracleDropUserStatement(), new PostgreSQLDropUserStatement(), new SQLServerDropUserStatement(), \n-            new CreateViewStatement(), new DropViewStatement(), new DeleteStatement(), new DoStatement(), new MySQLFlushStatement(),\n-            new MySQLGrantStatement(), new OracleGrantStatement(), new PostgreSQLGrantStatement(), new SQL92GrantStatement(), new SQLServerGrantStatement(),\n-            new InsertStatement(), new MySQLInstallPluginStatement(), new MySQLKillStatement(), new MySQLLoadIndexInfoStatement(), new MySQLOptimizeTableStatement(),\n-            new RenameTableStatement(), new MySQLRepairTableStatement(), new MySQLResetStatement(), new MySQLRevokeStatement(), new OracleRevokeStatement(), new PostgreSQLRevokeStatement(), \n-            new SQL92RevokeStatement(), new SQLServerRevokeStatement(), new SelectStatement(), new SetStatement(), new MySQLShowWarningsStatement(),\n+            new CreateDatabaseStatement(\"\"), new DropDatabaseStatement(\"\"), new CreateTableStatement(mock(SimpleTableSegment.class)), new DropTableStatement(), new MySQLCreateUserStatement(),\n+            new MySQLRenameUserStatement(), new MySQLDropUserStatement(), new CreateViewStatement(), new DropViewStatement(), new DeleteStatement(), new DoStatement(), new MySQLFlushStatement(),\n+            new MySQLGrantStatement(), new InsertStatement(), new MySQLInstallPluginStatement(), new MySQLKillStatement(), \n+            new MySQLLoadIndexInfoStatement(), new MySQLOptimizeTableStatement(), new RenameTableStatement(), new MySQLRepairTableStatement(), \n+            new MySQLResetStatement(), new MySQLRevokeStatement(), new SelectStatement(), new SetStatement(), new MySQLShowWarningsStatement(),\n             new MySQLShowErrorsStatement(), new MySQLShowBinlogStatement(), new MySQLShowCreateProcedureStatement(), new MySQLShowCreateFunctionStatement(), new MySQLShowCreateEventStatement(),\n             new MySQLShowCreateTableStatement(), new MySQLShowCreateViewStatement(), new MySQLShowBinaryLogsStatement(), new MySQLShowStatusStatement(), new StartSlaveStatement(),\n             new StopSlaveStatement(), new TruncateStatement(), new MySQLUninstallPluginStatement(), new UpdateStatement());\n"}}, {"oid": "b2a298fb3728695b1a4ab87ff6a22ff8126f6092", "url": "https://github.com/apache/shardingsphere/commit/b2a298fb3728695b1a4ab87ff6a22ff8126f6092", "message": "remove other sql statement in MySQLComStmtPrepareChecker", "committedDate": "2020-09-05T14:14:14Z", "type": "commit"}]}