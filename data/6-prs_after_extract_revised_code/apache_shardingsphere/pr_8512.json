{"pr_number": 8512, "pr_title": "Modify prevalidate and post validate method.", "pr_createdAt": "2020-12-06T03:12:04Z", "pr_url": "https://github.com/apache/shardingsphere/pull/8512", "timeline": [{"oid": "69cc2ad1b49325e69565716f1e214cd549c62e23", "url": "https://github.com/apache/shardingsphere/commit/69cc2ad1b49325e69565716f1e214cd549c62e23", "message": "test: add unit test.", "committedDate": "2020-12-01T02:28:23Z", "type": "commit"}, {"oid": "2b9986b891cf99ed01a9e89ca3fc49ed7e3973c5", "url": "https://github.com/apache/shardingsphere/commit/2b9986b891cf99ed01a9e89ca3fc49ed7e3973c5", "message": "refactor: modify prevalidate and postvalidate method.", "committedDate": "2020-12-06T03:09:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODUyNTMxNg==", "url": "https://github.com/apache/shardingsphere/pull/8512#discussion_r538525316", "bodyText": "Why this check condition is different from the check condition in ShardingSelectStatementValidator? \ud83e\udd14", "author": "strongduanmu", "createdAt": "2020-12-08T15:51:53Z", "path": "shardingsphere-features/shardingsphere-sharding/shardingsphere-sharding-route/src/main/java/org/apache/shardingsphere/sharding/route/engine/validator/dml/impl/ShardingInsertStatementValidator.java", "diffHunk": "@@ -90,5 +94,8 @@ private boolean isAllSameTables(final Collection<String> tableNames) {\n     \n     @Override\n     public void postValidate(final InsertStatement sqlStatement, final RouteContext routeContext) {\n+        if (needCheckShardingKey) {\n+            Preconditions.checkState(routeContext.getRouteUnits().size() > 0, \"Sharding value must same with subquery.\");", "originalCommit": "2b9986b891cf99ed01a9e89ca3fc49ed7e3973c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTg2NTYwMA==", "url": "https://github.com/apache/shardingsphere/pull/8512#discussion_r539865600", "bodyText": "I'd like to change the  variable name.", "author": "wgy8283335", "createdAt": "2020-12-10T05:56:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODUyNTMxNg=="}], "type": "inlineReview", "revised_code": {"commit": "02b1a4a52bd623a7a41a992363c6e9a80205e71a", "chunk": "diff --git a/shardingsphere-features/shardingsphere-sharding/shardingsphere-sharding-route/src/main/java/org/apache/shardingsphere/sharding/route/engine/validator/dml/impl/ShardingInsertStatementValidator.java b/shardingsphere-features/shardingsphere-sharding/shardingsphere-sharding-route/src/main/java/org/apache/shardingsphere/sharding/route/engine/validator/dml/impl/ShardingInsertStatementValidator.java\nindex b9a8e4ae92..f7cfc185dc 100644\n--- a/shardingsphere-features/shardingsphere-sharding/shardingsphere-sharding-route/src/main/java/org/apache/shardingsphere/sharding/route/engine/validator/dml/impl/ShardingInsertStatementValidator.java\n+++ b/shardingsphere-features/shardingsphere-sharding/shardingsphere-sharding-route/src/main/java/org/apache/shardingsphere/sharding/route/engine/validator/dml/impl/ShardingInsertStatementValidator.java\n\n@@ -94,7 +94,7 @@ public final class ShardingInsertStatementValidator extends ShardingDMLStatement\n     \n     @Override\n     public void postValidate(final InsertStatement sqlStatement, final RouteContext routeContext) {\n-        if (needCheckShardingKey) {\n+        if (needCheckDatabaseInstance) {\n             Preconditions.checkState(routeContext.getRouteUnits().size() > 0, \"Sharding value must same with subquery.\");\n         }\n     }\n"}}, {"oid": "02b1a4a52bd623a7a41a992363c6e9a80205e71a", "url": "https://github.com/apache/shardingsphere/commit/02b1a4a52bd623a7a41a992363c6e9a80205e71a", "message": "refactor: modify the variable name.", "committedDate": "2020-12-10T05:58:20Z", "type": "commit"}, {"oid": "abd662e9bd96effa75ac79f6e89cbba8666da3d4", "url": "https://github.com/apache/shardingsphere/commit/abd662e9bd96effa75ac79f6e89cbba8666da3d4", "message": "refactor: modify the check conditions.", "committedDate": "2020-12-13T13:32:47Z", "type": "commit"}]}