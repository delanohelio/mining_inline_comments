{"pr_number": 6982, "pr_title": "[1.16] Add data generators for sounds.json", "pr_createdAt": "2020-07-17T16:58:17Z", "pr_url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982", "timeline": [{"oid": "5de2448019d6f36e65ef075c0ecbcc3e2b1058ac", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/5de2448019d6f36e65ef075c0ecbcc3e2b1058ac", "message": "Add data-generated sounds.json\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-07-17T17:00:55Z", "type": "forcePushed"}, {"oid": "00455dc1b20de8657b43be60b1bf2847a12e4979", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/00455dc1b20de8657b43be60b1bf2847a12e4979", "message": "Add data-generated sounds.json\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-07-23T10:26:31Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ0MTExOA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r461441118", "bodyText": "Please move this and all related classes to the data gen package.", "author": "ichttt", "createdAt": "2020-07-28T09:19:30Z", "path": "src/main/java/net/minecraftforge/client/sounds/generators/SoundDefinition.java", "diffHunk": "@@ -0,0 +1,449 @@\n+/*\n+ * Minecraft Forge\n+ * Copyright (c) 2016-2020.\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.client.sounds.generators;", "originalCommit": "00455dc1b20de8657b43be60b1bf2847a12e4979", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ0OTU1NQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r461449555", "bodyText": "To make sure, do you refer to net.minecraftforge.common.data or is there another package?", "author": "TheSilkMiner", "createdAt": "2020-07-28T09:33:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ0MTExOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ1NTU0MQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r461455541", "bodyText": "Yes that package should be fine", "author": "ichttt", "createdAt": "2020-07-28T09:43:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ0MTExOA=="}], "type": "inlineReview", "revised_code": {"commit": "d5ada60fc7a4c93107e624b7ecf08da4d6c1b3b6", "chunk": "diff --git a/src/main/java/net/minecraftforge/client/sounds/generators/SoundDefinition.java b/src/main/java/net/minecraftforge/common/data/SoundDefinition.java\nsimilarity index 97%\nrename from src/main/java/net/minecraftforge/client/sounds/generators/SoundDefinition.java\nrename to src/main/java/net/minecraftforge/common/data/SoundDefinition.java\nindex 15fc5445b..145d383b0 100644\n--- a/src/main/java/net/minecraftforge/client/sounds/generators/SoundDefinition.java\n+++ b/src/main/java/net/minecraftforge/common/data/SoundDefinition.java\n\n@@ -17,7 +17,7 @@\n  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n  */\n \n-package net.minecraftforge.client.sounds.generators;\n+package net.minecraftforge.common.data;\n \n import com.google.gson.JsonArray;\n import com.google.gson.JsonElement;\n"}}, {"oid": "d5ada60fc7a4c93107e624b7ecf08da4d6c1b3b6", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/d5ada60fc7a4c93107e624b7ecf08da4d6c1b3b6", "message": "Allow the downloadable resource pack to be queried in datagen\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-07-28T12:40:01Z", "type": "forcePushed"}, {"oid": "677fa031f0f89d2d19135fed6729f78b42adc25e", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/677fa031f0f89d2d19135fed6729f78b42adc25e", "message": "Allow the downloadable resource pack to be queried in datagen\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-07-28T12:43:02Z", "type": "forcePushed"}, {"oid": "c4f807b1cf83086ee04361899729912554c6031f", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/c4f807b1cf83086ee04361899729912554c6031f", "message": "Fix conflicts and update to 1.16.3\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-09-13T09:31:43Z", "type": "forcePushed"}, {"oid": "99677cff3b53928b37cc0d11bd6ea5d8a5ce6a42", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/99677cff3b53928b37cc0d11bd6ea5d8a5ce6a42", "message": "Fix conflicts and update to 1.16.3\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-09-13T11:06:21Z", "type": "forcePushed"}, {"oid": "fe813d362fd4d720328ffeb9854798b2ba0c4eab", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/fe813d362fd4d720328ffeb9854798b2ba0c4eab", "message": "Fix conflicts and update to 1.16.3\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-09-13T11:35:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5Mjk1MzMzNA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r492953334", "bodyText": "What is your facination with adding arguments to the middle of the argument list?\nNew arguments go on the end, and ideally keep the old method bouncing to the new with default values.", "author": "LexManos", "createdAt": "2020-09-22T18:38:20Z", "path": "src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java", "diffHunk": "@@ -48,17 +52,24 @@\n     private final SimpleReloadableResourceManager clientResources, serverData;\n     private final boolean enable;\n \n-    public ExistingFileHelper(Collection<Path> existingPacks, boolean enable) {\n+    public ExistingFileHelper(Collection<Path> existingPacks, @Nullable final String assetIndex, @Nullable final File assetsDir, boolean enable) {", "originalCommit": "fe813d362fd4d720328ffeb9854798b2ba0c4eab", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a767fe99237384506ead78d8bd31cbb70a2b4328", "chunk": "diff --git a/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java b/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java\nindex bba4a94e6..4a89f8f83 100644\n--- a/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java\n+++ b/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java\n\n@@ -52,7 +52,11 @@ public class ExistingFileHelper {\n     private final SimpleReloadableResourceManager clientResources, serverData;\n     private final boolean enable;\n \n-    public ExistingFileHelper(Collection<Path> existingPacks, @Nullable final String assetIndex, @Nullable final File assetsDir, boolean enable) {\n+    public ExistingFileHelper(Collection<Path> existingPacks, boolean enable) {\n+        this(existingPacks, enable, null, null);\n+    }\n+\n+    public ExistingFileHelper(Collection<Path> existingPacks, boolean enable, @Nullable final String assetIndex, @Nullable final File assetsDir) {\n         this.clientResources = new SimpleReloadableResourceManager(ResourcePackType.CLIENT_RESOURCES);\n         this.serverData = new SimpleReloadableResourceManager(ResourcePackType.SERVER_DATA);\n \n"}}, {"oid": "a767fe99237384506ead78d8bd31cbb70a2b4328", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/a767fe99237384506ead78d8bd31cbb70a2b4328", "message": "Address comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-09-22T19:23:55Z", "type": "forcePushed"}, {"oid": "64a3e225513cf63d84511415e2127ce1ef76523c", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/64a3e225513cf63d84511415e2127ce1ef76523c", "message": "Address comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-10-21T09:58:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg0MDgyNg==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r549840826", "bodyText": "Don't we have that set up now? We should be able to compare the generated file with the original file", "author": "ichttt", "createdAt": "2020-12-29T20:43:07Z", "path": "src/test/java/net/minecraftforge/debug/DataGeneratorTest.java", "diffHunk": "@@ -201,6 +205,83 @@ protected void registerRecipes(Consumer<IFinishedRecipe> consumer)\n         }\n     }\n \n+    public static class SoundDefinitions extends SoundDefinitionsProvider\n+    {\n+        public SoundDefinitions(final DataGenerator generator, final ExistingFileHelper helper)\n+        {\n+            super(generator, MODID, helper);\n+        }\n+\n+        @Override\n+        public void registerSounds()\n+        {\n+            // Taken from vanilla's 'sounds.json'. These are supposed to be 1-to-1 copies, but currently\n+            // automatic testing of those copies cannot be performed due to limitations in the data-gen\n+            // system, where the additional data pack that vanilla loads from the launcher's assets/\n+            // directory isn't actually loaded when running data-gen.", "originalCommit": "64a3e225513cf63d84511415e2127ce1ef76523c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f8dac26d7a6258d32563f0480d56bf93550a7c5e", "chunk": "diff --git a/src/test/java/net/minecraftforge/debug/DataGeneratorTest.java b/src/test/java/net/minecraftforge/debug/DataGeneratorTest.java\nindex 998c7b277..09087aa53 100644\n--- a/src/test/java/net/minecraftforge/debug/DataGeneratorTest.java\n+++ b/src/test/java/net/minecraftforge/debug/DataGeneratorTest.java\n\n@@ -207,19 +217,18 @@ public class DataGeneratorTest\n \n     public static class SoundDefinitions extends SoundDefinitionsProvider\n     {\n+        private static final Logger LOGGER = LogManager.getLogger();\n+        private final ExistingFileHelper helper;\n+\n         public SoundDefinitions(final DataGenerator generator, final ExistingFileHelper helper)\n         {\n             super(generator, MODID, helper);\n+            this.helper = helper;\n         }\n \n         @Override\n         public void registerSounds()\n         {\n-            // Taken from vanilla's 'sounds.json'. These are supposed to be 1-to-1 copies, but currently\n-            // automatic testing of those copies cannot be performed due to limitations in the data-gen\n-            // system, where the additional data pack that vanilla loads from the launcher's assets/\n-            // directory isn't actually loaded when running data-gen.\n-\n             // ambient.underwater.loop.additions\n             this.add(SoundEvents.AMBIENT_UNDERWATER_LOOP_ADDITIONS, definition().with(\n                     sound(\"ambient/underwater/additions/bubbles1\"),\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTg0MTUzOQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r549841539", "bodyText": "Although run from datagen, this is a binary break. Please just leave the old contructor, and deprecate it. Also, please add the new parameters to the end of the parameter list", "author": "ichttt", "createdAt": "2020-12-29T20:45:50Z", "path": "src/main/java/net/minecraftforge/fml/DatagenModLoader.java", "diffHunk": "@@ -39,13 +40,13 @@ public static boolean isRunningDataGen() {\n         return runningDataGen;\n     }\n \n-    public static void begin(final Set<String> mods, final Path path, final java.util.Collection<Path> inputs, Collection<Path> existingPacks, final boolean serverGenerators, final boolean clientGenerators, final boolean devToolGenerators, final boolean reportsGenerator, final boolean structureValidator, final boolean flat) {\n+    public static void begin(final Set<String> mods, final Path path, final Collection<Path> inputs, Collection<Path> existingPacks, final String assetIndex, final File assetsDir, final boolean serverGenerators, final boolean clientGenerators, final boolean devToolGenerators, final boolean reportsGenerator, final boolean structureValidator, final boolean flat) {", "originalCommit": "64a3e225513cf63d84511415e2127ce1ef76523c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f8dac26d7a6258d32563f0480d56bf93550a7c5e", "chunk": "diff --git a/src/main/java/net/minecraftforge/fml/DatagenModLoader.java b/src/main/java/net/minecraftforge/fml/DatagenModLoader.java\nindex 4425d9680..7903677cb 100644\n--- a/src/main/java/net/minecraftforge/fml/DatagenModLoader.java\n+++ b/src/main/java/net/minecraftforge/fml/DatagenModLoader.java\n\n@@ -40,14 +41,28 @@ public class DatagenModLoader {\n         return runningDataGen;\n     }\n \n-    public static void begin(final Set<String> mods, final Path path, final Collection<Path> inputs, Collection<Path> existingPacks, final String assetIndex, final File assetsDir, final boolean serverGenerators, final boolean clientGenerators, final boolean devToolGenerators, final boolean reportsGenerator, final boolean structureValidator, final boolean flat) {\n+    @Deprecated //TODO: Remove in 1.17\n+    public static void begin(final Set<String> mods, final Path path, final Collection<Path> inputs, Collection<Path> existingPacks, final boolean serverGenerators, final boolean clientGenerators, final boolean devToolGenerators, final boolean reportsGenerator, final boolean structureValidator, final boolean flat) {\n+        begin(mods, path, inputs, existingPacks, Collections.emptySet(), serverGenerators, clientGenerators, devToolGenerators, reportsGenerator, structureValidator, flat);\n+    }\n+\n+    @Deprecated //TODO: Remove in 1.17\n+    public static void begin(final Set<String> mods, final Path path, final Collection<Path> inputs, Collection<Path> existingPacks, Set<String> existingMods, final boolean serverGenerators, final boolean clientGenerators, final boolean devToolGenerators, final boolean reportsGenerator, final boolean structureValidator, final boolean flat) {\n+        begin(mods, path, inputs, existingPacks, existingMods, serverGenerators, clientGenerators, devToolGenerators, reportsGenerator, structureValidator, flat, null, null);\n+    }\n+\n+    public static void begin(final Set<String> mods, final Path path, final Collection<Path> inputs, Collection<Path> existingPacks, Set<String> existingMods, final boolean serverGenerators, final boolean clientGenerators, final boolean devToolGenerators, final boolean reportsGenerator, final boolean structureValidator, final boolean flat, final String assetIndex, final File assetsDir) {\n         if (mods.contains(\"minecraft\") && mods.size() == 1) return;\n         LOGGER.info(\"Initializing Data Gatherer for mods {}\", mods);\n         runningDataGen = true;\n         Bootstrap.register();\n         dataGeneratorConfig = new GatherDataEvent.DataGeneratorConfig(mods, path, inputs, serverGenerators, clientGenerators, devToolGenerators, reportsGenerator, structureValidator, flat);\n-        existingFileHelper = new ExistingFileHelper(existingPacks, structureValidator, assetIndex, assetsDir);\n         ModLoader.get().gatherAndInitializeMods(ModWorkManager.syncExecutor(), ModWorkManager.parallelExecutor(), ()->{});\n+        if (!mods.contains(\"forge\")) {\n+            //If we aren't generating data for forge, automatically add forge as an existing so mods can access forge's data\n+            existingMods.add(\"forge\");\n+        }\n+        existingFileHelper = new ExistingFileHelper(existingPacks, existingMods, structureValidator, assetIndex, assetsDir);\n         ModLoader.get().runEventGenerator(mc->new GatherDataEvent(mc, dataGeneratorConfig.makeGenerator(p->dataGeneratorConfig.isFlat() ? p : p.resolve(mc.getModId()), dataGeneratorConfig.getMods().contains(mc.getModId())), dataGeneratorConfig, existingFileHelper));\n         dataGeneratorConfig.runAll();\n     }\n"}}, {"oid": "f8dac26d7a6258d32563f0480d56bf93550a7c5e", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/f8dac26d7a6258d32563f0480d56bf93550a7c5e", "message": "Add automatic test of generated sounds.json\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2020-12-30T14:21:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4Mjk4MQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r620082981", "bodyText": "It seems a bit unnecessary to define bouncers for all these methods when they could just be defined in this class entirely. What purpose does defining them inside the implementation serve?", "author": "tterrag1098", "createdAt": "2021-04-26T08:32:19Z", "path": "src/main/java/net/minecraftforge/common/data/SoundDefinitionsProvider.java", "diffHunk": "@@ -0,0 +1,270 @@\n+/*\n+ * Minecraft Forge\n+ * Copyright (c) 2016-2020.\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.common.data;\n+\n+import com.google.gson.Gson;\n+import com.google.gson.GsonBuilder;\n+import com.google.gson.JsonObject;\n+import net.minecraft.data.DataGenerator;\n+import net.minecraft.data.DirectoryCache;\n+import net.minecraft.data.IDataProvider;\n+import net.minecraft.resources.ResourcePackType;\n+import net.minecraft.util.ResourceLocation;\n+import net.minecraft.util.SoundEvent;\n+import net.minecraftforge.registries.ForgeRegistries;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+\n+import java.io.IOException;\n+import java.nio.file.Path;\n+import java.util.LinkedHashMap;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.function.Supplier;\n+import java.util.stream.Collectors;\n+\n+/**\n+ * Data provider for the {@code sounds.json} file, which identifies sound definitions\n+ * for the various sound events in Minecraft.\n+ */\n+public abstract class SoundDefinitionsProvider implements IDataProvider\n+{\n+    private static final Logger LOGGER = LogManager.getLogger();\n+    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().disableHtmlEscaping().create();\n+    private final DataGenerator generator;\n+    private final String modId;\n+    private final ExistingFileHelper helper;\n+\n+    private final Map<String, SoundDefinition> sounds = new LinkedHashMap<>();\n+\n+    /**\n+     * Creates a new instance of this data provider.\n+     *\n+     * @param generator The data generator instance provided by the event you are initializing this provider in.\n+     * @param modId The mod ID of the current mod.\n+     * @param helper The existing file helper provided by the event you are initializing this provider in.\n+     */\n+    protected SoundDefinitionsProvider(final DataGenerator generator, final String modId, final ExistingFileHelper helper)\n+    {\n+        this.generator = generator;\n+        this.modId = modId;\n+        this.helper = helper;\n+    }\n+\n+    /**\n+     * Registers the sound definitions that should be generated via one of the {@code add} methods.\n+     */\n+    public abstract void registerSounds();\n+\n+    @Override\n+    public void act(DirectoryCache cache) throws IOException\n+    {\n+        this.sounds.clear();\n+        this.registerSounds();\n+        this.validate();\n+        if (!this.sounds.isEmpty())\n+        {\n+            this.save(cache, this.generator.getOutputFolder().resolve(\"assets/\" + this.modId + \"/sounds.json\"));\n+        }\n+    }\n+\n+    @Override\n+    public String getName()\n+    {\n+        return \"Sound Definitions\";\n+    }\n+\n+    // Quick helpers\n+    /**\n+     * @see SoundDefinition#definition()\n+     */\n+    protected static SoundDefinition definition()", "originalCommit": "f8dac26d7a6258d32563f0480d56bf93550a7c5e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDExMDczOA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r620110738", "bodyText": "I defined the factory methods in the implementation classes so that everything related to them would be in the same place, and to keep the constructors private. These bouncer methods exist mainly as a convenience, so that people wouldn't need to specify the class every time they want to create a new sound or a new definition, without using static imports.", "author": "TheSilkMiner", "createdAt": "2021-04-26T09:07:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4Mjk4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDEzNjg0OQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r620136849", "bodyText": "Why do the constructors need to be private? They aren't for most other data builder classes.", "author": "tterrag1098", "createdAt": "2021-04-26T09:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4Mjk4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDE0OTc2OQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r620149769", "bodyText": "I consider constructors as an implementation detail and, as such, it doesn't need to be exposed. If this is not the desired convention, though, I can definitely change it. I based myself off the change that had been made to DeferredRegister, which had seen its main constructor's visibility reduced to private for the same reason.\nIf the constructor were to be made public, though, would all the other factory methods be removed, converted into constructors, or something else?", "author": "TheSilkMiner", "createdAt": "2021-04-26T09:59:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4Mjk4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDUwOTkxMQ==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r620509911", "bodyText": "You are correct in general, and maybe I'm in the minority here, but I feel like when you have to start duplicating methods in two different places just to make your design work, that design has failed. Sometimes you have to compromise on what is theoretically right vs what is easier to write and maintain. Mostly these data builder classes will never be directly instantiated, even if the constructors are public. If we need to change the ctor to a static factory later, it can be done with little API interruption between versions. If you want to leave a single static factory on the class and just move all the overloads out, that would also be fine.", "author": "tterrag1098", "createdAt": "2021-04-26T17:37:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4Mjk4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDU2MjQyNw==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r620562427", "bodyText": "Fair enough; will do.", "author": "TheSilkMiner", "createdAt": "2021-04-26T18:51:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4Mjk4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "18dad3c388551e46660002a69268a98f7a7f4507", "chunk": "diff --git a/src/main/java/net/minecraftforge/common/data/SoundDefinitionsProvider.java b/src/main/java/net/minecraftforge/common/data/SoundDefinitionsProvider.java\nindex de2833155..60c4a7467 100644\n--- a/src/main/java/net/minecraftforge/common/data/SoundDefinitionsProvider.java\n+++ b/src/main/java/net/minecraftforge/common/data/SoundDefinitionsProvider.java\n\n@@ -74,7 +74,7 @@ public abstract class SoundDefinitionsProvider implements IDataProvider\n     public abstract void registerSounds();\n \n     @Override\n-    public void act(DirectoryCache cache) throws IOException\n+    public void run(DirectoryCache cache) throws IOException\n     {\n         this.sounds.clear();\n         this.registerSounds();\n"}}, {"oid": "18dad3c388551e46660002a69268a98f7a7f4507", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/18dad3c388551e46660002a69268a98f7a7f4507", "message": "Fix merge conflicts and address PR comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-04-26T20:05:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNDY3NjUxMg==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r624676512", "bodyText": "What's with these whitespace changes?", "author": "TheCurle", "createdAt": "2021-05-02T11:10:49Z", "path": "src/main/java/net/minecraftforge/client/model/generators/ModelProvider.java", "diffHunk": "@@ -357,7 +356,7 @@ public T nested()\n         ret.assertExistence();\n         return ret;\n     }\n-    \n+", "originalCommit": "18dad3c388551e46660002a69268a98f7a7f4507", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8d8958546d3f61c9a1cf4ed1336caa8028ccfb53", "chunk": "diff --git a/src/main/java/net/minecraftforge/client/model/generators/ModelProvider.java b/src/main/java/net/minecraftforge/client/model/generators/ModelProvider.java\nindex 696977f95..e6092b697 100644\n--- a/src/main/java/net/minecraftforge/client/model/generators/ModelProvider.java\n+++ b/src/main/java/net/minecraftforge/client/model/generators/ModelProvider.java\n\n@@ -356,7 +357,7 @@ public abstract class ModelProvider<T extends ModelBuilder<T>> implements IDataP\n         ret.assertExistence();\n         return ret;\n     }\n-\n+    \n     protected void clear() {\n         generatedModels.clear();\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyNDY3NjY2NA==", "url": "https://github.com/MinecraftForge/MinecraftForge/pull/6982#discussion_r624676664", "bodyText": "w-w-w-whitespace!", "author": "TheCurle", "createdAt": "2021-05-02T11:11:48Z", "path": "src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java", "diffHunk": "@@ -218,7 +233,7 @@ public void trackGenerated(ResourceLocation loc, IResourceType type) {\n      * <p>\n      * This represents a <em>promise</em> to generate the file later, since other\n      * datagen may rely on this file existing.\n-     * \n+     *", "originalCommit": "18dad3c388551e46660002a69268a98f7a7f4507", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8d8958546d3f61c9a1cf4ed1336caa8028ccfb53", "chunk": "diff --git a/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java b/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java\nindex 661ddbec8..9dd64695a 100644\n--- a/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java\n+++ b/src/main/java/net/minecraftforge/common/data/ExistingFileHelper.java\n\n@@ -233,7 +218,7 @@ public class ExistingFileHelper {\n      * <p>\n      * This represents a <em>promise</em> to generate the file later, since other\n      * datagen may rely on this file existing.\n-     *\n+     * \n      * @param loc        the base location of the resource, e.g.\n      *                   {@code \"minecraft:block/stone\"}\n      * @param packType   the type of resources to check\n"}}, {"oid": "8d8958546d3f61c9a1cf4ed1336caa8028ccfb53", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/8d8958546d3f61c9a1cf4ed1336caa8028ccfb53", "message": "Add data generators for sounds.json\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:11:15Z", "type": "commit"}, {"oid": "2bdb8c6522b5a2034097162a73863e5090c8e16e", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/2bdb8c6522b5a2034097162a73863e5090c8e16e", "message": "Add data gen test mod\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:11:19Z", "type": "commit"}, {"oid": "e97c241183a47dd42c6d5457334ec55002e00d6f", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e97c241183a47dd42c6d5457334ec55002e00d6f", "message": "Refactor package and remove 'minecraft' prefix from definitions\n\nAlso add data-generated sounds.json\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:11:19Z", "type": "commit"}, {"oid": "1f65b1a6cf500735bb9c06b9217b94b926ee7852", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/1f65b1a6cf500735bb9c06b9217b94b926ee7852", "message": "Allow the downloadable resource pack to be queried in datagen\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:11:20Z", "type": "commit"}, {"oid": "9df3ed63973302e8c1967de3b94627dace7d0e42", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/9df3ed63973302e8c1967de3b94627dace7d0e42", "message": "Fix conflicts and update to 1.16.4\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:11:21Z", "type": "commit"}, {"oid": "ceda61b40a7eb8ac45757d7f5f09f8e5c04b7399", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/ceda61b40a7eb8ac45757d7f5f09f8e5c04b7399", "message": "Add automatic test of generated sounds.json\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:11:22Z", "type": "commit"}, {"oid": "1fa72c2c3a30afe7d8f2061eb3ada005dff5cebc", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/1fa72c2c3a30afe7d8f2061eb3ada005dff5cebc", "message": "Fix merge conflicts and address PR comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:18:47Z", "type": "forcePushed"}, {"oid": "0489737595efa1ecf12c48329f2061dda64745c6", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/0489737595efa1ecf12c48329f2061dda64745c6", "message": "Fix merge conflicts and address PR comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:20:13Z", "type": "forcePushed"}, {"oid": "e89911def42c315bb573f212a1de5e2a37b1fb4e", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e89911def42c315bb573f212a1de5e2a37b1fb4e", "message": "Fix merge conflicts and address PR comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:22:14Z", "type": "commit"}, {"oid": "e89911def42c315bb573f212a1de5e2a37b1fb4e", "url": "https://github.com/MinecraftForge/MinecraftForge/commit/e89911def42c315bb573f212a1de5e2a37b1fb4e", "message": "Fix merge conflicts and address PR comments\n\nSigned-off-by: TheSilkMiner <thesilkminer@outlook.com>", "committedDate": "2021-07-01T16:22:14Z", "type": "forcePushed"}]}