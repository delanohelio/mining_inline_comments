{"pr_number": 1973, "pr_title": "#1310 add executor user to the process instance & task instance pages", "pr_createdAt": "2020-02-18T08:56:00Z", "pr_url": "https://github.com/apache/dolphinscheduler/pull/1973", "timeline": [{"oid": "665349a979b36d96d3943ec84dae9b474ab9e7a7", "url": "https://github.com/apache/dolphinscheduler/commit/665349a979b36d96d3943ec84dae9b474ab9e7a7", "message": "add executor name in processDefinitionInstance & taskInstance", "committedDate": "2020-02-16T11:39:18Z", "type": "commit"}, {"oid": "088f9bd6f9b96ed8471cbe90d941b02053d38ca6", "url": "https://github.com/apache/dolphinscheduler/commit/088f9bd6f9b96ed8471cbe90d941b02053d38ca6", "message": "Merge branch 'dev' of https://github.com/apache/incubator-dolphinscheduler into dev", "committedDate": "2020-02-16T11:40:46Z", "type": "commit"}, {"oid": "63cd0f10c75892dddb384b761b4c3cb34e9ddbf0", "url": "https://github.com/apache/dolphinscheduler/commit/63cd0f10c75892dddb384b761b4c3cb34e9ddbf0", "message": "modify processInstanceTest", "committedDate": "2020-02-16T13:51:50Z", "type": "commit"}, {"oid": "ba65ba768f569fd476ae77b8798b426a6c0f6ed6", "url": "https://github.com/apache/dolphinscheduler/commit/ba65ba768f569fd476ae77b8798b426a6c0f6ed6", "message": "modify processInstanceTest", "committedDate": "2020-02-17T11:21:19Z", "type": "commit"}, {"oid": "c8941b353e077cf6bfd28fadd8eb30221cc0495f", "url": "https://github.com/apache/dolphinscheduler/commit/c8941b353e077cf6bfd28fadd8eb30221cc0495f", "message": "#1310 add executor user to the process instance & task instance pages", "committedDate": "2020-02-18T05:37:23Z", "type": "commit"}, {"oid": "1d94c462f9a36193d7d90eeb3a5ecf79b68434e8", "url": "https://github.com/apache/dolphinscheduler/commit/1d94c462f9a36193d7d90eeb3a5ecf79b68434e8", "message": "Merge branch 'dev-instance' of https://github.com/Eights-Li/incubator-dolphinscheduler into dev-instance", "committedDate": "2020-02-18T05:38:01Z", "type": "commit"}, {"oid": "2b6ed6fa9838c5538466e589b152619d3d3a31a3", "url": "https://github.com/apache/dolphinscheduler/commit/2b6ed6fa9838c5538466e589b152619d3d3a31a3", "message": "add processInstanceUT & taskInstanceUT", "committedDate": "2020-02-18T08:03:29Z", "type": "commit"}, {"oid": "1f9fab51672122bb5924650a447169847404166a", "url": "https://github.com/apache/dolphinscheduler/commit/1f9fab51672122bb5924650a447169847404166a", "message": "add processInstanceUT & taskInstanceUT", "committedDate": "2020-02-18T09:08:09Z", "type": "commit"}, {"oid": "a564142f5d7da6f38948fa8d3ee817a8fab2692b", "url": "https://github.com/apache/dolphinscheduler/commit/a564142f5d7da6f38948fa8d3ee817a8fab2692b", "message": "modify processInstanceTest & taskInstanceTest", "committedDate": "2020-02-18T11:10:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTA0MjE0NA==", "url": "https://github.com/apache/dolphinscheduler/pull/1973#discussion_r381042144", "bodyText": "Can duplicate code be refactored together\uff1f\nSuggest that put these them in UserService.", "author": "lenboo", "createdAt": "2020-02-19T02:12:45Z", "path": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/TaskInstanceService.java", "diffHunk": "@@ -111,18 +116,35 @@\n             return result;\n         }\n \n+\n         Page<TaskInstance> page = new Page(pageNo, pageSize);\n+        PageInfo pageInfo = new PageInfo<TaskInstance>(pageNo, pageSize);\n+\n+        //executor name query\n+        int executorId = 0;\n+        if (StringUtils.isNotEmpty(executorName)) {", "originalCommit": "a564142f5d7da6f38948fa8d3ee817a8fab2692b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTA1NDU4OQ==", "url": "https://github.com/apache/dolphinscheduler/pull/1973#discussion_r381054589", "bodyText": "thx, i will fix it", "author": "Eights-Li", "createdAt": "2020-02-19T03:05:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTA0MjE0NA=="}], "type": "inlineReview", "revised_code": {"commit": "0cdd757bdb761cc4c71395d7d008484f3be4d193", "chunk": "diff --git a/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/TaskInstanceService.java b/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/TaskInstanceService.java\nindex 922bb1d10..e4fec5439 100644\n--- a/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/TaskInstanceService.java\n+++ b/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/TaskInstanceService.java\n\n@@ -116,20 +116,9 @@ public class TaskInstanceService extends BaseService {\n             return result;\n         }\n \n-\n         Page<TaskInstance> page = new Page(pageNo, pageSize);\n         PageInfo pageInfo = new PageInfo<TaskInstance>(pageNo, pageSize);\n-\n-        //executor name query\n-        int executorId = 0;\n-        if (StringUtils.isNotEmpty(executorName)) {\n-            User executor = usersService.queryUser(executorName);\n-            if (null != executor) {\n-                executorId = executor.getId();\n-            } else {\n-                executorId = -1;\n-            }\n-        }\n+        int executorId = usersService.getUserIdByName(executorName);\n \n         IPage<TaskInstance> taskInstanceIPage = taskInstanceMapper.queryTaskInstanceListPaging(\n                 page, project.getId(), processInstanceId, searchVal, taskName, executorId, statusArray, host, start, end\n"}}, {"oid": "0cdd757bdb761cc4c71395d7d008484f3be4d193", "url": "https://github.com/apache/dolphinscheduler/commit/0cdd757bdb761cc4c71395d7d008484f3be4d193", "message": "Remove duplicate code", "committedDate": "2020-02-19T03:03:47Z", "type": "commit"}, {"oid": "b417dfcd9a5d4e3332d5e4f079b08cdb86decfd9", "url": "https://github.com/apache/dolphinscheduler/commit/b417dfcd9a5d4e3332d5e4f079b08cdb86decfd9", "message": "add userServiceUT", "committedDate": "2020-02-19T04:46:27Z", "type": "commit"}]}