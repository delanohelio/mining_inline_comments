{"pr_number": 3186, "pr_title": "[Feature-2574][Server]Specify Network Interface", "pr_createdAt": "2020-07-10T16:40:00Z", "pr_url": "https://github.com/apache/dolphinscheduler/pull/3186", "timeline": [{"oid": "b140bc963c0affc7c3734f5e91e876345a88cb00", "url": "https://github.com/apache/dolphinscheduler/commit/b140bc963c0affc7c3734f5e91e876345a88cb00", "message": "[Feature-2574][Server]Specify Network Interface\nThis closes #2574", "committedDate": "2020-07-10T16:24:43Z", "type": "commit"}, {"oid": "635724a6ab6623733b25f9d8ef802420f62fb36a", "url": "https://github.com/apache/dolphinscheduler/commit/635724a6ab6623733b25f9d8ef802420f62fb36a", "message": "Merge branch 'dev' into #2574", "committedDate": "2020-07-10T16:42:39Z", "type": "commit"}, {"oid": "32d4d8b79d068ec037bf86106cec324f258e2ca1", "url": "https://github.com/apache/dolphinscheduler/commit/32d4d8b79d068ec037bf86106cec324f258e2ca1", "message": "code smell", "committedDate": "2020-07-10T17:19:34Z", "type": "commit"}, {"oid": "238634b40cb5725a6aa53b8f5dfccf60740be186", "url": "https://github.com/apache/dolphinscheduler/commit/238634b40cb5725a6aa53b8f5dfccf60740be186", "message": "Merge remote-tracking branch 'origin/#2574' into #2574", "committedDate": "2020-07-10T17:19:53Z", "type": "commit"}, {"oid": "ad1f8292174054b18e60e7b3ae7bc0fc75bfab6e", "url": "https://github.com/apache/dolphinscheduler/commit/ad1f8292174054b18e60e7b3ae7bc0fc75bfab6e", "message": "code smell", "committedDate": "2020-07-10T17:30:26Z", "type": "commit"}, {"oid": "872762e9a488a6eefc7219f34f960cb09fc5ae2b", "url": "https://github.com/apache/dolphinscheduler/commit/872762e9a488a6eefc7219f34f960cb09fc5ae2b", "message": "Merge branch 'dev' into #2574", "committedDate": "2020-07-11T01:49:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1MDkyNQ==", "url": "https://github.com/apache/dolphinscheduler/pull/3186#discussion_r453150925", "bodyText": "Hi,\nGood job,\nUtils should be used as a tool class and it is better not to involve business process.\nIs it better to implement this part in the business process class?", "author": "yangyichao-mango", "createdAt": "2020-07-11T03:52:13Z", "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java", "diffHunk": "@@ -206,4 +215,8 @@ public static boolean ignoreNetworkInterface(NetworkInterface networkInterface)\n                 || !networkInterface.isUp();\n     }\n \n+    public static boolean isSpecifyNetworkInterface(NetworkInterface networkInterface) {\n+        String preferredNetworkInterface = System.getProperty(DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE);\n+        return Objects.equals(networkInterface.getDisplayName(), preferredNetworkInterface);\n+    }", "originalCommit": "872762e9a488a6eefc7219f34f960cb09fc5ae2b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1NDQ2OA==", "url": "https://github.com/apache/dolphinscheduler/pull/3186#discussion_r453154468", "bodyText": "Hello, this is exclusive to net, other business is not involved, so I think it is better to achieve here,how do you think\uff1f", "author": "CalvinKirs", "createdAt": "2020-07-11T04:37:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1MDkyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzIwMjc4NQ==", "url": "https://github.com/apache/dolphinscheduler/pull/3186#discussion_r453202785", "bodyText": "Hello, this is exclusive to net, other business is not involved, so I think it is better to achieve here,how do you think\uff1f\n\n\nHi,\nI think it is better not to add the isSpecifyNetworkInterface in findNetworkInterface of utils, but I find there is only one call of findNetworkInterface, so I don't think of a better place to add this at present.\nI think we can think about the implement scheme again later.", "author": "yangyichao-mango", "createdAt": "2020-07-11T14:57:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1MDkyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NzQwMDk4Mw==", "url": "https://github.com/apache/dolphinscheduler/pull/3186#discussion_r587400983", "bodyText": "I think this modify like this, the name is more better.\n private static boolean isSpecifyNetworkInterface(NetworkInterface networkInterface) {\n        String preferredNetworkInterface = PropertyUtils.getString(DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE);\n        logger.info(\"config name:{}, net work interface: {}, addrs: {}\",\n                preferredNetworkInterface,  networkInterface, networkInterface.getInterfaceAddresses());\n        return Objects.equals(networkInterface.getName(), preferredNetworkInterface) || \n                Objects.equals(networkInterface.getDisplayName(), preferredNetworkInterface);\n    }\n\ncommon.properties add interface config\n# Network Interface name\n#dolphin.scheduler.network.interface.preferred=eth0", "author": "szs122", "createdAt": "2021-03-04T11:43:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1MDkyNQ=="}], "type": "inlineReview", "revised_code": {"commit": "0f706830968d1b8b51ad1c03774d08e9c59f36f3", "chunk": "diff --git a/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java b/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java\nindex 99d135eae..13a25dc63 100644\n--- a/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java\n+++ b/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java\n\n@@ -215,7 +214,7 @@ public class NetUtils {\n                 || !networkInterface.isUp();\n     }\n \n-    public static boolean isSpecifyNetworkInterface(NetworkInterface networkInterface) {\n+    private static boolean isSpecifyNetworkInterface(NetworkInterface networkInterface) {\n         String preferredNetworkInterface = System.getProperty(DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE);\n         return Objects.equals(networkInterface.getDisplayName(), preferredNetworkInterface);\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1MDk5Mg==", "url": "https://github.com/apache/dolphinscheduler/pull/3186#discussion_r453150992", "bodyText": "Hi,\nIs it better to move DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE to Constants.java?", "author": "yangyichao-mango", "createdAt": "2020-07-11T03:53:05Z", "path": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java", "diffHunk": "@@ -51,6 +48,8 @@ private NetUtils() {\n \n     private static volatile String HOST_ADDRESS;\n \n+    private static  String DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE = \"dolphin.scheduler.network.interface.preferred\";\n+", "originalCommit": "872762e9a488a6eefc7219f34f960cb09fc5ae2b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1NDU2Ng==", "url": "https://github.com/apache/dolphinscheduler/pull/3186#discussion_r453154566", "bodyText": "Thanks for your suggestions, I have completed the changes.", "author": "CalvinKirs", "createdAt": "2020-07-11T04:39:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzE1MDk5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "0f706830968d1b8b51ad1c03774d08e9c59f36f3", "chunk": "diff --git a/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java b/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java\nindex 99d135eae..13a25dc63 100644\n--- a/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java\n+++ b/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/NetUtils.java\n\n@@ -48,8 +49,6 @@ public class NetUtils {\n \n     private static volatile String HOST_ADDRESS;\n \n-    private static  String DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE = \"dolphin.scheduler.network.interface.preferred\";\n-\n     public static String getHost() {\n         if (HOST_ADDRESS != null) {\n             return HOST_ADDRESS;\n"}}, {"oid": "0f706830968d1b8b51ad1c03774d08e9c59f36f3", "url": "https://github.com/apache/dolphinscheduler/commit/0f706830968d1b8b51ad1c03774d08e9c59f36f3", "message": "move DOLPHIN_SCHEDULER_PREFERRED_NETWORK_INTERFACE to Constants.java", "committedDate": "2020-07-11T04:35:41Z", "type": "commit"}, {"oid": "58c47c0f2bc17a871737616f1a0188d3e354943c", "url": "https://github.com/apache/dolphinscheduler/commit/58c47c0f2bc17a871737616f1a0188d3e354943c", "message": "Merge branch 'dev' into #2574", "committedDate": "2020-07-12T05:32:03Z", "type": "commit"}]}