{"pr_number": 8526, "pr_title": "Update material check connection in case pipeline name is not provided", "pr_createdAt": "2020-09-07T10:08:57Z", "pr_url": "https://github.com/gocd/gocd/pull/8526", "timeline": [{"oid": "c2ba56b3b6e14a9121a44883f3584af4133e455e", "url": "https://github.com/gocd/gocd/commit/c2ba56b3b6e14a9121a44883f3584af4133e455e", "message": "Update material check connection in case pipeline name is not provided\n\n - In case of check connection from new pipeline wizard, the pipeline name is not provided. Hence param expansion was not done.\n   But it also caused the # to not being escaped. Hence, creating a dummy pipeline config object for such cases", "committedDate": "2020-09-07T09:54:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDYyODUyOQ==", "url": "https://github.com/gocd/gocd/pull/8526#discussion_r484628529", "bodyText": "@kritika-singh3 do you think we can add a test for these scenarios over adding a comment?", "author": "maheshp", "createdAt": "2020-09-08T03:20:11Z", "path": "api/api-abstract-material-test/src/main/java/com/thoughtworks/go/api/abstractmaterialtest/AbstractMaterialTestController.java", "diffHunk": "@@ -126,12 +123,18 @@ private String handleValidationBeanResponse(ValidationBean validationBean, Respo\n     }\n \n     private void performParamExpansion(ScmMaterialConfig scmMaterialConfig, String pipelineName) {\n-        PipelineConfig existingPipeline = goConfigService.pipelineConfigNamed(new CaseInsensitiveString(pipelineName));\n-        PipelineConfig pipelineConfig = new PipelineConfig(existingPipeline.name(), new MaterialConfigs());\n-\n-        GoConfigCloner goConfigCloner = new GoConfigCloner();\n-        pipelineConfig.setParams(goConfigCloner.deepClone(existingPipeline.getParams()));\n+        PipelineConfig pipelineConfig;\n+        // If the pipeline name is provided, find the pipeline and add the params to the new pipeline config object\n+        if (isNotBlank(pipelineName)) {\n+            PipelineConfig existingPipeline = goConfigService.pipelineConfigNamed(new CaseInsensitiveString(pipelineName));\n+            pipelineConfig = new PipelineConfig(existingPipeline.name(), new MaterialConfigs());\n \n+            GoConfigCloner goConfigCloner = new GoConfigCloner();\n+            pipelineConfig.setParams(goConfigCloner.deepClone(existingPipeline.getParams()));\n+        } else {\n+            // If the pipeline name is not provided, this means that the pipeline is still in creation nd hence no params exist", "originalCommit": "c2ba56b3b6e14a9121a44883f3584af4133e455e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}