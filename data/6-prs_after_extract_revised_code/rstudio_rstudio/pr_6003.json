{"pr_number": 6003, "pr_title": "use aria-pressed to make LatchingToolbarButton a toggle button", "pr_createdAt": "2020-01-13T05:23:27Z", "pr_url": "https://github.com/rstudio/rstudio/pull/6003", "timeline": [{"oid": "7ced411c8a722851076130a8009c04f82437dcfb", "url": "https://github.com/rstudio/rstudio/commit/7ced411c8a722851076130a8009c04f82437dcfb", "message": "use aria-pressed to make LatchingToolbarButton a toggle button\n\n- in one use of this control (for showing/hiding document outline), the accessibility text is changed to indicate the state of the button; in that situation it is NOT appropriate to use aria-pressed as the text is sufficient to tell screen readers what is going on\n- in the other use, the Filter button in the data viewer, the text does not change, so aria-pressed is required to indicate that this is a toggle button and to indicate what state it is currently in", "committedDate": "2020-01-13T05:21:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTY4NTAxMQ==", "url": "https://github.com/rstudio/rstudio/pull/6003#discussion_r365685011", "bodyText": "Could be worth pulling these out into a local helper method that's merely setAriaPressedState(TRUE/FALSE) and it does the if check and the longer incantation (if you ever get tired of copy/pasting all that across all these!)", "author": "adamconroy", "createdAt": "2020-01-13T08:32:48Z", "path": "src/gwt/src/org/rstudio/core/client/widget/LatchingToolbarButton.java", "diffHunk": "@@ -39,10 +49,19 @@ public void setLatched(boolean latched)\n       latched_ = latched;\n       \n       if (latched_)\n+      {\n+         if (!textIndicatesState_)\n+            Roles.getButtonRole().setAriaPressedState(getElement(), PressedValue.TRUE);\n          getElement().addClassName(ThemeStyles.INSTANCE.toolbarButtonLatched());\n+      }\n       else\n+      {\n+         if (!textIndicatesState_)\n+            Roles.getButtonRole().setAriaPressedState(getElement(), PressedValue.FALSE);", "originalCommit": "7ced411c8a722851076130a8009c04f82437dcfb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}