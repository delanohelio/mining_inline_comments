{"pr_number": 8380, "pr_title": "ensure focus set on file.edit call", "pr_createdAt": "2020-11-14T00:02:28Z", "pr_url": "https://github.com/rstudio/rstudio/pull/8380", "timeline": [{"oid": "7f24fb0124bdbc7c35bff148441e9bc620c69ded", "url": "https://github.com/rstudio/rstudio/commit/7f24fb0124bdbc7c35bff148441e9bc620c69ded", "message": "ensure focus set on file.edit call", "committedDate": "2020-11-14T00:00:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzMwNDA3Ng==", "url": "https://github.com/rstudio/rstudio/pull/8380#discussion_r523304076", "bodyText": "I don't get this part of the change -- it looks like this was the only place where we read the focusOnNavigate flag. Is the flag still necessary?", "author": "jmcphers", "createdAt": "2020-11-14T00:53:18Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/views/source/Source.java", "diffHunk": "@@ -1948,13 +1948,8 @@ public void execute(EditingTarget target)\n             // helper command to focus after navigation has completed\n             final Command onNavigationCompleted = () ->\n             {\n-               if (file.focusOnNavigate())\n-               {\n-                  Scheduler.get().scheduleDeferred(() ->\n-                  {\n-                     target.focus();\n-                  });\n-               }\n+               events_.fireEvent(new SuppressNextShellFocusEvent());\n+               target.focus();", "originalCommit": "7f24fb0124bdbc7c35bff148441e9bc620c69ded", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzM0OTQwMQ==", "url": "https://github.com/rstudio/rstudio/pull/8380#discussion_r523349401", "bodyText": "It is -- I removed that code unintentionally. What's the brain equivalent of a typo?", "author": "kevinushey", "createdAt": "2020-11-14T02:20:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzMwNDA3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "e9a495142b94749e07a96db0d99a4f2709003025", "chunk": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/Source.java b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/Source.java\nindex b9d99b0c8a..8f40b7dd15 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/Source.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/Source.java\n\n@@ -1948,8 +1948,11 @@ public class Source implements InsertSourceHandler,\n             // helper command to focus after navigation has completed\n             final Command onNavigationCompleted = () ->\n             {\n-               events_.fireEvent(new SuppressNextShellFocusEvent());\n-               target.focus();\n+               if (file.focusOnNavigate())\n+               {\n+                  events_.fireEvent(new SuppressNextShellFocusEvent());\n+                  target.focus();\n+               }\n             };\n \n \n"}}, {"oid": "e9a495142b94749e07a96db0d99a4f2709003025", "url": "https://github.com/rstudio/rstudio/commit/e9a495142b94749e07a96db0d99a4f2709003025", "message": "fix brain-o", "committedDate": "2020-11-14T02:17:41Z", "type": "commit"}]}