{"pr_number": 6976, "pr_title": "cpp completion manager needs to explicitly handle keys", "pr_createdAt": "2020-05-27T21:37:57Z", "pr_url": "https://github.com/rstudio/rstudio/pull/6976", "timeline": [{"oid": "194c67e48b21a38a1cf68985392ef9ce9e39437a", "url": "https://github.com/rstudio/rstudio/commit/194c67e48b21a38a1cf68985392ef9ce9e39437a", "message": "cpp completion manager needs to explicitly handle keys", "committedDate": "2020-05-27T21:36:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk1NzM5NQ==", "url": "https://github.com/rstudio/rstudio/pull/6976#discussion_r431957395", "bodyText": "For parity with the old behavior, please also add support for home, end, PgUp and PgDn. This is what got removed, essentially:\n                     case KeyCodes.KEY_PAGEDOWN:\n                        moveSelectionFwd(5);\n                        break;\n                     case KeyCodes.KEY_PAGEUP:\n                        moveSelectionBwd(5);\n                        break;\n                     case KeyCodes.KEY_HOME:\n                        selectFirst();\n                        break;\n                     case KeyCodes.KEY_END:\n                        selectLast();\n                        break;", "author": "gtritchie", "createdAt": "2020-05-28T16:12:50Z", "path": "src/gwt/src/org/rstudio/studio/client/workbench/views/source/editors/text/cpp/CppCompletionManager.java", "diffHunk": "@@ -210,21 +210,27 @@ else if (event.getKeyCode() == 113 // F2\n             case KeyCodes.KEY_N: return popup.selectNext();\n             }\n          }\n-             \n+         \n+         // allow navigation with arrow keys\n+         // (needs to be handled here as the popup will not be explicitly focused)\n+         if (modifier == KeyboardShortcut.NONE)\n+         {\n+            switch (keyCode)\n+            {\n+            case KeyCodes.KEY_UP:    return popup.selectPrev();\n+            case KeyCodes.KEY_DOWN:  return popup.selectNext();\n+            case KeyCodes.KEY_ENTER: return popup.acceptSelected();\n+            case KeyCodes.KEY_TAB:   return popup.acceptSelected();\n+            }\n+         }\n+         ", "originalCommit": "194c67e48b21a38a1cf68985392ef9ce9e39437a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d51bbd966cf55f99603905f013b26096f481b1eb", "chunk": "diff --git a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/editors/text/cpp/CppCompletionManager.java b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/editors/text/cpp/CppCompletionManager.java\nindex 9c8cce2174..ab2250a813 100644\n--- a/src/gwt/src/org/rstudio/studio/client/workbench/views/source/editors/text/cpp/CppCompletionManager.java\n+++ b/src/gwt/src/org/rstudio/studio/client/workbench/views/source/editors/text/cpp/CppCompletionManager.java\n\n@@ -217,10 +217,14 @@ public class CppCompletionManager implements CompletionManager\n          {\n             switch (keyCode)\n             {\n-            case KeyCodes.KEY_UP:    return popup.selectPrev();\n-            case KeyCodes.KEY_DOWN:  return popup.selectNext();\n-            case KeyCodes.KEY_ENTER: return popup.acceptSelected();\n-            case KeyCodes.KEY_TAB:   return popup.acceptSelected();\n+            case KeyCodes.KEY_UP:       popup.selectPrev();        return true;\n+            case KeyCodes.KEY_DOWN:     popup.selectNext();        return true;\n+            case KeyCodes.KEY_PAGEUP:   popup.moveSelectionBwd(5); return true;\n+            case KeyCodes.KEY_PAGEDOWN: popup.moveSelectionFwd(5); return true;\n+            case KeyCodes.KEY_HOME:     popup.selectFirst();       return true;\n+            case KeyCodes.KEY_END:      popup.selectLast();        return true;\n+            case KeyCodes.KEY_ENTER:    popup.acceptSelected();    return true;\n+            case KeyCodes.KEY_TAB:      popup.acceptSelected();    return true;\n             }\n          }\n          \n"}}, {"oid": "d51bbd966cf55f99603905f013b26096f481b1eb", "url": "https://github.com/rstudio/rstudio/commit/d51bbd966cf55f99603905f013b26096f481b1eb", "message": "implement other navigation keys for cpp popup", "committedDate": "2020-05-28T17:44:09Z", "type": "commit"}]}