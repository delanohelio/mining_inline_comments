{"pr_number": 1947, "pr_title": "bigtable hbase: read and filter snippets", "pr_createdAt": "2020-01-14T03:37:20Z", "pr_url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/1947", "timeline": [{"oid": "b7cf3212ab3f84eb75bb9ff749c2186b2cbe62ae", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/b7cf3212ab3f84eb75bb9ff749c2186b2cbe62ae", "message": "Read and filter snippets for Hbase Bigtable\nReads done\nFilters WIP, issues with Pass and ColRange. Some nuances to sort out\nbetween HBase and other clients still", "committedDate": "2020-01-13T02:39:49Z", "type": "commit"}, {"oid": "89f39bed3beabbe0ec4103085b91def798a1b6ac", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/89f39bed3beabbe0ec4103085b91def798a1b6ac", "message": "Filter snippets", "committedDate": "2020-01-14T03:35:37Z", "type": "commit"}, {"oid": "55bbc629ab84085f209e06070875904b4e2e0ed0", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/55bbc629ab84085f209e06070875904b4e2e0ed0", "message": "Merge branch 'master' into bigtable-read-filters-hbase", "committedDate": "2020-01-14T03:37:53Z", "type": "commit"}, {"oid": "aeac23b8b495eb006f9bb1474e736c70991cf939", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/aeac23b8b495eb006f9bb1474e736c70991cf939", "message": "Remove unused region tags", "committedDate": "2020-01-14T04:33:00Z", "type": "commit"}, {"oid": "51d3a6e751be4dc2eff31ad4d564f9b2658acba7", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/51d3a6e751be4dc2eff31ad4d564f9b2658acba7", "message": "Merge branch 'master' into bigtable-read-filters-hbase", "committedDate": "2020-01-14T17:49:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4NjI1OA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/1947#discussion_r366486258", "bodyText": "Should there be a discussion of key design?  Having a common prefix is ok for tests, but it's exactly the pattern we are trying to discourage users from doing.", "author": "lesv", "createdAt": "2020-01-14T17:56:23Z", "path": "bigtable/hbase/snippets/src/test/java/com/example/bigtable/ReadsTest.java", "diffHunk": "@@ -0,0 +1,346 @@\n+/*\n+ * Copyright 2019 Google LLC\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package com.example.bigtable;\n+\n+import static com.google.common.truth.Truth.assertThat;\n+import static org.junit.Assert.assertNotNull;\n+\n+import com.google.cloud.bigtable.admin.v2.BigtableTableAdminClient;\n+import com.google.cloud.bigtable.admin.v2.models.CreateTableRequest;\n+import com.google.cloud.bigtable.data.v2.BigtableDataClient;\n+import com.google.cloud.bigtable.data.v2.models.BulkMutation;\n+import com.google.cloud.bigtable.data.v2.models.Mutation;\n+import com.google.protobuf.ByteString;\n+import java.io.ByteArrayOutputStream;\n+import java.io.IOException;\n+import java.io.PrintStream;\n+import java.util.UUID;\n+import org.junit.AfterClass;\n+import org.junit.Before;\n+import org.junit.BeforeClass;\n+import org.junit.FixMethodOrder;\n+import org.junit.Test;\n+import org.junit.runners.MethodSorters;\n+\n+@FixMethodOrder(MethodSorters.NAME_ASCENDING)\n+public class ReadsTest {\n+\n+  private static final String INSTANCE_ENV = \"BIGTABLE_TESTING_INSTANCE\";\n+  private static final String TABLE_ID =\n+      \"mobile-time-series-\" + UUID.randomUUID().toString().substring(0, 20);\n+  private static final String COLUMN_FAMILY_NAME = \"stats_summary\";\n+  private static final long TIMESTAMP = System.currentTimeMillis();\n+  private static final long TIMESTAMP_NANO = TIMESTAMP * 1000;\n+\n+  private static String projectId;\n+  private static String instanceId;\n+  private ByteArrayOutputStream bout;\n+\n+  private static String requireEnv(String varName) {\n+    String value = System.getenv(varName);\n+    assertNotNull(\n+        String.format(\"Environment variable '%s' is required to perform these tests.\", varName),\n+        value);\n+    return value;\n+  }\n+\n+  @BeforeClass\n+  public static void beforeClass() throws IOException {\n+    projectId = requireEnv(\"GOOGLE_CLOUD_PROJECT\");\n+    instanceId = requireEnv(INSTANCE_ENV);\n+\n+    try (BigtableTableAdminClient adminClient =\n+        BigtableTableAdminClient.create(projectId, instanceId)) {\n+      CreateTableRequest createTableRequest =\n+          CreateTableRequest.of(TABLE_ID).addFamily(COLUMN_FAMILY_NAME);\n+      adminClient.createTable(createTableRequest);\n+\n+      try (BigtableDataClient dataClient = BigtableDataClient.create(projectId, instanceId)) {", "originalCommit": "51d3a6e751be4dc2eff31ad4d564f9b2658acba7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjUzMzkyOA==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/1947#discussion_r366533928", "bodyText": "The schema is deviceType#deviceId#YYYYMMDD this was discussed and reviewed with members of the Bigtable team. This is only a small subset of data so we can't really show much variety", "author": "billyjacobson", "createdAt": "2020-01-14T19:37:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjQ4NjI1OA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "c4f293e84d05614f588f0ecfe7f5bad19c7eb61b", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/c4f293e84d05614f588f0ecfe7f5bad19c7eb61b", "message": "Merge branch 'master' into bigtable-read-filters-hbase", "committedDate": "2020-01-14T18:10:36Z", "type": "commit"}, {"oid": "0c88e412fe9348764451bb5253c508e15decad73", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/0c88e412fe9348764451bb5253c508e15decad73", "message": "Merge branch 'master' into bigtable-read-filters-hbase", "committedDate": "2020-01-14T19:37:40Z", "type": "commit"}]}