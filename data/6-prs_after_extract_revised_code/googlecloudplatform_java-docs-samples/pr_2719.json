{"pr_number": 2719, "pr_title": "automl: explictly update timeoutes due to default library changes", "pr_createdAt": "2020-04-21T22:18:39Z", "pr_url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719", "timeline": [{"oid": "65fccd99b576122cc0e46b712f3a10fbac47d4bd", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/65fccd99b576122cc0e46b712f3a10fbac47d4bd", "message": "automl: explictly update timeoutes due to library changes in the defaults", "committedDate": "2020-04-21T22:16:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDgwNg==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#discussion_r412530806", "bodyText": "@lesv, I wanted to make a note for the timeout that even though there is a timeout exception, the operation is still running in the background. But I still end up throwing the error.\nWhat's the best practice here?", "author": "nnegrey", "createdAt": "2020-04-21T22:19:38Z", "path": "automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java", "diffHunk": "@@ -55,8 +59,22 @@ static void importDataset(String projectId, String datasetId, String path)\n       InputConfig inputConfig = InputConfig.newBuilder().setGcsSource(gcsSource).build();\n       System.out.println(\"Processing import...\");\n \n-      Empty response = client.importDataAsync(datasetFullId, inputConfig).get();\n-      System.out.format(\"Dataset imported. %s\\n\", response);\n+      // Start the import job\n+      OperationFuture<Empty, OperationMetadata> operation =\n+          client.importDataAsync(datasetFullId, inputConfig);\n+\n+      System.out.format(\"Operation name: %s%n\", operation.getName());\n+\n+      // If you want to wait for the operation to finish, adjust the timeout appropriately. The\n+      // operation will still run if you choose not to wait for it to complete. You can check the\n+      // status of your operation using the operation's name.\n+      Empty response = operation.get(30, TimeUnit.MINUTES);\n+      System.out.format(\"Dataset imported. %s%n\", response);\n+    } catch (TimeoutException e) {\n+      System.out.println(\"The operation's polling period was not long enough.\");\n+      System.out.println(\"You can use the Operation's name to get the current status.\");\n+      System.out.println(\"The import job will still complete as expected.\");\n+      throw e;", "originalCommit": "65fccd99b576122cc0e46b712f3a10fbac47d4bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjU1Mzc3NQ==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#discussion_r412553775", "bodyText": "I'm good w/ this.  I'd prefer to see comments, but this is ok.\nThat said, you might be very clear by changing to:\nThe import job is still running and will complete as expected.", "author": "lesv", "createdAt": "2020-04-21T23:11:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDgwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA0Nzg5Nw==", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/pull/2719#discussion_r413047897", "bodyText": "Yea, I'll switch to that.", "author": "nnegrey", "createdAt": "2020-04-22T14:46:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjUzMDgwNg=="}], "type": "inlineReview", "revised_code": {"commit": "7e64cb0b4da0c07fd73c36b0666517d79b7ab623", "chunk": "diff --git a/automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java b/automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java\nindex 0fda7535b..a9d90669e 100644\n--- a/automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java\n+++ b/automl/cloud-client/src/main/java/com/example/automl/ImportDataset.java\n\n@@ -73,7 +73,7 @@ class ImportDataset {\n     } catch (TimeoutException e) {\n       System.out.println(\"The operation's polling period was not long enough.\");\n       System.out.println(\"You can use the Operation's name to get the current status.\");\n-      System.out.println(\"The import job will still complete as expected.\");\n+      System.out.println(\"The import job is still running and will complete as expected.\");\n       throw e;\n     }\n   }\n"}}, {"oid": "7e64cb0b4da0c07fd73c36b0666517d79b7ab623", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7e64cb0b4da0c07fd73c36b0666517d79b7ab623", "message": "Update ImportDataset.java", "committedDate": "2020-04-22T14:46:56Z", "type": "commit"}, {"oid": "962829dfc52cc506c8a0e348f14c026cc932b44d", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/962829dfc52cc506c8a0e348f14c026cc932b44d", "message": "try bumping timeout\n\nAutoML provides no guarantee on how long this could take and normally would send an email followup. Though normally, I see this finish in under 10 mins. Trying to pin down if TASK CANCELLED is actually related to a timeout or not.", "committedDate": "2020-04-22T19:20:28Z", "type": "commit"}, {"oid": "0b96bea21cdb21244b5902f746951287c022cb80", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/0b96bea21cdb21244b5902f746951287c022cb80", "message": "update timeouts for all import methods", "committedDate": "2020-04-24T15:25:08Z", "type": "commit"}, {"oid": "8cf0c8be2c0dfe5e3b2c52106e8bc6b5801bb451", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/8cf0c8be2c0dfe5e3b2c52106e8bc6b5801bb451", "message": "Merge branch 'master' into fix-automl-test", "committedDate": "2020-04-24T15:55:15Z", "type": "commit"}, {"oid": "bc7b94825557ee226ce3ada6727ffc33e3da89e5", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/bc7b94825557ee226ce3ada6727ffc33e3da89e5", "message": "undo changes to TablesImport, add catch for Cancellation Exception", "committedDate": "2020-04-24T16:12:23Z", "type": "commit"}, {"oid": "fdcfc5cd8ed7714083f0c5da9aa22cf92bc56718", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/fdcfc5cd8ed7714083f0c5da9aa22cf92bc56718", "message": "update to correct CancelledException", "committedDate": "2020-04-24T16:13:45Z", "type": "commit"}, {"oid": "a593a349c5531d7c803f84a40720220baadad4eb", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/a593a349c5531d7c803f84a40720220baadad4eb", "message": "wrong cancellation again", "committedDate": "2020-04-24T16:16:22Z", "type": "commit"}, {"oid": "858a7b610b9acc19477e23a299a77f88b87b6d2c", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/858a7b610b9acc19477e23a299a77f88b87b6d2c", "message": "run tests", "committedDate": "2020-04-24T16:49:18Z", "type": "commit"}, {"oid": "903409fe92aaafc904557dc1de05e806a2aeb0bb", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/903409fe92aaafc904557dc1de05e806a2aeb0bb", "message": "log to error", "committedDate": "2020-04-24T18:25:42Z", "type": "commit"}, {"oid": "29e9e6c477ac52420add556245df94df55c80ad0", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/29e9e6c477ac52420add556245df94df55c80ad0", "message": "test", "committedDate": "2020-04-24T19:42:06Z", "type": "commit"}, {"oid": "dafc662f0ca89985acd645f8615c395351e9fad4", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/dafc662f0ca89985acd645f8615c395351e9fad4", "message": "reset changes that printed error", "committedDate": "2020-04-24T20:07:39Z", "type": "commit"}, {"oid": "7c6cdbd393a672cda35f9ab4a4ec89a22a02daf8", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/7c6cdbd393a672cda35f9ab4a4ec89a22a02daf8", "message": "set retry settings", "committedDate": "2020-04-24T21:14:13Z", "type": "commit"}, {"oid": "6a5b968753de3dee6366dbc3e9b6e0e2d51ce374", "url": "https://github.com/GoogleCloudPlatform/java-docs-samples/commit/6a5b968753de3dee6366dbc3e9b6e0e2d51ce374", "message": "add timeout check to beta code", "committedDate": "2020-04-24T22:06:46Z", "type": "commit"}]}