{"pr_number": 211, "pr_title": "[MOB-1192] Remove animation from Dialog Fragment startup", "pr_createdAt": "2020-03-02T21:20:51Z", "pr_url": "https://github.com/Iterable/iterable-android-sdk/pull/211", "timeline": [{"oid": "d1d222ca05ca883467ce6f8707048c6b5699cf47", "url": "https://github.com/Iterable/iterable-android-sdk/commit/d1d222ca05ca883467ce6f8707048c6b5699cf47", "message": "[MOB-1192] Remove animation from Dialog Fragment startup\n\nHiding and showing in-app before resizing to avoid animation effect.", "committedDate": "2020-04-01T16:35:15Z", "type": "commit"}, {"oid": "a68612d8745741d2b0fd33e8ed08287790645a36", "url": "https://github.com/Iterable/iterable-android-sdk/commit/a68612d8745741d2b0fd33e8ed08287790645a36", "message": "Added webview status to have better granularity\n\nNow the resize script will be called when webview starts loading and also when the page is finished loading, removing the possibility of hiding the webview for long time caused due to delayed resource loading.\nFor Dialog implementation to have same experience as previous implementation, the resize script will be processed only if the webview status is loaded.", "committedDate": "2020-04-01T16:35:15Z", "type": "commit"}, {"oid": "4f589742753814a15944552819bb419a20757675", "url": "https://github.com/Iterable/iterable-android-sdk/commit/4f589742753814a15944552819bb419a20757675", "message": "Fix resizing in-apps, disable fullscreen for non-fullscreen in-apps", "committedDate": "2020-04-01T16:35:15Z", "type": "commit"}, {"oid": "5e91a3caaba5edf563c110fc2bb5f22f362189d6", "url": "https://github.com/Iterable/iterable-android-sdk/commit/5e91a3caaba5edf563c110fc2bb5f22f362189d6", "message": "Removing webview status variables\n\nNot required anymore as the page will be refreshed based on progress updates and not just start and finish", "committedDate": "2020-04-01T16:35:15Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NDYwOA==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/211#discussion_r404494608", "bodyText": "Do we not need this anymore?", "author": "vbabenkoru", "createdAt": "2020-04-07T02:08:32Z", "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppFragmentHTMLNotification.java", "diffHunk": "@@ -170,16 +157,13 @@ public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup c\n         if (orientationListener == null) {\n             orientationListener = new OrientationEventListener(getContext(), SensorManager.SENSOR_DELAY_NORMAL) {\n                 public void onOrientationChanged(int orientation) {\n-                    // Resize the webview on device rotation\n-                    if (loaded) {", "originalCommit": "5e91a3caaba5edf563c110fc2bb5f22f362189d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDU5OTE4MA==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/211#discussion_r404599180", "bodyText": "this was a boolean flag which was replaced with tri-state : not loaded, initialized and finished loading, which was then replaced by our new granular refresh.", "author": "Ayyanchira", "createdAt": "2020-04-07T07:37:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NDYwOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDk5Mjk4NQ==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/211#discussion_r404992985", "bodyText": "Hmm, but this was there before.. Was there a reason why we can't resize on rotation until it's loaded? Seems too specific.", "author": "vbabenkoru", "createdAt": "2020-04-07T17:39:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NDYwOA=="}], "type": "inlineReview", "revised_code": {"commit": "04ff474c9ea3e1016748ab781aa57dc2ed55cad6", "chunk": "diff --git a/iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppFragmentHTMLNotification.java b/iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppFragmentHTMLNotification.java\nindex 881af0b..98e5b39 100644\n--- a/iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppFragmentHTMLNotification.java\n+++ b/iterableapi/src/main/java/com/iterable/iterableapi/IterableInAppFragmentHTMLNotification.java\n\n@@ -157,13 +168,16 @@ public class IterableInAppFragmentHTMLNotification extends DialogFragment implem\n         if (orientationListener == null) {\n             orientationListener = new OrientationEventListener(getContext(), SensorManager.SENSOR_DELAY_NORMAL) {\n                 public void onOrientationChanged(int orientation) {\n-                    final Handler handler = new Handler();\n-                    handler.postDelayed(new Runnable() {\n-                        @Override\n-                        public void run() {\n-                            webView.loadUrl(IterableWebViewClient.resizeScript);\n-                        }\n-                    }, 1000);\n+                    // Resize the webview on device rotation\n+                    if (loaded) {\n+                        final Handler handler = new Handler();\n+                        handler.postDelayed(new Runnable() {\n+                            @Override\n+                            public void run() {\n+                                webView.loadUrl(IterableWebViewClient.resizeScript);\n+                            }\n+                        }, 1000);\n+                    }\n                 }\n             };\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NTEwMA==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/211#discussion_r404495100", "bodyText": "Looks like this is not doing anything.", "author": "vbabenkoru", "createdAt": "2020-04-07T02:10:15Z", "path": "iterableapi/src/main/java/com/iterable/iterableapi/IterableWebViewClient.java", "diffHunk": "@@ -27,19 +28,22 @@ public boolean shouldOverrideUrlLoading(WebView view, String url) {\n         return true;\n     }\n \n+    @Override\n+    public void onPageStarted(WebView view, String url, Bitmap favicon) {", "originalCommit": "5e91a3caaba5edf563c110fc2bb5f22f362189d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDYwNTMzNQ==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/211#discussion_r404605335", "bodyText": "Thanks...\nRemoved... \ud83d\udc4d", "author": "Ayyanchira", "createdAt": "2020-04-07T07:48:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ5NTEwMA=="}], "type": "inlineReview", "revised_code": {"commit": "fa6df6f13e00f97b5269b59cdbb9dec6d6d30351", "chunk": "diff --git a/iterableapi/src/main/java/com/iterable/iterableapi/IterableWebViewClient.java b/iterableapi/src/main/java/com/iterable/iterableapi/IterableWebViewClient.java\nindex 206179f..cfe2377 100644\n--- a/iterableapi/src/main/java/com/iterable/iterableapi/IterableWebViewClient.java\n+++ b/iterableapi/src/main/java/com/iterable/iterableapi/IterableWebViewClient.java\n\n@@ -28,11 +28,6 @@ class IterableWebViewClient extends WebViewClient {\n         return true;\n     }\n \n-    @Override\n-    public void onPageStarted(WebView view, String url, Bitmap favicon) {\n-        super.onPageStarted(view, url, favicon);\n-    }\n-\n     /**\n      * Resizes the view after the page has loaded\n      * @param view\n"}}, {"oid": "fa6df6f13e00f97b5269b59cdbb9dec6d6d30351", "url": "https://github.com/Iterable/iterable-android-sdk/commit/fa6df6f13e00f97b5269b59cdbb9dec6d6d30351", "message": "Removing webview status variables\n\nNot required anymore as the page will be refreshed based on progress updates and not just start and finish", "committedDate": "2020-04-07T07:41:33Z", "type": "forcePushed"}, {"oid": "04ff474c9ea3e1016748ab781aa57dc2ed55cad6", "url": "https://github.com/Iterable/iterable-android-sdk/commit/04ff474c9ea3e1016748ab781aa57dc2ed55cad6", "message": "Removing webview status variables\n\nNot required anymore as the page will be refreshed based on progress updates and not just start and finish", "committedDate": "2020-04-07T23:26:25Z", "type": "commit"}, {"oid": "04ff474c9ea3e1016748ab781aa57dc2ed55cad6", "url": "https://github.com/Iterable/iterable-android-sdk/commit/04ff474c9ea3e1016748ab781aa57dc2ed55cad6", "message": "Removing webview status variables\n\nNot required anymore as the page will be refreshed based on progress updates and not just start and finish", "committedDate": "2020-04-07T23:26:25Z", "type": "forcePushed"}]}