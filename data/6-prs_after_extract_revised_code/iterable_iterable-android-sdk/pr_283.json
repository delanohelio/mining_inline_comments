{"pr_number": 283, "pr_title": "[MOB-2341] Refactor tests to not depend on partial mocks", "pr_createdAt": "2020-11-11T22:25:44Z", "pr_url": "https://github.com/Iterable/iterable-android-sdk/pull/283", "timeline": [{"oid": "d10677860e0efb2ec12411a655cf78eb5a2d7a1d", "url": "https://github.com/Iterable/iterable-android-sdk/commit/d10677860e0efb2ec12411a655cf78eb5a2d7a1d", "message": "Replace partial mocking with constructor injection for InAppManager", "committedDate": "2020-11-11T22:24:42Z", "type": "commit"}, {"oid": "8dcccc1177490cb6547293a661150a93bfe77c06", "url": "https://github.com/Iterable/iterable-android-sdk/commit/8dcccc1177490cb6547293a661150a93bfe77c06", "message": "Remove individual iterableUtilSpy, use IterableUtilRule instead", "committedDate": "2020-11-11T22:29:08Z", "type": "commit"}, {"oid": "e1862dcbc0b8a812ad0515839636da80d31a7b35", "url": "https://github.com/Iterable/iterable-android-sdk/commit/e1862dcbc0b8a812ad0515839636da80d31a7b35", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()", "committedDate": "2020-11-11T23:36:34Z", "type": "forcePushed"}, {"oid": "4406d19119044d0fb34793b1820cd1208deeebd0", "url": "https://github.com/Iterable/iterable-android-sdk/commit/4406d19119044d0fb34793b1820cd1208deeebd0", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()", "committedDate": "2020-11-12T00:48:37Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTc1MTUwNg==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#discussion_r521751506", "bodyText": "\ud83d\udc4c", "author": "Ayyanchira", "createdAt": "2020-11-12T01:02:52Z", "path": "iterableapi/src/test/java/com/iterable/iterableapi/IterableInAppManagerSyncTest.java", "diffHunk": "@@ -75,11 +75,9 @@ public void testSyncOnLaunch() throws Exception {\n     @Test\n     public void testSyncOnLogin() throws Exception {\n         IterableInAppManager inAppManagerMock = mock(IterableInAppManager.class);\n-        IterableApi apiSpy = spy(new IterableApi());\n-        IterableApi.sharedInstance = apiSpy;\n+        IterableApi.sharedInstance = new IterableApi(inAppManagerMock);", "originalCommit": "4406d19119044d0fb34793b1820cd1208deeebd0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTc1Mjk3Ng==", "url": "https://github.com/Iterable/iterable-android-sdk/pull/283#discussion_r521752976", "bodyText": "few more line breaks here and down.. especially after \"fake key\"", "author": "Ayyanchira", "createdAt": "2020-11-12T01:05:16Z", "path": "iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java", "diffHunk": "@@ -205,7 +196,8 @@ public void testHandleUniversalLinkRewrite() throws Exception {\n \n     @Test\n     public void testSetEmailWithAutomaticPushRegistration() throws Exception {\n-        IterableApi.initialize(RuntimeEnvironment.application, \"fake_key\", new IterableConfig.Builder().setPushIntegrationName(\"pushIntegration\").setAutoPushRegistration(true).build());\n+        IterableApi.initialize(getContext(), \"fake_key\",\n+                new IterableConfig.Builder().setPushIntegrationName(\"pushIntegration\").setAutoPushRegistration(true).build());", "originalCommit": "4406d19119044d0fb34793b1820cd1208deeebd0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "chunk": "diff --git a/iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java b/iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java\nindex 2c3323f..1133bf4 100644\n--- a/iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java\n+++ b/iterableapi/src/test/java/com/iterable/iterableapi/IterableApiTest.java\n\n@@ -196,8 +195,7 @@ public class IterableApiTest extends BaseTest {\n \n     @Test\n     public void testSetEmailWithAutomaticPushRegistration() throws Exception {\n-        IterableApi.initialize(getContext(), \"fake_key\",\n-                new IterableConfig.Builder().setPushIntegrationName(\"pushIntegration\").setAutoPushRegistration(true).build());\n+        IterableApi.initialize(getContext(), \"fake_key\", new IterableConfig.Builder().setPushIntegrationName(\"pushIntegration\").setAutoPushRegistration(true).build());\n \n         // Check that setEmail calls registerForPush\n         IterableApi.getInstance().setEmail(\"test@email.com\");\n"}}, {"oid": "7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "url": "https://github.com/Iterable/iterable-android-sdk/commit/7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()", "committedDate": "2020-11-13T03:53:45Z", "type": "commit"}, {"oid": "7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "url": "https://github.com/Iterable/iterable-android-sdk/commit/7e4aec2f0b581ac72e14dc906eb85e81655f7d22", "message": "Replace deprecated RuntimeEnvironment.application with calls to getContext()", "committedDate": "2020-11-13T03:53:45Z", "type": "forcePushed"}]}