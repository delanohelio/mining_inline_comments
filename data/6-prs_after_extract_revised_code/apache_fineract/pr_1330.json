{"pr_number": 1330, "pr_title": "Interop KYC and Interop Loan Disbursement", "pr_createdAt": "2020-09-15T14:54:10Z", "pr_url": "https://github.com/apache/fineract/pull/1330", "timeline": [{"oid": "0a32c2a4255a63d35874849feaca3df77a20ef70", "url": "https://github.com/apache/fineract/commit/0a32c2a4255a63d35874849feaca3df77a20ef70", "message": "Interop get account KYC", "committedDate": "2020-09-15T09:13:28Z", "type": "commit"}, {"oid": "f200287e5557fe6f85eae431c1bef1131f3eea9d", "url": "https://github.com/apache/fineract/commit/f200287e5557fe6f85eae431c1bef1131f3eea9d", "message": "loan interop disbursement", "committedDate": "2020-09-15T12:10:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA5ODczNQ==", "url": "https://github.com/apache/fineract/pull/1330#discussion_r490098735", "bodyText": "Check permission for this action and entity (READ - CLIENTIDENTIFIER) ...context.authenticatedUser().validateHasReadPermission(ENTITY_NAME);", "author": "avikganguly01", "createdAt": "2020-09-17T09:21:20Z", "path": "fineract-provider/src/main/java/org/apache/fineract/interoperation/api/InteropApiResource.java", "diffHunk": "@@ -373,4 +374,29 @@ public String performTransfer(@QueryParam(\"action\") @Parameter(description = \"ac\n \n         return jsonSerializer.serialize(settings, result);\n     }\n+\n+    @GET\n+    @Consumes({ MediaType.APPLICATION_JSON })\n+    @Produces({ MediaType.APPLICATION_JSON })\n+    @Path(\"accounts/{accountId}/kyc\")\n+    @Operation(summary = \"Query KYC by Account Id\", description = \"\")\n+    @ApiResponses({\n+            @ApiResponse(responseCode = \"200\", description = \"OK\", content = @Content(schema = @Schema(implementation = InteropKycResponseData.class))) })\n+    public String getClientKyc(@PathParam(\"accountId\") @Parameter(description = \"accountId\") String accountId, @Context UriInfo uriInfo) {\n+        InteropKycResponseData result = interopService.getKyc(accountId);\n+        ApiRequestJsonSerializationSettings settings = this.apiRequestParameterHelper.process(uriInfo.getQueryParameters());", "originalCommit": "f200287e5557fe6f85eae431c1bef1131f3eea9d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA3Mzc4MA==", "url": "https://github.com/apache/fineract/pull/1330#discussion_r493073780", "bodyText": "Not sure how to do it. Can you point to a refernce implementation?", "author": "SubhamPramanik", "createdAt": "2020-09-22T22:41:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA5ODczNQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUyOTA4Mw==", "url": "https://github.com/apache/fineract/pull/1330#discussion_r490529083", "bodyText": "Remove this if you're not planning to use it.", "author": "avikganguly01", "createdAt": "2020-09-17T20:02:58Z", "path": "fineract-provider/src/main/java/org/apache/fineract/interoperation/service/InteropServiceImpl.java", "diffHunk": "@@ -437,6 +550,19 @@ private SavingsAccount validateAndGetSavingAccount(@NotNull InteropRequestData r\n         return savingsAccount;\n     }\n \n+    // private Loan validateAndGetLoan(@NotNull InteropRequestData request) {", "originalCommit": "f200287e5557fe6f85eae431c1bef1131f3eea9d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MzA3MzQ0Ng==", "url": "https://github.com/apache/fineract/pull/1330#discussion_r493073446", "bodyText": "Removed", "author": "SubhamPramanik", "createdAt": "2020-09-22T22:40:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDUyOTA4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "29b73950309be84c6b3a113ba6dfaa575598ee81", "chunk": "diff --git a/fineract-provider/src/main/java/org/apache/fineract/interoperation/service/InteropServiceImpl.java b/fineract-provider/src/main/java/org/apache/fineract/interoperation/service/InteropServiceImpl.java\nindex 752f136f9..4fb0fff9c 100644\n--- a/fineract-provider/src/main/java/org/apache/fineract/interoperation/service/InteropServiceImpl.java\n+++ b/fineract-provider/src/main/java/org/apache/fineract/interoperation/service/InteropServiceImpl.java\n\n@@ -550,19 +550,6 @@ public class InteropServiceImpl implements InteropService {\n         return savingsAccount;\n     }\n \n-    // private Loan validateAndGetLoan(@NotNull InteropRequestData request) {\n-    // Loan loan = validateAndGetLoan(request.getAccountId());\n-    //\n-    // ApplicationCurrency requestCurrency = currencyRepository.findOneByCode(request.getAmount().getCurrency());\n-    // if (!loan.getCurrency().getCode().equals(requestCurrency.getCode())) {\n-    // throw new UnsupportedOperationException(\"Account and request has different currencies!\");\n-    // }\n-    //\n-    // request.normalizeAmounts(loan.getCurrency());\n-    //\n-    // return loan;\n-    // }\n-\n     private BigDecimal calculateTotalTransferAmount(@NotNull InteropTransferRequestData request, @NotNull SavingsAccount savingsAccount) {\n         BigDecimal total = request.getAmount().getAmount();\n         MoneyData requestFee = request.getFspFee();\n"}}, {"oid": "29b73950309be84c6b3a113ba6dfaa575598ee81", "url": "https://github.com/apache/fineract/commit/29b73950309be84c6b3a113ba6dfaa575598ee81", "message": "checkstyle fix", "committedDate": "2020-09-22T21:46:56Z", "type": "commit"}, {"oid": "29b73950309be84c6b3a113ba6dfaa575598ee81", "url": "https://github.com/apache/fineract/commit/29b73950309be84c6b3a113ba6dfaa575598ee81", "message": "checkstyle fix", "committedDate": "2020-09-22T21:46:56Z", "type": "forcePushed"}]}