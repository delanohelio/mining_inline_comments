{"pr_number": 672, "pr_title": "P41216606:  Remove the dependencies from the platform specific manifest", "pr_createdAt": "2020-11-12T22:44:41Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/672", "timeline": [{"oid": "54126bb22117f481d837d933e73fe0eb2db1f99e", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/54126bb22117f481d837d933e73fe0eb2db1f99e", "message": "P41216606:  Remove the dependencies from the platform manisfet", "committedDate": "2020-11-12T22:41:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUxOTg4MQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/672#discussion_r522519881", "bodyText": "the empty check doesn't matter", "author": "MikeDombo", "createdAt": "2020-11-13T00:08:38Z", "path": "src/main/java/com/aws/greengrass/componentmanager/converter/RecipeLoader.java", "diffHunk": "@@ -84,12 +84,9 @@\n \n         PlatformSpecificManifest platformSpecificManifest = optionalPlatformSpecificManifest.get();\n \n-        // TODO: [P41216606]: delete after migration of global dependencies\n         Map<String, DependencyProperties> dependencyPropertiesMap = new HashMap<>();\n-        if (componentRecipe.getComponentDependencies() == null || componentRecipe.getComponentDependencies()\n+        if (componentRecipe.getComponentDependencies() != null && !componentRecipe.getComponentDependencies()", "originalCommit": "54126bb22117f481d837d933e73fe0eb2db1f99e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU0MjQ0OQ==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/672#discussion_r522542449", "bodyText": "Done", "author": "k-khatri", "createdAt": "2020-11-13T01:08:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUxOTg4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "9edd2d851362360274ffc6de6583dd10bac88b59", "chunk": "diff --git a/src/main/java/com/aws/greengrass/componentmanager/converter/RecipeLoader.java b/src/main/java/com/aws/greengrass/componentmanager/converter/RecipeLoader.java\nindex d1ffb2ac6d..bba71674fb 100644\n--- a/src/main/java/com/aws/greengrass/componentmanager/converter/RecipeLoader.java\n+++ b/src/main/java/com/aws/greengrass/componentmanager/converter/RecipeLoader.java\n\n@@ -85,8 +85,7 @@ public final class RecipeLoader {\n         PlatformSpecificManifest platformSpecificManifest = optionalPlatformSpecificManifest.get();\n \n         Map<String, DependencyProperties> dependencyPropertiesMap = new HashMap<>();\n-        if (componentRecipe.getComponentDependencies() != null && !componentRecipe.getComponentDependencies()\n-                .isEmpty()) {\n+        if (componentRecipe.getComponentDependencies() != null) {\n             dependencyPropertiesMap.putAll(componentRecipe.getComponentDependencies());\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUyMDAyNw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/672#discussion_r522520027", "bodyText": "change these assertions to look at the new dependencies", "author": "MikeDombo", "createdAt": "2020-11-13T00:09:10Z", "path": "src/test/java/com/aws/greengrass/componentmanager/converter/RecipeLoaderTest.java", "diffHunk": "@@ -98,13 +89,6 @@ void GIVEN_a_recipe_file_with_global_dependencies_WHEN_converts_THEN_fields_are_\n         assertThat(artifact.getArtifactUri().toString(), is(\"s3://some-bucket/hello_world.py\"));\n         assertThat(artifact.getChecksum(), is(\"d14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f\"));\n         assertThat(artifact.getAlgorithm(), is(\"SHA-256\"));\n-        assertThat(recipe.getDependencies().size(), is(2));", "originalCommit": "54126bb22117f481d837d933e73fe0eb2db1f99e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjU0MjM3OA==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/672#discussion_r522542378", "bodyText": "Done", "author": "k-khatri", "createdAt": "2020-11-13T01:08:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjUyMDAyNw=="}], "type": "inlineReview", "revised_code": {"commit": "9edd2d851362360274ffc6de6583dd10bac88b59", "chunk": "diff --git a/src/test/java/com/aws/greengrass/componentmanager/converter/RecipeLoaderTest.java b/src/test/java/com/aws/greengrass/componentmanager/converter/RecipeLoaderTest.java\nindex 3426a849f6..275b163fd6 100644\n--- a/src/test/java/com/aws/greengrass/componentmanager/converter/RecipeLoaderTest.java\n+++ b/src/test/java/com/aws/greengrass/componentmanager/converter/RecipeLoaderTest.java\n\n@@ -89,6 +98,13 @@ class RecipeLoaderTest {\n         assertThat(artifact.getArtifactUri().toString(), is(\"s3://some-bucket/hello_world.py\"));\n         assertThat(artifact.getChecksum(), is(\"d14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f\"));\n         assertThat(artifact.getAlgorithm(), is(\"SHA-256\"));\n+        assertThat(recipe.getDependencies().size(), is(2));\n+        assertThat(recipe.getDependencies(),\n+                hasEntry(\"BarService\", new DependencyProperties(\"^1.1\", DependencyType.SOFT)));\n+\n+        assertThat(recipe.getDependencies(),\n+                hasEntry(\"BazService\", new DependencyProperties(\"^2.0\", DependencyType.HARD)));\n+\n     }\n \n     @Test\n"}}, {"oid": "9edd2d851362360274ffc6de6583dd10bac88b59", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/9edd2d851362360274ffc6de6583dd10bac88b59", "message": "Keeping the assertions", "committedDate": "2020-11-13T01:07:15Z", "type": "commit"}, {"oid": "808ca77ea371ef4536ed956c3a049482e2ea157d", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/808ca77ea371ef4536ed956c3a049482e2ea157d", "message": "Merge branch 'master' into RecipeLoader", "committedDate": "2020-11-13T21:28:08Z", "type": "commit"}]}