{"pr_number": 679, "pr_title": "Temporarily get the filename from the presigned url so that it is gua\u2026", "pr_createdAt": "2020-11-13T06:33:10Z", "pr_url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/679", "timeline": [{"oid": "f68d90482edb884dcb8fd5ee8988835ec419e406", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/f68d90482edb884dcb8fd5ee8988835ec419e406", "message": "Temporarily get the filename from the presigned url so that it is guaranteed to be safe.", "committedDate": "2020-11-13T06:32:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjY4MjE1Nw==", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/pull/679#discussion_r522682157", "bodyText": "why not check it for null before doing complicated stuff?", "author": "MikeDombo", "createdAt": "2020-11-13T06:36:15Z", "path": "src/main/java/com/aws/greengrass/componentmanager/plugins/GreengrassRepositoryDownloader.java", "diffHunk": "@@ -157,7 +157,30 @@ public long getDownloadSize(ComponentIdentifier componentIdentifier, ComponentAr\n \n     @Override\n     public File getArtifactFile(Path artifactDir, ComponentArtifact artifact, ComponentIdentifier componentIdentifier) {\n-        return artifactDir.resolve(artifact.getFileName()).toFile();", "originalCommit": "f68d90482edb884dcb8fd5ee8988835ec419e406", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2460648b08365433cd58ae3e08f32237a06a5a98", "chunk": "diff --git a/src/main/java/com/aws/greengrass/componentmanager/plugins/GreengrassRepositoryDownloader.java b/src/main/java/com/aws/greengrass/componentmanager/plugins/GreengrassRepositoryDownloader.java\nindex dbdfcf3a5..79432d7b1 100644\n--- a/src/main/java/com/aws/greengrass/componentmanager/plugins/GreengrassRepositoryDownloader.java\n+++ b/src/main/java/com/aws/greengrass/componentmanager/plugins/GreengrassRepositoryDownloader.java\n\n@@ -157,6 +157,9 @@ public class GreengrassRepositoryDownloader extends ArtifactDownloader {\n \n     @Override\n     public File getArtifactFile(Path artifactDir, ComponentArtifact artifact, ComponentIdentifier componentIdentifier) {\n+        if (artifact.getFileName() != null) {\n+            return artifactDir.resolve(artifact.getFileName()).toFile();\n+        }\n         // TODO remove after data plane switching to new GCS API\n         try {\n             String preSignedUrl =\n"}}, {"oid": "2460648b08365433cd58ae3e08f32237a06a5a98", "url": "https://github.com/aws-greengrass/aws-greengrass-nucleus/commit/2460648b08365433cd58ae3e08f32237a06a5a98", "message": "take michael's suggestion", "committedDate": "2020-11-13T06:41:27Z", "type": "commit"}]}