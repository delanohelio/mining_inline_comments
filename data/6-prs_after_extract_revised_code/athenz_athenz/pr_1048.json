{"pr_number": 1048, "pr_title": "Moved ChangeLogStore factories and implementors to Server Common", "pr_createdAt": "2020-07-19T11:54:00Z", "pr_url": "https://github.com/AthenZ/athenz/pull/1048", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg5OTczNw==", "url": "https://github.com/AthenZ/athenz/pull/1048#discussion_r456899737", "bodyText": "If region isn't specified, I'm taking it from the instance metadata as in AWSObjectStoreFactory", "author": "OferLevi85", "createdAt": "2020-07-19T11:57:20Z", "path": "libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/S3ChangeLogStore.java", "diffHunk": "@@ -72,6 +80,13 @@ public S3ChangeLogStore(CloudStore cloudStore) {\n         jsonMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n     }\n \n+    void initAwsRegion() {\n+        awsRegion = System.getProperty(ZTS_PROP_AWS_REGION_NAME);\n+        if (StringUtil.isEmpty(awsRegion)) {\n+            awsRegion = EC2MetadataUtils.getEC2InstanceRegion();", "originalCommit": "3a2e9cf4bb66d928de9e84a59e801358554f4d67", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "443b74aeb3faf9a0c6ad402259ba58b1bba5929d", "chunk": "diff --git a/libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/S3ChangeLogStore.java b/libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/S3ChangeLogStore.java\nindex dc24fdf29..a5888432f 100644\n--- a/libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/S3ChangeLogStore.java\n+++ b/libs/java/server_common/src/main/java/com/yahoo/athenz/common/server/store/impl/S3ChangeLogStore.java\n\n@@ -80,13 +68,6 @@ public class S3ChangeLogStore implements ChangeLogStore {\n         jsonMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);\n     }\n \n-    void initAwsRegion() {\n-        awsRegion = System.getProperty(ZTS_PROP_AWS_REGION_NAME);\n-        if (StringUtil.isEmpty(awsRegion)) {\n-            awsRegion = EC2MetadataUtils.getEC2InstanceRegion();\n-        }\n-    }\n-\n     @Override\n     public boolean supportsFullRefresh() {\n         return false;\n"}}, {"oid": "443b74aeb3faf9a0c6ad402259ba58b1bba5929d", "url": "https://github.com/AthenZ/athenz/commit/443b74aeb3faf9a0c6ad402259ba58b1bba5929d", "message": "Moved ChangeLogStore factories and implementors to Server Common", "committedDate": "2020-07-19T12:25:07Z", "type": "commit"}, {"oid": "40229e71da3bbf248dbfd4a691b456bffb777b8a", "url": "https://github.com/AthenZ/athenz/commit/40229e71da3bbf248dbfd4a691b456bffb777b8a", "message": "Refactor - CloudStore moved back to ZTS. ChangeLog will build S3Client on its own", "committedDate": "2020-07-19T12:25:07Z", "type": "forcePushed"}, {"oid": "fbaa06439f3fdc4f1ac78b255c28bbddafa0bea3", "url": "https://github.com/AthenZ/athenz/commit/fbaa06439f3fdc4f1ac78b255c28bbddafa0bea3", "message": "Refactor - CloudStore moved back to ZTS. ChangeLog will build S3Client on its own", "committedDate": "2020-07-20T09:21:41Z", "type": "commit"}, {"oid": "fbaa06439f3fdc4f1ac78b255c28bbddafa0bea3", "url": "https://github.com/AthenZ/athenz/commit/fbaa06439f3fdc4f1ac78b255c28bbddafa0bea3", "message": "Refactor - CloudStore moved back to ZTS. ChangeLog will build S3Client on its own", "committedDate": "2020-07-20T09:21:41Z", "type": "forcePushed"}]}