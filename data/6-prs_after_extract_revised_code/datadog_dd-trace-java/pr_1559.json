{"pr_number": 1559, "pr_title": "PROF-1622: Sample all exceptions", "pr_createdAt": "2020-06-08T17:03:59Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/1559", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkwMzQxNQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/1559#discussion_r436903415", "bodyText": "The class name should be renamed to match.", "author": "tylerbenson", "createdAt": "2020-06-08T18:19:10Z", "path": "dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ExceptionInstrumentation.java", "diffHunk": "@@ -13,12 +13,7 @@\n import net.bytebuddy.description.type.TypeDescription;\n import net.bytebuddy.matcher.ElementMatcher;\n \n-/**\n- * Provides instrumentation of {@linkplain Exception} constructor. <br>\n- * {@linkplain Exception}, as opposed to {@linkplain Throwable} was deliberately chosen such that we\n- * don't instrument {@linkplain Error} class/subclasses since they are tracked by a native JFR event\n- * already.\n- */\n+/** Provides instrumentation of {@linkplain Throwable} constructor. <br> */\n @AutoService(Instrumenter.class)\n public final class ExceptionInstrumentation extends Instrumenter.Default {", "originalCommit": "dfb476b3f1a0e734e8038ae67e3e1bc67615bd47", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODY3Nzc2MA==", "url": "https://github.com/DataDog/dd-trace-java/pull/1559#discussion_r438677760", "bodyText": "I will rename only the advice and instrumentation classes since they deal with the exact class. The rest of the code is more about 'exceptions' as a concept rather than a concrete Java class and eg. ThrowableSampleEvent sounds strange, at least to me.", "author": "jbachorik", "createdAt": "2020-06-11T10:02:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjkwMzQxNQ=="}], "type": "inlineReview", "revised_code": {"commit": "c2b9e025da755a0c30e7389386bbbbda9e887167", "chunk": "diff --git a/dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ExceptionInstrumentation.java b/dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ThrowableInstrumentation.java\nsimilarity index 94%\nrename from dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ExceptionInstrumentation.java\nrename to dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ThrowableInstrumentation.java\nindex 63b75c22a7..ec37ff37c1 100644\n--- a/dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ExceptionInstrumentation.java\n+++ b/dd-java-agent/instrumentation/exception-profiling/src/main/java/datadog/exceptions/instrumentation/ThrowableInstrumentation.java\n\n@@ -15,11 +15,11 @@ import net.bytebuddy.matcher.ElementMatcher;\n \n /** Provides instrumentation of {@linkplain Throwable} constructor. <br> */\n @AutoService(Instrumenter.class)\n-public final class ExceptionInstrumentation extends Instrumenter.Default {\n+public final class ThrowableInstrumentation extends Instrumenter.Default {\n   private final boolean hasJfr;\n \n-  public ExceptionInstrumentation() {\n-    super(\"exceptions\");\n+  public ThrowableInstrumentation() {\n+    super(\"throwables\");\n     /* Check only for the open-sources JFR implementation.\n      * If it is ever needed to support also the closed sourced JDK 8 version the check should be\n      * enhanced.\n"}}, {"oid": "929bd02e9f8c4603fe09bfc10889da9c45cd184a", "url": "https://github.com/DataDog/dd-trace-java/commit/929bd02e9f8c4603fe09bfc10889da9c45cd184a", "message": "PROF-1622: Sample all exceptions\nCapture all exceptions by instrumenting `Throwable` constructors so they can be subsampled", "committedDate": "2020-06-11T09:51:31Z", "type": "commit"}, {"oid": "c2b9e025da755a0c30e7389386bbbbda9e887167", "url": "https://github.com/DataDog/dd-trace-java/commit/c2b9e025da755a0c30e7389386bbbbda9e887167", "message": "Rename advice and instrumentation classes", "committedDate": "2020-06-11T10:08:12Z", "type": "commit"}, {"oid": "c2b9e025da755a0c30e7389386bbbbda9e887167", "url": "https://github.com/DataDog/dd-trace-java/commit/c2b9e025da755a0c30e7389386bbbbda9e887167", "message": "Rename advice and instrumentation classes", "committedDate": "2020-06-11T10:08:12Z", "type": "forcePushed"}]}