{"pr_number": 1480, "pr_title": "Register WeakMapProvider earlier in AgentInstaller", "pr_createdAt": "2020-05-20T20:54:00Z", "pr_url": "https://github.com/DataDog/dd-trace-java/pull/1480", "timeline": [{"oid": "86f75b3bb2028e2b14300a2ac84c3996c4bd4f7c", "url": "https://github.com/DataDog/dd-trace-java/commit/86f75b3bb2028e2b14300a2ac84c3996c4bd4f7c", "message": "Register WeakMapProvider earlier in AgentInstaller\n\nSpecifically it is used statically by `FieldBackedProvider` which was likely called before the `AgentTooling` class was initialized.", "committedDate": "2020-05-20T20:53:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMxNjg5MQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/1480#discussion_r428316891", "bodyText": "Why do we want to lower the logging level?  I'd actually like to know readily if this happens.", "author": "dougqh", "createdAt": "2020-05-20T21:27:03Z", "path": "dd-java-agent/agent-bootstrap/src/main/java/datadog/trace/bootstrap/WeakMap.java", "diffHunk": "@@ -52,7 +52,7 @@ public static boolean isProviderRegistered() {\n \n       @Override\n       public <K, V> WeakMap<K, V> get() {\n-        log.warn(\"WeakMap.Supplier not registered. Returning a synchronized WeakHashMap.\");\n+        log.debug(\"WeakMap.Supplier not registered. Returning a synchronized WeakHashMap.\");", "originalCommit": "86f75b3bb2028e2b14300a2ac84c3996c4bd4f7c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3MzAzOQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/1480#discussion_r429373039", "bodyText": "I felt like this isn't a great reason to alert users.  The main side effect would be worse performance, but that may or may not be noticeable depending on where it is applied. I can revert if you think it's important.", "author": "tylerbenson", "createdAt": "2020-05-22T17:35:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMxNjg5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU1MDc1NA==", "url": "https://github.com/DataDog/dd-trace-java/pull/1480#discussion_r430550754", "bodyText": "Agreed that this shouldn't log to users in the default configuration. I think users should only see things that are actionable by them in the default configuration, other than version numbers", "author": "devinsba", "createdAt": "2020-05-26T16:35:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODMxNjg5MQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU1MTc0NQ==", "url": "https://github.com/DataDog/dd-trace-java/pull/1480#discussion_r430551745", "bodyText": "Is this callsite still needed?", "author": "devinsba", "createdAt": "2020-05-26T16:36:46Z", "path": "dd-java-agent/agent-tooling/src/main/java/datadog/trace/agent/tooling/AgentTooling.java", "diffHunk": "@@ -20,7 +20,7 @@\n     registerWeakMapProvider();", "originalCommit": "86f75b3bb2028e2b14300a2ac84c3996c4bd4f7c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU1NTc2Nw==", "url": "https://github.com/DataDog/dd-trace-java/pull/1480#discussion_r430555767", "bodyText": "I left it in as a fallback... it isn't hurting anything for the time being.", "author": "tylerbenson", "createdAt": "2020-05-26T16:41:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU1MTc0NQ=="}], "type": "inlineReview", "revised_code": null}]}