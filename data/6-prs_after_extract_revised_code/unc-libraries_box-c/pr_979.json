{"pr_number": 979, "pr_title": "Allow images to get through access filter", "pr_createdAt": "2020-05-04T19:15:21Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/979", "timeline": [{"oid": "21aea7ed8898266806ff196b59c96648fc3b9365", "url": "https://github.com/UNC-Libraries/box-c/commit/21aea7ed8898266806ff196b59c96648fc3b9365", "message": "Allow images to get through access filter", "committedDate": "2020-05-04T19:02:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDc2MzI4NQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/979#discussion_r420763285", "bodyText": "hmm, IMAGE_JP2000 is the boxc3 name for the datastream. Might be better to update JP2Viewer.js to request datastreams jp2 (I think that's the current datastream name).\nIts kind of funny that hasAccess has this default datastream behavior but the actual controller methods both require the datastream name in the path.", "author": "bbpennel", "createdAt": "2020-05-06T12:49:23Z", "path": "access-common/src/main/java/edu/unc/lib/dl/ui/controller/LorisContentController.java", "diffHunk": "@@ -62,8 +62,8 @@\n      * @return\n      */\n     private boolean hasAccess(PID pid, String datastream) {\n-        // Defaults to jp2 surrogate if no datastream specified\n-        if (datastream == null) {\n+        // Defaults to jp2 surrogate\n+        if (datastream.equals(\"IMAGE_JP2000\") || datastream == null) {", "originalCommit": "21aea7ed8898266806ff196b59c96648fc3b9365", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "54c9ddc6ab302f583fff72742d0630bc214cdc79", "chunk": "diff --git a/access-common/src/main/java/edu/unc/lib/dl/ui/controller/LorisContentController.java b/access-common/src/main/java/edu/unc/lib/dl/ui/controller/LorisContentController.java\nindex 4ad554b95..dfb3786cc 100644\n--- a/access-common/src/main/java/edu/unc/lib/dl/ui/controller/LorisContentController.java\n+++ b/access-common/src/main/java/edu/unc/lib/dl/ui/controller/LorisContentController.java\n\n@@ -63,7 +63,7 @@ public class LorisContentController extends AbstractSolrSearchController {\n      */\n     private boolean hasAccess(PID pid, String datastream) {\n         // Defaults to jp2 surrogate\n-        if (datastream.equals(\"IMAGE_JP2000\") || datastream == null) {\n+        if (datastream == null) {\n             datastream = JP2_ACCESS_COPY.getId();\n         }\n \n"}}, {"oid": "54c9ddc6ab302f583fff72742d0630bc214cdc79", "url": "https://github.com/UNC-Libraries/box-c/commit/54c9ddc6ab302f583fff72742d0630bc214cdc79", "message": "Switch datastream name", "committedDate": "2020-05-06T13:25:36Z", "type": "commit"}]}