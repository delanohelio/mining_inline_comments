{"pr_number": 947, "pr_title": "Change event from Normalization to Accession for PID creation", "pr_createdAt": "2020-03-31T14:00:31Z", "pr_url": "https://github.com/UNC-Libraries/box-c/pull/947", "timeline": [{"oid": "3f1443ea6998d6e734008c3cc98c007912b8705b", "url": "https://github.com/UNC-Libraries/box-c/commit/3f1443ea6998d6e734008c3cc98c007912b8705b", "message": "Change event from Normalization to Accession for PID creation", "committedDate": "2020-03-31T14:41:49Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk2NTk2NQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/947#discussion_r400965965", "bodyText": "This defines what we are migrating from, and we are migrating from boxc3 data which currently uses the Normalization event, so you'll need to leave it as NORMALIZATION in this case", "author": "bbpennel", "createdAt": "2020-03-31T14:37:51Z", "path": "migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformer.java", "diffHunk": "@@ -83,8 +84,8 @@ public void compute() {\n                 transformValidationEvent(eventEl);\n             } else if (eventTypes.contains(INGESTION_TYPE)) {\n                 addIngestionEvent(eventEl);\n-            } else if (eventTypes.contains(NORMALIZATION_TYPE)) {", "originalCommit": "78a1f94fc35f2543222dff272ce8bd8e42e0f7e8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4cabd1ff38fed5c288730c7340777411d12a8656", "chunk": "diff --git a/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformer.java b/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformer.java\nindex 7c0a4ac1e..36aef4aad 100644\n--- a/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformer.java\n+++ b/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformer.java\n\n@@ -84,8 +83,8 @@ public class ContentPremisToRdfTransformer extends AbstractPremisToRdfTransforme\n                 transformValidationEvent(eventEl);\n             } else if (eventTypes.contains(INGESTION_TYPE)) {\n                 addIngestionEvent(eventEl);\n-            } else if (eventTypes.contains(ACCESSION_TYPE)) {\n-                transformAccessionEvent(eventEl);\n+            } else if (eventTypes.contains(NORMALIZATION_TYPE)) {\n+                transformNormalizationEvent(eventEl);\n             } else if (eventTypes.contains(MIGRATION_TYPE)) {\n                 transformMigrationEvent(eventEl);\n             } else if (eventTypes.contains(CREATION_TYPE)) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk2NjcwOQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/947#discussion_r400966709", "bodyText": "This defines what we are migrating from, and we are migrating from boxc3 data which currently uses the Normalization event, so you'll need to leave it as NORMALIZATION in this case. We would only need to change the event type as it is stored in boxc5", "author": "bbpennel", "createdAt": "2020-03-31T14:38:48Z", "path": "migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformer.java", "diffHunk": "@@ -72,8 +72,8 @@ public void compute() {\n                 addVirusCheckEvent(eventEl);\n             } else if (eventTypes.contains(Premis2Constants.INGESTION_TYPE)) {\n                 addIngestionEvent(eventEl);\n-            } else if (eventTypes.contains(Premis2Constants.NORMALIZATION_TYPE)) {\n-                transformNormalizationEvent(eventEl);\n+            } else if (eventTypes.contains(Premis2Constants.ACCESSION_TYPE)) {", "originalCommit": "78a1f94fc35f2543222dff272ce8bd8e42e0f7e8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b1c651b1a1711fab47abb5b930756693370d4240", "chunk": "diff --git a/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformer.java b/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformer.java\nindex af834de12..07c61c70d 100644\n--- a/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformer.java\n+++ b/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformer.java\n\n@@ -72,8 +72,8 @@ public class DepositRecordPremisToRdfTransformer extends AbstractPremisToRdfTran\n                 addVirusCheckEvent(eventEl);\n             } else if (eventTypes.contains(Premis2Constants.INGESTION_TYPE)) {\n                 addIngestionEvent(eventEl);\n-            } else if (eventTypes.contains(Premis2Constants.ACCESSION_TYPE)) {\n-                transformAccessionEvent(eventEl);\n+            } else if (eventTypes.contains(Premis2Constants.NORMALIZATION_TYPE)) {\n+                transformNormalizationEvent(eventEl);\n             } else if (eventTypes.contains(Premis2Constants.VALIDATION_TYPE)) {\n                 addValidationEvent(eventEl);\n             } else {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk2NzM1Mg==", "url": "https://github.com/UNC-Libraries/box-c/pull/947#discussion_r400967352", "bodyText": "Based on the previous comments, we don't have accession events in boxc3 so you shouldn't need this", "author": "bbpennel", "createdAt": "2020-03-31T14:39:34Z", "path": "migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/Premis2Constants.java", "diffHunk": "@@ -33,6 +33,7 @@ private Premis2Constants() {\n     public static final String DELETION_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/deletion\";\n     public static final String FIXITY_CHECK_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/fixityCheck\";\n     public static final String CREATION_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/creation\";\n+    public static final String ACCESSION_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/accession\";", "originalCommit": "78a1f94fc35f2543222dff272ce8bd8e42e0f7e8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4cabd1ff38fed5c288730c7340777411d12a8656", "chunk": "diff --git a/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/Premis2Constants.java b/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/Premis2Constants.java\nindex fb2b041ce..81d92045a 100644\n--- a/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/Premis2Constants.java\n+++ b/migration-util/src/main/java/edu/unc/lib/dcr/migration/premis/Premis2Constants.java\n\n@@ -33,7 +33,6 @@ public class Premis2Constants {\n     public static final String DELETION_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/deletion\";\n     public static final String FIXITY_CHECK_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/fixityCheck\";\n     public static final String CREATION_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/creation\";\n-    public static final String ACCESSION_TYPE = \"http://id.loc.gov/vocabulary/preservationEvents/accession\";\n \n     public static final String VIRUS_AGENT = \"edu.unc.lib.deposit.validate.VirusScanJob\";\n     public static final String INGEST_AGENT = \"edu.unc.lib.deposit.fcrepo3.IngestDeposit\";\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk2NzgyMw==", "url": "https://github.com/UNC-Libraries/box-c/pull/947#discussion_r400967823", "bodyText": "you'll need to undo this", "author": "bbpennel", "createdAt": "2020-03-31T14:40:08Z", "path": "migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformerTest.java", "diffHunk": "@@ -200,9 +201,9 @@ public void invalidNormalizationEvent() throws Exception {\n     }\n \n     @Test\n-    public void metsPidAssignmentNormalization() throws Exception {\n+    public void metsPidAssignmentAccession() throws Exception {", "originalCommit": "78a1f94fc35f2543222dff272ce8bd8e42e0f7e8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4cabd1ff38fed5c288730c7340777411d12a8656", "chunk": "diff --git a/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformerTest.java b/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformerTest.java\nindex 4a0da2fa0..2a584a98a 100644\n--- a/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformerTest.java\n+++ b/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/ContentPremisToRdfTransformerTest.java\n\n@@ -201,9 +200,9 @@ public class ContentPremisToRdfTransformerTest extends AbstractPremisToRdfTransf\n     }\n \n     @Test\n-    public void metsPidAssignmentAccession() throws Exception {\n+    public void metsPidAssignmentNormalization() throws Exception {\n         String detail = \"Assigned PID to object defined in a METS div\";\n-        Element eventEl = addEvent(premisDoc, ACCESSION_TYPE, detail, EVENT_DATE);\n+        Element eventEl = addEvent(premisDoc, NORMALIZATION_TYPE, detail, EVENT_DATE);\n         addAgent(eventEl, \"PID\", INITIATOR_ROLE, METS_NORMAL_AGENT);\n \n         transformer.compute();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDk2ODAzNQ==", "url": "https://github.com/UNC-Libraries/box-c/pull/947#discussion_r400968035", "bodyText": "you'll need to undo the changes in here", "author": "bbpennel", "createdAt": "2020-03-31T14:40:25Z", "path": "migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformerTest.java", "diffHunk": "@@ -173,7 +174,7 @@ public void invalidNormalizationEvent() throws Exception {\n     @Test\n     public void validPidsAssignedToObjectsEvent() throws Exception {\n         String detail = \"Assigned PIDs to 3 objects\";\n-        Element eventEl = addEvent(premisDoc, NORMALIZATION_TYPE, detail, EVENT_DATE);\n+        Element eventEl = addEvent(premisDoc, ACCESSION_TYPE, detail, EVENT_DATE);", "originalCommit": "78a1f94fc35f2543222dff272ce8bd8e42e0f7e8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4cabd1ff38fed5c288730c7340777411d12a8656", "chunk": "diff --git a/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformerTest.java b/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformerTest.java\nindex ecd8319b1..e0f0d355a 100644\n--- a/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformerTest.java\n+++ b/migration-util/src/test/java/edu/unc/lib/dcr/migration/premis/DepositRecordPremisToRdfTransformerTest.java\n\n@@ -174,7 +173,7 @@ public class DepositRecordPremisToRdfTransformerTest extends AbstractPremisToRdf\n     @Test\n     public void validPidsAssignedToObjectsEvent() throws Exception {\n         String detail = \"Assigned PIDs to 3 objects\";\n-        Element eventEl = addEvent(premisDoc, ACCESSION_TYPE, detail, EVENT_DATE);\n+        Element eventEl = addEvent(premisDoc, NORMALIZATION_TYPE, detail, EVENT_DATE);\n         addInitiatorAgent(eventEl, METS_NORMAL_AGENT);\n \n         transformer.compute();\n"}}, {"oid": "4cabd1ff38fed5c288730c7340777411d12a8656", "url": "https://github.com/UNC-Libraries/box-c/commit/4cabd1ff38fed5c288730c7340777411d12a8656", "message": "Change event from Normalization to Accession for PID creation", "committedDate": "2020-03-31T18:47:48Z", "type": "forcePushed"}, {"oid": "b1c651b1a1711fab47abb5b930756693370d4240", "url": "https://github.com/UNC-Libraries/box-c/commit/b1c651b1a1711fab47abb5b930756693370d4240", "message": "Change event from Normalization to Accession for PID creation", "committedDate": "2020-03-31T19:10:48Z", "type": "commit"}, {"oid": "b1c651b1a1711fab47abb5b930756693370d4240", "url": "https://github.com/UNC-Libraries/box-c/commit/b1c651b1a1711fab47abb5b930756693370d4240", "message": "Change event from Normalization to Accession for PID creation", "committedDate": "2020-03-31T19:10:48Z", "type": "forcePushed"}]}