{"pr_number": 517, "pr_title": "Notifications are not updated automatically(v8.0.3)", "pr_createdAt": "2020-10-01T07:55:37Z", "pr_url": "https://github.com/dashevo/dash-wallet/pull/517", "timeline": [{"oid": "1ed67f2c962af60e092d0243babce2ce154bcdf0", "url": "https://github.com/dashevo/dash-wallet/commit/1ed67f2c962af60e092d0243babce2ce154bcdf0", "message": "Use 0.15-SNAPSHOT for dpp, dashpay, dapi-client", "committedDate": "2020-09-18T18:34:19Z", "type": "commit"}, {"oid": "1354fcad8fdb06104a5303fe84ce25ed9b42bd2a", "url": "https://github.com/dashevo/dash-wallet/commit/1354fcad8fdb06104a5303fe84ce25ed9b42bd2a", "message": "Update for DPP 0.15, new dpns/dashpay contracts, database tables", "committedDate": "2020-09-19T01:58:36Z", "type": "commit"}, {"oid": "f9d262ea38241110aca09e3b5d25206154fa6f46", "url": "https://github.com/dashevo/dash-wallet/commit/f9d262ea38241110aca09e3b5d25206154fa6f46", "message": "Set unique property on username", "committedDate": "2020-09-19T17:14:07Z", "type": "commit"}, {"oid": "1deafa3b404b19722ab479bda10ac489492ec1ff", "url": "https://github.com/dashevo/dash-wallet/commit/1deafa3b404b19722ab479bda10ac489492ec1ff", "message": "Handle updated profiles from Platform and refactor", "committedDate": "2020-09-22T22:19:02Z", "type": "commit"}, {"oid": "090df0b4bd6fb6d3964fa5c8404f63af66b27d87", "url": "https://github.com/dashevo/dash-wallet/commit/090df0b4bd6fb6d3964fa5c8404f63af66b27d87", "message": "BlockchainIdentityData:  Add userId field\n\nThis allows loading an identity before the credit funding\ntransaction is found.", "committedDate": "2020-09-24T15:58:49Z", "type": "commit"}, {"oid": "e5601c2525486b8b0ae8b2d07b29dc4a9c82af81", "url": "https://github.com/dashevo/dash-wallet/commit/e5601c2525486b8b0ae8b2d07b29dc4a9c82af81", "message": "BlockchainState: Notification shows sync percentage", "committedDate": "2020-09-24T15:58:50Z", "type": "commit"}, {"oid": "ff9b5a7e42de88a5a8197f874c80744b21490613", "url": "https://github.com/dashevo/dash-wallet/commit/ff9b5a7e42de88a5a8197f874c80744b21490613", "message": "BlockchainState: Notification shows sync percentage", "committedDate": "2020-09-24T15:58:50Z", "type": "commit"}, {"oid": "db91501fa06211eca89dc7e7bb9d7aa44cef3892", "url": "https://github.com/dashevo/dash-wallet/commit/db91501fa06211eca89dc7e7bb9d7aa44cef3892", "message": "Refactor database clear when restarting/wiping the app", "committedDate": "2020-09-24T15:58:50Z", "type": "commit"}, {"oid": "927595c9418a37bce0d6d6630224e2d1652de695", "url": "https://github.com/dashevo/dash-wallet/commit/927595c9418a37bce0d6d6630224e2d1652de695", "message": "Check for identity before syncing chain.", "committedDate": "2020-09-24T16:02:55Z", "type": "commit"}, {"oid": "289be3cf59ae3d4417b2b310b54256a87cd2cf68", "url": "https://github.com/dashevo/dash-wallet/commit/289be3cf59ae3d4417b2b310b54256a87cd2cf68", "message": "Add database json file and handle the cftx after the fact", "committedDate": "2020-09-24T16:03:45Z", "type": "commit"}, {"oid": "4b5b1c88f387dd4c2fc19d3e184806fdac8b923d", "url": "https://github.com/dashevo/dash-wallet/commit/4b5b1c88f387dd4c2fc19d3e184806fdac8b923d", "message": "catch profile fetching exception and fix getIdentityByPublicKey", "committedDate": "2020-09-25T18:33:47Z", "type": "commit"}, {"oid": "36b7be6b44b24a506783648c4eeeb58fb942c023", "url": "https://github.com/dashevo/dash-wallet/commit/36b7be6b44b24a506783648c4eeeb58fb942c023", "message": "Change method of submitting bloom filters", "committedDate": "2020-09-25T18:34:35Z", "type": "commit"}, {"oid": "c1a8d002665d6365f421b5b67cf29dd9cb7a3d69", "url": "https://github.com/dashevo/dash-wallet/commit/c1a8d002665d6365f421b5b67cf29dd9cb7a3d69", "message": "Fix recovery of passphrase", "committedDate": "2020-09-29T16:23:40Z", "type": "commit"}, {"oid": "cc9449946f8dfd05c38212706579e6d22a14952a", "url": "https://github.com/dashevo/dash-wallet/commit/cc9449946f8dfd05c38212706579e6d22a14952a", "message": "Refactor DashPayProfile", "committedDate": "2020-09-29T16:37:21Z", "type": "commit"}, {"oid": "5964f05eb56c7d42d01f1e1b5d4d084f4f6d1c50", "url": "https://github.com/dashevo/dash-wallet/commit/5964f05eb56c7d42d01f1e1b5d4d084f4f6d1c50", "message": "Merge branch 'evonet-develop' of https://github.com/dashevo/dash-wallet into dpp-0.15", "committedDate": "2020-09-29T18:21:39Z", "type": "commit"}, {"oid": "15f7ef210c3b2a4b710726c52c6f46a0350f60da", "url": "https://github.com/dashevo/dash-wallet/commit/15f7ef210c3b2a4b710726c52c6f46a0350f60da", "message": "Merge branch 'dpp-0.15' of https://github.com/dashevo/dash-wallet into chain-sync-phase-3a", "committedDate": "2020-09-29T18:45:40Z", "type": "commit"}, {"oid": "858f89f01c04abec252b520b13ffd642d7c7f46e", "url": "https://github.com/dashevo/dash-wallet/commit/858f89f01c04abec252b520b13ffd642d7c7f46e", "message": "CreateIdentityService: remove commented code", "committedDate": "2020-09-30T15:25:44Z", "type": "commit"}, {"oid": "5bbc6bf4fb3f25285938415403ae3386297e3658", "url": "https://github.com/dashevo/dash-wallet/commit/5bbc6bf4fb3f25285938415403ae3386297e3658", "message": "PlatformRepo: Fix loading of blockchainIdentity from Database", "committedDate": "2020-09-30T15:27:02Z", "type": "commit"}, {"oid": "66f955eca73ab75af529904f6b80e91a799994e5", "url": "https://github.com/dashevo/dash-wallet/commit/66f955eca73ab75af529904f6b80e91a799994e5", "message": "ReceiveInfoView: Use observer to get profile information\n\nFixes crash", "committedDate": "2020-09-30T15:27:56Z", "type": "commit"}, {"oid": "1b86ba48be297898cb5cee2e7d97971394f4fb20", "url": "https://github.com/dashevo/dash-wallet/commit/1b86ba48be297898cb5cee2e7d97971394f4fb20", "message": "MoreFragment: Show the user profile only if the user has registered on PlatformRepo.kt\n\nThis resolves a crash when accessing the More menu before registring a username", "committedDate": "2020-09-30T22:33:25Z", "type": "commit"}, {"oid": "67bc825f3c23af4148ea4a932cabcec43150b9cc", "url": "https://github.com/dashevo/dash-wallet/commit/67bc825f3c23af4148ea4a932cabcec43150b9cc", "message": "PlatformRepo: Modify blockchainIdentity creation depending user registration state", "committedDate": "2020-09-30T22:34:42Z", "type": "commit"}, {"oid": "983529e01a4381dc89932979bb018a948a197c03", "url": "https://github.com/dashevo/dash-wallet/commit/983529e01a4381dc89932979bb018a948a197c03", "message": "Merge branch 'evonet-develop' of https://github.com/dashevo/dash-wallet into chain-sync-phase-3a", "committedDate": "2020-09-30T22:47:04Z", "type": "commit"}, {"oid": "2930d3b0c962e434f042df9e467aadc5d5a86f2b", "url": "https://github.com/dashevo/dash-wallet/commit/2930d3b0c962e434f042df9e467aadc5d5a86f2b", "message": "Fixed the issue with incorrect value of NotificationItemContact.getDate() causing the notifications count to not be updated.\n(this is a leftover after data formats change in platform)", "committedDate": "2020-10-01T07:52:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODA1NTI3OA==", "url": "https://github.com/dashevo/dash-wallet/pull/517#discussion_r498055278", "bodyText": "Based on the documentation of apply() method and lack of issues I suggest to use it over commit()\n\nYou don't need to worry about Android component lifecycles and their interaction with apply() writing to disk. The framework makes sure in-flight disk writes from apply() complete before switching states.\n\nsource: https://developer.android.com/reference/android/content/SharedPreferences.Editor#apply()", "author": "tomasz-ludek", "createdAt": "2020-10-01T08:00:42Z", "path": "common/src/main/java/org/dash/wallet/common/Configuration.java", "diffHunk": "@@ -441,6 +441,6 @@ public long getLastSeenNotificationTime() {\n     }\n \n     public void setPrefsLastSeenNotificationTime(long lastSeenNotificationTime) {\n-        prefs.edit().putLong(PREFS_LAST_SEEN_NOTIFICATION_TIME, lastSeenNotificationTime).commit();\n+        prefs.edit().putLong(PREFS_LAST_SEEN_NOTIFICATION_TIME, lastSeenNotificationTime).apply();", "originalCommit": "2930d3b0c962e434f042df9e467aadc5d5a86f2b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7b0c0699363bfbd351fd9c3e6ee2cd15f97559e2", "chunk": "diff --git a/common/src/main/java/org/dash/wallet/common/Configuration.java b/common/src/main/java/org/dash/wallet/common/Configuration.java\nindex 27d0a3af5..cf3596d52 100644\n--- a/common/src/main/java/org/dash/wallet/common/Configuration.java\n+++ b/common/src/main/java/org/dash/wallet/common/Configuration.java\n\n@@ -428,14 +427,6 @@ public class Configuration {\n         prefs.edit().putInt(PREFS_PIN_LENGTH, pinLength).apply();\n     }\n \n-    public boolean getShowJoinDashPay() {\n-        return prefs.getBoolean(PREFS_SHOW_JOIN_DASH_PAY, true);\n-    }\n-\n-    public void setShowJoinDashPay(boolean showJoinDashPay) {\n-        prefs.edit().putBoolean(PREFS_SHOW_JOIN_DASH_PAY, showJoinDashPay).apply();\n-    }\n-\n     public long getLastSeenNotificationTime() {\n         return prefs.getLong(PREFS_LAST_SEEN_NOTIFICATION_TIME, 0);\n     }\n"}}, {"oid": "7b0c0699363bfbd351fd9c3e6ee2cd15f97559e2", "url": "https://github.com/dashevo/dash-wallet/commit/7b0c0699363bfbd351fd9c3e6ee2cd15f97559e2", "message": "Merge branch 'evonet-develop' into notifications-count-update", "committedDate": "2020-10-07T00:12:08Z", "type": "commit"}]}