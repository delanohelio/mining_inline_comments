{"pr_number": 419, "pr_title": "NMA-309 Home Screen Status | Restart from Error (UI)", "pr_createdAt": "2020-05-28T11:21:21Z", "pr_url": "https://github.com/dashevo/dash-wallet/pull/419", "timeline": [{"oid": "05baa43334cb9414486dbb2365de0d042a9a53c1", "url": "https://github.com/dashevo/dash-wallet/commit/05baa43334cb9414486dbb2365de0d042a9a53c1", "message": "Replaced IdentityCreationState by equivalent fields in BlockchainIdentityData class.\nPersisting some additional fields from BlockchainIdentity inside BlockchainIdentityData for future use.\nMoved the code related to exchanging data between database and Platform (primarily bindings between BlockchainIdentity and BlockchainIdentityData) into PlatformRepo class.", "committedDate": "2020-05-28T10:00:54Z", "type": "commit"}, {"oid": "1cd06941d7fcf9c43adc45bcca1421b55cb094d3", "url": "https://github.com/dashevo/dash-wallet/commit/1cd06941d7fcf9c43adc45bcca1421b55cb094d3", "message": "Added BlockchainIdentityBaseData being a simplified version of BlockchainIdentityData intended for use when only basic info are needed (this will improve the speed of queries by reducing the IO cost)", "committedDate": "2020-05-28T11:05:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgwMjU4OQ==", "url": "https://github.com/dashevo/dash-wallet/pull/419#discussion_r431802589", "bodyText": "I think I had a check for status == null because it could be null, perhaps this problem is addressed elsewhere.", "author": "HashEngineering", "createdAt": "2020-05-28T12:38:17Z", "path": "wallet/src/de/schildbach/wallet/ui/WalletActivity.java", "diffHunk": "@@ -326,9 +326,9 @@ public void onChanged(Resource<Boolean> status) {\n         AppDatabase.getAppDatabase().blockchainIdentityDataDao().load().observe(this, new Observer<BlockchainIdentityData>() {\n             @Override\n             public void onChanged(BlockchainIdentityData blockchainIdentityData) {\n-                if(blockchainIdentityData != null) {\n+                if (blockchainIdentityData != null) {\n                     BlockchainIdentity.RegistrationStatus status = blockchainIdentityData.getRegistrationStatus();\n-                    hasIdentity = status != null ? status == BlockchainIdentity.RegistrationStatus.REGISTERED : false;\n+                    hasIdentity = (status == BlockchainIdentity.RegistrationStatus.REGISTERED);", "originalCommit": "1cd06941d7fcf9c43adc45bcca1421b55cb094d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgyMDc5MA==", "url": "https://github.com/dashevo/dash-wallet/pull/419#discussion_r431820790", "bodyText": "yea, basically it doesn't matter since == operator doesn't throw NPE", "author": "tomasz-ludek", "createdAt": "2020-05-28T13:08:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTgwMjU4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "ec502d1949baec6235ee65a490aebe8f37716c49", "chunk": "diff --git a/wallet/src/de/schildbach/wallet/ui/WalletActivity.java b/wallet/src/de/schildbach/wallet/ui/WalletActivity.java\nindex adf07f2a2..ecd494351 100644\n--- a/wallet/src/de/schildbach/wallet/ui/WalletActivity.java\n+++ b/wallet/src/de/schildbach/wallet/ui/WalletActivity.java\n\n@@ -316,19 +315,18 @@ public final class WalletActivity extends AbstractBindServiceActivity\n         dashPayViewModel.isPlatformAvailableLiveData().observe(this, new Observer<Resource<Boolean>>() {\n             @Override\n             public void onChanged(Resource<Boolean> status) {\n-                if(status.getStatus() == Status.SUCCESS)\n+                if (status.getStatus() == Status.SUCCESS)\n                     isPlatformAvailable = status.getData();\n                 else isPlatformAvailable = false;\n                 showHideJoinDashPayAction();\n             }\n         });\n \n-        AppDatabase.getAppDatabase().blockchainIdentityDataDao().load().observe(this, new Observer<BlockchainIdentityData>() {\n+        AppDatabase.getAppDatabase().blockchainIdentityDataDao().loadBase().observe(this, new Observer<BlockchainIdentityBaseData>() {\n             @Override\n-            public void onChanged(BlockchainIdentityData blockchainIdentityData) {\n+            public void onChanged(BlockchainIdentityBaseData blockchainIdentityData) {\n                 if (blockchainIdentityData != null) {\n-                    BlockchainIdentity.RegistrationStatus status = blockchainIdentityData.getRegistrationStatus();\n-                    hasIdentity = (status == BlockchainIdentity.RegistrationStatus.REGISTERED);\n+                    hasIdentity = (blockchainIdentityData.getCreationState() != BlockchainIdentityData.CreationState.DONE);\n                     showHideJoinDashPayAction();\n                 }\n             }\n"}}, {"oid": "b652fd895aa1f1b2ba97512ef3e2376915fb292a", "url": "https://github.com/dashevo/dash-wallet/commit/b652fd895aa1f1b2ba97512ef3e2376915fb292a", "message": "Merge branch 'evonet-develop' into evonet-create-identity-error-handling\n\n# Conflicts:\n#\twallet/src/de/schildbach/wallet/AppDatabase.java\n#\twallet/src/de/schildbach/wallet/data/IdentityCreationState.kt\n#\twallet/src/de/schildbach/wallet/ui/dashpay/PlatformRepo.kt\n#\twallet/src/de/schildbach/wallet/ui/dashpay/ProcessingIdentityViewHolder.kt", "committedDate": "2020-05-28T12:47:46Z", "type": "commit"}, {"oid": "b68660b77aa8c94b1c7a521705ba1d25bb154cb9", "url": "https://github.com/dashevo/dash-wallet/commit/b68660b77aa8c94b1c7a521705ba1d25bb154cb9", "message": "Added ability to restore the process of identity creation at any point of time", "committedDate": "2020-05-28T16:07:27Z", "type": "commit"}, {"oid": "1a5d6e1802342ef8f6fb1f2122311cdfbb787245", "url": "https://github.com/dashevo/dash-wallet/commit/1a5d6e1802342ef8f6fb1f2122311cdfbb787245", "message": "Added useful log", "committedDate": "2020-05-28T16:17:17Z", "type": "commit"}, {"oid": "3581261c20fcae778814c27b2f89b24d363270a3", "url": "https://github.com/dashevo/dash-wallet/commit/3581261c20fcae778814c27b2f89b24d363270a3", "message": "Added ability to restore the process of identity creation at any point of time (improvements)", "committedDate": "2020-05-28T17:45:02Z", "type": "commit"}, {"oid": "ec502d1949baec6235ee65a490aebe8f37716c49", "url": "https://github.com/dashevo/dash-wallet/commit/ec502d1949baec6235ee65a490aebe8f37716c49", "message": "Added ability to restore the process of identity creation at any point of time (additional improvements)", "committedDate": "2020-05-28T21:06:58Z", "type": "commit"}, {"oid": "7ed7707183671ef4587f609941ec7ba146665d36", "url": "https://github.com/dashevo/dash-wallet/commit/7ed7707183671ef4587f609941ec7ba146665d36", "message": "Removed testing exception", "committedDate": "2020-05-29T05:35:48Z", "type": "commit"}, {"oid": "1f430e16073a1a2613cfbdcb441549581ede6641", "url": "https://github.com/dashevo/dash-wallet/commit/1f430e16073a1a2613cfbdcb441549581ede6641", "message": "Added missing comment", "committedDate": "2020-05-29T05:37:28Z", "type": "commit"}, {"oid": "85902b616c0fc275608a7ed39922a6ab477cf298", "url": "https://github.com/dashevo/dash-wallet/commit/85902b616c0fc275608a7ed39922a6ab477cf298", "message": "Added ability to restore the process of identity creation at any point of time (improvements)", "committedDate": "2020-05-29T07:34:54Z", "type": "commit"}, {"oid": "ea03fe11b42ba85690efe875440df7c1c11efe52", "url": "https://github.com/dashevo/dash-wallet/commit/ea03fe11b42ba85690efe875440df7c1c11efe52", "message": "Added ability to restore the process of identity creation at any point of time (improvements)", "committedDate": "2020-05-29T09:36:02Z", "type": "commit"}, {"oid": "6a1245953364280354702ddc0150e1a480eba279", "url": "https://github.com/dashevo/dash-wallet/commit/6a1245953364280354702ddc0150e1a480eba279", "message": "Added ability to restore the process of identity creation at any point of time (improvements)", "committedDate": "2020-05-29T12:50:38Z", "type": "commit"}]}