{"pr_number": 3403, "pr_title": "Add Mending Event", "pr_createdAt": "2020-09-24T22:28:52Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/3403", "timeline": [{"oid": "0dd9144df7aa29d9a99a35f4c1d5e4360a3305bd", "url": "https://github.com/SkriptLang/Skript/commit/0dd9144df7aa29d9a99a35f4c1d5e4360a3305bd", "message": "Add Mending Event", "committedDate": "2020-09-24T21:43:23Z", "type": "commit"}, {"oid": "33dc8a69e4e3e68029d9d8441e1fb6bc91ec6533", "url": "https://github.com/SkriptLang/Skript/commit/33dc8a69e4e3e68029d9d8441e1fb6bc91ec6533", "message": "Small Modifcations\n\n- Changed event syntax\n- Reordered event value registration\n- Updated 'repair amount' docs", "committedDate": "2020-09-24T22:26:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY0NjIzOQ==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r494646239", "bodyText": "What do you think about changing this to something like \"Mending Repair Amount\"?\nIm only suggesting this, as \"Repair Amount\" is a bit vague and could easily confuse users, who might think this is for repairing in other scenarios", "author": "ShaneBeee", "createdAt": "2020-09-24T22:31:20Z", "path": "src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.player.PlayerItemMendEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Repair Amount\")", "originalCommit": "33dc8a69e4e3e68029d9d8441e1fb6bc91ec6533", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY0NjU5OA==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r494646598", "bodyText": "Good idea! I'll make the change.", "author": "APickledWalrus", "createdAt": "2020-09-24T22:32:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY0NjIzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "579239f1daa5089a226657128b829b439e939495", "chunk": "diff --git a/src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nsimilarity index 86%\nrename from src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java\nrename to src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nindex df4492d9..3f9d5a24 100644\n--- a/src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java\n+++ b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n\n@@ -38,22 +38,22 @@ import ch.njol.skript.log.ErrorQuality;\n import ch.njol.util.Kleenean;\n import ch.njol.util.coll.CollectionUtils;\n \n-@Name(\"Repair Amount\")\n+@Name(\"Mending Repair Amount\")\n @Description({\"The number of durability points an item is to be repaired in a mending event.\",\n \t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n @Examples({\"on item mend:\",\n-\t\t\"\\tset the repair amount to 100\"})\n+\t\t\"\\tset the mending repair amount to 100\"})\n @Since(\"2.0\")\n-public class ExprRepairAmount extends SimpleExpression<Number> {\n+public class ExprMendingRepairAmount extends SimpleExpression<Number> {\n \n \tstatic {\n-\t\tSkript.registerExpression(ExprRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] repair amount\");\n+\t\tSkript.registerExpression(ExprMendingRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] [mending] repair amount\");\n \t}\n \n \t@Override\n \tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n \t\tif (!ScriptLoader.isCurrentEvent(PlayerItemMendEvent.class)) {\n-\t\t\tSkript.error(\"The 'repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n+\t\t\tSkript.error(\"The 'mending repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n \t\t\treturn false;\n \t\t}\n \t\treturn true;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY0NjUwMg==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r494646502", "bodyText": "You forgot breaks.", "author": "ShaneBeee", "createdAt": "2020-09-24T22:32:07Z", "path": "src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.player.PlayerItemMendEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Repair Amount\")\n+@Description({\"The number of durability points an item is to be repaired in a mending event.\",\n+\t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n+@Examples({\"on item mend:\",\n+\t\t\"\\tset the repair amount to 100\"})\n+@Since(\"2.0\")\n+public class ExprRepairAmount extends SimpleExpression<Number> {\n+\n+\tstatic {\n+\t\tSkript.registerExpression(ExprRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] repair amount\");\n+\t}\n+\n+\t@Override\n+\tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n+\t\tif (!ScriptLoader.isCurrentEvent(PlayerItemMendEvent.class)) {\n+\t\t\tSkript.error(\"The 'repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n+\t\t\treturn false;\n+\t\t}\n+\t\treturn true;\n+\t}\n+\n+\t@Override\n+\tprotected Number[] get(final Event e) {\n+\t\treturn new Number[]{((PlayerItemMendEvent) e).getRepairAmount()};\n+\t}\n+\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\tswitch (mode) {\n+\t\t\tcase SET:\n+\t\t\tcase ADD:\n+\t\t\tcase REMOVE:\n+\t\t\t\treturn CollectionUtils.array(Number.class);\n+\t\t\tdefault:\n+\t\t\t\treturn null;\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic void change(Event event, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta == null)\n+\t\t\treturn;\n+\t\tPlayerItemMendEvent e = (PlayerItemMendEvent) event;\n+\t\tint newLevel = ((Number) delta[0]).intValue();\n+\t\tswitch (mode) {\n+\t\t\tcase SET:\n+\t\t\t\te.setRepairAmount(newLevel);\n+\t\t\tcase ADD:\n+\t\t\t\te.setRepairAmount(e.getRepairAmount() + newLevel);\n+\t\t\tcase REMOVE:\n+\t\t\t\te.setRepairAmount(e.getRepairAmount() - newLevel);\n+\t\t\tdefault:\n+\t\t\t\tassert false;", "originalCommit": "33dc8a69e4e3e68029d9d8441e1fb6bc91ec6533", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "579239f1daa5089a226657128b829b439e939495", "chunk": "diff --git a/src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nsimilarity index 86%\nrename from src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java\nrename to src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nindex df4492d9..3f9d5a24 100644\n--- a/src/main/java/ch/njol/skript/expressions/ExprRepairAmount.java\n+++ b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n\n@@ -38,22 +38,22 @@ import ch.njol.skript.log.ErrorQuality;\n import ch.njol.util.Kleenean;\n import ch.njol.util.coll.CollectionUtils;\n \n-@Name(\"Repair Amount\")\n+@Name(\"Mending Repair Amount\")\n @Description({\"The number of durability points an item is to be repaired in a mending event.\",\n \t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n @Examples({\"on item mend:\",\n-\t\t\"\\tset the repair amount to 100\"})\n+\t\t\"\\tset the mending repair amount to 100\"})\n @Since(\"2.0\")\n-public class ExprRepairAmount extends SimpleExpression<Number> {\n+public class ExprMendingRepairAmount extends SimpleExpression<Number> {\n \n \tstatic {\n-\t\tSkript.registerExpression(ExprRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] repair amount\");\n+\t\tSkript.registerExpression(ExprMendingRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] [mending] repair amount\");\n \t}\n \n \t@Override\n \tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n \t\tif (!ScriptLoader.isCurrentEvent(PlayerItemMendEvent.class)) {\n-\t\t\tSkript.error(\"The 'repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n+\t\t\tSkript.error(\"The 'mending repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n \t\t\treturn false;\n \t\t}\n \t\treturn true;\n"}}, {"oid": "579239f1daa5089a226657128b829b439e939495", "url": "https://github.com/SkriptLang/Skript/commit/579239f1daa5089a226657128b829b439e939495", "message": "Rename and add breaks", "committedDate": "2020-09-24T22:36:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY0OTE5Mw==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r494649193", "bodyText": "Dunno how I missed this, you going back in time? haha, as Im sure you know this should be \"INSERT VERSION\"", "author": "ShaneBeee", "createdAt": "2020-09-24T22:39:48Z", "path": "src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.player.PlayerItemMendEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Mending Repair Amount\")\n+@Description({\"The number of durability points an item is to be repaired in a mending event.\",\n+\t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n+@Examples({\"on item mend:\",\n+\t\t\"\\tset the mending repair amount to 100\"})\n+@Since(\"2.0\")", "originalCommit": "579239f1daa5089a226657128b829b439e939495", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY1MjI0Mg==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r494652242", "bodyText": "I always miss stuff \ud83d\ude14\nhaha", "author": "APickledWalrus", "createdAt": "2020-09-24T22:49:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDY0OTE5Mw=="}], "type": "inlineReview", "revised_code": {"commit": "1d0e10fbc2d7f161c5fced62290276778a905d50", "chunk": "diff --git a/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nindex 3f9d5a24..11b8e8e8 100644\n--- a/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n+++ b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n\n@@ -43,7 +43,7 @@ import ch.njol.util.coll.CollectionUtils;\n \t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n @Examples({\"on item mend:\",\n \t\t\"\\tset the mending repair amount to 100\"})\n-@Since(\"2.0\")\n+@Since(\"INSERT VERSION\")\n public class ExprMendingRepairAmount extends SimpleExpression<Number> {\n \n \tstatic {\n"}}, {"oid": "1d0e10fbc2d7f161c5fced62290276778a905d50", "url": "https://github.com/SkriptLang/Skript/commit/1d0e10fbc2d7f161c5fced62290276778a905d50", "message": "Fix Since Annotation", "committedDate": "2020-09-24T23:42:01Z", "type": "commit"}, {"oid": "1677f2f6e4a37ab22e027a583258978b36eb4300", "url": "https://github.com/SkriptLang/Skript/commit/1677f2f6e4a37ab22e027a583258978b36eb4300", "message": "Merge branch 'dev-2.5' into feature/item-mend-event", "committedDate": "2020-09-25T15:56:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjMxNTE1OQ==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r496315159", "bodyText": "Perhaps you could do\n\t\tswitch (mode) {\n\t\t\tcase SET:\n\t\t\t\tbreak;\n\t\t\tcase ADD:\n\t\t\t\tnewLevel += e.getRepairAmount();\n\t\t\t\tbreak;\n\t\t\tcase REMOVE:\n\t\t\t\tnewLevel -= e.getRepairAmount();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tassert false;\n\t\t}\n\t\te.setRepairAmount(newLevel);", "author": "Wealthyturtle", "createdAt": "2020-09-29T00:59:43Z", "path": "src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.player.PlayerItemMendEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Mending Repair Amount\")\n+@Description({\"The number of durability points an item is to be repaired in a mending event.\",\n+\t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n+@Examples({\"on item mend:\",\n+\t\t\"\\tset the mending repair amount to 100\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprMendingRepairAmount extends SimpleExpression<Number> {\n+\n+\tstatic {\n+\t\tSkript.registerExpression(ExprMendingRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] [mending] repair amount\");\n+\t}\n+\n+\t@Override\n+\tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n+\t\tif (!ScriptLoader.isCurrentEvent(PlayerItemMendEvent.class)) {\n+\t\t\tSkript.error(\"The 'mending repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n+\t\t\treturn false;\n+\t\t}\n+\t\treturn true;\n+\t}\n+\n+\t@Override\n+\tprotected Number[] get(final Event e) {\n+\t\treturn new Number[]{((PlayerItemMendEvent) e).getRepairAmount()};\n+\t}\n+\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\tswitch (mode) {\n+\t\t\tcase SET:\n+\t\t\tcase ADD:\n+\t\t\tcase REMOVE:\n+\t\t\t\treturn CollectionUtils.array(Number.class);\n+\t\t\tdefault:\n+\t\t\t\treturn null;\n+\t\t}\n+\t}\n+\n+\t@Override\n+\tpublic void change(Event event, @Nullable Object[] delta, ChangeMode mode) {\n+\t\tif (delta == null)\n+\t\t\treturn;\n+\t\tPlayerItemMendEvent e = (PlayerItemMendEvent) event;\n+\t\tint newLevel = ((Number) delta[0]).intValue();\n+\t\tswitch (mode) {\n+\t\t\tcase SET:\n+\t\t\t\te.setRepairAmount(newLevel);\n+\t\t\t\tbreak;\n+\t\t\tcase ADD:\n+\t\t\t\te.setRepairAmount(e.getRepairAmount() + newLevel);\n+\t\t\t\tbreak;\n+\t\t\tcase REMOVE:\n+\t\t\t\te.setRepairAmount(e.getRepairAmount() - newLevel);\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\tassert false;\n+\t\t}", "originalCommit": "1677f2f6e4a37ab22e027a583258978b36eb4300", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjgyMzg1Mw==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r496823853", "bodyText": "That would probably be better", "author": "APickledWalrus", "createdAt": "2020-09-29T15:37:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjMxNTE1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "10dce5d66ff12eb656a68beb654120f36eb12ae0", "chunk": "diff --git a/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nindex 11b8e8e8..e0a74459 100644\n--- a/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n+++ b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n\n@@ -25,6 +25,7 @@ import org.eclipse.jdt.annotation.Nullable;\n \n import ch.njol.skript.ScriptLoader;\n import ch.njol.skript.Skript;\n+import ch.njol.skript.bukkitutil.ItemUtils;\n import ch.njol.skript.classes.Changer.ChangeMode;\n import ch.njol.skript.doc.Description;\n import ch.njol.skript.doc.Examples;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjMxNTI5MQ==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r496315291", "bodyText": "Might the RESET ChangeMode be applicable here?", "author": "Wealthyturtle", "createdAt": "2020-09-29T01:00:13Z", "path": "src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java", "diffHunk": "@@ -0,0 +1,116 @@\n+/**\n+ *   This file is part of Skript.\n+ *\n+ *  Skript is free software: you can redistribute it and/or modify\n+ *  it under the terms of the GNU General Public License as published by\n+ *  the Free Software Foundation, either version 3 of the License, or\n+ *  (at your option) any later version.\n+ *\n+ *  Skript is distributed in the hope that it will be useful,\n+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ *  GNU General Public License for more details.\n+ *\n+ *  You should have received a copy of the GNU General Public License\n+ *  along with Skript.  If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ *\n+ * Copyright 2011-2017 Peter G\u00fcttinger and contributors\n+ */\n+package ch.njol.skript.expressions;\n+\n+import org.bukkit.event.Event;\n+import org.bukkit.event.player.PlayerItemMendEvent;\n+import org.eclipse.jdt.annotation.Nullable;\n+\n+import ch.njol.skript.ScriptLoader;\n+import ch.njol.skript.Skript;\n+import ch.njol.skript.classes.Changer.ChangeMode;\n+import ch.njol.skript.doc.Description;\n+import ch.njol.skript.doc.Examples;\n+import ch.njol.skript.doc.Name;\n+import ch.njol.skript.doc.Since;\n+import ch.njol.skript.lang.Expression;\n+import ch.njol.skript.lang.ExpressionType;\n+import ch.njol.skript.lang.SkriptParser.ParseResult;\n+import ch.njol.skript.lang.util.SimpleExpression;\n+import ch.njol.skript.log.ErrorQuality;\n+import ch.njol.util.Kleenean;\n+import ch.njol.util.coll.CollectionUtils;\n+\n+@Name(\"Mending Repair Amount\")\n+@Description({\"The number of durability points an item is to be repaired in a mending event.\",\n+\t\t\t\" Modifying the repair amount will affect how much experience is given to the player after mending.\"})\n+@Examples({\"on item mend:\",\n+\t\t\"\\tset the mending repair amount to 100\"})\n+@Since(\"INSERT VERSION\")\n+public class ExprMendingRepairAmount extends SimpleExpression<Number> {\n+\n+\tstatic {\n+\t\tSkript.registerExpression(ExprMendingRepairAmount.class, Number.class, ExpressionType.SIMPLE, \"[the] [mending] repair amount\");\n+\t}\n+\n+\t@Override\n+\tpublic boolean init(Expression<?>[] exprs, int matchedPattern, Kleenean isDelayed, ParseResult parseResult) {\n+\t\tif (!ScriptLoader.isCurrentEvent(PlayerItemMendEvent.class)) {\n+\t\t\tSkript.error(\"The 'mending repair amount' is only usable in item mend events\", ErrorQuality.SEMANTIC_ERROR);\n+\t\t\treturn false;\n+\t\t}\n+\t\treturn true;\n+\t}\n+\n+\t@Override\n+\tprotected Number[] get(final Event e) {\n+\t\treturn new Number[]{((PlayerItemMendEvent) e).getRepairAmount()};\n+\t}\n+\n+\t@Nullable\n+\t@Override\n+\tpublic Class<?>[] acceptChange(ChangeMode mode) {\n+\t\tswitch (mode) {", "originalCommit": "1677f2f6e4a37ab22e027a583258978b36eb4300", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjgyMzI1Nw==", "url": "https://github.com/SkriptLang/Skript/pull/3403#discussion_r496823257", "bodyText": "It might be possible if I get the ExperienceOrb actually. I'll have to test that out.", "author": "APickledWalrus", "createdAt": "2020-09-29T15:36:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NjMxNTI5MQ=="}], "type": "inlineReview", "revised_code": {"commit": "10dce5d66ff12eb656a68beb654120f36eb12ae0", "chunk": "diff --git a/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\nindex 11b8e8e8..e0a74459 100644\n--- a/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n+++ b/src/main/java/ch/njol/skript/expressions/ExprMendingRepairAmount.java\n\n@@ -25,6 +25,7 @@ import org.eclipse.jdt.annotation.Nullable;\n \n import ch.njol.skript.ScriptLoader;\n import ch.njol.skript.Skript;\n+import ch.njol.skript.bukkitutil.ItemUtils;\n import ch.njol.skript.classes.Changer.ChangeMode;\n import ch.njol.skript.doc.Description;\n import ch.njol.skript.doc.Examples;\n"}}, {"oid": "10dce5d66ff12eb656a68beb654120f36eb12ae0", "url": "https://github.com/SkriptLang/Skript/commit/10dce5d66ff12eb656a68beb654120f36eb12ae0", "message": "RESET case", "committedDate": "2020-10-03T15:02:39Z", "type": "commit"}, {"oid": "9d7a0253d594a6638f6c9cc36eeacfe1fce449f3", "url": "https://github.com/SkriptLang/Skript/commit/9d7a0253d594a6638f6c9cc36eeacfe1fce449f3", "message": "Merge branch 'dev-2.5' into feature/item-mend-event", "committedDate": "2020-10-04T22:54:02Z", "type": "commit"}, {"oid": "150580a708509e8e2965c84de926cde09e1ae139", "url": "https://github.com/SkriptLang/Skript/commit/150580a708509e8e2965c84de926cde09e1ae139", "message": "Fix license header", "committedDate": "2020-10-04T23:07:51Z", "type": "commit"}]}