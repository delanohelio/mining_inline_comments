{"pr_number": 3284, "pr_title": "Fix issue with item crack particle not working", "pr_createdAt": "2020-08-07T09:44:18Z", "pr_url": "https://github.com/SkriptLang/Skript/pull/3284", "timeline": [{"oid": "05be906686d0f742a3eb6570da565c935a8b4a37", "url": "https://github.com/SkriptLang/Skript/commit/05be906686d0f742a3eb6570da565c935a8b4a37", "message": "Introducing block state modification", "committedDate": "2020-08-03T08:11:23Z", "type": "commit"}, {"oid": "2ea350b47773ff6ebaf48bf6a3c44833778e7838", "url": "https://github.com/SkriptLang/Skript/commit/2ea350b47773ff6ebaf48bf6a3c44833778e7838", "message": "Revert \"Introducing block state modification\"\n\nThis reverts commit 05be9066", "committedDate": "2020-08-03T08:24:46Z", "type": "commit"}, {"oid": "29a0869b3b6553fc1043066413d30c2ffe486916", "url": "https://github.com/SkriptLang/Skript/commit/29a0869b3b6553fc1043066413d30c2ffe486916", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-06T18:58:31Z", "type": "commit"}, {"oid": "23785c76083b6eca9c26a3c9cd0d7674def09aa8", "url": "https://github.com/SkriptLang/Skript/commit/23785c76083b6eca9c26a3c9cd0d7674def09aa8", "message": "Merge branch 'master' of https://github.com/SkriptLang/Skript", "committedDate": "2020-08-06T20:48:52Z", "type": "commit"}, {"oid": "d8a567478a61e450cc280caa9cd0c2205ecc94b6", "url": "https://github.com/SkriptLang/Skript/commit/d8a567478a61e450cc280caa9cd0c2205ecc94b6", "message": "VisualEffect - fix issue with ITEM_CRACK particles not working", "committedDate": "2020-08-07T09:41:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0NTIyMA==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467345220", "bodyText": "Even if this Material didn't change between versions, it might be better to have a constant with Aliases.javaItemtype(\"iron sword\") and use ItemType#getMaterial here, just to avoid referencing the enum in general.", "author": "FranKusmiruk", "createdAt": "2020-08-08T01:33:44Z", "path": "src/main/java/ch/njol/skript/util/VisualEffect.java", "diffHunk": "@@ -159,17 +159,16 @@ public boolean isColorable() {\n \t\tITEM_CRACK(Particle.ITEM_CRACK) {\r\n \t\t\t@Override\r\n \t\t\tpublic Object getData(final @Nullable Object raw, final Location l) {\r\n-\t\t\t\tif (raw == null)\r\n-\t\t\t\t\treturn Material.IRON_SWORD;\r\n-\t\t\t\telse if (raw instanceof ItemType) {\r\n+\t\t\t\tItemStack itemStack = new ItemStack( Material.IRON_SWORD);\r", "originalCommit": "d8a567478a61e450cc280caa9cd0c2205ecc94b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0NTQ0OQ==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467345449", "bodyText": "Good idea... never know what is going to happen in the future.", "author": "ShaneBeee", "createdAt": "2020-08-08T01:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0NTIyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0NjgzNw==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467346837", "bodyText": "Updated :)", "author": "ShaneBeee", "createdAt": "2020-08-08T01:50:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzM0NTIyMA=="}], "type": "inlineReview", "revised_code": {"commit": "4e26413e2ac253ae5c36abcaa09604143b65ada4", "chunk": "diff --git a/src/main/java/ch/njol/skript/util/VisualEffect.java b/src/main/java/ch/njol/skript/util/VisualEffect.java\nindex a7d950ef..31ef83a5 100644\n--- a/src/main/java/ch/njol/skript/util/VisualEffect.java\n+++ b/src/main/java/ch/njol/skript/util/VisualEffect.java\n\n@@ -159,13 +160,14 @@ public final class VisualEffect implements SyntaxElement, YggdrasilSerializable\n \t\tITEM_CRACK(Particle.ITEM_CRACK) {\n \t\t\t@Override\n \t\t\tpublic Object getData(final @Nullable Object raw, final Location l) {\n-\t\t\t\tItemStack itemStack = new ItemStack( Material.IRON_SWORD);\n+\t\t\t\tItemStack itemStack = Aliases.javaItemType(\"iron sword\").getRandom();\n \t\t\t\tif (raw instanceof ItemType) {\n \t\t\t\t\tItemStack rand = ((ItemType) raw).getRandom();\n \t\t\t\t\tif (rand != null)\n \t\t\t\t\t\titemStack = rand;\n \t\t\t\t} else if (raw != null)\n \t\t\t\t\treturn raw;\n+\t\t\t\tassert itemStack != null;\n \t\t\t\tif (Particle.ITEM_CRACK.getDataType() == Material.class)\n \t\t\t\t\treturn itemStack.getType();\n \t\t\t\treturn itemStack;\n"}}, {"oid": "d1607e1ab75b7e6ef463262f7d0507de3ef5a4cc", "url": "https://github.com/SkriptLang/Skript/commit/d1607e1ab75b7e6ef463262f7d0507de3ef5a4cc", "message": "VisualEffect - add regression test\n- I know its small, but theres not much more i can do here.", "committedDate": "2020-08-08T01:49:39Z", "type": "commit"}, {"oid": "4e26413e2ac253ae5c36abcaa09604143b65ada4", "url": "https://github.com/SkriptLang/Skript/commit/4e26413e2ac253ae5c36abcaa09604143b65ada4", "message": "VisualEffect - use alias/ItemType instead of Material", "committedDate": "2020-08-08T01:50:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU1MzU1NQ==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467553555", "bodyText": "I think this could be a private final static constant for the class", "author": "Wealthyturtle", "createdAt": "2020-08-09T08:24:12Z", "path": "src/main/java/ch/njol/skript/util/VisualEffect.java", "diffHunk": "@@ -159,17 +160,17 @@ public boolean isColorable() {\n \t\tITEM_CRACK(Particle.ITEM_CRACK) {\r\n \t\t\t@Override\r\n \t\t\tpublic Object getData(final @Nullable Object raw, final Location l) {\r\n-\t\t\t\tif (raw == null)\r\n-\t\t\t\t\treturn Material.IRON_SWORD;\r\n-\t\t\t\telse if (raw instanceof ItemType) {\r\n+\t\t\t\tItemStack itemStack = Aliases.javaItemType(\"iron sword\").getRandom();\r", "originalCommit": "4e26413e2ac253ae5c36abcaa09604143b65ada4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU1NDA2Mw==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467554063", "bodyText": "If it were, id have to clone it each time its used. In that case its the same as creating a new item stack.\nUnless I were to make a final private static ItemType then use getRandom within this method.\nThoughts?", "author": "ShaneBeee", "createdAt": "2020-08-09T08:29:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU1MzU1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzkzMDA2NQ==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467930065", "bodyText": "https://github.com/SkriptLang/Skript/blob/master/src/main/java/ch/njol/skript/expressions/ExprSkull.java I'm not sure, but other components of Skript do it like that", "author": "Wealthyturtle", "createdAt": "2020-08-10T14:09:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU1MzU1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzk2NjgwNA==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r467966804", "bodyText": "Cloning might be marginally cheaper than constructing the ItemType again, not that it really matters on this case though.", "author": "FranKusmiruk", "createdAt": "2020-08-10T15:01:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU1MzU1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODMwODIxOQ==", "url": "https://github.com/SkriptLang/Skript/pull/3284#discussion_r468308219", "bodyText": "Im going to leave it as is. As snow said it won't really matter here.", "author": "ShaneBeee", "createdAt": "2020-08-11T03:41:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzU1MzU1NQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "93628294a783824219acb237008291ca3575b03c", "url": "https://github.com/SkriptLang/Skript/commit/93628294a783824219acb237008291ca3575b03c", "message": "Merge branch 'master' into fix/item_crack-particle", "committedDate": "2020-08-10T18:19:52Z", "type": "commit"}]}