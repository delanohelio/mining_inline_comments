{"pr_number": 9856, "pr_title": "change default number of segment loading threads", "pr_createdAt": "2020-05-12T14:03:10Z", "pr_url": "https://github.com/apache/druid/pull/9856", "timeline": [{"oid": "d7187e40e556b2dd75a5c317dacb02dad367dbdd", "url": "https://github.com/apache/druid/commit/d7187e40e556b2dd75a5c317dacb02dad367dbdd", "message": "change default number of segment loading threads", "committedDate": "2020-05-12T14:02:37Z", "type": "commit"}, {"oid": "2677ee20583ba8c51fe20c1d5ba8f5e835f65148", "url": "https://github.com/apache/druid/commit/2677ee20583ba8c51fe20c1d5ba8f5e835f65148", "message": "fix docs", "committedDate": "2020-05-12T14:03:45Z", "type": "commit"}, {"oid": "3446441574337ddd964fe10673a97d05b143193a", "url": "https://github.com/apache/druid/commit/3446441574337ddd964fe10673a97d05b143193a", "message": "missed file", "committedDate": "2020-05-12T14:04:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMDQ0NA==", "url": "https://github.com/apache/druid/pull/9856#discussion_r424730444", "bodyText": "Oops, I think this should be Math.max so the value isn't always 0 or 1?", "author": "clintropolis", "createdAt": "2020-05-13T21:05:15Z", "path": "server/src/main/java/org/apache/druid/segment/loading/SegmentLoaderConfig.java", "diffHunk": "@@ -50,7 +50,7 @@\n   private int announceIntervalMillis = 0; // do not background announce\n \n   @JsonProperty(\"numLoadingThreads\")\n-  private int numLoadingThreads = JvmUtils.getRuntimeInfo().getAvailableProcessors();\n+  private int numLoadingThreads = Math.min(1, JvmUtils.getRuntimeInfo().getAvailableProcessors() / 6);", "originalCommit": "3446441574337ddd964fe10673a97d05b143193a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjY2OTA4OQ==", "url": "https://github.com/apache/druid/pull/9856#discussion_r426669089", "bodyText": "whoops , thanks for catching this!", "author": "dylwylie", "createdAt": "2020-05-18T14:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDczMDQ0NA=="}], "type": "inlineReview", "revised_code": {"commit": "993948c984b30e79a73c336805cbae828339608f", "chunk": "diff --git a/server/src/main/java/org/apache/druid/segment/loading/SegmentLoaderConfig.java b/server/src/main/java/org/apache/druid/segment/loading/SegmentLoaderConfig.java\nindex cea04ac445..84475c1f33 100644\n--- a/server/src/main/java/org/apache/druid/segment/loading/SegmentLoaderConfig.java\n+++ b/server/src/main/java/org/apache/druid/segment/loading/SegmentLoaderConfig.java\n\n@@ -50,7 +50,7 @@ public class SegmentLoaderConfig\n   private int announceIntervalMillis = 0; // do not background announce\n \n   @JsonProperty(\"numLoadingThreads\")\n-  private int numLoadingThreads = Math.min(1, JvmUtils.getRuntimeInfo().getAvailableProcessors() / 6);\n+  private int numLoadingThreads = Math.max(1, JvmUtils.getRuntimeInfo().getAvailableProcessors() / 6);\n \n   @JsonProperty(\"numBootstrapThreads\")\n   private Integer numBootstrapThreads = null;\n"}}, {"oid": "993948c984b30e79a73c336805cbae828339608f", "url": "https://github.com/apache/druid/commit/993948c984b30e79a73c336805cbae828339608f", "message": "min -> max for segment loading threads", "committedDate": "2020-05-18T14:30:12Z", "type": "commit"}]}