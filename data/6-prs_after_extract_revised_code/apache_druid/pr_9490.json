{"pr_number": 9490, "pr_title": "Fix NPE when using IndexedTable and all left rows are filtered out", "pr_createdAt": "2020-03-10T00:12:27Z", "pr_url": "https://github.com/apache/druid/pull/9490", "timeline": [{"oid": "1dc8405342689ec3c0267cc2addbb1a23091208a", "url": "https://github.com/apache/druid/commit/1dc8405342689ec3c0267cc2addbb1a23091208a", "message": "Fix NPE when using IndexedTable and all left rows are filtered out", "committedDate": "2020-03-10T20:33:58Z", "type": "commit"}, {"oid": "74f015d1f8665b3830735cf81ea690802daa6185", "url": "https://github.com/apache/druid/commit/74f015d1f8665b3830735cf81ea690802daa6185", "message": "Fix compile", "committedDate": "2020-03-10T20:36:05Z", "type": "commit"}, {"oid": "74f015d1f8665b3830735cf81ea690802daa6185", "url": "https://github.com/apache/druid/commit/74f015d1f8665b3830735cf81ea690802daa6185", "message": "Fix compile", "committedDate": "2020-03-10T20:36:05Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDYwMTU1Nw==", "url": "https://github.com/apache/druid/pull/9490#discussion_r390601557", "bodyText": "Perhaps create a named constant for this that's also used by the reset() method in this class", "author": "ccaominh", "createdAt": "2020-03-10T20:48:42Z", "path": "processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java", "diffHunk": "@@ -81,6 +81,7 @@\n   )\n   {\n     this.table = table;\n+    this.currentRow = -1;", "originalCommit": "74f015d1f8665b3830735cf81ea690802daa6185", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMzMDk5MQ==", "url": "https://github.com/apache/druid/pull/9490#discussion_r391330991", "bodyText": "Added a constant", "author": "jon-wei", "createdAt": "2020-03-11T23:43:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDYwMTU1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "102b5b92c01550ad39ee51e299e9d2ca162178bf", "chunk": "diff --git a/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java b/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java\nindex a5f3fe8f26..80e4774a46 100644\n--- a/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java\n+++ b/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java\n\n@@ -81,7 +83,7 @@ public class IndexedTableJoinMatcher implements JoinMatcher\n   )\n   {\n     this.table = table;\n-    this.currentRow = -1;\n+    this.currentRow = UNINITIALIZED_CURRENT_ROW;\n \n     if (condition.isAlwaysTrue()) {\n       this.conditionMatchers = Collections.singletonList(() -> IntIterators.fromTo(0, table.numRows()));\n"}}, {"oid": "102b5b92c01550ad39ee51e299e9d2ca162178bf", "url": "https://github.com/apache/druid/commit/102b5b92c01550ad39ee51e299e9d2ca162178bf", "message": "Add constant for uninitialized current row", "committedDate": "2020-03-11T23:42:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTM0OTYwOQ==", "url": "https://github.com/apache/druid/pull/9490#discussion_r391349609", "bodyText": "Checkstyle is flagging this:\nERROR] /home/travis/build/apache/druid/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java:62:17: 'static' modifier out of order with the JLS suggestions. [ModifierOrder]", "author": "ccaominh", "createdAt": "2020-03-12T00:54:52Z", "path": "processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java", "diffHunk": "@@ -59,6 +59,8 @@\n \n public class IndexedTableJoinMatcher implements JoinMatcher\n {\n+  private final static int UNINITIALIZED_CURRENT_ROW = -1;", "originalCommit": "102b5b92c01550ad39ee51e299e9d2ca162178bf", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7780ce4069485907caee7be755cc8712f7c3b558", "chunk": "diff --git a/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java b/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java\nindex 80e4774a46..5313bac26f 100644\n--- a/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java\n+++ b/processing/src/main/java/org/apache/druid/segment/join/table/IndexedTableJoinMatcher.java\n\n@@ -59,7 +59,7 @@ import java.util.stream.Collectors;\n \n public class IndexedTableJoinMatcher implements JoinMatcher\n {\n-  private final static int UNINITIALIZED_CURRENT_ROW = -1;\n+  private static final int UNINITIALIZED_CURRENT_ROW = -1;\n \n   private final IndexedTable table;\n   private final List<Supplier<IntIterator>> conditionMatchers;\n"}}, {"oid": "7780ce4069485907caee7be755cc8712f7c3b558", "url": "https://github.com/apache/druid/commit/7780ce4069485907caee7be755cc8712f7c3b558", "message": "Fix checkstyle", "committedDate": "2020-03-12T01:13:43Z", "type": "commit"}]}