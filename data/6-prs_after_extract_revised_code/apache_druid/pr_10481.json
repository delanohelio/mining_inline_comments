{"pr_number": 10481, "pr_title": "Make sure all fields in sys.segments are JSON-serialized ", "pr_createdAt": "2020-10-05T22:15:20Z", "pr_url": "https://github.com/apache/druid/pull/10481", "timeline": [{"oid": "9992c0d331924cabc0601ff8c37940601530db17", "url": "https://github.com/apache/druid/commit/9992c0d331924cabc0601ff8c37940601530db17", "message": "fix JSON format", "committedDate": "2020-10-01T21:21:07Z", "type": "commit"}, {"oid": "1c14aad4c67a5d538a6923695f96f4d9fd83af4d", "url": "https://github.com/apache/druid/commit/1c14aad4c67a5d538a6923695f96f4d9fd83af4d", "message": "Change all columns in sys segments to be JSON", "committedDate": "2020-10-02T01:11:26Z", "type": "commit"}, {"oid": "a2f9d86cafc1b634af904599cf96c813e56e7553", "url": "https://github.com/apache/druid/commit/a2f9d86cafc1b634af904599cf96c813e56e7553", "message": "Change all columns in sys segments to be JSON", "committedDate": "2020-10-02T01:13:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxMzI5OQ==", "url": "https://github.com/apache/druid/pull/10481#discussion_r499913299", "bodyText": "shardSpec was introduced in this change #9883 and changing it to shard_spec would be a breaking change. I don't think we should do this without an upgrade plan", "author": "suneet-s", "createdAt": "2020-10-05T22:48:27Z", "path": "sql/src/main/java/org/apache/druid/sql/calcite/schema/SystemSchema.java", "diffHunk": "@@ -142,7 +143,7 @@\n       .add(\"is_available\", ValueType.LONG)\n       .add(\"is_realtime\", ValueType.LONG)\n       .add(\"is_overshadowed\", ValueType.LONG)\n-      .add(\"shardSpec\", ValueType.STRING)\n+      .add(\"shard_spec\", ValueType.STRING)", "originalCommit": "a2f9d86cafc1b634af904599cf96c813e56e7553", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxOTI3NA==", "url": "https://github.com/apache/druid/pull/10481#discussion_r499919274", "bodyText": "I don't think there is anything in Druid depending on shardSpec (similar to how the linked PR changed payload to shardSpec, metrics, dimensions). I can update the document but I don't think anything will break. I guess unless someone has a custom script reading this field which is probably unlikely and is why we should change this ASAP.", "author": "maytasm", "createdAt": "2020-10-05T23:07:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxMzI5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkyMjQ3OQ==", "url": "https://github.com/apache/druid/pull/10481#discussion_r499922479", "bodyText": "The linked PR added those fields, so we didn't have to worry about backwards incompatibility.\n@yuanlihan since you introduced this field, do you have any comments on changing the name of this field?", "author": "suneet-s", "createdAt": "2020-10-05T23:18:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxMzI5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkyNDE0MA==", "url": "https://github.com/apache/druid/pull/10481#discussion_r499924140", "bodyText": "The linked PR removed payload and added shardSpec, metrics, dimensions", "author": "maytasm", "createdAt": "2020-10-05T23:23:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTkxMzI5OQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "4a0448d736cd26aa56280632631139e158e1d13a", "url": "https://github.com/apache/druid/commit/4a0448d736cd26aa56280632631139e158e1d13a", "message": "add tests", "committedDate": "2020-10-05T23:46:37Z", "type": "commit"}, {"oid": "a0d83f0d6ae172d21209b1cd4d025300d99dffe0", "url": "https://github.com/apache/druid/commit/a0d83f0d6ae172d21209b1cd4d025300d99dffe0", "message": "fix failing tests", "committedDate": "2020-10-14T05:21:04Z", "type": "commit"}, {"oid": "c169833b09b54b216f08ad8a9efa0d4f5ba57e64", "url": "https://github.com/apache/druid/commit/c169833b09b54b216f08ad8a9efa0d4f5ba57e64", "message": "fix failing tests", "committedDate": "2020-10-14T05:22:25Z", "type": "commit"}]}