{"pr_number": 9614, "pr_title": "Add tests for valid and invalid datasource names", "pr_createdAt": "2020-04-03T21:17:34Z", "pr_url": "https://github.com/apache/druid/pull/9614", "timeline": [{"oid": "f8efeb715a31f556082faabe226a9b83a3d09df5", "url": "https://github.com/apache/druid/commit/f8efeb715a31f556082faabe226a9b83a3d09df5", "message": "Add tests for valid and invalid datasource names", "committedDate": "2020-04-03T21:16:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NDE3NQ==", "url": "https://github.com/apache/druid/pull/9614#discussion_r403344175", "bodyText": "The test class can extend NullHandlingTest instead.", "author": "ccaominh", "createdAt": "2020-04-03T21:26:12Z", "path": "server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java", "diffHunk": "@@ -54,10 +56,20 @@\n import java.nio.charset.StandardCharsets;\n import java.util.Arrays;\n import java.util.Collections;\n+import java.util.List;\n import java.util.Map;\n \n public class DataSchemaTest\n {\n+\n+  private static final String VALID_DATASOURCE_CHARS_NAME = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n+  private static final String VALID_DATASOURCE_CHARS_FOR_SERIALIZER = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n+\n+  static {\n+    // testTransformSpec needs NullHandling initialized.\n+    NullHandling.initializeForTests();\n+  }", "originalCommit": "f8efeb715a31f556082faabe226a9b83a3d09df5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMTQ0Mg==", "url": "https://github.com/apache/druid/pull/9614#discussion_r404231442", "bodyText": "Done", "author": "suneet-s", "createdAt": "2020-04-06T16:36:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NDE3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "0422580a16dfe485e3fa85ad3959f80d0bd029a5", "chunk": "diff --git a/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java b/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java\nindex fd8a7ee99e..ff081c598b 100644\n--- a/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java\n+++ b/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java\n\n@@ -59,16 +60,10 @@ import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n-public class DataSchemaTest\n+public class DataSchemaTest extends NullHandlingTest\n {\n \n   private static final String VALID_DATASOURCE_CHARS_NAME = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n-  private static final String VALID_DATASOURCE_CHARS_FOR_SERIALIZER = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n-\n-  static {\n-    // testTransformSpec needs NullHandling initialized.\n-    NullHandling.initializeForTests();\n-  }\n \n   @Rule\n   public ExpectedException expectedException = ExpectedException.none();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NDc4Ng==", "url": "https://github.com/apache/druid/pull/9614#discussion_r403344786", "bodyText": "Suggest adding a helper method that escapes VALID_DATASOURCE_CHARS_NAME. The helper method can be used here as well as in testSerializeWithInvalidDataSourceName()", "author": "ccaominh", "createdAt": "2020-04-03T21:27:46Z", "path": "server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java", "diffHunk": "@@ -54,10 +56,20 @@\n import java.nio.charset.StandardCharsets;\n import java.util.Arrays;\n import java.util.Collections;\n+import java.util.List;\n import java.util.Map;\n \n public class DataSchemaTest\n {\n+\n+  private static final String VALID_DATASOURCE_CHARS_NAME = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n+  private static final String VALID_DATASOURCE_CHARS_FOR_SERIALIZER = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\\\\\ \ud55c\uad6d \u4e2d\u56fd!\";", "originalCommit": "f8efeb715a31f556082faabe226a9b83a3d09df5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDIzMTU4MA==", "url": "https://github.com/apache/druid/pull/9614#discussion_r404231580", "bodyText": "\ud83d\udc4d", "author": "suneet-s", "createdAt": "2020-04-06T16:37:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzM0NDc4Ng=="}], "type": "inlineReview", "revised_code": {"commit": "0422580a16dfe485e3fa85ad3959f80d0bd029a5", "chunk": "diff --git a/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java b/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java\nindex fd8a7ee99e..ff081c598b 100644\n--- a/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java\n+++ b/server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java\n\n@@ -59,16 +60,10 @@ import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n-public class DataSchemaTest\n+public class DataSchemaTest extends NullHandlingTest\n {\n \n   private static final String VALID_DATASOURCE_CHARS_NAME = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n-  private static final String VALID_DATASOURCE_CHARS_FOR_SERIALIZER = \"alpha123..*~!@#&%^&*()-+ \u0420\u043e\u0441\u0441\u0438\u044f\\\\\\\\ \ud55c\uad6d \u4e2d\u56fd!\";\n-\n-  static {\n-    // testTransformSpec needs NullHandling initialized.\n-    NullHandling.initializeForTests();\n-  }\n \n   @Rule\n   public ExpectedException expectedException = ExpectedException.none();\n"}}, {"oid": "0422580a16dfe485e3fa85ad3959f80d0bd029a5", "url": "https://github.com/apache/druid/commit/0422580a16dfe485e3fa85ad3959f80d0bd029a5", "message": "code review", "committedDate": "2020-04-06T16:55:48Z", "type": "commit"}, {"oid": "4c918fb003a56d1b1c3bb48edee489bdf44a7c6b", "url": "https://github.com/apache/druid/commit/4c918fb003a56d1b1c3bb48edee489bdf44a7c6b", "message": "clean up dependencies", "committedDate": "2020-04-06T19:18:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQzODk4NA==", "url": "https://github.com/apache/druid/pull/9614#discussion_r404438984", "bodyText": "nit: it's actually InitializedNullHandlingTest that you want, but the one you've extended also initializes null handling", "author": "clintropolis", "createdAt": "2020-04-06T23:01:14Z", "path": "server/src/test/java/org/apache/druid/segment/indexing/DataSchemaTest.java", "diffHunk": "@@ -54,10 +57,14 @@\n import java.nio.charset.StandardCharsets;\n import java.util.Arrays;\n import java.util.Collections;\n+import java.util.List;\n import java.util.Map;\n \n-public class DataSchemaTest\n+public class DataSchemaTest extends NullHandlingTest", "originalCommit": "4c918fb003a56d1b1c3bb48edee489bdf44a7c6b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}