{"pr_number": 9729, "pr_title": "Test reading from empty kafka/kinesis partitions", "pr_createdAt": "2020-04-21T03:39:59Z", "pr_url": "https://github.com/apache/druid/pull/9729", "timeline": [{"oid": "e75522c725c26555d29aca48b48b32e8d9aca911", "url": "https://github.com/apache/druid/commit/e75522c725c26555d29aca48b48b32e8d9aca911", "message": "add test for stream sequence number returns null", "committedDate": "2020-04-21T03:30:19Z", "type": "commit"}, {"oid": "d8b86f083f7048eb952e4965f6047557b9cf4883", "url": "https://github.com/apache/druid/commit/d8b86f083f7048eb952e4965f6047557b9cf4883", "message": "fix checkstyle", "committedDate": "2020-04-21T21:55:26Z", "type": "commit"}, {"oid": "578cac7940c320f033ddc9eb4a719d0c4b243d3c", "url": "https://github.com/apache/druid/commit/578cac7940c320f033ddc9eb4a719d0c4b243d3c", "message": "add index test for when stream returns null", "committedDate": "2020-04-22T02:43:03Z", "type": "commit"}, {"oid": "ae222aadcb28fff86752544297de965fceaba46a", "url": "https://github.com/apache/druid/commit/ae222aadcb28fff86752544297de965fceaba46a", "message": "retrigger test", "committedDate": "2020-04-22T07:28:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI2NDM0NA==", "url": "https://github.com/apache/druid/pull/9729#discussion_r414264344", "bodyText": "This change doesn't seem doing anything. Is there some reason?", "author": "jihoonson", "createdAt": "2020-04-24T03:25:52Z", "path": "extensions-core/kinesis-indexing-service/src/main/java/org/apache/druid/indexing/kinesis/KinesisRecordSupplier.java", "diffHunk": "@@ -780,15 +780,14 @@ private String getSequenceNumberInternal(StreamPartition<String> partition, Shar\n   private String getSequenceNumberInternal(StreamPartition<String> partition, String shardIterator)\n   {\n     long timeoutMillis = System.currentTimeMillis() + fetchSequenceNumberTimeout;\n+    GetRecordsResult recordsResult = null;", "originalCommit": "ae222aadcb28fff86752544297de965fceaba46a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI5Nzc1OQ==", "url": "https://github.com/apache/druid/pull/9729#discussion_r414297759", "bodyText": "I want to access recordsResult outside of the while loop (so that I can print the millisBehindLatest in the warn logging line 834). Hence, I moved variable declaration of recordsResult to outside the while loop and we can check for null in the warn logging. If it is not null (meaning it was assign in the while loop when we getRecords from Kinesis) then we can log the millisBehindLatest. This will help us be sure that timeout is due to no data or not", "author": "maytasm", "createdAt": "2020-04-24T05:11:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI2NDM0NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDc0Nzg4NA==", "url": "https://github.com/apache/druid/pull/9729#discussion_r414747884", "bodyText": "Got it. Thanks.", "author": "jihoonson", "createdAt": "2020-04-24T17:37:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDI2NDM0NA=="}], "type": "inlineReview", "revised_code": null}]}