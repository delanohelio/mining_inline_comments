{"pr_number": 9472, "pr_title": "Add option to control join filter rewrites", "pr_createdAt": "2020-03-06T20:43:28Z", "pr_url": "https://github.com/apache/druid/pull/9472", "timeline": [{"oid": "150f643c0c7560852eb818bfe35c76ed604e42d3", "url": "https://github.com/apache/druid/commit/150f643c0c7560852eb818bfe35c76ed604e42d3", "message": "Add option to control join filter rewrites", "committedDate": "2020-03-06T20:32:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE3MjgzNg==", "url": "https://github.com/apache/druid/pull/9472#discussion_r389172836", "bodyText": "Does this need to be added to the docs?", "author": "ccaominh", "createdAt": "2020-03-06T22:22:40Z", "path": "processing/src/main/java/org/apache/druid/query/QueryContexts.java", "diffHunk": "@@ -46,6 +46,7 @@\n   public static final String VECTORIZE_KEY = \"vectorize\";\n   public static final String VECTOR_SIZE_KEY = \"vectorSize\";\n   public static final String JOIN_FILTER_PUSH_DOWN_KEY = \"enableJoinFilterPushDown\";\n+  public static final String JOIN_FILTER_REWRITE_KEY = \"enableJoinFilterRewrite\";", "originalCommit": "150f643c0c7560852eb818bfe35c76ed604e42d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTkzMjIyMw==", "url": "https://github.com/apache/druid/pull/9472#discussion_r389932223", "bodyText": "It should, I'll do a follow on PR that adds docs for enableJoinFilterPushDown as well", "author": "jon-wei", "createdAt": "2020-03-09T20:08:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE3MjgzNg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE3NTE3Nw==", "url": "https://github.com/apache/druid/pull/9472#discussion_r389175177", "bodyText": "Wrong key name (unused new rewrite key name getting flagged by intellij inspection job)", "author": "ccaominh", "createdAt": "2020-03-06T22:29:59Z", "path": "processing/src/main/java/org/apache/druid/query/QueryContexts.java", "diffHunk": "@@ -225,6 +227,11 @@ public String toString()\n     return parseBoolean(query, JOIN_FILTER_PUSH_DOWN_KEY, DEFAULT_ENABLE_JOIN_FILTER_PUSH_DOWN);\n   }\n \n+  public static <T> boolean getEnableJoinFilterRewrite(Query<T> query)\n+  {\n+    return parseBoolean(query, JOIN_FILTER_PUSH_DOWN_KEY, DEFAULT_ENABLE_JOIN_FILTER_REWRITE);", "originalCommit": "150f643c0c7560852eb818bfe35c76ed604e42d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTkzMjM3OQ==", "url": "https://github.com/apache/druid/pull/9472#discussion_r389932379", "bodyText": "Fixed", "author": "jon-wei", "createdAt": "2020-03-09T20:08:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE3NTE3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "92f290bc46a0a3147ad56bce3b48f6a4ec7fe3d4", "chunk": "diff --git a/processing/src/main/java/org/apache/druid/query/QueryContexts.java b/processing/src/main/java/org/apache/druid/query/QueryContexts.java\nindex 8a0324b16e..2af3b95156 100644\n--- a/processing/src/main/java/org/apache/druid/query/QueryContexts.java\n+++ b/processing/src/main/java/org/apache/druid/query/QueryContexts.java\n\n@@ -229,7 +229,7 @@ public class QueryContexts\n \n   public static <T> boolean getEnableJoinFilterRewrite(Query<T> query)\n   {\n-    return parseBoolean(query, JOIN_FILTER_PUSH_DOWN_KEY, DEFAULT_ENABLE_JOIN_FILTER_REWRITE);\n+    return parseBoolean(query, JOIN_FILTER_REWRITE_KEY, DEFAULT_ENABLE_JOIN_FILTER_REWRITE);\n   }\n \n   public static <T> Query<T> withMaxScatterGatherBytes(Query<T> query, long maxScatterGatherBytesLimit)\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE3NjM5NA==", "url": "https://github.com/apache/druid/pull/9472#discussion_r389176394", "bodyText": "Javadoc reference to this method on line 54 needs to be updated (flagged by intellij inspection job)", "author": "ccaominh", "createdAt": "2020-03-06T22:33:27Z", "path": "processing/src/main/java/org/apache/druid/segment/join/filter/JoinFilterAnalyzer.java", "diffHunk": "@@ -88,7 +88,8 @@ public static JoinFilterSplit splitFilter(\n       HashJoinSegmentStorageAdapter hashJoinSegmentStorageAdapter,\n       Set<String> baseColumnNames,\n       @Nullable Filter originalFilter,\n-      boolean enableFilterPushDown\n+      boolean enableFilterPushDown,\n+      boolean enableFilterRewrite", "originalCommit": "150f643c0c7560852eb818bfe35c76ed604e42d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTkzMjQyNg==", "url": "https://github.com/apache/druid/pull/9472#discussion_r389932426", "bodyText": "Fixed", "author": "jon-wei", "createdAt": "2020-03-09T20:08:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTE3NjM5NA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "92f290bc46a0a3147ad56bce3b48f6a4ec7fe3d4", "url": "https://github.com/apache/druid/commit/92f290bc46a0a3147ad56bce3b48f6a4ec7fe3d4", "message": "Fix inspections", "committedDate": "2020-03-09T20:07:02Z", "type": "commit"}]}