{"pr_number": 1558, "pr_title": "GG-31173: ODBC nullability info for columns", "pr_createdAt": "2020-11-10T14:31:17Z", "pr_url": "https://github.com/gridgain/gridgain/pull/1558", "timeline": [{"oid": "3c5acf1ad52167fcbe0d8435ba58b528479f1997", "url": "https://github.com/gridgain/gridgain/commit/3c5acf1ad52167fcbe0d8435ba58b528479f1997", "message": "GG-31173: Server provides nullability info for columns", "committedDate": "2020-11-10T13:19:26Z", "type": "commit"}, {"oid": "4c0cf9c0c48b737d482319be93aed7e3ec7b089c", "url": "https://github.com/gridgain/gridgain/commit/4c0cf9c0c48b737d482319be93aed7e3ec7b089c", "message": "GG-31173: Implement ODBC Driver part. Fix tests", "committedDate": "2020-11-10T14:24:09Z", "type": "commit"}, {"oid": "4223c2753aa5f7824e9e002403c725b049b55325", "url": "https://github.com/gridgain/gridgain/commit/4223c2753aa5f7824e9e002403c725b049b55325", "message": "GG-31173: Add protocol versions tests", "committedDate": "2020-11-10T14:28:03Z", "type": "commit"}, {"oid": "6bd247ba239fd604cca3d11a069cee01b38ec4c9", "url": "https://github.com/gridgain/gridgain/commit/6bd247ba239fd604cca3d11a069cee01b38ec4c9", "message": "GG-31173: Remove unused import", "committedDate": "2020-11-10T14:51:14Z", "type": "commit"}, {"oid": "6bd247ba239fd604cca3d11a069cee01b38ec4c9", "url": "https://github.com/gridgain/gridgain/commit/6bd247ba239fd604cca3d11a069cee01b38ec4c9", "message": "GG-31173: Remove unused import", "committedDate": "2020-11-10T14:51:14Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyMjczMQ==", "url": "https://github.com/gridgain/gridgain/pull/1558#discussion_r520622731", "bodyText": "Using int for nullability is very confusing, especially if you don't know about ResultSetMetaData. Can we make this boolean, since columnNullableUnknown is not used and there are only 2 possible values? Here and below.\nShould we add a property instead of making the field public?", "author": "ptupitsyn", "createdAt": "2020-11-10T14:52:20Z", "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/odbc/odbc/OdbcColumnMeta.java", "diffHunk": "@@ -45,8 +45,8 @@\n     /** Scale. */\n     public final int scale;\n \n-    /** Client version. */\n-    private final ClientListenerProtocolVersion ver;\n+    /** Nullability. */\n+    public final int nullability;", "originalCommit": "6bd247ba239fd604cca3d11a069cee01b38ec4c9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY0NTIwOA==", "url": "https://github.com/gridgain/gridgain/pull/1558#discussion_r520645208", "bodyText": "I'm not sure that columnNullableUnknown is not used and can never be returned. Do you propose to use some kind of enum here? Or should I add a comment?\nYou are right. I'm not sure, why this and other fields are public. Will change.", "author": "isapego", "createdAt": "2020-11-10T15:20:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyMjczMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDY2MjQ2Mg==", "url": "https://github.com/gridgain/gridgain/pull/1558#discussion_r520662462", "bodyText": "This field is initialized only in one place in OdbcRequestHandler: prop.notNull() ? columnNoNulls : columnNullable.\ncolumnNullableUnknown is never used if I'm not missing anything.", "author": "ptupitsyn", "createdAt": "2020-11-10T15:42:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyMjczMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcwNjI0Nw==", "url": "https://github.com/gridgain/gridgain/pull/1558#discussion_r520706247", "bodyText": "That's not the only place where nullability is taken from - see second constructor, it takes nullability from H2 result set column information.", "author": "isapego", "createdAt": "2020-11-10T16:39:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyMjczMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcyMDQxOA==", "url": "https://github.com/gridgain/gridgain/pull/1558#discussion_r520720418", "bodyText": "Ok then, let's keep it as is, but add a comment with a reference to ResultSetMetaData to indicate the meaning.", "author": "ptupitsyn", "createdAt": "2020-11-10T16:59:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyMjczMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDcyODEwNw==", "url": "https://github.com/gridgain/gridgain/pull/1558#discussion_r520728107", "bodyText": "Added comment that I hope will make it more clear.", "author": "isapego", "createdAt": "2020-11-10T17:10:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYyMjczMQ=="}], "type": "inlineReview", "revised_code": {"commit": "0149f666ed7d2c3ba6a3addcb4844af159c19250", "chunk": "diff --git a/modules/core/src/main/java/org/apache/ignite/internal/processors/odbc/odbc/OdbcColumnMeta.java b/modules/core/src/main/java/org/apache/ignite/internal/processors/odbc/odbc/OdbcColumnMeta.java\nindex ad6f0b4b817..7dbd438c1b3 100644\n--- a/modules/core/src/main/java/org/apache/ignite/internal/processors/odbc/odbc/OdbcColumnMeta.java\n+++ b/modules/core/src/main/java/org/apache/ignite/internal/processors/odbc/odbc/OdbcColumnMeta.java\n\n@@ -34,19 +34,19 @@ public class OdbcColumnMeta {\n     private final String tableName;\n \n     /** Column name. */\n-    public final String columnName;\n+    private final String columnName;\n \n     /** Data type. */\n     private final Class<?> dataType;\n \n     /** Precision. */\n-    public final int precision;\n+    private final int precision;\n \n     /** Scale. */\n-    public final int scale;\n+    private final int scale;\n \n-    /** Nullability. */\n-    public final int nullability;\n+    /** Nullability. See {@link java.sql.ResultSetMetaData#isNullable(int)} for more info. */\n+    private final int nullability;\n \n     /**\n      * @param schemaName Cache name.\n"}}, {"oid": "0149f666ed7d2c3ba6a3addcb4844af159c19250", "url": "https://github.com/gridgain/gridgain/commit/0149f666ed7d2c3ba6a3addcb4844af159c19250", "message": "GG-31173: Fix review findings", "committedDate": "2020-11-10T15:39:30Z", "type": "commit"}]}