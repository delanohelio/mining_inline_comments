{"pr_number": 1076, "pr_title": "GG-27581 .NET: Add partition-based AffinityCall and AffinityRun overloads", "pr_createdAt": "2020-04-15T19:12:22Z", "pr_url": "https://github.com/gridgain/gridgain/pull/1076", "timeline": [{"oid": "cff332560be88194caea998224bf3d9fe3cab7f7", "url": "https://github.com/gridgain/gridgain/commit/cff332560be88194caea998224bf3d9fe3cab7f7", "message": "Add new APIs", "committedDate": "2020-04-13T13:01:17Z", "type": "commit"}, {"oid": "6373043d38c585ab1f1bd82df60d5371cd17b6e1", "url": "https://github.com/gridgain/gridgain/commit/6373043d38c585ab1f1bd82df60d5371cd17b6e1", "message": "Merge remote-tracking branch 'ggce/8.7-master' into gg-27581", "committedDate": "2020-04-14T08:15:11Z", "type": "commit"}, {"oid": "1cfccfabffb9aa159db88530c93f8a068ac08499", "url": "https://github.com/gridgain/gridgain/commit/1cfccfabffb9aa159db88530c93f8a068ac08499", "message": "Implementing AffinityCall", "committedDate": "2020-04-14T08:25:53Z", "type": "commit"}, {"oid": "b5b8f5a00c054c9d8392f062df990dd15b06f385", "url": "https://github.com/gridgain/gridgain/commit/b5b8f5a00c054c9d8392f062df990dd15b06f385", "message": "Implementing AffinityCall", "committedDate": "2020-04-14T08:34:57Z", "type": "commit"}, {"oid": "4a720ad6880d2e2d67c9b23009e5f12357697aec", "url": "https://github.com/gridgain/gridgain/commit/4a720ad6880d2e2d67c9b23009e5f12357697aec", "message": "Add TestAffinityCallWithPartition", "committedDate": "2020-04-14T08:44:43Z", "type": "commit"}, {"oid": "8d3cc4117a816aea30fe9bc535ad0bd87bb36bdb", "url": "https://github.com/gridgain/gridgain/commit/8d3cc4117a816aea30fe9bc535ad0bd87bb36bdb", "message": "Implementing AffinityCallAsync", "committedDate": "2020-04-14T10:56:39Z", "type": "commit"}, {"oid": "ce93db4465297ca31b025e5efb5f73569be5fbc4", "url": "https://github.com/gridgain/gridgain/commit/ce93db4465297ca31b025e5efb5f73569be5fbc4", "message": "Implementing AffinityCall", "committedDate": "2020-04-14T11:02:06Z", "type": "commit"}, {"oid": "7aed382227342bd0175ba31c3c8aa9f05bef6ba0", "url": "https://github.com/gridgain/gridgain/commit/7aed382227342bd0175ba31c3c8aa9f05bef6ba0", "message": "Implementing AffinityCall", "committedDate": "2020-04-14T11:04:04Z", "type": "commit"}, {"oid": "eb07236fca72f197b9beea383d8243bcd0b8f80e", "url": "https://github.com/gridgain/gridgain/commit/eb07236fca72f197b9beea383d8243bcd0b8f80e", "message": "Implementing ComputeJobReadAndExecute", "committedDate": "2020-04-14T11:29:38Z", "type": "commit"}, {"oid": "5e137b0def7ab308c0687f83d1193eabe79ee890", "url": "https://github.com/gridgain/gridgain/commit/5e137b0def7ab308c0687f83d1193eabe79ee890", "message": "Implementing AffinityCallAsync", "committedDate": "2020-04-14T11:36:36Z", "type": "commit"}, {"oid": "ee615831562b51f1b823477ac57539e833a20188", "url": "https://github.com/gridgain/gridgain/commit/ee615831562b51f1b823477ac57539e833a20188", "message": "Test works", "committedDate": "2020-04-14T12:05:12Z", "type": "commit"}, {"oid": "acf82992ef5bae57be8880e07445cbbdde83cad5", "url": "https://github.com/gridgain/gridgain/commit/acf82992ef5bae57be8880e07445cbbdde83cad5", "message": "cleanup", "committedDate": "2020-04-14T12:58:05Z", "type": "commit"}, {"oid": "360acddaad7dabbc55c98915ebb711badf9618f0", "url": "https://github.com/gridgain/gridgain/commit/360acddaad7dabbc55c98915ebb711badf9618f0", "message": "TODOs", "committedDate": "2020-04-14T17:42:51Z", "type": "commit"}, {"oid": "7e66a311178b994fbc5da726e38afe170fe762e4", "url": "https://github.com/gridgain/gridgain/commit/7e66a311178b994fbc5da726e38afe170fe762e4", "message": "Get rid of wrappers: wip", "committedDate": "2020-04-14T17:59:10Z", "type": "commit"}, {"oid": "c2de56f69e9594d832fb77add706ac361f7cfb7e", "url": "https://github.com/gridgain/gridgain/commit/c2de56f69e9594d832fb77add706ac361f7cfb7e", "message": "Get rid of wrappers: it works for simple case", "committedDate": "2020-04-14T18:00:29Z", "type": "commit"}, {"oid": "8d3ab230eb76085043c7d6691d846b2ffdde3591", "url": "https://github.com/gridgain/gridgain/commit/8d3ab230eb76085043c7d6691d846b2ffdde3591", "message": "TODOs", "committedDate": "2020-04-14T18:00:53Z", "type": "commit"}, {"oid": "603ef4bc89d4413fc754c3c5375690720e32ebba", "url": "https://github.com/gridgain/gridgain/commit/603ef4bc89d4413fc754c3c5375690720e32ebba", "message": "Refactoring Compute logic to extract reusable code", "committedDate": "2020-04-14T18:16:39Z", "type": "commit"}, {"oid": "abf8113014b3a88e53b7f75567a0da2ec42ca904", "url": "https://github.com/gridgain/gridgain/commit/abf8113014b3a88e53b7f75567a0da2ec42ca904", "message": "Refactoring Compute logic to extract reusable code", "committedDate": "2020-04-14T18:32:10Z", "type": "commit"}, {"oid": "bca7316d0da578cfd4d65cc66401c985827cd925", "url": "https://github.com/gridgain/gridgain/commit/bca7316d0da578cfd4d65cc66401c985827cd925", "message": "Refactoring Compute logic to extract reusable code", "committedDate": "2020-04-14T18:32:48Z", "type": "commit"}, {"oid": "ce7d20a6466c24ada055c7f806f7047dd5afa987", "url": "https://github.com/gridgain/gridgain/commit/ce7d20a6466c24ada055c7f806f7047dd5afa987", "message": "Refactoring Compute logic to extract reusable code", "committedDate": "2020-04-14T18:35:41Z", "type": "commit"}, {"oid": "8c4d25dda24d50a48ef217c8da513d7284a7423f", "url": "https://github.com/gridgain/gridgain/commit/8c4d25dda24d50a48ef217c8da513d7284a7423f", "message": "cleanup", "committedDate": "2020-04-14T18:37:57Z", "type": "commit"}, {"oid": "51bac569e2f0211d3d0799b84657b2e0ecbba3ab", "url": "https://github.com/gridgain/gridgain/commit/51bac569e2f0211d3d0799b84657b2e0ecbba3ab", "message": "TODOs", "committedDate": "2020-04-14T18:42:56Z", "type": "commit"}, {"oid": "0cfddb38bbe13de59bf005f3bc00280dc9dbd3c5", "url": "https://github.com/gridgain/gridgain/commit/0cfddb38bbe13de59bf005f3bc00280dc9dbd3c5", "message": "Implementing AffinityRun", "committedDate": "2020-04-15T07:41:04Z", "type": "commit"}, {"oid": "9d26c2a4802cc2f461b73d5a02d1c7f85e09d9e2", "url": "https://github.com/gridgain/gridgain/commit/9d26c2a4802cc2f461b73d5a02d1c7f85e09d9e2", "message": "Implementing AffinityRun", "committedDate": "2020-04-15T08:52:55Z", "type": "commit"}, {"oid": "b38945d61beaf761ad95ab8134cedceed30fcb83", "url": "https://github.com/gridgain/gridgain/commit/b38945d61beaf761ad95ab8134cedceed30fcb83", "message": "TestAffinityRunWithPartition", "committedDate": "2020-04-15T08:56:54Z", "type": "commit"}, {"oid": "a258c68e1fce5e48c4c03f5829618e555aa40c78", "url": "https://github.com/gridgain/gridgain/commit/a258c68e1fce5e48c4c03f5829618e555aa40c78", "message": "Add compute action callback", "committedDate": "2020-04-15T09:45:20Z", "type": "commit"}, {"oid": "0d62d68e7943b12e594bcf19cb2118f4d21fbcba", "url": "https://github.com/gridgain/gridgain/commit/0d62d68e7943b12e594bcf19cb2118f4d21fbcba", "message": "Fix callbacks", "committedDate": "2020-04-15T09:53:13Z", "type": "commit"}, {"oid": "4583446f8f2cbe0a7a4399c87414e88009b244ef", "url": "https://github.com/gridgain/gridgain/commit/4583446f8f2cbe0a7a4399c87414e88009b244ef", "message": "TestAffinityRunWithPartition works", "committedDate": "2020-04-15T10:07:37Z", "type": "commit"}, {"oid": "4a1dd061ec1782434478b3442ddb4610c7edbfb3", "url": "https://github.com/gridgain/gridgain/commit/4a1dd061ec1782434478b3442ddb4610c7edbfb3", "message": "wip", "committedDate": "2020-04-15T10:10:51Z", "type": "commit"}, {"oid": "68e248724c60dc78e95a4a547ace722b33b26403", "url": "https://github.com/gridgain/gridgain/commit/68e248724c60dc78e95a4a547ace722b33b26403", "message": "Extract PlatformAbstractFunc", "committedDate": "2020-04-15T10:25:59Z", "type": "commit"}, {"oid": "753ebbf885ce0a3747dc769f574402ef910c1772", "url": "https://github.com/gridgain/gridgain/commit/753ebbf885ce0a3747dc769f574402ef910c1772", "message": "Merge remote-tracking branch 'ggce/8.7-master' into gg-27581", "committedDate": "2020-04-15T10:29:15Z", "type": "commit"}, {"oid": "5b9bc40b36caef89b4b36f76043019c96870c505", "url": "https://github.com/gridgain/gridgain/commit/5b9bc40b36caef89b4b36f76043019c96870c505", "message": "cleanup", "committedDate": "2020-04-15T10:42:30Z", "type": "commit"}, {"oid": "54fe0c55c49420f4b80ddd8eb8dd718c8e44840f", "url": "https://github.com/gridgain/gridgain/commit/54fe0c55c49420f4b80ddd8eb8dd718c8e44840f", "message": "Fixing existing AffinityCall & AffinityRun", "committedDate": "2020-04-15T11:12:50Z", "type": "commit"}, {"oid": "61487f6ff7d4fbc91d7ef55a8d5553a64af67328", "url": "https://github.com/gridgain/gridgain/commit/61487f6ff7d4fbc91d7ef55a8d5553a64af67328", "message": "Fixing existing AffinityCall & AffinityRun", "committedDate": "2020-04-15T11:34:22Z", "type": "commit"}, {"oid": "78bce6e2068cf574311dd20db4fe76c1b2a015be", "url": "https://github.com/gridgain/gridgain/commit/78bce6e2068cf574311dd20db4fe76c1b2a015be", "message": "Include Streamer tests in .NET Core proj", "committedDate": "2020-04-15T16:20:29Z", "type": "commit"}, {"oid": "05a7b7d9303192a5090b20f6914d7a62f302f5b6", "url": "https://github.com/gridgain/gridgain/commit/05a7b7d9303192a5090b20f6914d7a62f302f5b6", "message": "Fix existing Affinity* APIs", "committedDate": "2020-04-15T18:20:49Z", "type": "commit"}, {"oid": "f247b10d01b9ebd68795a4b2e97f59f93274438c", "url": "https://github.com/gridgain/gridgain/commit/f247b10d01b9ebd68795a4b2e97f59f93274438c", "message": "Fixing existing AffinityCall & AffinityRun - remove unused code", "committedDate": "2020-04-15T18:47:16Z", "type": "commit"}, {"oid": "c4240af09f140997247f78ba4a7c41f34bbe7747", "url": "https://github.com/gridgain/gridgain/commit/c4240af09f140997247f78ba4a7c41f34bbe7747", "message": "cleanup", "committedDate": "2020-04-15T18:53:48Z", "type": "commit"}, {"oid": "8ba675b6c719ebacf9138712d4e78a63be3a55b3", "url": "https://github.com/gridgain/gridgain/commit/8ba675b6c719ebacf9138712d4e78a63be3a55b3", "message": "Test that partition is reserved", "committedDate": "2020-04-15T19:02:06Z", "type": "commit"}, {"oid": "2772298501120ddc50b7ec9a5492c676a145e75e", "url": "https://github.com/gridgain/gridgain/commit/2772298501120ddc50b7ec9a5492c676a145e75e", "message": "Fix proj", "committedDate": "2020-04-15T19:05:00Z", "type": "commit"}, {"oid": "a4acaa61a5b946fed6a8778eaa394fbda14cc1a0", "url": "https://github.com/gridgain/gridgain/commit/a4acaa61a5b946fed6a8778eaa394fbda14cc1a0", "message": "Cleanup", "committedDate": "2020-04-15T19:05:40Z", "type": "commit"}, {"oid": "ee281ceeb6e281555cd4662ee05a32bbd5814458", "url": "https://github.com/gridgain/gridgain/commit/ee281ceeb6e281555cd4662ee05a32bbd5814458", "message": "Update peer loading tests", "committedDate": "2020-04-15T19:09:58Z", "type": "commit"}, {"oid": "f87ddbc4608ce747e37594969f850f071e404975", "url": "https://github.com/gridgain/gridgain/commit/f87ddbc4608ce747e37594969f850f071e404975", "message": "Merge remote-tracking branch 'ggce/8.7-master' into gg-27581", "committedDate": "2020-04-15T19:14:33Z", "type": "commit"}, {"oid": "b843eda19b9eb8010a57f493404b4c090c73149b", "url": "https://github.com/gridgain/gridgain/commit/b843eda19b9eb8010a57f493404b4c090c73149b", "message": "Bring back PlatformBalancingSingleClosureAffinityTask for compat", "committedDate": "2020-04-15T19:39:52Z", "type": "commit"}, {"oid": "9d8acea365e23fe85b0da5b678851fb789ffe0fe", "url": "https://github.com/gridgain/gridgain/commit/9d8acea365e23fe85b0da5b678851fb789ffe0fe", "message": "Bring back PlatformBalancingSingleClosureAffinityTask for compat", "committedDate": "2020-04-15T19:41:05Z", "type": "commit"}, {"oid": "138098c7440fa465cff8b02acc77b6a0ce0d8692", "url": "https://github.com/gridgain/gridgain/commit/138098c7440fa465cff8b02acc77b6a0ce0d8692", "message": "fix inspection errors", "committedDate": "2020-04-16T19:33:38Z", "type": "commit"}, {"oid": "a464687fbe97b401f7192373e86ac0792f21a5f6", "url": "https://github.com/gridgain/gridgain/commit/a464687fbe97b401f7192373e86ac0792f21a5f6", "message": "TODOs", "committedDate": "2020-04-16T19:50:56Z", "type": "commit"}, {"oid": "c6729b78e160611a3a525526f4b6c0ffd62414dd", "url": "https://github.com/gridgain/gridgain/commit/c6729b78e160611a3a525526f4b6c0ffd62414dd", "message": "Add local execution optimization", "committedDate": "2020-04-16T20:06:01Z", "type": "commit"}, {"oid": "22a37b1ed3a3c6a19a0bace708c8d7c9e4e54b2f", "url": "https://github.com/gridgain/gridgain/commit/22a37b1ed3a3c6a19a0bace708c8d7c9e4e54b2f", "message": "Add local handles", "committedDate": "2020-04-16T20:11:35Z", "type": "commit"}, {"oid": "93f3077cb20b19f634c69a755547f5bfb6c519b2", "url": "https://github.com/gridgain/gridgain/commit/93f3077cb20b19f634c69a755547f5bfb6c519b2", "message": "Add local handles", "committedDate": "2020-04-16T20:29:54Z", "type": "commit"}, {"oid": "02bf7f61dab90505efe07d6b6596d58e7fba96b3", "url": "https://github.com/gridgain/gridgain/commit/02bf7f61dab90505efe07d6b6596d58e7fba96b3", "message": "TODOs", "committedDate": "2020-04-16T20:30:34Z", "type": "commit"}, {"oid": "decbaa31abc1ae4fae4f996a1fa3368028795ae5", "url": "https://github.com/gridgain/gridgain/commit/decbaa31abc1ae4fae4f996a1fa3368028795ae5", "message": "Adding tests", "committedDate": "2020-04-17T10:19:17Z", "type": "commit"}, {"oid": "0ddabda502a4745b9325ac58a26910de77c90d87", "url": "https://github.com/gridgain/gridgain/commit/0ddabda502a4745b9325ac58a26910de77c90d87", "message": "Adding tests", "committedDate": "2020-04-17T10:22:47Z", "type": "commit"}, {"oid": "99b9144713fe4e47867c523f277cfe7bfa6f40dd", "url": "https://github.com/gridgain/gridgain/commit/99b9144713fe4e47867c523f277cfe7bfa6f40dd", "message": "Adding tests", "committedDate": "2020-04-17T10:24:45Z", "type": "commit"}, {"oid": "220bec5633268346743f22ac147ab794e615d2a0", "url": "https://github.com/gridgain/gridgain/commit/220bec5633268346743f22ac147ab794e615d2a0", "message": "Adding tests", "committedDate": "2020-04-17T10:52:23Z", "type": "commit"}, {"oid": "0b9904ed1dbcf627a1a3db96591349f15ea0c588", "url": "https://github.com/gridgain/gridgain/commit/0b9904ed1dbcf627a1a3db96591349f15ea0c588", "message": "Adding tests", "committedDate": "2020-04-17T11:03:28Z", "type": "commit"}, {"oid": "469edac6919bd45dd228c8c653903312fca87328", "url": "https://github.com/gridgain/gridgain/commit/469edac6919bd45dd228c8c653903312fca87328", "message": "Tests done", "committedDate": "2020-04-17T11:32:13Z", "type": "commit"}, {"oid": "8c0cde63742603bdf21f6f08236503f61b15f17f", "url": "https://github.com/gridgain/gridgain/commit/8c0cde63742603bdf21f6f08236503f61b15f17f", "message": "Reduce code duplication", "committedDate": "2020-04-17T11:44:53Z", "type": "commit"}, {"oid": "a4c723f4058815bc642d352ce9443c48b6ba1afa", "url": "https://github.com/gridgain/gridgain/commit/a4c723f4058815bc642d352ce9443c48b6ba1afa", "message": "Improving test coverage", "committedDate": "2020-04-17T11:51:55Z", "type": "commit"}, {"oid": "1debaacb38dc64fb6fe4a923f4ecd47f58e282ca", "url": "https://github.com/gridgain/gridgain/commit/1debaacb38dc64fb6fe4a923f4ecd47f58e282ca", "message": "Adding tests", "committedDate": "2020-04-17T12:19:29Z", "type": "commit"}, {"oid": "023d2b79b3ca6121c30f599bacecf77ff029f472", "url": "https://github.com/gridgain/gridgain/commit/023d2b79b3ca6121c30f599bacecf77ff029f472", "message": "Add cancellation test", "committedDate": "2020-04-17T12:30:53Z", "type": "commit"}, {"oid": "0de5cac326502d178ff038e075f113baacc14700", "url": "https://github.com/gridgain/gridgain/commit/0de5cac326502d178ff038e075f113baacc14700", "message": "cleanup", "committedDate": "2020-04-17T12:32:12Z", "type": "commit"}, {"oid": "98c77ee6e9003f54bb631ad52643dcc9f77825e2", "url": "https://github.com/gridgain/gridgain/commit/98c77ee6e9003f54bb631ad52643dcc9f77825e2", "message": "Merge remote-tracking branch 'ggce/8.7-master' into gg-27581", "committedDate": "2020-04-17T12:34:18Z", "type": "commit"}, {"oid": "e2342ea0ca28e15519c7049171c468c4a35edad7", "url": "https://github.com/gridgain/gridgain/commit/e2342ea0ca28e15519c7049171c468c4a35edad7", "message": "Fix test", "committedDate": "2020-04-17T16:19:15Z", "type": "commit"}, {"oid": "8c19ed4d61ccb0a6bd442d1eab2530d6fc82672c", "url": "https://github.com/gridgain/gridgain/commit/8c19ed4d61ccb0a6bd442d1eab2530d6fc82672c", "message": "Add AffinityCallBenchmark", "committedDate": "2020-04-17T16:37:23Z", "type": "commit"}, {"oid": "82b6d0719139c3d7989d42d070d26315e54376c9", "url": "https://github.com/gridgain/gridgain/commit/82b6d0719139c3d7989d42d070d26315e54376c9", "message": "Add AffinityCallBenchmark", "committedDate": "2020-04-17T17:04:32Z", "type": "commit"}, {"oid": "40896518bcfc18aa8f2cd33b27e1a48372829cf1", "url": "https://github.com/gridgain/gridgain/commit/40896518bcfc18aa8f2cd33b27e1a48372829cf1", "message": "Fix test - add rebalance wait", "committedDate": "2020-04-18T09:25:30Z", "type": "commit"}, {"oid": "6ec383eca1dc43c8fd9f5435a7dcaafbe3c3f7ae", "url": "https://github.com/gridgain/gridgain/commit/6ec383eca1dc43c8fd9f5435a7dcaafbe3c3f7ae", "message": "Fix license", "committedDate": "2020-04-18T18:31:40Z", "type": "commit"}, {"oid": "3fde4e1bc00800f9a7a78d50adcd93b7508c77d0", "url": "https://github.com/gridgain/gridgain/commit/3fde4e1bc00800f9a7a78d50adcd93b7508c77d0", "message": "Merge remote-tracking branch 'ggce/8.7-master' into gg-27581", "committedDate": "2020-04-18T18:31:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTAwMDM4Mw==", "url": "https://github.com/gridgain/gridgain/pull/1076#discussion_r411000383", "bodyText": "This class doesn't transfer through the wire, why should we take care of it during RU?", "author": "ashapkin", "createdAt": "2020-04-19T21:56:05Z", "path": "modules/core/src/main/java/org/apache/ignite/internal/processors/platform/compute/PlatformBalancingSingleClosureAffinityTask.java", "diffHunk": "@@ -31,6 +31,8 @@\n \n /**\n  * Interop single-closure task with node balancing.\n+ *\n+ * NOTE: This class is not used, but preserved for compat during rolling upgrades.", "originalCommit": "3fde4e1bc00800f9a7a78d50adcd93b7508c77d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTE5OTkyNg==", "url": "https://github.com/gridgain/gridgain/pull/1076#discussion_r411199926", "bodyText": "Good catch, fixed", "author": "ptupitsyn", "createdAt": "2020-04-20T08:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTAwMDM4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "54b860bc9bf8e40b2b46f734e05d121e601ccb21", "chunk": "diff --git a/modules/core/src/main/java/org/apache/ignite/internal/processors/platform/compute/PlatformBalancingSingleClosureAffinityTask.java b/modules/core/src/main/java/org/apache/ignite/internal/processors/platform/compute/PlatformBalancingSingleClosureAffinityTask.java\ndeleted file mode 100644\nindex aaa1b89e961..00000000000\n--- a/modules/core/src/main/java/org/apache/ignite/internal/processors/platform/compute/PlatformBalancingSingleClosureAffinityTask.java\n+++ /dev/null\n\n@@ -1,90 +0,0 @@\n-/*\n- * Copyright 2019 GridGain Systems, Inc. and Contributors.\n- *\n- * Licensed under the GridGain Community Edition License (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     https://www.gridgain.com/products/software/community-edition/gridgain-community-edition-license\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package org.apache.ignite.internal.processors.platform.compute;\n-\n-import java.util.Collections;\n-import java.util.List;\n-import java.util.Map;\n-import org.apache.ignite.IgniteCheckedException;\n-import org.apache.ignite.cluster.ClusterNode;\n-import org.apache.ignite.compute.ComputeJob;\n-import org.apache.ignite.compute.ComputeTaskNoResultCache;\n-import org.apache.ignite.internal.GridKernalContext;\n-import org.apache.ignite.internal.processors.platform.PlatformContext;\n-import org.apache.ignite.internal.util.typedef.internal.U;\n-import org.jetbrains.annotations.NotNull;\n-import org.jetbrains.annotations.Nullable;\n-\n-/**\n- * Interop single-closure task with node balancing.\n- *\n- * NOTE: This class is not used, but preserved for compat during rolling upgrades.\n- */\n-@ComputeTaskNoResultCache\n-public class PlatformBalancingSingleClosureAffinityTask extends PlatformAbstractTask {\n-    /** */\n-    private static final long serialVersionUID = 0L;\n-\n-    /** Job. */\n-    private PlatformJob job;\n-\n-    /** Node, according to affinity. */\n-    private ClusterNode node;\n-\n-    /**\n-     * Constructor.\n-     *\n-     * @param ctx Platform context.\n-     * @param taskPtr Task pointer.\n-     */\n-    public PlatformBalancingSingleClosureAffinityTask(PlatformContext ctx, long taskPtr) {\n-        super(ctx, taskPtr);\n-    }\n-\n-    /** {@inheritDoc} */\n-    @NotNull @Override public Map<? extends ComputeJob, ClusterNode> map(List<ClusterNode> subgrid,\n-        @Nullable Object arg) {\n-        assert job != null : \"Job null-check must be performed in native platform.\";\n-\n-        return Collections.singletonMap(job, node);\n-    }\n-\n-    /**\n-     * @param job Job.\n-     */\n-    public void job(PlatformJob job) {\n-        this.job = job;\n-    }\n-\n-    /**\n-     * Init affinity.\n-     *\n-     * @param cacheName Cache name.\n-     * @param affKey Affinity key.\n-     * @param ctx Kernal context.\n-     */\n-    public void affinity(String cacheName, Object affKey, GridKernalContext ctx) {\n-        try {\n-            final Object affKey0 = ctx.affinity().affinityKey(cacheName, affKey);\n-\n-            node = ctx.affinity().mapKeyToNode(cacheName, affKey0);\n-        }\n-        catch (IgniteCheckedException e) {\n-            throw U.convertException(e);\n-        }\n-    }\n-}\n\\ No newline at end of file\n"}}, {"oid": "57af71bc07bdf74bee2b18850251390afb303596", "url": "https://github.com/gridgain/gridgain/commit/57af71bc07bdf74bee2b18850251390afb303596", "message": "Fix xmldoc wording", "committedDate": "2020-04-20T08:40:38Z", "type": "commit"}, {"oid": "54b860bc9bf8e40b2b46f734e05d121e601ccb21", "url": "https://github.com/gridgain/gridgain/commit/54b860bc9bf8e40b2b46f734e05d121e601ccb21", "message": "Remove unused task class", "committedDate": "2020-04-20T08:42:00Z", "type": "commit"}, {"oid": "42fcde352ac7608f4908db4c39cb5bd301320ba8", "url": "https://github.com/gridgain/gridgain/commit/42fcde352ac7608f4908db4c39cb5bd301320ba8", "message": "Update DEVNOTES", "committedDate": "2020-04-20T09:01:33Z", "type": "commit"}, {"oid": "1f6cb655cf961e2e01b9ae8b76efcce736b1073c", "url": "https://github.com/gridgain/gridgain/commit/1f6cb655cf961e2e01b9ae8b76efcce736b1073c", "message": "Fixing PeerAssemblyLoadingTest to work on Linux/Mono", "committedDate": "2020-04-20T09:07:34Z", "type": "commit"}, {"oid": "281c08f3df3a8d2e58492c1b87e9ec04484facf2", "url": "https://github.com/gridgain/gridgain/commit/281c08f3df3a8d2e58492c1b87e9ec04484facf2", "message": "Fixing PeerAssemblyLoadingTest to work on Linux/Mono", "committedDate": "2020-04-20T10:00:50Z", "type": "commit"}, {"oid": "68b21762b99b5c6dd657fd29a465c2c1453dbd35", "url": "https://github.com/gridgain/gridgain/commit/68b21762b99b5c6dd657fd29a465c2c1453dbd35", "message": "Fix peer deployment for Affinity APIs", "committedDate": "2020-04-20T10:36:31Z", "type": "commit"}, {"oid": "868314f52db8e2fb913d2f0db4afd62636b3e687", "url": "https://github.com/gridgain/gridgain/commit/868314f52db8e2fb913d2f0db4afd62636b3e687", "message": "cleanup", "committedDate": "2020-04-20T17:06:48Z", "type": "commit"}]}