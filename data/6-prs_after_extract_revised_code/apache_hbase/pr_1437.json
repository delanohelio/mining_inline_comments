{"pr_number": 1437, "pr_title": "HBASE-24055 Make AsyncFSWAL can run on EC cluster", "pr_createdAt": "2020-04-05T15:11:22Z", "pr_url": "https://github.com/apache/hbase/pull/1437", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404454565", "bodyText": "Should this be logged at warn instead?", "author": "ndimiduk", "createdAt": "2020-04-06T23:47:19Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/asyncfs/FanOutOneBlockAsyncDFSOutputHelper.java", "diffHunk": "@@ -272,6 +272,15 @@ private static FileCreator createFileCreator() throws NoSuchMethodException {\n     return createFileCreator2();\n   }\n \n+  private static CreateFlag loadShouldReplicateFlag() {\n+    try {\n+      return CreateFlag.valueOf(\"SHOULD_REPLICATE\");\n+    } catch (IllegalArgumentException e) {\n+      LOG.debug(\"can not find SHOULD_REPLICATE flag, should be hadoop 2.x\", e);", "originalCommit": "1a1a3202501db69730c93b1400fbafb76fbfe5e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ2Nzk4Nw==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404467987", "bodyText": "I used to make all the adaptor code to log as WARN but it was proven to be annoying for most users and we changed them all to debug...", "author": "Apache9", "createdAt": "2020-04-07T00:31:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ4MzQ5NA==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404483494", "bodyText": "This happens every time we open a file in hadoop2? Or just once on class loading? (Looks like the latter).", "author": "saintstack", "createdAt": "2020-04-07T01:27:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ4NDUzNA==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404484534", "bodyText": "This is how we test if the the SHOULD_REPLICATE flag is available? It is not available if hadoop2? If so, can we have a comment on the method to this effect? The log is a little confusing. Suggest: \"SHOULD_REPLICATE is not available; this is a problem if we are running on hadoop3 (Its expected if hadoop2)\".", "author": "saintstack", "createdAt": "2020-04-07T01:31:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ4OTI5NQ==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404489295", "bodyText": "Only once when loading.", "author": "Apache9", "createdAt": "2020-04-07T01:48:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDUyNjUxNw==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404526517", "bodyText": "All the other log messages are just like this, so do not want to only change this one. Let me add some comments on the field.", "author": "Apache9", "createdAt": "2020-04-07T04:22:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDU2NQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDQ1NDgyMg==", "url": "https://github.com/apache/hbase/pull/1437#discussion_r404454822", "bodyText": "nice cleanup.", "author": "ndimiduk", "createdAt": "2020-04-06T23:48:00Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/asyncfs/FanOutOneBlockAsyncDFSOutputHelper.java", "diffHunk": "@@ -502,8 +524,8 @@ private static FanOutOneBlockAsyncDFSOutput createOutput(DistributedFileSystem d\n       try {\n         stat = FILE_CREATOR.create(namenode, src,\n           FsPermission.getFileDefault().applyUMask(FsPermission.getUMask(conf)), clientName,\n-          new EnumSetWritable<>(overwrite ? EnumSet.of(CREATE, OVERWRITE) : EnumSet.of(CREATE)),\n-          createParent, replication, blockSize, CryptoProtocolVersion.supported());\n+          getCreateFlags(overwrite), createParent, replication, blockSize,", "originalCommit": "1a1a3202501db69730c93b1400fbafb76fbfe5e7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "1f7a4ef1f3ce26cddb6a04a1b34bbeb3c26f11ce", "url": "https://github.com/apache/hbase/commit/1f7a4ef1f3ce26cddb6a04a1b34bbeb3c26f11ce", "message": "HBASE-24055 Make AsyncFSWAL can run on EC cluster", "committedDate": "2020-04-07T01:50:03Z", "type": "commit"}, {"oid": "9eb6cce57547e361101642bf77b9c575bf21f531", "url": "https://github.com/apache/hbase/commit/9eb6cce57547e361101642bf77b9c575bf21f531", "message": "add comment", "committedDate": "2020-04-07T04:27:56Z", "type": "commit"}, {"oid": "9eb6cce57547e361101642bf77b9c575bf21f531", "url": "https://github.com/apache/hbase/commit/9eb6cce57547e361101642bf77b9c575bf21f531", "message": "add comment", "committedDate": "2020-04-07T04:27:56Z", "type": "forcePushed"}]}