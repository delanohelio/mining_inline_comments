{"pr_number": 1458, "pr_title": "HBASE-24140 : Move CandidateGenerator and their implementors out of StochasticLoadBalancer", "pr_createdAt": "2020-04-08T17:27:57Z", "pr_url": "https://github.com/apache/hbase/pull/1458", "timeline": [{"oid": "fd60fa8c95a06bd0a90cbf716d600838d9a20f6e", "url": "https://github.com/apache/hbase/commit/fd60fa8c95a06bd0a90cbf716d600838d9a20f6e", "message": "HBASE-24140 : Move CandidateGenerator and their implementors out of StochasticLoadBalancer", "committedDate": "2020-04-08T17:25:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcwOTk1Mg==", "url": "https://github.com/apache/hbase/pull/1458#discussion_r405709952", "bodyText": "Please expressly label this @InterfaceAudience.Private in case someone later makes the class public.", "author": "busbey", "createdAt": "2020-04-08T17:57:54Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/CandidateGenerator.java", "diffHunk": "@@ -0,0 +1,148 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.hbase.master.balancer;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.List;\n+import java.util.Map;\n+\n+import org.apache.hadoop.hbase.client.RegionInfo;\n+\n+/**\n+ * Generates a candidate action to be applied to the cluster for cost function search\n+ */", "originalCommit": "fd60fa8c95a06bd0a90cbf716d600838d9a20f6e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcxMTMwNA==", "url": "https://github.com/apache/hbase/pull/1458#discussion_r405711304", "bodyText": "Oops, completely missed this :(", "author": "virajjasani", "createdAt": "2020-04-08T18:00:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcwOTk1Mg=="}], "type": "inlineReview", "revised_code": {"commit": "5b0556fa2830753b04ba482a93c7f674ad0189e6", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/CandidateGenerator.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/CandidateGenerator.java\nindex cff14c6123..77bbcf9ef7 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/CandidateGenerator.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/CandidateGenerator.java\n\n@@ -25,9 +25,12 @@ import java.util.Map;\n \n import org.apache.hadoop.hbase.client.RegionInfo;\n \n+import org.apache.yetus.audience.InterfaceAudience;\n+\n /**\n  * Generates a candidate action to be applied to the cluster for cost function search\n  */\n+@InterfaceAudience.Private\n abstract class CandidateGenerator {\n \n   abstract BaseLoadBalancer.Cluster.Action generate(BaseLoadBalancer.Cluster cluster);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcxMDA5Ng==", "url": "https://github.com/apache/hbase/pull/1458#discussion_r405710096", "bodyText": "Please expressly label this @InterfaceAudience.Private in case someone later makes the class public.", "author": "busbey", "createdAt": "2020-04-08T17:58:10Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LoadCandidateGenerator.java", "diffHunk": "@@ -0,0 +1,57 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.hbase.master.balancer;\n+\n+class LoadCandidateGenerator extends CandidateGenerator {", "originalCommit": "fd60fa8c95a06bd0a90cbf716d600838d9a20f6e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5b0556fa2830753b04ba482a93c7f674ad0189e6", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LoadCandidateGenerator.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LoadCandidateGenerator.java\nindex 7f7dc4da98..d60065feeb 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LoadCandidateGenerator.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LoadCandidateGenerator.java\n\n@@ -18,6 +18,9 @@\n \n package org.apache.hadoop.hbase.master.balancer;\n \n+import org.apache.yetus.audience.InterfaceAudience;\n+\n+@InterfaceAudience.Private\n class LoadCandidateGenerator extends CandidateGenerator {\n \n   @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcxMDE1Mw==", "url": "https://github.com/apache/hbase/pull/1458#discussion_r405710153", "bodyText": "Please expressly label this @InterfaceAudience.Private in case someone later makes the class public.", "author": "busbey", "createdAt": "2020-04-08T17:58:17Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LocalityBasedCandidateGenerator.java", "diffHunk": "@@ -0,0 +1,89 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.hbase.master.balancer;\n+\n+import org.apache.hadoop.hbase.master.MasterServices;\n+import org.apache.hbase.thirdparty.com.google.common.base.Optional;\n+\n+class LocalityBasedCandidateGenerator extends CandidateGenerator {", "originalCommit": "fd60fa8c95a06bd0a90cbf716d600838d9a20f6e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5b0556fa2830753b04ba482a93c7f674ad0189e6", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LocalityBasedCandidateGenerator.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LocalityBasedCandidateGenerator.java\nindex fb9b466614..6afb86ff9e 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LocalityBasedCandidateGenerator.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/LocalityBasedCandidateGenerator.java\n\n@@ -19,8 +19,12 @@\n package org.apache.hadoop.hbase.master.balancer;\n \n import org.apache.hadoop.hbase.master.MasterServices;\n+\n import org.apache.hbase.thirdparty.com.google.common.base.Optional;\n \n+import org.apache.yetus.audience.InterfaceAudience;\n+\n+@InterfaceAudience.Private\n class LocalityBasedCandidateGenerator extends CandidateGenerator {\n \n   private MasterServices masterServices;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTcxMDI5MA==", "url": "https://github.com/apache/hbase/pull/1458#discussion_r405710290", "bodyText": "Please expressly label this @InterfaceAudience.Private in case someone later makes the class public.", "author": "busbey", "createdAt": "2020-04-08T17:58:30Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/RegionReplicaCandidateGenerator.java", "diffHunk": "@@ -0,0 +1,105 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.hadoop.hbase.master.balancer;\n+\n+/**\n+ * Generates candidates which moves the replicas out of the region server for\n+ * co-hosted region replicas\n+ */\n+class RegionReplicaCandidateGenerator extends CandidateGenerator {", "originalCommit": "fd60fa8c95a06bd0a90cbf716d600838d9a20f6e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5b0556fa2830753b04ba482a93c7f674ad0189e6", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/RegionReplicaCandidateGenerator.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/RegionReplicaCandidateGenerator.java\nindex 3250bc6147..0a878fdf60 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/RegionReplicaCandidateGenerator.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/RegionReplicaCandidateGenerator.java\n\n@@ -18,10 +18,13 @@\n \n package org.apache.hadoop.hbase.master.balancer;\n \n+import org.apache.yetus.audience.InterfaceAudience;\n+\n /**\n  * Generates candidates which moves the replicas out of the region server for\n  * co-hosted region replicas\n  */\n+@InterfaceAudience.Private\n class RegionReplicaCandidateGenerator extends CandidateGenerator {\n \n   StochasticLoadBalancer.RandomCandidateGenerator randomGenerator =\n"}}, {"oid": "5b0556fa2830753b04ba482a93c7f674ad0189e6", "url": "https://github.com/apache/hbase/commit/5b0556fa2830753b04ba482a93c7f674ad0189e6", "message": "adding InterfaceAudience.Private based on review comment", "committedDate": "2020-04-08T18:07:33Z", "type": "commit"}, {"oid": "90d19ea133cc6cef5f9f8c6baeeb9fb9c485d37d", "url": "https://github.com/apache/hbase/commit/90d19ea133cc6cef5f9f8c6baeeb9fb9c485d37d", "message": "Merge branch 'master' of github.com:apache/hbase into HBASE-24140-master", "committedDate": "2020-04-09T03:56:14Z", "type": "commit"}, {"oid": "50fd8be0b5b5b7dd0e37d74ee6ca598bfb71b14a", "url": "https://github.com/apache/hbase/commit/50fd8be0b5b5b7dd0e37d74ee6ca598bfb71b14a", "message": "Merge branch 'master' of github.com:apache/hbase into HBASE-24140-master", "committedDate": "2020-04-09T05:08:53Z", "type": "commit"}, {"oid": "bdf82fba044fbcf193760b9cfe40aab68934dd9f", "url": "https://github.com/apache/hbase/commit/bdf82fba044fbcf193760b9cfe40aab68934dd9f", "message": "Merge branch 'master' of github.com:apache/hbase into HBASE-24140-master", "committedDate": "2020-04-11T09:38:38Z", "type": "commit"}]}