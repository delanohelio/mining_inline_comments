{"pr_number": 2460, "pr_title": "HBASE-25098 ReplicationStatisticsChore runs in wrong time unit", "pr_createdAt": "2020-09-25T10:29:22Z", "pr_url": "https://github.com/apache/hbase/pull/2460", "timeline": [{"oid": "b87929a468e1b134d85bac6428605499b2aa61d0", "url": "https://github.com/apache/hbase/commit/b87929a468e1b134d85bac6428605499b2aa61d0", "message": "HBASE-25098 ReplicationStatisticsChore runs in wrong time unit", "committedDate": "2020-09-25T12:02:59Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE1MjI5MA==", "url": "https://github.com/apache/hbase/pull/2460#discussion_r495152290", "bodyText": "You can use TimeUnit.SECONDS.toMillis(statsPeriodInSecond)", "author": "virajjasani", "createdAt": "2020-09-25T18:09:51Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/replication/ReplicationSinkServiceImpl.java", "diffHunk": "@@ -75,7 +75,8 @@ public void initialize(Server server, FileSystem fs, Path logdir, Path oldLogDir\n   public void startReplicationService() throws IOException {\n     this.replicationSink = new ReplicationSink(this.conf);\n     this.server.getChoreService().scheduleChore(\n-      new ReplicationStatisticsChore(\"ReplicationSinkStatistics\", server, statsPeriod));\n+        new ReplicationStatisticsChore(\"ReplicationSinkStatistics\", server,\n+            1000 * statsPeriodInSecond));", "originalCommit": "b87929a468e1b134d85bac6428605499b2aa61d0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTQyNTc4Mg==", "url": "https://github.com/apache/hbase/pull/2460#discussion_r495425782", "bodyText": "OK, thanks for reviewing.", "author": "ddupg", "createdAt": "2020-09-26T07:10:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE1MjI5MA=="}], "type": "inlineReview", "revised_code": {"commit": "780277f35152094fbc5167aed63931869ea133aa", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/ReplicationSinkServiceImpl.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/ReplicationSinkServiceImpl.java\nindex d56a7a7ed4..91dd8d08e6 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/ReplicationSinkServiceImpl.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/ReplicationSinkServiceImpl.java\n\n@@ -76,7 +77,7 @@ public class ReplicationSinkServiceImpl implements ReplicationSinkService {\n     this.replicationSink = new ReplicationSink(this.conf);\n     this.server.getChoreService().scheduleChore(\n         new ReplicationStatisticsChore(\"ReplicationSinkStatistics\", server,\n-            1000 * statsPeriodInSecond));\n+            (int) TimeUnit.SECONDS.toMillis(statsPeriodInSecond)));\n   }\n \n   @Override\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTE1MjQwOQ==", "url": "https://github.com/apache/hbase/pull/2460#discussion_r495152409", "bodyText": "same here", "author": "virajjasani", "createdAt": "2020-09-25T18:10:05Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java", "diffHunk": "@@ -169,7 +169,8 @@ public void stopReplicationService() {\n   public void startReplicationService() throws IOException {\n     this.replicationManager.init();\n     this.server.getChoreService().scheduleChore(\n-      new ReplicationStatisticsChore(\"ReplicationSourceStatistics\", server, statsPeriod));\n+      new ReplicationStatisticsChore(\"ReplicationSourceStatistics\", server,\n+          1000 * statsPeriodInSecond));", "originalCommit": "b87929a468e1b134d85bac6428605499b2aa61d0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "780277f35152094fbc5167aed63931869ea133aa", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java\nindex e9e13e4d83..9be7b9a1e4 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java\n\n@@ -170,7 +172,7 @@ public class Replication implements ReplicationSourceService {\n     this.replicationManager.init();\n     this.server.getChoreService().scheduleChore(\n       new ReplicationStatisticsChore(\"ReplicationSourceStatistics\", server,\n-          1000 * statsPeriodInSecond));\n+          (int) TimeUnit.SECONDS.toMillis(statsPeriodInSecond)));\n     LOG.info(\"{} started\", this.server.toString());\n   }\n \n"}}, {"oid": "780277f35152094fbc5167aed63931869ea133aa", "url": "https://github.com/apache/hbase/commit/780277f35152094fbc5167aed63931869ea133aa", "message": "HBASE-25098 ReplicationStatisticsChore runs in wrong time unit", "committedDate": "2020-09-26T07:08:03Z", "type": "commit"}, {"oid": "780277f35152094fbc5167aed63931869ea133aa", "url": "https://github.com/apache/hbase/commit/780277f35152094fbc5167aed63931869ea133aa", "message": "HBASE-25098 ReplicationStatisticsChore runs in wrong time unit", "committedDate": "2020-09-26T07:08:03Z", "type": "forcePushed"}]}