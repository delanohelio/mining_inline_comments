{"pr_number": 2289, "pr_title": "HBASE-24918 Make RegionInfo#UNDEFINED IA.Private", "pr_createdAt": "2020-08-20T18:35:23Z", "pr_url": "https://github.com/apache/hbase/pull/2289", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI3NTA5NQ==", "url": "https://github.com/apache/hbase/pull/2289#discussion_r474275095", "bodyText": "I think this statement can be omitted since this is being handled separately in the parent task.", "author": "bharathv", "createdAt": "2020-08-20T21:11:33Z", "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java", "diffHunk": "@@ -69,7 +66,15 @@\n  */\n @InterfaceAudience.Public\n public interface RegionInfo extends Comparable<RegionInfo> {\n-  RegionInfo UNDEFINED = RegionInfoBuilder.newBuilder(TableName.valueOf(\"__UNDEFINED__\")).build();\n+  /**\n+   * @deprecated since 2.3.2/3.0.0; to be removed in 4.0.0 with no replacement (for internal use).\n+   */\n+  @Deprecated\n+  @InterfaceAudience.Private\n+  // Not using RegionInfoBuilder intentionally to avoid a static loading deadlock: HBASE-24627", "originalCommit": "00a629f323c40d066bcc9588174a8bb3e92e1101", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI4NTkyMQ==", "url": "https://github.com/apache/hbase/pull/2289#discussion_r474285921", "bodyText": "Makes sense.", "author": "saintstack", "createdAt": "2020-08-20T21:35:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI3NTA5NQ=="}], "type": "inlineReview", "revised_code": {"commit": "0c5412f6521ba402cb4e3460e665167949791809", "chunk": "diff --git a/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java b/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java\nindex 493b389b72..7a3a9af227 100644\n--- a/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java\n+++ b/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java\n\n@@ -71,9 +71,7 @@ public interface RegionInfo extends Comparable<RegionInfo> {\n    */\n   @Deprecated\n   @InterfaceAudience.Private\n-  // Not using RegionInfoBuilder intentionally to avoid a static loading deadlock: HBASE-24627\n-  RegionInfo UNDEFINED = new MutableRegionInfo(0, TableName.valueOf(\"__UNDEFINED__\"),\n-    RegionInfo.DEFAULT_REPLICA_ID);\n+  RegionInfo UNDEFINED = RegionInfoBuilder.newBuilder(TableName.valueOf(\"__UNDEFINED__\")).build();\n \n   /**\n    * Separator used to demarcate the encodedName in a region name\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI3NTIxNA==", "url": "https://github.com/apache/hbase/pull/2289#discussion_r474275214", "bodyText": "Switch back to RegionInfoBuilder? (same below?)", "author": "bharathv", "createdAt": "2020-08-20T21:11:47Z", "path": "hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java", "diffHunk": "@@ -69,7 +66,15 @@\n  */\n @InterfaceAudience.Public\n public interface RegionInfo extends Comparable<RegionInfo> {\n-  RegionInfo UNDEFINED = RegionInfoBuilder.newBuilder(TableName.valueOf(\"__UNDEFINED__\")).build();\n+  /**\n+   * @deprecated since 2.3.2/3.0.0; to be removed in 4.0.0 with no replacement (for internal use).\n+   */\n+  @Deprecated\n+  @InterfaceAudience.Private\n+  // Not using RegionInfoBuilder intentionally to avoid a static loading deadlock: HBASE-24627\n+  RegionInfo UNDEFINED = new MutableRegionInfo(0, TableName.valueOf(\"__UNDEFINED__\"),", "originalCommit": "00a629f323c40d066bcc9588174a8bb3e92e1101", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI4NjAzMg==", "url": "https://github.com/apache/hbase/pull/2289#discussion_r474286032", "bodyText": "Done", "author": "saintstack", "createdAt": "2020-08-20T21:35:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDI3NTIxNA=="}], "type": "inlineReview", "revised_code": {"commit": "0c5412f6521ba402cb4e3460e665167949791809", "chunk": "diff --git a/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java b/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java\nindex 493b389b72..7a3a9af227 100644\n--- a/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java\n+++ b/hbase-client/src/main/java/org/apache/hadoop/hbase/client/RegionInfo.java\n\n@@ -71,9 +71,7 @@ public interface RegionInfo extends Comparable<RegionInfo> {\n    */\n   @Deprecated\n   @InterfaceAudience.Private\n-  // Not using RegionInfoBuilder intentionally to avoid a static loading deadlock: HBASE-24627\n-  RegionInfo UNDEFINED = new MutableRegionInfo(0, TableName.valueOf(\"__UNDEFINED__\"),\n-    RegionInfo.DEFAULT_REPLICA_ID);\n+  RegionInfo UNDEFINED = RegionInfoBuilder.newBuilder(TableName.valueOf(\"__UNDEFINED__\")).build();\n \n   /**\n    * Separator used to demarcate the encodedName in a region name\n"}}, {"oid": "47add12032329a9065665b32b67f11a3409aba75", "url": "https://github.com/apache/hbase/commit/47add12032329a9065665b32b67f11a3409aba75", "message": "HBASE-24918 Make RegionInfo#UNDEFINED IA.Private\n\nMark RegionInfo#UNDEFINED IA.Private and deprecated;\nit is for internal use only and likely to be removed in hbase4.\n\nMove MutableRegionInfo out of RegionInfoBuilder and have it as a\nstanadlone task; a nice-to-have.", "committedDate": "2020-08-20T21:25:26Z", "type": "forcePushed"}, {"oid": "0c5412f6521ba402cb4e3460e665167949791809", "url": "https://github.com/apache/hbase/commit/0c5412f6521ba402cb4e3460e665167949791809", "message": "HBASE-24918 Make RegionInfo#UNDEFINED IA.Private\n\nMark RegionInfo#UNDEFINED IA.Private and deprecated;\nit is for internal use only and likely to be removed in hbase4.\n\nMove MutableRegionInfo out of RegionInfoBuilder and have it as a\nstanadlone task; a nice-to-have.", "committedDate": "2020-08-20T21:58:45Z", "type": "commit"}, {"oid": "0c5412f6521ba402cb4e3460e665167949791809", "url": "https://github.com/apache/hbase/commit/0c5412f6521ba402cb4e3460e665167949791809", "message": "HBASE-24918 Make RegionInfo#UNDEFINED IA.Private\n\nMark RegionInfo#UNDEFINED IA.Private and deprecated;\nit is for internal use only and likely to be removed in hbase4.\n\nMove MutableRegionInfo out of RegionInfoBuilder and have it as a\nstanadlone task; a nice-to-have.", "committedDate": "2020-08-20T21:58:45Z", "type": "forcePushed"}]}