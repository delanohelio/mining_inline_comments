{"pr_number": 2702, "pr_title": "HBASE-25323 Fix potential NPE when the zookeeper path of RegionServerTracker does not exist when start", "pr_createdAt": "2020-11-24T09:29:13Z", "pr_url": "https://github.com/apache/hbase/pull/2702", "timeline": [{"oid": "c147395ab553f0ac5295f492cdd244daa94775cf", "url": "https://github.com/apache/hbase/commit/c147395ab553f0ac5295f492cdd244daa94775cf", "message": "HBASE-25323 Fix potential NPE when the zookeeper path of RegionServerTracker does not exist when start", "committedDate": "2020-11-24T09:26:17Z", "type": "commit"}, {"oid": "84198871f4a85f5e9cec9d6fac4308df1363c670", "url": "https://github.com/apache/hbase/commit/84198871f4a85f5e9cec9d6fac4308df1363c670", "message": "Merge branch 'master' of https://github.com/apache/hbase into HBASE-25323", "committedDate": "2020-11-24T09:27:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTYwMzkxMg==", "url": "https://github.com/apache/hbase/pull/2702#discussion_r529603912", "bodyText": "Collections.emptySet(). Use EMPTY_SET will introduce a warning.", "author": "Apache9", "createdAt": "2020-11-24T14:51:39Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionServerTracker.java", "diffHunk": "@@ -163,8 +168,9 @@ private synchronized void refresh() {\n       server.abort(\"Unexpected zk exception getting RS nodes\", e);\n       return;\n     }\n-    Set<ServerName> servers =\n+    Set<ServerName> servers = CollectionUtils.isEmpty(names) ? Collections.EMPTY_SET :", "originalCommit": "84198871f4a85f5e9cec9d6fac4308df1363c670", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA2OTk5Ng==", "url": "https://github.com/apache/hbase/pull/2702#discussion_r530069996", "bodyText": "OK, I will use replace it with Collections.emptySet()", "author": "yuqi1129", "createdAt": "2020-11-25T02:36:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTYwMzkxMg=="}], "type": "inlineReview", "revised_code": {"commit": "f568064250d9cb319629c5cc70c4a2a601be6669", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionServerTracker.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionServerTracker.java\nindex 9a43bbbc4f..336f9dc04f 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionServerTracker.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionServerTracker.java\n\n@@ -168,7 +168,7 @@ public class RegionServerTracker extends ZKListener {\n       server.abort(\"Unexpected zk exception getting RS nodes\", e);\n       return;\n     }\n-    Set<ServerName> servers = CollectionUtils.isEmpty(names) ? Collections.EMPTY_SET :\n+    Set<ServerName> servers = CollectionUtils.isEmpty(names) ? Collections.emptySet() :\n       names.stream().map(ServerName::parseServerName).collect(Collectors.toSet());\n \n     for (Iterator<ServerName> iter = regionServers.iterator(); iter.hasNext();) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAxNjgyMw==", "url": "https://github.com/apache/hbase/pull/2702#discussion_r530016823", "bodyText": "Why change this?", "author": "infraio", "createdAt": "2020-11-24T23:46:22Z", "path": "hbase-zookeeper/src/main/java/org/apache/hadoop/hbase/zookeeper/MasterAddressTracker.java", "diffHunk": "@@ -297,7 +297,7 @@ public static boolean deleteIfEquals(ZKWatcher zkw, final String content) {\n   public static List<ServerName> getBackupMastersAndRenewWatch(\n       ZKWatcher zkw) throws InterruptedIOException {\n     // Build Set of backup masters from ZK nodes\n-    List<String> backupMasterStrings = Collections.emptyList();", "originalCommit": "84198871f4a85f5e9cec9d6fac4308df1363c670", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA3MDY2Ng==", "url": "https://github.com/apache/hbase/pull/2702#discussion_r530070666", "bodyText": "There is not need to assign value to backupMasterStrings see code below", "author": "yuqi1129", "createdAt": "2020-11-25T02:38:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAxNjgyMw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "f568064250d9cb319629c5cc70c4a2a601be6669", "url": "https://github.com/apache/hbase/commit/f568064250d9cb319629c5cc70c4a2a601be6669", "message": "Fix discussion 1", "committedDate": "2020-11-25T02:41:34Z", "type": "commit"}]}