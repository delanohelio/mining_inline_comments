{"pr_number": 2823, "pr_title": "HBASE-25435 Slow metric value can be configured", "pr_createdAt": "2020-12-28T11:35:08Z", "pr_url": "https://github.com/apache/hbase/pull/2823", "timeline": [{"oid": "dc5459315cb36b6c68d2f34c3ecda50c8bb93d57", "url": "https://github.com/apache/hbase/commit/dc5459315cb36b6c68d2f34c3ecda50c8bb93d57", "message": "HBASE-25435 Slow metric value can be configured", "committedDate": "2020-12-28T11:33:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ0OTA5Mg==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r549449092", "bodyText": "Where do we read slowMetricTime from the configuration? I don't see it in this PR", "author": "saintstack", "createdAt": "2020-12-28T18:42:22Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java", "diffHunk": "@@ -53,6 +54,8 @@\n   private Timer bulkLoadTimer;\n   private Meter serverReadQueryMeter;\n   private Meter serverWriteQueryMeter;\n+  protected long slowMetricTime = 1000L;\n+  protected static final int DEFAULT_SLOW_METRIC_TIME = 1000; // milliseconds", "originalCommit": "dc5459315cb36b6c68d2f34c3ecda50c8bb93d57", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTUzNjkzNw==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r549536937", "bodyText": "sorry, the pr has updated!  please review again!", "author": "leyangyueshan", "createdAt": "2020-12-29T01:31:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ0OTA5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDQwNzI5Nw==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r550407297", "bodyText": "@saintstack  hi, pr updated already!", "author": "leyangyueshan", "createdAt": "2020-12-31T06:22:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ0OTA5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "aeccb8541c61841dde442f5b2d7b51ca1e280628", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\nindex b3b2376ba7..3bd787d100 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\n\n@@ -54,7 +54,7 @@ public class MetricsRegionServer {\n   private Timer bulkLoadTimer;\n   private Meter serverReadQueryMeter;\n   private Meter serverWriteQueryMeter;\n-  protected long slowMetricTime = 1000L;\n+  protected long slowMetricTime;\n   protected static final int DEFAULT_SLOW_METRIC_TIME = 1000; // milliseconds\n \n   public MetricsRegionServer(MetricsRegionServerWrapper regionServerWrapper, Configuration conf,\n"}}, {"oid": "7f47f17196064b247d55c31837847e200d6a9b8b", "url": "https://github.com/apache/hbase/commit/7f47f17196064b247d55c31837847e200d6a9b8b", "message": "fix  HBASE-25435", "committedDate": "2020-12-29T01:28:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0NjQwMg==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r549546402", "bodyText": "Need a blank after \",\" .", "author": "bsglz", "createdAt": "2020-12-29T02:33:31Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java", "diffHunk": "@@ -68,6 +71,7 @@ public MetricsRegionServer(MetricsRegionServerWrapper regionServerWrapper, Confi\n     // create and use metrics from the new hbase-metrics based registry.\n     bulkLoadTimer = metricRegistry.timer(\"Bulkload\");\n \n+    slowMetricTime = conf.getLong(SLOW_METRIC_TIME,DEFAULT_SLOW_METRIC_TIME);", "originalCommit": "7f47f17196064b247d55c31837847e200d6a9b8b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU1MTg0Nw==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r549551847", "bodyText": "thanks a lot , fixed already!", "author": "leyangyueshan", "createdAt": "2020-12-29T03:07:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTU0NjQwMg=="}], "type": "inlineReview", "revised_code": {"commit": "50b11fd8fddc4149411a007e65b1eb80263bc4bf", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\nindex 45eb8e69d2..d83f12f931 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\n\n@@ -71,7 +71,7 @@ public class MetricsRegionServer {\n     // create and use metrics from the new hbase-metrics based registry.\n     bulkLoadTimer = metricRegistry.timer(\"Bulkload\");\n \n-    slowMetricTime = conf.getLong(SLOW_METRIC_TIME,DEFAULT_SLOW_METRIC_TIME);\n+    slowMetricTime = conf.getLong(SLOW_METRIC_TIME, DEFAULT_SLOW_METRIC_TIME);\n     quotaSource = CompatibilitySingletonFactory.getInstance(MetricsRegionServerQuotaSource.class);\n     serverReadQueryMeter = metricRegistry.meter(\"ServerReadQueryPerSecond\");\n     serverWriteQueryMeter = metricRegistry.meter(\"ServerWriteQueryPerSecond\");\n"}}, {"oid": "50b11fd8fddc4149411a007e65b1eb80263bc4bf", "url": "https://github.com/apache/hbase/commit/50b11fd8fddc4149411a007e65b1eb80263bc4bf", "message": "hbase-25435 add blank", "committedDate": "2020-12-29T03:05:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwMTMxMA==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r549601310", "bodyText": "Since we will init it later, so not need give it a special value here?", "author": "bsglz", "createdAt": "2020-12-29T07:39:38Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java", "diffHunk": "@@ -53,6 +54,8 @@\n   private Timer bulkLoadTimer;\n   private Meter serverReadQueryMeter;\n   private Meter serverWriteQueryMeter;\n+  protected long slowMetricTime = 1000L;", "originalCommit": "50b11fd8fddc4149411a007e65b1eb80263bc4bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTY1MzA3NQ==", "url": "https://github.com/apache/hbase/pull/2823#discussion_r549653075", "bodyText": "updated, please review again! thanks a lot", "author": "leyangyueshan", "createdAt": "2020-12-29T10:29:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTYwMTMxMA=="}], "type": "inlineReview", "revised_code": {"commit": "aeccb8541c61841dde442f5b2d7b51ca1e280628", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\nindex d83f12f931..3bd787d100 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MetricsRegionServer.java\n\n@@ -54,7 +54,7 @@ public class MetricsRegionServer {\n   private Timer bulkLoadTimer;\n   private Meter serverReadQueryMeter;\n   private Meter serverWriteQueryMeter;\n-  protected long slowMetricTime = 1000L;\n+  protected long slowMetricTime;\n   protected static final int DEFAULT_SLOW_METRIC_TIME = 1000; // milliseconds\n \n   public MetricsRegionServer(MetricsRegionServerWrapper regionServerWrapper, Configuration conf,\n"}}, {"oid": "aeccb8541c61841dde442f5b2d7b51ca1e280628", "url": "https://github.com/apache/hbase/commit/aeccb8541c61841dde442f5b2d7b51ca1e280628", "message": "fix hbase-25435-2", "committedDate": "2020-12-29T10:27:15Z", "type": "commit"}]}