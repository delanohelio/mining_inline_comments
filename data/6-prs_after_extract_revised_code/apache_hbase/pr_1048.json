{"pr_number": 1048, "pr_title": "HBASE-23694 After RegionProcedureStore completes migration of WALProcedureStore, \u2026", "pr_createdAt": "2020-01-15T17:00:20Z", "pr_url": "https://github.com/apache/hbase/pull/1048", "timeline": [{"oid": "a0cf59afdee7ab27a4c11f60f7f1f055dfc62979", "url": "https://github.com/apache/hbase/commit/a0cf59afdee7ab27a4c11f60f7f1f055dfc62979", "message": "After RegionProcedureStore completes migration of WALProcedureStore, still running WALProcedureStore.syncThread keeps trying to delete now inexistent log files.", "committedDate": "2020-01-15T16:55:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzEwMjY0OA==", "url": "https://github.com/apache/hbase/pull/1048#discussion_r367102648", "bodyText": "Why an abort and  not non-abort here? Should this be in finally block? I closed my dupe of this over in HBASE-23696", "author": "saintstack", "createdAt": "2020-01-15T20:56:32Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/procedure2/store/region/RegionProcedureStore.java", "diffHunk": "@@ -364,6 +364,7 @@ public void handleCorrupted(ProcedureIterator procIter) throws IOException {\n       throw new IOException(\"Failed to delete the WALProcedureStore migrated proc wal directory \" +\n         procWALDir);\n     }\n+    store.stop(true);", "originalCommit": "a0cf59afdee7ab27a4c11f60f7f1f055dfc62979", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzI2MDc1Nw==", "url": "https://github.com/apache/hbase/pull/1048#discussion_r367260757", "bodyText": "Do not need to be in finally block. If there are errors we just fail the start up of HMaster. If we pass abort = false then it will try to append a trailer which will cause teh stop to hang there.\nOf course, a better way maybe call store.stop(false) before we delete the proc wal directory, but not a big deal?", "author": "Apache9", "createdAt": "2020-01-16T07:10:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzEwMjY0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODA1MTM0Mw==", "url": "https://github.com/apache/hbase/pull/1048#discussion_r368051343", "bodyText": "Ok. Good enough for now. Thanks.", "author": "saintstack", "createdAt": "2020-01-17T17:28:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzEwMjY0OA=="}], "type": "inlineReview", "revised_code": null}]}