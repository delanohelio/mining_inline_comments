{"pr_number": 2537, "pr_title": "HBASE-24977 Meta table shouldn't be modified as read only", "pr_createdAt": "2020-10-13T08:37:30Z", "pr_url": "https://github.com/apache/hbase/pull/2537", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDM5MTIyNw==", "url": "https://github.com/apache/hbase/pull/2537#discussion_r504391227", "bodyText": "Super nit/NOT IMPORTANT/NEXT TIME: just pass in the message rather than save to local variable.", "author": "saintstack", "createdAt": "2020-10-14T04:16:38Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java", "diffHunk": "@@ -150,6 +151,12 @@ public static void sanityCheck(final Configuration c, final TableDescriptor td)\n       warnOrThrowExceptionForFailure(logWarn, message, null);\n     }\n \n+    // Meta table shouldn't be set as read only, otherwise it will impact region assignments\n+    if (td.isReadOnly() && TableName.isMetaTableName(td.getTableName())) {\n+      String message = \"Meta table can't be set as read only.\";\n+      warnOrThrowExceptionForFailure(false, message, null);", "originalCommit": "b89dd07b6c60503ab7d2151cce056694687772b0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0d695e9e0418bcea76c157d6718b1d2022a47f0e", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java\nindex 0bb0a549b3..c69d38a8ec 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/util/TableDescriptorChecker.java\n\n@@ -153,8 +153,7 @@ public final class TableDescriptorChecker {\n \n     // Meta table shouldn't be set as read only, otherwise it will impact region assignments\n     if (td.isReadOnly() && TableName.isMetaTableName(td.getTableName())) {\n-      String message = \"Meta table can't be set as read only.\";\n-      warnOrThrowExceptionForFailure(false, message, null);\n+      warnOrThrowExceptionForFailure(false, \"Meta table can't be set as read only.\", null);\n     }\n \n     for (ColumnFamilyDescriptor hcd : td.getColumnFamilies()) {\n"}}, {"oid": "6c22cba320eddc38337503b9ad136e02fb512be9", "url": "https://github.com/apache/hbase/commit/6c22cba320eddc38337503b9ad136e02fb512be9", "message": "HBASE-24977 Meta table shouldn't be modified as read only", "committedDate": "2020-10-14T04:32:01Z", "type": "commit"}, {"oid": "0d695e9e0418bcea76c157d6718b1d2022a47f0e", "url": "https://github.com/apache/hbase/commit/0d695e9e0418bcea76c157d6718b1d2022a47f0e", "message": "HBASE-24977 Meta table shouldn't be modified as read only", "committedDate": "2020-10-14T04:34:57Z", "type": "commit"}, {"oid": "0d695e9e0418bcea76c157d6718b1d2022a47f0e", "url": "https://github.com/apache/hbase/commit/0d695e9e0418bcea76c157d6718b1d2022a47f0e", "message": "HBASE-24977 Meta table shouldn't be modified as read only", "committedDate": "2020-10-14T04:34:57Z", "type": "forcePushed"}]}