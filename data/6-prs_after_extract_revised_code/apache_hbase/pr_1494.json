{"pr_number": 1494, "pr_title": "HBASE-24174 Fix findbugs warning in branch-1", "pr_createdAt": "2020-04-11T15:29:11Z", "pr_url": "https://github.com/apache/hbase/pull/1494", "timeline": [{"oid": "fec95bc15416947ee6183ba5e675c5e844c4d8a5", "url": "https://github.com/apache/hbase/commit/fec95bc15416947ee6183ba5e675c5e844c4d8a5", "message": "HBASE-24174 Fix findbugs warning in branch-1", "committedDate": "2020-04-13T05:31:12Z", "type": "forcePushed"}, {"oid": "9ebc1791149d292eec1358fc5b1bc60275526ce6", "url": "https://github.com/apache/hbase/commit/9ebc1791149d292eec1358fc5b1bc60275526ce6", "message": "HBASE-24174 Fix findbugs warning in branch-1", "committedDate": "2020-04-13T05:43:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0MzEwNQ==", "url": "https://github.com/apache/hbase/pull/1494#discussion_r407343105", "bodyText": "If we want to make this change, it should go to master, branch-2 first right?", "author": "virajjasani", "createdAt": "2020-04-13T06:43:33Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2260,16 +2259,13 @@ public RpcServer(final Server server, final String name,\n   }\n \n   @Override\n-  public void onConfigurationChange(Configuration newConf) {\n+  public synchronized void onConfigurationChange(Configuration newConf) {", "originalCommit": "9ebc1791149d292eec1358fc5b1bc60275526ce6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0NTEyNQ==", "url": "https://github.com/apache/hbase/pull/1494#discussion_r407345125", "bodyText": "I saw the warning in branch-1 only after HBASE-24174. I can forward-port to branch-2 and master. But as you said it is supressed, dilemma...", "author": "Reidddddd", "createdAt": "2020-04-13T06:50:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0MzEwNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0NTc1OA==", "url": "https://github.com/apache/hbase/pull/1494#discussion_r407345758", "bodyText": "Right, it is suppressed there. Either we can backport suppressed one or forward port this to branch-2+ and remove suppression there. Sure, let's see QA \ud83d\udc4d", "author": "virajjasani", "createdAt": "2020-04-13T06:52:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzM0MzEwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "309a4e4459200dc29ac7e2812f929e1d973b65e0", "chunk": "diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java\nindex e89b4b4e5f..f62a218b74 100644\n--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java\n+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java\n\n@@ -2259,16 +2259,14 @@ public class RpcServer implements RpcServerInterface, ConfigurationObserver {\n   }\n \n   @Override\n-  public synchronized void onConfigurationChange(Configuration newConf) {\n+  public void onConfigurationChange(Configuration newConf) {\n     initReconfigurable(newConf);\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver)scheduler).onConfigurationChange(newConf);\n     }\n-    System.setProperty(\"hadoop.policy.file\", \"hbase-policy.xml\");\n-    this.authManager.refresh(newConf, new HBasePolicyProvider());\n-    LOG.info(\"Refreshed hbase-policy.xml successfully\");\n-    ProxyUsers.refreshSuperUserGroupsConfiguration(newConf);\n-    LOG.info(\"Refreshed super and proxy users successfully\");\n+    if (authorize) {\n+      refreshAuthManager(newConf, new HBasePolicyProvider());\n+    }\n   }\n \n   private void initReconfigurable(Configuration confToLoad) {\n"}}, {"oid": "309a4e4459200dc29ac7e2812f929e1d973b65e0", "url": "https://github.com/apache/hbase/commit/309a4e4459200dc29ac7e2812f929e1d973b65e0", "message": "HBASE-24174 Fix findbugs warning in branch-1", "committedDate": "2020-04-15T17:23:20Z", "type": "forcePushed"}, {"oid": "6e6f3aaff67ff85e58129ba310fa3bad30818ec7", "url": "https://github.com/apache/hbase/commit/6e6f3aaff67ff85e58129ba310fa3bad30818ec7", "message": "HBASE-24174 Fix findbugs warning on ServiceAuthorizationManager", "committedDate": "2020-04-17T02:32:09Z", "type": "commit"}, {"oid": "6e6f3aaff67ff85e58129ba310fa3bad30818ec7", "url": "https://github.com/apache/hbase/commit/6e6f3aaff67ff85e58129ba310fa3bad30818ec7", "message": "HBASE-24174 Fix findbugs warning on ServiceAuthorizationManager", "committedDate": "2020-04-17T02:32:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk5OTg1NQ==", "url": "https://github.com/apache/hbase/pull/1494#discussion_r409999855", "bodyText": "btw, this if condition is an enhancement for this patch? is it necessary?", "author": "virajjasani", "createdAt": "2020-04-17T05:28:13Z", "path": "hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/RpcServer.java", "diffHunk": "@@ -2265,14 +2264,9 @@ public void onConfigurationChange(Configuration newConf) {\n     if (scheduler instanceof ConfigurationObserver) {\n       ((ConfigurationObserver)scheduler).onConfigurationChange(newConf);\n     }\n-    // Make sure authManager will read hbase-policy file\n-    System.setProperty(\"hadoop.policy.file\", \"hbase-policy.xml\");\n-    synchronized (authManager) {\n-      authManager.refresh(newConf, new HBasePolicyProvider());\n+    if (authorize) {", "originalCommit": "6e6f3aaff67ff85e58129ba310fa3bad30818ec7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAwMDY3MA==", "url": "https://github.com/apache/hbase/pull/1494#discussion_r410000670", "bodyText": "Yes, it is, to avoid unnecessary refresh. If authorization is disabled, then no need to refresh it which it is time consuming.\nWe should forward-port this patch to branch-2+ and master as well, quite some changes.", "author": "Reidddddd", "createdAt": "2020-04-17T05:31:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk5OTg1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDAwMDg5OA==", "url": "https://github.com/apache/hbase/pull/1494#discussion_r410000898", "bodyText": "\ud83d\udc4d", "author": "virajjasani", "createdAt": "2020-04-17T05:32:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTk5OTg1NQ=="}], "type": "inlineReview", "revised_code": null}]}