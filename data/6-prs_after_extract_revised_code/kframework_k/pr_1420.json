{"pr_number": 1420, "pr_title": "debugger flag to kprove", "pr_createdAt": "2020-07-13T14:27:57Z", "pr_url": "https://github.com/kframework/k/pull/1420", "timeline": [{"oid": "eae64fc88b7877b10f402be6e7d3c7d9a3c095b4", "url": "https://github.com/kframework/k/commit/eae64fc88b7877b10f402be6e7d3c7d9a3c095b4", "message": "debugger flag to kprove", "committedDate": "2020-07-13T14:27:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc0MjU2Ng==", "url": "https://github.com/kframework/k/pull/1420#discussion_r453742566", "bodyText": "Should we only enable this option if --debugger is passed? The only other use-case I can think of is if they pass --haskell-backend-command directly, and also want to use this option, but then tehy can just add --repl-script to their --haskell-backend-command.", "author": "ehildenb", "createdAt": "2020-07-13T15:39:14Z", "path": "haskell-backend/src/main/java/org/kframework/backend/haskell/HaskellRewriter.java", "diffHunk": "@@ -305,6 +312,10 @@ private String saveKoreSpecToTemp(ModuleToKORE converter, Module rules) {\n                     args.add(\"--smt-prelude\");\n                     args.add(smtOptions.smtPrelude);\n                 }\n+                if (kProveOptions.debugScript != null) {\n+                    args.add(\"--repl-script\");\n+                    args.add(files.resolveWorkingDirectory(kProveOptions.debugScript).getAbsolutePath());\n+                }", "originalCommit": "eae64fc88b7877b10f402be6e7d3c7d9a3c095b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc0Nzc0Ng==", "url": "https://github.com/kframework/k/pull/1420#discussion_r453747746", "bodyText": "I mean, if anything it should be an error to pass this flag but not --debugger. I can implement that behavior if you'd like.", "author": "dwightguth", "createdAt": "2020-07-13T15:45:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc0MjU2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc1OTkwOA==", "url": "https://github.com/kframework/k/pull/1420#discussion_r453759908", "bodyText": "Up to you, I don't think it's worth blocking the merge. But yes, that's what I meant, this flag should only be passed if --debugger is passed. If it's simple, we might as well do it I think.", "author": "ehildenb", "createdAt": "2020-07-13T16:03:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc0MjU2Ng=="}], "type": "inlineReview", "revised_code": {"commit": "808afc628304ff5300ec48ce917e46a410578d20", "chunk": "diff --git a/haskell-backend/src/main/java/org/kframework/backend/haskell/HaskellRewriter.java b/haskell-backend/src/main/java/org/kframework/backend/haskell/HaskellRewriter.java\nindex e5be90e0a..5cf67e499 100644\n--- a/haskell-backend/src/main/java/org/kframework/backend/haskell/HaskellRewriter.java\n+++ b/haskell-backend/src/main/java/org/kframework/backend/haskell/HaskellRewriter.java\n\n@@ -313,6 +313,9 @@ public class HaskellRewriter implements Function<Definition, Rewriter> {\n                     args.add(smtOptions.smtPrelude);\n                 }\n                 if (kProveOptions.debugScript != null) {\n+                    if (!kProveOptions.debugger) {\n+                        throw KEMException.criticalError(\"Can only use --debug-script with --debugger.\");\n+                    }\n                     args.add(\"--repl-script\");\n                     args.add(files.resolveWorkingDirectory(kProveOptions.debugScript).getAbsolutePath());\n                 }\n"}}, {"oid": "808afc628304ff5300ec48ce917e46a410578d20", "url": "https://github.com/kframework/k/commit/808afc628304ff5300ec48ce917e46a410578d20", "message": "add error msg", "committedDate": "2020-07-13T17:32:53Z", "type": "commit"}, {"oid": "2d7c00285a61167f37a0b6277e40632039b33156", "url": "https://github.com/kframework/k/commit/2d7c00285a61167f37a0b6277e40632039b33156", "message": "Merge branch 'master' into debug", "committedDate": "2020-07-13T18:50:47Z", "type": "commit"}, {"oid": "bc6ae5ad045ace27102d82072bc859582e783094", "url": "https://github.com/kframework/k/commit/bc6ae5ad045ace27102d82072bc859582e783094", "message": "Merge branch 'master' into debug", "committedDate": "2020-07-13T20:21:53Z", "type": "commit"}]}