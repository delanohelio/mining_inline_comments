{"pr_number": 1104, "pr_title": "Fix add empty list pass for parametric productions", "pr_createdAt": "2020-02-13T21:12:23Z", "pr_url": "https://github.com/kframework/k/pull/1104", "timeline": [{"oid": "117847dd4fe0b0f769bc2df8edfa9772f56e0dd8", "url": "https://github.com/kframework/k/commit/117847dd4fe0b0f769bc2df8edfa9772f56e0dd8", "message": "fix definitions", "committedDate": "2020-02-13T20:58:22Z", "type": "commit"}, {"oid": "3ef301aab99b07a152c019b34ae51bb5acd6b55e", "url": "https://github.com/kframework/k/commit/3ef301aab99b07a152c019b34ae51bb5acd6b55e", "message": "fix add empty list for parametric productions", "committedDate": "2020-02-13T20:58:32Z", "type": "commit"}, {"oid": "f1b6ce3bb539603c4e73fdf5b42eefa929b7a748", "url": "https://github.com/kframework/k/commit/f1b6ce3bb539603c4e73fdf5b42eefa929b7a748", "message": "add test", "committedDate": "2020-02-13T21:06:49Z", "type": "commit"}, {"oid": "ab91dc56c017a313a8718c50abe56aa4ca6764dc", "url": "https://github.com/kframework/k/commit/ab91dc56c017a313a8718c50abe56aa4ca6764dc", "message": "add start symbol", "committedDate": "2020-02-13T21:25:34Z", "type": "commit"}, {"oid": "72e1e12bb27d671cd39599829baaf2a64759beb1", "url": "https://github.com/kframework/k/commit/72e1e12bb27d671cd39599829baaf2a64759beb1", "message": "update tests", "committedDate": "2020-02-13T21:31:02Z", "type": "commit"}, {"oid": "477a64c6bb032d877014e8d044c81ed6c58fb97a", "url": "https://github.com/kframework/k/commit/477a64c6bb032d877014e8d044c81ed6c58fb97a", "message": "fix another case where an empty list should not be added", "committedDate": "2020-02-14T18:22:01Z", "type": "commit"}, {"oid": "59ed50991df2ef12138511109c41f792b27d31ef", "url": "https://github.com/kframework/k/commit/59ed50991df2ef12138511109c41f792b27d31ef", "message": "fix bug with error when rewrite is at top of term and child is\npolymorphic in return sort", "committedDate": "2020-02-14T18:22:19Z", "type": "commit"}, {"oid": "67cc1be4924f6d657aaecf189186626c40162864", "url": "https://github.com/kframework/k/commit/67cc1be4924f6d657aaecf189186626c40162864", "message": "tmp: Jenkinsfile", "committedDate": "2020-02-14T19:20:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDIzNTE0NA==", "url": "https://github.com/kframework/k/pull/1104#discussion_r380235144", "bodyText": "This needs a small description.", "author": "radumereuta", "createdAt": "2020-02-17T15:09:43Z", "path": "kernel/src/main/java/org/kframework/compile/AddSortInjections.java", "diffHunk": "@@ -249,6 +221,40 @@ private K visitChildren(K term, Sort actualSort, Sort expectedSort) {\n         }\n     }\n \n+    public Production substituteProd(Production prod, Sort expectedSort, BiFunction<Integer, Production, Sort> getSort, HasLocation loc) {", "originalCommit": "67cc1be4924f6d657aaecf189186626c40162864", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "004375bad3794e1fc2db0b745463c5cf69c9b8ae", "chunk": "diff --git a/kernel/src/main/java/org/kframework/compile/AddSortInjections.java b/kernel/src/main/java/org/kframework/compile/AddSortInjections.java\nindex c39bc2898..60bf01a61 100644\n--- a/kernel/src/main/java/org/kframework/compile/AddSortInjections.java\n+++ b/kernel/src/main/java/org/kframework/compile/AddSortInjections.java\n\n@@ -221,6 +221,14 @@ public class AddSortInjections {\n         }\n     }\n \n+    /**\n+     * Generate the substituted production with its sort parameters added for a parametric production.\n+     * @param prod The production to add sort parameters to.\n+     * @param expectedSort the sort context where the term with the specified production appears.\n+     * @param getSort a function taking the 0-based index of the child of this production and the substitutedFresh production and returning the sort of the child.\n+     * @param loc The location to report upon an error.\n+     * @return The production substituted with the least upper bounds of its sort parameters based on its children's sorts.\n+     */\n     public Production substituteProd(Production prod, Sort expectedSort, BiFunction<Integer, Production, Sort> getSort, HasLocation loc) {\n         Production substituted = prod;\n         List<Sort> args = new ArrayList<>();\n"}}, {"oid": "004375bad3794e1fc2db0b745463c5cf69c9b8ae", "url": "https://github.com/kframework/k/commit/004375bad3794e1fc2db0b745463c5cf69c9b8ae", "message": "add comment", "committedDate": "2020-02-17T16:18:22Z", "type": "commit"}, {"oid": "ae199cbe1b32ebc95858f76fb3a89445f25b0c9f", "url": "https://github.com/kframework/k/commit/ae199cbe1b32ebc95858f76fb3a89445f25b0c9f", "message": "Revert \"tmp: Jenkinsfile\"\n\nThis reverts commit 67cc1be4924f6d657aaecf189186626c40162864.", "committedDate": "2020-02-19T19:33:52Z", "type": "commit"}, {"oid": "79ee7911d6126bf3810263f2ac46b94caf085b42", "url": "https://github.com/kframework/k/commit/79ee7911d6126bf3810263f2ac46b94caf085b42", "message": "Merge branch 'master' into emptylists", "committedDate": "2020-02-19T19:34:09Z", "type": "commit"}, {"oid": "d9d4d8b46ca6341536a0a94608cf0f8d5fcae4fc", "url": "https://github.com/kframework/k/commit/d9d4d8b46ca6341536a0a94608cf0f8d5fcae4fc", "message": "Merge branch 'master' into emptylists", "committedDate": "2020-02-19T21:22:01Z", "type": "commit"}]}