{"pr_number": 1440, "pr_title": "Migrate ffi.k to ffi.md", "pr_createdAt": "2020-07-17T18:47:46Z", "pr_url": "https://github.com/kframework/k/pull/1440", "timeline": [{"oid": "0b5dc0961c376f904a69c85d0288da07930edb64", "url": "https://github.com/kframework/k/commit/0b5dc0961c376f904a69c85d0288da07930edb64", "message": "remove unused files", "committedDate": "2020-07-17T17:57:25Z", "type": "commit"}, {"oid": "73d1d99080b4c0511fff9bb45b9f80c01a50ba32", "url": "https://github.com/kframework/k/commit/73d1d99080b4c0511fff9bb45b9f80c01a50ba32", "message": "rename ffi.k to ffi.md and add documentation", "committedDate": "2020-07-17T18:33:02Z", "type": "commit"}, {"oid": "abb52279635f617bce835a8b1e200b56ffa5c99a", "url": "https://github.com/kframework/k/commit/abb52279635f617bce835a8b1e200b56ffa5c99a", "message": "update requires statements referencing ffi.k", "committedDate": "2020-07-17T18:33:14Z", "type": "commit"}, {"oid": "2225d72f63f662b2ca93a2f3298c81feb414fcd8", "url": "https://github.com/kframework/k/commit/2225d72f63f662b2ca93a2f3298c81feb414fcd8", "message": "move builtin directories before other directories in include path", "committedDate": "2020-07-17T18:42:29Z", "type": "commit"}, {"oid": "e63d596312035d021fc56814afeb7359c3dea9c6", "url": "https://github.com/kframework/k/commit/e63d596312035d021fc56814afeb7359c3dea9c6", "message": "add warning for deprecated filename", "committedDate": "2020-07-17T18:46:00Z", "type": "commit"}, {"oid": "2cd6dc6d9da9ca8cddda547d6d7590e8bc31d7c0", "url": "https://github.com/kframework/k/commit/2cd6dc6d9da9ca8cddda547d6d7590e8bc31d7c0", "message": "add test", "committedDate": "2020-07-17T18:46:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjY1MTA2MA==", "url": "https://github.com/kframework/k/pull/1440#discussion_r456651060", "bodyText": "This looks like a typo in the name of this variable allLookupDirectoris => allLookupDirectories\nWhat is this change? The 0 => 1.", "author": "ehildenb", "createdAt": "2020-07-17T20:07:53Z", "path": "kernel/src/main/java/org/kframework/parser/ParserUtils.java", "diffHunk": "@@ -155,8 +155,15 @@ else if (di instanceof Require) {\n \n                 String definitionFileName = ((Require) di).getValue();\n \n+                if (definitionFileName.equals(\"ffi.k\")) {\n+                    kem.registerCompilerWarning(ExceptionType.FUTURE_ERROR,\n+                        \"Requiring a K file in the K builtin directory via \" +\n+                        \"a deprecated filename. Please replace \\\"\" + definitionFileName +\n+                        \"\\\" with \\\"\" + definitionFileName.substring(0, definitionFileName.length() - 2) + \".md\\\".\", di);\n+                }\n+\n                 ArrayList<File> allLookupDirectoris = new ArrayList<>(lookupDirectories);\n-                allLookupDirectoris.add(0, currentDirectory);\n+                allLookupDirectoris.add(1, currentDirectory);", "originalCommit": "2cd6dc6d9da9ca8cddda547d6d7590e8bc31d7c0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fb1d937a429d4bdffe8bc45bf26446caa8edb618", "chunk": "diff --git a/kernel/src/main/java/org/kframework/parser/ParserUtils.java b/kernel/src/main/java/org/kframework/parser/ParserUtils.java\nindex 00812823d..ebd1ad66c 100644\n--- a/kernel/src/main/java/org/kframework/parser/ParserUtils.java\n+++ b/kernel/src/main/java/org/kframework/parser/ParserUtils.java\n\n@@ -162,10 +162,10 @@ public class ParserUtils {\n                         \"\\\" with \\\"\" + definitionFileName.substring(0, definitionFileName.length() - 2) + \".md\\\".\", di);\n                 }\n \n-                ArrayList<File> allLookupDirectoris = new ArrayList<>(lookupDirectories);\n-                allLookupDirectoris.add(1, currentDirectory);\n+                ArrayList<File> allLookupDirectories = new ArrayList<>(lookupDirectories);\n+                allLookupDirectories.add(1, currentDirectory); //after builtin directory but before anything else\n \n-                Optional<File> definitionFile = allLookupDirectoris.stream()\n+                Optional<File> definitionFile = allLookupDirectories.stream()\n                         .map(lookupDirectory -> {\n                             if (new File(definitionFileName).isAbsolute()) {\n                                 return new File(definitionFileName);\n"}}, {"oid": "fb1d937a429d4bdffe8bc45bf26446caa8edb618", "url": "https://github.com/kframework/k/commit/fb1d937a429d4bdffe8bc45bf26446caa8edb618", "message": "fix typo and add comment", "committedDate": "2020-07-17T20:22:54Z", "type": "commit"}, {"oid": "b7d440518042843325274ada03b0e80fd0daf45b", "url": "https://github.com/kframework/k/commit/b7d440518042843325274ada03b0e80fd0daf45b", "message": "fix blocks", "committedDate": "2020-07-17T20:39:04Z", "type": "commit"}, {"oid": "97f152d50fb0995c2a609addb28b9c50cd7cab33", "url": "https://github.com/kframework/k/commit/97f152d50fb0995c2a609addb28b9c50cd7cab33", "message": "Merge branch 'master' into prelude2", "committedDate": "2020-07-17T21:50:55Z", "type": "commit"}]}