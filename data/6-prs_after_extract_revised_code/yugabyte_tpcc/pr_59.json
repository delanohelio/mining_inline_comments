{"pr_number": 59, "pr_title": "Display latencies for getting a connection from Hikari pool.", "pr_createdAt": "2020-10-15T07:30:00Z", "pr_url": "https://github.com/yugabyte/tpcc/pull/59", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3NjY3Mg==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505276672", "bodyText": "what if we get a retry status?", "author": "robertsami", "createdAt": "2020-10-15T07:39:00Z", "path": "src/com/oltpbenchmark/api/Worker.java", "diffHunk": "@@ -420,7 +439,10 @@ protected final TransactionType doWork(boolean measure, SubmittedProcedure piece\n                     // }\n \n                     status = TransactionStatus.UNKNOWN;\n+\n+                    startOperation.setValue(System.nanoTime());\n                     status = this.executeWork(conn, next);", "originalCommit": "ba57c2ce7b1376699d47463742f200764d7a03aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNTU0Mw==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505705543", "bodyText": "It was a conscious decision to just include the time of the actual operation and not the failure cases.\nLet me know what you think.", "author": "psudheer21", "createdAt": "2020-10-15T17:09:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3NjY3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyNjQzMw==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505726433", "bodyText": "i do think its useful to isolate measurement to successful operations in terms of our own understanding, as you did here, but we should also be measuring the latency a user would experience for said operation, from op start, through each retry, to final completion, when grading ourselves", "author": "robertsami", "createdAt": "2020-10-15T17:45:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3NjY3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyMzEyMQ==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505923121", "bodyText": "But 1% of the transactions have failures by design.\nShould we include those?", "author": "psudheer21", "createdAt": "2020-10-15T23:37:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3NjY3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzNzEzMw==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505937133", "bodyText": "id say lets match the previous behavior for those?", "author": "robertsami", "createdAt": "2020-10-16T00:29:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3NjY3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk3NjM2Mg==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505976362", "bodyText": "Done.\nI have changed the behaviour a bit and showed the actual latency by default and the whole operation latency along with the connection acquisition latency protected by the flag.", "author": "psudheer21", "createdAt": "2020-10-16T01:52:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3NjY3Mg=="}], "type": "inlineReview", "revised_code": {"commit": "13034d65f4fe209d5419316f080b124d045dd973", "chunk": "diff --git a/src/com/oltpbenchmark/api/Worker.java b/src/com/oltpbenchmark/api/Worker.java\nindex 54dd6d7..626c58d 100644\n--- a/src/com/oltpbenchmark/api/Worker.java\n+++ b/src/com/oltpbenchmark/api/Worker.java\n\n@@ -440,9 +505,9 @@ public abstract class Worker<T extends BenchmarkModule> implements Runnable {\n \n                     status = TransactionStatus.UNKNOWN;\n \n-                    startOperation.setValue(System.nanoTime());\n+                    startOperation = System.nanoTime();\n                     status = this.executeWork(conn, next);\n-                    endOperation.setValue(System.nanoTime());\n+                    endOperation = System.nanoTime();\n \n                 // User Abort Handling\n                 // These are not errors\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3ODAxMQ==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505278011", "bodyText": "could we just pass in startConnection and endConnection, keep the old startOperation/endOperation computation outside here, and compute the difference if desired?", "author": "robertsami", "createdAt": "2020-10-15T07:40:02Z", "path": "src/com/oltpbenchmark/api/Worker.java", "diffHunk": "@@ -310,10 +318,14 @@ public final void run() {\n                 }\n             }\n \n-            long startOperation = System.nanoTime();\n+            MutableLong startOperation = new MutableLong();\n+            MutableLong endOperation = new MutableLong();\n+            MutableLong startConnection = new MutableLong();\n+            MutableLong endConnection = new MutableLong();", "originalCommit": "ba57c2ce7b1376699d47463742f200764d7a03aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcwNDcxOQ==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505704719", "bodyText": "I would prefer this, cuz the intention is clearer here. where we try to get the time of the actual operation execution.\nLet me know what you think", "author": "psudheer21", "createdAt": "2020-10-15T17:08:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3ODAxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyNzI0NQ==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505727245", "bodyText": "yeah i dont disagree. i might consider returning something richer than TransactionType that includes latency info as well, to further clarify/document the intention", "author": "robertsami", "createdAt": "2020-10-15T17:46:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3ODAxMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyMzc0OA==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505923748", "bodyText": "Thats a good idea. Let me incorporate that.", "author": "psudheer21", "createdAt": "2020-10-15T23:40:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTI3ODAxMQ=="}], "type": "inlineReview", "revised_code": {"commit": "13034d65f4fe209d5419316f080b124d045dd973", "chunk": "diff --git a/src/com/oltpbenchmark/api/Worker.java b/src/com/oltpbenchmark/api/Worker.java\nindex 54dd6d7..626c58d 100644\n--- a/src/com/oltpbenchmark/api/Worker.java\n+++ b/src/com/oltpbenchmark/api/Worker.java\n\n@@ -318,14 +370,9 @@ public abstract class Worker<T extends BenchmarkModule> implements Runnable {\n                 }\n             }\n \n-            MutableLong startOperation = new MutableLong();\n-            MutableLong endOperation = new MutableLong();\n-            MutableLong startConnection = new MutableLong();\n-            MutableLong endConnection = new MutableLong();\n-            TransactionType type = invalidTT;\n+            TransactionExecutionState executionState = new TransactionExecutionState();\n             try {\n-                type = doWork(preState == State.MEASURE, pieceOfWork, startOperation, endOperation,\n-                              startConnection, endConnection);\n+                executionState = doWork(preState == State.MEASURE, pieceOfWork);\n             } catch (IndexOutOfBoundsException e) {\n                 if (phase.isThroughputRun()) {\n                     LOG.error(\"Thread tried executing disabled phase!\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyOTM1Ng==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505729356", "bodyText": "this feels hacky. is there some alternative approach where we can track overall_latencies as the original latency semantic (including connection acquisition and all retries), acq_connection_latenciesas the time taken to acquire a connection, and final_op_try_latency as the latency of the final/successful op only (as in excluding retries), and each list can be of size final int kNumTxnTypes = 5;?", "author": "robertsami", "createdAt": "2020-10-15T17:50:04Z", "path": "src/com/oltpbenchmark/DBWorkload.java", "diffHunk": "@@ -1018,32 +1018,52 @@ private static Results runWorkload(List<BenchmarkModule> benchList, boolean verb\n     LOG.info(\"Efficiency : \" + df.format(efficiency) + \"%\");\n \n     List<List<Integer>> list_latencies = new ArrayList<>();\n-    for (int i = 0; i < 5; ++i) {\n+    for (int i = 0; i < 6; ++i) {\n       list_latencies.add(new ArrayList<Integer>());\n     }\n+\n+    boolean printConnectionLatency =\n+      xmlConfig.containsKey(\"displayHikariPoolConnectionLatency\") &&\n+      xmlConfig.getBoolean(\"displayHikariPoolConnectionLatency\");\n     for (Worker<?> w : workers) {\n       for (LatencyRecord.Sample sample : w.getLatencyRecords()) {\n         list_latencies.get(sample.tranType - 1).add(sample.operationLatencyUs);\n       }\n+\n+      // Since we have 5 transaction types, use the index 5 to store the latency for the Hikari pool\n+      // connections.\n+      if (printConnectionLatency) {\n+        for (LatencyRecord.Sample sample : w.getConnectionLatencyRecords()) {\n+          list_latencies.get(5).add(sample.operationLatencyUs);", "originalCommit": "ba57c2ce7b1376699d47463742f200764d7a03aa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTczMDg0NA==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505730844", "bodyText": "so, going further, each worker can have getLatencyRecords , getConnectionLatencies, and getFinalOpLatencies", "author": "robertsami", "createdAt": "2020-10-15T17:52:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyOTM1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyMzUzNQ==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505923535", "bodyText": "Changed the code to be easier to read by making the intentions clearer.", "author": "psudheer21", "createdAt": "2020-10-15T23:39:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTcyOTM1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "404895268b0bad9e4ef675b451b6456b98bab981", "chunk": "diff --git a/src/com/oltpbenchmark/DBWorkload.java b/src/com/oltpbenchmark/DBWorkload.java\nindex 2fd58cb..07ae74f 100644\n--- a/src/com/oltpbenchmark/DBWorkload.java\n+++ b/src/com/oltpbenchmark/DBWorkload.java\n\n@@ -1017,54 +1017,56 @@ public class DBWorkload {\n     LOG.info(\"TPM-C: \" + df.format(tpmc));\n     LOG.info(\"Efficiency : \" + df.format(efficiency) + \"%\");\n \n+    boolean displayAcqConnectionLatency =\n+      xmlConfig.containsKey(\"displayHikariPoolConnectionLatency\") &&\n+      xmlConfig.getBoolean(\"displayHikariPoolConnectionLatency\");\n+    PrintLatencies(workers, displayAcqConnectionLatency);\n+\n+    return r;\n+  }\n+\n+  private static void PrintLatencies(List<Worker<?>> workers, boolean displayAcqConnectionLatency) {\n     List<List<Integer>> list_latencies = new ArrayList<>();\n-    for (int i = 0; i < 6; ++i) {\n+    for (int i = 0; i < 5; ++i) {\n       list_latencies.add(new ArrayList<Integer>());\n     }\n \n-    boolean printConnectionLatency =\n-      xmlConfig.containsKey(\"displayHikariPoolConnectionLatency\") &&\n-      xmlConfig.getBoolean(\"displayHikariPoolConnectionLatency\");\n     for (Worker<?> w : workers) {\n       for (LatencyRecord.Sample sample : w.getLatencyRecords()) {\n         list_latencies.get(sample.tranType - 1).add(sample.operationLatencyUs);\n       }\n+    }\n+    for (int i = 0; i < 5; ++i) {\n+      printOperationLatency(transactionTypes.get(i+1).toString(), list_latencies.get(i));\n+    }\n \n-      // Since we have 5 transaction types, use the index 5 to store the latency for the Hikari pool\n-      // connections.\n-      if (printConnectionLatency) {\n-        for (LatencyRecord.Sample sample : w.getConnectionLatencyRecords()) {\n-          list_latencies.get(5).add(sample.operationLatencyUs);\n-        }\n+    if (!displayAcqConnectionLatency) {\n+      return;\n+    }\n+    List<Integer> acqConnectionLatency = new ArrayList<Integer>();\n+    for (Worker<?> w : workers) {\n+      for (LatencyRecord.Sample sample : w.getAcqConnectionLatencyRecords()) {\n+        acqConnectionLatency.add(sample.operationLatencyUs);\n       }\n     }\n-    printLatencies(list_latencies, transactionTypes, printConnectionLatency);\n-    return r;\n+    printOperationLatency(\"Acquire Connection\", acqConnectionLatency);\n   }\n \n-  private static void printLatencies(List<List<Integer>> list_latencies, Map<Integer,\n-                                     String> transactionTypes, boolean printConnectionLatency) {\n-    for (int i = 0; i < 6; ++i) {\n-      Collections.sort(list_latencies.get(i));\n-      long sum = 0;\n-      for (int val : list_latencies.get(i)) {\n-        sum += val;\n-      }\n-      double avgLatency = 0;\n-      double p99Latency = 0;\n-      if (list_latencies.get(i).size() > 0) {\n-        avgLatency = sum / list_latencies.get(i).size() / 1000;\n-        int p99Index = (int)(list_latencies.get(i).size() * 0.99);\n-        p99Latency = list_latencies.get(i).get(p99Index) * 1.0 / 1000;\n-      }\n-\n-      if (i < 5)\n-        LOG.info(transactionTypes.get(i+1) +\n-            \", Avg Latency: \" + avgLatency + \" msecs, p99 Latency: \" + p99Latency + \" msecs\");\n-      else if (printConnectionLatency)\n-        LOG.info(\"Connection wait time \" +\n-            \", Avg Latency: \" + avgLatency + \" msecs, p99 Latency: \" + p99Latency + \" msecs\");\n+  private static void printOperationLatency(String operation, List<Integer> latencies) {\n+    if (latencies.size() == 0) {\n+      return;\n+    }\n+    Collections.sort(latencies);\n+    long sum = 0;\n+    for (int val : latencies) {\n+      sum += val;\n     }\n+    double avgLatency = sum * 1.0 / latencies.size() / 1000;\n+    int p99Index = (int)(latencies.size() * 0.99);\n+    double p99Latency = latencies.get(p99Index) * 1.0 / 1000;\n+\n+    LOG.info(operation + \", Avg Latency: \" + avgLatency +\n+             \" msecs, p99 Latency: \" + p99Latency + \" msecs\");\n   }\n \n   public static void mergeResults(String dirPath, String[] fileNames) {\n"}}, {"oid": "404895268b0bad9e4ef675b451b6456b98bab981", "url": "https://github.com/yugabyte/tpcc/commit/404895268b0bad9e4ef675b451b6456b98bab981", "message": "Display latencies for getting a connection from Hikari pool.\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-15T23:07:35Z", "type": "forcePushed"}, {"oid": "957d56f8931d808616e75f074ac2a154e21eeef9", "url": "https://github.com/yugabyte/tpcc/commit/957d56f8931d808616e75f074ac2a154e21eeef9", "message": "Display latencies for getting a connection from Hikari pool.\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-15T23:28:16Z", "type": "forcePushed"}, {"oid": "04a03625208356e184cb75f8150d3505e115e8dd", "url": "https://github.com/yugabyte/tpcc/commit/04a03625208356e184cb75f8150d3505e115e8dd", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n23:32:46,660 (DBWorkload.java:1016) INFO  - Num New Order transactions : 34, time seconds: 180\n23:32:46,661 (DBWorkload.java:1017) INFO  - TPM-C: 11.33\n23:32:46,661 (DBWorkload.java:1018) INFO  - Efficiency : 88.13%\n23:32:46,661 (DBWorkload.java:1068) INFO  - NewOrder, Avg Latency: 31.96870588235294 msecs, p99 Latency: 154.854 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - Payment, Avg Latency: 20.616526315789475 msecs, p99 Latency: 95.526 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - OrderStatus, Avg Latency: 44.650166666666664 msecs, p99 Latency: 183.981 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - Delivery, Avg Latency: 112.808 msecs, p99 Latency: 140.305 msecs\n23:32:46,663 (DBWorkload.java:1068) INFO  - StockLevel, Avg Latency: 146.24966666666666 msecs, p99 Latency: 213.393 msecs\n23:32:46,663 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 6.450216867469879 msecs, p99 Latency: 186.069 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-15T23:34:23Z", "type": "forcePushed"}, {"oid": "13034d65f4fe209d5419316f080b124d045dd973", "url": "https://github.com/yugabyte/tpcc/commit/13034d65f4fe209d5419316f080b124d045dd973", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n23:32:46,660 (DBWorkload.java:1016) INFO  - Num New Order transactions : 34, time seconds: 180\n23:32:46,661 (DBWorkload.java:1017) INFO  - TPM-C: 11.33\n23:32:46,661 (DBWorkload.java:1018) INFO  - Efficiency : 88.13%\n23:32:46,661 (DBWorkload.java:1068) INFO  - NewOrder, Avg Latency: 31.96870588235294 msecs, p99 Latency: 154.854 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - Payment, Avg Latency: 20.616526315789475 msecs, p99 Latency: 95.526 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - OrderStatus, Avg Latency: 44.650166666666664 msecs, p99 Latency: 183.981 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - Delivery, Avg Latency: 112.808 msecs, p99 Latency: 140.305 msecs\n23:32:46,663 (DBWorkload.java:1068) INFO  - StockLevel, Avg Latency: 146.24966666666666 msecs, p99 Latency: 213.393 msecs\n23:32:46,663 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 6.450216867469879 msecs, p99 Latency: 186.069 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-16T00:24:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzODkwNw==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505938907", "bodyText": "i < list_latencies.size()?", "author": "robertsami", "createdAt": "2020-10-16T00:35:10Z", "path": "src/com/oltpbenchmark/DBWorkload.java", "diffHunk": "@@ -1113,7 +1135,9 @@ public static void mergeResults(String dirPath, String[] fileNames) {\n     LOG.info(\"Num New Order transactions : \" + numNewOrderTransactions + \", time seconds: \" + time);\n     LOG.info(\"TPM-C: \" + df.format(tpmc));\n     LOG.info(\"Efficiency : \" + df.format(efficiency) + \"%\");\n-    printLatencies(list_latencies, transactionTypes);\n+    for (int i = 0; i < 5; ++i) {", "originalCommit": "13034d65f4fe209d5419316f080b124d045dd973", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTk5MzI3Mg==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r505993272", "bodyText": "Done.", "author": "psudheer21", "createdAt": "2020-10-16T02:25:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzODkwNw=="}], "type": "inlineReview", "revised_code": {"commit": "8f8f38341c5909416c0be9ab70568e6c86e72975", "chunk": "diff --git a/src/com/oltpbenchmark/DBWorkload.java b/src/com/oltpbenchmark/DBWorkload.java\nindex 07ae74f..f0f3d79 100644\n--- a/src/com/oltpbenchmark/DBWorkload.java\n+++ b/src/com/oltpbenchmark/DBWorkload.java\n\n@@ -1136,7 +1158,8 @@ public class DBWorkload {\n     LOG.info(\"TPM-C: \" + df.format(tpmc));\n     LOG.info(\"Efficiency : \" + df.format(efficiency) + \"%\");\n     for (int i = 0; i < 5; ++i) {\n-      printOperationLatency(transactionTypes.get(i+1).toString(), list_latencies.get(i));\n+      LOG.info(getOperationLatencyString(transactionTypes.get(i+1).toString(),\n+                                         list_latencies.get(i)));\n     }\n   }\n \n"}}, {"oid": "d028c0151defa9bf1be329a45c4dc1860f7e70b2", "url": "https://github.com/yugabyte/tpcc/commit/d028c0151defa9bf1be329a45c4dc1860f7e70b2", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n23:32:46,660 (DBWorkload.java:1016) INFO  - Num New Order transactions : 34, time seconds: 180\n23:32:46,661 (DBWorkload.java:1017) INFO  - TPM-C: 11.33\n23:32:46,661 (DBWorkload.java:1018) INFO  - Efficiency : 88.13%\n23:32:46,661 (DBWorkload.java:1068) INFO  - NewOrder, Avg Latency: 31.96870588235294 msecs, p99 Latency: 154.854 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - Payment, Avg Latency: 20.616526315789475 msecs, p99 Latency: 95.526 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - OrderStatus, Avg Latency: 44.650166666666664 msecs, p99 Latency: 183.981 msecs\n23:32:46,662 (DBWorkload.java:1068) INFO  - Delivery, Avg Latency: 112.808 msecs, p99 Latency: 140.305 msecs\n23:32:46,663 (DBWorkload.java:1068) INFO  - StockLevel, Avg Latency: 146.24966666666666 msecs, p99 Latency: 213.393 msecs\n23:32:46,663 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 6.450216867469879 msecs, p99 Latency: 186.069 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-16T00:43:45Z", "type": "forcePushed"}, {"oid": "8f8f38341c5909416c0be9ab70568e6c86e72975", "url": "https://github.com/yugabyte/tpcc/commit/8f8f38341c5909416c0be9ab70568e6c86e72975", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n01:39:14,402 (DBWorkload.java:1016) INFO  - Num New Order transactions : 36, time seconds: 180\n01:39:14,402 (DBWorkload.java:1017) INFO  - TPM-C: 12\n01:39:14,402 (DBWorkload.java:1018) INFO  - Efficiency : 93.31%\n01:39:14,403 (DBWorkload.java:1056) INFO  - NewOrder, Avg Latency: 35.67194444444444 msecs, p99 Latency: 172.218 msecs Whole operation, Avg Latency: 56.37466666666666 msecs, p99 Latency: 231.338 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Payment, Avg Latency: 25.760722222222224 msecs, p99 Latency: 216.9 msecs Whole operation, Avg Latency: 39.668416666666666 msecs, p99 Latency: 255.616 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - OrderStatus, Avg Latency: 19.56925 msecs, p99 Latency: 36.103 msecs Whole operation, Avg Latency: 20.107 msecs, p99 Latency: 36.516 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Delivery, Avg Latency: 63.89 msecs, p99 Latency: 87.842 msecs Whole operation, Avg Latency: 64.649 msecs, p99 Latency: 88.568 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - StockLevel, Avg Latency: 135.317 msecs, p99 Latency: 136.352 msecs Whole operation, Avg Latency: 135.9805 msecs, p99 Latency: 136.877 msecs\n01:39:14,404 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 49.240474999999996 msecs, p99 Latency: 255.616 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-16T01:50:21Z", "type": "forcePushed"}, {"oid": "cf39e60ba17fa0c5126c3e5f218e1c1ac7b57c4a", "url": "https://github.com/yugabyte/tpcc/commit/cf39e60ba17fa0c5126c3e5f218e1c1ac7b57c4a", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n01:39:14,402 (DBWorkload.java:1016) INFO  - Num New Order transactions : 36, time seconds: 180\n01:39:14,402 (DBWorkload.java:1017) INFO  - TPM-C: 12\n01:39:14,402 (DBWorkload.java:1018) INFO  - Efficiency : 93.31%\n01:39:14,403 (DBWorkload.java:1056) INFO  - NewOrder, Avg Latency: 35.67194444444444 msecs, p99 Latency: 172.218 msecs Whole operation, Avg Latency: 56.37466666666666 msecs, p99 Latency: 231.338 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Payment, Avg Latency: 25.760722222222224 msecs, p99 Latency: 216.9 msecs Whole operation, Avg Latency: 39.668416666666666 msecs, p99 Latency: 255.616 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - OrderStatus, Avg Latency: 19.56925 msecs, p99 Latency: 36.103 msecs Whole operation, Avg Latency: 20.107 msecs, p99 Latency: 36.516 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Delivery, Avg Latency: 63.89 msecs, p99 Latency: 87.842 msecs Whole operation, Avg Latency: 64.649 msecs, p99 Latency: 88.568 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - StockLevel, Avg Latency: 135.317 msecs, p99 Latency: 136.352 msecs Whole operation, Avg Latency: 135.9805 msecs, p99 Latency: 136.877 msecs\n01:39:14,404 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 49.240474999999996 msecs, p99 Latency: 255.616 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-16T04:14:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA0NDYzNA==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r506044634", "bodyText": "Suggested change", "author": "robertsami", "createdAt": "2020-10-16T04:28:03Z", "path": "src/com/oltpbenchmark/api/Worker.java", "diffHunk": "@@ -352,15 +423,35 @@ public final void run() {\n             long end = System.nanoTime();\n             postState = wrkldState.getGlobalState();\n \n+", "originalCommit": "cf39e60ba17fa0c5126c3e5f218e1c1ac7b57c4a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA5Mjc4Mw==", "url": "https://github.com/yugabyte/tpcc/pull/59#discussion_r506092783", "bodyText": "Done.", "author": "psudheer21", "createdAt": "2020-10-16T06:44:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjA0NDYzNA=="}], "type": "inlineReview", "revised_code": {"commit": "e9367080828228776cc06e40c042b41bf9a814b9", "chunk": "diff --git a/src/com/oltpbenchmark/api/Worker.java b/src/com/oltpbenchmark/api/Worker.java\nindex 7d91e57..20a053c 100644\n--- a/src/com/oltpbenchmark/api/Worker.java\n+++ b/src/com/oltpbenchmark/api/Worker.java\n\n@@ -423,7 +423,6 @@ public abstract class Worker<T extends BenchmarkModule> implements Runnable {\n             long end = System.nanoTime();\n             postState = wrkldState.getGlobalState();\n \n-\n             switch (postState) {\n                 case MEASURE:\n                     // Non-serial measurement. Only measure if the state both\n"}}, {"oid": "e9367080828228776cc06e40c042b41bf9a814b9", "url": "https://github.com/yugabyte/tpcc/commit/e9367080828228776cc06e40c042b41bf9a814b9", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n01:39:14,402 (DBWorkload.java:1016) INFO  - Num New Order transactions : 36, time seconds: 180\n01:39:14,402 (DBWorkload.java:1017) INFO  - TPM-C: 12\n01:39:14,402 (DBWorkload.java:1018) INFO  - Efficiency : 93.31%\n01:39:14,403 (DBWorkload.java:1056) INFO  - NewOrder, Avg Latency: 35.67194444444444 msecs, p99 Latency: 172.218 msecs Whole operation, Avg Latency: 56.37466666666666 msecs, p99 Latency: 231.338 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Payment, Avg Latency: 25.760722222222224 msecs, p99 Latency: 216.9 msecs Whole operation, Avg Latency: 39.668416666666666 msecs, p99 Latency: 255.616 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - OrderStatus, Avg Latency: 19.56925 msecs, p99 Latency: 36.103 msecs Whole operation, Avg Latency: 20.107 msecs, p99 Latency: 36.516 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Delivery, Avg Latency: 63.89 msecs, p99 Latency: 87.842 msecs Whole operation, Avg Latency: 64.649 msecs, p99 Latency: 88.568 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - StockLevel, Avg Latency: 135.317 msecs, p99 Latency: 136.352 msecs Whole operation, Avg Latency: 135.9805 msecs, p99 Latency: 136.877 msecs\n01:39:14,404 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 49.240474999999996 msecs, p99 Latency: 255.616 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-16T06:43:59Z", "type": "commit"}, {"oid": "e9367080828228776cc06e40c042b41bf9a814b9", "url": "https://github.com/yugabyte/tpcc/commit/e9367080828228776cc06e40c042b41bf9a814b9", "message": "Display latencies for getting a connection from Hikari pool.\n\nSummary:\nThe output with the connection latency:\n01:39:14,402 (DBWorkload.java:1016) INFO  - Num New Order transactions : 36, time seconds: 180\n01:39:14,402 (DBWorkload.java:1017) INFO  - TPM-C: 12\n01:39:14,402 (DBWorkload.java:1018) INFO  - Efficiency : 93.31%\n01:39:14,403 (DBWorkload.java:1056) INFO  - NewOrder, Avg Latency: 35.67194444444444 msecs, p99 Latency: 172.218 msecs Whole operation, Avg Latency: 56.37466666666666 msecs, p99 Latency: 231.338 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Payment, Avg Latency: 25.760722222222224 msecs, p99 Latency: 216.9 msecs Whole operation, Avg Latency: 39.668416666666666 msecs, p99 Latency: 255.616 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - OrderStatus, Avg Latency: 19.56925 msecs, p99 Latency: 36.103 msecs Whole operation, Avg Latency: 20.107 msecs, p99 Latency: 36.516 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - Delivery, Avg Latency: 63.89 msecs, p99 Latency: 87.842 msecs Whole operation, Avg Latency: 64.649 msecs, p99 Latency: 88.568 msecs\n01:39:14,404 (DBWorkload.java:1056) INFO  - StockLevel, Avg Latency: 135.317 msecs, p99 Latency: 136.352 msecs Whole operation, Avg Latency: 135.9805 msecs, p99 Latency: 136.877 msecs\n01:39:14,404 (DBWorkload.java:1068) INFO  - Acquire Connection, Avg Latency: 49.240474999999996 msecs, p99 Latency: 255.616 msecs\n\nReviewers:\nMihnea, Rob", "committedDate": "2020-10-16T06:43:59Z", "type": "forcePushed"}]}