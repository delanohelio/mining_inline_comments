{"pr_number": 636, "pr_title": "fix unit test", "pr_createdAt": "2020-06-17T14:18:15Z", "pr_url": "https://github.com/Apicurio/apicurio-registry/pull/636", "timeline": [{"oid": "f01186b4e7f4be9b33691ebfec86f4bfc5c80b7b", "url": "https://github.com/Apicurio/apicurio-registry/commit/f01186b4e7f4be9b33691ebfec86f4bfc5c80b7b", "message": "fix unit test", "committedDate": "2020-06-17T14:17:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY0NDE0MA==", "url": "https://github.com/Apicurio/apicurio-registry/pull/636#discussion_r441644140", "bodyText": "What does waiting for the global id accomplish that waiting for the artifact doesn't?", "author": "EricWittmann", "createdAt": "2020-06-17T15:42:02Z", "path": "app/src/test/java/io/apicurio/registry/SerdeMixTest.java", "diffHunk": "@@ -57,9 +57,10 @@ public void testVersions(Supplier<RegistryService> supplier) throws Exception {\n         Schema schema = new Schema.Parser().parse(\"{\\\"type\\\":\\\"record\\\",\\\"name\\\":\\\"myrecord5\\\",\\\"fields\\\":[{\\\"name\\\":\\\"bar\\\",\\\"type\\\":\\\"string\\\"}]}\");\n         int id = confClient.register(subject, schema);\n         confClient.reset();\n-        \n+\n         this.waitForArtifact(subject);\n \n+        this.waitForGlobalId(id);", "originalCommit": "f01186b4e7f4be9b33691ebfec86f4bfc5c80b7b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY2MjQxNg==", "url": "https://github.com/Apicurio/apicurio-registry/pull/636#discussion_r441662416", "bodyText": "for some reason the confClient.getById(id); fails if you don't wait", "author": "famartinrh", "createdAt": "2020-06-17T16:09:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY0NDE0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTczMjU1OQ==", "url": "https://github.com/Apicurio/apicurio-registry/pull/636#discussion_r441732559", "bodyText": "@carlesarnal Can you verify this locally?  Also if you could try it with line 61 removed as well.  I don't see why we would need both of these waits.", "author": "EricWittmann", "createdAt": "2020-06-17T18:06:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY0NDE0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAxOTQ5Nw==", "url": "https://github.com/Apicurio/apicurio-registry/pull/636#discussion_r442019497", "bodyText": "Hi @famartinrh , @EricWittmann, makes sense that we need to add here the waitForGlobalId since the id argument of the getById operation is a global id. I'm not sure about the waitForArtifact but, I guess that we need it since we are trying to perform an updateArtifact operation that otherwise might fail. That said, after removing the line 61 and a couple of executions the test worked fine.", "author": "carlesarnal", "createdAt": "2020-06-18T07:22:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY0NDE0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjI2MTQ0OQ==", "url": "https://github.com/Apicurio/apicurio-registry/pull/636#discussion_r442261449", "bodyText": "Thanks @carlesarnal", "author": "EricWittmann", "createdAt": "2020-06-18T14:17:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY0NDE0MA=="}], "type": "inlineReview", "revised_code": null}]}