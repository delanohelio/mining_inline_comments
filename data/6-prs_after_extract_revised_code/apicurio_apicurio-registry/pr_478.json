{"pr_number": 478, "pr_title": "Better YAML and XML support", "pr_createdAt": "2020-05-15T13:45:22Z", "pr_url": "https://github.com/Apicurio/apicurio-registry/pull/478", "timeline": [{"oid": "82cd3809a3207df395acca141d7069787cddbd6a", "url": "https://github.com/Apicurio/apicurio-registry/commit/82cd3809a3207df395acca141d7069787cddbd6a", "message": "added support for YAML in both front and back-ends.  also added XML content-type support in the API.  Fixes #462", "committedDate": "2020-05-15T13:43:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTgyMTA3OA==", "url": "https://github.com/Apicurio/apicurio-registry/pull/478#discussion_r425821078", "bodyText": "Maybe extract the content types to a constant and reuse them in the tests would be a good idea.", "author": "carlesarnal", "createdAt": "2020-05-15T13:58:58Z", "path": "app/src/main/java/io/apicurio/registry/util/ContentTypeUtil.java", "diffHunk": "@@ -0,0 +1,68 @@\n+/*\n+ * Copyright 2020 Red Hat\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.apicurio.registry.util;\n+\n+import javax.servlet.http.HttpServletRequest;\n+\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;\n+\n+import io.apicurio.registry.content.ContentHandle;\n+\n+/**\n+ * @author eric.wittmann@gmail.com\n+ */\n+public final class ContentTypeUtil {\n+\n+    private static final ObjectMapper yamlMapper = new ObjectMapper(new YAMLFactory());\n+    private static final ObjectMapper jsonMapper = new ObjectMapper();\n+\n+    /**\n+     * Returns true if the Content-Type of the inbound request is \"application/json\".\n+     * @param request\n+     */\n+    public static final boolean isApplicationJson(HttpServletRequest request) {\n+        String ct = request.getContentType();\n+        if (ct == null) {\n+            return false;\n+        }\n+        return ct.contains(\"application/json\");", "originalCommit": "82cd3809a3207df395acca141d7069787cddbd6a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a8b189e2a43834d37477ec1dfa6fb1489a6b9d97", "chunk": "diff --git a/app/src/main/java/io/apicurio/registry/util/ContentTypeUtil.java b/app/src/main/java/io/apicurio/registry/util/ContentTypeUtil.java\nindex 7f1d1c24..a0f1e99f 100644\n--- a/app/src/main/java/io/apicurio/registry/util/ContentTypeUtil.java\n+++ b/app/src/main/java/io/apicurio/registry/util/ContentTypeUtil.java\n\n@@ -28,6 +28,10 @@ import io.apicurio.registry.content.ContentHandle;\n  * @author eric.wittmann@gmail.com\n  */\n public final class ContentTypeUtil {\n+    \n+    public static final String CT_APPLICATION_JSON = \"application/json\";\n+    public static final String CT_APPLICATION_YAML = \"application/x-yaml\";\n+    public static final String CT_APPLICATION_XML = \"application/xml\";\n \n     private static final ObjectMapper yamlMapper = new ObjectMapper(new YAMLFactory());\n     private static final ObjectMapper jsonMapper = new ObjectMapper();\n"}}, {"oid": "84d5669266d230eadaecb49b7ae25fa505a7ef5d", "url": "https://github.com/Apicurio/apicurio-registry/commit/84d5669266d230eadaecb49b7ae25fa505a7ef5d", "message": "normalize strings in unit test", "committedDate": "2020-05-15T17:32:27Z", "type": "commit"}, {"oid": "a8b189e2a43834d37477ec1dfa6fb1489a6b9d97", "url": "https://github.com/Apicurio/apicurio-registry/commit/a8b189e2a43834d37477ec1dfa6fb1489a6b9d97", "message": "add constants for artifact types and content types", "committedDate": "2020-05-15T18:50:50Z", "type": "commit"}]}