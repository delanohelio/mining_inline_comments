{"pr_number": 2168, "pr_title": "[JBPM-9197] Allow the introduction of emails in Tasks notifications", "pr_createdAt": "2020-07-27T10:13:13Z", "pr_url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2168", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ0OTk1NQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2168#discussion_r461449955", "bodyText": "Though this is a test (any value works), it would be meaningful if email here is different than the \"from\" (target vs origin).\nIf possible, use more than one email to take advantage of using \"asList\" instead of \"Collections.singletonList\".", "author": "gmunozfe", "createdAt": "2020-07-28T09:34:10Z", "path": "kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java", "diffHunk": "@@ -971,7 +971,15 @@ private void testCancelNotify(boolean whenNotStarted) throws Exception {\n             Assertions.assertThat(notifications).isNotNull();\n             Assertions.assertThat(notifications).hasSize(0);\n \n-            EmailNotification emailNotification = EmailNotification.builder().from(\"test@jbpm.org\").replyTo(\"no-reply@jbpm.org\").subject(\"reminder\").body(\"my test content\").users(Arrays.asList(USER_JOHN)).build();\n+            EmailNotification emailNotification = EmailNotification.builder()\n+                                                                   .from(\"test@jbpm.org\")\n+                                                                   .replyTo(\"no-reply@jbpm.org\")\n+                                                                   .subject(\"reminder\")\n+                                                                   .body(\"my test content\")\n+                                                                   .users(asList(USER_JOHN))\n+                                                                   .emails(asList(\"test@jbpm.org\"))", "originalCommit": "a2f2092f672cb2f64dbf190af54d8db3fbc9457b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjE1NTQ4OA==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2168#discussion_r462155488", "bodyText": "done", "author": "elguardian", "createdAt": "2020-07-29T09:12:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ0OTk1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "42cc14c4fff849e594aa21509afcbc28da6311bf", "chunk": "diff --git a/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java b/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java\nindex 77149ba68..622da732c 100644\n--- a/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java\n+++ b/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java\n\n@@ -976,8 +977,8 @@ public class UserTaskAdminServiceIntegrationTest extends JbpmKieServerBaseIntegr\n                                                                    .replyTo(\"no-reply@jbpm.org\")\n                                                                    .subject(\"reminder\")\n                                                                    .body(\"my test content\")\n-                                                                   .users(asList(USER_JOHN))\n-                                                                   .emails(asList(\"test@jbpm.org\"))\n+                                                                   .users(singletonList(USER_JOHN))\n+                                                                   .emails(singletonList(\"email@jbpm.org\"))\n                                                                    .build();\n \n             Long notificationId = null;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ1MDUxNQ==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2168#discussion_r461450515", "bodyText": "Could values also be asserted?", "author": "gmunozfe", "createdAt": "2020-07-28T09:35:06Z", "path": "kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java", "diffHunk": "@@ -982,6 +990,8 @@ private void testCancelNotify(boolean whenNotStarted) throws Exception {\n             notifications = userTaskAdminClient.getTaskNotifications(CONTAINER_ID, taskId, true);\n             Assertions.assertThat(notifications).isNotNull();\n             Assertions.assertThat(notifications).hasSize(1);\n+            Assertions.assertThat(notifications.get(0).getUsers()).hasSize(1);\n+            Assertions.assertThat(notifications.get(0).getEmails()).hasSize(1);", "originalCommit": "a2f2092f672cb2f64dbf190af54d8db3fbc9457b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjE1NTU2NA==", "url": "https://github.com/kiegroup/droolsjbpm-integration/pull/2168#discussion_r462155564", "bodyText": "done", "author": "elguardian", "createdAt": "2020-07-29T09:12:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTQ1MDUxNQ=="}], "type": "inlineReview", "revised_code": {"commit": "42cc14c4fff849e594aa21509afcbc28da6311bf", "chunk": "diff --git a/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java b/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java\nindex 77149ba68..622da732c 100644\n--- a/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java\n+++ b/kie-server-parent/kie-server-tests/kie-server-integ-tests-jbpm/src/test/java/org/kie/server/integrationtests/jbpm/admin/UserTaskAdminServiceIntegrationTest.java\n\n@@ -991,7 +992,9 @@ public class UserTaskAdminServiceIntegrationTest extends JbpmKieServerBaseIntegr\n             Assertions.assertThat(notifications).isNotNull();\n             Assertions.assertThat(notifications).hasSize(1);\n             Assertions.assertThat(notifications.get(0).getUsers()).hasSize(1);\n+            Assertions.assertThat(notifications.get(0).getUsers().get(0)).isEqualTo(USER_JOHN);\n             Assertions.assertThat(notifications.get(0).getEmails()).hasSize(1);\n+            Assertions.assertThat(notifications.get(0).getEmails().get(0)).isEqualTo(\"email@jbpm.org\");\n \n             userTaskAdminClient.cancelNotification(CONTAINER_ID, taskId, notificationId);\n \n"}}, {"oid": "42cc14c4fff849e594aa21509afcbc28da6311bf", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/42cc14c4fff849e594aa21509afcbc28da6311bf", "message": "[JBPM-9197] Allow the introduction of emails in Tasks notifications", "committedDate": "2020-07-29T09:08:19Z", "type": "forcePushed"}, {"oid": "cc561413f583bb82fa0ef911672a1735af5cf63a", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/cc561413f583bb82fa0ef911672a1735af5cf63a", "message": "[JBPM-9197] Allow the introduction of emails in Tasks notifications", "committedDate": "2020-07-29T09:12:08Z", "type": "forcePushed"}, {"oid": "2eef6532cf7f25a99c1b4cc9c9a915aad4532757", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/2eef6532cf7f25a99c1b4cc9c9a915aad4532757", "message": "[JBPM-9197] Allow the introduction of emails in Tasks notifications", "committedDate": "2020-07-29T12:42:27Z", "type": "forcePushed"}, {"oid": "efaaad9f2492fe81b81a6db86816d2311ae0d6cf", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/efaaad9f2492fe81b81a6db86816d2311ae0d6cf", "message": "[JBPM-9197] Allow the introduction of emails in Tasks notifications", "committedDate": "2020-07-31T07:58:01Z", "type": "commit"}, {"oid": "efaaad9f2492fe81b81a6db86816d2311ae0d6cf", "url": "https://github.com/kiegroup/droolsjbpm-integration/commit/efaaad9f2492fe81b81a6db86816d2311ae0d6cf", "message": "[JBPM-9197] Allow the introduction of emails in Tasks notifications", "committedDate": "2020-07-31T07:58:01Z", "type": "forcePushed"}]}