{"pr_number": 857, "pr_title": "Added ErrorCodeException instead of passing the ErrorCode in response object", "pr_createdAt": "2020-08-31T16:04:56Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/857", "timeline": [{"oid": "9e753735d4e0a1a592d35c656c7faa110e203b09", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9e753735d4e0a1a592d35c656c7faa110e203b09", "message": "issue fixed", "committedDate": "2020-08-31T14:35:15Z", "type": "commit"}, {"oid": "7ec18efe7ec4300a7d4211a2b9bd9bfd8ea44b89", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/7ec18efe7ec4300a7d4211a2b9bd9bfd8ea44b89", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into issue-702-fixes\n\n# Conflicts:\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/SiteStatusResponse.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/StudyServiceImpl.java", "committedDate": "2020-08-31T15:11:08Z", "type": "commit"}, {"oid": "11fda3ebf814f347820dde1af525977dccd44065", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/11fda3ebf814f347820dde1af525977dccd44065", "message": "bug fixed for test case failure", "committedDate": "2020-08-31T15:44:20Z", "type": "commit"}, {"oid": "8e9d67a862a4694285200cebdfdc04ea93d0f1c6", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8e9d67a862a4694285200cebdfdc04ea93d0f1c6", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into issue-702-fixes\n\n# Conflicts:\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/AppController.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/SiteController.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/AppServiceImpl.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/ConsentServiceImpl.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserProfileServiceImpl.java", "committedDate": "2020-08-31T16:03:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA1NzMyMg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/857#discussion_r482057322", "bodyText": "Shouldn't these properties be removed from this class as well?", "author": "nikklassen", "createdAt": "2020-09-02T13:12:39Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/BaseResponse.java", "diffHunk": "@@ -48,13 +47,6 @@\n \n   public BaseResponse() {}\n \n-  public BaseResponse(ErrorCode errorCode) {\n-    this.httpStatusCode = errorCode.getStatus();\n-    this.code = errorCode.getCode();\n-    this.errorType = errorCode.getErrorType();\n-    this.errorDescription = errorCode.getDescription();", "originalCommit": "8e9d67a862a4694285200cebdfdc04ea93d0f1c6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjczOTU4MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/857#discussion_r482739580", "bodyText": "Requested issue fixed.", "author": "chiranjibi009", "createdAt": "2020-09-03T06:43:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA1NzMyMg=="}], "type": "inlineReview", "revised_code": {"commit": "1cc21bbc3503fd63236dd7e83ba71a82e4cd9e96", "chunk": "diff --git a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/BaseResponse.java b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/BaseResponse.java\nindex 09fa7b6e9..b4c43ad52 100644\n--- a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/BaseResponse.java\n+++ b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/beans/BaseResponse.java\n\n@@ -25,22 +25,10 @@ public class BaseResponse {\n   @JsonProperty(\"status\")\n   private Integer httpStatusCode;\n \n-  @JsonInclude(Include.NON_NULL)\n-  @JsonProperty(\"error_code\")\n-  private String errorCode;\n-\n   @JsonInclude(Include.NON_NULL)\n   @JsonProperty(\"code\")\n   private String code;\n \n-  @JsonInclude(Include.NON_NULL)\n-  @JsonProperty(\"error_type\")\n-  private String errorType;\n-\n-  @JsonInclude(Include.NON_NULL)\n-  @JsonProperty(\"error_description\")\n-  private String errorDescription;\n-\n   @JsonInclude(Include.NON_NULL)\n   @JsonProperty(\"message\")\n   private String message;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA2MDY4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/857#discussion_r482060685", "bodyText": "This isn't throwing an error code yet", "author": "nikklassen", "createdAt": "2020-09-02T13:17:40Z", "path": "participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -490,7 +474,6 @@ private ErrorCode validateDecommissionSiteRequest(String userId, String siteId)\n     Optional<SitePermissionEntity> optSitePermission =\n         sitePermissionRepository.findByUserIdAndSiteId(userId, siteId);\n     if (!optSitePermission.isPresent()) {\n-      // TODO (#702) throw ErrorCodeException", "originalCommit": "8e9d67a862a4694285200cebdfdc04ea93d0f1c6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjczOTY0MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/857#discussion_r482739640", "bodyText": "Requested issue fixed.", "author": "chiranjibi009", "createdAt": "2020-09-03T06:43:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjA2MDY4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "1cc21bbc3503fd63236dd7e83ba71a82e4cd9e96", "chunk": "diff --git a/participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java b/participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java\nindex c07c6fbb0..2d7c52819 100644\n--- a/participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java\n+++ b/participant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java\n\n@@ -470,22 +467,22 @@ public class SiteServiceImpl implements SiteService {\n         site.getId(), site.getStatus(), MessageCode.DECOMMISSION_SITE_SUCCESS);\n   }\n \n-  private ErrorCode validateDecommissionSiteRequest(String userId, String siteId) {\n+  private void validateDecommissionSiteRequest(String userId, String siteId) {\n     Optional<SitePermissionEntity> optSitePermission =\n         sitePermissionRepository.findByUserIdAndSiteId(userId, siteId);\n     if (!optSitePermission.isPresent()) {\n-      return ErrorCode.SITE_NOT_FOUND;\n+      throw new ErrorCodeException(ErrorCode.SITE_NOT_FOUND);\n     }\n \n     SitePermissionEntity sitePermission = optSitePermission.get();\n     if (OPEN.equalsIgnoreCase(sitePermission.getStudy().getType())) {\n-      return ErrorCode.CANNOT_DECOMMISSION_SITE_FOR_OPEN_STUDY;\n+      throw new ErrorCodeException(ErrorCode.CANNOT_DECOMMISSION_SITE_FOR_OPEN_STUDY);\n     }\n \n     String studyId = sitePermission.getStudy().getId();\n     boolean canEdit = isEditPermissionAllowed(studyId, userId);\n     if (!canEdit) {\n-      return ErrorCode.SITE_PERMISSION_ACCESS_DENIED;\n+      throw new ErrorCodeException(ErrorCode.SITE_PERMISSION_ACCESS_DENIED);\n     }\n \n     List<String> status = Arrays.asList(ENROLLED_STATUS, STATUS_ACTIVE);\n"}}, {"oid": "1cc21bbc3503fd63236dd7e83ba71a82e4cd9e96", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1cc21bbc3503fd63236dd7e83ba71a82e4cd9e96", "message": "commented changes fixed", "committedDate": "2020-09-03T06:38:31Z", "type": "commit"}, {"oid": "c9fbe086c406dcb0401adbd7069f804be037a594", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/c9fbe086c406dcb0401adbd7069f804be037a594", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into issue-702-fixes\n\n# Conflicts:\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/UserProfileServiceImpl.java", "committedDate": "2020-09-03T16:34:01Z", "type": "commit"}]}