{"pr_number": 653, "pr_title": "Participant manager (PUT) /locations/{locationId} endpoint", "pr_createdAt": "2020-07-20T09:08:31Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653", "timeline": [{"oid": "389bec9d8f37ef48e70c35e4d9a863ea100ed997", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/389bec9d8f37ef48e70c35e4d9a863ea100ed997", "message": "PUT update location api endpoint", "committedDate": "2020-07-20T08:58:13Z", "type": "commit"}, {"oid": "6886920c6f92230521fe3fc5311cc1687d32f8b7", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6886920c6f92230521fe3fc5311cc1687d32f8b7", "message": "update location api end point", "committedDate": "2020-07-20T09:04:09Z", "type": "commit"}, {"oid": "35516f7f6be0b1696341f882d55208f12c43d593", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/35516f7f6be0b1696341f882d55208f12c43d593", "message": "ActiveUserFilter conditional property removed", "committedDate": "2020-07-20T11:33:22Z", "type": "commit"}, {"oid": "734c580946f13d11afd2953ec13f80b1cfe4cd0d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/734c580946f13d11afd2953ec13f80b1cfe4cd0d", "message": "conditional property of activeUserFilter", "committedDate": "2020-07-20T11:42:02Z", "type": "commit"}, {"oid": "0cef4ab47ff27bdce31db14849a17ef13621c9e8", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0cef4ab47ff27bdce31db14849a17ef13621c9e8", "message": "Merge branch 'participant-manager-studies-endpoint' into participant-manager-put-update-location-endpoint", "committedDate": "2020-07-22T14:56:13Z", "type": "commit"}, {"oid": "e7146b73602f5dd443504e8f88bc9121fce772f0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/e7146b73602f5dd443504e8f88bc9121fce772f0", "message": "Resolved conflict issue", "committedDate": "2020-07-22T15:01:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNjIzNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653#discussion_r459106234", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              CANNOT_REACTIVE(\n          \n          \n            \n                  400, \"EC_887\", Constants.BAD_REQUEST, \"Can't reactive an already active location\"),\n          \n          \n            \n              CANNOT_REACTIVATE(\n          \n          \n            \n                  400, \"EC_887\", Constants.BAD_REQUEST, \"Can't reactivate an already active location\"),", "author": "saminguyen", "createdAt": "2020-07-22T21:54:40Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java", "diffHunk": "@@ -84,7 +84,27 @@\n \n   APP_NOT_FOUND(404, \"EC-817\", Constants.BAD_REQUEST, \"App not found.\"),\n \n-  STUDY_NOT_FOUND(404, \"EC-816\", Constants.BAD_REQUEST, \"Study not found\");\n+  STUDY_NOT_FOUND(404, \"EC-816\", Constants.BAD_REQUEST, \"Study not found\"),\n+\n+  LOCATION_NOT_FOUND(404, \"EC_881\", \"Not Found\", \"No Locations Found\"),\n+\n+  DEFAULT_SITE_MODIFY_DENIED(\n+      400, \"EC_888\", Constants.BAD_REQUEST, \"Default site can't be modified\"),\n+\n+  ALREADY_DECOMMISSIONED(\n+      400, \"EC_886\", Constants.BAD_REQUEST, \"Can't decommision an already decommissioned location\"),\n+\n+  CANNOT_DECOMMISSIONED(\n+      400,\n+      \"EC_885\",\n+      Constants.BAD_REQUEST,\n+      \"This Location is being used as an active Site in one or more studies and cannot be decomissioned\"),\n+\n+  CANNOT_REACTIVE(\n+      400, \"EC_887\", Constants.BAD_REQUEST, \"Can't reactive an already active location\"),", "originalCommit": "e7146b73602f5dd443504e8f88bc9121fce772f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIyMDQzOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653#discussion_r459220438", "bodyText": "Changed from CANNOT_REACTIVE to CANNOT_REACTIVATE.", "author": "madhurya-btc", "createdAt": "2020-07-23T05:24:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNjIzNA=="}], "type": "inlineReview", "revised_code": {"commit": "9166da96bdcf9fce2aeb875479b1404b0d46e7b2", "chunk": "diff --git a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java\nindex 45b4439e5..71f338e7a 100644\n--- a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java\n+++ b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/ErrorCode.java\n\n@@ -100,8 +100,8 @@ public enum ErrorCode {\n       Constants.BAD_REQUEST,\n       \"This Location is being used as an active Site in one or more studies and cannot be decomissioned\"),\n \n-  CANNOT_REACTIVE(\n-      400, \"EC_887\", Constants.BAD_REQUEST, \"Can't reactive an already active location\"),\n+  CANNOT_REACTIVATE(\n+      400, \"EC_887\", Constants.BAD_REQUEST, \"Can't reactivate an already active location\"),\n \n   LOCATION_UPDATE_DENIED(\n       403, \"EC-882\", \"Forbidden\", \"You do not have permission to update the location\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNzYxNA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653#discussion_r459107614", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              GET_STUDIES_SUCCESS(HttpStatus.OK, \"MSG-0004\", \"Get studies successfull\"),\n          \n          \n            \n              GET_STUDIES_SUCCESS(HttpStatus.OK, \"MSG-0004\", \"Get studies successfully\"),", "author": "saminguyen", "createdAt": "2020-07-22T21:58:04Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java", "diffHunk": "@@ -32,7 +32,13 @@\n \n   GET_APPS_SUCCESS(HttpStatus.OK, \"MSG-0003\", \"Get apps successfull\"),\n \n-  GET_STUDIES_SUCCESS(HttpStatus.OK, \"MSG-0004\", \"Get studies successfull\");\n+  GET_STUDIES_SUCCESS(HttpStatus.OK, \"MSG-0004\", \"Get studies successfull\"),", "originalCommit": "e7146b73602f5dd443504e8f88bc9121fce772f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIyMDQ1Ng==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653#discussion_r459220456", "bodyText": "Changed from  \"successfull\" to \"successfully\".", "author": "madhurya-btc", "createdAt": "2020-07-23T05:24:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEwNzYxNA=="}], "type": "inlineReview", "revised_code": {"commit": "9166da96bdcf9fce2aeb875479b1404b0d46e7b2", "chunk": "diff --git a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java\nindex 009b96b00..e2eb6976c 100644\n--- a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java\n+++ b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java\n\n@@ -30,9 +30,9 @@ public enum MessageCode {\n \n   ADD_LOCATION_SUCCESS(HttpStatus.CREATED, \"MSG-0002\", \"New location added successfully\"),\n \n-  GET_APPS_SUCCESS(HttpStatus.OK, \"MSG-0003\", \"Get apps successfull\"),\n+  GET_APPS_SUCCESS(HttpStatus.OK, \"MSG-0003\", \"Get apps successfully\"),\n \n-  GET_STUDIES_SUCCESS(HttpStatus.OK, \"MSG-0004\", \"Get studies successfull\"),\n+  GET_STUDIES_SUCCESS(HttpStatus.OK, \"MSG-0004\", \"Get studies successfully\"),\n \n   DECOMMISSION_SUCCESS(HttpStatus.OK, \"MSG-0003\", \"Decommission successfully\"),\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyMjE5MA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653#discussion_r459122190", "bodyText": "Use the Constant YES/NO here (there is one in CommonConstants.java)", "author": "saminguyen", "createdAt": "2020-07-22T22:35:45Z", "path": "common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java", "diffHunk": "@@ -80,4 +81,9 @@ public void addSiteEntity(SiteEntity site) {\n     sites.add(site);\n     site.setLocation(this);\n   }\n+\n+  @Transient\n+  public boolean isDefault() {\n+    return \"Y\".equalsIgnoreCase(isDefault);", "originalCommit": "e7146b73602f5dd443504e8f88bc9121fce772f0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIyMDUyOA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/653#discussion_r459220528", "bodyText": "Instead of \"Y\" used constant \"YES\" which is in CommonConstants.java.", "author": "madhurya-btc", "createdAt": "2020-07-23T05:24:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTEyMjE5MA=="}], "type": "inlineReview", "revised_code": {"commit": "9166da96bdcf9fce2aeb875479b1404b0d46e7b2", "chunk": "diff --git a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java\nindex 515a2fbc0..eac443de3 100644\n--- a/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java\n+++ b/common-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/model/LocationEntity.java\n\n@@ -84,6 +86,6 @@ public class LocationEntity implements Serializable {\n \n   @Transient\n   public boolean isDefault() {\n-    return \"Y\".equalsIgnoreCase(isDefault);\n+    return YES.equalsIgnoreCase(isDefault);\n   }\n }\n"}}, {"oid": "9166da96bdcf9fce2aeb875479b1404b0d46e7b2", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/9166da96bdcf9fce2aeb875479b1404b0d46e7b2", "message": "PR Comments fixed.", "committedDate": "2020-07-23T05:08:41Z", "type": "commit"}, {"oid": "6323302a11379ae686cd65dbe825efa068ca12db", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6323302a11379ae686cd65dbe825efa068ca12db", "message": "Merge branch 'participant-manager-studies-endpoint' into participant-manager-put-update-location-endpoint", "committedDate": "2020-07-24T05:14:43Z", "type": "commit"}, {"oid": "b93fdbafb9f42d524ab70a3f343fa63a5391abea", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/b93fdbafb9f42d524ab70a3f343fa63a5391abea", "message": "Merge branch 'participant-manager-studies-endpoint' into participant-manager-put-update-location-endpoint", "committedDate": "2020-07-28T04:49:15Z", "type": "commit"}, {"oid": "37ecf2666717870d3545408003ecd012175f9d8f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/37ecf2666717870d3545408003ecd012175f9d8f", "message": "Merge branch 'develop' into participant-manager-put-update-location-endpoint\n\n# Conflicts:\n#\tcommon-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/CommonConstants.java\n#\tcommon-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/MessageCode.java\n#\tcommon-modules/common-service/src/main/java/com/google/cloud/healthcare/fdamystudies/common/Permission.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/controller/LocationController.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/LocationService.java\n#\tparticipant-manager-module/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/LocationServiceImpl.java\n#\tparticipant-manager-module/participant-manager-service/src/test/java/com/google/cloud/healthcare/fdamystudies/common/ApiEndpoint.java", "committedDate": "2020-08-11T16:03:15Z", "type": "commit"}, {"oid": "1144f77e07d4be22b411ea5afd137988e30f500d", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/1144f77e07d4be22b411ea5afd137988e30f500d", "message": "Merge branch 'develop' into participant-manager-put-update-location-endpoint", "committedDate": "2020-08-11T16:10:51Z", "type": "commit"}]}