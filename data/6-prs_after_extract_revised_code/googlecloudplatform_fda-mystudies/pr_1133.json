{"pr_number": 1133, "pr_title": "(StudyBuilder)- UserAccessLevel implementation for audit log events", "pr_createdAt": "2020-10-06T11:52:04Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133", "timeline": [{"oid": "72d86231ee82bc520710961cb2621e97a778865a", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/72d86231ee82bc520710961cb2621e97a778865a", "message": "access level added to session object", "committedDate": "2020-10-05T03:55:09Z", "type": "commit"}, {"oid": "be0bd682d3c729945393b0c24d995de33e2a8e94", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/be0bd682d3c729945393b0c24d995de33e2a8e94", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into study-builder-access-level-correction", "committedDate": "2020-10-05T03:56:00Z", "type": "commit"}, {"oid": "8db823537e010dfc9176eb1c2eb51ffa99db78ed", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/8db823537e010dfc9176eb1c2eb51ffa99db78ed", "message": "test case implemented for access level", "committedDate": "2020-10-05T13:44:40Z", "type": "commit"}, {"oid": "2ebb4433bcd625ac3b7fbdf924cf5b5dcdcd1dd4", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/2ebb4433bcd625ac3b7fbdf924cf5b5dcdcd1dd4", "message": "user access level implemented with assertation", "committedDate": "2020-10-06T10:55:17Z", "type": "commit"}, {"oid": "81e37d921d0a97327ff24ee43c220e8e889fa0ff", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/81e37d921d0a97327ff24ee43c220e8e889fa0ff", "message": "Merge branch 'develop' into issue-1124-fixes", "committedDate": "2020-10-06T11:55:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1MTk5NA==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500451994", "bodyText": "Keep empty line between static and non-static imports", "author": "saminguyen", "createdAt": "2020-10-06T16:54:48Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyActiveTasksController.java", "diffHunk": "@@ -26,7 +26,6 @@\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_MARKED_COMPLETE;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_SAVED_OR_UPDATED;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_SECTION_MARKED_COMPLETE;\n-", "originalCommit": "81e37d921d0a97327ff24ee43c220e8e889fa0ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgwNjAzNQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500806035", "bodyText": "Kept empty line between static and non-static imports", "author": "chiranjibi009", "createdAt": "2020-10-07T07:49:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1MTk5NA=="}], "type": "inlineReview", "revised_code": {"commit": "dc0b43d52401d56192dde8104affc905b005f2e0", "chunk": "diff --git a/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyActiveTasksController.java b/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyActiveTasksController.java\nindex 14012ba61..c1a8fc831 100644\n--- a/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyActiveTasksController.java\n+++ b/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyActiveTasksController.java\n\n@@ -26,6 +26,7 @@ package com.fdahpstudydesigner.controller;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_MARKED_COMPLETE;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_SAVED_OR_UPDATED;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_ACTIVE_TASK_SECTION_MARKED_COMPLETE;\n+\n import com.fdahpstudydesigner.bean.ActiveStatisticsBean;\n import com.fdahpstudydesigner.bean.AuditLogEventRequest;\n import com.fdahpstudydesigner.bo.ActiveTaskBo;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1MjI1Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500452253", "bodyText": "same as above", "author": "saminguyen", "createdAt": "2020-10-06T16:55:11Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyController.java", "diffHunk": "@@ -42,7 +42,6 @@\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_RESOURCE_SECTION_MARKED_COMPLETE;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_SAVED_IN_DRAFT_STATE;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_VIEWED;\n-", "originalCommit": "81e37d921d0a97327ff24ee43c220e8e889fa0ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgwNjA5Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500806097", "bodyText": "Kept empty line between static and non-static imports", "author": "chiranjibi009", "createdAt": "2020-10-07T07:49:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1MjI1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "dc0b43d52401d56192dde8104affc905b005f2e0", "chunk": "diff --git a/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyController.java b/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyController.java\nindex d8d6ea353..8072f8391 100644\n--- a/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyController.java\n+++ b/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyController.java\n\n@@ -42,6 +42,7 @@ import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_RESOURC\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_RESOURCE_SECTION_MARKED_COMPLETE;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_SAVED_IN_DRAFT_STATE;\n import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_VIEWED;\n+\n import com.fdahpstudydesigner.bean.AuditLogEventRequest;\n import com.fdahpstudydesigner.bean.StudyDetailsBean;\n import com.fdahpstudydesigner.bean.StudyIdBean;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1MjM2Nw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500452367", "bodyText": "same as above", "author": "saminguyen", "createdAt": "2020-10-06T16:55:21Z", "path": "WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java", "diffHunk": "@@ -16,7 +16,6 @@\n import static com.fdahpstudydesigner.common.StudyBuilderConstants.FORM_ID;\n import static com.fdahpstudydesigner.common.StudyBuilderConstants.QUESTION_ID;\n import static com.fdahpstudydesigner.common.StudyBuilderConstants.STEP_ID;\n-", "originalCommit": "81e37d921d0a97327ff24ee43c220e8e889fa0ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgwNjE3Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500806173", "bodyText": "Kept empty line between static and non-static imports", "author": "chiranjibi009", "createdAt": "2020-10-07T07:49:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1MjM2Nw=="}], "type": "inlineReview", "revised_code": {"commit": "dc0b43d52401d56192dde8104affc905b005f2e0", "chunk": "diff --git a/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java b/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java\nindex 8cc4fb9c3..bd7246481 100644\n--- a/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java\n+++ b/WCP/fdahpStudyDesigner/src/main/java/com/fdahpstudydesigner/controller/StudyQuestionnaireController.java\n\n@@ -16,6 +16,7 @@ import static com.fdahpstudydesigner.common.StudyBuilderAuditEvent.STUDY_QUESTIO\n import static com.fdahpstudydesigner.common.StudyBuilderConstants.FORM_ID;\n import static com.fdahpstudydesigner.common.StudyBuilderConstants.QUESTION_ID;\n import static com.fdahpstudydesigner.common.StudyBuilderConstants.STEP_ID;\n+\n import com.fdahpstudydesigner.bean.AuditLogEventRequest;\n import com.fdahpstudydesigner.bean.FormulaInfoBean;\n import com.fdahpstudydesigner.bean.QuestionnaireStepBean;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1Njk1Mw==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500456953", "bodyText": "remove redundant commented line", "author": "saminguyen", "createdAt": "2020-10-06T17:02:37Z", "path": "WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java", "diffHunk": "@@ -313,14 +318,33 @@ public void checkNewStudyCreationInitiated() throws Exception {\n   public void checkLastPublishedVersionOfStudiedViewed() throws Exception {\n     HttpHeaders headers = getCommonHeaders();\n \n+    List<StudySessionBean> studySessionBeans = new ArrayList<>();\n+    StudySessionBean studySession = new StudySessionBean();\n+    studySession.setIsLive(\"true\");\n+    studySession.setPermission(\"View\");\n+    studySession.setSessionStudyCount(10);\n+    studySession.setStudyId(\"10\");\n+    studySessionBeans.add(studySession);\n+\n+    SessionObject session = new SessionObject();\n+    session.setUserId(Integer.parseInt(USER_ID_VALUE));\n+    session.setStudySession(new ArrayList<>(Arrays.asList(0)));\n+    session.setSessionId(UUID.randomUUID().toString());\n+    session.setStudySessionBeans(studySessionBeans);\n+    session.setAccessLevel(UserAccessLevel.SUPER_ADMIN.getValue());\n+\n+    HashMap<String, Object> sessionAttributes = getSessionAttributes();\n+    sessionAttributes.put(FdahpStudyDesignerConstants.SESSION_OBJECT, session);\n+\n     mockMvc\n         .perform(\n             post(PathMappingUri.VIEW_STUDY_DETAILS.getPath())\n                 .param(FdahpStudyDesignerConstants.STUDY_ID, STUDY_ID_VALUE)\n                 .param(FdahpStudyDesignerConstants.PERMISSION, \"View\")\n                 .param(FdahpStudyDesignerConstants.IS_LIVE, \"isLive\")\n                 .headers(headers)\n-                .sessionAttrs(getSessionAttributes()))\n+                .sessionAttrs(sessionAttributes))\n+        //        .sessionAttrs(getSessionAttributes()))", "originalCommit": "81e37d921d0a97327ff24ee43c220e8e889fa0ff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgwNTU3NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/1133#discussion_r500805575", "bodyText": "Removed redundant commented line.", "author": "chiranjibi009", "createdAt": "2020-10-07T07:48:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1Njk1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "dc0b43d52401d56192dde8104affc905b005f2e0", "chunk": "diff --git a/WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java b/WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java\nindex 61ee26bb9..2b9d1a531 100644\n--- a/WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java\n+++ b/WCP/fdahpStudyDesigner/src/test/java/com/fdahpstudydesigner/controller/StudyControllerTest.java\n\n@@ -344,7 +345,6 @@ public class StudyControllerTest extends BaseMockIT {\n                 .param(FdahpStudyDesignerConstants.IS_LIVE, \"isLive\")\n                 .headers(headers)\n                 .sessionAttrs(sessionAttributes))\n-        //        .sessionAttrs(getSessionAttributes()))\n         .andDo(print())\n         .andExpect(status().isFound())\n         .andExpect(view().name(\"redirect:/adminStudies/viewBasicInfo.do\"));\n"}}, {"oid": "f407649d7524146ec6150626b21ce2cff497777f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/f407649d7524146ec6150626b21ce2cff497777f", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into issue-1124-fixes", "committedDate": "2020-10-07T06:45:43Z", "type": "commit"}, {"oid": "dc0b43d52401d56192dde8104affc905b005f2e0", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/dc0b43d52401d56192dde8104affc905b005f2e0", "message": "organized import", "committedDate": "2020-10-07T07:45:37Z", "type": "commit"}, {"oid": "0e3d53c98457d7f740fbfe9c862dd9542bc11d4e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0e3d53c98457d7f740fbfe9c862dd9542bc11d4e", "message": "Merge branch 'develop' of https://github.com/GoogleCloudPlatform/fda-mystudies into issue-1124-fixes", "committedDate": "2020-10-07T07:46:09Z", "type": "commit"}, {"oid": "38439d4c2c6956437737d370bc3a8eb305439a8c", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/38439d4c2c6956437737d370bc3a8eb305439a8c", "message": "Merge branch 'develop' into issue-1124-fixes", "committedDate": "2020-10-07T16:57:52Z", "type": "commit"}, {"oid": "0d3a253724defa9de979cc7c93e45c575f44508f", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/0d3a253724defa9de979cc7c93e45c575f44508f", "message": "Merge branch 'develop' into issue-1124-fixes", "committedDate": "2020-10-08T04:37:33Z", "type": "commit"}]}