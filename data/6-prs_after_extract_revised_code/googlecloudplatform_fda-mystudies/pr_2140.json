{"pr_number": 2140, "pr_title": "[Particiapnt Manager]Issue #1841 fixed, You don't have permission to manage site' error message is displayed when user decommissions the site and refreshes the page", "pr_createdAt": "2020-11-25T15:12:09Z", "pr_url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2140", "timeline": [{"oid": "879e4aa571bd475ba6d3066653fec4a225b2871b", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/879e4aa571bd475ba6d3066653fec4a225b2871b", "message": "Issue #1841 issue fixed\n\nIssue #1841 issue fixed", "committedDate": "2020-11-25T15:10:07Z", "type": "commit"}, {"oid": "6e037cb665d8d4a235b707fd1dfa76da4aa6a5d7", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/6e037cb665d8d4a235b707fd1dfa76da4aa6a5d7", "message": "Merge branch 'develop' into issue1841", "committedDate": "2020-11-25T15:14:26Z", "type": "commit"}, {"oid": "3be0ba6e36f759547d1951b18e18e2d1361f192e", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/3be0ba6e36f759547d1951b18e18e2d1361f192e", "message": "Merge branch 'develop' into issue1841", "committedDate": "2020-11-27T02:36:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NzY1Mg==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2140#discussion_r531647652", "bodyText": "this doesn't make sense, should the second part be negated as well?\nif (!(studyAdminIds.contains(sitePermission.getUrAdminUser().getId())\n     ||    !(appAdminIds.contains(sitePermission.getUrAdminUser().getId()))))", "author": "zohrehj", "createdAt": "2020-11-27T14:58:11Z", "path": "participant-manager-datastore/participant-manager-service/src/main/java/com/google/cloud/healthcare/fdamystudies/service/SiteServiceImpl.java", "diffHunk": "@@ -640,7 +639,7 @@ private void updateSitePermissions(String siteId) {\n \n     for (SitePermissionEntity sitePermission : sitePermissions) {\n       if (!(studyAdminIds.contains(sitePermission.getUrAdminUser().getId())\n-          && appAdminIds.contains(sitePermission.getUrAdminUser().getId()))) {\n+          || appAdminIds.contains(sitePermission.getUrAdminUser().getId()))) {", "originalCommit": "3be0ba6e36f759547d1951b18e18e2d1361f192e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY1NzQ4NQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2140#discussion_r531657485", "bodyText": "@zohrehj the above changes will fail if user is having studylevel permission but not app level permission (vice -versa) or having both permission\nIn any of this case we should not delete site permission from sitePermissionRepository.\nso i had put check like below\n! (studylevelPermission || appLevelPermission)", "author": "madhurya-btc", "createdAt": "2020-11-27T15:18:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NzY1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTczMjY5OQ==", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/pull/2140#discussion_r531732699", "bodyText": "makes sense.", "author": "zohrehj", "createdAt": "2020-11-27T18:54:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTY0NzY1Mg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "d6d150a5808848301eba1193ca6a92997cc94ae1", "url": "https://github.com/GoogleCloudPlatform/fda-mystudies/commit/d6d150a5808848301eba1193ca6a92997cc94ae1", "message": "Merge branch 'develop' into issue1841", "committedDate": "2020-11-28T02:30:28Z", "type": "commit"}]}