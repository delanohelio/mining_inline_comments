{"pr_number": 3868, "pr_title": "reuse memory-expensive tagger between all loaded English dialects", "pr_createdAt": "2020-11-16T13:39:32Z", "pr_url": "https://github.com/languagetool-org/languagetool/pull/3868", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5Njc4MQ==", "url": "https://github.com/languagetool-org/languagetool/pull/3868#discussion_r524296781", "bodyText": "Could these be split into two lines? I think it's a bit uncommon to have a second assignment like this.", "author": "danielnaber", "createdAt": "2020-11-16T14:14:26Z", "path": "languagetool-language-modules/en/src/main/java/org/languagetool/language/English.java", "diffHunk": "@@ -105,7 +107,12 @@ public String getShortCode() {\n   @NotNull\n   @Override\n   public Tagger createDefaultTagger() {\n-    return new EnglishTagger();\n+    WeakReference<EnglishTagger> ref = cachedTagger;\n+    EnglishTagger tagger = ref == null ? null : ref.get();\n+    if (tagger == null) {\n+      cachedTagger = new WeakReference<>(tagger = new EnglishTagger());", "originalCommit": "abd92ef1aa9a8c89630710009ed11dbf74d1924e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5ODA3NQ==", "url": "https://github.com/languagetool-org/languagetool/pull/3868#discussion_r524298075", "bodyText": "It's common for me, but I see your point", "author": "donnerpeter", "createdAt": "2020-11-16T14:16:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5Njc4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5ODg5Nw==", "url": "https://github.com/languagetool-org/languagetool/pull/3868#discussion_r524298897", "bodyText": "Force-pushed", "author": "donnerpeter", "createdAt": "2020-11-16T14:17:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDI5Njc4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "21c9026606356e05e91a63bda2481237fc542813", "chunk": "diff --git a/languagetool-language-modules/en/src/main/java/org/languagetool/language/English.java b/languagetool-language-modules/en/src/main/java/org/languagetool/language/English.java\nindex c8bb4a2b51..3772432e9c 100644\n--- a/languagetool-language-modules/en/src/main/java/org/languagetool/language/English.java\n+++ b/languagetool-language-modules/en/src/main/java/org/languagetool/language/English.java\n\n@@ -110,7 +110,8 @@ public class English extends Language implements AutoCloseable {\n     WeakReference<EnglishTagger> ref = cachedTagger;\n     EnglishTagger tagger = ref == null ? null : ref.get();\n     if (tagger == null) {\n-      cachedTagger = new WeakReference<>(tagger = new EnglishTagger());\n+      tagger = new EnglishTagger();\n+      cachedTagger = new WeakReference<>(tagger);\n     }\n     return tagger;\n   }\n"}}, {"oid": "21c9026606356e05e91a63bda2481237fc542813", "url": "https://github.com/languagetool-org/languagetool/commit/21c9026606356e05e91a63bda2481237fc542813", "message": "reuse memory-expensive tagger between all loaded English dialects", "committedDate": "2020-11-16T14:17:06Z", "type": "forcePushed"}, {"oid": "d9e9920ba22ae9a885d40559dd9f02d25c9c3146", "url": "https://github.com/languagetool-org/languagetool/commit/d9e9920ba22ae9a885d40559dd9f02d25c9c3146", "message": "reuse memory-expensive tagger between all loaded English dialects", "committedDate": "2020-11-16T19:16:21Z", "type": "commit"}, {"oid": "d9e9920ba22ae9a885d40559dd9f02d25c9c3146", "url": "https://github.com/languagetool-org/languagetool/commit/d9e9920ba22ae9a885d40559dd9f02d25c9c3146", "message": "reuse memory-expensive tagger between all loaded English dialects", "committedDate": "2020-11-16T19:16:21Z", "type": "forcePushed"}]}