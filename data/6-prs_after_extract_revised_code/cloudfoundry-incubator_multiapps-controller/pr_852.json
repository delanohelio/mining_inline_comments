{"pr_number": 852, "pr_title": "remove logging of app environment without masking", "pr_createdAt": "2020-05-08T00:17:28Z", "pr_url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/852", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk5MTU4Mg==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/852#discussion_r421991582", "bodyText": "Method reference could be used: secureSerializer::toJson", "author": "IvanBorislavovDimitrov", "createdAt": "2020-05-08T07:32:51Z", "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/BuildCloudDeployModelStep.java", "diffHunk": "@@ -79,8 +79,10 @@ protected StepPhase executeStep(ProcessContext context) {\n         // Build a list of applications for deployment and save them in the context:\r\n         List<Module> modulesCalculatedForDeployment = calculateModulesForDeployment(context, deploymentDescriptor, mtaArchiveModules,\r\n                                                                                     deployedModuleNames, mtaModules);\r\n-\r\n-        getStepLogger().debug(Messages.MODULES_TO_DEPLOY, secureSerializer.toJson(modulesCalculatedForDeployment));\r\n+        List<String> moduleJsons = modulesCalculatedForDeployment.stream()\r\n+                                                                 .map(module -> secureSerializer.toJson(module))\r", "originalCommit": "9c842ee8dd68a612a47b1b15fa3c9601102f4954", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjEyNzMyOQ==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/852#discussion_r422127329", "bodyText": "10x!", "author": "ddonchev", "createdAt": "2020-05-08T12:56:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk5MTU4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "chunk": "diff --git a/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/BuildCloudDeployModelStep.java b/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/BuildCloudDeployModelStep.java\nindex 101a8ba30..e456d9f91 100644\n--- a/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/BuildCloudDeployModelStep.java\n+++ b/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/steps/BuildCloudDeployModelStep.java\n\n@@ -80,7 +80,7 @@ public class BuildCloudDeployModelStep extends SyncFlowableStep {\n         List<Module> modulesCalculatedForDeployment = calculateModulesForDeployment(context, deploymentDescriptor, mtaArchiveModules,\n                                                                                     deployedModuleNames, mtaModules);\n         List<String> moduleJsons = modulesCalculatedForDeployment.stream()\n-                                                                 .map(module -> secureSerializer.toJson(module))\n+                                                                 .map(secureSerializer::toJson)\n                                                                  .collect(Collectors.toList());\n         getStepLogger().debug(Messages.MODULES_TO_DEPLOY, moduleJsons.toString());\n         context.setVariable(Variables.ALL_MODULES_TO_DEPLOY, modulesCalculatedForDeployment);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk5MzI2Mg==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/852#discussion_r421993262", "bodyText": "Could you format this?", "author": "IvanBorislavovDimitrov", "createdAt": "2020-05-08T07:36:41Z", "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java", "diffHunk": "@@ -28,10 +28,8 @@ protected void updateAttribute(CloudApplication existingApplication, CloudApplic\n     }\n \n     private Map<String, String> applyUpdateStrategy(Map<String, String> existingEnv, Map<String, String> env) {\n-        getLogger().debug(Messages.EXISTING_ENV_0, JsonUtil.toJson(existingEnv, true));\n-        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV_1, updateStrategy, JsonUtil.toJson(env, true));\n+        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV, updateStrategy );", "originalCommit": "9c842ee8dd68a612a47b1b15fa3c9601102f4954", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "chunk": "diff --git a/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java b/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java\nindex 9ede5c9de..3346fba8f 100644\n--- a/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java\n+++ b/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java\n\n@@ -28,9 +28,8 @@ public class EnvironmentApplicationAttributeUpdater extends ApplicationAttribute\n     }\n \n     private Map<String, String> applyUpdateStrategy(Map<String, String> existingEnv, Map<String, String> env) {\n-        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV, updateStrategy );\n-        Map<String, String> result = getElementUpdater().updateMap(existingEnv, env);\n-        return result;\n+        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV, updateStrategy);\n+        return getElementUpdater().updateMap(existingEnv, env);\n     }\n \n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk5NDk4Nw==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/852#discussion_r421994987", "bodyText": "The result can be returned directly.", "author": "IvanBorislavovDimitrov", "createdAt": "2020-05-08T07:40:29Z", "path": "com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java", "diffHunk": "@@ -28,10 +28,8 @@ protected void updateAttribute(CloudApplication existingApplication, CloudApplic\n     }\n \n     private Map<String, String> applyUpdateStrategy(Map<String, String> existingEnv, Map<String, String> env) {\n-        getLogger().debug(Messages.EXISTING_ENV_0, JsonUtil.toJson(existingEnv, true));\n-        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV_1, updateStrategy, JsonUtil.toJson(env, true));\n+        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV, updateStrategy );\n         Map<String, String> result = getElementUpdater().updateMap(existingEnv, env);\n-        getLogger().debug(Messages.RESULT_0, JsonUtil.toJson(result, true));\n         return result;", "originalCommit": "9c842ee8dd68a612a47b1b15fa3c9601102f4954", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjEyNzQyMg==", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/pull/852#discussion_r422127422", "bodyText": "yep :)", "author": "ddonchev", "createdAt": "2020-05-08T12:57:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk5NDk4Nw=="}], "type": "inlineReview", "revised_code": {"commit": "b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "chunk": "diff --git a/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java b/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java\nindex 9ede5c9de..3346fba8f 100644\n--- a/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java\n+++ b/com.sap.cloud.lm.sl.cf.process/src/main/java/com/sap/cloud/lm/sl/cf/process/util/EnvironmentApplicationAttributeUpdater.java\n\n@@ -28,9 +28,8 @@ public class EnvironmentApplicationAttributeUpdater extends ApplicationAttribute\n     }\n \n     private Map<String, String> applyUpdateStrategy(Map<String, String> existingEnv, Map<String, String> env) {\n-        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV, updateStrategy );\n-        Map<String, String> result = getElementUpdater().updateMap(existingEnv, env);\n-        return result;\n+        getLogger().debug(Messages.APPLYING_UPDATE_STRATEGY_0_TO_ENV, updateStrategy);\n+        return getElementUpdater().updateMap(existingEnv, env);\n     }\n \n }\n"}}, {"oid": "b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "message": "remove logging of app environment without masking", "committedDate": "2020-05-08T12:55:57Z", "type": "commit"}, {"oid": "b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "url": "https://github.com/cloudfoundry-incubator/multiapps-controller/commit/b534fa6a550f5d8dc2a227936bf973c7aa4ecbfa", "message": "remove logging of app environment without masking", "committedDate": "2020-05-08T12:55:57Z", "type": "forcePushed"}]}