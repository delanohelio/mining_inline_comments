{"pr_number": 4290, "pr_title": "[m2e] fix dependency management resolving", "pr_createdAt": "2020-09-03T12:42:16Z", "pr_url": "https://github.com/bndtools/bnd/pull/4290", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI3MjE3Ng==", "url": "https://github.com/bndtools/bnd/pull/4290#discussion_r483272176", "bodyText": "You don't need unchecked here since thenAccept allows an exception to be thrown.", "author": "bjhargrave", "createdAt": "2020-09-03T21:48:38Z", "path": "bndtools.m2e/src/bndtools/m2e/MavenWorkspaceRepository.java", "diffHunk": "@@ -130,8 +133,15 @@ public MavenWorkspaceRepository() {\n \n \t@Activate\n \tvoid activate() {\n-\t\tprocess();\n \t\tlist = memoize(this::list0);\n+\t\tpromiseFactory.submit(this::process)\n+\t\t\t.thenAccept(changed -> {\n+\t\t\t\tif (changed) {\n+\t\t\t\t\tlist = memoize(this::list0);\n+\t\t\t\t\tunchecked(() -> Central.refreshPlugins());", "originalCommit": "75ce28c37474dfbd8aff59d7394a7b50a679e461", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzNTcxNw==", "url": "https://github.com/bndtools/bnd/pull/4290#discussion_r483335717", "bodyText": "ah, good one. I missed that.", "author": "rotty3000", "createdAt": "2020-09-04T01:27:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI3MjE3Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMzNjcxMw==", "url": "https://github.com/bndtools/bnd/pull/4290#discussion_r483336713", "bodyText": "pushed", "author": "rotty3000", "createdAt": "2020-09-04T01:31:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzI3MjE3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "dc8da89224a17b3e12ba72dfb990e90d27e9a2ad", "chunk": "diff --git a/bndtools.m2e/src/bndtools/m2e/MavenWorkspaceRepository.java b/bndtools.m2e/src/bndtools/m2e/MavenWorkspaceRepository.java\nindex 3aa55162d..14c70aeda 100644\n--- a/bndtools.m2e/src/bndtools/m2e/MavenWorkspaceRepository.java\n+++ b/bndtools.m2e/src/bndtools/m2e/MavenWorkspaceRepository.java\n\n@@ -138,7 +138,7 @@ public class MavenWorkspaceRepository extends\n \t\t\t.thenAccept(changed -> {\n \t\t\t\tif (changed) {\n \t\t\t\t\tlist = memoize(this::list0);\n-\t\t\t\t\tunchecked(() -> Central.refreshPlugins());\n+\t\t\t\t\tCentral.refreshPlugins();\n \t\t\t\t}\n \t\t\t}\n \t\t);\n"}}, {"oid": "dc8da89224a17b3e12ba72dfb990e90d27e9a2ad", "url": "https://github.com/bndtools/bnd/commit/dc8da89224a17b3e12ba72dfb990e90d27e9a2ad", "message": "[m2e] fix dependency management resolving\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>", "committedDate": "2020-09-04T01:30:40Z", "type": "commit"}, {"oid": "dc8da89224a17b3e12ba72dfb990e90d27e9a2ad", "url": "https://github.com/bndtools/bnd/commit/dc8da89224a17b3e12ba72dfb990e90d27e9a2ad", "message": "[m2e] fix dependency management resolving\n\nSigned-off-by: Raymond Aug\u00e9 <raymond.auge@liferay.com>", "committedDate": "2020-09-04T01:30:40Z", "type": "forcePushed"}]}