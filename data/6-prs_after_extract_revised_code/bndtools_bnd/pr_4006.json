{"pr_number": 4006, "pr_title": "[generate] Minor fixes", "pr_createdAt": "2020-05-05T09:36:42Z", "pr_url": "https://github.com/bndtools/bnd/pull/4006", "timeline": [{"oid": "b6d1c3992274805dece7812f8c0499838459cb03", "url": "https://github.com/bndtools/bnd/commit/b6d1c3992274805dece7812f8c0499838459cb03", "message": "[generate] Minor fixes\n\n- Force now cleans all files\n- No check anymore\n- Method to clean and check if build is needed\n- Better error handling\n- bndgenerate marker does not inherit other bnd marker\n\nSigned-off-by: Peter Kriens <Peter.Kriens@aqute.biz>", "committedDate": "2020-05-05T09:35:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI0NTU2Ng==", "url": "https://github.com/bndtools/bnd/pull/4006#discussion_r420245566", "bodyText": "Did you mean to commit this println?", "author": "bjhargrave", "createdAt": "2020-05-05T16:33:21Z", "path": "bndtools.builder/src/org/bndtools/builder/BndSourceGenerateCompilationParticipant.java", "diffHunk": "@@ -16,26 +16,20 @@\n \tprivate static final ILogger\tlogger\t\t\t\t= Logger\n \t\t.getLogger(BndSourceGenerateCompilationParticipant.class);\n \tpublic static final String\t\tMARKER_BND_GENERATE\t= \"bndtools.builder.bndgenerate\";\n-\tprivate Project\t\t\t\t\tproject;\n \n \t@Override\n \tpublic boolean isActive(IJavaProject javaProject) {\n \t\ttry {\n \t\t\tMarkerSupport markers = new MarkerSupport(javaProject.getProject());\n-\t\t\tproject = Central.getProject(javaProject.getProject());\n+\t\t\tProject project = Central.getProject(javaProject.getProject());\n \t\t\tif (project == null)\n \t\t\t\treturn false;\n \n-\t\t\tResult<Set<File>, String> inputs = project.getGenerate()\n-\t\t\t\t.getInputs();\n-\t\t\tif (inputs.isErr()) {\n-\t\t\t\t// handle any errors\n-\t\t\t\t// in the aboutToBuild method\n-\t\t\t\treturn true;\n-\t\t\t}\n+\t\t\tboolean result = project.getGenerate()\n+\t\t\t\t.needsBuild();\n \n-\t\t\treturn !inputs.unwrap()\n-\t\t\t\t.isEmpty();\n+\t\t\tSystem.out.println(\"isActive \" + project + \" \" + result);", "originalCommit": "b6d1c3992274805dece7812f8c0499838459cb03", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI0NTY4MA==", "url": "https://github.com/bndtools/bnd/pull/4006#discussion_r420245680", "bodyText": "Did you mean to commit this println?", "author": "bjhargrave", "createdAt": "2020-05-05T16:33:28Z", "path": "bndtools.builder/src/org/bndtools/builder/BndSourceGenerateCompilationParticipant.java", "diffHunk": "@@ -45,11 +39,16 @@ public boolean isActive(IJavaProject javaProject) {\n \t@Override\n \tpublic int aboutToBuild(IJavaProject javaProject) {\n \t\ttry {\n+\t\t\tProject project = Central.getProject(javaProject.getProject());\n+\t\t\tif (project == null)\n+\t\t\t\treturn READY_FOR_BUILD;\n+\n+\t\t\tSystem.out.println(\"aboutToBuild \" + project);", "originalCommit": "b6d1c3992274805dece7812f8c0499838459cb03", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI1NjU4OA==", "url": "https://github.com/bndtools/bnd/pull/4006#discussion_r420256588", "bodyText": "nope, corrected", "author": "pkriens", "createdAt": "2020-05-05T16:49:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDI0NTY4MA=="}], "type": "inlineReview", "revised_code": null}]}