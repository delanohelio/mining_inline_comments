{"pr_number": 4376, "pr_title": "fix: Run was not closed after export in ProjectBuilder", "pr_createdAt": "2020-10-26T18:10:12Z", "pr_url": "https://github.com/bndtools/bnd/pull/4376", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjIwMzkwOA==", "url": "https://github.com/bndtools/bnd/pull/4376#discussion_r512203908", "bodyText": "Run is a Closeable, so use a try-with-resources statement here to close the Run.\ntry (Run run = Run.createRun(getProject().getWorkspace(), file)) {\n  ...\n}", "author": "bjhargrave", "createdAt": "2020-10-26T19:09:14Z", "path": "biz.aQute.bndlib/src/aQute/bnd/build/ProjectBuilder.java", "diffHunk": "@@ -670,18 +670,18 @@ public String toString() {\n \t\treturn runs;\n \t}\n \n-\tMap<File, Resource> doExports(Map<File, List<Attrs>> entries) {\n+\tMap<File, Resource> doExports(Map<File, List<Attrs>> entries) throws Exception {\n \t\tMap<File, Resource> result = new LinkedHashMap<>();\n \n \t\tfor (Entry<File, List<Attrs>> e : entries.entrySet()) {\n \n \t\t\tfor (Attrs attrs : e.getValue()) {\n \n \t\t\t\tFile file = e.getKey();\n+\t\t\t\tRun run = null;\n \t\t\t\ttry {\n \n-\t\t\t\t\tRun run = Run.createRun(getProject().getWorkspace(), file);\n-\n+\t\t\t\t\trun = Run.createRun(getProject().getWorkspace(), file);", "originalCommit": "6208e40d8eef4d005d09a9d672dba26faf3ddf6e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3c3b5efa25445d11630c3654fd87a7f5cdab8575", "chunk": "diff --git a/biz.aQute.bndlib/src/aQute/bnd/build/ProjectBuilder.java b/biz.aQute.bndlib/src/aQute/bnd/build/ProjectBuilder.java\nindex 61859246b..21dd12a52 100644\n--- a/biz.aQute.bndlib/src/aQute/bnd/build/ProjectBuilder.java\n+++ b/biz.aQute.bndlib/src/aQute/bnd/build/ProjectBuilder.java\n\n@@ -670,7 +670,7 @@ public class ProjectBuilder extends Builder {\n \t\treturn runs;\n \t}\n \n-\tMap<File, Resource> doExports(Map<File, List<Attrs>> entries) throws Exception {\n+\tMap<File, Resource> doExports(Map<File, List<Attrs>> entries) {\n \t\tMap<File, Resource> result = new LinkedHashMap<>();\n \n \t\tfor (Entry<File, List<Attrs>> e : entries.entrySet()) {\n"}}, {"oid": "3c3b5efa25445d11630c3654fd87a7f5cdab8575", "url": "https://github.com/bndtools/bnd/commit/3c3b5efa25445d11630c3654fd87a7f5cdab8575", "message": "fix: Run was not closed after export in ProjectBuilder\n\nSigned-off-by: Juergen Albert <j.albert@data-in-motion.biz>", "committedDate": "2020-10-27T09:02:15Z", "type": "commit"}, {"oid": "3c3b5efa25445d11630c3654fd87a7f5cdab8575", "url": "https://github.com/bndtools/bnd/commit/3c3b5efa25445d11630c3654fd87a7f5cdab8575", "message": "fix: Run was not closed after export in ProjectBuilder\n\nSigned-off-by: Juergen Albert <j.albert@data-in-motion.biz>", "committedDate": "2020-10-27T09:02:15Z", "type": "forcePushed"}]}