{"pr_number": 4842, "pr_title": "[Bug][SQL] Fix bug that query failed when SQL contains Union and Colocate join", "pr_createdAt": "2020-11-03T15:55:01Z", "pr_url": "https://github.com/apache/incubator-doris/pull/4842", "timeline": [{"oid": "406723e2dd5ba30a54ebb97b0c89a2a85adacba5", "url": "https://github.com/apache/incubator-doris/commit/406723e2dd5ba30a54ebb97b0c89a2a85adacba5", "message": "[Bug][SQL] Fix bug that query failed when SQL contains Union and Colocate Join.\n\nSQL like:\n`select a join b union select c join d`;\n\nif a b is colocate join, and c d is also colocate join, the query may failed\nwith error like:\n\n`failed to get tablet. tablet_id=26846, with schema_hash=398972982, reason=tablet does not exist`", "committedDate": "2020-11-03T15:45:01Z", "type": "commit"}, {"oid": "a7c33635bb324663d805c26311cab8bbf9a97af6", "url": "https://github.com/apache/incubator-doris/commit/a7c33635bb324663d805c26311cab8bbf9a97af6", "message": "fix ut", "committedDate": "2020-11-04T02:14:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyNzc5Mw==", "url": "https://github.com/apache/incubator-doris/pull/4842#discussion_r517127793", "bodyText": "Maybe bucketSeqToScanRang should be a map like fragmentIdToSeqToAddressMap to solve this problem is a\nbetter understanding  way\uff1f", "author": "HappenLee", "createdAt": "2020-11-04T06:50:50Z", "path": "fe/fe-core/src/main/java/org/apache/doris/qe/Coordinator.java", "diffHunk": "@@ -1140,17 +1141,26 @@ private long getScanRangeLength(final TScanRange scanRange) {\n \n     private void computeColocateJoinInstanceParam(PlanFragmentId fragmentId, int parallelExecInstanceNum, FragmentExecParams params) {\n         Map<Integer, TNetworkAddress> bucketSeqToAddress = fragmentIdToSeqToAddressMap.get(fragmentId);", "originalCommit": "a7c33635bb324663d805c26311cab8bbf9a97af6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODAyOTkxNg==", "url": "https://github.com/apache/incubator-doris/pull/4842#discussion_r518029916", "bodyText": "I will leave it when refactoring them.", "author": "morningman", "createdAt": "2020-11-05T12:56:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEyNzc5Mw=="}], "type": "inlineReview", "revised_code": null}]}