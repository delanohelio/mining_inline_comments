{"pr_number": 3096, "pr_title": "Rewrite count distinct to bitmap hll", "pr_createdAt": "2020-03-12T13:30:04Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3096", "timeline": [{"oid": "8775f82106acb539e6976c860572f163e014aebe", "url": "https://github.com/apache/incubator-doris/commit/8775f82106acb539e6976c860572f163e014aebe", "message": "Rewrite count distinct to bitmap hll", "committedDate": "2020-03-12T13:22:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0MjkzMQ==", "url": "https://github.com/apache/incubator-doris/pull/3096#discussion_r391642931", "bodyText": "Add a document?", "author": "imay", "createdAt": "2020-03-12T14:04:40Z", "path": "fe/src/main/java/org/apache/doris/qe/SessionVariable.java", "diffHunk": "@@ -91,6 +91,7 @@\n     public static final String DEFAULT_ROWSET_TYPE = \"default_rowset_type\";\n     public static final String USE_V2_ROLLUP = \"use_v2_rollup\";\n     public static final String TEST_MATERIALIZED_VIEW = \"test_materialized_view\";\n+    public static final String REWRITE_COUNT_DISTINCT_TO_BITMAP_HLL = \"rewrite_count_distinct_to_bitmap_hll\";", "originalCommit": "8775f82106acb539e6976c860572f163e014aebe", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0NTYwOA==", "url": "https://github.com/apache/incubator-doris/pull/3096#discussion_r391645608", "bodyText": "isCountDistinctSet?", "author": "imay", "createdAt": "2020-03-12T14:08:36Z", "path": "fe/src/main/java/org/apache/doris/analysis/FunctionCallExpr.java", "diffHunk": "@@ -249,6 +249,23 @@ public boolean isCountStar() {\n         return false;\n     }\n \n+    public boolean needRewriteCountDistinct() {", "originalCommit": "8775f82106acb539e6976c860572f163e014aebe", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b6228c10ce67629bb3050a618ab529702194dd1e", "chunk": "diff --git a/fe/src/main/java/org/apache/doris/analysis/FunctionCallExpr.java b/fe/src/main/java/org/apache/doris/analysis/FunctionCallExpr.java\nindex ae1c9b68a..437a2a67e 100644\n--- a/fe/src/main/java/org/apache/doris/analysis/FunctionCallExpr.java\n+++ b/fe/src/main/java/org/apache/doris/analysis/FunctionCallExpr.java\n\n@@ -249,7 +249,7 @@ public class FunctionCallExpr extends Expr {\n         return false;\n     }\n \n-    public boolean needRewriteCountDistinct() {\n+    public boolean isCountDistinctBitmapOrHLL() {\n         if (!fnParams.isDistinct()) {\n             return false;\n         }\n"}}, {"oid": "b6228c10ce67629bb3050a618ab529702194dd1e", "url": "https://github.com/apache/incubator-doris/commit/b6228c10ce67629bb3050a618ab529702194dd1e", "message": "Update for comment", "committedDate": "2020-03-12T14:34:18Z", "type": "commit"}, {"oid": "8c342a557f210c6cf37a05239e1749cadebef0e1", "url": "https://github.com/apache/incubator-doris/commit/8c342a557f210c6cf37a05239e1749cadebef0e1", "message": "Fix FE UT", "committedDate": "2020-03-13T02:11:33Z", "type": "commit"}]}