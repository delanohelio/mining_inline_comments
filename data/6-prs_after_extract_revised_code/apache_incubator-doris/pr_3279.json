{"pr_number": 3279, "pr_title": "[BUG] Fix cast result expr bug", "pr_createdAt": "2020-04-08T08:00:27Z", "pr_url": "https://github.com/apache/incubator-doris/pull/3279", "timeline": [{"oid": "1169bdbb13bc7f5ebde9dd8e73d361de8ca82bab", "url": "https://github.com/apache/incubator-doris/commit/1169bdbb13bc7f5ebde9dd8e73d361de8ca82bab", "message": "fix cast result bug", "committedDate": "2020-04-08T07:00:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwNTM5OA==", "url": "https://github.com/apache/incubator-doris/pull/3279#discussion_r405505398", "bodyText": "Please add a detailed comment here to explain the problem. Specific examples can be used.", "author": "morningman", "createdAt": "2020-04-08T13:00:45Z", "path": "fe/src/main/java/org/apache/doris/analysis/StatementBase.java", "diffHunk": "@@ -124,6 +124,9 @@ public void castResultExprs(List<Type> types) throws AnalysisException {\n         Preconditions.checkNotNull(resultExprs);\n         Preconditions.checkState(resultExprs.size() == types.size());\n         for (int i = 0; i < types.size(); ++i) {\n+            if (resultExprs.get(i).getType().isDateType() && types.get(i).isDateType()) {", "originalCommit": "1169bdbb13bc7f5ebde9dd8e73d361de8ca82bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUxMDc4OQ==", "url": "https://github.com/apache/incubator-doris/pull/3279#discussion_r405510789", "bodyText": "OK", "author": "HangyuanLiu", "createdAt": "2020-04-08T13:08:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUwNTM5OA=="}], "type": "inlineReview", "revised_code": {"commit": "1cf84ca4445cffb9d0f91fe3f04804f2e80abd31", "chunk": "diff --git a/fe/src/main/java/org/apache/doris/analysis/StatementBase.java b/fe/src/main/java/org/apache/doris/analysis/StatementBase.java\nindex 166f7b0d1..74100283f 100644\n--- a/fe/src/main/java/org/apache/doris/analysis/StatementBase.java\n+++ b/fe/src/main/java/org/apache/doris/analysis/StatementBase.java\n\n@@ -124,6 +124,9 @@ public abstract class StatementBase implements ParseNode {\n         Preconditions.checkNotNull(resultExprs);\n         Preconditions.checkState(resultExprs.size() == types.size());\n         for (int i = 0; i < types.size(); ++i) {\n+            //The specific type of the date type is determined by the \n+            //actual type of the return value, not by the function return value type in FE Function\n+            //such as the result of str_to_date may be either DATE or DATETIME\n             if (resultExprs.get(i).getType().isDateType() && types.get(i).isDateType()) {\n                 continue;                               \n             }\n"}}, {"oid": "1cf84ca4445cffb9d0f91fe3f04804f2e80abd31", "url": "https://github.com/apache/incubator-doris/commit/1cf84ca4445cffb9d0f91fe3f04804f2e80abd31", "message": "add comment", "committedDate": "2020-04-09T08:01:15Z", "type": "commit"}]}