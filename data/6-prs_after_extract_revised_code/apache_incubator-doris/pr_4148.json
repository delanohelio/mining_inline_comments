{"pr_number": 4148, "pr_title": "[Bug][TabletRepair] Fix bug that too many replicas generated when decommission BE", "pr_createdAt": "2020-07-22T15:49:08Z", "pr_url": "https://github.com/apache/incubator-doris/pull/4148", "timeline": [{"oid": "ee2ad8b7ec20eac5b7872555290708bf54c6667c", "url": "https://github.com/apache/incubator-doris/commit/ee2ad8b7ec20eac5b7872555290708bf54c6667c", "message": "[Bug][TabletRepair] Fix bug that too many replicas generated when decommission BE\n\nTry to select the BE with an existing replicas as the destination BE for\nREPLICA_RELOCATING clone task.", "committedDate": "2020-07-23T14:15:12Z", "type": "forcePushed"}, {"oid": "3fc294dbef8bce084552d12c6974d7525c529998", "url": "https://github.com/apache/incubator-doris/commit/3fc294dbef8bce084552d12c6974d7525c529998", "message": "[Bug][TabletRepair] Fix bug that too many replicas generated when decommission BE\n\nTry to select the BE with an existing replicas as the destination BE for\nREPLICA_RELOCATING clone task.", "committedDate": "2020-07-29T08:38:00Z", "type": "commit"}, {"oid": "2c8a3a064942d528f72eb20704de996c30f05842", "url": "https://github.com/apache/incubator-doris/commit/2c8a3a064942d528f72eb20704de996c30f05842", "message": "Release slot before schedule again", "committedDate": "2020-07-29T08:43:03Z", "type": "commit"}, {"oid": "2c8a3a064942d528f72eb20704de996c30f05842", "url": "https://github.com/apache/incubator-doris/commit/2c8a3a064942d528f72eb20704de996c30f05842", "message": "Release slot before schedule again", "committedDate": "2020-07-29T08:43:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjEzOTM3Mg==", "url": "https://github.com/apache/incubator-doris/pull/4148#discussion_r462139372", "bodyText": "For reviewer:\nIn the original design logic, when the status of a replica is bad, it cannot become not bad again.\nThis is a clerical error and will cause the admin set replica status function to fail.", "author": "morningman", "createdAt": "2020-07-29T08:46:03Z", "path": "fe/fe-core/src/main/java/org/apache/doris/master/ReportHandler.java", "diffHunk": "@@ -481,7 +481,6 @@ private static void sync(Map<Long, TTablet> backendTablets, ListMultimap<Long, L\n                             // 1. PUSH finished in BE but failed or not yet report to FE\n                             // 2. repair for VERSION_INCOMPLETE finished in BE, but failed or not yet report to FE\n                             replica.updateVersionInfo(backendVersion, backendVersionHash, dataSize, rowCount);\n-                            replica.setBad(false);", "originalCommit": "2c8a3a064942d528f72eb20704de996c30f05842", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}