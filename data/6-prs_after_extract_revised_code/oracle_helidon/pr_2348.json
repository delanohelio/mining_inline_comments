{"pr_number": 2348, "pr_title": "Implementation of MP FT 2.1.1 using FT SE", "pr_createdAt": "2020-09-09T17:47:27Z", "pr_url": "https://github.com/oracle/helidon/pull/2348", "timeline": [{"oid": "2a32348fb6a7986c8fbac869827584d31e98040f", "url": "https://github.com/oracle/helidon/commit/2a32348fb6a7986c8fbac869827584d31e98040f", "message": "Initial prototype with basic support for fallback, retry and asynchronous. Passing unit tests FallbackTest, RetryTest and AsynchronousTest.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-08T18:30:31Z", "type": "commit"}, {"oid": "6b6fd9bc8d5802dba0750b97661b8134a1027673", "url": "https://github.com/oracle/helidon/commit/6b6fd9bc8d5802dba0750b97661b8134a1027673", "message": "Allow conversion to CompletionStage with completeWithoutValue flag.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-09T18:58:35Z", "type": "commit"}, {"oid": "66c46158f30f20b61a74f618bfda590aaf6119d3", "url": "https://github.com/oracle/helidon/commit/66c46158f30f20b61a74f618bfda590aaf6119d3", "message": "Create Single's with nullMeansEmpty flag to handle void methods. Modified ErrorChecker to use subtyping instead of equality when comparing exceptions.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-09T19:03:38Z", "type": "commit"}, {"oid": "dcba7dc233f4055eff15d8ba2c411c7d5e52ce27", "url": "https://github.com/oracle/helidon/commit/dcba7dc233f4055eff15d8ba2c411c7d5e52ce27", "message": "Several improvements for circuit breakers. Handler creation for all FT annotations.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-09T19:06:39Z", "type": "commit"}, {"oid": "41214c8570a784120a0a32eda1bc4c7741075ffe", "url": "https://github.com/oracle/helidon/commit/41214c8570a784120a0a32eda1bc4c7741075ffe", "message": "Trying new implementation of timeout when running on same thread.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-10T19:54:53Z", "type": "commit"}, {"oid": "11280c9c050fb58a229d80a1b1ad03b8cdbc9e94", "url": "https://github.com/oracle/helidon/commit/11280c9c050fb58a229d80a1b1ad03b8cdbc9e94", "message": "Updates to CommandRunner and ThrowableMapper.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-10T19:56:30Z", "type": "commit"}, {"oid": "8792c04c1106f8f032ee82bddcee20fdf5f44efb", "url": "https://github.com/oracle/helidon/commit/8792c04c1106f8f032ee82bddcee20fdf5f44efb", "message": "Improvements to better support sync and async timeouts.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-16T16:55:07Z", "type": "commit"}, {"oid": "8621fa344761a4972d91fa4c8ed668ad8b4b2909", "url": "https://github.com/oracle/helidon/commit/8621fa344761a4972d91fa4c8ed668ad8b4b2909", "message": "Improved handling of exceptions in async calls.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-16T18:07:23Z", "type": "commit"}, {"oid": "afcb9d4ce9382da64e538d6e1c6970916bc0c0fd", "url": "https://github.com/oracle/helidon/commit/afcb9d4ce9382da64e538d6e1c6970916bc0c0fd", "message": "Threshold compared using greater-than instead of greater-or-equal.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-16T18:29:29Z", "type": "commit"}, {"oid": "c7d67aeffaa2b4ace5a30c1f9b443c53966e4292", "url": "https://github.com/oracle/helidon/commit/c7d67aeffaa2b4ace5a30c1f9b443c53966e4292", "message": "Changes in this commit:\n\n - Support for sync (no queues) in Bulkhead\n - Fixed validation in FallbackAntn\n - Fixes to CommandRunner async support\n - Some changes in unit tests while preserving coverage\n\n All unit tests for Timeout, Fallback, Retry, Asynchronous, Bulkhead and CircuitBreaker are passing.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-20T18:10:40Z", "type": "commit"}, {"oid": "6528030b68e8048d2cfac13ca93e7335abd1f4c6", "url": "https://github.com/oracle/helidon/commit/6528030b68e8048d2cfac13ca93e7335abd1f4c6", "message": "Changes in this commit:\n\n - Support for metrics for all primitives except bulkheads\n - Changes to SE Retry to count number of retries\n - Some test fixes\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-22T20:33:55Z", "type": "commit"}, {"oid": "0ba871ddc4455969afdaa9349f003997acee176c", "url": "https://github.com/oracle/helidon/commit/0ba871ddc4455969afdaa9349f003997acee176c", "message": "Changes in this commit:\n\n - New method in Bulkhead to return stats\n - Support for all metrics related to bulkheads\n - Some minor test changes\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-23T15:24:50Z", "type": "commit"}, {"oid": "1b9a62f9a0bfe2c802259aff60e24e069e1c741d", "url": "https://github.com/oracle/helidon/commit/1b9a62f9a0bfe2c802259aff60e24e069e1c741d", "message": "Bulkhead metrics improved.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-24T15:05:35Z", "type": "commit"}, {"oid": "d41445206b02730684e26f309078dc549df30af9", "url": "https://github.com/oracle/helidon/commit/d41445206b02730684e26f309078dc549df30af9", "message": "Removed all Hystrix and Failsafe code and dependencies.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-07-24T15:24:57Z", "type": "commit"}, {"oid": "c31b95fb932f205a4e43ae89b7b83408c223f69e", "url": "https://github.com/oracle/helidon/commit/c31b95fb932f205a4e43ae89b7b83408c223f69e", "message": "Upgraded to FT 2.1 API. Fixed checkstyle and copyright problems.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-04T15:20:08Z", "type": "commit"}, {"oid": "fe91cf3cca343b7c4d1a7b6a627ef56215c96450", "url": "https://github.com/oracle/helidon/commit/fe91cf3cca343b7c4d1a7b6a627ef56215c96450", "message": "Fixed used of duration units in Retry.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-04T19:48:04Z", "type": "commit"}, {"oid": "54ce27b618091aa1ed1e71f29178c7ff95dad12a", "url": "https://github.com/oracle/helidon/commit/54ce27b618091aa1ed1e71f29178c7ff95dad12a", "message": "Support for request scope propagation for CDI and Jersey. In the FT TCKs, only the CDI request scope is active. Temporarily disable annotation validation in CDI extension as this now causes TCKs to fail validation before running.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-05T14:57:57Z", "type": "commit"}, {"oid": "f6f17773512f9bfa20147a45ccf372e53c72e42b", "url": "https://github.com/oracle/helidon/commit/f6f17773512f9bfa20147a45ccf372e53c72e42b", "message": "Changes to ErrorChecker to implement MP semantics. First checks skipOn and then applyOn sets. Updates to some tests.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-05T17:32:18Z", "type": "commit"}, {"oid": "aeaec54f2d45e549be1fd5188aac6d9931470557", "url": "https://github.com/oracle/helidon/commit/aeaec54f2d45e549be1fd5188aac6d9931470557", "message": "Handle somewhat unusual case of synchronous method returning a CompletionStage<?>.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-05T19:05:59Z", "type": "commit"}, {"oid": "b0929b6c17d7a2ce5761fac85985a7cdebd205c6", "url": "https://github.com/oracle/helidon/commit/b0929b6c17d7a2ce5761fac85985a7cdebd205c6", "message": "Changes in this commit:\n\n - Handle timeouts when a method catches InterruptedException\n - Changes to SE FT to support some event listeners\n - Create handlers for each invocation while sharing those for Bulkheads and CircuitBreakers\n - Renamed CommandRunner to MethodInvoker\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-10T15:38:25Z", "type": "commit"}, {"oid": "e73962a99cfc6154b04e67d86ccdc3adce7ba13f", "url": "https://github.com/oracle/helidon/commit/e73962a99cfc6154b04e67d86ccdc3adce7ba13f", "message": "Handle TestNG before and after methods.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-11T21:01:33Z", "type": "commit"}, {"oid": "d1af56c57ee5b4b4f5f112169792a7dfade21f33", "url": "https://github.com/oracle/helidon/commit/d1af56c57ee5b4b4f5f112169792a7dfade21f33", "message": "Added toString() method to help debugging.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-11T21:02:30Z", "type": "commit"}, {"oid": "ef3f58521e17fc35eabbbf922f68ae3c69679f6f", "url": "https://github.com/oracle/helidon/commit/ef3f58521e17fc35eabbbf922f68ae3c69679f6f", "message": "Improved implementations of MethodInvoker and TimeoutImpl.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-11T21:04:09Z", "type": "commit"}, {"oid": "e00cbce7a75f629afe945e3365fd2d6618a91ebe", "url": "https://github.com/oracle/helidon/commit/e00cbce7a75f629afe945e3365fd2d6618a91ebe", "message": "Async methods cannot throw exceptions. Fixed return type.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-13T12:44:05Z", "type": "commit"}, {"oid": "b5abd22d37bede915e6bf1848f084cfc2fd6b2ba", "url": "https://github.com/oracle/helidon/commit/b5abd22d37bede915e6bf1848f084cfc2fd6b2ba", "message": "Use FT 2.1.1.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-13T12:50:12Z", "type": "commit"}, {"oid": "fbab4342aba7b0ae1e5fa79c18d68fac1bd4c641", "url": "https://github.com/oracle/helidon/commit/fbab4342aba7b0ae1e5fa79c18d68fac1bd4c641", "message": "New implementation for async that also simplifies the sync case.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-13T12:50:50Z", "type": "commit"}, {"oid": "2d55ff29a4fe0a42eef3047929753ead9fffa16e", "url": "https://github.com/oracle/helidon/commit/2d55ff29a4fe0a42eef3047929753ead9fffa16e", "message": "Renamed async to currentThread.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-13T13:11:01Z", "type": "commit"}, {"oid": "dba5c0711f287336f11b99c9a01963f9cd55dc35", "url": "https://github.com/oracle/helidon/commit/dba5c0711f287336f11b99c9a01963f9cd55dc35", "message": "Fixed returned types of async methods in tests.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-14T13:52:19Z", "type": "commit"}, {"oid": "56d0b00677ecf1301c2faa1149a418edb9a3c20e", "url": "https://github.com/oracle/helidon/commit/56d0b00677ecf1301c2faa1149a418edb9a3c20e", "message": "Enhanced support for asynchronous methods.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-14T13:53:34Z", "type": "commit"}, {"oid": "90e0b6fa9d5419b218036a7b4440165124904c75", "url": "https://github.com/oracle/helidon/commit/90e0b6fa9d5419b218036a7b4440165124904c75", "message": "Fixed regression in request scope support.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-14T18:55:24Z", "type": "commit"}, {"oid": "a59886bd2424dbdb3be9aa1e4df03691006cd7c2", "url": "https://github.com/oracle/helidon/commit/a59886bd2424dbdb3be9aa1e4df03691006cd7c2", "message": "Support for cancellation of Singles created from CompletableFutures and vice-versa.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-20T15:52:24Z", "type": "commit"}, {"oid": "0f41dee438ef53d8247f3c5753503521e9beaf3a", "url": "https://github.com/oracle/helidon/commit/0f41dee438ef53d8247f3c5753503521e9beaf3a", "message": "Support for cancellation of async tasks. Update ResultWindow opening condition to use '>' instead of '>=' for MP compatibility. Made some test changes.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-20T18:25:31Z", "type": "commit"}, {"oid": "a13e077a5872438a1c240d4777c7b93c6a837968", "url": "https://github.com/oracle/helidon/commit/a13e077a5872438a1c240d4777c7b93c6a837968", "message": "Use CompletableFuture instead of Future whenever possible. CircuitBreaker's opening window condition.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-20T18:27:04Z", "type": "commit"}, {"oid": "c37a25a460481c11a72f63efa6b040e76721ad99", "url": "https://github.com/oracle/helidon/commit/c37a25a460481c11a72f63efa6b040e76721ad99", "message": "Config property to disable caching of MethodState's. New logic to support task cancellations.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-20T18:48:58Z", "type": "commit"}, {"oid": "6b5de792582c102038df5cdf9a44d509fac6a78d", "url": "https://github.com/oracle/helidon/commit/6b5de792582c102038df5cdf9a44d509fac6a78d", "message": "Handle multiple applications with different CCL as required by the TCKs.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-26T14:47:18Z", "type": "commit"}, {"oid": "164cc77385f7062b8b878be2c59fa9a7e24b41bf", "url": "https://github.com/oracle/helidon/commit/164cc77385f7062b8b878be2c59fa9a7e24b41bf", "message": "Map exception types in applyOn and failOn from MP to SE. This is necessary for proper semantics of breakers, retry and bulkheads, and their combinations.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-08-31T18:36:49Z", "type": "commit"}, {"oid": "c2dd907a795e1b04058156ce70b0c7fab1401508", "url": "https://github.com/oracle/helidon/commit/c2dd907a795e1b04058156ce70b0c7fab1401508", "message": "Re-organized FT handlers to run the timeout handler first.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-01T17:45:47Z", "type": "commit"}, {"oid": "073e67791501de119830d01640803e4eec544411", "url": "https://github.com/oracle/helidon/commit/073e67791501de119830d01640803e4eec544411", "message": "Updated semantics for circuit breakers. Thresholds are checked after collecting more results than the window size. Several TCK tests were failing due to incorrect semantics. Some tests have been updated.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-01T17:47:48Z", "type": "commit"}, {"oid": "49abf122f83de8e1b8fee808a1d28c706296b2d3", "url": "https://github.com/oracle/helidon/commit/49abf122f83de8e1b8fee808a1d28c706296b2d3", "message": "Restored validation of FT annotations.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-01T18:26:00Z", "type": "commit"}, {"oid": "b22da5326cfc6045aa4c538875b6c1c1b71bb0e7", "url": "https://github.com/oracle/helidon/commit/b22da5326cfc6045aa4c538875b6c1c1b71bb0e7", "message": "Fixed problems with fallback and breaker metrics.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-01T19:21:07Z", "type": "commit"}, {"oid": "5449921aaa04ec94d6d66ec776211171aa56ea6e", "url": "https://github.com/oracle/helidon/commit/5449921aaa04ec94d6d66ec776211171aa56ea6e", "message": "Bulkhead histograms should only be registered for async methods. Entries should only be recorded for scheduled tasks.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-02T13:44:40Z", "type": "commit"}, {"oid": "d1644aaa83f2205a1ace5d3e6bdf01e11932cd3a", "url": "https://github.com/oracle/helidon/commit/d1644aaa83f2205a1ace5d3e6bdf01e11932cd3a", "message": "New class to use as key into the method states map. Key must include class loader (TCKs), class (method inheritance) and method. The class is necessary since the same method can be inherited by multiple classes with different annotations.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-02T15:01:55Z", "type": "commit"}, {"oid": "02f1191b73d4589520bc2bb7046426e219af8def", "url": "https://github.com/oracle/helidon/commit/02f1191b73d4589520bc2bb7046426e219af8def", "message": "Use executor from FT SE after adjusting core sizes. Set queue to 0 for sync bulkheads.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-03T13:36:15Z", "type": "commit"}, {"oid": "d857591290ad6d5a05a7957f051be5fb8e6e7186", "url": "https://github.com/oracle/helidon/commit/d857591290ad6d5a05a7957f051be5fb8e6e7186", "message": "Switched composition of handlers for bulkhead and circuit breakers.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-03T13:50:02Z", "type": "commit"}, {"oid": "182575c2d13b64331cbca4c13a4e0433124a7f98", "url": "https://github.com/oracle/helidon/commit/182575c2d13b64331cbca4c13a4e0433124a7f98", "message": "Ensure proper access to context class loader to access application's config while running the TCKs.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-03T15:58:27Z", "type": "commit"}, {"oid": "cc51f55f34e1c645ff0a4ef8bbd27536318b53a6", "url": "https://github.com/oracle/helidon/commit/cc51f55f34e1c645ff0a4ef8bbd27536318b53a6", "message": "Invert timeout and bulkhead handlers. Timeouts also apply to tasks waiting in bulkhead queue.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-08T19:12:42Z", "type": "commit"}, {"oid": "b9830c16a767c0ed9eeedbe490462f65c5b60ae6", "url": "https://github.com/oracle/helidon/commit/b9830c16a767c0ed9eeedbe490462f65c5b60ae6", "message": "On timeout also cancel source single.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-08T19:13:21Z", "type": "commit"}, {"oid": "c943a24d1962df292356fde0332d8aca7df39cf9", "url": "https://github.com/oracle/helidon/commit/c943a24d1962df292356fde0332d8aca7df39cf9", "message": "New instance of SingleNever for every invocation. It is otherwise possible for an old timeout to interrupt a new invocation on same thread.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-08T19:14:22Z", "type": "commit"}, {"oid": "b51b46c9a997562d12250c2e9a60299f49b6f842", "url": "https://github.com/oracle/helidon/commit/b51b46c9a997562d12250c2e9a60299f49b6f842", "message": "Clean up tck-suite file.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-08T19:15:59Z", "type": "commit"}, {"oid": "8f502f888322eccf3c93968e328dfcde75f35f10", "url": "https://github.com/oracle/helidon/commit/8f502f888322eccf3c93968e328dfcde75f35f10", "message": "Fixed copyright and checkstyle issues.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-08T19:34:39Z", "type": "commit"}, {"oid": "be53ab9364bfa4b314b2b89ddb9bf6c7567b3bbf", "url": "https://github.com/oracle/helidon/commit/be53ab9364bfa4b314b2b89ddb9bf6c7567b3bbf", "message": "Merge branch 'master' into ft-2.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-08T20:12:16Z", "type": "commit"}, {"oid": "c79c1f9e8a3f5cf39f3f917f87418ed1c4089c4d", "url": "https://github.com/oracle/helidon/commit/c79c1f9e8a3f5cf39f3f917f87418ed1c4089c4d", "message": "Revert \"On timeout also cancel source single.\"\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T15:03:42Z", "type": "commit"}, {"oid": "b72ecc0a3ffa5d9c245ccb00ab7841c1d123e021", "url": "https://github.com/oracle/helidon/commit/b72ecc0a3ffa5d9c245ccb00ab7841c1d123e021", "message": "Make sure source is cancelled when multi is cancelled.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T15:05:06Z", "type": "commit"}, {"oid": "0a0e151fd7c3561807fbeac5a431cfed1f8035e0", "url": "https://github.com/oracle/helidon/commit/0a0e151fd7c3561807fbeac5a431cfed1f8035e0", "message": "Remove old files.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T15:38:54Z", "type": "commit"}, {"oid": "cfd6fe7f06984982198778fefd56d0eb86dbef31", "url": "https://github.com/oracle/helidon/commit/cfd6fe7f06984982198778fefd56d0eb86dbef31", "message": "Async flag is no longer needed.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T17:18:56Z", "type": "commit"}, {"oid": "7de6fbcf64080dbba1c19338e4c953fb6740fe44", "url": "https://github.com/oracle/helidon/commit/7de6fbcf64080dbba1c19338e4c953fb6740fe44", "message": "Updated comment.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T17:20:22Z", "type": "commit"}, {"oid": "668d11485840f515b63cd773f1b72cdf4902d37b", "url": "https://github.com/oracle/helidon/commit/668d11485840f515b63cd773f1b72cdf4902d37b", "message": "Removed unused listener support.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T17:24:46Z", "type": "commit"}, {"oid": "f0c6cef9730689637b4908cd0e716d5b66eb61c7", "url": "https://github.com/oracle/helidon/commit/f0c6cef9730689637b4908cd0e716d5b66eb61c7", "message": "More cleanup of unused flags.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T17:38:12Z", "type": "commit"}, {"oid": "8b7467ff0011d78f12d38378fc1ceed578e5cd54", "url": "https://github.com/oracle/helidon/commit/8b7467ff0011d78f12d38378fc1ceed578e5cd54", "message": "Fixed checkstyle errors.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T17:55:08Z", "type": "commit"}, {"oid": "5ac8cccb7875594fdff38794fd7e5c988cf1a0a6", "url": "https://github.com/oracle/helidon/commit/5ac8cccb7875594fdff38794fd7e5c988cf1a0a6", "message": "Fixed Javadoc.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T18:05:09Z", "type": "commit"}, {"oid": "960897d70c820f58cd1cbebab23c9eacb35ebcc6", "url": "https://github.com/oracle/helidon/commit/960897d70c820f58cd1cbebab23c9eacb35ebcc6", "message": "Copyright year.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T18:38:50Z", "type": "commit"}, {"oid": "37cef9422029e5d82a53192d02e951f1159c5f77", "url": "https://github.com/oracle/helidon/commit/37cef9422029e5d82a53192d02e951f1159c5f77", "message": "Adjusted breaker window and error ratio based on latest changes.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-09T21:00:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE0NjgxMA==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486146810", "bodyText": "This looks like duplication of CompletableFuture.supplyAsync internals, is there some AsyncTask's feature I missed @tomas-langer, or we can simplify?\n    public <T> Single<T> invoke(Supplier<T> supplier) {\n        try {\n            return Single.create(CompletableFuture.supplyAsync(task, executor.get()), true);\n        } catch (Throwable e) {\n            // rejected execution and other executor related issues\n            return Single.error(e);\n        }\n    }", "author": "danielkec", "createdAt": "2020-09-10T08:08:00Z", "path": "fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java", "diffHunk": "@@ -35,14 +36,17 @@\n         CompletableFuture<T> future = new CompletableFuture<>();\n         AsyncTask<T> task = new AsyncTask<>(supplier, future);\n \n+        Future<?> taskFuture;\n         try {\n-            executor.get().submit(task);\n+            taskFuture = executor.get().submit(task);\n         } catch (Throwable e) {\n             // rejected execution and other executor related issues\n             return Single.error(e);\n         }\n \n-        return Single.create(future);\n+        Single<T> single = Single.create(future, true);\n+        single.onCancel(() -> taskFuture.cancel(false));     // cancel task\n+        return single;", "originalCommit": "37cef9422029e5d82a53192d02e951f1159c5f77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMxNTIyOQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486315229", "bodyText": "Maybe, but not sure it is more readable tbh", "author": "spericas", "createdAt": "2020-09-10T12:59:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE0NjgxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM5MDQ0Ng==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486390446", "bodyText": "Code has changed now, see below", "author": "spericas", "createdAt": "2020-09-10T14:29:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE0NjgxMA=="}], "type": "inlineReview", "revised_code": {"commit": "06f3669d8c4262fd255f8333ce3924c08595fc11", "chunk": "diff --git a/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java b/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java\nindex dc341aa18..57b30ea4b 100644\n--- a/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java\n+++ b/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java\n\n@@ -45,8 +45,7 @@ class AsyncImpl implements Async {\n         }\n \n         Single<T> single = Single.create(future, true);\n-        single.onCancel(() -> taskFuture.cancel(false));     // cancel task\n-        return single;\n+        return single.onCancel(() -> taskFuture.cancel(false));     // cancel task\n     }\n \n     private static class AsyncTask<T> implements Runnable {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE1OTU1NQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486159555", "bodyText": "anyMatch could save few cycles", "author": "danielkec", "createdAt": "2020-09-10T08:28:54Z", "path": "fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java", "diffHunk": "@@ -22,25 +22,21 @@\n interface ErrorChecker {\n     boolean shouldSkip(Throwable throwable);\n \n+    /**\n+     * Returns ErrorChecker that skips if throwable is in skipOnSet or if applyOnSet\n+     * is not empty and throwable is not in it. Note that if applyOnSet is empty, then\n+     * it is equivalent to it containing {@code Throwable.class}.\n+     *\n+     * @param skipOnSet set of throwables to skip logic on.\n+     * @param applyOnSet set of throwables to apply logic on.\n+     * @return An error checker.\n+     */\n     static ErrorChecker create(Set<Class<? extends Throwable>> skipOnSet, Set<Class<? extends Throwable>> applyOnSet) {\n-        Set<Class<? extends Throwable>> skipOn = Set.copyOf(skipOnSet);\n-        Set<Class<? extends Throwable>> applyOn = Set.copyOf(applyOnSet);\n-\n-        if (skipOn.isEmpty()) {\n-            if (applyOn.isEmpty()) {\n-                return throwable -> false;\n-            } else {\n-                return throwable -> !applyOn.contains(throwable.getClass());\n-            }\n-        } else {\n-            if (applyOn.isEmpty()) {\n-                return throwable -> skipOn.contains(throwable.getClass());\n-            } else {\n-                throw new IllegalArgumentException(\"You have defined both skip and apply set of exception classes. \"\n-                                                           + \"This cannot be correctly handled; skipOn: \" + skipOn\n-                                                           + \" applyOn: \" + applyOn);\n-            }\n+        return throwable -> containsThrowable(skipOnSet, throwable)\n+                || !applyOnSet.isEmpty() && !containsThrowable(applyOnSet, throwable);\n+    }\n \n-        }\n+    private static boolean containsThrowable(Set<Class<? extends Throwable>> set, Throwable throwable) {\n+        return set.stream().filter(t -> t.isAssignableFrom(throwable.getClass())).count() > 0;", "originalCommit": "37cef9422029e5d82a53192d02e951f1159c5f77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMxNDg1Mw==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486314853", "bodyText": "Good point", "author": "spericas", "createdAt": "2020-09-10T12:58:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjE1OTU1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "06f3669d8c4262fd255f8333ce3924c08595fc11", "chunk": "diff --git a/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java b/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java\nindex 0fcc4abd1..b012308cd 100644\n--- a/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java\n+++ b/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java\n\n@@ -37,6 +37,6 @@ interface ErrorChecker {\n     }\n \n     private static boolean containsThrowable(Set<Class<? extends Throwable>> set, Throwable throwable) {\n-        return set.stream().filter(t -> t.isAssignableFrom(throwable.getClass())).count() > 0;\n+        return set.stream().anyMatch(t -> t.isAssignableFrom(throwable.getClass()));\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMyMjU4Mg==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486322582", "bodyText": "This doesn't look right. I think Single operators are still immutable and create a new instance, thus returing single will not have the cancel operation. You'd probably want return single.onCancel(() -> taskFuture.cancel(true));.", "author": "akarnokd", "createdAt": "2020-09-10T13:10:09Z", "path": "fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java", "diffHunk": "@@ -35,14 +36,17 @@\n         CompletableFuture<T> future = new CompletableFuture<>();\n         AsyncTask<T> task = new AsyncTask<>(supplier, future);\n \n+        Future<?> taskFuture;\n         try {\n-            executor.get().submit(task);\n+            taskFuture = executor.get().submit(task);\n         } catch (Throwable e) {\n             // rejected execution and other executor related issues\n             return Single.error(e);\n         }\n \n-        return Single.create(future);\n+        Single<T> single = Single.create(future, true);\n+        single.onCancel(() -> taskFuture.cancel(false));     // cancel task", "originalCommit": "37cef9422029e5d82a53192d02e951f1159c5f77", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM4OTg4Ng==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486389886", "bodyText": "I discussed this with @danielkec. Code works because of how we interact with Future but returning the Single from onCancel is the correct way. Fixed.", "author": "spericas", "createdAt": "2020-09-10T14:29:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMyMjU4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "06f3669d8c4262fd255f8333ce3924c08595fc11", "chunk": "diff --git a/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java b/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java\nindex dc341aa18..57b30ea4b 100644\n--- a/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java\n+++ b/fault-tolerance/src/main/java/io/helidon/faulttolerance/AsyncImpl.java\n\n@@ -45,8 +45,7 @@ class AsyncImpl implements Async {\n         }\n \n         Single<T> single = Single.create(future, true);\n-        single.onCancel(() -> taskFuture.cancel(false));     // cancel task\n-        return single;\n+        return single.onCancel(() -> taskFuture.cancel(false));     // cancel task\n     }\n \n     private static class AsyncTask<T> implements Runnable {\n"}}, {"oid": "06f3669d8c4262fd255f8333ce3924c08595fc11", "url": "https://github.com/oracle/helidon/commit/06f3669d8c4262fd255f8333ce3924c08595fc11", "message": "Use Single returned from onCancel. Minor optimization.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-10T14:27:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM5NTkzNQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486395935", "bodyText": "There is a reason for copying the sets - this method is called from a builder, which has mutable properties. This should work only on the data at the point the method was called and should ignore future mutation of these sets.", "author": "tomas-langer", "createdAt": "2020-09-10T14:36:53Z", "path": "fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java", "diffHunk": "@@ -22,25 +22,21 @@\n interface ErrorChecker {\n     boolean shouldSkip(Throwable throwable);\n \n+    /**\n+     * Returns ErrorChecker that skips if throwable is in skipOnSet or if applyOnSet\n+     * is not empty and throwable is not in it. Note that if applyOnSet is empty, then\n+     * it is equivalent to it containing {@code Throwable.class}.\n+     *\n+     * @param skipOnSet set of throwables to skip logic on.\n+     * @param applyOnSet set of throwables to apply logic on.\n+     * @return An error checker.\n+     */\n     static ErrorChecker create(Set<Class<? extends Throwable>> skipOnSet, Set<Class<? extends Throwable>> applyOnSet) {\n-        Set<Class<? extends Throwable>> skipOn = Set.copyOf(skipOnSet);\n-        Set<Class<? extends Throwable>> applyOn = Set.copyOf(applyOnSet);\n-\n-        if (skipOn.isEmpty()) {\n-            if (applyOn.isEmpty()) {\n-                return throwable -> false;\n-            } else {\n-                return throwable -> !applyOn.contains(throwable.getClass());\n-            }\n-        } else {\n-            if (applyOn.isEmpty()) {\n-                return throwable -> skipOn.contains(throwable.getClass());\n-            } else {\n-                throw new IllegalArgumentException(\"You have defined both skip and apply set of exception classes. \"\n-                                                           + \"This cannot be correctly handled; skipOn: \" + skipOn\n-                                                           + \" applyOn: \" + applyOn);\n-            }\n+        return throwable -> containsThrowable(skipOnSet, throwable)", "originalCommit": "06f3669d8c4262fd255f8333ce3924c08595fc11", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjQwODg2OQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r486408869", "bodyText": "Make sense, will fix", "author": "spericas", "createdAt": "2020-09-10T14:53:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjM5NTkzNQ=="}], "type": "inlineReview", "revised_code": {"commit": "b6d2e917df5ab314a37d264d588e342730d50475", "chunk": "diff --git a/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java b/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java\nindex b012308cd..bae585ea7 100644\n--- a/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java\n+++ b/fault-tolerance/src/main/java/io/helidon/faulttolerance/ErrorChecker.java\n\n@@ -25,15 +25,18 @@ interface ErrorChecker {\n     /**\n      * Returns ErrorChecker that skips if throwable is in skipOnSet or if applyOnSet\n      * is not empty and throwable is not in it. Note that if applyOnSet is empty, then\n-     * it is equivalent to it containing {@code Throwable.class}.\n+     * it is equivalent to it containing {@code Throwable.class}. Sets are copied\n+     * because they are mutable.\n      *\n      * @param skipOnSet set of throwables to skip logic on.\n      * @param applyOnSet set of throwables to apply logic on.\n      * @return An error checker.\n      */\n     static ErrorChecker create(Set<Class<? extends Throwable>> skipOnSet, Set<Class<? extends Throwable>> applyOnSet) {\n-        return throwable -> containsThrowable(skipOnSet, throwable)\n-                || !applyOnSet.isEmpty() && !containsThrowable(applyOnSet, throwable);\n+        Set<Class<? extends Throwable>> skipOn = Set.copyOf(skipOnSet);\n+        Set<Class<? extends Throwable>> applyOn = Set.copyOf(applyOnSet);\n+        return throwable -> containsThrowable(skipOn, throwable)\n+                || !applyOn.isEmpty() && !containsThrowable(applyOn, throwable);\n     }\n \n     private static boolean containsThrowable(Set<Class<? extends Throwable>> set, Throwable throwable) {\n"}}, {"oid": "b6d2e917df5ab314a37d264d588e342730d50475", "url": "https://github.com/oracle/helidon/commit/b6d2e917df5ab314a37d264d588e342730d50475", "message": "Make sure that tests are copied due to mutability.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-10T15:03:28Z", "type": "commit"}, {"oid": "24ba0472567a99d95cd7f6818851e0083e31286a", "url": "https://github.com/oracle/helidon/commit/24ba0472567a99d95cd7f6818851e0083e31286a", "message": "Merge branch 'master' into ft-2", "committedDate": "2020-09-10T19:19:55Z", "type": "commit"}, {"oid": "06b6c1ab426a61fbdbbb73229de8e6d8163387fd", "url": "https://github.com/oracle/helidon/commit/06b6c1ab426a61fbdbbb73229de8e6d8163387fd", "message": "Use latest version of SingleNever after merge with master.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-10T19:30:14Z", "type": "commit"}, {"oid": "a01426f5af3cf674aed2e72268d7bba3805b3256", "url": "https://github.com/oracle/helidon/commit/a01426f5af3cf674aed2e72268d7bba3805b3256", "message": "Removed unused import.\n\nSigned-off-by: Santiago Pericasgeertsen <santiago.pericasgeertsen@oracle.com>", "committedDate": "2020-09-10T19:41:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk0MTU0MQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r487941541", "bodyText": "What a chance \ud83d\ude42", "author": "danielkec", "createdAt": "2020-09-14T13:57:01Z", "path": "microprofile/fault-tolerance/src/test/java/io/helidon/microprofile/faulttolerance/TimeoutTest.java", "diffHunk": "@@ -79,7 +94,7 @@ public void testForceTimeoutLoop() {\n         try {\n             bean.forceTimeoutLoop();        // cannot interrupt\n         } catch (TimeoutException e) {\n-            assertThat(System.currentTimeMillis() - start, is(greaterThan(2000L)));\n+            assertThat(System.currentTimeMillis() - start, is(greaterThanOrEqualTo(2000L)));", "originalCommit": "a01426f5af3cf674aed2e72268d7bba3805b3256", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk0MjgzNQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r487942835", "bodyText": "Got me curious is there some rounding involved?", "author": "danielkec", "createdAt": "2020-09-14T13:58:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk0MTU0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk3MTU0MA==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r487971540", "bodyText": "No, but this is special case where the thread continues to run and cannot be interrupted (note that timeout is 1000). It hit 2000 at least once :)", "author": "spericas", "createdAt": "2020-09-14T14:22:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk0MTU0MQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk3MzQzMQ==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r487973431", "bodyText": "16 is the default right?", "author": "danielkec", "createdAt": "2020-09-14T14:24:58Z", "path": "microprofile/fault-tolerance/src/main/java/io/helidon/microprofile/faulttolerance/FaultToleranceExtension.java", "diffHunk": "@@ -260,6 +264,19 @@ void registerFaultToleranceMetrics(@Observes AfterDeploymentValidation validatio\n                 }\n             });\n         }\n+\n+        // Initialize executors for MP FT - default size of 16\n+        io.helidon.config.Config config = io.helidon.config.Config.create();\n+        FaultTolerance.scheduledExecutor(ScheduledThreadPoolSupplier.builder()\n+                .threadNamePrefix(\"ft-mp-schedule-\")\n+                .corePoolSize(16)", "originalCommit": "a01426f5af3cf674aed2e72268d7bba3805b3256", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk4NzMzMA==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r487987330", "bodyText": "I think so. But defaults can change and a smaller number will likely result in FT TCK failures.", "author": "spericas", "createdAt": "2020-09-14T14:42:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk3MzQzMQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODAxMjY3Mw==", "url": "https://github.com/oracle/helidon/pull/2348#discussion_r488012673", "bodyText": "validFts is always LinkedList, using descendingIterator would be nice", "author": "danielkec", "createdAt": "2020-09-14T15:14:53Z", "path": "fault-tolerance/src/main/java/io/helidon/faulttolerance/FaultTolerance.java", "diffHunk": "@@ -266,7 +276,17 @@ private FtHandlerTypedImpl(List<FtHandlerTyped<T>> validFts) {\n                     next = () -> validFt.invoke(finalNext);\n                 }\n \n-                return Single.create(next.get());\n+                return Single.create(next.get(), true);\n+            }\n+\n+            @Override\n+            public String toString() {\n+                StringBuilder sb = new StringBuilder();\n+                for (int i = validFts.size() - 1; i >= 0; i--) {\n+                    sb.append(validFts.get(i).toString());\n+                    sb.append(\"\\n\");\n+                }\n+                return sb.toString();", "originalCommit": "a01426f5af3cf674aed2e72268d7bba3805b3256", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}