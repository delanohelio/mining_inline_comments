{"pr_number": 1988, "pr_title": "MP native image no longer misses bean types for proxies.", "pr_createdAt": "2020-06-11T20:45:44Z", "pr_url": "https://github.com/oracle/helidon/pull/1988", "timeline": [{"oid": "1c5e1d8613caffb34d888fab19837615970027a2", "url": "https://github.com/oracle/helidon/commit/1c5e1d8613caffb34d888fab19837615970027a2", "message": "MP native image no longer misses bean types for proxies.\n\nSigned-off-by: Tomas Langer <tomas.langer@oracle.com>", "committedDate": "2020-06-11T20:44:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA5Mzg2Ng==", "url": "https://github.com/oracle/helidon/pull/1988#discussion_r439093866", "bodyText": "Depending on how proper you want to be, you may want to see if the bean is PassivationCapable and if so use the return value of its getId() method.", "author": "ljnelson", "createdAt": "2020-06-11T21:55:48Z", "path": "integrations/graal/mp-native-image-extension/src/main/java/io/helidon/integrations/graal/mp/nativeimage/extension/WeldFeature.java", "diffHunk": "@@ -168,11 +168,15 @@ private void initializeProxy(DuringSetupAccess access,\n \n     private void iterateBeans(BeanManagerImpl bm,\n                               ClientProxyProvider cpp,\n-                              Set<Class<?>> processed,\n+                              Set<BeanId> processed,\n                               Collection<Bean<?>> beans) {\n         for (Bean<?> bean : beans) {\n-            Class<?> clazz = bean.getBeanClass();\n-            if (!processed.add(clazz)) {\n+            Set<Type> beanTypes = bean.getTypes();\n+\n+            BeanId id = new BeanId(bean.getBeanClass(), beanTypes);", "originalCommit": "1c5e1d8613caffb34d888fab19837615970027a2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTExODIxMw==", "url": "https://github.com/oracle/helidon/pull/1988#discussion_r439118213", "bodyText": "I think we can live with a certain amount of improper, unless this would fail for some cases.", "author": "tomas-langer", "createdAt": "2020-06-11T23:07:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA5Mzg2Ng=="}], "type": "inlineReview", "revised_code": null}]}