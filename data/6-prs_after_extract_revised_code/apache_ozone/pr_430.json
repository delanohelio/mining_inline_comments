{"pr_number": 430, "pr_title": "HDDS-2817. Fix listing buckets for setting --prefix equal to bucket name", "pr_createdAt": "2020-01-10T06:17:09Z", "pr_url": "https://github.com/apache/ozone/pull/430", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MzkzNg==", "url": "https://github.com/apache/ozone/pull/430#discussion_r375983936", "bodyText": "Should this be volumeBBucketsPrefixWithOzoneOwner.add instead? Otherwise this line is the same as line 70, adding the same element to a set won't do anything. :)", "author": "smengcl", "createdAt": "2020-02-06T17:42:48Z", "path": "hadoop-ozone/ozone-manager/src/test/java/org/apache/hadoop/ozone/om/TestOmMetadataManager.java", "diffHunk": "@@ -83,7 +85,9 @@ public void testListBuckets() throws Exception {\n     TreeSet<String> volumeBBucketsPrefixWithOzoneOwner = new TreeSet<>();\n     TreeSet<String> volumeBBucketsPrefixWithHadoopOwner = new TreeSet<>();\n     TestOMRequestUtils.addVolumeToDB(volumeName2, omMetadataManager);\n-    for (int i=1; i<= 100; i++) {\n+    volumeABucketsPrefixWithOzoneOwner.add(prefixBucketNameWithOzoneOwner);", "originalCommit": "874571d3e8e3003dfff304a2d9d6aaa3ee185f62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTM2MDE2OA==", "url": "https://github.com/apache/ozone/pull/430#discussion_r389360168", "bodyText": "Thank you @smengcl for address this line.\nFixed.", "author": "cxorm", "createdAt": "2020-03-08T11:30:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTk4MzkzNg=="}], "type": "inlineReview", "revised_code": {"commit": "f7ebbee8b92b9e1b5bea8a38381dba1d996769ee", "chunk": "diff --git a/hadoop-ozone/ozone-manager/src/test/java/org/apache/hadoop/ozone/om/TestOmMetadataManager.java b/hadoop-ozone/ozone-manager/src/test/java/org/apache/hadoop/ozone/om/TestOmMetadataManager.java\nindex 6ab2afed9a..dc2187ccec 100644\n--- a/hadoop-ozone/ozone-manager/src/test/java/org/apache/hadoop/ozone/om/TestOmMetadataManager.java\n+++ b/hadoop-ozone/ozone-manager/src/test/java/org/apache/hadoop/ozone/om/TestOmMetadataManager.java\n\n@@ -85,9 +165,7 @@ public void testListBuckets() throws Exception {\n     TreeSet<String> volumeBBucketsPrefixWithOzoneOwner = new TreeSet<>();\n     TreeSet<String> volumeBBucketsPrefixWithHadoopOwner = new TreeSet<>();\n     TestOMRequestUtils.addVolumeToDB(volumeName2, omMetadataManager);\n-    volumeABucketsPrefixWithOzoneOwner.add(prefixBucketNameWithOzoneOwner);\n-    addBucketsToCache(volumeName2, prefixBucketNameWithOzoneOwner);\n-    for (int i = 1; i < 100; i++) {\n+    for (int i=1; i<= 100; i++) {\n       if (i % 2 == 0) {\n         volumeBBucketsPrefixWithOzoneOwner.add(\n             prefixBucketNameWithOzoneOwner + i);\n"}}, {"oid": "f7ebbee8b92b9e1b5bea8a38381dba1d996769ee", "url": "https://github.com/apache/ozone/commit/f7ebbee8b92b9e1b5bea8a38381dba1d996769ee", "message": "Fix --prefix bug", "committedDate": "2020-04-03T21:35:37Z", "type": "commit"}, {"oid": "054747665a2a02b62dba65939d91d23dd3053c5b", "url": "https://github.com/apache/ozone/commit/054747665a2a02b62dba65939d91d23dd3053c5b", "message": "Update UT", "committedDate": "2020-04-03T21:35:37Z", "type": "commit"}, {"oid": "34ac832e648bd3a36a02e14d9a977837d0e0d124", "url": "https://github.com/apache/ozone/commit/34ac832e648bd3a36a02e14d9a977837d0e0d124", "message": "Address comments", "committedDate": "2020-04-03T21:35:37Z", "type": "commit"}, {"oid": "a8160ca79ec4f875d62b091d803551b052cf61fd", "url": "https://github.com/apache/ozone/commit/a8160ca79ec4f875d62b091d803551b052cf61fd", "message": "fix comments", "committedDate": "2020-04-03T21:35:37Z", "type": "commit"}, {"oid": "a8160ca79ec4f875d62b091d803551b052cf61fd", "url": "https://github.com/apache/ozone/commit/a8160ca79ec4f875d62b091d803551b052cf61fd", "message": "fix comments", "committedDate": "2020-04-03T21:35:37Z", "type": "forcePushed"}]}