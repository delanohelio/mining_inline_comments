{"pr_number": 615, "pr_title": "HDDS-3085. OM Delta updates request in Recon should work with secure Ozone Manager.", "pr_createdAt": "2020-02-27T22:32:10Z", "pr_url": "https://github.com/apache/ozone/pull/615", "timeline": [{"oid": "48402dc87a18d86c0cb819ab7a1c3b80d0da4c1b", "url": "https://github.com/apache/ozone/commit/48402dc87a18d86c0cb819ab7a1c3b80d0da4c1b", "message": "OM Delta updates request in Recon should work with secure Ozone Manager.", "committedDate": "2020-02-27T22:23:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQyNTY2Ng==", "url": "https://github.com/apache/ozone/pull/615#discussion_r385425666", "bodyText": "Move this to org.apache.hadoop.hdds.recon.ReconConfigKeys#ReconConfigKeys since it will be needed by Datanodes as well.", "author": "avijayanhwx", "createdAt": "2020-02-27T23:15:46Z", "path": "hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServerConfigKeys.java", "diffHunk": "@@ -39,8 +39,12 @@\n       \"ozone.recon.http-address\";\n   public static final String OZONE_RECON_HTTPS_ADDRESS_KEY =\n       \"ozone.recon.https-address\";\n-  public static final String OZONE_RECON_KEYTAB_FILE =\n-      \"ozone.recon.keytab.file\";\n+  public static final String OZONE_RECON_HTTP_KEYTAB_FILE =\n+      \"ozone.recon.http.kerberos.keytab.file\";\n+  public static final String OZONE_RECON_KERBEROS_KEYTAB_FILE_KEY =\n+      \"ozone.recon.kerberos.keytab.file\";\n+  public static final String OZONE_RECON_KERBEROS_PRINCIPAL_KEY =", "originalCommit": "48402dc87a18d86c0cb819ab7a1c3b80d0da4c1b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "39fc1fd205e385a91a8f74eebf7c01ca35051930", "chunk": "diff --git a/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServerConfigKeys.java b/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServerConfigKeys.java\nindex 231ee9682..d91efe5e7 100644\n--- a/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServerConfigKeys.java\n+++ b/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServerConfigKeys.java\n\n@@ -41,10 +41,6 @@\n       \"ozone.recon.https-address\";\n   public static final String OZONE_RECON_HTTP_KEYTAB_FILE =\n       \"ozone.recon.http.kerberos.keytab.file\";\n-  public static final String OZONE_RECON_KERBEROS_KEYTAB_FILE_KEY =\n-      \"ozone.recon.kerberos.keytab.file\";\n-  public static final String OZONE_RECON_KERBEROS_PRINCIPAL_KEY =\n-      \"ozone.recon.kerberos.principal\";\n   public static final String OZONE_RECON_HTTP_BIND_HOST_DEFAULT =\n       \"0.0.0.0\";\n   public static final int OZONE_RECON_HTTP_BIND_PORT_DEFAULT = 9888;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTQyNTg1Nw==", "url": "https://github.com/apache/ozone/pull/615#discussion_r385425857", "bodyText": "Do we need a securityEnabled field in the class?", "author": "avijayanhwx", "createdAt": "2020-02-27T23:16:20Z", "path": "hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServer.java", "diffHunk": "@@ -144,6 +156,51 @@ public void join() {\n     }\n   }\n \n+  /**\n+   * Logs in the Recon user if security is enabled in the configuration.\n+   *\n+   * @param conf OzoneConfiguration\n+   * @throws IOException, AuthenticationException in case login fails.\n+   */\n+  private static void loginReconUserIfSecurityEnabled(OzoneConfiguration  conf)\n+      throws IOException, AuthenticationException {\n+    securityEnabled = OzoneSecurityUtil.isSecurityEnabled(conf);", "originalCommit": "48402dc87a18d86c0cb819ab7a1c3b80d0da4c1b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "39fc1fd205e385a91a8f74eebf7c01ca35051930", "chunk": "diff --git a/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServer.java b/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServer.java\nindex 3a4c49dcb..43365537f 100644\n--- a/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServer.java\n+++ b/hadoop-ozone/recon/src/main/java/org/apache/hadoop/ozone/recon/ReconServer.java\n\n@@ -164,8 +163,7 @@ public void join() {\n    */\n   private static void loginReconUserIfSecurityEnabled(OzoneConfiguration  conf)\n       throws IOException, AuthenticationException {\n-    securityEnabled = OzoneSecurityUtil.isSecurityEnabled(conf);\n-    if (securityEnabled) {\n+    if (OzoneSecurityUtil.isSecurityEnabled(conf)) {\n       loginReconUser(conf);\n     }\n   }\n"}}, {"oid": "39fc1fd205e385a91a8f74eebf7c01ca35051930", "url": "https://github.com/apache/ozone/commit/39fc1fd205e385a91a8f74eebf7c01ca35051930", "message": "Fix integration test failure and address review comments.", "committedDate": "2020-02-28T18:16:34Z", "type": "commit"}, {"oid": "5b151f6a5a1f9372ad097023ef0908a1c2cb8566", "url": "https://github.com/apache/ozone/commit/5b151f6a5a1f9372ad097023ef0908a1c2cb8566", "message": "Merge remote-tracking branch 'apache/master' into HDDS-3085", "committedDate": "2020-02-28T19:23:49Z", "type": "commit"}, {"oid": "85bbb2a54da6ad38c4d65fb0bafb75e796dd836f", "url": "https://github.com/apache/ozone/commit/85bbb2a54da6ad38c4d65fb0bafb75e796dd836f", "message": "Fix review comments.", "committedDate": "2020-02-28T20:01:00Z", "type": "commit"}]}