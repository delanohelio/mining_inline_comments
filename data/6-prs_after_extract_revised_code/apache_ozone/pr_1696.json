{"pr_number": 1696, "pr_title": "HDDS-4582 Update `quota in counts` to `quota in namespace`", "pr_createdAt": "2020-12-13T03:24:21Z", "pr_url": "https://github.com/apache/ozone/pull/1696", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA4ODE1NQ==", "url": "https://github.com/apache/ozone/pull/1696#discussion_r542088155", "bodyText": "Can you also rename '--count-quota' to '--namespace-quota'?", "author": "linyiqun", "createdAt": "2020-12-14T03:31:33Z", "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/shell/SetSpaceQuotaOptions.java", "diffHunk": "@@ -32,14 +32,14 @@\n   @CommandLine.Option(names = {\"--count-quota\"},\n       description = \"For volume this parameter represents the number of \" +", "originalCommit": "f449196a847566c5bb2d73bffa8c713f6a59105c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA5NTc1Mw==", "url": "https://github.com/apache/ozone/pull/1696#discussion_r542095753", "bodyText": "Good point!", "author": "amaliujia", "createdAt": "2020-12-14T03:58:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjA4ODE1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "24b3f6039e13ae556f08f340ee3115ac6c91ae8b", "chunk": "diff --git a/hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/shell/SetSpaceQuotaOptions.java b/hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/shell/SetSpaceQuotaOptions.java\nindex b43a29cd7b..6030b85a4d 100644\n--- a/hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/shell/SetSpaceQuotaOptions.java\n+++ b/hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/shell/SetSpaceQuotaOptions.java\n\n@@ -29,7 +29,7 @@\n       description = \"The maximum space quota can be used (eg. 1GB)\")\n   private String quotaInBytes;\n \n-  @CommandLine.Option(names = {\"--count-quota\"},\n+  @CommandLine.Option(names = {\"--namespace-quota\"},\n       description = \"For volume this parameter represents the number of \" +\n           \"buckets, and for buckets represents the number of keys (eg. 5)\")\n   private long quotaInNamespace;\n"}}, {"oid": "2943d193915e1dab875e1a9af2ba9d97c35a463e", "url": "https://github.com/apache/ozone/commit/2943d193915e1dab875e1a9af2ba9d97c35a463e", "message": "HDDS-4582 Update QUOTA_IN_COUNTS to quota in namespace", "committedDate": "2020-12-14T05:15:27Z", "type": "commit"}, {"oid": "e6554a01d9aebf1559b39395c65ac57f96bd8d62", "url": "https://github.com/apache/ozone/commit/e6554a01d9aebf1559b39395c65ac57f96bd8d62", "message": "fixup! fix style", "committedDate": "2020-12-14T05:15:29Z", "type": "commit"}, {"oid": "24b3f6039e13ae556f08f340ee3115ac6c91ae8b", "url": "https://github.com/apache/ozone/commit/24b3f6039e13ae556f08f340ee3115ac6c91ae8b", "message": "fiupx! address comments", "committedDate": "2020-12-14T05:15:29Z", "type": "commit"}, {"oid": "ec031734f776c263f20b50d0e0d8ecf6d900de82", "url": "https://github.com/apache/ozone/commit/ec031734f776c263f20b50d0e0d8ecf6d900de82", "message": "trigger new CI check", "committedDate": "2020-12-14T05:15:29Z", "type": "commit"}, {"oid": "943f63bc3563f46ec8a544c51f3f3217b58d0cf5", "url": "https://github.com/apache/ozone/commit/943f63bc3563f46ec8a544c51f3f3217b58d0cf5", "message": "fixup! fix CI", "committedDate": "2020-12-14T05:15:29Z", "type": "commit"}, {"oid": "943f63bc3563f46ec8a544c51f3f3217b58d0cf5", "url": "https://github.com/apache/ozone/commit/943f63bc3563f46ec8a544c51f3f3217b58d0cf5", "message": "fixup! fix CI", "committedDate": "2020-12-14T05:15:29Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjM3NDA4OQ==", "url": "https://github.com/apache/ozone/pull/1696#discussion_r542374089", "bodyText": "Do we also change checkQuotaCountsValid to checkQuotaNamespaceValid?", "author": "captainzmc", "createdAt": "2020-12-14T13:15:46Z", "path": "hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/volume/OMVolumeSetQuotaRequest.java", "diffHunk": "@@ -135,11 +135,12 @@ public OMClientResponse validateAndUpdateCache(OzoneManager ozoneManager,\n       } else {\n         omVolumeArgs.setQuotaInBytes(omVolumeArgs.getQuotaInBytes());\n       }\n-      if (checkQuotaCountsValid(setVolumePropertyRequest.getQuotaInCounts())) {\n-        omVolumeArgs.setQuotaInCounts(\n-            setVolumePropertyRequest.getQuotaInCounts());\n+      if (checkQuotaCountsValid(", "originalCommit": "943f63bc3563f46ec8a544c51f3f3217b58d0cf5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Mjc4MzQ0Nw==", "url": "https://github.com/apache/ozone/pull/1696#discussion_r542783447", "bodyText": "Indeed! Done!", "author": "amaliujia", "createdAt": "2020-12-14T21:03:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjM3NDA4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "31b18bc104977f88257c35af272ed853de8fe59e", "chunk": "diff --git a/hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/volume/OMVolumeSetQuotaRequest.java b/hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/volume/OMVolumeSetQuotaRequest.java\nindex c6dfe8e8c7..49275b9375 100644\n--- a/hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/volume/OMVolumeSetQuotaRequest.java\n+++ b/hadoop-ozone/ozone-manager/src/main/java/org/apache/hadoop/ozone/om/request/volume/OMVolumeSetQuotaRequest.java\n\n@@ -135,7 +135,7 @@ public OMClientResponse validateAndUpdateCache(OzoneManager ozoneManager,\n       } else {\n         omVolumeArgs.setQuotaInBytes(omVolumeArgs.getQuotaInBytes());\n       }\n-      if (checkQuotaCountsValid(\n+      if (checkQuotaNamespaceValid(\n           setVolumePropertyRequest.getQuotaInNamespace())) {\n         omVolumeArgs.setQuotaInNamespace(\n             setVolumePropertyRequest.getQuotaInNamespace());\n"}}, {"oid": "31b18bc104977f88257c35af272ed853de8fe59e", "url": "https://github.com/apache/ozone/commit/31b18bc104977f88257c35af272ed853de8fe59e", "message": "fixup! address comments", "committedDate": "2020-12-14T18:19:49Z", "type": "commit"}, {"oid": "c197da6a8e3e4d9f7bdd14895cc0850712ccd23a", "url": "https://github.com/apache/ozone/commit/c197da6a8e3e4d9f7bdd14895cc0850712ccd23a", "message": "trigger new CI check", "committedDate": "2020-12-14T19:52:04Z", "type": "commit"}, {"oid": "b52ab271c4f8283e2a2a8188cc9bafb1d86cd496", "url": "https://github.com/apache/ozone/commit/b52ab271c4f8283e2a2a8188cc9bafb1d86cd496", "message": "trigger new CI check", "committedDate": "2020-12-14T20:43:37Z", "type": "commit"}, {"oid": "2bf12684fdbadbb3a5893bb52d08ababed9ac49c", "url": "https://github.com/apache/ozone/commit/2bf12684fdbadbb3a5893bb52d08ababed9ac49c", "message": "trigger new CI check", "committedDate": "2020-12-14T21:02:21Z", "type": "commit"}, {"oid": "b6d9fb3c0d7f1dd710a413aa41bb25f681e4f7dd", "url": "https://github.com/apache/ozone/commit/b6d9fb3c0d7f1dd710a413aa41bb25f681e4f7dd", "message": "trigger new CI check", "committedDate": "2020-12-14T22:32:30Z", "type": "commit"}, {"oid": "d109c85603437f0159a5cef8fb3ef9a69f58b40a", "url": "https://github.com/apache/ozone/commit/d109c85603437f0159a5cef8fb3ef9a69f58b40a", "message": "trigger new CI check", "committedDate": "2020-12-14T22:32:36Z", "type": "commit"}]}