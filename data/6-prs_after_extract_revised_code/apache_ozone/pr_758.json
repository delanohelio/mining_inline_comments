{"pr_number": 758, "pr_title": "HDDS-3280. Ozone BaseHTTPServer should honor ozone.security.enabled c\u2026", "pr_createdAt": "2020-04-02T17:18:25Z", "pr_url": "https://github.com/apache/ozone/pull/758", "timeline": [{"oid": "e7cc58800ab61a5cab5a6d12e0b232338e8ec516", "url": "https://github.com/apache/ozone/commit/e7cc58800ab61a5cab5a6d12e0b232338e8ec516", "message": "HDDS-3280. Ozone BaseHTTPServer should honor ozone.security.enabled config", "committedDate": "2020-04-02T17:09:44Z", "type": "commit"}, {"oid": "1702b3d375de534b29fd7377022bf4ed1c26ca1e", "url": "https://github.com/apache/ozone/commit/1702b3d375de534b29fd7377022bf4ed1c26ca1e", "message": "Fix integration test failures", "committedDate": "2020-04-02T18:41:17Z", "type": "commit"}, {"oid": "3c8f7e89181fa8d4fcfed644f79f7c7417089867", "url": "https://github.com/apache/ozone/commit/3c8f7e89181fa8d4fcfed644f79f7c7417089867", "message": "Merge remote-tracking branch 'apache/master' into HDDS-3280", "committedDate": "2020-04-03T20:56:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMxNTEzNw==", "url": "https://github.com/apache/ozone/pull/758#discussion_r404315137", "bodyText": "This should be better named like ozone.security.http.kerberos.enabled to have a common prefix for http related settings as there will be ozone.security.http.simple.* as well.", "author": "xiaoyuyao", "createdAt": "2020-04-06T18:52:57Z", "path": "hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java", "diffHunk": "@@ -347,6 +347,10 @@\n       \"ozone.security.enabled\";\n   public static final boolean OZONE_SECURITY_ENABLED_DEFAULT = false;\n \n+  public static final String OZONE_HTTP_SECURITY_ENABLED_KEY =\n+      \"ozone.security.kerberos.http.enabled\";", "originalCommit": "3c8f7e89181fa8d4fcfed644f79f7c7417089867", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d9eeea1a12f04bfc483506d2a456c3ade3879aae", "chunk": "diff --git a/hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java b/hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java\nindex efa81977a..6bc0c77aa 100644\n--- a/hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java\n+++ b/hadoop-hdds/common/src/main/java/org/apache/hadoop/ozone/OzoneConfigKeys.java\n\n@@ -348,7 +348,7 @@\n   public static final boolean OZONE_SECURITY_ENABLED_DEFAULT = false;\n \n   public static final String OZONE_HTTP_SECURITY_ENABLED_KEY =\n-      \"ozone.security.kerberos.http.enabled\";\n+      \"ozone.security.http.kerberos.enabled\";\n   public static final boolean OZONE_HTTP_SECURITY_ENABLED_DEFAULT = false;\n \n   public static final String OZONE_CONTAINER_COPY_WORKDIR =\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNDMxNTg4OA==", "url": "https://github.com/apache/ozone/pull/758#discussion_r404315888", "bodyText": "NIT: can we wrap this into OzoneSecurityUtil as isHttpSecurityEnabled?", "author": "xiaoyuyao", "createdAt": "2020-04-06T18:54:14Z", "path": "hadoop-hdds/framework/src/main/java/org/apache/hadoop/hdds/server/http/BaseHttpServer.java", "diffHunk": "@@ -145,16 +146,19 @@ public BaseHttpServer(Configuration conf, String name) throws IOException {\n       final InetSocketAddress httpsAddr, String name, String spnegoUserNameKey,\n       String spnegoKeytabFileKey) throws IOException {\n     HttpConfig.Policy policy = getHttpPolicy(conf);\n+    boolean isSecurityEnabled = OzoneSecurityUtil.isSecurityEnabled(conf) &&", "originalCommit": "3c8f7e89181fa8d4fcfed644f79f7c7417089867", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d9eeea1a12f04bfc483506d2a456c3ade3879aae", "chunk": "diff --git a/hadoop-hdds/framework/src/main/java/org/apache/hadoop/hdds/server/http/BaseHttpServer.java b/hadoop-hdds/framework/src/main/java/org/apache/hadoop/hdds/server/http/BaseHttpServer.java\nindex c9831ac24..5e6d0e6ab 100644\n--- a/hadoop-hdds/framework/src/main/java/org/apache/hadoop/hdds/server/http/BaseHttpServer.java\n+++ b/hadoop-hdds/framework/src/main/java/org/apache/hadoop/hdds/server/http/BaseHttpServer.java\n\n@@ -146,8 +144,7 @@ public BaseHttpServer(Configuration conf, String name) throws IOException {\n       final InetSocketAddress httpsAddr, String name, String spnegoUserNameKey,\n       String spnegoKeytabFileKey) throws IOException {\n     HttpConfig.Policy policy = getHttpPolicy(conf);\n-    boolean isSecurityEnabled = OzoneSecurityUtil.isSecurityEnabled(conf) &&\n-        UserGroupInformation.isSecurityEnabled() &&\n+    boolean isSecurityEnabled = UserGroupInformation.isSecurityEnabled() &&\n         OzoneSecurityUtil.isHttpSecurityEnabled(conf);\n \n     HttpServer2.Builder builder = new HttpServer2.Builder().setName(name)\n"}}, {"oid": "d9eeea1a12f04bfc483506d2a456c3ade3879aae", "url": "https://github.com/apache/ozone/commit/d9eeea1a12f04bfc483506d2a456c3ade3879aae", "message": "Address review comments.", "committedDate": "2020-04-06T21:46:28Z", "type": "commit"}]}