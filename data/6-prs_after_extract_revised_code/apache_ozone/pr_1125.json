{"pr_number": 1125, "pr_title": "HDDS-3866. Support multi-part-upload with Freon S3 key generator", "pr_createdAt": "2020-06-24T15:13:54Z", "pr_url": "https://github.com/apache/ozone/pull/1125", "timeline": [{"oid": "c0a0f0bcf597578fee232fb75861594e6cff5582", "url": "https://github.com/apache/ozone/commit/c0a0f0bcf597578fee232fb75861594e6cff5582", "message": "HDDS-3866. Support multi-part-upload with Freon S3 key generator", "committedDate": "2020-06-24T15:09:28Z", "type": "commit"}, {"oid": "67846b56345bf9eebdb6bf2b2aca11bea43a5634", "url": "https://github.com/apache/ozone/commit/67846b56345bf9eebdb6bf2b2aca11bea43a5634", "message": "trigger new CI check", "committedDate": "2020-06-24T18:47:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5OTQ3Mw==", "url": "https://github.com/apache/ozone/pull/1125#discussion_r445299473", "bodyText": "Minor: Do you think we need some check on the size, when multipart upload option is specified, as in MPU each part should be at least 5MB(except last part) But here we use same part size having that check would be useful, otherwise we shall get an error during complete MPU afteer uploading 10 parts.", "author": "bharatviswa504", "createdAt": "2020-06-25T04:27:04Z", "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/freon/S3KeyGenerator.java", "diffHunk": "@@ -54,7 +64,8 @@\n   private String bucketName;\n \n   @Option(names = {\"-s\", \"--size\"},\n-      description = \"Size of the generated key (in bytes)\",\n+      description = \"Size of the generated key (in bytes) or size of one \"\n+          + \"multipart upload part (in case of multipart upload)\",", "originalCommit": "67846b56345bf9eebdb6bf2b2aca11bea43a5634", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ4MjkwMQ==", "url": "https://github.com/apache/ozone/pull/1125#discussion_r445482901", "bodyText": "The backend will fail anyway thanks to the implementation there...  (guess, you were more thoroughgoing ;-) )\nBut yes, it's slightly more polite to fail early (and creates less garbage). Added a simple check.", "author": "elek", "createdAt": "2020-06-25T11:14:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5OTQ3Mw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5OTk0NQ==", "url": "https://github.com/apache/ozone/pull/1125#discussion_r445299945", "bodyText": "Any reason for this change, setting to us-east-1, as previously this was not set to any value?", "author": "bharatviswa504", "createdAt": "2020-06-25T04:29:02Z", "path": "hadoop-ozone/tools/src/main/java/org/apache/hadoop/ozone/freon/S3KeyGenerator.java", "diffHunk": "@@ -81,7 +103,8 @@ public Void call() throws Exception {\n     if (endpoint.length() > 0) {\n       amazonS3ClientBuilder\n           .withPathStyleAccessEnabled(true)\n-          .withEndpointConfiguration(new EndpointConfiguration(endpoint, \"\"));\n+          .withEndpointConfiguration(\n+              new EndpointConfiguration(endpoint, \"us-east-1\"));", "originalCommit": "67846b56345bf9eebdb6bf2b2aca11bea43a5634", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTQ3OTAxOA==", "url": "https://github.com/apache/ozone/pull/1125#discussion_r445479018", "bodyText": "Just one reason: got an exception ;-) The AWS 4 signature handling failed in our code with having empty region. I tried to define it with environment variable but it was not enough.", "author": "elek", "createdAt": "2020-06-25T11:05:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NTI5OTk0NQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "6f2c8c5445eb8b95def040cded0149ff16bed1bc", "url": "https://github.com/apache/ozone/commit/6f2c8c5445eb8b95def040cded0149ff16bed1bc", "message": "findbugs fix + parameter check", "committedDate": "2020-06-25T11:08:52Z", "type": "commit"}, {"oid": "f9302e0674440f1baa70b9c75b741e54b82d03c9", "url": "https://github.com/apache/ozone/commit/f9302e0674440f1baa70b9c75b741e54b82d03c9", "message": "Merge remote-tracking branch 'elek/HDDS-3866' into HDDS-3866", "committedDate": "2020-06-25T11:13:40Z", "type": "commit"}, {"oid": "94120bf3df63da34dd595ad1a84d9eda4e138ff3", "url": "https://github.com/apache/ozone/commit/94120bf3df63da34dd595ad1a84d9eda4e138ff3", "message": "trigger new CI check", "committedDate": "2020-06-26T02:31:29Z", "type": "commit"}]}