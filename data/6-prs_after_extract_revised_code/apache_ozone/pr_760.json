{"pr_number": 760, "pr_title": "HDDS-3334. OM Client failover to next OM on NotLeaderException", "pr_createdAt": "2020-04-02T18:57:24Z", "pr_url": "https://github.com/apache/ozone/pull/760", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU0NjA2MQ==", "url": "https://github.com/apache/ozone/pull/760#discussion_r402546061", "bodyText": "Can we use lambdaTestUtils instead of sleep?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                Thread.sleep(5000);\n          \n          \n            \n                LambdaTestUtils.await(6000, 2000, () -> (omFailoverProxyProvider.getCurrentProxyOMNodeId().equals(leaderOMNodeId)));", "author": "vivekratnavel", "createdAt": "2020-04-02T19:05:05Z", "path": "hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/om/TestOzoneManagerHA.java", "diffHunk": "@@ -726,7 +726,7 @@ public void testOMProxyProviderFailoverToCurrentLeader() throws Exception {\n     // information must be returned via the response and a failover must\n     // happen to the leader proxy node.\n     createVolumeTest(true);\n-    Thread.sleep(2000);\n+    Thread.sleep(5000);", "originalCommit": "e45546d6f885dd633a1705d422618045697810b1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU0OTQ0Ng==", "url": "https://github.com/apache/ozone/pull/760#discussion_r402549446", "bodyText": "Didn't realize till Bharat pointed out that this test is disabled. I ll revert the change to test and we can fix this when enabling TestOzoneManagerHA. That test was disabled as it was flaky and would need more work before it can be enabled.", "author": "hanishakoneru", "createdAt": "2020-04-02T19:10:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU0NjA2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU1MjcwOA==", "url": "https://github.com/apache/ozone/pull/760#discussion_r402552708", "bodyText": "Sounds good!", "author": "vivekratnavel", "createdAt": "2020-04-02T19:16:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjU0NjA2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "2575052dac2e4880c839d2b1bbf2c514090ca97d", "chunk": "diff --git a/hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/om/TestOzoneManagerHA.java b/hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/om/TestOzoneManagerHA.java\nindex c8de39ab23..9a30ed00e1 100644\n--- a/hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/om/TestOzoneManagerHA.java\n+++ b/hadoop-ozone/integration-test/src/test/java/org/apache/hadoop/ozone/om/TestOzoneManagerHA.java\n\n@@ -726,7 +726,7 @@ public void testOMProxyProviderFailoverToCurrentLeader() throws Exception {\n     // information must be returned via the response and a failover must\n     // happen to the leader proxy node.\n     createVolumeTest(true);\n-    Thread.sleep(5000);\n+    Thread.sleep(2000);\n \n     String newLeaderOMNodeId =\n         omFailoverProxyProvider.getCurrentProxyOMNodeId();\n"}}, {"oid": "2575052dac2e4880c839d2b1bbf2c514090ca97d", "url": "https://github.com/apache/ozone/commit/2575052dac2e4880c839d2b1bbf2c514090ca97d", "message": "HDDS-3334. OM Client failover to next OM on NotLeaderException", "committedDate": "2020-04-02T19:07:15Z", "type": "commit"}, {"oid": "2575052dac2e4880c839d2b1bbf2c514090ca97d", "url": "https://github.com/apache/ozone/commit/2575052dac2e4880c839d2b1bbf2c514090ca97d", "message": "HDDS-3334. OM Client failover to next OM on NotLeaderException", "committedDate": "2020-04-02T19:07:15Z", "type": "forcePushed"}]}