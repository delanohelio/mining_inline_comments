{"pr_number": 971, "pr_title": "HDDS-2566. Handle InterruptedException in ContainerDataScanner", "pr_createdAt": "2020-05-27T03:36:40Z", "pr_url": "https://github.com/apache/ozone/pull/971", "timeline": [{"oid": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "url": "https://github.com/apache/ozone/commit/954d569c8a0df2da21abfffa5e70665b3305e1c3", "message": "HDDS-2566. Handle InterruptedException in ContainerDataScanner", "committedDate": "2020-05-27T03:34:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1OTE3MQ==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431359171", "bodyText": "Can we use String format here?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n              private static final String NAME = \"ContainerDataScanner(\";\n          \n          \n            \n              private static final String NAME_FORMAT = \"ContainerDataScanner(%s)\";", "author": "vivekratnavel", "createdAt": "2020-05-27T18:35:02Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -49,6 +49,7 @@\n   private final Canceler canceler;\n   private final ContainerDataScrubberMetrics metrics;\n   private final long dataScanInterval;\n+  private static final String NAME = \"ContainerDataScanner(\";", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d5a0cac20784c3071f2ba311a9e668bb92ec455c", "chunk": "diff --git a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\nindex f96f391cf3..28e2de801c 100644\n--- a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n+++ b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\n@@ -49,7 +49,7 @@\n   private final Canceler canceler;\n   private final ContainerDataScrubberMetrics metrics;\n   private final long dataScanInterval;\n-  private static final String NAME = \"ContainerDataScanner(\";\n+  private static final String NAME_FORMAT = \"ContainerDataScanner(%s)\";\n \n   /**\n    * True if the thread is stopping.<p/>\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM1OTgyNw==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431359827", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                setName(NAME + volume + \")\");\n          \n          \n            \n                setName(String.format(NAME_FORMAT, volume));", "author": "vivekratnavel", "createdAt": "2020-05-27T18:36:11Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -66,7 +67,7 @@ public ContainerDataScanner(ContainerScrubberConfiguration conf,\n     throttler = new HddsDataTransferThrottler(conf.getBandwidthPerVolume());\n     canceler = new Canceler();\n     metrics = ContainerDataScrubberMetrics.create(volume.toString());\n-    setName(\"ContainerDataScanner(\" + volume + \")\");\n+    setName(NAME + volume + \")\");", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7990798d024a16d5bcb69bd4849c30d872dba0c", "chunk": "diff --git a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\nindex f96f391cf3..97e20198bf 100644\n--- a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n+++ b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\n@@ -67,7 +67,7 @@ public ContainerDataScanner(ContainerScrubberConfiguration conf,\n     throttler = new HddsDataTransferThrottler(conf.getBandwidthPerVolume());\n     canceler = new Canceler();\n     metrics = ContainerDataScrubberMetrics.create(volume.toString());\n-    setName(NAME + volume + \")\");\n+    setName(String.format(NAME_FORMAT, volume));\n     setDaemon(true);\n   }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM2MDQ5NA==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431360494", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                this.canceler.cancel(NAME + volume + \") is shutting down\");\n          \n          \n            \n                this.canceler.cancel(String.format(NAME_FORMAT, volume) + \" is shutting down\");", "author": "vivekratnavel", "createdAt": "2020-05-27T18:37:22Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -162,13 +165,14 @@ private static void logScanCompleted(\n \n   public synchronized void shutdown() {\n     this.stopping = true;\n-    this.canceler.cancel(\"ContainerDataScanner(\"+volume+\") is shutting down\");\n+    this.canceler.cancel(NAME + volume + \") is shutting down\");", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6679237038e68fd6b4dfc1c87dfe9814af6eaa18", "chunk": "diff --git a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\nindex f96f391cf3..73a6dbffb0 100644\n--- a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n+++ b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\n@@ -165,7 +165,7 @@ private static void logScanCompleted(\n \n   public synchronized void shutdown() {\n     this.stopping = true;\n-    this.canceler.cancel(NAME + volume + \") is shutting down\");\n+    this.canceler.cancel(String.format(NAME_FORMAT, volume) + \" is shutting down\");\n     this.interrupt();\n     try {\n       this.join();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTM2MDkxOQ==", "url": "https://github.com/apache/ozone/pull/971#discussion_r431360919", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                return NAME + volume + \", \" + volume.getStorageID() + \")\";\n          \n          \n            \n                return String.format(NAME_FORMAT, volume + \", \" + volume.getStorageID());", "author": "vivekratnavel", "createdAt": "2020-05-27T18:38:12Z", "path": "hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java", "diffHunk": "@@ -179,8 +183,7 @@ public ContainerDataScrubberMetrics getMetrics() {\n \n   @Override\n   public String toString() {\n-    return \"ContainerDataScanner(\" + volume +\n-        \", \" + volume.getStorageID() + \")\";\n+    return NAME + volume + \", \" + volume.getStorageID() + \")\";", "originalCommit": "954d569c8a0df2da21abfffa5e70665b3305e1c3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "64c602aa8689235aa9557a6e35601c98cb75cc7a", "chunk": "diff --git a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\nindex f96f391cf3..159ae8d203 100644\n--- a/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n+++ b/hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\n@@ -183,7 +183,7 @@ public ContainerDataScrubberMetrics getMetrics() {\n \n   @Override\n   public String toString() {\n-    return NAME + volume + \", \" + volume.getStorageID() + \")\";\n+    return String.format(NAME_FORMAT, volume + \", \" + volume.getStorageID());\n   }\n \n   private class HddsDataTransferThrottler extends DataTransferThrottler {\n"}}, {"oid": "d5a0cac20784c3071f2ba311a9e668bb92ec455c", "url": "https://github.com/apache/ozone/commit/d5a0cac20784c3071f2ba311a9e668bb92ec455c", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:15Z", "type": "commit"}, {"oid": "b7990798d024a16d5bcb69bd4849c30d872dba0c", "url": "https://github.com/apache/ozone/commit/b7990798d024a16d5bcb69bd4849c30d872dba0c", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:24Z", "type": "commit"}, {"oid": "6679237038e68fd6b4dfc1c87dfe9814af6eaa18", "url": "https://github.com/apache/ozone/commit/6679237038e68fd6b4dfc1c87dfe9814af6eaa18", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:33Z", "type": "commit"}, {"oid": "64c602aa8689235aa9557a6e35601c98cb75cc7a", "url": "https://github.com/apache/ozone/commit/64c602aa8689235aa9557a6e35601c98cb75cc7a", "message": "Update hadoop-hdds/container-service/src/main/java/org/apache/hadoop/ozone/container/ozoneimpl/ContainerDataScanner.java\n\nCo-authored-by: Vivek Ratnavel Subramanian <vivekratnavel90@gmail.com>", "committedDate": "2020-05-27T18:40:39Z", "type": "commit"}, {"oid": "a106cca745d0eb4d05f844789494141fc50b2a22", "url": "https://github.com/apache/ozone/commit/a106cca745d0eb4d05f844789494141fc50b2a22", "message": "fixed checkstyle", "committedDate": "2020-05-27T19:26:29Z", "type": "commit"}]}