{"pr_number": 1555, "pr_title": "Implement OS and some process resource attributes.", "pr_createdAt": "2020-08-19T09:54:24Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555", "timeline": [{"oid": "b986018d9a4cc3d4c1be892e78c52ac199c1ab0a", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b986018d9a4cc3d4c1be892e78c52ac199c1ab0a", "message": "Implement OS and some process resource attributes.", "committedDate": "2020-08-19T09:53:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkyMzk2OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r472923969", "bodyText": "Are these attributes defined by semantic convention? If yes, I think a link to it will be useful here.", "author": "iNikem", "createdAt": "2020-08-19T10:22:57Z", "path": "sdk/common/src/main/java/io/opentelemetry/sdk/resources/ResourceConstants.java", "diffHunk": "@@ -25,6 +25,36 @@\n  */\n public class ResourceConstants {\n \n+  /** The operating system type, such as {@code \"WINDOWS\"}, {@code \"DARWIN\"}, {@code \"LINUX\"}. */\n+  public static final String OS_NAME = \"os.name\";", "originalCommit": "b986018d9a4cc3d4c1be892e78c52ac199c1ab0a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkzMDMxMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r472930311", "bodyText": "It's in the class javadoc - but thanks to the reminder I found it was a dead link :)", "author": "anuraaga", "createdAt": "2020-08-19T10:34:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjkyMzk2OQ=="}], "type": "inlineReview", "revised_code": {"commit": "2893a16997708b16e420832405b6069aa059d9f7", "chunk": "diff --git a/sdk/common/src/main/java/io/opentelemetry/sdk/resources/ResourceConstants.java b/sdk/common/src/main/java/io/opentelemetry/sdk/resources/ResourceConstants.java\nindex a8195535a..59ad0fa31 100644\n--- a/sdk/common/src/main/java/io/opentelemetry/sdk/resources/ResourceConstants.java\n+++ b/sdk/common/src/main/java/io/opentelemetry/sdk/resources/ResourceConstants.java\n\n@@ -20,7 +20,7 @@ package io.opentelemetry.sdk.resources;\n  * Provides constants for resource semantic conventions defined by the OpenTelemetry specification.\n  *\n  * @see <a\n- *     href=\"https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/data-resource-semantic-conventions.md\">Resource\n+ *     href=\"https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/resource/semantic_conventions/README.md\">Resource\n  *     Conventions</a>\n  */\n public class ResourceConstants {\n"}}, {"oid": "2893a16997708b16e420832405b6069aa059d9f7", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/2893a16997708b16e420832405b6069aa059d9f7", "message": "Update link in javadoc", "committedDate": "2020-08-19T10:34:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk0OTU2OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r472949568", "bodyText": "Would contains make the code more robust? I am not familiar with all the cases so I might be wrong.", "author": "thisthat", "createdAt": "2020-08-19T11:11:50Z", "path": "sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/OsResource.java", "diffHunk": "@@ -0,0 +1,88 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.sdk.extensions.resources;\n+\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.sdk.resources.ResourceConstants;\n+import io.opentelemetry.sdk.resources.ResourceProvider;\n+import javax.annotation.Nullable;\n+\n+/** {@link ResourceProvider} which provides information about the current operating system. */\n+public class OsResource extends ResourceProvider {\n+\n+  @Override\n+  protected Attributes getAttributes() {\n+    final String os;\n+    try {\n+      os = System.getProperty(\"os.name\");\n+    } catch (SecurityException t) {\n+      // Security manager enabled, can't provide much os information.\n+      return Attributes.empty();\n+    }\n+\n+    if (os == null) {\n+      return Attributes.empty();\n+    }\n+\n+    Attributes.Builder attributes = Attributes.newBuilder();\n+\n+    String osName = getOs(os);\n+    if (osName != null) {\n+      attributes.setAttribute(ResourceConstants.OS_NAME, osName);\n+    }\n+\n+    String version = null;\n+    try {\n+      version = System.getProperty(\"os.version\");\n+    } catch (SecurityException e) {\n+      // Ignore\n+    }\n+    String osDescription = version != null ? os + ' ' + version : os;\n+    attributes.setAttribute(ResourceConstants.OS_DESCRIPTION, osDescription);\n+\n+    return attributes.build();\n+  }\n+\n+  @Nullable\n+  private static String getOs(String os) {", "originalCommit": "2893a16997708b16e420832405b6069aa059d9f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk1MzcxMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r472953711", "bodyText": "I took the approach from commons Lang - I think it's been vetted much more than anything I could ever come up with ;)", "author": "anuraaga", "createdAt": "2020-08-19T11:20:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk0OTU2OA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk1MDM1MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r472950350", "bodyText": "I would avoid reporting the attribute if no process id was available.", "author": "thisthat", "createdAt": "2020-08-19T11:13:29Z", "path": "sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.sdk.extensions.resources;\n+\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.sdk.resources.ResourceConstants;\n+import io.opentelemetry.sdk.resources.ResourceProvider;\n+import java.io.File;\n+import java.lang.management.ManagementFactory;\n+import java.lang.management.RuntimeMXBean;\n+\n+/** {@link ResourceProvider} which provides information about the current running process. */\n+public class ProcessResource extends ResourceProvider {\n+  @Override\n+  protected Attributes getAttributes() {\n+    Attributes.Builder attributes = Attributes.newBuilder();\n+\n+    // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n+    RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n+    long pid = -1;\n+    String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n+    int atIndex = runtimeName.indexOf('@');\n+    if (atIndex >= 0) {\n+      String pidString = runtimeName.substring(0, atIndex);\n+      try {\n+        pid = Long.parseLong(pidString);\n+      } catch (NumberFormatException ignored) {\n+        // Ignore parse failure.\n+      }\n+    }\n+\n+    attributes.setAttribute(ResourceConstants.PROCESS_PID, pid);", "originalCommit": "2893a16997708b16e420832405b6069aa059d9f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3NDg2Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473174863", "bodyText": "agreed. I'd rather have no value, rather than a -1", "author": "jkwatson", "createdAt": "2020-08-19T16:46:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk1MDM1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzUzMzk4MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473533981", "bodyText": "Oops forgot, thanks!\nUnfortunately, don't think there's any way for me to write a unit test for it.", "author": "anuraaga", "createdAt": "2020-08-20T02:04:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjk1MDM1MA=="}], "type": "inlineReview", "revised_code": {"commit": "7bbdfe86a092e559d85eaa2adc928d1690dfe265", "chunk": "diff --git a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\nindex c61e08381..113a3f91b 100644\n--- a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n+++ b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n\n@@ -32,6 +32,8 @@ public class ProcessResource extends ResourceProvider {\n     // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n     RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n     long pid = -1;\n+    // While this is not strictly defined, almost all commonly used JVMs format this as\n+    // pid@hostname.\n     String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n     int atIndex = runtimeName.indexOf('@');\n     if (atIndex >= 0) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3MTU2MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473171560", "bodyText": "We should create an issue for this, so the TODO doesn't lie dead in the code.", "author": "jkwatson", "createdAt": "2020-08-19T16:40:23Z", "path": "sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.sdk.extensions.resources;\n+\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.sdk.resources.ResourceConstants;\n+import io.opentelemetry.sdk.resources.ResourceProvider;\n+import java.io.File;\n+import java.lang.management.ManagementFactory;\n+import java.lang.management.RuntimeMXBean;\n+\n+/** {@link ResourceProvider} which provides information about the current running process. */\n+public class ProcessResource extends ResourceProvider {\n+  @Override\n+  protected Attributes getAttributes() {\n+    Attributes.Builder attributes = Attributes.newBuilder();\n+\n+    // TODO(anuraaga): Use reflection to get more stable values on Java 9+", "originalCommit": "2893a16997708b16e420832405b6069aa059d9f7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7bbdfe86a092e559d85eaa2adc928d1690dfe265", "chunk": "diff --git a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\nindex c61e08381..113a3f91b 100644\n--- a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n+++ b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n\n@@ -32,6 +32,8 @@ public class ProcessResource extends ResourceProvider {\n     // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n     RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n     long pid = -1;\n+    // While this is not strictly defined, almost all commonly used JVMs format this as\n+    // pid@hostname.\n     String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n     int atIndex = runtimeName.indexOf('@');\n     if (atIndex >= 0) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE3NDQzOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473174439", "bodyText": "could you add a little comment about what the structure of this name looks like, so the code doesn't just look like magic. Thanks!", "author": "jkwatson", "createdAt": "2020-08-19T16:45:22Z", "path": "sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.sdk.extensions.resources;\n+\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.sdk.resources.ResourceConstants;\n+import io.opentelemetry.sdk.resources.ResourceProvider;\n+import java.io.File;\n+import java.lang.management.ManagementFactory;\n+import java.lang.management.RuntimeMXBean;\n+\n+/** {@link ResourceProvider} which provides information about the current running process. */\n+public class ProcessResource extends ResourceProvider {\n+  @Override\n+  protected Attributes getAttributes() {\n+    Attributes.Builder attributes = Attributes.newBuilder();\n+\n+    // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n+    RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n+    long pid = -1;\n+    String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n+    int atIndex = runtimeName.indexOf('@');", "originalCommit": "2893a16997708b16e420832405b6069aa059d9f7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7bbdfe86a092e559d85eaa2adc928d1690dfe265", "chunk": "diff --git a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\nindex c61e08381..113a3f91b 100644\n--- a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n+++ b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n\n@@ -32,6 +32,8 @@ public class ProcessResource extends ResourceProvider {\n     // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n     RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n     long pid = -1;\n+    // While this is not strictly defined, almost all commonly used JVMs format this as\n+    // pid@hostname.\n     String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n     int atIndex = runtimeName.indexOf('@');\n     if (atIndex >= 0) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5MTQ2NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473191465", "bodyText": "interesting assumption. This is definitely the most common location for a java executable, but is it universal enough to be encoded here?", "author": "jkwatson", "createdAt": "2020-08-19T17:07:02Z", "path": "sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.sdk.extensions.resources;\n+\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.sdk.resources.ResourceConstants;\n+import io.opentelemetry.sdk.resources.ResourceProvider;\n+import java.io.File;\n+import java.lang.management.ManagementFactory;\n+import java.lang.management.RuntimeMXBean;\n+\n+/** {@link ResourceProvider} which provides information about the current running process. */\n+public class ProcessResource extends ResourceProvider {\n+  @Override\n+  protected Attributes getAttributes() {\n+    Attributes.Builder attributes = Attributes.newBuilder();\n+\n+    // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n+    RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n+    long pid = -1;\n+    String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n+    int atIndex = runtimeName.indexOf('@');\n+    if (atIndex >= 0) {\n+      String pidString = runtimeName.substring(0, atIndex);\n+      try {\n+        pid = Long.parseLong(pidString);\n+      } catch (NumberFormatException ignored) {\n+        // Ignore parse failure.\n+      }\n+    }\n+\n+    attributes.setAttribute(ResourceConstants.PROCESS_PID, pid);\n+\n+    String javaHome = null;\n+    String osName = null;\n+    try {\n+      javaHome = System.getProperty(\"java.home\");\n+      osName = System.getProperty(\"os.name\");\n+    } catch (SecurityException e) {\n+      // Ignore\n+    }\n+    if (javaHome != null) {\n+      StringBuilder executablePath = new StringBuilder(javaHome);\n+      executablePath\n+          .append(File.pathSeparatorChar)\n+          .append(\"bin\")", "originalCommit": "2893a16997708b16e420832405b6069aa059d9f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzUyODAxMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473528013", "bodyText": "On Java 9 we can have a better path using ProcessHandle I want to implement that at some point. This seems common enough for the base case that I figured it's ok but let me know what you think (I think a lot of tools would break if java wasn't at this subdirectory of the java home).", "author": "anuraaga", "createdAt": "2020-08-20T01:55:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5MTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzU2MTE1Ng==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473561156", "bodyText": "Let's go with it for now. I'm sure a user on some obscure platform will let us know when it's wrong. :)", "author": "jkwatson", "createdAt": "2020-08-20T03:09:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5MTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzU2MTQyNw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473561427", "bodyText": "I wonder what this does on Android, for instance. I also hope no one is running this SDK on android, since we haven't been (and don't intend to be) optimizing for that runtime environment.", "author": "jkwatson", "createdAt": "2020-08-20T03:10:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5MTQ2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzU3NTgxMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473575812", "bodyText": "Currently it's guaranteed to crash because java management isn't available anyways :) I added a note to the README and note to the issue that we can reflectionize this too to unbreak.", "author": "anuraaga", "createdAt": "2020-08-20T04:06:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5MTQ2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7bbdfe86a092e559d85eaa2adc928d1690dfe265", "chunk": "diff --git a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\nindex c61e08381..113a3f91b 100644\n--- a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n+++ b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n\n@@ -32,6 +32,8 @@ public class ProcessResource extends ResourceProvider {\n     // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n     RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n     long pid = -1;\n+    // While this is not strictly defined, almost all commonly used JVMs format this as\n+    // pid@hostname.\n     String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n     int atIndex = runtimeName.indexOf('@');\n     if (atIndex >= 0) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5NDIyMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473194221", "bodyText": "I'm nervous about blindly adding all the command lines arguments from a java process.This could end up being gigantic, and also leaking senstivie information that is being passed in via system properties. Are we sure this is a good idea?", "author": "jkwatson", "createdAt": "2020-08-19T17:11:55Z", "path": "sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java", "diffHunk": "@@ -0,0 +1,78 @@\n+/*\n+ * Copyright 2020, OpenTelemetry Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package io.opentelemetry.sdk.extensions.resources;\n+\n+import io.opentelemetry.common.Attributes;\n+import io.opentelemetry.sdk.resources.ResourceConstants;\n+import io.opentelemetry.sdk.resources.ResourceProvider;\n+import java.io.File;\n+import java.lang.management.ManagementFactory;\n+import java.lang.management.RuntimeMXBean;\n+\n+/** {@link ResourceProvider} which provides information about the current running process. */\n+public class ProcessResource extends ResourceProvider {\n+  @Override\n+  protected Attributes getAttributes() {\n+    Attributes.Builder attributes = Attributes.newBuilder();\n+\n+    // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n+    RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n+    long pid = -1;\n+    String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n+    int atIndex = runtimeName.indexOf('@');\n+    if (atIndex >= 0) {\n+      String pidString = runtimeName.substring(0, atIndex);\n+      try {\n+        pid = Long.parseLong(pidString);\n+      } catch (NumberFormatException ignored) {\n+        // Ignore parse failure.\n+      }\n+    }\n+\n+    attributes.setAttribute(ResourceConstants.PROCESS_PID, pid);\n+\n+    String javaHome = null;\n+    String osName = null;\n+    try {\n+      javaHome = System.getProperty(\"java.home\");\n+      osName = System.getProperty(\"os.name\");\n+    } catch (SecurityException e) {\n+      // Ignore\n+    }\n+    if (javaHome != null) {\n+      StringBuilder executablePath = new StringBuilder(javaHome);\n+      executablePath\n+          .append(File.pathSeparatorChar)\n+          .append(\"bin\")\n+          .append(File.pathSeparatorChar)\n+          .append(\"java\");\n+      if (osName != null && osName.toLowerCase().startsWith(\"windows\")) {\n+        executablePath.append(\".exe\");\n+      }\n+\n+      attributes.setAttribute(ResourceConstants.PROCESS_EXECUTABLE_PATH, executablePath.toString());\n+\n+      StringBuilder commandLine = new StringBuilder(executablePath);\n+      for (String arg : runtime.getInputArguments()) {\n+        commandLine.append(' ').append(arg);", "originalCommit": "2893a16997708b16e420832405b6069aa059d9f7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzIwMjgwOA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473202808", "bodyText": "I guess if this isn't something we're putting in by default in the SDK, it's probably fine. I think we should definitely have some warnings in the module README, or perhaps in the javadoc, or somewhere. :)", "author": "jkwatson", "createdAt": "2020-08-19T17:26:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5NDIyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzUzMzc3OQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473533779", "bodyText": "Checked the output and it seems to only have system properties / normal command line, and not classpath for example which would be huge.\nI think this point applies to the semantic convention itself so we'll probably need to find some guidelines on how to deal with this attribute there.", "author": "anuraaga", "createdAt": "2020-08-20T02:03:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5NDIyMQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzU1ODgxMw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1555#discussion_r473558813", "bodyText": "oh good. I was worried about the classpath, which would be gigantic. The point still holds for system properties and security, and you're right about the conventions probably needing some clarification. I'm still ok with this for now, since it's an opt-in extension module.", "author": "jkwatson", "createdAt": "2020-08-20T02:59:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzE5NDIyMQ=="}], "type": "inlineReview", "revised_code": {"commit": "7bbdfe86a092e559d85eaa2adc928d1690dfe265", "chunk": "diff --git a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\nindex c61e08381..113a3f91b 100644\n--- a/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n+++ b/sdk_extensions/resources/src/main/java/io/opentelemetry/sdk/extensions/resources/ProcessResource.java\n\n@@ -32,6 +32,8 @@ public class ProcessResource extends ResourceProvider {\n     // TODO(anuraaga): Use reflection to get more stable values on Java 9+\n     RuntimeMXBean runtime = ManagementFactory.getRuntimeMXBean();\n     long pid = -1;\n+    // While this is not strictly defined, almost all commonly used JVMs format this as\n+    // pid@hostname.\n     String runtimeName = ManagementFactory.getRuntimeMXBean().getName();\n     int atIndex = runtimeName.indexOf('@');\n     if (atIndex >= 0) {\n"}}, {"oid": "7bbdfe86a092e559d85eaa2adc928d1690dfe265", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/7bbdfe86a092e559d85eaa2adc928d1690dfe265", "message": "pid, docs", "committedDate": "2020-08-20T02:04:38Z", "type": "commit"}, {"oid": "b4951534dba3c89668c88b38392fe627fea8b456", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/b4951534dba3c89668c88b38392fe627fea8b456", "message": "Merge branch 'resource-os-process' of github.com:anuraaga/opentelemetry-java into resource-os-process", "committedDate": "2020-08-20T03:02:35Z", "type": "commit"}, {"oid": "bb82b3ea59531410f2e5847eb798c122d2949952", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/bb82b3ea59531410f2e5847eb798c122d2949952", "message": "Don't support Android", "committedDate": "2020-08-20T04:05:06Z", "type": "commit"}]}