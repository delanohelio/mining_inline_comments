{"pr_number": 2231, "pr_title": "Remove duplicate getters and builder options from SDK", "pr_createdAt": "2020-12-08T22:15:12Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231", "timeline": [{"oid": "81e0866fd2f5ba77b3a311e887df969fa910e1bc", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/81e0866fd2f5ba77b3a311e887df969fa910e1bc", "message": "Remove duplicate getters and builder options from SDK\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-08T22:24:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r538914370", "bodyText": "While there could be an argument for removing the tracerprovider knobs here, I don't see why we would remove global concerns like clock / resource.", "author": "anuraaga", "createdAt": "2020-12-09T00:35:47Z", "path": "sdk/all/src/main/java/io/opentelemetry/sdk/OpenTelemetrySdk.java", "diffHunk": "@@ -144,130 +111,28 @@ public Builder setPropagators(ContextPropagators propagators) {\n       return this;\n     }\n \n-    /**\n-     * Sets the {@link Clock} to be used for measuring timings.\n-     *\n-     * <p>If you use {@link #setTracerProvider(TracerProvider)}, this will be ignored for purposes\n-     * of configuring the TracerProvider.\n-     *\n-     * @param clock The clock to use for all temporal needs.\n-     * @return this\n-     */\n-    public Builder setClock(Clock clock) {", "originalCommit": "81e0866fd2f5ba77b3a311e887df969fa910e1bc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNzUzOQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r538917539", "bodyText": "Because they are properties of the providers why would we need to have getters for Clock and Resource in the SDK?", "author": "bogdandrutu", "createdAt": "2020-12-09T00:44:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxODM3OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r538918378", "bodyText": "Also it is a very poor design choice, if user sets TracerProvider and Resource the Resource is not set to the provider so it is an unexpected behavior for the user", "author": "bogdandrutu", "createdAt": "2020-12-09T00:46:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODk1MDU0Mw==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r538950543", "bodyText": "It's poor design to make it easy to set a different resource for tracer and meter right? The getters can probably be removed, they were with the thought that the providers might read them from the OpenTelemetry, but they can be pushed down via the builders instead. The idea is to remove setTracerProvider / setMeterProvider from here to make sure cross-signal concerns are handled by the SDK itself. We're making steps towards that and after making sure SDK can be configured as one unit, and each signal can also be configured as one unit, we can remove them.", "author": "anuraaga", "createdAt": "2020-12-09T02:10:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODk1NDgyMQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r538954821", "bodyText": "Not sure about this, I can see reasons to have different clock instances (for metrics you don't need us precision, ms is more than enough). So the only part that is really common is Resource, does it worth all this duplicated code? Also as a user right now I am totally confused, where do I set Resource? Where do I set SpanProcessors?\n\nSo far we clearly agreed that the getters even if available to pass to the providers, they do not need to be public.\n\nDo we agree that having duplicate way to configure the same thing is a maintainers problem?", "author": "bogdandrutu", "createdAt": "2020-12-09T02:22:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODk1NTcxNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r538955716", "bodyText": "Yeah - two ways to do the same thing is an issue of maintenance, which takes the back seat to user experience.\n\nAlso as a user right now I am totally confused, where do I set Resource? Where do I set SpanProcessors?\n\nI don't understand this - the configuration is on the SDK builder, why are you confused? (after we remove setTracerProvider / setMeterProvider)", "author": "anuraaga", "createdAt": "2020-12-09T02:24:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY0MjY3MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/2231#discussion_r539642671", "bodyText": "Yeah - two ways to do the same thing is an issue of maintenance, which takes the back seat to user experience.\n\nBut, we already have tons of ways to configure things...env vars, system properties, programmatic, SPI. How do we draw the line at what the \"right\" number of ways is to configure the API and SDK?", "author": "jkwatson", "createdAt": "2020-12-09T20:58:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODkxNDM3MA=="}], "type": "inlineReview", "revised_code": {"commit": "e7ec290c26a49386602d7c68ddea0a7778ec36bb", "chunk": "diff --git a/sdk/all/src/main/java/io/opentelemetry/sdk/OpenTelemetrySdk.java b/sdk/all/src/main/java/io/opentelemetry/sdk/OpenTelemetrySdk.java\nindex 19e47e4b7..b2c5eff46 100644\n--- a/sdk/all/src/main/java/io/opentelemetry/sdk/OpenTelemetrySdk.java\n+++ b/sdk/all/src/main/java/io/opentelemetry/sdk/OpenTelemetrySdk.java\n\n@@ -121,7 +123,7 @@ public final class OpenTelemetrySdk extends DefaultOpenTelemetry {\n       }\n \n       if (tracerProvider == null) {\n-        tracerProvider = TracerSdkProvider.builder().build();\n+        tracerProvider = SdkTracerProvider.builder().build();\n       }\n \n       OpenTelemetrySdk sdk =\n"}}, {"oid": "e7ec290c26a49386602d7c68ddea0a7778ec36bb", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/e7ec290c26a49386602d7c68ddea0a7778ec36bb", "message": "Remove duplicate getters and builder options from SDK\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-15T18:42:31Z", "type": "commit"}, {"oid": "e7ec290c26a49386602d7c68ddea0a7778ec36bb", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/e7ec290c26a49386602d7c68ddea0a7778ec36bb", "message": "Remove duplicate getters and builder options from SDK\n\nSigned-off-by: Bogdan Drutu <bogdandrutu@gmail.com>", "committedDate": "2020-12-15T18:42:31Z", "type": "forcePushed"}]}