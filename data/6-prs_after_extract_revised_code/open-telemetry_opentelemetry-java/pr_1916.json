{"pr_number": 1916, "pr_title": "Have Baggage context interaction API mirror Span.", "pr_createdAt": "2020-10-29T06:46:19Z", "pr_url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916", "timeline": [{"oid": "cba055c6b7221610ff7faf8b163f8811f75e8b19", "url": "https://github.com/open-telemetry/opentelemetry-java/commit/cba055c6b7221610ff7faf8b163f8811f75e8b19", "message": "Have Baggage context interaction API mirror Span.", "committedDate": "2020-10-29T06:46:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMTAwNA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514321004", "bodyText": "oh, good catch! good thing it's just a name. :)", "author": "jkwatson", "createdAt": "2020-10-29T14:52:20Z", "path": "api/src/main/java/io/opentelemetry/api/baggage/BaggageUtils.java", "diffHunk": "@@ -5,18 +5,16 @@\n \n package io.opentelemetry.api.baggage;\n \n-import com.google.errorprone.annotations.MustBeClosed;\n import io.opentelemetry.context.Context;\n import io.opentelemetry.context.ContextKey;\n-import io.opentelemetry.context.Scope;\n import javax.annotation.Nullable;\n import javax.annotation.concurrent.Immutable;\n \n /** Utility methods for accessing the {@link Baggage} contained in the {@link Context}. */\n @Immutable\n public final class BaggageUtils {\n-  private static final ContextKey<Baggage> CORR_CONTEXT_KEY =\n-      ContextKey.named(\"opentelemetry-corr-context-key\");\n+  private static final ContextKey<Baggage> BAGGAGE_KEY =", "originalCommit": "cba055c6b7221610ff7faf8b163f8811f75e8b19", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMTM1MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514321351", "bodyText": "do we still need the class to be public?", "author": "jkwatson", "createdAt": "2020-10-29T14:52:46Z", "path": "api/src/main/java/io/opentelemetry/api/baggage/BaggageUtils.java", "diffHunk": "@@ -5,18 +5,16 @@\n \n package io.opentelemetry.api.baggage;\n \n-import com.google.errorprone.annotations.MustBeClosed;\n import io.opentelemetry.context.Context;\n import io.opentelemetry.context.ContextKey;\n-import io.opentelemetry.context.Scope;\n import javax.annotation.Nullable;\n import javax.annotation.concurrent.Immutable;\n \n /** Utility methods for accessing the {@link Baggage} contained in the {@link Context}. */\n @Immutable\n public final class BaggageUtils {", "originalCommit": "cba055c6b7221610ff7faf8b163f8811f75e8b19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM2NTkzMg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514365932", "bodyText": "As long as TracingContextUtils, yes, I suggest we keep it public (and TracingContextUtils should probably stay public to be Specification compliant).", "author": "carlosalberto", "createdAt": "2020-10-29T15:48:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMTM1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM3NzQ1OA==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514377458", "bodyText": "even if none of the methods are public?", "author": "jkwatson", "createdAt": "2020-10-29T16:02:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMTM1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDUyNDExNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514524116", "bodyText": "It does not need to be public, the specification says that the context interaction functionality can be added in few places, and avoid duplicate. So that needs to not be public.", "author": "bogdandrutu", "createdAt": "2020-10-29T19:51:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMTM1MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTE2NjM4NQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r515166385", "bodyText": "You guys can do whatever you want \ud83d\ude09  But if I may give my opinion, it looks really weird to be we have TracingContextUtils and no equivalent for BaggageUtils (why didn't we have public methods there, btw?)\nAlso, the specification says:\n\nthey MAY be exposed as static methods on the trace module, as static methods on a class inside the trace module (it MAY be named TracingContextUtilities), or on the Tracer class.\n\nSure, it only mentions the trace portion, but I would have hoped it would be similar for Baggage ;)", "author": "carlosalberto", "createdAt": "2020-10-30T15:06:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDMyMTM1MQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM0NjMyNg==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514346326", "bodyText": "Do we need this? People can compare with empty or can check for size of entries.", "author": "bogdandrutu", "createdAt": "2020-10-29T15:24:04Z", "path": "api/src/main/java/io/opentelemetry/api/baggage/Baggage.java", "diffHunk": "@@ -39,6 +39,23 @@ static Baggage current() {\n     return BaggageUtils.getCurrentBaggage();\n   }\n \n+  /**\n+   * Returns the {@link Baggage} from the specified {@link Context}, falling back to a empty {@link\n+   * Baggage} if there is no baggage in the context.\n+   */\n+  static Baggage fromContext(Context context) {\n+    return BaggageUtils.getBaggage(context);\n+  }\n+\n+  /**\n+   * Returns the {@link Baggage} from the specified {@link Context}, or {@code null} if there is no\n+   * baggage in the context.\n+   */\n+  @Nullable\n+  static Baggage fromContextOrNull(Context context) {", "originalCommit": "cba055c6b7221610ff7faf8b163f8811f75e8b19", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM0NjY0MQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514346641", "bodyText": "May be in a separate PR.", "author": "bogdandrutu", "createdAt": "2020-10-29T15:24:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM0NjMyNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM2NjExNQ==", "url": "https://github.com/open-telemetry/opentelemetry-java/pull/1916#discussion_r514366115", "bodyText": "+1", "author": "carlosalberto", "createdAt": "2020-10-29T15:48:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDM0NjMyNg=="}], "type": "inlineReview", "revised_code": null}]}