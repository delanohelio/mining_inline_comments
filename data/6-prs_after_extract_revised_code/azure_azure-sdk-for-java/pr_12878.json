{"pr_number": 12878, "pr_title": "Use Varargs in Model APIs", "pr_createdAt": "2020-07-07T22:58:31Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/12878", "timeline": [{"oid": "fd012ae2bd68dfca9bbd317cbd073fb20751f7fc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fd012ae2bd68dfca9bbd317cbd073fb20751f7fc", "message": "Move model list APIs to use varargs", "committedDate": "2020-07-07T22:27:55Z", "type": "commit"}, {"oid": "6bc1582d3ae05947c4c4ff22808d87f8f99c5148", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6bc1582d3ae05947c4c4ff22808d87f8f99c5148", "message": "Merge branch 'master' into AzSearch_ModelVarargsAndIterable", "committedDate": "2020-07-08T22:12:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTg2MjI3Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r451862276", "bodyText": "These shouldn't have to change. Input-output models should have setter overloads for both varargs and List.", "author": "srnagar", "createdAt": "2020-07-08T22:35:25Z", "path": "sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/implementation/converters/AnalyzeRequestConverter.java", "diffHunk": "@@ -35,15 +35,17 @@ public static AnalyzeTextOptions map(com.azure.search.documents.indexes.implemen\n         }\n \n         if (obj.getCharFilters() != null) {\n-            List<CharFilterName> charFilters =\n-                obj.getCharFilters().stream().map(CharFilterNameConverter::map).collect(Collectors.toList());\n+            CharFilterName[] charFilters = obj.getCharFilters().stream()\n+                .map(CharFilterNameConverter::map)\n+                .toArray(CharFilterName[]::new);\n             analyzeTextOptions.setCharFilters(charFilters);\n         }\n \n \n         if (obj.getTokenFilters() != null) {\n-            List<TokenFilterName> tokenFilters =\n-                obj.getTokenFilters().stream().map(TokenFilterNameConverter::map).collect(Collectors.toList());\n+            TokenFilterName[] tokenFilters = obj.getTokenFilters().stream()\n+                .map(TokenFilterNameConverter::map)\n+                .toArray(TokenFilterName[]::new);", "originalCommit": "fd012ae2bd68dfca9bbd317cbd073fb20751f7fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTkwMTQ5Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r451901493", "bodyText": "Reverted", "author": "alzimmermsft", "createdAt": "2020-07-09T00:46:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTg2MjI3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "292961a849e45bd204fcca0c3107d225fb359b19", "chunk": "diff --git a/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/implementation/converters/AnalyzeRequestConverter.java b/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/implementation/converters/AnalyzeRequestConverter.java\nindex 772c61783ea..c87bb381d7d 100644\n--- a/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/implementation/converters/AnalyzeRequestConverter.java\n+++ b/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/implementation/converters/AnalyzeRequestConverter.java\n\n@@ -35,18 +33,16 @@ public final class AnalyzeRequestConverter {\n         }\n \n         if (obj.getCharFilters() != null) {\n-            CharFilterName[] charFilters = obj.getCharFilters().stream()\n+            analyzeTextOptions.setCharFilters(obj.getCharFilters().stream()\n                 .map(CharFilterNameConverter::map)\n-                .toArray(CharFilterName[]::new);\n-            analyzeTextOptions.setCharFilters(charFilters);\n+                .collect(Collectors.toList()));\n         }\n \n \n         if (obj.getTokenFilters() != null) {\n-            TokenFilterName[] tokenFilters = obj.getTokenFilters().stream()\n+            analyzeTextOptions.setTokenFilters(obj.getTokenFilters().stream()\n                 .map(TokenFilterNameConverter::map)\n-                .toArray(TokenFilterName[]::new);\n-            analyzeTextOptions.setTokenFilters(tokenFilters);\n+                .collect(Collectors.toList()));\n         }\n \n \n"}}, {"oid": "d917ab6913669ce2e6abd2d3e0ce9247cdaec373", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d917ab6913669ce2e6abd2d3e0ce9247cdaec373", "message": "Add missing vararg and List overloads", "committedDate": "2020-07-08T23:10:28Z", "type": "commit"}, {"oid": "292961a849e45bd204fcca0c3107d225fb359b19", "url": "https://github.com/Azure/azure-sdk-for-java/commit/292961a849e45bd204fcca0c3107d225fb359b19", "message": "Added more vararg and List overloads, add JsonGetters to List overloads", "committedDate": "2020-07-09T00:44:05Z", "type": "commit"}, {"oid": "46a141a67a3b67fc39b29224975cd6de7178039e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/46a141a67a3b67fc39b29224975cd6de7178039e", "message": "Fix failing test", "committedDate": "2020-07-09T16:30:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MjA5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r452352094", "bodyText": "The options are input only", "author": "sima-zhu", "createdAt": "2020-07-09T16:44:24Z", "path": "sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/AnalyzeTextOptions.java", "diffHunk": "@@ -201,6 +204,20 @@ public LexicalTokenizerName getTokenizerName() {\n      * @param tokenFilters the tokenFilters value to set.\n      * @return the AnalyzeRequest object itself.\n      */\n+    public AnalyzeTextOptions setTokenFilters(TokenFilterName... tokenFilters) {", "originalCommit": "46a141a67a3b67fc39b29224975cd6de7178039e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1NjExNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r452356117", "bodyText": "We can leave the varargs setter here and remove the list one.", "author": "sima-zhu", "createdAt": "2020-07-09T16:51:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MjA5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM5NTE0NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r452395145", "bodyText": "Removed", "author": "alzimmermsft", "createdAt": "2020-07-09T18:00:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM1MjA5NA=="}], "type": "inlineReview", "revised_code": {"commit": "67740cca8370227d6308ca5624b661eccca5e6c4", "chunk": "diff --git a/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/AnalyzeTextOptions.java b/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/AnalyzeTextOptions.java\nindex c749b25df81..b96c467fb8d 100644\n--- a/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/AnalyzeTextOptions.java\n+++ b/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/AnalyzeTextOptions.java\n\n@@ -209,20 +208,6 @@ public final class AnalyzeTextOptions {\n         return this;\n     }\n \n-    /**\n-     * Set the tokenFilters property: An optional list of token filters to use\n-     * when breaking the given text. This parameter can only be set when using\n-     * the tokenizer parameter.\n-     *\n-     * @param tokenFilters the tokenFilters value to set.\n-     * @return the AnalyzeRequest object itself.\n-     */\n-    @JsonSetter\n-    public AnalyzeTextOptions setTokenFilters(List<TokenFilterName> tokenFilters) {\n-        this.tokenFilters = tokenFilters;\n-        return this;\n-    }\n-\n     /**\n      * Get the charFilters property: An optional list of character filters to\n      * use when breaking the given text. This parameter can only be set when\n"}}, {"oid": "67740cca8370227d6308ca5624b661eccca5e6c4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/67740cca8370227d6308ca5624b661eccca5e6c4", "message": "Remove list overload from input only model", "committedDate": "2020-07-09T17:43:16Z", "type": "commit"}, {"oid": "c051f0fdf851aa9078e5cc81e17020e840e3c9b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c051f0fdf851aa9078e5cc81e17020e840e3c9b4", "message": "Fix Java 8 toArray call", "committedDate": "2020-07-09T17:54:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQxODg0Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r452418842", "bodyText": "This should have a null check. Update this in other places too.\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.ignoreScripts = Arrays.asList(ignoreScripts);\n          \n          \n            \n                    this.ignoreScripts = ignoreScripts == null ? null : Arrays.asList(ignoreScripts);", "author": "srnagar", "createdAt": "2020-07-09T18:44:45Z", "path": "sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/CjkBigramTokenFilter.java", "diffHunk": "@@ -58,6 +61,18 @@ public CjkBigramTokenFilter(@JsonProperty(value = \"name\") String name) {\n      * @param ignoreScripts the ignoreScripts value to set.\n      * @return the CjkBigramTokenFilter object itself.\n      */\n+    public CjkBigramTokenFilter setIgnoreScripts(CjkBigramTokenFilterScripts... ignoreScripts) {\n+        this.ignoreScripts = Arrays.asList(ignoreScripts);", "originalCommit": "c051f0fdf851aa9078e5cc81e17020e840e3c9b4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQzNzA3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/12878#discussion_r452437075", "bodyText": "Added checks to all usage of varargs, additionally updated options models as well as they would run into the same issue.", "author": "alzimmermsft", "createdAt": "2020-07-09T19:19:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQxODg0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "f12dfb424cfeea11a1fad529aa04da5c91e16b13", "chunk": "diff --git a/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/CjkBigramTokenFilter.java b/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/CjkBigramTokenFilter.java\nindex 75ea9393040..9df7360dac2 100644\n--- a/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/CjkBigramTokenFilter.java\n+++ b/sdk/search/azure-search-documents/src/main/java/com/azure/search/documents/indexes/models/CjkBigramTokenFilter.java\n\n@@ -62,7 +62,7 @@ public final class CjkBigramTokenFilter extends TokenFilter {\n      * @return the CjkBigramTokenFilter object itself.\n      */\n     public CjkBigramTokenFilter setIgnoreScripts(CjkBigramTokenFilterScripts... ignoreScripts) {\n-        this.ignoreScripts = Arrays.asList(ignoreScripts);\n+        this.ignoreScripts = (ignoreScripts == null) ? null : Arrays.asList(ignoreScripts);\n         return this;\n     }\n \n"}}, {"oid": "f12dfb424cfeea11a1fad529aa04da5c91e16b13", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f12dfb424cfeea11a1fad529aa04da5c91e16b13", "message": "Add null checking validation for vararg overloads", "committedDate": "2020-07-09T19:18:13Z", "type": "commit"}]}