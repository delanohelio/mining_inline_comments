{"pr_number": 14795, "pr_title": "Stopping Pair<L, R> of implementation package from leaking into public surface area ", "pr_createdAt": "2020-09-03T21:59:39Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14795", "timeline": [{"oid": "b8dc1f0a917997cde51ac7b066c93935e41bc159", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b8dc1f0a917997cde51ac7b066c93935e41bc159", "message": "Removing Pair<L, R> of implementation package from leaking into public surface area for readMany API", "committedDate": "2020-09-03T21:54:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMxMzMyNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483313324", "bodyText": "@kushagraThapar this is a new public api\nFYI", "author": "moderakh", "createdAt": "2020-09-03T23:57:33Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java", "diffHunk": "@@ -0,0 +1,50 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.cosmos.models;\n+\n+/**\n+ * Encapsulates the PartitionKey/id tuple that uniquely identifies a CosmosItem\n+ */\n+public class CosmosItemIdentity {", "originalCommit": "b8dc1f0a917997cde51ac7b066c93935e41bc159", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzExNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483363117", "bodyText": "We should mark this as final class.", "author": "kushagraThapar", "createdAt": "2020-09-04T03:21:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMxMzMyNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwMzQ0MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483403440", "bodyText": "Fixed", "author": "FabianMeiswinkel", "createdAt": "2020-09-04T05:58:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMxMzMyNA=="}], "type": "inlineReview", "revised_code": {"commit": "f8b8930c592a08d42b18329f57fb6fc357e968f6", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java\nindex 7c3c4015aca..56ea1288c33 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java\n\n@@ -6,7 +6,7 @@ package com.azure.cosmos.models;\n /**\n  * Encapsulates the PartitionKey/id tuple that uniquely identifies a CosmosItem\n  */\n-public class CosmosItemIdentity {\n+public final class CosmosItemIdentity {\n     private final PartitionKey partitionKey;\n     private final String id;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMxMzQyMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483313422", "bodyText": "@FabianMeiswinkel shouldn't this class be marked with BETA annotation?", "author": "moderakh", "createdAt": "2020-09-03T23:57:53Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java", "diffHunk": "@@ -0,0 +1,50 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+\n+package com.azure.cosmos.models;\n+\n+/**\n+ * Encapsulates the PartitionKey/id tuple that uniquely identifies a CosmosItem\n+ */\n+public class CosmosItemIdentity {", "originalCommit": "b8dc1f0a917997cde51ac7b066c93935e41bc159", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2MzQzNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483363434", "bodyText": "We should discuss this.\n@FabianMeiswinkel  @moderakh - We have a release going out early next week, probably 9/8.\nIf we can finalize this soon, we will be able to get this in.", "author": "kushagraThapar", "createdAt": "2020-09-04T03:22:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMxMzQyMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwMzM3Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483403372", "bodyText": "Fixed", "author": "FabianMeiswinkel", "createdAt": "2020-09-04T05:57:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzMxMzQyMg=="}], "type": "inlineReview", "revised_code": {"commit": "f8b8930c592a08d42b18329f57fb6fc357e968f6", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java\nindex 7c3c4015aca..56ea1288c33 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/models/CosmosItemIdentity.java\n\n@@ -6,7 +6,7 @@ package com.azure.cosmos.models;\n /**\n  * Encapsulates the PartitionKey/id tuple that uniquely identifies a CosmosItem\n  */\n-public class CosmosItemIdentity {\n+public final class CosmosItemIdentity {\n     private final PartitionKey partitionKey;\n     private final String id;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2Mzk1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483363958", "bodyText": "These APIs are also in implementation layer, we have ability to still improve them. Shouldn't we change their signature to take CosmosItemIdentity ?", "author": "kushagraThapar", "createdAt": "2020-09-04T03:24:51Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/ItemOperations.java", "diffHunk": "@@ -53,7 +56,27 @@\n             throw new IllegalArgumentException(\"Parameter container is required and cannot be null.\");\n         }\n \n-        return container.readMany(itemKeyList, classType);\n+        return container.readMany(convertItemKeyList(itemKeyList), classType);", "originalCommit": "b8dc1f0a917997cde51ac7b066c93935e41bc159", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwMjAwMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483402001", "bodyText": "No - I left this intentionally to not break Adobe. Sounds like we told Adobe to take a dependency on this implementation package class. Whoever worked with Adobe on this needs to follow up with them and ask them to move to the ReadMany Api in the public surface area - only then we will be able to delete this class.", "author": "FabianMeiswinkel", "createdAt": "2020-09-04T05:53:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2Mzk1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQyNzM3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483427375", "bodyText": "Sounds good, makes sense.", "author": "kushagraThapar", "createdAt": "2020-09-04T07:03:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2Mzk1OA=="}], "type": "inlineReview", "revised_code": {"commit": "349595d6f9341f40021b6b545c76e9962d914f7f", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/ItemOperations.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/ItemOperations.java\nindex 72018b49329..070cc5af6a3 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/ItemOperations.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/ItemOperations.java\n\n@@ -63,7 +61,7 @@ final public class ItemOperations {\n         List<Pair<String, PartitionKey>> itemKeyList) {\n \n         if (itemKeyList != null) {\n-            List<CosmosItemIdentity> itemIdentities = new ArrayList<CosmosItemIdentity>(itemKeyList.size());\n+            List<CosmosItemIdentity> itemIdentities = new ArrayList<>(itemKeyList.size());\n             for (int i = 0; i < itemKeyList.size(); i++) {\n \n                 itemIdentities.set(\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NDAwOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483364008", "bodyText": "These APIs are also in implementation layer, we have ability to still improve them. Shouldn't we change their signature to take CosmosItemIdentity ?", "author": "kushagraThapar", "createdAt": "2020-09-04T03:24:58Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/ItemOperations.java", "diffHunk": "@@ -31,6 +33,7 @@\n     public static <T> FeedResponse<T> readMany(CosmosContainer container,", "originalCommit": "b8dc1f0a917997cde51ac7b066c93935e41bc159", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzQwMjEyMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14795#discussion_r483402120", "bodyText": "No - I left this intentionally to not break Adobe. Sounds like we told Adobe to take a dependency on this implementation package class. Whoever worked with Adobe on this needs to follow up with them and ask them to move to the ReadMany Api in the public surface area - only then we will be able to delete this class.", "author": "FabianMeiswinkel", "createdAt": "2020-09-04T05:53:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM2NDAwOA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "f8b8930c592a08d42b18329f57fb6fc357e968f6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f8b8930c592a08d42b18329f57fb6fc357e968f6", "message": "Making CosmosItemIdentity class sealed/final", "committedDate": "2020-09-04T05:55:51Z", "type": "commit"}, {"oid": "b07cc13cf172978f8fecb54b714ac8210875c085", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b07cc13cf172978f8fecb54b714ac8210875c085", "message": "Adding Beta-Annotation to CosmosItemIdentity", "committedDate": "2020-09-04T05:57:27Z", "type": "commit"}, {"oid": "bcc085bb6de2aa15638b0a95681d8cb489a8668d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/bcc085bb6de2aa15638b0a95681d8cb489a8668d", "message": "Fixing build error due to corrupt link after spring data samples were moved", "committedDate": "2020-09-04T09:10:36Z", "type": "commit"}, {"oid": "6f5da12db2203b2dc4543c09864c201d60b3e1f5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6f5da12db2203b2dc4543c09864c201d60b3e1f5", "message": "Merge branch 'master' of https://github.com/Azure/azure-sdk-for-java into users/fabianm/FixReadManyApiSurface", "committedDate": "2020-09-04T09:55:04Z", "type": "commit"}, {"oid": "349595d6f9341f40021b6b545c76e9962d914f7f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/349595d6f9341f40021b6b545c76e9962d914f7f", "message": "Fixing SpotBug issue in ItemOperations", "committedDate": "2020-09-04T10:35:23Z", "type": "commit"}, {"oid": "179a246130703f33a78ed5bdcc8298ef272ce762", "url": "https://github.com/Azure/azure-sdk-for-java/commit/179a246130703f33a78ed5bdcc8298ef272ce762", "message": "Fixing unit test failure due to conversion error in ItemOperations", "committedDate": "2020-09-04T13:31:10Z", "type": "commit"}]}