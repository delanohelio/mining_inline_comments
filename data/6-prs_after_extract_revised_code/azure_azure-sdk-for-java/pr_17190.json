{"pr_number": 17190, "pr_title": "[Service Bus] Option to disable autocomplete for processor", "pr_createdAt": "2020-11-05T01:31:11Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/17190", "timeline": [{"oid": "517166823c5e0c8be1142da021d74a4b63e44406", "url": "https://github.com/Azure/azure-sdk-for-java/commit/517166823c5e0c8be1142da021d74a4b63e44406", "message": "Option to disable autocomplete for processor", "committedDate": "2020-11-05T01:27:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MTMxOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17190#discussion_r517791319", "bodyText": "Do you have a check that if user did not call this but  set receivemode to RECEIVE AND DELETE, that is not allowed.\nWe can not auto complete in that mode.", "author": "hemanttanwar", "createdAt": "2020-11-05T04:51:43Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java", "diffHunk": "@@ -1191,6 +1205,20 @@ public ServiceBusProcessorClientBuilder maxConcurrentCalls(int maxConcurrentCall\n             return this;\n         }\n \n+        /**\n+         * Disables auto-complete and auto-abandon of received messages. By default, a successfully processed message is\n+         * {@link ServiceBusReceivedMessageContext#complete() completed}. If an error happens when\n+         * the message is processed, it is {@link ServiceBusReceivedMessageContext#abandon()\n+         * abandoned}.\n+         *\n+         * @return The modified {@link ServiceBusProcessorClientBuilder} object.\n+         */\n+        public ServiceBusProcessorClientBuilder disableAutoComplete() {", "originalCommit": "517166823c5e0c8be1142da021d74a4b63e44406", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzgwMjgxOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17190#discussion_r517802819", "bodyText": "That is for the underlying receiver to handle. If the mode is RECEIVE_AND_DELETE, FluxAutoComplete should not be enabled regardless of whether autocomplete is enabled or not.", "author": "srnagar", "createdAt": "2020-11-05T05:37:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MTMxOQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MTY5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17190#discussion_r517791695", "bodyText": "should accept be called if AutoComplete is disabled ?", "author": "hemanttanwar", "createdAt": "2020-11-05T04:53:21Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusProcessorClient.java", "diffHunk": "@@ -169,8 +169,10 @@ public void onNext(ServiceBusMessageContext serviceBusMessageContext) {\n                             processMessage.accept(serviceBusReceivedMessageContext);", "originalCommit": "517166823c5e0c8be1142da021d74a4b63e44406", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzgwMjk5OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17190#discussion_r517802998", "bodyText": "accept calls the user's message handler. It's not related to autoComplete", "author": "srnagar", "createdAt": "2020-11-05T05:38:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MTY5NQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MTk1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17190#discussion_r517791958", "bodyText": "Do you need to complete the message if isDisableAutoComplete() == false? This statement is from above,\"By default, a successfully processed message is * {@link ServiceBusReceivedMessageContext#complete() completed}\"", "author": "YijunXieMS", "createdAt": "2020-11-05T04:54:16Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusProcessorClient.java", "diffHunk": "@@ -169,8 +169,10 @@ public void onNext(ServiceBusMessageContext serviceBusMessageContext) {\n                             processMessage.accept(serviceBusReceivedMessageContext);", "originalCommit": "517166823c5e0c8be1142da021d74a4b63e44406", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzgwMzQ2OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17190#discussion_r517803469", "bodyText": "The underlying async receiver will do that automatically because I delegate that to the async client in the builder.", "author": "srnagar", "createdAt": "2020-11-05T05:39:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzc5MTk1OA=="}], "type": "inlineReview", "revised_code": null}]}