{"pr_number": 14244, "pr_title": "Support limiting query (Limiting is not supported #12726)", "pr_createdAt": "2020-08-19T03:04:46Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14244", "timeline": [{"oid": "c59fd43016c4cd0c2a3e0ef0a1904c4a8baf6860", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c59fd43016c4cd0c2a3e0ef0a1904c4a8baf6860", "message": "Support limiting query", "committedDate": "2020-08-19T02:19:16Z", "type": "commit"}, {"oid": "de35a5dd3542f1ef4f7676d6c012e51889cb7917", "url": "https://github.com/Azure/azure-sdk-for-java/commit/de35a5dd3542f1ef4f7676d6c012e51889cb7917", "message": "modify javadoc", "committedDate": "2020-08-19T03:31:12Z", "type": "commit"}, {"oid": "1901a1b95bbcdd2451ec0166c1ee0403d001bb11", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1901a1b95bbcdd2451ec0166c1ee0403d001bb11", "message": "modify javadoc", "committedDate": "2020-08-19T05:38:29Z", "type": "commit"}, {"oid": "152c8fff3b9bd2791abc2203ce019aa6188fb5df", "url": "https://github.com/Azure/azure-sdk-for-java/commit/152c8fff3b9bd2791abc2203ce019aa6188fb5df", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-19T06:13:30Z", "type": "commit"}, {"oid": "1c42fb7e53b952795f80be7922281b28aae0b8ca", "url": "https://github.com/Azure/azure-sdk-for-java/commit/1c42fb7e53b952795f80be7922281b28aae0b8ca", "message": "modify code style", "committedDate": "2020-08-19T06:18:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc2MzcxMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14244#discussion_r472763711", "bodyText": "We shouldn't bring the PartTree here since the PartTree is a kind of implementation, however, the CosmsQuery is an Abstraction class for CosmosQuery.", "author": "saragluna", "createdAt": "2020-08-19T06:38:54Z", "path": "sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/core/query/CosmosQuery.java", "diffHunk": "@@ -21,6 +22,8 @@\n \n     private Pageable pageable = Pageable.unpaged();\n \n+    private PartTree tree;", "originalCommit": "1c42fb7e53b952795f80be7922281b28aae0b8ca", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "daf83b7d3927bae7f74bcaf9f03da96435bf0745", "chunk": "diff --git a/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/core/query/CosmosQuery.java b/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/core/query/CosmosQuery.java\nindex 8fe865b39ae..168bc71fa81 100644\n--- a/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/core/query/CosmosQuery.java\n+++ b/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/core/query/CosmosQuery.java\n\n@@ -22,7 +22,7 @@ public class CosmosQuery {\n \n     private Pageable pageable = Pageable.unpaged();\n \n-    private PartTree tree;\n+    private int limit;\n \n     /**\n      * Initialization\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc2NDg5Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14244#discussion_r472764892", "bodyText": "We should pass the limit value to the query, instead of passing the PartTree object.", "author": "saragluna", "createdAt": "2020-08-19T06:40:32Z", "path": "sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/repository/query/PartTreeCosmosQuery.java", "diffHunk": "@@ -40,9 +39,7 @@ protected CosmosQuery createQuery(CosmosParameterAccessor accessor) {\n \n         final CosmosQuery query = creator.createQuery();\n \n-        if (tree.isLimiting()) {\n-            throw new NotImplementedException(\"Limiting is not supported.\");\n-        }\n+        query.setTree(tree);", "originalCommit": "1c42fb7e53b952795f80be7922281b28aae0b8ca", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "daf83b7d3927bae7f74bcaf9f03da96435bf0745", "chunk": "diff --git a/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/repository/query/PartTreeCosmosQuery.java b/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/repository/query/PartTreeCosmosQuery.java\nindex 14ca0906e1e..04759b9dd96 100644\n--- a/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/repository/query/PartTreeCosmosQuery.java\n+++ b/sdk/cosmos/azure-spring-data-cosmos-core/src/main/java/com/azure/spring/data/cosmos/repository/query/PartTreeCosmosQuery.java\n\n@@ -39,7 +40,9 @@ public class PartTreeCosmosQuery extends AbstractCosmosQuery {\n \n         final CosmosQuery query = creator.createQuery();\n \n-        query.setTree(tree);\n+        if (tree.isLimiting() && tree.getMaxResults() != null) {\n+            query.setLimit(tree.getMaxResults());\n+        }\n \n         return query;\n     }\n"}}, {"oid": "8311e2f5920aa2df90f394ce0ba9f463574c1865", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8311e2f5920aa2df90f394ce0ba9f463574c1865", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into dev", "committedDate": "2020-08-19T07:14:03Z", "type": "commit"}, {"oid": "daf83b7d3927bae7f74bcaf9f03da96435bf0745", "url": "https://github.com/Azure/azure-sdk-for-java/commit/daf83b7d3927bae7f74bcaf9f03da96435bf0745", "message": "modify", "committedDate": "2020-08-19T07:14:54Z", "type": "commit"}, {"oid": "27c0945752d1286ad96061bc17097bdfc7fd4fbd", "url": "https://github.com/Azure/azure-sdk-for-java/commit/27c0945752d1286ad96061bc17097bdfc7fd4fbd", "message": "modify", "committedDate": "2020-08-19T08:10:23Z", "type": "commit"}, {"oid": "d347cf81eaf5dc7523912f7fd8a5f29cd325c177", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d347cf81eaf5dc7523912f7fd8a5f29cd325c177", "message": "modify", "committedDate": "2020-08-19T08:46:29Z", "type": "commit"}, {"oid": "172301ce7921c64dc412308d4e8e444cc070580f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/172301ce7921c64dc412308d4e8e444cc070580f", "message": "modify", "committedDate": "2020-08-19T08:49:20Z", "type": "commit"}, {"oid": "67330bc0a718ecb2da54d4d06c20b1dddcefa0cc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/67330bc0a718ecb2da54d4d06c20b1dddcefa0cc", "message": "modify", "committedDate": "2020-08-19T09:20:57Z", "type": "commit"}, {"oid": "73ff047c781a9d59ab2b7d9b11768b5f9f9c25ad", "url": "https://github.com/Azure/azure-sdk-for-java/commit/73ff047c781a9d59ab2b7d9b11768b5f9f9c25ad", "message": "modify", "committedDate": "2020-08-19T09:46:39Z", "type": "commit"}, {"oid": "8d70ee863bdc4a7d97e1b656e8240b721d98a7a8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8d70ee863bdc4a7d97e1b656e8240b721d98a7a8", "message": "modify", "committedDate": "2020-08-20T02:56:47Z", "type": "commit"}, {"oid": "2b0c07a14a180ffc1787c74bdfb23615c7564114", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2b0c07a14a180ffc1787c74bdfb23615c7564114", "message": "modify", "committedDate": "2020-08-20T03:07:48Z", "type": "commit"}, {"oid": "d8d205cf47290eb01562dfdf34ceff8625fe3e17", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d8d205cf47290eb01562dfdf34ceff8625fe3e17", "message": "modify", "committedDate": "2020-08-20T03:32:15Z", "type": "commit"}, {"oid": "9e2ba8b2cabf366cd4f371c106aba6f2b59f1dce", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9e2ba8b2cabf366cd4f371c106aba6f2b59f1dce", "message": "modify", "committedDate": "2020-08-20T04:58:08Z", "type": "commit"}]}