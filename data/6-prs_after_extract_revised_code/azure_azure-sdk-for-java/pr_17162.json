{"pr_number": 17162, "pr_title": "Support to get transitive groups for authorization", "pr_createdAt": "2020-11-04T07:13:12Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/17162", "timeline": [{"oid": "cbb050a0ca8dc3c18d991e68943475fc30871d01", "url": "https://github.com/Azure/azure-sdk-for-java/commit/cbb050a0ca8dc3c18d991e68943475fc30871d01", "message": "Fix spring readme broken link; Support to get transitive groups for authorization, https://github.com/MicrosoftDocs/azure-dev-docs/issues/329", "committedDate": "2020-11-04T07:12:00Z", "type": "commit"}, {"oid": "283521d4e2bb5be48b8389ebec655cb56487f882", "url": "https://github.com/Azure/azure-sdk-for-java/commit/283521d4e2bb5be48b8389ebec655cb56487f882", "message": "Update unit testcase; fix build error", "committedDate": "2020-11-04T08:30:45Z", "type": "commit"}, {"oid": "da00934e4c7ac38dc14fde9347abf5ff0e20e253", "url": "https://github.com/Azure/azure-sdk-for-java/commit/da00934e4c7ac38dc14fde9347abf5ff0e20e253", "message": "fix checkstyle error", "committedDate": "2020-11-04T09:10:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMTQ4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517221482", "bodyText": "Why don't we have a static variable for this one?", "author": "saragluna", "createdAt": "2020-11-04T09:53:22Z", "path": "sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java", "diffHunk": "@@ -230,6 +240,11 @@ public void validateUserGroupProperties() {\n             throw new IllegalArgumentException(\"One of the User Group Properties must be populated. \"\n                 + \"Please populate azure.activedirectory.user-group.allowed-groups\");\n         }\n+        if (!DEFAULT_GROUP_RELATIONSHIP.equalsIgnoreCase(groupRelationship)\n+            && !\"transitive\".equalsIgnoreCase(groupRelationship)) {", "originalCommit": "da00934e4c7ac38dc14fde9347abf5ff0e20e253", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMzk2OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517233968", "bodyText": "Will add another one.", "author": "moarychan", "createdAt": "2020-11-04T10:13:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMTQ4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "9c34a1816652398530ef1791d70c4787780ec029", "chunk": "diff --git a/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java b/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\nindex 1b5f2f7b8a9..3cc59da933d 100644\n--- a/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\n+++ b/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\n\n@@ -240,9 +253,9 @@ public class AADAuthenticationProperties {\n             throw new IllegalArgumentException(\"One of the User Group Properties must be populated. \"\n                 + \"Please populate azure.activedirectory.user-group.allowed-groups\");\n         }\n-        if (!DEFAULT_GROUP_RELATIONSHIP.equalsIgnoreCase(groupRelationship)\n-            && !\"transitive\".equalsIgnoreCase(groupRelationship)) {\n-            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.group-relationship' \"\n+        if (!GROUP_RELATIONSHIP_DIRECT.equalsIgnoreCase(userGroup.groupRelationship)\n+            && !GROUP_RELATIONSHIP_TRANSITIVE.equalsIgnoreCase(userGroup.groupRelationship)) {\n+            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.user-group.group-relationship' \"\n                 + \"should be 'direct' or 'transitive'.\");\n         }\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMjAxMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517222012", "bodyText": "Is it better we call it xxx.user-group.xxx?", "author": "saragluna", "createdAt": "2020-11-04T09:54:06Z", "path": "sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java", "diffHunk": "@@ -230,6 +240,11 @@ public void validateUserGroupProperties() {\n             throw new IllegalArgumentException(\"One of the User Group Properties must be populated. \"\n                 + \"Please populate azure.activedirectory.user-group.allowed-groups\");\n         }\n+        if (!DEFAULT_GROUP_RELATIONSHIP.equalsIgnoreCase(groupRelationship)\n+            && !\"transitive\".equalsIgnoreCase(groupRelationship)) {\n+            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.group-relationship' \"", "originalCommit": "da00934e4c7ac38dc14fde9347abf5ff0e20e253", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzNDEyMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517234123", "bodyText": "Okay", "author": "moarychan", "createdAt": "2020-11-04T10:13:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMjAxMg=="}], "type": "inlineReview", "revised_code": {"commit": "9c34a1816652398530ef1791d70c4787780ec029", "chunk": "diff --git a/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java b/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\nindex 1b5f2f7b8a9..3cc59da933d 100644\n--- a/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\n+++ b/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\n\n@@ -240,9 +253,9 @@ public class AADAuthenticationProperties {\n             throw new IllegalArgumentException(\"One of the User Group Properties must be populated. \"\n                 + \"Please populate azure.activedirectory.user-group.allowed-groups\");\n         }\n-        if (!DEFAULT_GROUP_RELATIONSHIP.equalsIgnoreCase(groupRelationship)\n-            && !\"transitive\".equalsIgnoreCase(groupRelationship)) {\n-            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.group-relationship' \"\n+        if (!GROUP_RELATIONSHIP_DIRECT.equalsIgnoreCase(userGroup.groupRelationship)\n+            && !GROUP_RELATIONSHIP_TRANSITIVE.equalsIgnoreCase(userGroup.groupRelationship)) {\n+            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.user-group.group-relationship' \"\n                 + \"should be 'direct' or 'transitive'.\");\n         }\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMjY3MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517222671", "bodyText": "Is this used anymore?", "author": "saragluna", "createdAt": "2020-11-04T09:55:04Z", "path": "sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/ServiceEndpoints.java", "diffHunk": "@@ -44,4 +45,12 @@ public String getAadMembershipRestUri() {\n     public void setAadMembershipRestUri(String aadMembershipRestUri) {", "originalCommit": "da00934e4c7ac38dc14fde9347abf5ff0e20e253", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzNDc4MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517234781", "bodyText": "no, will use it by default", "author": "moarychan", "createdAt": "2020-11-04T10:14:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIyMjY3MQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "9c34a1816652398530ef1791d70c4787780ec029", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9c34a1816652398530ef1791d70c4787780ec029", "message": "Update according reviewer's comments", "committedDate": "2020-11-04T10:32:30Z", "type": "commit"}, {"oid": "6473315e1448427b2861ab47fad1d5f8fd2b94e4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6473315e1448427b2861ab47fad1d5f8fd2b94e4", "message": "Merge branch 'master' of github.com:Azure/azure-sdk-for-java into issue/aad-nested-group", "committedDate": "2020-11-05T06:15:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzEzODE1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/17162#discussion_r517138158", "bodyText": "should the string \"transitive\" be replaced with a final transitive here?", "author": "backwind1233", "createdAt": "2020-11-04T07:20:35Z", "path": "sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java", "diffHunk": "@@ -230,6 +239,11 @@ public void validateUserGroupProperties() {\n             throw new IllegalArgumentException(\"One of the User Group Properties must be populated. \"\n                 + \"Please populate azure.activedirectory.user-group.allowed-groups\");\n         }\n+        if (!DEFAULT_GROUP_RELATIONSHIP.equalsIgnoreCase(groupRelationship)\n+            && !\"transitive\".equalsIgnoreCase(groupRelationship)) {", "originalCommit": "cbb050a0ca8dc3c18d991e68943475fc30871d01", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9c34a1816652398530ef1791d70c4787780ec029", "chunk": "diff --git a/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java b/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\nindex 7c984b0d3f9..3cc59da933d 100644\n--- a/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\n+++ b/sdk/spring/azure-spring-boot/src/main/java/com/azure/spring/autoconfigure/aad/AADAuthenticationProperties.java\n\n@@ -239,9 +253,9 @@ public class AADAuthenticationProperties {\n             throw new IllegalArgumentException(\"One of the User Group Properties must be populated. \"\n                 + \"Please populate azure.activedirectory.user-group.allowed-groups\");\n         }\n-        if (!DEFAULT_GROUP_RELATIONSHIP.equalsIgnoreCase(groupRelationship)\n-            && !\"transitive\".equalsIgnoreCase(groupRelationship)) {\n-            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.group-relationship' \"\n+        if (!GROUP_RELATIONSHIP_DIRECT.equalsIgnoreCase(userGroup.groupRelationship)\n+            && !GROUP_RELATIONSHIP_TRANSITIVE.equalsIgnoreCase(userGroup.groupRelationship)) {\n+            throw new IllegalArgumentException(\"Configuration 'azure.activedirectory.user-group.group-relationship' \"\n                 + \"should be 'direct' or 'transitive'.\");\n         }\n     }\n"}}]}