{"pr_number": 14727, "pr_title": "Fixed netty leak on DELETE operations in GATEWAY mode", "pr_createdAt": "2020-09-02T07:07:09Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14727", "timeline": [{"oid": "dc360a5107519b41059f7cb69a3ff822b2b899fc", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dc360a5107519b41059f7cb69a3ff822b2b899fc", "message": "Fixed netty leak on DELETE operations in GATEWAY mode", "committedDate": "2020-09-02T00:27:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI1MDg3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14727#discussion_r482250875", "bodyText": "what this change for ?", "author": "simplynaveen20", "createdAt": "2020-09-02T17:40:36Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/http/ReactorNettyClient.java", "diffHunk": "@@ -197,11 +197,7 @@ public HttpHeaders headers() {\n         @Override\n         public Flux<ByteBuf> body() {\n             return bodyIntern()\n-                .doOnSubscribe(this::updateSubscriptionState)\n-                .map(byteBuf -> {\n-                    byteBuf.retain();\n-                    return byteBuf;\n-                });\n+                .doOnSubscribe(this::updateSubscriptionState);", "originalCommit": "dc360a5107519b41059f7cb69a3ff822b2b899fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI2NDg5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14727#discussion_r482264894", "bodyText": "Just removed the unnecessary map operator. We don't need to retain the byteBuf here, as it is not released afterwards.\nThis can potentially raise IllegalReferenceCount issue with netty.\nAlthough, we don't use this API, which is why no one has seen this issue.", "author": "kushagraThapar", "createdAt": "2020-09-02T18:04:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjI1MDg3NQ=="}], "type": "inlineReview", "revised_code": null}]}