{"pr_number": 16027, "pr_title": "Add locale support for Form recognizer prebuilt API's ", "pr_createdAt": "2020-10-07T07:13:00Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/16027", "timeline": [{"oid": "f92f75978eacd02e8608175d6cb7411dc595c7dd", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f92f75978eacd02e8608175d6cb7411dc595c7dd", "message": "update tests and snippets", "committedDate": "2020-10-14T06:32:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MTQ5Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r504781492", "bodyText": "is it normal for Java to pass empty string instead of null into the request if the user doesn't specify a param?", "author": "kristapratico", "createdAt": "2020-10-14T15:41:52Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java", "diffHunk": "@@ -538,11 +542,18 @@\n             Objects.requireNonNull(receipt, \"'receipt' is required and cannot be null.\");\n             recognizeReceiptsOptions = getRecognizeReceiptOptions(recognizeReceiptsOptions);\n             final boolean isFieldElementsIncluded = recognizeReceiptsOptions.isFieldElementsIncluded();\n+            final String localeInfo\n+                = recognizeReceiptsOptions.getLocale() == null ? \"\" : recognizeReceiptsOptions.getLocale();", "originalCommit": "f92f75978eacd02e8608175d6cb7411dc595c7dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTAzODYxMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r505038610", "bodyText": "does the service behavior changes if \"\" is sent instead of not passing anything?", "author": "maririos", "createdAt": "2020-10-14T22:48:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MTQ5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA0NjQ3OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r505046478", "bodyText": "is it normal for Java to pass empty string instead of null into the request if the user doesn't specify a param?\n\nSo, Java doesn't need to default to \"\" when the user doesn't specify. I initially had test recordings with \"\" so tests were failing. Will update the PR with this change and updated recordings.\n\ndoes the service behavior changes if \"\" is sent instead of not passing anything?\n\nDon't know about the service behavior but the url changes from includeTextDetails=false&locale=  when specified (\"\") to includeTextDetails=false\" when null.\ncc: @kristapratico @maririos", "author": "samvaity", "createdAt": "2020-10-14T23:00:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MTQ5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5MDQ5NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r505090494", "bodyText": "yeah I expect the url to change. I haven't done tests here so idk the service behavior but it will be good to validate before making an assumption.\nI remember in TA, for example, sending \"\" for Language is different than not sending the language parameter", "author": "maririos", "createdAt": "2020-10-15T00:10:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MTQ5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkwNTExMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r505905112", "bodyText": "Talked offline, currently, the client just passes down the supplied value by the user.", "author": "samvaity", "createdAt": "2020-10-15T22:43:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDc4MTQ5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "4636d20eeaf6539b1c4d3bd213ccb91935a6466b", "chunk": "diff --git a/sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java b/sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java\nindex be42b659198..3a0f666203c 100644\n--- a/sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java\n+++ b/sdk/formrecognizer/azure-ai-formrecognizer/src/main/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClient.java\n\n@@ -542,8 +551,7 @@ public final class FormRecognizerAsyncClient {\n             Objects.requireNonNull(receipt, \"'receipt' is required and cannot be null.\");\n             recognizeReceiptsOptions = getRecognizeReceiptOptions(recognizeReceiptsOptions);\n             final boolean isFieldElementsIncluded = recognizeReceiptsOptions.isFieldElementsIncluded();\n-            final String localeInfo\n-                = recognizeReceiptsOptions.getLocale() == null ? \"\" : recognizeReceiptsOptions.getLocale();\n+            final String localeInfo = recognizeReceiptsOptions.getLocale();\n             return new PollerFlux<>(\n                 recognizeReceiptsOptions.getPollInterval(),\n                 streamActivationOperation(\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA0MDc4NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r505040785", "bodyText": "Is the idea to always set it in the samples?", "author": "maririos", "createdAt": "2020-10-14T22:51:56Z", "path": "sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java", "diffHunk": "@@ -355,6 +355,7 @@ public void beginRecognizeReceiptsFromUrlWithOptions() {\n         formRecognizerAsyncClient.beginRecognizeReceiptsFromUrl(receiptUrl,\n             new RecognizeReceiptsOptions()\n                 .setFieldElementsIncluded(includeFieldElements)\n+                .setLocale(\"en-US\")", "originalCommit": "f92f75978eacd02e8608175d6cb7411dc595c7dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA0MTc5OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/16027#discussion_r505041798", "bodyText": "I just wanted to showcase this feature and thought samples would be a good way to do it.", "author": "samvaity", "createdAt": "2020-10-14T22:53:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA0MDc4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "5ced675946bec4a37a8af3f881bb2d52ac618ba2", "chunk": "diff --git a/sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java b/sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java\nindex 9ee0c774f71..b7ed79f0bb6 100644\n--- a/sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java\n+++ b/sdk/formrecognizer/azure-ai-formrecognizer/src/samples/java/com/azure/ai/formrecognizer/FormRecognizerAsyncClientJavaDocCodeSnippets.java\n\n@@ -355,7 +356,6 @@ public class FormRecognizerAsyncClientJavaDocCodeSnippets {\n         formRecognizerAsyncClient.beginRecognizeReceiptsFromUrl(receiptUrl,\n             new RecognizeReceiptsOptions()\n                 .setFieldElementsIncluded(includeFieldElements)\n-                .setLocale(\"en-US\")\n                 .setPollInterval(Duration.ofSeconds(5)))\n             .flatMap(AsyncPollResponse::getFinalResult)\n             .subscribe(recognizedReceipts -> {\n"}}, {"oid": "4636d20eeaf6539b1c4d3bd213ccb91935a6466b", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4636d20eeaf6539b1c4d3bd213ccb91935a6466b", "message": "update recordings for no locale param", "committedDate": "2020-10-15T00:24:16Z", "type": "forcePushed"}, {"oid": "5ced675946bec4a37a8af3f881bb2d52ac618ba2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5ced675946bec4a37a8af3f881bb2d52ac618ba2", "message": "add locale support for receipts", "committedDate": "2020-10-15T19:11:30Z", "type": "commit"}, {"oid": "e8af95b89e47aea85b2bc90c104a2776b14d8923", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e8af95b89e47aea85b2bc90c104a2776b14d8923", "message": "update tests and snippets", "committedDate": "2020-10-15T19:23:33Z", "type": "commit"}, {"oid": "e352ec269fbd10a13e75ba27ef90cf00b75f768d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e352ec269fbd10a13e75ba27ef90cf00b75f768d", "message": "update recordings for no locale param", "committedDate": "2020-10-15T19:25:38Z", "type": "commit"}, {"oid": "f4cacf5e2d2be5559ae144367a47a54328eab883", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f4cacf5e2d2be5559ae144367a47a54328eab883", "message": "update test recording", "committedDate": "2020-10-15T19:25:42Z", "type": "commit"}, {"oid": "f4cacf5e2d2be5559ae144367a47a54328eab883", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f4cacf5e2d2be5559ae144367a47a54328eab883", "message": "update test recording", "committedDate": "2020-10-15T19:25:42Z", "type": "forcePushed"}, {"oid": "f420f141f715d1940e845e9771bbee715d94a0de", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f420f141f715d1940e845e9771bbee715d94a0de", "message": "rebase changes", "committedDate": "2020-10-15T20:06:28Z", "type": "commit"}, {"oid": "f420f141f715d1940e845e9771bbee715d94a0de", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f420f141f715d1940e845e9771bbee715d94a0de", "message": "rebase changes", "committedDate": "2020-10-15T20:06:28Z", "type": "forcePushed"}, {"oid": "13d81bdff71375f79136b9e5a75b9d86c372fa1a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/13d81bdff71375f79136b9e5a75b9d86c372fa1a", "message": "update defaulting and add business cards locale support", "committedDate": "2020-10-15T22:28:21Z", "type": "commit"}, {"oid": "a060f7abc944dff2a849242be5531908a2df464e", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a060f7abc944dff2a849242be5531908a2df464e", "message": "remove US receipt references", "committedDate": "2020-10-15T22:42:27Z", "type": "commit"}, {"oid": "d1bd4d37723eebd179db3f8d53e6ba28c519573c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d1bd4d37723eebd179db3f8d53e6ba28c519573c", "message": "checkstyle", "committedDate": "2020-10-16T01:11:33Z", "type": "commit"}]}