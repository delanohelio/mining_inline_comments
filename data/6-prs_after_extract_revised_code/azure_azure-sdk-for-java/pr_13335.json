{"pr_number": 13335, "pr_title": "Added support to seal an append blob", "pr_createdAt": "2020-07-20T17:20:13Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/13335", "timeline": [{"oid": "dee85ed30b8266efeb38b6c7677c9d887ed9b32a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dee85ed30b8266efeb38b6c7677c9d887ed9b32a", "message": "Added methods for appendSeal", "committedDate": "2020-07-17T16:47:47Z", "type": "commit"}, {"oid": "4778d3fd9ea0575f0033d632f0056d23dc5e9c03", "url": "https://github.com/Azure/azure-sdk-for-java/commit/4778d3fd9ea0575f0033d632f0056d23dc5e9c03", "message": "Added logic to pass appendSeal to copy", "committedDate": "2020-07-17T19:26:51Z", "type": "commit"}, {"oid": "f80647e9e6ea47467d5ade902f6f1eac31952688", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f80647e9e6ea47467d5ade902f6f1eac31952688", "message": "Merge branch 'master' into storage/appendSeal", "committedDate": "2020-07-17T19:28:09Z", "type": "commit"}, {"oid": "65ed29b9bba51917c314c7495a1a65a505272431", "url": "https://github.com/Azure/azure-sdk-for-java/commit/65ed29b9bba51917c314c7495a1a65a505272431", "message": "Added sealed to getproperties and list blobs", "committedDate": "2020-07-17T19:44:35Z", "type": "commit"}, {"oid": "598000baade29e785491d67a7a32af3b0e07915a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/598000baade29e785491d67a7a32af3b0e07915a", "message": "Added code for seal append blob", "committedDate": "2020-07-20T17:19:10Z", "type": "commit"}, {"oid": "e8969a26bd4e1c1fb2af93b704b4bae472e37dbe", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e8969a26bd4e1c1fb2af93b704b4bae472e37dbe", "message": "Added changelog", "committedDate": "2020-07-20T17:21:54Z", "type": "commit"}, {"oid": "adac2dc589ed9603595fbcfba88825f21f44b698", "url": "https://github.com/Azure/azure-sdk-for-java/commit/adac2dc589ed9603595fbcfba88825f21f44b698", "message": "Changed named of sealed to destinationSealed", "committedDate": "2020-07-20T17:24:52Z", "type": "commit"}, {"oid": "47f8ec9c974437f72f453636f3bdfa04740bed89", "url": "https://github.com/Azure/azure-sdk-for-java/commit/47f8ec9c974437f72f453636f3bdfa04740bed89", "message": "Added append blob seal test records", "committedDate": "2020-07-20T17:35:49Z", "type": "commit"}, {"oid": "d7b6f793207e94d6997ed80b51ae986f7a2d6025", "url": "https://github.com/Azure/azure-sdk-for-java/commit/d7b6f793207e94d6997ed80b51ae986f7a2d6025", "message": "Added param tag to getProperties", "committedDate": "2020-07-20T18:44:49Z", "type": "commit"}, {"oid": "ee5d423e47a424b055ca34f42bf41a6e995acff8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ee5d423e47a424b055ca34f42bf41a6e995acff8", "message": "Merge branch 'master' into storage/appendSeal", "committedDate": "2020-07-20T19:07:34Z", "type": "commit"}, {"oid": "dc3c8c02436e26cb70d5eca16267cf62326999a7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dc3c8c02436e26cb70d5eca16267cf62326999a7", "message": "Added javadoc stuff", "committedDate": "2020-07-20T19:31:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY1OTY5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457659695", "bodyText": "I think \"sealDestination\" makes more sense to me because it's something that will happen in the future whereas \"destinationSealed\" sounds like it's commenting on the past/current state. I'm not really sure what you would use for the getter, though, because \"isSealDestination\" doesn't really work. Also not sure if this was already resolved in .NET", "author": "rickle-msft", "createdAt": "2020-07-20T20:03:24Z", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobBeginCopyOptions.java", "diffHunk": "@@ -26,6 +26,7 @@\n     private RequestConditions sourceRequestConditions;\n     private BlobRequestConditions destinationRequestConditions;\n     private Duration pollInterval;\n+    private Boolean destinationSealed;", "originalCommit": "dc3c8c02436e26cb70d5eca16267cf62326999a7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY4MzMwMw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457683303", "bodyText": "modified", "author": "gapra-msft", "createdAt": "2020-07-20T20:49:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY1OTY5NQ=="}], "type": "inlineReview", "revised_code": {"commit": "95bc0d8a810ece2ad01622e613a08cf1f79c7946", "chunk": "diff --git a/sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobBeginCopyOptions.java b/sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobBeginCopyOptions.java\nindex 2ea14281d67..de42e1a1f16 100644\n--- a/sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobBeginCopyOptions.java\n+++ b/sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/options/BlobBeginCopyOptions.java\n\n@@ -26,7 +26,7 @@ public class BlobBeginCopyOptions {\n     private RequestConditions sourceRequestConditions;\n     private BlobRequestConditions destinationRequestConditions;\n     private Duration pollInterval;\n-    private Boolean destinationSealed;\n+    private Boolean sealDestination;\n \n     /**\n      * @param sourceUrl The source URL to copy from. URLs outside of Azure may only be copied to block blobs.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2MDA3MA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457660070", "bodyText": "Is there a Rest doc we can link to?", "author": "rickle-msft", "createdAt": "2020-07-20T20:04:06Z", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/specialized/AppendBlobAsyncClient.java", "diffHunk": "@@ -367,4 +368,55 @@\n                 return new SimpleResponse<>(rb, item);\n             });\n     }\n+\n+    /**\n+     * Seals an append blob, making it read only. Any subsequent appends will fail.\n+     *", "originalCommit": "dc3c8c02436e26cb70d5eca16267cf62326999a7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2MDY1Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457660653", "bodyText": "I couldnt find a REST doc for this", "author": "gapra-msft", "createdAt": "2020-07-20T20:05:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2MDA3MA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2MTM0Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457661347", "bodyText": "Sorry to keep asking this, but it looks like we decided to allow null for options when they don't have a required value?", "author": "rickle-msft", "createdAt": "2020-07-20T20:06:39Z", "path": "sdk/storage/azure-storage-blob/src/main/java/com/azure/storage/blob/specialized/AppendBlobAsyncClient.java", "diffHunk": "@@ -367,4 +368,55 @@\n                 return new SimpleResponse<>(rb, item);\n             });\n     }\n+\n+    /**\n+     * Seals an append blob, making it read only. Any subsequent appends will fail.\n+     *\n+     * <p><strong>Code Samples</strong></p>\n+     *\n+     * {@codesnippet com.azure.storage.blob.specialized.AppendBlobAsyncClient.seal}\n+     *\n+     * @return A reactive response signalling completion.\n+     */\n+    public Mono<Void> seal() {\n+        try {\n+            return sealWithResponse(new AppendBlobSealOptions())\n+                .flatMap(FluxUtil::toMono);\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    /**\n+     * Seals an append blob, making it read only. Any subsequent appends will fail.\n+     *\n+     * <p><strong>Code Samples</strong></p>\n+     *\n+     * {@codesnippet com.azure.storage.blob.specialized.AppendBlobAsyncClient.sealWithResponse#AppendBlobSealOptions}\n+     *\n+     * @param options {@link AppendBlobSealOptions}\n+     * @return A reactive response signalling completion.\n+     */\n+    public Mono<Response<Void>> sealWithResponse(AppendBlobSealOptions options) {\n+        try {\n+            return withContext(context -> sealWithResponse(options, context));\n+        } catch (RuntimeException ex) {\n+            return monoError(logger, ex);\n+        }\n+    }\n+\n+    Mono<Response<Void>> sealWithResponse(AppendBlobSealOptions options, Context context) {\n+        options = (options == null) ? new AppendBlobSealOptions() : options;", "originalCommit": "dc3c8c02436e26cb70d5eca16267cf62326999a7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2NjM5Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457666393", "bodyText": "yeah I noticed that we do allow null for options when they dont have a required value. Im gonna create a PR after this making them all have this functionality - just didnt want to have this PR do 2 things at once", "author": "gapra-msft", "createdAt": "2020-07-20T20:16:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2MTM0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY3MzYyMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/13335#discussion_r457673620", "bodyText": "#13339", "author": "gapra-msft", "createdAt": "2020-07-20T20:30:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzY2MTM0Nw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "95bc0d8a810ece2ad01622e613a08cf1f79c7946", "url": "https://github.com/Azure/azure-sdk-for-java/commit/95bc0d8a810ece2ad01622e613a08cf1f79c7946", "message": "renamed methods in BeginCopyOptions", "committedDate": "2020-07-20T20:49:35Z", "type": "commit"}]}