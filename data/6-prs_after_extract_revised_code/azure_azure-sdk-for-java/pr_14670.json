{"pr_number": 14670, "pr_title": "Implement decommission APIs for Models", "pr_createdAt": "2020-08-31T23:51:44Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/14670", "timeline": [{"oid": "5046cc75ee1bf913e9e72c28915d7ba8b2540167", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5046cc75ee1bf913e9e72c28915d7ba8b2540167", "message": "Implement the last 2 Model APIs", "committedDate": "2020-08-31T23:51:00Z", "type": "commit"}, {"oid": "b4d4727ae6eed39278561d8c538ac4fba9dc13d9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b4d4727ae6eed39278561d8c538ac4fba9dc13d9", "message": "Update API design.md", "committedDate": "2020-08-31T23:51:19Z", "type": "commit"}, {"oid": "ab5dba61ffa6fffad1cf011e22f94993bfe59831", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ab5dba61ffa6fffad1cf011e22f94993bfe59831", "message": "Update API design.md", "committedDate": "2020-08-31T23:54:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MDAxMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480480012", "bodyText": "can be replaced with method reference:\n.map(Response::getValue);", "author": "abhipsaMisra", "createdAt": "2020-08-31T23:56:58Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -593,8 +594,8 @@ public HttpPipeline getHttpPipeline() {\n      */\n     @ServiceMethod(returns = ReturnType.SINGLE)\n     public Mono<ModelData> getModel(String modelId) {\n-        return withContext(context -> getModelWithResponse(modelId, context))\n-            .flatMap(response -> Mono.just(response.getValue()));\n+        return getModelWithResponse(modelId)\n+            .map(response -> response.getValue());", "originalCommit": "b4d4727ae6eed39278561d8c538ac4fba9dc13d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MDEyMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480480120", "bodyText": "you fancy", "author": "azabbasi", "createdAt": "2020-08-31T23:57:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MDAxMg=="}], "type": "inlineReview", "revised_code": {"commit": "affd379b84e553d226ce45b53c569aca0bccb4a3", "chunk": "diff --git a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java\nindex d8ac1b2d926..8f54858ee32 100644\n--- a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java\n+++ b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java\n\n@@ -595,7 +595,7 @@ public final class DigitalTwinsAsyncClient {\n     @ServiceMethod(returns = ReturnType.SINGLE)\n     public Mono<ModelData> getModel(String modelId) {\n         return getModelWithResponse(modelId)\n-            .map(response -> response.getValue());\n+            .map(Response::getValue);\n     }\n \n     /**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MDExNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480480117", "bodyText": "same here as well :)", "author": "abhipsaMisra", "createdAt": "2020-08-31T23:57:24Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -665,8 +666,8 @@ public HttpPipeline getHttpPipeline() {\n      */\n     @ServiceMethod(returns = ReturnType.SINGLE)\n     public Mono<Void> deleteModel(String modelId) {\n-        return withContext(context -> deleteModelWithResponse(modelId, context))\n-            .flatMap(response -> Mono.just(response.getValue()));\n+        return deleteModelWithResponse(modelId)\n+            .map(response -> response.getValue());", "originalCommit": "b4d4727ae6eed39278561d8c538ac4fba9dc13d9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "affd379b84e553d226ce45b53c569aca0bccb4a3", "chunk": "diff --git a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java\nindex d8ac1b2d926..8f54858ee32 100644\n--- a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java\n+++ b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java\n\n@@ -667,7 +667,7 @@ public final class DigitalTwinsAsyncClient {\n     @ServiceMethod(returns = ReturnType.SINGLE)\n     public Mono<Void> deleteModel(String modelId) {\n         return deleteModelWithResponse(modelId)\n-            .map(response -> response.getValue());\n+            .map(Response::getValue);\n     }\n \n     /**\n"}}, {"oid": "affd379b84e553d226ce45b53c569aca0bccb4a3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/affd379b84e553d226ce45b53c569aca0bccb4a3", "message": "use method reference when applicable.", "committedDate": "2020-08-31T23:59:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MTI3NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480481275", "bodyText": "Return type here should be the keyword void, not the Void class type.", "author": "abhipsaMisra", "createdAt": "2020-09-01T00:01:09Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java", "diffHunk": "@@ -365,6 +366,21 @@ public Void deleteModel(String modelId) {\n         return digitalTwinsAsyncClient.deleteModelWithResponse(modelId, context).block();\n     }\n \n-    //TODO: Decommission Model APIs (waiting for Abhipsa's change to come in)\n+    /**\n+     * Decommissions a model.\n+     * @param modelId The Id of the model to decommission.\n+     * @return Void\n+     */\n+    public Void decommissionModel(String modelId) {", "originalCommit": "b4d4727ae6eed39278561d8c538ac4fba9dc13d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MjI1Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480482257", "bodyText": "The more you know.", "author": "drwill-ms", "createdAt": "2020-09-01T00:04:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MTI3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "c4286605cf8d80d55d136b73ee0323cada3c6a12", "chunk": "diff --git a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java\nindex c2fb9cd74eb..79208aadc9d 100644\n--- a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java\n+++ b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java\n\n@@ -371,8 +370,8 @@ public final class DigitalTwinsClient {\n      * @param modelId The Id of the model to decommission.\n      * @return Void\n      */\n-    public Void decommissionModel(String modelId) {\n-        return digitalTwinsAsyncClient.decommissionModel(modelId).block();\n+    public void decommissionModel(String modelId) {\n+        decommissionModelWithResponse(modelId, Context.NONE);\n     }\n \n     /**\n"}}, {"oid": "7f4ae9710fabb56b0b9fb0183b98df8e26557815", "url": "https://github.com/Azure/azure-sdk-for-java/commit/7f4ae9710fabb56b0b9fb0183b98df8e26557815", "message": "cleanup imports", "committedDate": "2020-09-01T00:01:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MjgyNg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480482826", "bodyText": "No need of this", "author": "bikamani", "createdAt": "2020-09-01T00:06:39Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java", "diffHunk": "@@ -365,6 +365,21 @@ public Void deleteModel(String modelId) {\n         return digitalTwinsAsyncClient.deleteModelWithResponse(modelId, context).block();\n     }\n \n-    //TODO: Decommission Model APIs (waiting for Abhipsa's change to come in)\n+    /**\n+     * Decommissions a model.\n+     * @param modelId The Id of the model to decommission.\n+     * @return Void", "originalCommit": "7f4ae9710fabb56b0b9fb0183b98df8e26557815", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4NjIwNA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480486204", "bodyText": "Yeah, javadocs only have the @ return if it returns something other than void. We'll still need them for cases like Mono, but here you can remove it", "author": "timtay-microsoft", "createdAt": "2020-09-01T00:12:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4MjgyNg=="}], "type": "inlineReview", "revised_code": {"commit": "c4286605cf8d80d55d136b73ee0323cada3c6a12", "chunk": "diff --git a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java\nindex 5c5b54294ac..79208aadc9d 100644\n--- a/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java\n+++ b/sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsClient.java\n\n@@ -370,8 +370,8 @@ public final class DigitalTwinsClient {\n      * @param modelId The Id of the model to decommission.\n      * @return Void\n      */\n-    public Void decommissionModel(String modelId) {\n-        return digitalTwinsAsyncClient.decommissionModel(modelId).block();\n+    public void decommissionModel(String modelId) {\n+        decommissionModelWithResponse(modelId, Context.NONE);\n     }\n \n     /**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4Mzc5OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480483799", "bodyText": "why we need to write this return?", "author": "bikamani", "createdAt": "2020-09-01T00:08:41Z", "path": "sdk/digitaltwins/azure-digitaltwins-core/src/main/java/com/azure/digitaltwins/core/DigitalTwinsAsyncClient.java", "diffHunk": "@@ -683,11 +684,36 @@ public HttpPipeline getHttpPipeline() {\n         return protocolLayer.getDigitalTwinModels().deleteWithResponseAsync(modelId, context);\n     }\n \n-    //TODO: Decommission Model APIs (waiting for Abhipsa's change to come in)\n     PagedFlux<String> listRelationships(String digitalTwinId, String relationshipName, Context context) {\n         return new PagedFlux<>(\n             () -> listRelationshipsFirstPage(digitalTwinId, relationshipName, context),\n             nextLink -> listRelationshipsNextPage(nextLink, context));\n     }\n \n+    /**\n+     * Decommissions a model.\n+     * @param modelId The Id of the model to decommission.\n+     * @return an empty Mono", "originalCommit": "7f4ae9710fabb56b0b9fb0183b98df8e26557815", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4NTg1NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/14670#discussion_r480485855", "bodyText": "java doc analyzer will complain if there is no return section in the comments for publicly facing APIs", "author": "azabbasi", "createdAt": "2020-09-01T00:11:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDQ4Mzc5OQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "c4286605cf8d80d55d136b73ee0323cada3c6a12", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c4286605cf8d80d55d136b73ee0323cada3c6a12", "message": "Update DigitalTwinsClient.java", "committedDate": "2020-09-01T00:11:11Z", "type": "commit"}, {"oid": "16c1414e935ac10f7bf21fbe03d8654d115e1eb0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/16c1414e935ac10f7bf21fbe03d8654d115e1eb0", "message": "Update DigitalTwinsClient.java", "committedDate": "2020-09-01T00:21:28Z", "type": "commit"}]}