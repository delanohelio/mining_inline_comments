{"pr_number": 11272, "pr_title": "Updates API based on feedback", "pr_createdAt": "2020-05-19T02:09:17Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/11272", "timeline": [{"oid": "9ff648646602ae58c9af70e37f2852bbf8742bd2", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9ff648646602ae58c9af70e37f2852bbf8742bd2", "message": "Update synchronous receive sample.", "committedDate": "2020-05-18T21:46:17Z", "type": "commit"}, {"oid": "fc1b1d82d0aeb7b6ba494310a1ab2c6f426439ac", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fc1b1d82d0aeb7b6ba494310a1ab2c6f426439ac", "message": "Remove ReceiveAsyncOptions and fix build breaks.", "committedDate": "2020-05-18T21:46:18Z", "type": "commit"}, {"oid": "5f7f1c90a09b92b9b177aa260d6ae5a4da6e9698", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5f7f1c90a09b92b9b177aa260d6ae5a4da6e9698", "message": "update peek -> browse()", "committedDate": "2020-05-18T21:46:18Z", "type": "commit"}, {"oid": "79834ee26d95eac02626f58988ace3354e557c93", "url": "https://github.com/Azure/azure-sdk-for-java/commit/79834ee26d95eac02626f58988ace3354e557c93", "message": "Fixing build breaks.", "committedDate": "2020-05-18T21:46:19Z", "type": "commit"}, {"oid": "672fca9423ee1509340a77913b46bd2be375d388", "url": "https://github.com/Azure/azure-sdk-for-java/commit/672fca9423ee1509340a77913b46bd2be375d388", "message": "Update peek -> browse", "committedDate": "2020-05-18T21:46:19Z", "type": "commit"}, {"oid": "ed9dd9b9e2d63bc58e44fd54a5374980113fcbdf", "url": "https://github.com/Azure/azure-sdk-for-java/commit/ed9dd9b9e2d63bc58e44fd54a5374980113fcbdf", "message": "Add support for maximum lock renewal time.", "committedDate": "2020-05-18T22:51:35Z", "type": "commit"}, {"oid": "c0ccc2f74e741f2425cee18012b0d23e10f9caa4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c0ccc2f74e741f2425cee18012b0d23e10f9caa4", "message": "Fix samples.", "committedDate": "2020-05-18T22:58:47Z", "type": "commit"}, {"oid": "61167877063ec42092d68a8d1ab93987b7d5d659", "url": "https://github.com/Azure/azure-sdk-for-java/commit/61167877063ec42092d68a8d1ab93987b7d5d659", "message": "Fix completion with sessionId.", "committedDate": "2020-05-18T23:48:46Z", "type": "commit"}, {"oid": "43948ca5aadfcd9da8638b5737588c94feaba2d7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/43948ca5aadfcd9da8638b5737588c94feaba2d7", "message": "Fix checkstyle issues in samples.", "committedDate": "2020-05-18T23:58:49Z", "type": "commit"}, {"oid": "9669971e423aa132b967d57e52f4f7756119b328", "url": "https://github.com/Azure/azure-sdk-for-java/commit/9669971e423aa132b967d57e52f4f7756119b328", "message": "Update tests.", "committedDate": "2020-05-19T01:01:07Z", "type": "commit"}, {"oid": "8fbe30913e39d49dd5b5469257e1fdbec265d547", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8fbe30913e39d49dd5b5469257e1fdbec265d547", "message": "Adding integration tag.", "committedDate": "2020-05-19T01:02:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwMTg3OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11272#discussion_r427001879", "bodyText": "Might want to change documentation to reflect autoLockRenewalEnabled.", "author": "hemanttanwar", "createdAt": "2020-05-19T02:58:40Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ReceiverOptions.java", "diffHunk": "@@ -15,26 +17,38 @@\n     private final boolean isRollingSessionReceiver;\n     private final Integer maxConcurrentSessions;\n     private final boolean isSessionReceiver;\n+    private final Duration maxAutoLockRenewalDuration;\n \n-    ReceiverOptions(ReceiveMode receiveMode, int prefetchCount) {\n+    ReceiverOptions(ReceiveMode receiveMode, int prefetchCount, Duration maxAutoLockRenewalDuration) {\n         this.receiveMode = receiveMode;\n         this.prefetchCount = prefetchCount;\n+        this.maxAutoLockRenewalDuration = maxAutoLockRenewalDuration;\n         this.sessionId = null;\n         this.isRollingSessionReceiver = false;\n         this.maxConcurrentSessions = null;\n         this.isSessionReceiver = false;\n     }\n \n-    ReceiverOptions(ReceiveMode receiveMode, int prefetchCount, String sessionId,\n-        boolean isRollingSessionReceiver, Integer maxConcurrentSessions) {\n+    ReceiverOptions(ReceiveMode receiveMode, int prefetchCount, Duration maxAutoLockRenewalDuration,\n+        String sessionId, boolean isRollingSessionReceiver, Integer maxConcurrentSessions) {\n         this.receiveMode = receiveMode;\n         this.prefetchCount = prefetchCount;\n+        this.maxAutoLockRenewalDuration = maxAutoLockRenewalDuration;\n         this.sessionId = sessionId;\n         this.isRollingSessionReceiver = isRollingSessionReceiver;\n         this.maxConcurrentSessions = maxConcurrentSessions;\n         this.isSessionReceiver = true;\n     }\n \n+    /**\n+     * Gets whether or not the receiver is a session-aware receiver.\n+     *\n+     * @return true if it is a session-aware receiver; false otherwise.\n+     */", "originalCommit": "8fbe30913e39d49dd5b5469257e1fdbec265d547", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c85b81acf753da52359ab2fe43a9bbcabe0fe84d", "chunk": "diff --git a/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ReceiverOptions.java b/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ReceiverOptions.java\nindex 4cb2d67c72d..06a9a4ac643 100644\n--- a/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ReceiverOptions.java\n+++ b/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ReceiverOptions.java\n\n@@ -41,9 +41,10 @@ class ReceiverOptions {\n     }\n \n     /**\n-     * Gets whether or not the receiver is a session-aware receiver.\n+     * Gets whether or not auto-lock renewal is enabled. If the receiver is a session aware receiver, it renews the lock\n+     * for the entire session; otherwise, renews the lock for each message.\n      *\n-     * @return true if it is a session-aware receiver; false otherwise.\n+     * @return true if it renews the session or message lock; false otherwise.\n      */\n     boolean autoLockRenewalEnabled() {\n         return maxAutoLockRenewalDuration != null && maxAutoLockRenewalDuration != Duration.ZERO;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwMjYzNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11272#discussion_r427002637", "bodyText": "Explain little bit about If there are multiple session This would apply on each session separately.", "author": "hemanttanwar", "createdAt": "2020-05-19T03:01:59Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java", "diffHunk": "@@ -542,16 +549,29 @@ public ServiceBusSenderClient buildClient() {\n         private String sessionId;\n         private String subscriptionName;\n         private String topicName;\n+        private Duration maxAutoLockRenewalDuration;\n \n         private ServiceBusSessionReceiverClientBuilder() {\n         }\n \n+        /**\n+         * Enables auto-lock renewal by renewing session lock renewal until the {@code maxAutoLockRenewalDuration} has\n+         * elapsed.", "originalCommit": "8fbe30913e39d49dd5b5469257e1fdbec265d547", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c85b81acf753da52359ab2fe43a9bbcabe0fe84d", "chunk": "diff --git a/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java b/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\nindex 9895d2c8d33..32127b31606 100644\n--- a/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\n+++ b/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\n\n@@ -555,7 +555,7 @@ public final class ServiceBusClientBuilder {\n         }\n \n         /**\n-         * Enables auto-lock renewal by renewing session lock renewal until the {@code maxAutoLockRenewalDuration} has\n+         * Enables auto-lock renewal by renewing each session lock until the {@code maxAutoLockRenewalDuration} has\n          * elapsed.\n          *\n          * @param maxAutoLockRenewalDuration Maximum amount of time to renew the session lock.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAwMzAxNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/11272#discussion_r427003017", "bodyText": "This documentation should be for non session receiver because this builder belongs to non-session entities.", "author": "hemanttanwar", "createdAt": "2020-05-19T03:03:35Z", "path": "sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java", "diffHunk": "@@ -734,10 +760,23 @@ private boolean isRollingSessionReceiver() {\n         private ReceiveMode receiveMode = ReceiveMode.PEEK_LOCK;\n         private String subscriptionName;\n         private String topicName;\n+        private Duration maxAutoLockRenewalDuration;\n \n         private ServiceBusReceiverClientBuilder() {\n         }\n \n+        /**\n+         * Enables auto-lock renewal by renewing session lock renewal until the {@code maxAutoLockRenewalDuration} has\n+         * elapsed.\n+         *\n+         * @param maxAutoLockRenewalDuration Maximum amount of time to renew the session lock.\n+         * @return The modified {@link ServiceBusReceiverClientBuilder} object.", "originalCommit": "8fbe30913e39d49dd5b5469257e1fdbec265d547", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c85b81acf753da52359ab2fe43a9bbcabe0fe84d", "chunk": "diff --git a/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java b/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\nindex 9895d2c8d33..32127b31606 100644\n--- a/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\n+++ b/sdk/servicebus/azure-messaging-servicebus/src/main/java/com/azure/messaging/servicebus/ServiceBusClientBuilder.java\n\n@@ -766,8 +766,8 @@ public final class ServiceBusClientBuilder {\n         }\n \n         /**\n-         * Enables auto-lock renewal by renewing session lock renewal until the {@code maxAutoLockRenewalDuration} has\n-         * elapsed.\n+         * Enables auto-lock renewal by renewing each message lock renewal until the {@code maxAutoLockRenewalDuration}\n+         * has elapsed.\n          *\n          * @param maxAutoLockRenewalDuration Maximum amount of time to renew the session lock.\n          * @return The modified {@link ServiceBusReceiverClientBuilder} object.\n"}}, {"oid": "c85b81acf753da52359ab2fe43a9bbcabe0fe84d", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c85b81acf753da52359ab2fe43a9bbcabe0fe84d", "message": "Fix documentation. Add overload for String.", "committedDate": "2020-05-19T03:24:26Z", "type": "commit"}]}