{"pr_number": 8075, "pr_title": "Moving CosmosItemProperties to implementation", "pr_createdAt": "2020-02-10T07:41:28Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/8075", "timeline": [{"oid": "754fdd38c9c048952c3aff8bba57f884f97bd4a1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/754fdd38c9c048952c3aff8bba57f884f97bd4a1", "message": "Moving CosmosItemProperties to implementation\nRemoving CosmosItemProperties from public surface of the SDK\nMoved the ChangeFeedProcessor to use JsonNode instead of CosmosItemProperties\nRefactoring Item tests.", "committedDate": "2020-02-10T01:33:48Z", "type": "commit"}, {"oid": "f110c19db1b1fd2407ba0f250a7220a5183be858", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f110c19db1b1fd2407ba0f250a7220a5183be858", "message": "Adding header", "committedDate": "2020-02-10T01:34:55Z", "type": "commit"}, {"oid": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "message": "fixing test", "committedDate": "2020-02-10T08:34:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMTg0Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377221846", "bodyText": "can we use slf4j for logger? instead of printStackTrace", "author": "moderakh", "createdAt": "2020-02-10T17:55:20Z", "path": "sdk/cosmos/azure-cosmos-examples/src/main/java/com/azure/cosmos/examples/ChangeFeed/SampleChangeFeedProcessor.java", "diffHunk": "@@ -88,11 +95,16 @@ public static ChangeFeedProcessor getChangeFeedProcessor(String hostName, Cosmos\n             .setHostName(hostName)\n             .setFeedContainer(feedContainer)\n             .setLeaseContainer(leaseContainer)\n-            .setHandleChanges(docs -> {\n+            .setHandleChanges((List<JsonNode> docs) -> {\n                 System.out.println(\"--->setHandleChanges() START\");\n \n-                for (CosmosItemProperties document : docs) {\n-                    System.out.println(\"---->DOCUMENT RECEIVED: \" + document.toJson(SerializationFormattingPolicy.INDENTED));\n+                for (JsonNode document : docs) {\n+                    try {\n+                        System.out.println(\"---->DOCUMENT RECEIVED: \" + OBJECT_MAPPER.writerWithDefaultPrettyPrinter()\n+                                                                            .writeValueAsString(document));\n+                    } catch (JsonProcessingException e) {\n+                        e.printStackTrace();", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI4ODQ5Ng==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377288496", "bodyText": "Done", "author": "mbhaskar", "createdAt": "2020-02-10T20:07:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMTg0Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMjQ0Mw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377222443", "bodyText": "For query we are still doing double deserialization. am I right?", "author": "moderakh", "createdAt": "2020-02-10T17:56:35Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncContainer.java", "diffHunk": "@@ -351,13 +349,18 @@ public String getId() {\n             setContinuationTokenAndMaxItemCount(pagedFluxOptions, feedOptions);\n             return getDatabase().getDocClientWrapper().queryDocuments(CosmosAsyncContainer.this.getLink(), sqlQuerySpec, feedOptions)\n                                             .map(response ->\n-                                                BridgeInternal.createFeedResponseWithQueryMetrics((\n-                                                    CosmosItemProperties.getTypedResultsFromV2Results((List<Document>)(Object)response.getResults(), klass)),\n-                                                    response.getResponseHeaders(),\n-                                                    response.queryMetrics()));\n+                                                     prepareFeedResponse(response, klass));\n         });\n     }\n \n+    private <T> FeedResponse<T> prepareFeedResponse(FeedResponse<Document> response, Class<T> klass){\n+        return BridgeInternal.createFeedResponseWithQueryMetrics(\n+            (response.getResults().stream().map(document -> document.toObject(klass))", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5MTQzOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377291439", "bodyText": "So what happens here is we donot convert it to json again, we parse the existing propertyBag into the userobject. For JsonNode/ObjectNode we just cast the propertybag", "author": "mbhaskar", "createdAt": "2020-02-10T20:13:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMjQ0Mw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMzI4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377223282", "bodyText": "why are we adding these new methods?", "author": "moderakh", "createdAt": "2020-02-10T17:58:11Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java", "diffHunk": "@@ -51,21 +57,99 @@ public T getResource(){\n      */\n     public CosmosItemProperties getProperties() {\n         ensureCosmosItemPropertiesInitialized();\n-        return super.getProperties();\n+        return props;\n     }\n \n     private void ensureCosmosItemPropertiesInitialized() {\n-        if (super.getProperties() == null) {\n-            synchronized (this) {\n-                if (super.getProperties() == null) {\n-                    if (StringUtils.isEmpty(responseBodyString)){\n-                        super.setProperties(null);\n-                    } else {\n-                        CosmosItemProperties props = new CosmosItemProperties(responseBodyString);\n-                        super.setProperties(props);\n-                    }\n-                }\n+        synchronized (this) {\n+            if (StringUtils.isEmpty(responseBodyString)) {\n+                props = null;\n+            } else {\n+                props = new CosmosItemProperties(responseBodyString);\n             }\n+\n         }\n     }\n+\n+    /**\n+     * Gets the maximum size limit for this entity (in megabytes (MB) for server resources and in count for master\n+     * resources).\n+     *\n+     * @return the max resource quota.\n+     */\n+    public String getMaxResourceQuota() {\n+        return resourceResponse.getMaxResourceQuota();\n+    }\n+\n+    /**\n+     * Gets the current size of this entity (in megabytes (MB) for server resources and in count for master resources)\n+     *\n+     * @return the current resource quota usage.\n+     */\n+    public String getCurrentResourceQuotaUsage() {\n+        return resourceResponse.getCurrentResourceQuotaUsage();\n+    }\n+\n+    /**\n+     * Gets the Activity ID for the request.\n+     *\n+     * @return the activity getId.\n+     */\n+    public String getActivityId() {\n+        return resourceResponse.getActivityId();\n+    }\n+\n+    /**\n+     * Gets the number of index paths (terms) generated by the operation.\n+     *\n+     * @return the request charge.\n+     */\n+    public double getRequestCharge() {\n+        return resourceResponse.getRequestCharge();\n+    }\n+\n+    /**\n+     * Gets the HTTP status code associated with the response.\n+     *\n+     * @return the status code.\n+     */\n+    public int getStatusCode() {\n+        return resourceResponse.getStatusCode();\n+    }\n+\n+    /**\n+     * Gets the token used for managing client's consistency requirements.\n+     *\n+     * @return the session token.\n+     */\n+    public String getSessionToken() {\n+        return resourceResponse.getSessionToken();\n+    }\n+\n+    /**\n+     * Gets the headers associated with the response.\n+     *\n+     * @return the response headers.\n+     */\n+    public Map<String, String> getResponseHeaders() {\n+        return resourceResponse.getResponseHeaders();\n+    }", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5MTczMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377291730", "bodyText": "Because Cosmos*ItemResponse no longer extendes CosmosResponse. So we have to provide all these methods direclty", "author": "mbhaskar", "createdAt": "2020-02-10T20:14:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMzI4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "df9736c999aa06c72bfce3cd8ccea84517677035", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\nindex aa9b0b8b5ef..20eebe866d3 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\n\n@@ -55,7 +55,7 @@ public class CosmosAsyncItemResponse<T> {\n      *\n      * @return the itemProperties\n      */\n-    public CosmosItemProperties getProperties() {\n+    CosmosItemProperties getProperties() {\n         ensureCosmosItemPropertiesInitialized();\n         return props;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMzU4Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377223582", "bodyText": "same, why are we adding these new methods?", "author": "moderakh", "createdAt": "2020-02-10T17:58:49Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosItemResponse.java", "diffHunk": "@@ -25,4 +29,86 @@ public CosmosItemProperties getProperties() {\n         return responseWrapper.getProperties();\n     }\n \n+    /**\n+     * Gets the maximum size limit for this entity (in megabytes (MB) for server resources and in count for master\n+     * resources).\n+     *\n+     * @return the max resource quota.\n+     */\n+    public String getMaxResourceQuota() {\n+        return responseWrapper.getMaxResourceQuota();\n+    }\n+\n+    /**\n+     * Gets the current size of this entity (in megabytes (MB) for server resources and in count for master resources)\n+     *\n+     * @return the current resource quota usage.\n+     */\n+    public String getCurrentResourceQuotaUsage() {\n+        return responseWrapper.getCurrentResourceQuotaUsage();\n+    }\n+\n+    /**\n+     * Gets the Activity ID for the request.\n+     *\n+     * @return the activity getId.\n+     */\n+    public String getActivityId() {\n+        return responseWrapper.getActivityId();\n+    }\n+\n+    /**\n+     * Gets the number of index paths (terms) generated by the operation.\n+     *\n+     * @return the request charge.\n+     */\n+    public double getRequestCharge() {\n+        return responseWrapper.getRequestCharge();\n+    }\n+\n+    /**\n+     * Gets the HTTP status code associated with the response.\n+     *\n+     * @return the status code.\n+     */\n+    public int getStatusCode() {\n+        return responseWrapper.getStatusCode();\n+    }\n+\n+    /**\n+     * Gets the token used for managing client's consistency requirements.\n+     *\n+     * @return the session token.\n+     */\n+    public String getSessionToken() {\n+        return responseWrapper.getSessionToken();\n+    }\n+\n+    /**\n+     * Gets the headers associated with the response.\n+     *\n+     * @return the response headers.\n+     */\n+    public Map<String, String> getResponseHeaders() {\n+        return responseWrapper.getResponseHeaders();\n+    }", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5MTc2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377291765", "bodyText": "Because Cosmos*ItemResponse no longer extendes CosmosResponse. So we have to provide all these methods direclty", "author": "mbhaskar", "createdAt": "2020-02-10T20:14:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyMzU4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "df9736c999aa06c72bfce3cd8ccea84517677035", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosItemResponse.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosItemResponse.java\nindex 219d92b127e..90e9ff41238 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosItemResponse.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosItemResponse.java\n\n@@ -25,7 +25,7 @@ public class CosmosItemResponse<T> {\n      *\n      * @return the itemSettings\n      */\n-    public CosmosItemProperties getProperties() {\n+    CosmosItemProperties getProperties() {\n         return responseWrapper.getProperties();\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNTY4OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377225689", "bodyText": "does document.toObject(JsonNode.class) return a reference to internal propertybag or does it copy data?", "author": "moderakh", "createdAt": "2020-02-10T18:02:58Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/changefeed/implementation/ChangeFeedContextClientImpl.java", "diffHunk": "@@ -82,15 +84,16 @@ public ChangeFeedContextClientImpl(CosmosAsyncContainer cosmosContainer, Schedul\n     }\n \n     @Override\n-    public Flux<FeedResponse<CosmosItemProperties>> createDocumentChangeFeedQuery(CosmosAsyncContainer collectionLink, ChangeFeedOptions feedOptions) {\n+    public Flux<FeedResponse<JsonNode>> createDocumentChangeFeedQuery(CosmosAsyncContainer collectionLink,\n+                                                                      ChangeFeedOptions feedOptions) {\n         AsyncDocumentClient clientWrapper =\n             CosmosBridgeInternal.getAsyncDocumentClient(collectionLink.getDatabase());\n-        Flux<FeedResponse<CosmosItemProperties>> feedResponseFlux =\n+        Flux<FeedResponse<JsonNode>> feedResponseFlux =\n             clientWrapper.queryDocumentChangeFeed(BridgeInternal.extractContainerSelfLink(collectionLink), feedOptions)\n                                                                     .map(response -> {\n-                                                                        List<CosmosItemProperties> results = response.getResults()\n+                                                                        List<JsonNode> results = response.getResults()\n                                                                                                                      .stream()\n-                                                                                                                     .map(document -> new CosmosItemProperties(document.toJson()))\n+                                                                                                                     .map(document -> document.toObject(JsonNode.class))", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5MjE0MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377292141", "bodyText": "It returns a reference and doesnt copy data", "author": "mbhaskar", "createdAt": "2020-02-10T20:15:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNTY4OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNjQyMA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377226420", "bodyText": "jdk.nashorn.internal.ir.ObjectNode is this the correct ObjectNode type? shouldn't this be jackson?", "author": "moderakh", "createdAt": "2020-02-10T18:04:32Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ChangeFeedProcessorTest.java", "diffHunk": "@@ -12,15 +12,20 @@\n import com.azure.cosmos.CosmosClientBuilder;\n import com.azure.cosmos.CosmosContainerProperties;\n import com.azure.cosmos.CosmosContainerRequestOptions;\n-import com.azure.cosmos.CosmosItemProperties;\n+import com.azure.cosmos.implementation.CosmosItemProperties;\n import com.azure.cosmos.CosmosItemRequestOptions;\n import com.azure.cosmos.FeedOptions;\n import com.azure.cosmos.PartitionKey;\n import com.azure.cosmos.SerializationFormattingPolicy;\n import com.azure.cosmos.SqlParameter;\n import com.azure.cosmos.SqlParameterList;\n import com.azure.cosmos.SqlQuerySpec;\n+import com.azure.cosmos.implementation.Utils;\n import com.azure.cosmos.implementation.changefeed.ServiceItemLease;\n+import com.fasterxml.jackson.core.JsonProcessingException;\n+import com.fasterxml.jackson.databind.JsonNode;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import jdk.nashorn.internal.ir.ObjectNode;", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzI5MjIyNw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377292227", "bodyText": "Unused imports, removed.", "author": "mbhaskar", "createdAt": "2020-02-10T20:15:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzIyNjQyMA=="}], "type": "inlineReview", "revised_code": {"commit": "f55c1feba7f5f198ef01c9d054f8cfb5bc8943dd", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ChangeFeedProcessorTest.java b/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ChangeFeedProcessorTest.java\nindex f63034c7f82..668293c818e 100644\n--- a/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ChangeFeedProcessorTest.java\n+++ b/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/rx/ChangeFeedProcessorTest.java\n\n@@ -12,20 +12,18 @@ import com.azure.cosmos.CosmosAsyncItemResponse;\n import com.azure.cosmos.CosmosClientBuilder;\n import com.azure.cosmos.CosmosContainerProperties;\n import com.azure.cosmos.CosmosContainerRequestOptions;\n-import com.azure.cosmos.implementation.CosmosItemProperties;\n import com.azure.cosmos.CosmosItemRequestOptions;\n import com.azure.cosmos.FeedOptions;\n import com.azure.cosmos.PartitionKey;\n-import com.azure.cosmos.SerializationFormattingPolicy;\n import com.azure.cosmos.SqlParameter;\n import com.azure.cosmos.SqlParameterList;\n import com.azure.cosmos.SqlQuerySpec;\n+import com.azure.cosmos.implementation.CosmosItemProperties;\n import com.azure.cosmos.implementation.Utils;\n import com.azure.cosmos.implementation.changefeed.ServiceItemLease;\n import com.fasterxml.jackson.core.JsonProcessingException;\n import com.fasterxml.jackson.databind.JsonNode;\n import com.fasterxml.jackson.databind.ObjectMapper;\n-import jdk.nashorn.internal.ir.ObjectNode;\n import org.apache.commons.lang3.RandomStringUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n"}}, {"oid": "f55c1feba7f5f198ef01c9d054f8cfb5bc8943dd", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f55c1feba7f5f198ef01c9d054f8cfb5bc8943dd", "message": "Addressing pr comments", "committedDate": "2020-02-10T20:07:15Z", "type": "commit"}, {"oid": "fa2eaed3e03496409312eaf5b7d8118687c1f67f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/fa2eaed3e03496409312eaf5b7d8118687c1f67f", "message": "Merge branch 'feature/cosmos/upstream-v4' into v4/removing-cosmositemproperties\n\n# Conflicts:\n#\tsdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/implementation/RxDocumentClientImpl.java\n#\tsdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/CosmosKeyCredentialTest.java\n#\tsdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/CosmosPartitionKeyTests.java", "committedDate": "2020-02-10T20:21:58Z", "type": "commit"}, {"oid": "eb73f40d6b526822c497103c233ee136c89960b4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/eb73f40d6b526822c497103c233ee136c89960b4", "message": "Fixing issue", "committedDate": "2020-02-10T21:35:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM0ODEzMg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377348132", "bodyText": "This is already available in cosmosResponseDiagnostics exposed above. duplicate ways of getting the same thing", "author": "moderakh", "createdAt": "2020-02-10T22:13:07Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java", "diffHunk": "@@ -51,21 +57,99 @@ public T getResource(){\n      */\n     public CosmosItemProperties getProperties() {\n         ensureCosmosItemPropertiesInitialized();\n-        return super.getProperties();\n+        return props;\n     }\n \n     private void ensureCosmosItemPropertiesInitialized() {\n-        if (super.getProperties() == null) {\n-            synchronized (this) {\n-                if (super.getProperties() == null) {\n-                    if (StringUtils.isEmpty(responseBodyString)){\n-                        super.setProperties(null);\n-                    } else {\n-                        CosmosItemProperties props = new CosmosItemProperties(responseBodyString);\n-                        super.setProperties(props);\n-                    }\n-                }\n+        synchronized (this) {\n+            if (StringUtils.isEmpty(responseBodyString)) {\n+                props = null;\n+            } else {\n+                props = new CosmosItemProperties(responseBodyString);\n             }\n+\n         }\n     }\n+\n+    /**\n+     * Gets the maximum size limit for this entity (in megabytes (MB) for server resources and in count for master\n+     * resources).\n+     *\n+     * @return the max resource quota.\n+     */\n+    public String getMaxResourceQuota() {\n+        return resourceResponse.getMaxResourceQuota();\n+    }\n+\n+    /**\n+     * Gets the current size of this entity (in megabytes (MB) for server resources and in count for master resources)\n+     *\n+     * @return the current resource quota usage.\n+     */\n+    public String getCurrentResourceQuotaUsage() {\n+        return resourceResponse.getCurrentResourceQuotaUsage();\n+    }\n+\n+    /**\n+     * Gets the Activity ID for the request.\n+     *\n+     * @return the activity getId.\n+     */\n+    public String getActivityId() {\n+        return resourceResponse.getActivityId();\n+    }\n+\n+    /**\n+     * Gets the number of index paths (terms) generated by the operation.\n+     *\n+     * @return the request charge.\n+     */\n+    public double getRequestCharge() {\n+        return resourceResponse.getRequestCharge();\n+    }\n+\n+    /**\n+     * Gets the HTTP status code associated with the response.\n+     *\n+     * @return the status code.\n+     */\n+    public int getStatusCode() {\n+        return resourceResponse.getStatusCode();\n+    }\n+\n+    /**\n+     * Gets the token used for managing client's consistency requirements.\n+     *\n+     * @return the session token.\n+     */\n+    public String getSessionToken() {\n+        return resourceResponse.getSessionToken();\n+    }\n+\n+    /**\n+     * Gets the headers associated with the response.\n+     *\n+     * @return the response headers.\n+     */\n+    public Map<String, String> getResponseHeaders() {\n+        return resourceResponse.getResponseHeaders();\n+    }\n+\n+    /**\n+     * Gets the diagnostics information for the current request to Azure Cosmos DB service.\n+     *\n+     * @return diagnostics information for the current request to Azure Cosmos DB service.\n+     */\n+    public CosmosResponseDiagnostics getCosmosResponseDiagnostics() {\n+        return resourceResponse.getCosmosResponseDiagnostics();\n+    }\n+\n+    /**\n+     * Gets the end-to-end request latency for the current request to Azure Cosmos DB service.\n+     *\n+     * @return end-to-end request latency for the current request to Azure Cosmos DB service.\n+     */\n+    public Duration getRequestLatency() {\n+        return resourceResponse.getRequestLatency();", "originalCommit": "2fc5c3efaa0397ceceb7b62fa58c70b6505e896a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "df9736c999aa06c72bfce3cd8ccea84517677035", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\nindex aa9b0b8b5ef..20eebe866d3 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\n\n@@ -55,7 +55,7 @@ public class CosmosAsyncItemResponse<T> {\n      *\n      * @return the itemProperties\n      */\n-    public CosmosItemProperties getProperties() {\n+    CosmosItemProperties getProperties() {\n         ensureCosmosItemPropertiesInitialized();\n         return props;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM3ODUwMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r377378501", "bodyText": "This should not be public", "author": "mbhaskar", "createdAt": "2020-02-10T23:28:58Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java", "diffHunk": "@@ -51,21 +57,99 @@ public T getResource(){\n      */\n     public CosmosItemProperties getProperties() {", "originalCommit": "fa2eaed3e03496409312eaf5b7d8118687c1f67f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3ODAzNTc0Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8075#discussion_r378035742", "bodyText": "Done", "author": "mbhaskar", "createdAt": "2020-02-12T04:29:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzM3ODUwMQ=="}], "type": "inlineReview", "revised_code": {"commit": "df9736c999aa06c72bfce3cd8ccea84517677035", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\nindex aa9b0b8b5ef..20eebe866d3 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosAsyncItemResponse.java\n\n@@ -55,7 +55,7 @@ public class CosmosAsyncItemResponse<T> {\n      *\n      * @return the itemProperties\n      */\n-    public CosmosItemProperties getProperties() {\n+    CosmosItemProperties getProperties() {\n         ensureCosmosItemPropertiesInitialized();\n         return props;\n     }\n"}}, {"oid": "db39962c6076f089d93df27fd4d51b88847e3d1f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/db39962c6076f089d93df27fd4d51b88847e3d1f", "message": "Fixing test failure", "committedDate": "2020-02-11T02:31:26Z", "type": "commit"}, {"oid": "140e672380141e1d997e05084434d99bf60147a5", "url": "https://github.com/Azure/azure-sdk-for-java/commit/140e672380141e1d997e05084434d99bf60147a5", "message": "Merge branch 'feature/cosmos/upstream-v4' into v4/removing-cosmositemproperties\n\n# Conflicts:\n#\tsdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosContainer.java\n#\tsdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/CosmosItemTest.java", "committedDate": "2020-02-12T04:18:37Z", "type": "commit"}, {"oid": "df9736c999aa06c72bfce3cd8ccea84517677035", "url": "https://github.com/Azure/azure-sdk-for-java/commit/df9736c999aa06c72bfce3cd8ccea84517677035", "message": "Resolving merge conflicts\nMaking getProperties in Cosmos*ItemResponse package-private and\n refactoring calls related to it", "committedDate": "2020-02-12T04:28:20Z", "type": "commit"}]}