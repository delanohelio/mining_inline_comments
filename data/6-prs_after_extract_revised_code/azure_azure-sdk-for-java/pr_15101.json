{"pr_number": 15101, "pr_title": "Make code easier to read", "pr_createdAt": "2020-09-11T08:59:46Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15101", "timeline": [{"oid": "df530d49dd13258ffe1e704ecedeffc8b325c512", "url": "https://github.com/Azure/azure-sdk-for-java/commit/df530d49dd13258ffe1e704ecedeffc8b325c512", "message": "No logic change, just make code easier to read.", "committedDate": "2020-09-11T08:31:08Z", "type": "commit"}, {"oid": "dbc178df8fed6f6591f26626b498acb954aa4fc9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/dbc178df8fed6f6591f26626b498acb954aa4fc9", "message": "Add class: AccessTokenClaims.", "committedDate": "2020-09-11T08:37:06Z", "type": "commit"}, {"oid": "46c897c676289520dec57bdb50f56c80b8643cb8", "url": "https://github.com/Azure/azure-sdk-for-java/commit/46c897c676289520dec57bdb50f56c80b8643cb8", "message": "No logic change, just make code easier to read.", "committedDate": "2020-09-11T08:52:55Z", "type": "commit"}, {"oid": "b1b55d0d4459250a4f3da710c37fa74f60bdcce1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b1b55d0d4459250a4f3da710c37fa74f60bdcce1", "message": "Remame AccessTokenClaim to AccessTokenClaims.", "committedDate": "2020-09-11T08:58:53Z", "type": "commit"}, {"oid": "945e2f38ba0a84142ad4cda34d496684e7059bc1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/945e2f38ba0a84142ad4cda34d496684e7059bc1", "message": "Combine 2 kinds of Exception, delete ErrorCode.", "committedDate": "2020-09-11T09:06:00Z", "type": "commit"}, {"oid": "99acb6cc896c00f0c221e9e1eff896d986972147", "url": "https://github.com/Azure/azure-sdk-for-java/commit/99acb6cc896c00f0c221e9e1eff896d986972147", "message": "Add AADOAuth2ErrorCode.", "committedDate": "2020-09-11T09:25:29Z", "type": "commit"}, {"oid": "b9f9724f59a6c72873eb261e1551ebcedf64cd61", "url": "https://github.com/Azure/azure-sdk-for-java/commit/b9f9724f59a6c72873eb261e1551ebcedf64cd61", "message": "Rename AccessTokenClaim to AADAccessTokenClaim.", "committedDate": "2020-09-11T09:28:08Z", "type": "commit"}, {"oid": "eb622c8ca2fdbf386628918112a1bc6663d7b437", "url": "https://github.com/Azure/azure-sdk-for-java/commit/eb622c8ca2fdbf386628918112a1bc6663d7b437", "message": "No logic change, just make code easier to read.", "committedDate": "2020-09-11T09:49:43Z", "type": "commit"}, {"oid": "e9b36fb1c552e7d77f5d256572fc8c8c80983bd0", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e9b36fb1c552e7d77f5d256572fc8c8c80983bd0", "message": "setStatus before sendRedirect.", "committedDate": "2020-09-11T09:52:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzEzNTM3NA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101#discussion_r487135374", "bodyText": "this is just a style comment, but I personally find the original form of the throw (1 line versus 5 lines) easier to read.", "author": "joshfree", "createdAt": "2020-09-11T15:51:01Z", "path": "sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AADOAuth2UserService.java", "diffHunk": "@@ -50,25 +45,44 @@ public OidcUser loadUser(OidcUserRequest userRequest) throws OAuth2Authenticatio\n             // https://github.com/MicrosoftDocs/azure-docs/issues/8121#issuecomment-387090099\n             // In AAD App Registration configure oauth2AllowImplicitFlow to true\n             final ClientRegistration registration = userRequest.getClientRegistration();\n-            final AzureADGraphClient graphClient = new AzureADGraphClient(\n+            final AzureADGraphClient azureADGraphClient = new AzureADGraphClient(\n                 registration.getClientId(),\n                 registration.getClientSecret(),\n-                aadAuthProps,\n-                serviceEndpointsProps\n+                aadAuthenticationProperties,\n+                serviceEndpointsProperties\n             );\n-            String graphApiToken = graphClient\n-                .acquireTokenForGraphApi(userRequest.getIdToken().getTokenValue(), aadAuthProps.getTenantId())\n+            String graphApiToken = azureADGraphClient\n+                .acquireTokenForGraphApi(\n+                    userRequest.getIdToken().getTokenValue(),\n+                    aadAuthenticationProperties.getTenantId()\n+                )\n                 .accessToken();\n-            mappedAuthorities = graphClient.getGrantedAuthorities(graphApiToken);\n+            mappedAuthorities = azureADGraphClient.getGrantedAuthorities(graphApiToken);\n         } catch (MalformedURLException e) {\n-            throw wrapException(INVALID_REQUEST, \"Failed to acquire token for Graph API.\", null, e);\n+            throw toOAuth2AuthenticationException(", "originalCommit": "e9b36fb1c552e7d77f5d256572fc8c8c80983bd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzYxMjM4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15101#discussion_r487612388", "bodyText": "Hi, @joshfree .\nThank you for your feedback.\nHere is my principal about whether to break line:\n\nIf line length <= 120, it should be written in 1 line.\nIf length > 120, write 1 parameter in one line, which will make code easier to read.\n\nIn this case, I renamed method name from wrapException to toOAuth2AuthenticationException, this will make this line's length > 120, so I write each parameter in a line.", "author": "chenrujun", "createdAt": "2020-09-14T01:51:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzEzNTM3NA=="}], "type": "inlineReview", "revised_code": {"commit": "16fbf66b7d658140403804e643e8a775140e59d9", "chunk": "diff --git a/sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AADOAuth2UserService.java b/sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AADOAuth2UserService.java\nindex 15d2f9989ef..5e681d94050 100644\n--- a/sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AADOAuth2UserService.java\n+++ b/sdk/spring/azure-spring-boot/src/main/java/com/microsoft/azure/spring/autoconfigure/aad/AADOAuth2UserService.java\n\n@@ -59,30 +63,14 @@ public class AADOAuth2UserService implements OAuth2UserService<OidcUserRequest,\n                 .accessToken();\n             mappedAuthorities = azureADGraphClient.getGrantedAuthorities(graphApiToken);\n         } catch (MalformedURLException e) {\n-            throw toOAuth2AuthenticationException(\n-                AADOAuth2ErrorCode.INVALID_REQUEST,\n-                \"Failed to acquire token for Graph API.\",\n-                e\n-            );\n+            throw toOAuth2AuthenticationException(INVALID_REQUEST, \"Failed to acquire token for Graph API.\", e);\n         } catch (ServiceUnavailableException e) {\n-            throw toOAuth2AuthenticationException(\n-                AADOAuth2ErrorCode.SERVER_SERVER,\n-                \"Failed to acquire token for Graph API.\",\n-                e\n-            );\n+            throw toOAuth2AuthenticationException(SERVER_SERVER, \"Failed to acquire token for Graph API.\",e);\n         } catch (IOException e) {\n-            throw toOAuth2AuthenticationException(\n-                AADOAuth2ErrorCode.SERVER_SERVER,\n-                \"Failed to map group to authorities.\",\n-                e\n-            );\n+            throw toOAuth2AuthenticationException(SERVER_SERVER, \"Failed to map group to authorities.\", e);\n         } catch (MsalServiceException e) {\n             if (e.claims() != null && !e.claims().isEmpty()) {\n-                throw toOAuth2AuthenticationException(\n-                    AADOAuth2ErrorCode.CONDITIONAL_ACCESS_POLICY,\n-                    \"Handle conditional access policy\",\n-                    e\n-                );\n+                throw toOAuth2AuthenticationException(CONDITIONAL_ACCESS_POLICY, \"Handle conditional access policy\", e);\n             } else {\n                 throw e;\n             }\n"}}, {"oid": "16fbf66b7d658140403804e643e8a775140e59d9", "url": "https://github.com/Azure/azure-sdk-for-java/commit/16fbf66b7d658140403804e643e8a775140e59d9", "message": "No logic change, just make code easier to read.", "committedDate": "2020-09-14T08:25:20Z", "type": "commit"}, {"oid": "77becea05b2ab8dce44ddf571ef71fd9118efdda", "url": "https://github.com/Azure/azure-sdk-for-java/commit/77becea05b2ab8dce44ddf571ef71fd9118efdda", "message": "Fix error reported by maven-checkstyle-plugin.", "committedDate": "2020-09-15T00:57:14Z", "type": "commit"}]}