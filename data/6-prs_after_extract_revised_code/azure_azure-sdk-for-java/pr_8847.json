{"pr_number": 8847, "pr_title": "Public api duration change", "pr_createdAt": "2020-03-09T01:35:42Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/8847", "timeline": [{"oid": "6fc002ec93b4891a3456d173e6da34434baba326", "url": "https://github.com/Azure/azure-sdk-for-java/commit/6fc002ec93b4891a3456d173e6da34434baba326", "message": "Updated public surface of Connection Policy to use Duration\nUpdated internal classes to follow the same duration values", "committedDate": "2020-03-09T00:50:20Z", "type": "commit"}, {"oid": "0b75bfa93b017348218e130406fb1f038bafc629", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0b75bfa93b017348218e130406fb1f038bafc629", "message": "Updated Cosmos Client Exception to duration", "committedDate": "2020-03-09T01:33:50Z", "type": "commit"}, {"oid": "62a467657ec12be65e4056b0580793089d1b0ae6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/62a467657ec12be65e4056b0580793089d1b0ae6", "message": "Updated Throttling Retry Options to Duration", "committedDate": "2020-03-09T02:59:00Z", "type": "commit"}, {"oid": "f85c6a9371e49c27f8be0d32e5b1ba53aad344ff", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f85c6a9371e49c27f8be0d32e5b1ba53aad344ff", "message": "Removed unused imports", "committedDate": "2020-03-09T03:06:55Z", "type": "commit"}, {"oid": "a35ac2de8e38aff37b1ede994016476b7fa3bb08", "url": "https://github.com/Azure/azure-sdk-for-java/commit/a35ac2de8e38aff37b1ede994016476b7fa3bb08", "message": "Fixed config and connection policy duration values to seconds", "committedDate": "2020-03-09T05:41:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3NTkxOA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389775918", "bodyText": "Duration is not used as a suffix in ConnectionPolicy#setRequestTimeout() and getter.\nany reason we are using it here?\nwhat are your thought on the method naming?", "author": "moderakh", "createdAt": "2020-03-09T15:41:35Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/CosmosClientException.java", "diffHunk": "@@ -193,13 +194,13 @@ void setError(CosmosError cosmosError) {\n     }\n \n     /**\n-     * Gets the recommended time interval after which the client can retry failed\n+     * Gets the recommended time duration after which the client can retry failed\n      * requests\n      *\n-     * @return the recommended time interval after which the client can retry failed\n+     * @return the recommended time duration after which the client can retry failed\n      * requests.\n      */\n-    public long getRetryAfterInMilliseconds() {\n+    public Duration getRetryAfterDuration() {", "originalCommit": "a35ac2de8e38aff37b1ede994016476b7fa3bb08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc4Njk0Mg==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389786942", "bodyText": "The reason I added Duration here is because getRetryAfter seems very general. It was not clear to me that it returns duration to retry after. So I added that. I can change it to getRetryAfter if you think that is much better.", "author": "kushagraThapar", "createdAt": "2020-03-09T15:57:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3NTkxOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc5Mjg5NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389792895", "bodyText": "ok makes sense, getRetryAfterDuration() looks good", "author": "moderakh", "createdAt": "2020-03-09T16:06:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3NTkxOA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3ODM3Nw==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389778377", "bodyText": "hmm, do we want \"InSeconds()\" as suffix in the method name?\nthe time resolution for this method is seconds. If we are using Duration here we should update the documentation mentioning that the resolution is in seconds.", "author": "moderakh", "createdAt": "2020-03-09T15:45:15Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java", "diffHunk": "@@ -105,21 +107,21 @@ public ConsistencyPolicy setMaxStalenessPrefix(int maxStalenessPrefix) {\n      *\n      * @return the max staleness prefix.\n      */\n-    public int getMaxStalenessIntervalInSeconds() {\n+    public Duration getMaxStalenessIntervalInSeconds() {", "originalCommit": "a35ac2de8e38aff37b1ede994016476b7fa3bb08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc4NzE1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389787159", "bodyText": "We don't want inSeconds() as the suffix in the method name. I will remove it.", "author": "kushagraThapar", "createdAt": "2020-03-09T15:58:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3ODM3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "77afe776713084675adca2709ec85cc2442fe76a", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java\nindex bd9fa6801e3..3db635324be 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java\n\n@@ -107,7 +107,7 @@ public final class ConsistencyPolicy extends JsonSerializable {\n      *\n      * @return the max staleness prefix.\n      */\n-    public Duration getMaxStalenessIntervalInSeconds() {\n+    public Duration getMaxStalenessInterval() {\n         Integer value = super.getInt(Constants.Properties.MAX_STALENESS_INTERVAL_IN_SECONDS);\n         if (value == null) {\n             return Duration.ofSeconds(ConsistencyPolicy.DEFAULT_MAX_STALENESS_INTERVAL);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3ODU1OQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389778559", "bodyText": "the same.", "author": "moderakh", "createdAt": "2020-03-09T15:45:26Z", "path": "sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java", "diffHunk": "@@ -105,21 +107,21 @@ public ConsistencyPolicy setMaxStalenessPrefix(int maxStalenessPrefix) {\n      *\n      * @return the max staleness prefix.\n      */\n-    public int getMaxStalenessIntervalInSeconds() {\n+    public Duration getMaxStalenessIntervalInSeconds() {\n         Integer value = super.getInt(Constants.Properties.MAX_STALENESS_INTERVAL_IN_SECONDS);\n         if (value == null) {\n-            return ConsistencyPolicy.DEFAULT_MAX_STALENESS_INTERVAL;\n+            return Duration.ofSeconds(ConsistencyPolicy.DEFAULT_MAX_STALENESS_INTERVAL);\n         }\n-        return value;\n+        return Duration.ofSeconds(value);\n     }\n \n     /**\n      * Sets the in bounded staleness consistency, the maximum allowed staleness in terms time interval.\n      *\n-     * @param maxStalenessIntervalInSeconds the max staleness interval in seconds.\n+     * @param maxStalenessIntervalInSeconds the max staleness duration.\n      * @return the ConsistenctPolicy.\n      */\n-    public ConsistencyPolicy setMaxStalenessIntervalInSeconds(int maxStalenessIntervalInSeconds) {\n+    public ConsistencyPolicy setMaxStalenessIntervalInSeconds(Duration maxStalenessIntervalInSeconds) {", "originalCommit": "a35ac2de8e38aff37b1ede994016476b7fa3bb08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc4NzI4OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/8847#discussion_r389787288", "bodyText": "agreed.", "author": "kushagraThapar", "createdAt": "2020-03-09T15:58:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc3ODU1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "77afe776713084675adca2709ec85cc2442fe76a", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java\nindex bd9fa6801e3..3db635324be 100644\n--- a/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java\n+++ b/sdk/cosmos/azure-cosmos/src/main/java/com/azure/cosmos/model/ConsistencyPolicy.java\n\n@@ -107,7 +107,7 @@ public final class ConsistencyPolicy extends JsonSerializable {\n      *\n      * @return the max staleness prefix.\n      */\n-    public Duration getMaxStalenessIntervalInSeconds() {\n+    public Duration getMaxStalenessInterval() {\n         Integer value = super.getInt(Constants.Properties.MAX_STALENESS_INTERVAL_IN_SECONDS);\n         if (value == null) {\n             return Duration.ofSeconds(ConsistencyPolicy.DEFAULT_MAX_STALENESS_INTERVAL);\n"}}, {"oid": "77afe776713084675adca2709ec85cc2442fe76a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/77afe776713084675adca2709ec85cc2442fe76a", "message": "Renamed getMaxStalenessInterval API", "committedDate": "2020-03-09T16:06:49Z", "type": "commit"}, {"oid": "e4945f8f19a58a10f26d0b30984b2f4e05773474", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e4945f8f19a58a10f26d0b30984b2f4e05773474", "message": "Fixed potential bug and typos", "committedDate": "2020-03-09T16:26:37Z", "type": "commit"}, {"oid": "3ba6fa1f25d97f9bf3bcfc8f4cbee93b6daba619", "url": "https://github.com/Azure/azure-sdk-for-java/commit/3ba6fa1f25d97f9bf3bcfc8f4cbee93b6daba619", "message": "Fixed toSeconds() java 11 API to getSeconds() java 8 API", "committedDate": "2020-03-09T16:32:38Z", "type": "commit"}]}