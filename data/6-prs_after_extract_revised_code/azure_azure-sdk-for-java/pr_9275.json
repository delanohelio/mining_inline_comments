{"pr_number": 9275, "pr_title": "Azure-Cosmos version management HttpConstants", "pr_createdAt": "2020-03-19T18:45:47Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/9275", "timeline": [{"oid": "5a5217401262908ed10bcef9c2b1f44180bdb8c1", "url": "https://github.com/Azure/azure-sdk-for-java/commit/5a5217401262908ed10bcef9c2b1f44180bdb8c1", "message": "Removed hard coded version from HttpConstants.\nAdded azure-cosmos.properties file.\nAdded unit tests to verify current version", "committedDate": "2020-03-19T18:44:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI0NjI2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9275#discussion_r395246261", "bodyText": "Please add license header", "author": "mbhaskar", "createdAt": "2020-03-19T18:48:02Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java", "diffHunk": "@@ -0,0 +1,58 @@\n+package com.azure.cosmos;", "originalCommit": "5a5217401262908ed10bcef9c2b1f44180bdb8c1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI0NzEyNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9275#discussion_r395247125", "bodyText": "Good catch.", "author": "kushagraThapar", "createdAt": "2020-03-19T18:49:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI0NjI2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI0NzY3OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9275#discussion_r395247678", "bodyText": "Done.", "author": "kushagraThapar", "createdAt": "2020-03-19T18:50:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI0NjI2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "f5f8ca1a723abd3212f46bf6772195d859038664", "chunk": "diff --git a/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java b/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java\nindex 1f4a9dab682..3e61fc1c46f 100644\n--- a/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java\n+++ b/sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java\n\n@@ -1,20 +1,18 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n package com.azure.cosmos;\n \n import com.azure.core.util.CoreUtils;\n import com.azure.cosmos.implementation.HttpConstants;\n import org.testng.annotations.Test;\n \n-import java.io.BufferedInputStream;\n import java.io.BufferedReader;\n import java.io.File;\n-import java.io.FileInputStream;\n-import java.io.FileNotFoundException;\n import java.io.FileReader;\n import java.io.IOException;\n import java.util.Map;\n \n import static org.assertj.core.api.Assertions.assertThat;\n-import static org.assertj.core.api.Assertions.fail;\n \n public class AzureCosmosPropertiesTest {\n \n"}}, {"oid": "f5f8ca1a723abd3212f46bf6772195d859038664", "url": "https://github.com/Azure/azure-sdk-for-java/commit/f5f8ca1a723abd3212f46bf6772195d859038664", "message": "Added license header", "committedDate": "2020-03-19T18:50:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI1MjcyNQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9275#discussion_r395252725", "bodyText": "ideally you can use xml parser to get the path of the filed of interest\nanyway, not a big deal for a test and may not worth the time.\nThank you.", "author": "moderakh", "createdAt": "2020-03-19T18:59:02Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java", "diffHunk": "@@ -0,0 +1,56 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+package com.azure.cosmos;\n+\n+import com.azure.core.util.CoreUtils;\n+import com.azure.cosmos.implementation.HttpConstants;\n+import org.testng.annotations.Test;\n+\n+import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Map;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+public class AzureCosmosPropertiesTest {\n+\n+    @Test(groups = \"unit\")\n+    public void verifyAzureCosmosProperties() {\n+        Map<String, String> properties =\n+            CoreUtils.getProperties(HttpConstants.Versions.AZURE_COSMOS_PROPERTIES_FILE_NAME);\n+        assertThat(properties).isNotNull();\n+        assertThat(properties).isNotEmpty();\n+        assertThat(properties.get(\"version\")).isNotNull();\n+        assertThat(properties.get(\"name\")).isNotNull();\n+    }\n+\n+    @Test(groups = \"unit\")\n+    public void verifyProjectVersion() {\n+        assertThat(HttpConstants.Versions.SDK_VERSION).isNotNull();\n+        String pomFileVersion = getVersionFromPomFile();\n+        assertThat(HttpConstants.Versions.SDK_VERSION).isEqualTo(pomFileVersion);\n+    }\n+\n+    private String getVersionFromPomFile() {\n+        String fileName = \"pom.xml\";\n+        String versionStartTag = \"<version>\";\n+        String versionEndTag = \"</version>\";\n+        File file = new File(fileName);\n+        try {", "originalCommit": "f5f8ca1a723abd3212f46bf6772195d859038664", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI1MzYwOQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9275#discussion_r395253609", "bodyText": "Yeah, didn't want to add extra dependency :)\nbut yes, I agree. We could use that.", "author": "kushagraThapar", "createdAt": "2020-03-19T19:00:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI1MjcyNQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTI1NzA1MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9275#discussion_r395257051", "bodyText": "This is cool. We do additional regex testing to test over the version format.", "author": "sima-zhu", "createdAt": "2020-03-19T19:07:01Z", "path": "sdk/cosmos/azure-cosmos/src/test/java/com/azure/cosmos/AzureCosmosPropertiesTest.java", "diffHunk": "@@ -0,0 +1,56 @@\n+// Copyright (c) Microsoft Corporation. All rights reserved.\n+// Licensed under the MIT License.\n+package com.azure.cosmos;\n+\n+import com.azure.core.util.CoreUtils;\n+import com.azure.cosmos.implementation.HttpConstants;\n+import org.testng.annotations.Test;\n+\n+import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.util.Map;\n+\n+import static org.assertj.core.api.Assertions.assertThat;\n+\n+public class AzureCosmosPropertiesTest {\n+\n+    @Test(groups = \"unit\")\n+    public void verifyAzureCosmosProperties() {\n+        Map<String, String> properties =\n+            CoreUtils.getProperties(HttpConstants.Versions.AZURE_COSMOS_PROPERTIES_FILE_NAME);\n+        assertThat(properties).isNotNull();\n+        assertThat(properties).isNotEmpty();\n+        assertThat(properties.get(\"version\")).isNotNull();\n+        assertThat(properties.get(\"name\")).isNotNull();\n+    }\n+\n+    @Test(groups = \"unit\")\n+    public void verifyProjectVersion() {\n+        assertThat(HttpConstants.Versions.SDK_VERSION).isNotNull();\n+        String pomFileVersion = getVersionFromPomFile();\n+        assertThat(HttpConstants.Versions.SDK_VERSION).isEqualTo(pomFileVersion);", "originalCommit": "f5f8ca1a723abd3212f46bf6772195d859038664", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}