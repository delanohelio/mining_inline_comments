{"pr_number": 15766, "pr_title": "mgmt, fix network sample VerifyNetworkPeeringWithNetworkWatcher", "pr_createdAt": "2020-09-28T06:05:15Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/15766", "timeline": [{"oid": "e9fdccbd2d456de2c6d681318008ce62cb7761e7", "url": "https://github.com/Azure/azure-sdk-for-java/commit/e9fdccbd2d456de2c6d681318008ce62cb7761e7", "message": "fix sample VerifyNetworkPeeringWithNetworkWatcher", "committedDate": "2020-09-28T05:58:30Z", "type": "commit"}, {"oid": "53c17d6dd08ccb34824083949acddabd3813568f", "url": "https://github.com/Azure/azure-sdk-for-java/commit/53c17d6dd08ccb34824083949acddabd3813568f", "message": "enable VerifyNetworkPeeringWithNetworkWatcher", "committedDate": "2020-09-28T05:58:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NTcxNjI2MQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/15766#discussion_r495716261", "bodyText": "Only create NetworkerWatcher if not there.", "author": "weidongxu-microsoft", "createdAt": "2020-09-28T06:34:52Z", "path": "sdk/resourcemanager/azure-resourcemanager-samples/src/main/java/com/azure/resourcemanager/network/samples/VerifyNetworkPeeringWithNetworkWatcher.java", "diffHunk": "@@ -148,10 +148,17 @@ public static boolean runSample(AzureResourceManager azureResourceManager) {\n \n             //=============================================================\n             // Check connectivity between the two VMs/networks using Network Watcher\n-            NetworkWatcher networkWatcher = azureResourceManager.networkWatchers().define(networkWatcherName)\n+\n+            // Azure Network Watcher enabled by default\n+            // https://azure.microsoft.com/updates/azure-network-watcher-will-be-enabled-by-default-for-subscriptions-containing-virtual-networks/\n+            NetworkWatcher networkWatcher = azureResourceManager.networkWatchers().list().stream()\n+                .filter(nw -> nw.region() == region).findFirst()\n+                .orElseGet(() -> azureResourceManager", "originalCommit": "53c17d6dd08ccb34824083949acddabd3813568f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}