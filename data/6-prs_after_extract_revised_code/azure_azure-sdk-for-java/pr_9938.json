{"pr_number": 9938, "pr_title": "KV add retry policy", "pr_createdAt": "2020-04-07T21:56:19Z", "pr_url": "https://github.com/Azure/azure-sdk-for-java/pull/9938", "timeline": [{"oid": "58f5424d9c891ee06e0e7ca1c42b80b29dc09de6", "url": "https://github.com/Azure/azure-sdk-for-java/commit/58f5424d9c891ee06e0e7ca1c42b80b29dc09de6", "message": "add retry policy", "committedDate": "2020-04-07T21:55:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MDg1OA==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9938#discussion_r405140858", "bodyText": "This should use RetryPolicy.", "author": "srnagar", "createdAt": "2020-04-07T22:04:29Z", "path": "sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java", "diffHunk": "@@ -70,7 +70,7 @@\n     private URL vaultUrl;\n     private HttpClient httpClient;\n     private HttpLogOptions httpLogOptions;\n-    private final RetryPolicy retryPolicy;\n+    private HttpPipelinePolicy retryPolicy;", "originalCommit": "58f5424d9c891ee06e0e7ca1c42b80b29dc09de6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0c079ac065116a08ba22efa0fc6138a2264b1d31", "chunk": "diff --git a/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java b/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java\nindex f7cc00fe39a..62f40eb7608 100644\n--- a/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java\n+++ b/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java\n\n@@ -70,7 +70,7 @@ public final class KeyClientBuilder {\n     private URL vaultUrl;\n     private HttpClient httpClient;\n     private HttpLogOptions httpLogOptions;\n-    private HttpPipelinePolicy retryPolicy;\n+    private RetryPolicy retryPolicy;\n     private Configuration configuration;\n     private KeyServiceVersion version;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0MDk2NQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9938#discussion_r405140965", "bodyText": "Same here - use RetryPolicy instead.", "author": "srnagar", "createdAt": "2020-04-07T22:04:44Z", "path": "sdk/keyvault/azure-security-keyvault-secrets/src/main/java/com/azure/security/keyvault/secrets/SecretClientBuilder.java", "diffHunk": "@@ -277,6 +277,19 @@ public SecretClientBuilder serviceVersion(SecretServiceVersion version) {\n         return this;\n     }\n \n+    /**\n+     * Sets the {@link HttpPipelinePolicy} that is used when each request is sent.\n+     *\n+     * The default retry policy will be used in the pipeline, if not provided.\n+     *\n+     * @param retryPolicy user's retry policy applied to each request.\n+     * @return The updated SecretClientBuilder object.\n+     */\n+    public SecretClientBuilder retryPolicy(HttpPipelinePolicy retryPolicy) {", "originalCommit": "58f5424d9c891ee06e0e7ca1c42b80b29dc09de6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0c079ac065116a08ba22efa0fc6138a2264b1d31", "chunk": "diff --git a/sdk/keyvault/azure-security-keyvault-secrets/src/main/java/com/azure/security/keyvault/secrets/SecretClientBuilder.java b/sdk/keyvault/azure-security-keyvault-secrets/src/main/java/com/azure/security/keyvault/secrets/SecretClientBuilder.java\nindex 69a14b55c5c..6ca940c53a2 100644\n--- a/sdk/keyvault/azure-security-keyvault-secrets/src/main/java/com/azure/security/keyvault/secrets/SecretClientBuilder.java\n+++ b/sdk/keyvault/azure-security-keyvault-secrets/src/main/java/com/azure/security/keyvault/secrets/SecretClientBuilder.java\n\n@@ -278,14 +278,14 @@ public final class SecretClientBuilder {\n     }\n \n     /**\n-     * Sets the {@link HttpPipelinePolicy} that is used when each request is sent.\n+     * Sets the {@link RetryPolicy} that is used when each request is sent.\n      *\n      * The default retry policy will be used in the pipeline, if not provided.\n      *\n      * @param retryPolicy user's retry policy applied to each request.\n      * @return The updated SecretClientBuilder object.\n      */\n-    public SecretClientBuilder retryPolicy(HttpPipelinePolicy retryPolicy) {\n+    public SecretClientBuilder retryPolicy(RetryPolicy retryPolicy) {\n         this.retryPolicy = retryPolicy;\n         return this;\n     }\n"}}, {"oid": "0c079ac065116a08ba22efa0fc6138a2264b1d31", "url": "https://github.com/Azure/azure-sdk-for-java/commit/0c079ac065116a08ba22efa0fc6138a2264b1d31", "message": "update builders", "committedDate": "2020-04-07T22:08:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTE0NjMxMQ==", "url": "https://github.com/Azure/azure-sdk-for-java/pull/9938#discussion_r405146311", "bodyText": "It would be better to have a null check in all these retryPolicy setters.", "author": "srnagar", "createdAt": "2020-04-07T22:18:05Z", "path": "sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java", "diffHunk": "@@ -274,6 +274,19 @@ public KeyClientBuilder configuration(Configuration configuration) {\n         return this;\n     }\n \n+    /**\n+     * Sets the {@link RetryPolicy} that is used when each request is sent.\n+     *\n+     * The default retry policy will be used in the pipeline, if not provided.\n+     *\n+     * @param retryPolicy user's retry policy applied to each request.\n+     * @return The updated KeyClientBuilder object.\n+     */\n+    public KeyClientBuilder retryPolicy(RetryPolicy retryPolicy) {\n+        this.retryPolicy = retryPolicy;", "originalCommit": "0c079ac065116a08ba22efa0fc6138a2264b1d31", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2658e6e7fb0a2963558afc4ac8475f0f8baef19c", "chunk": "diff --git a/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java b/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java\nindex 62f40eb7608..b58733b35d9 100644\n--- a/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java\n+++ b/sdk/keyvault/azure-security-keyvault-keys/src/main/java/com/azure/security/keyvault/keys/KeyClientBuilder.java\n\n@@ -281,8 +281,10 @@ public final class KeyClientBuilder {\n      *\n      * @param retryPolicy user's retry policy applied to each request.\n      * @return The updated KeyClientBuilder object.\n+     * @throws NullPointerException if the specified {@code retryPolicy} is null.\n      */\n     public KeyClientBuilder retryPolicy(RetryPolicy retryPolicy) {\n+        Objects.requireNonNull(retryPolicy, \"The retry policy cannot be bull\");\n         this.retryPolicy = retryPolicy;\n         return this;\n     }\n"}}, {"oid": "2658e6e7fb0a2963558afc4ac8475f0f8baef19c", "url": "https://github.com/Azure/azure-sdk-for-java/commit/2658e6e7fb0a2963558afc4ac8475f0f8baef19c", "message": "add null checks", "committedDate": "2020-04-09T16:38:38Z", "type": "commit"}, {"oid": "c1a5963eab55f8c8933e13566bc29ba83bfe1d3a", "url": "https://github.com/Azure/azure-sdk-for-java/commit/c1a5963eab55f8c8933e13566bc29ba83bfe1d3a", "message": "Merge remote-tracking branch 'upstream/master' into kv-add-retry-policy", "committedDate": "2020-04-09T16:41:30Z", "type": "commit"}, {"oid": "8a35636882ff5824ea822104da7fa7989fad7ff3", "url": "https://github.com/Azure/azure-sdk-for-java/commit/8a35636882ff5824ea822104da7fa7989fad7ff3", "message": "update changelog", "committedDate": "2020-04-09T17:04:49Z", "type": "commit"}, {"oid": "79009e48c1120c47f95f367f928204e2844bfee4", "url": "https://github.com/Azure/azure-sdk-for-java/commit/79009e48c1120c47f95f367f928204e2844bfee4", "message": "fix checkstyle", "committedDate": "2020-04-09T17:27:16Z", "type": "commit"}]}