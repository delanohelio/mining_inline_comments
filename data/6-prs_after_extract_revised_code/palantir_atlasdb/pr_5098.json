{"pr_number": 5098, "pr_title": "[LE] Wire in the metrics from client to server", "pr_createdAt": "2020-11-04T10:07:20Z", "pr_url": "https://github.com/palantir/atlasdb/pull/5098", "timeline": [{"oid": "340aa1b81058f23023de39438f1d68a6677efa22", "url": "https://github.com/palantir/atlasdb/commit/340aa1b81058f23023de39438f1d68a6677efa22", "message": "make some things static", "committedDate": "2020-11-04T09:57:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzIzMDcxNA==", "url": "https://github.com/palantir/atlasdb/pull/5098#discussion_r517230714", "bodyText": "Changes to this class are just cleanup (adding static, moving methods around).", "author": "Jolyon-S", "createdAt": "2020-11-04T10:07:50Z", "path": "lock-api/src/main/java/com/palantir/lock/client/LeaderElectionReportingTimelockService.java", "diffHunk": "@@ -63,7 +63,8 @@\n     private Map<UUID, Instant> leadershipUpperBound = new ConcurrentHashMap<>();\n     private Map<UUID, Instant> leadershipLowerBound = new ConcurrentHashMap<>();\n \n-    public LeaderElectionReportingTimelockService(\n+    @VisibleForTesting\n+    LeaderElectionReportingTimelockService(", "originalCommit": "340aa1b81058f23023de39438f1d68a6677efa22", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "fc4cc95386e378bcfa3d5b61ae67427f9e9890e0", "url": "https://github.com/palantir/atlasdb/commit/fc4cc95386e378bcfa3d5b61ae67427f9e9890e0", "message": "update build.gradle", "committedDate": "2020-11-04T10:15:08Z", "type": "commit"}, {"oid": "b8aa637a9a96be98a1d132550f54337bda335653", "url": "https://github.com/palantir/atlasdb/commit/b8aa637a9a96be98a1d132550f54337bda335653", "message": "Add generated changelog entries", "committedDate": "2020-11-04T10:15:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzI0ODQxNQ==", "url": "https://github.com/palantir/atlasdb/pull/5098#discussion_r517248415", "bodyText": "this is a bit trippy, but correct", "author": "jeremyk-91", "createdAt": "2020-11-04T10:36:26Z", "path": "lock-api/src/main/java/com/palantir/lock/client/LeaderElectionReportingTimelockService.java", "diffHunk": "@@ -230,26 +232,30 @@ LeaderElectionStatistics getStatisticsAndSetRegistryTo(TaggedMetricRegistry metr\n         return durationToNextLeader(lowerBounds, upperBounds, leaders, secondToLastLongTermLeader);\n     }\n \n-    private Set<UUID> leadersWithBothBounds(Map<UUID, Instant> lowerBounds, Map<UUID, Instant> upperBounds) {\n+    private void clearOldLongTermLeaders(List<UUID> sortedLongTermLeaders) {\n+        for (int i = 0; i < sortedLongTermLeaders.size() - 2; i++) {", "originalCommit": "b8aa637a9a96be98a1d132550f54337bda335653", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}