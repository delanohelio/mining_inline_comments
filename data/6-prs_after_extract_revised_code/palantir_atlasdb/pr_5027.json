{"pr_number": 5027, "pr_title": "[DB TimeLock] 1D.2/3C.1 - Validation of DB TimeLock Multiple Series Mode", "pr_createdAt": "2020-10-13T17:54:26Z", "pr_url": "https://github.com/palantir/atlasdb/pull/5027", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE1OTExMA==", "url": "https://github.com/palantir/atlasdb/pull/5027#discussion_r504159110", "bodyText": "minor: you can add assertion that other was fastforwarded, not necessary if it's already covered by other tests.", "author": "sudiksha27", "createdAt": "2020-10-13T18:12:04Z", "path": "timelock-server/src/suiteTest/java/com/palantir/atlasdb/timelock/MultiNodePaxosTimeLockServerIntegrationTest.java", "diffHunk": "@@ -431,6 +431,20 @@ public void stressTest() {\n         }\n     }\n \n+    @Test\n+    public void fastForwardsDoNotHaveCrossNamespaceImpact() {\n+        long freshTimestamp = client.getFreshTimestamp();\n+\n+        long fastForwardTimestamp = freshTimestamp + 100_000_000;\n+        NamespacedClients other = cluster.clientForRandomNamespace().throughWireMockProxy();\n+        other.timestampManagementService().fastForwardTimestamp(fastForwardTimestamp);\n+\n+        cluster.failoverToNewLeader(client.namespace());\n+        assertThat(client.getFreshTimestamp())\n+                .isGreaterThan(freshTimestamp)\n+                .isLessThan(fastForwardTimestamp);\n+    }\n+", "originalCommit": "795e8215378876b5a53e80733005a00c97e2d9ea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDgxMzA0Mw==", "url": "https://github.com/palantir/atlasdb/pull/5027#discussion_r504813043", "bodyText": "Good flag - this isn't covered by the other tests!", "author": "jeremyk-91", "createdAt": "2020-10-14T16:27:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDE1OTExMA=="}], "type": "inlineReview", "revised_code": {"commit": "119e96e779b9423321ddca96b4bd26358c26eb60", "chunk": "diff --git a/timelock-server/src/suiteTest/java/com/palantir/atlasdb/timelock/MultiNodePaxosTimeLockServerIntegrationTest.java b/timelock-server/src/suiteTest/java/com/palantir/atlasdb/timelock/MultiNodePaxosTimeLockServerIntegrationTest.java\nindex 90dd3ff636..1fc2f9e98e 100644\n--- a/timelock-server/src/suiteTest/java/com/palantir/atlasdb/timelock/MultiNodePaxosTimeLockServerIntegrationTest.java\n+++ b/timelock-server/src/suiteTest/java/com/palantir/atlasdb/timelock/MultiNodePaxosTimeLockServerIntegrationTest.java\n\n@@ -431,6 +431,16 @@ public class MultiNodePaxosTimeLockServerIntegrationTest {\n         }\n     }\n \n+    @Test\n+    public void fastForwardDoesNotGoBack() {\n+        long freshTimestamp = client.getFreshTimestamp();\n+\n+        long fastForwardTimestamp = freshTimestamp + 100_000_000;\n+        client.timestampManagementService().fastForwardTimestamp(fastForwardTimestamp);\n+        client.timestampManagementService().fastForwardTimestamp(freshTimestamp);\n+        assertThat(client.getFreshTimestamp()).isGreaterThan(fastForwardTimestamp);\n+    }\n+\n     @Test\n     public void fastForwardsDoNotHaveCrossNamespaceImpact() {\n         long freshTimestamp = client.getFreshTimestamp();\n"}}, {"oid": "d0d82b7731414ae53982a122537ddfd4dbe2c720", "url": "https://github.com/palantir/atlasdb/commit/d0d82b7731414ae53982a122537ddfd4dbe2c720", "message": "add test", "committedDate": "2020-10-14T16:22:43Z", "type": "commit"}, {"oid": "d0d82b7731414ae53982a122537ddfd4dbe2c720", "url": "https://github.com/palantir/atlasdb/commit/d0d82b7731414ae53982a122537ddfd4dbe2c720", "message": "add test", "committedDate": "2020-10-14T16:22:43Z", "type": "forcePushed"}, {"oid": "119e96e779b9423321ddca96b4bd26358c26eb60", "url": "https://github.com/palantir/atlasdb/commit/119e96e779b9423321ddca96b4bd26358c26eb60", "message": "few more assertions", "committedDate": "2020-10-14T16:46:13Z", "type": "commit"}]}