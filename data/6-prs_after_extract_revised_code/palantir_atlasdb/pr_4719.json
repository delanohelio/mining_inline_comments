{"pr_number": 4719, "pr_title": "[Timelock Partitioning] Tag remote hosts for internode communication", "pr_createdAt": "2020-04-17T13:04:39Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4719", "timeline": [{"oid": "dfaa39b8b6c494e37a3e3a0bab4fac84f42ddeaf", "url": "https://github.com/palantir/atlasdb/commit/dfaa39b8b6c494e37a3e3a0bab4fac84f42ddeaf", "message": "Tag remote hosts for internode communication", "committedDate": "2020-04-17T12:53:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM0MjE4Mg==", "url": "https://github.com/palantir/atlasdb/pull/4719#discussion_r410342182", "bodyText": "Is this risky in terms of metrics cardinality? I'm in the process of checking with the internal team that's responsible for this", "author": "jeremyk-91", "createdAt": "2020-04-17T16:42:00Z", "path": "timelock-agent/src/main/java/com/palantir/atlasdb/timelock/paxos/PaxosRemoteClients.java", "diffHunk": "@@ -160,7 +161,11 @@\n                                 .remotingClientConfig(() -> RemotingClientConfigs.DEFAULT)\n                                 .shouldSupportBlockingOperations(false)\n                                 .build()))\n-                .map(proxy -> AtlasDbMetrics.instrumentWithTaggedMetrics(metrics().getTaggedRegistry(), clazz, proxy));\n+                .map((host, proxy) -> AtlasDbMetrics.instrumentWithTaggedMetrics(\n+                        metrics().getTaggedRegistry(),\n+                        clazz,\n+                        proxy,\n+                        any -> ImmutableMap.of(AtlasDbMetricNames.TAG_REMOTE_HOST, host)));", "originalCommit": "dfaa39b8b6c494e37a3e3a0bab4fac84f42ddeaf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM2MDQyMg==", "url": "https://github.com/palantir/atlasdb/pull/4719#discussion_r410360422", "bodyText": "Checked internally: no, this is fine.", "author": "jeremyk-91", "createdAt": "2020-04-17T17:16:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM0MjE4Mg=="}], "type": "inlineReview", "revised_code": null}]}