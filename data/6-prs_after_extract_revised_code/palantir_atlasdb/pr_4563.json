{"pr_number": 4563, "pr_title": "Make createProxy retain refreshing capabilities.", "pr_createdAt": "2020-02-11T12:57:13Z", "pr_url": "https://github.com/palantir/atlasdb/pull/4563", "timeline": [{"oid": "89bd2b84b1c10bb2a66c45fbc79a989883fab793", "url": "https://github.com/palantir/atlasdb/commit/89bd2b84b1c10bb2a66c45fbc79a989883fab793", "message": "Make createProxy retain refreshing capabilities.", "committedDate": "2020-02-11T12:51:02Z", "type": "commit"}, {"oid": "459cbc0bc133c352827cd92fe35c1d6fdd9a85bc", "url": "https://github.com/palantir/atlasdb/commit/459cbc0bc133c352827cd92fe35c1d6fdd9a85bc", "message": "Add changelog", "committedDate": "2020-02-11T13:02:33Z", "type": "commit"}, {"oid": "8b01eacdc683319c099a517aa56b0f4abe7fdd01", "url": "https://github.com/palantir/atlasdb/commit/8b01eacdc683319c099a517aa56b0f4abe7fdd01", "message": "Fix up test.", "committedDate": "2020-02-11T13:04:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzYyMDU1NQ==", "url": "https://github.com/palantir/atlasdb/pull/4563#discussion_r377620555", "bodyText": "Is ok, since useExperimental is true and useFallback false. Is not great, but maybe exploding if we get into this kind of state that we don't expect is possible is not the worst reaction.", "author": "jeremyk-91", "createdAt": "2020-02-11T13:04:28Z", "path": "atlasdb-config/src/main/java/com/palantir/atlasdb/http/VersionSelectingClients.java", "diffHunk": "@@ -83,6 +84,19 @@ private VersionSelectingClients() {\n                 errorMetric::increment);\n     }\n \n+    static <T> T createRefreshingNewClient(\n+            Supplier<TargetFactory.InstanceAndVersion<T>> newClientSupplier,\n+            Class<T> clazz) {\n+\n+        return ExperimentRunningProxy.newProxyInstance(\n+                Suppliers.compose(TargetFactory.InstanceAndVersion::instance, newClientSupplier::get),\n+                null,", "originalCommit": "459cbc0bc133c352827cd92fe35c1d6fdd9a85bc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzYyMDc2MQ==", "url": "https://github.com/palantir/atlasdb/pull/4563#discussion_r377620761", "bodyText": "wat \ud83e\udd86", "author": "jeremyk-91", "createdAt": "2020-02-11T13:04:57Z", "path": "atlasdb-config/src/test/java/com/palantir/atlasdb/factory/LeadersTest.java", "diffHunk": "@@ -116,7 +116,7 @@ public void createProxyAndLocalListCreatesSingletonListIfNoRemoteAddressesProvid\n         verifyNoMoreInteractions(localAcceptor);\n     }\n \n-    @Test(expected = IllegalStateException.class)\n+    @Test(expected = IllegalArgumentException.class)", "originalCommit": "8b01eacdc683319c099a517aa56b0f4abe7fdd01", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzYyMTQxOA==", "url": "https://github.com/palantir/atlasdb/pull/4563#discussion_r377621418", "bodyText": "\ud83e\udd37\u200d\u2642 weird, I know", "author": "felixdesouza", "createdAt": "2020-02-11T13:06:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NzYyMDc2MQ=="}], "type": "inlineReview", "revised_code": null}]}