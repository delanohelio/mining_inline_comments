{"pr_number": 1657, "pr_title": "[SCB-1823] change kie label env to environment", "pr_createdAt": "2020-03-23T12:57:48Z", "pr_url": "https://github.com/apache/servicecomb-java-chassis/pull/1657", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjgzNjgzNg==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1657#discussion_r396836836", "bodyText": "Too many literals in a function, better to define constants for them.", "author": "liubao68", "createdAt": "2020-03-24T00:25:46Z", "path": "dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java", "diffHunk": "@@ -65,7 +65,7 @@ public static String encrypt(String dataStr) {\n       //todo:how to deal env\n       if (labelsMap.containsKey(\"app\") && labelsMap.get(\"app\")\n           .equals(KieConfig.INSTANCE.getAppName())\n-          && labelsMap.containsKey(\"env\") && labelsMap.get(\"env\")\n+          && labelsMap.containsKey(\"environment\") && labelsMap.get(\"environment\")", "originalCommit": "0e9e481402699593470bca43c51b403865bfa375", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg2MjMwMA==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1657#discussion_r396862300", "bodyText": "done", "author": "GuoYL123", "createdAt": "2020-03-24T02:02:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjgzNjgzNg=="}], "type": "inlineReview", "revised_code": {"commit": "0bee90e052282159b7f854d992c8387afee34675", "chunk": "diff --git a/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java b/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java\nindex ad4b78781..fd6fd1a73 100644\n--- a/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java\n+++ b/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java\n\n@@ -62,20 +71,19 @@ public class KieUtil {\n     List<KVDoc> versionList = new ArrayList<>();\n     for (KVDoc kvDoc : resp.getData()) {\n       Map<String, String> labelsMap = kvDoc.getLabels();\n-      //todo:how to deal env\n-      if (labelsMap.containsKey(\"app\") && labelsMap.get(\"app\")\n+      if (labelsMap.containsKey(LABEL_APP) && labelsMap.get(LABEL_APP)\n           .equals(KieConfig.INSTANCE.getAppName())\n-          && labelsMap.containsKey(\"environment\") && labelsMap.get(\"environment\")\n+          && labelsMap.containsKey(LABEL_ENV) && labelsMap.get(LABEL_ENV)\n           .equals(KieConfig.INSTANCE.getEnvironment())) {\n-        if (!labelsMap.containsKey(\"service\")) {\n+        if (!labelsMap.containsKey(LABEL_SERVICE)) {\n           appList.add(kvDoc);\n         }\n-        if (labelsMap.containsKey(\"service\") && labelsMap.get(\"service\")\n+        if (labelsMap.containsKey(LABEL_SERVICE) && labelsMap.get(LABEL_SERVICE)\n             .equals(KieConfig.INSTANCE.getServiceName())) {\n-          if (!kvDoc.getLabels().containsKey(\"version\")) {\n+          if (!kvDoc.getLabels().containsKey(LABEL_VERSION)) {\n             serviceList.add(kvDoc);\n           }\n-          if (labelsMap.containsKey(\"version\") && labelsMap.get(\"version\")\n+          if (labelsMap.containsKey(LABEL_VERSION) && labelsMap.get(LABEL_VERSION)\n               .equals(KieConfig.INSTANCE.getServiceName())) {\n             versionList.add(kvDoc);\n           }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjgzNjk0OQ==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1657#discussion_r396836949", "bodyText": "Can this todo removed?", "author": "liubao68", "createdAt": "2020-03-24T00:26:07Z", "path": "dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java", "diffHunk": "@@ -65,7 +65,7 @@ public static String encrypt(String dataStr) {\n       //todo:how to deal env", "originalCommit": "0e9e481402699593470bca43c51b403865bfa375", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Njg2MjMzNg==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1657#discussion_r396862336", "bodyText": "done", "author": "GuoYL123", "createdAt": "2020-03-24T02:02:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjgzNjk0OQ=="}], "type": "inlineReview", "revised_code": {"commit": "0bee90e052282159b7f854d992c8387afee34675", "chunk": "diff --git a/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java b/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java\nindex ad4b78781..fd6fd1a73 100644\n--- a/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java\n+++ b/dynamic-config/config-kie/src/main/java/org/apache/servicecomb/config/kie/client/KieUtil.java\n\n@@ -62,20 +71,19 @@ public class KieUtil {\n     List<KVDoc> versionList = new ArrayList<>();\n     for (KVDoc kvDoc : resp.getData()) {\n       Map<String, String> labelsMap = kvDoc.getLabels();\n-      //todo:how to deal env\n-      if (labelsMap.containsKey(\"app\") && labelsMap.get(\"app\")\n+      if (labelsMap.containsKey(LABEL_APP) && labelsMap.get(LABEL_APP)\n           .equals(KieConfig.INSTANCE.getAppName())\n-          && labelsMap.containsKey(\"environment\") && labelsMap.get(\"environment\")\n+          && labelsMap.containsKey(LABEL_ENV) && labelsMap.get(LABEL_ENV)\n           .equals(KieConfig.INSTANCE.getEnvironment())) {\n-        if (!labelsMap.containsKey(\"service\")) {\n+        if (!labelsMap.containsKey(LABEL_SERVICE)) {\n           appList.add(kvDoc);\n         }\n-        if (labelsMap.containsKey(\"service\") && labelsMap.get(\"service\")\n+        if (labelsMap.containsKey(LABEL_SERVICE) && labelsMap.get(LABEL_SERVICE)\n             .equals(KieConfig.INSTANCE.getServiceName())) {\n-          if (!kvDoc.getLabels().containsKey(\"version\")) {\n+          if (!kvDoc.getLabels().containsKey(LABEL_VERSION)) {\n             serviceList.add(kvDoc);\n           }\n-          if (labelsMap.containsKey(\"version\") && labelsMap.get(\"version\")\n+          if (labelsMap.containsKey(LABEL_VERSION) && labelsMap.get(LABEL_VERSION)\n               .equals(KieConfig.INSTANCE.getServiceName())) {\n             versionList.add(kvDoc);\n           }\n"}}, {"oid": "0bee90e052282159b7f854d992c8387afee34675", "url": "https://github.com/apache/servicecomb-java-chassis/commit/0bee90e052282159b7f854d992c8387afee34675", "message": "change kie label env to environment", "committedDate": "2020-03-24T01:49:29Z", "type": "commit"}, {"oid": "0bee90e052282159b7f854d992c8387afee34675", "url": "https://github.com/apache/servicecomb-java-chassis/commit/0bee90e052282159b7f854d992c8387afee34675", "message": "change kie label env to environment", "committedDate": "2020-03-24T01:49:29Z", "type": "forcePushed"}]}