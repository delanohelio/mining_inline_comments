{"pr_number": 1628, "pr_title": "[SCB-1796] support client outlog", "pr_createdAt": "2020-03-11T11:49:54Z", "pr_url": "https://github.com/apache/servicecomb-java-chassis/pull/1628", "timeline": [{"oid": "00b989b476eb98df7f30229c299620bc7006ad29", "url": "https://github.com/apache/servicecomb-java-chassis/commit/00b989b476eb98df7f30229c299620bc7006ad29", "message": "[SCB-1796] support client outlog: add client transport info", "committedDate": "2020-03-11T12:56:11Z", "type": "forcePushed"}, {"oid": "c1ded79b5f7666b0dc902727817a0f5a11a7dcdd", "url": "https://github.com/apache/servicecomb-java-chassis/commit/c1ded79b5f7666b0dc902727817a0f5a11a7dcdd", "message": "[SCB-1796] support client outlog: add client transport info", "committedDate": "2020-03-11T14:33:58Z", "type": "forcePushed"}, {"oid": "390a9b61f613a7dda8399ad263103af0e6e78315", "url": "https://github.com/apache/servicecomb-java-chassis/commit/390a9b61f613a7dda8399ad263103af0e6e78315", "message": "[SCB-1796] support client outlog: add client transport info", "committedDate": "2020-03-16T11:41:48Z", "type": "forcePushed"}, {"oid": "f3459f5f9ce216ecaa4d2e89b94152c828ba4bc6", "url": "https://github.com/apache/servicecomb-java-chassis/commit/f3459f5f9ce216ecaa4d2e89b94152c828ba4bc6", "message": "[SCB-1793] use @RequestHeader(value =\"xxx\") : add ut", "committedDate": "2020-03-17T13:50:09Z", "type": "forcePushed"}, {"oid": "62b72298c23a81bb70d6ffb3f49e5da34182814f", "url": "https://github.com/apache/servicecomb-java-chassis/commit/62b72298c23a81bb70d6ffb3f49e5da34182814f", "message": "[SCB-1796]  add ut", "committedDate": "2020-03-17T13:54:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA2ODY2Mw==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1628#discussion_r394068663", "bodyText": "servervicomb.request.log  or servicecomb.accesslog.request is better, see 'https://sling.apache.org/documentation/development/client-request-logging.html' for reference.", "author": "liubao68", "createdAt": "2020-03-18T02:09:30Z", "path": "foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/LogConfig.java", "diffHunk": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.servicecomb.foundation.log;\n+\n+import com.netflix.config.DynamicPropertyFactory;\n+\n+public class LogConfig {\n+\n+    private static final String SERVER_BASE = \"servicecomb.accesslog.\";\n+\n+    private static final String CLIENT_BASE = \"servicecomb.outlog.\";", "originalCommit": "62b72298c23a81bb70d6ffb3f49e5da34182814f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3MTc2MQ==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1628#discussion_r394171761", "bodyText": "ok, servervicomb.request.log  is better", "author": "heyile", "createdAt": "2020-03-18T08:21:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA2ODY2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "258191bdd003a5b5596cdc9fdafc0ff3fb70c367", "chunk": "diff --git a/foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/LogConfig.java b/common/common-access-log/src/main/java/org/apache/servicecomb/common/accessLog/AccessLogConfig.java\nsimilarity index 90%\nrename from foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/LogConfig.java\nrename to common/common-access-log/src/main/java/org/apache/servicecomb/common/accessLog/AccessLogConfig.java\nindex 8b4de90d5..ce2dc5885 100644\n--- a/foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/LogConfig.java\n+++ b/common/common-access-log/src/main/java/org/apache/servicecomb/common/accessLog/AccessLogConfig.java\n\n@@ -15,15 +15,15 @@\n  * limitations under the License.\n  */\n \n-package org.apache.servicecomb.foundation.log;\n+package org.apache.servicecomb.common.accessLog;\n \n import com.netflix.config.DynamicPropertyFactory;\n \n-public class LogConfig {\n+public class AccessLogConfig {\n \n     private static final String SERVER_BASE = \"servicecomb.accesslog.\";\n \n-    private static final String CLIENT_BASE = \"servicecomb.outlog.\";\n+    private static final String CLIENT_BASE = \"servicecomb.accesslog.request.\";\n \n     private static final String SERVER_LOG_ENABLED = SERVER_BASE + \"enabled\";\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA2OTI2Mw==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1628#discussion_r394069263", "bodyText": "Server access log and request log can both called AccessLog. Log is a general name may be confusing with any application trace. I'd prefer using AccessLogItem. And 'servicecomb.assesslog.request` as the configuration.", "author": "liubao68", "createdAt": "2020-03-18T02:12:00Z", "path": "foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/core/element/LogItem.java", "diffHunk": "@@ -15,17 +15,22 @@\n  * limitations under the License.\n  */\n \n-package org.apache.servicecomb.transport.rest.vertx.accesslog.element;\n+package org.apache.servicecomb.foundation.log.core.element;\n \n-import org.apache.servicecomb.transport.rest.vertx.accesslog.AccessLogParam;\n+import org.apache.servicecomb.core.event.InvocationFinishEvent;\n+import org.apache.servicecomb.core.event.ServerAccessLogEvent;\n \n /*\n  * Access log item represents the items supported in access log printing.\n  * It generate the segment of access log according to {@link AccessLogParam}\n  */\n-public interface AccessLogItem<T> {\n+public interface LogItem<T> {", "originalCommit": "62b72298c23a81bb70d6ffb3f49e5da34182814f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDE3MTY0Mw==", "url": "https://github.com/apache/servicecomb-java-chassis/pull/1628#discussion_r394171643", "bodyText": "ok", "author": "heyile", "createdAt": "2020-03-18T08:21:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NDA2OTI2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "258191bdd003a5b5596cdc9fdafc0ff3fb70c367", "chunk": "diff --git a/foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/core/element/LogItem.java b/common/common-access-log/src/main/java/org/apache/servicecomb/common/accessLog/core/element/AccessLogItem.java\nsimilarity index 67%\nrename from foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/core/element/LogItem.java\nrename to common/common-access-log/src/main/java/org/apache/servicecomb/common/accessLog/core/element/AccessLogItem.java\nindex d52cd9725..02fffb25a 100644\n--- a/foundations/foundation-log/src/main/java/org/apache/servicecomb/foundation/log/core/element/LogItem.java\n+++ b/common/common-access-log/src/main/java/org/apache/servicecomb/common/accessLog/core/element/AccessLogItem.java\n\n@@ -15,22 +15,19 @@\n  * limitations under the License.\n  */\n \n-package org.apache.servicecomb.foundation.log.core.element;\n+package org.apache.servicecomb.common.accessLog.core.element;\n \n import org.apache.servicecomb.core.event.InvocationFinishEvent;\n import org.apache.servicecomb.core.event.ServerAccessLogEvent;\n \n /*\n- * Access log item represents the items supported in access log printing.\n- * It generate the segment of access log according to {@link AccessLogParam}\n+ * Access log item represents the items supported in access log and request log printing.\n+ * It generate the segment of log according to {@link AccessLogParam}\n  */\n-public interface LogItem<T> {\n-  /*\n-   * find out specified content from {@link AccessLogParam}, format the content and return it.\n-   */\n-  default void appendFormattedItem(ServerAccessLogEvent accessLogEvent, StringBuilder builder) {\n+public interface AccessLogItem<T> {\n+  default void appendServerFormattedItem(ServerAccessLogEvent accessLogEvent, StringBuilder builder) {\n   }\n \n-  default void appendFormattedItem(InvocationFinishEvent clientLogEvent, StringBuilder builder) {\n+  default void appendClientFormattedItem(InvocationFinishEvent clientLogEvent, StringBuilder builder) {\n   }\n }\n"}}, {"oid": "258191bdd003a5b5596cdc9fdafc0ff3fb70c367", "url": "https://github.com/apache/servicecomb-java-chassis/commit/258191bdd003a5b5596cdc9fdafc0ff3fb70c367", "message": "[SCB-1796] support request log : modify as review and support log4j", "committedDate": "2020-03-19T13:48:57Z", "type": "forcePushed"}, {"oid": "d0d5907e912e9013bd047dce78d860e1444d9038", "url": "https://github.com/apache/servicecomb-java-chassis/commit/d0d5907e912e9013bd047dce78d860e1444d9038", "message": "[SCB-1796] support request log : modify as review and support log4j", "committedDate": "2020-03-19T13:55:59Z", "type": "forcePushed"}, {"oid": "c7209da0626f1a2512ad778d13457ddab201e87f", "url": "https://github.com/apache/servicecomb-java-chassis/commit/c7209da0626f1a2512ad778d13457ddab201e87f", "message": "[SCB-1796] support request log : modify as review and support log4j", "committedDate": "2020-03-19T14:17:09Z", "type": "forcePushed"}, {"oid": "4a27b5e6e977099d119a5ffd275072af1197f222", "url": "https://github.com/apache/servicecomb-java-chassis/commit/4a27b5e6e977099d119a5ffd275072af1197f222", "message": "[SCB-1796] support client outlog", "committedDate": "2020-03-20T01:29:03Z", "type": "commit"}, {"oid": "64bc8abeb2d9221fc144bade8e2200c187ee4713", "url": "https://github.com/apache/servicecomb-java-chassis/commit/64bc8abeb2d9221fc144bade8e2200c187ee4713", "message": "[SCB-1796] support client outlog: add client transport info", "committedDate": "2020-03-20T01:29:03Z", "type": "commit"}, {"oid": "d274ed856c1b675ec383d7e2305ff2571df81708", "url": "https://github.com/apache/servicecomb-java-chassis/commit/d274ed856c1b675ec383d7e2305ff2571df81708", "message": "[SCB-1796]  add ut", "committedDate": "2020-03-20T01:29:03Z", "type": "commit"}, {"oid": "4c696f4425ff68912b3171eb5c05db16e75a1123", "url": "https://github.com/apache/servicecomb-java-chassis/commit/4c696f4425ff68912b3171eb5c05db16e75a1123", "message": "[SCB-1796] support request log : modify as review and support log4j", "committedDate": "2020-03-20T01:29:04Z", "type": "forcePushed"}, {"oid": "0eb2cef1f65002835ec099ba0ee1403f14dee235", "url": "https://github.com/apache/servicecomb-java-chassis/commit/0eb2cef1f65002835ec099ba0ee1403f14dee235", "message": "[SCB-1796] support request log : modify as review and support log4j", "committedDate": "2020-03-20T01:47:28Z", "type": "commit"}, {"oid": "0eb2cef1f65002835ec099ba0ee1403f14dee235", "url": "https://github.com/apache/servicecomb-java-chassis/commit/0eb2cef1f65002835ec099ba0ee1403f14dee235", "message": "[SCB-1796] support request log : modify as review and support log4j", "committedDate": "2020-03-20T01:47:28Z", "type": "forcePushed"}]}