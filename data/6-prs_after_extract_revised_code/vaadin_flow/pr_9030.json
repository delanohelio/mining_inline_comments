{"pr_number": 9030, "pr_title": "Add test for forwardTo from setParameter without BeforeEnterObserver.", "pr_createdAt": "2020-09-18T08:32:57Z", "pr_url": "https://github.com/vaadin/flow/pull/9030", "timeline": [{"oid": "870d669ef4f65970cc70f5c33fba18a11d664c29", "url": "https://github.com/vaadin/flow/commit/870d669ef4f65970cc70f5c33fba18a11d664c29", "message": "Add test for forwardTo from setParameter without BeforeEnterObserver.", "committedDate": "2020-09-18T08:31:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg0NTkxOA==", "url": "https://github.com/vaadin/flow/pull/9030#discussion_r491845918", "bodyText": "Why are we setting a private static parameter of another class here?", "author": "caalador", "createdAt": "2020-09-21T07:44:12Z", "path": "flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java", "diffHunk": "@@ -1599,7 +1599,42 @@ private void redirect(BeforeEnterEvent event,\n     public static class RedirectWithRouteParametersView\n             extends RouteParametersBase {\n     }\n-    \n+\n+    @Route(\"forward/setParameter/back\")\n+    @Tag(Tag.DIV)\n+    public static class ForwardSetParameterBackView extends Component implements BeforeEnterObserver {\n+\n+        @Override\n+        public void beforeEnter(BeforeEnterEvent event) {\n+            ForwardSetParameterView.backBeforeEnterInvoked = true;", "originalCommit": "870d669ef4f65970cc70f5c33fba18a11d664c29", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "af6fff4ffca723f8b414904d3ac113f22b002041", "chunk": "diff --git a/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java b/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java\nindex b387f137eb..d7a45bc308 100644\n--- a/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java\n+++ b/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java\n\n@@ -1614,24 +1614,24 @@ public class RouterTest extends RoutingTestBase {\n     @Tag(Tag.DIV)\n     public static class ForwardSetParameterView extends Component implements HasUrlParameter<String>, AfterNavigationObserver {\n \n-        private static boolean afterNavigationInvocked = false;\n-        private static boolean backBeforeEnterInvoked = false;\n+        static boolean afterNavigationInvoked = false;\n+        static boolean backBeforeEnterInvoked = false;\n \n         private static void clear() {\n-            afterNavigationInvocked = false;\n+            afterNavigationInvoked = false;\n             backBeforeEnterInvoked = false;\n         }\n \n         @Override\n         public void setParameter(BeforeEvent event, String parameter) {\n-            afterNavigationInvocked = false;\n+            afterNavigationInvoked = false;\n \n             event.forwardTo(ForwardSetParameterBackView.class);\n         }\n \n         @Override\n         public void afterNavigation(AfterNavigationEvent event) {\n-            afterNavigationInvocked = true;\n+            afterNavigationInvoked = true;\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg0NTk1MA==", "url": "https://github.com/vaadin/flow/pull/9030#discussion_r491845950", "bodyText": "Use assertFalse and assertTrue instead of assertEquals", "author": "caalador", "createdAt": "2020-09-21T07:44:16Z", "path": "flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java", "diffHunk": "@@ -3782,6 +3817,22 @@ public void forward_withWrongRouteParameters_fails() {\n         assertWrongRouteParametersRedirect();\n     }\n \n+    @Test // #5173\n+    public void forward_fromSetParameters_withoutBeforeEnterObserver() {\n+        ForwardSetParameterView.clear();\n+\n+        setNavigationTargets(ForwardSetParameterView.class,\n+                ForwardSetParameterBackView.class);\n+\n+        navigate(\"forward/setParameter/test\");\n+\n+        Assert.assertEquals(", "originalCommit": "870d669ef4f65970cc70f5c33fba18a11d664c29", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "af6fff4ffca723f8b414904d3ac113f22b002041", "chunk": "diff --git a/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java b/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java\nindex b387f137eb..d7a45bc308 100644\n--- a/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java\n+++ b/flow-server/src/test/java/com/vaadin/flow/router/RouterTest.java\n\n@@ -3826,11 +3826,11 @@ public class RouterTest extends RoutingTestBase {\n \n         navigate(\"forward/setParameter/test\");\n \n-        Assert.assertEquals(\n+        Assert.assertFalse(\n                 \"afterNavigation must not be invoked after forwardTo in setParameter\",\n-                false, ForwardSetParameterView.afterNavigationInvocked);\n-        Assert.assertEquals(\"forwardTo ForwardSetParameterBackView failed\",\n-                true, ForwardSetParameterView.backBeforeEnterInvoked);\n+                ForwardSetParameterView.afterNavigationInvoked);\n+        Assert.assertTrue(\"forwardTo ForwardSetParameterBackView failed\",\n+                ForwardSetParameterView.backBeforeEnterInvoked);\n     }\n \n     private void assertWrongRouteParametersRedirect() {\n"}}, {"oid": "af6fff4ffca723f8b414904d3ac113f22b002041", "url": "https://github.com/vaadin/flow/commit/af6fff4ffca723f8b414904d3ac113f22b002041", "message": "Fix comments", "committedDate": "2020-09-21T07:59:54Z", "type": "commit"}]}