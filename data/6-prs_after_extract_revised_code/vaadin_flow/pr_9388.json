{"pr_number": 9388, "pr_title": "Cherry Picks to 4.0", "pr_createdAt": "2020-11-12T10:36:37Z", "pr_url": "https://github.com/vaadin/flow/pull/9388", "timeline": [{"oid": "b6bc58b32a24cb05800a365362b90c0e7e7518f3", "url": "https://github.com/vaadin/flow/commit/b6bc58b32a24cb05800a365362b90c0e7e7518f3", "message": "fix: Use ArrayList while creating ListDataProvider from items array (#9197)\n\nWrapped the result of `Arrays.asList(T... items)` by `java.util.ArrayList` to support further add/remove operations through the DataView API without getting an UnsupportedOperationException.\n\nFixes #8761\n\n(cherry picked from commit c4c4ec9cc960927f393280abe7341682d1acd8e2)", "committedDate": "2020-11-12T10:16:58Z", "type": "commit"}, {"oid": "0ba4d723b817e0b382ff637061bf3c41d0d134f0", "url": "https://github.com/vaadin/flow/commit/0ba4d723b817e0b382ff637061bf3c41d0d134f0", "message": "fix: hide loading indicator when endpoint call fails (#9380)\n\n(cherry picked from commit 676f7529f1eafeb188d3cf3bb87be86ea7722af6)", "committedDate": "2020-11-12T12:25:44Z", "type": "commit"}, {"oid": "d690843e2b16318974a4c5e686d2759f702c312c", "url": "https://github.com/vaadin/flow/commit/d690843e2b16318974a4c5e686d2759f702c312c", "message": "fix: increase threshold for performance test (#9381)\n\n(cherry picked from commit 529f7111729fe68c3c3190d12b22e3d41fcb84b6)", "committedDate": "2020-11-12T12:26:07Z", "type": "commit"}, {"oid": "1c343dbffa9ed1dae6a890344f325d1d0d04c91e", "url": "https://github.com/vaadin/flow/commit/1c343dbffa9ed1dae6a890344f325d1d0d04c91e", "message": "feat: tree-shakeable ES imports for TS form validators (#9374)\n\n- Use tree-shakeable ES imports for TS form validators based on the latest version of validators lib.\n- Add missing `return` in the `submit()` method\n\n(cherry picked from commit 6608604b94af4f11013463dfdcf9521681ddb4e0)", "committedDate": "2020-11-12T12:26:35Z", "type": "commit"}, {"oid": "830ff84bb1dac53b12754a05f1ba744b77b685a2", "url": "https://github.com/vaadin/flow/commit/830ff84bb1dac53b12754a05f1ba744b77b685a2", "message": "fix: support Range requests with either start or end byte index omitted (#9368)\n\nSupports headers of the type Range: -123 and Range: 123-.\n\nFixes #9083.\n\n(cherry picked from commit ff28dd041ce8f477b4a0734c37540cec71ea524d)", "committedDate": "2020-11-12T12:26:57Z", "type": "commit"}, {"oid": "6c9b360d07345e3f8a2898032609e8133e2563b2", "url": "https://github.com/vaadin/flow/commit/6c9b360d07345e3f8a2898032609e8133e2563b2", "message": "chore: do not depend on commons.lang3 (#9271)\n\n(cherry picked from commit 427ca7840cb2ec4fea44e7bb81fef22cf9d41965)", "committedDate": "2020-11-12T12:31:45Z", "type": "commit"}, {"oid": "8e50c7d49b6664afacda4c21fc0acd2511ab3706", "url": "https://github.com/vaadin/flow/commit/8e50c7d49b6664afacda4c21fc0acd2511ab3706", "message": "fix: Simplify check for recursive Composite::getContent() (#9180)\n\nUsing a regular instance field instead of a non-static ThreadLocal has\nno functional difference except in the hypothetical case when\ngetContent() would be called concurrently on a different thread. That\ncase is not supposed to happen since the session lock should be used to\nprevent concurrent access. Furthermore, concurrent invocation would\nstill not work properly since use of the `content` field is not\nsynchronized.\n\nA simple boolean communicates the intent more clearly, thus making the\npurpose of the implementation easier to understand. The simpler approach\nalso has a minimal positive impact on CPU usage and memory allocation.\n\nFixes #9160\n\n(cherry picked from commit 51f0eda33063e00b4cdc79e97f4724159ea9a09f)", "committedDate": "2020-11-12T12:36:18Z", "type": "commit"}, {"oid": "45898fdfad88068f4839f81ed3c586f9092789de", "url": "https://github.com/vaadin/flow/commit/45898fdfad88068f4839f81ed3c586f9092789de", "message": "fix: Fix JavaScriptBootstrapUI::getChildren\n\nIt should return all components added to the UI, like Dialog and Notification.\nRelated to #7799\n\nFixes #9069\n\n(cherry picked from commit bae7bce45ce8708b6a00867f7b52ea854c45eb07)", "committedDate": "2020-11-12T14:17:05Z", "type": "commit"}, {"oid": "6a18dc7926027ea1eb54fdaa9bf2fa91f48d145b", "url": "https://github.com/vaadin/flow/commit/6a18dc7926027ea1eb54fdaa9bf2fa91f48d145b", "message": "fix: check if Url contains directory change in Dev Mode (#9392)\n\nChecks whether the Url contains a directory change and a double encoding in Dev Mode. Returns 403 Forbidden immediately and skip the request handling, if does.\n\n(cherry picked from commit 19fe3864f9d1567c5ac7a211189986ac093e781f)", "committedDate": "2020-11-18T12:48:55Z", "type": "commit"}, {"oid": "5519bacd3c97fa0e9e84f35151c0a0f13e3a1df9", "url": "https://github.com/vaadin/flow/commit/5519bacd3c97fa0e9e84f35151c0a0f13e3a1df9", "message": "chore: remove test module test-subcontext (#9394)\n\nThis module is subsumed by test-router-custom-context.\n\n(cherry picked from commit ea7d5c6ace26628da706bf335ec5bfef5e37df44)", "committedDate": "2020-11-18T13:17:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNjA5NTgwMA==", "url": "https://github.com/vaadin/flow/pull/9388#discussion_r526095800", "bodyText": "Define and throw a dedicated exception instead of using a generic one.", "author": "vaadin-bot", "createdAt": "2020-11-18T13:42:24Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/HandlerHelper.java", "diffHunk": "@@ -176,4 +189,26 @@ public static String getCancelingRelativePath(String pathToCancel) {\n         return sb.toString();\n     }\n \n+    /**\n+     * Checks if the given URL path contains the directory change instruction\n+     * (dot-dot), taking into account possible double encoding in hexadecimal\n+     * format, which can be injected maliciously.\n+     *\n+     * @param path\n+     *            the URL path to be verified.\n+     * @return {@code true}, if the given path has a directory change\n+     *         instruction, {@code false} otherwise.\n+     */\n+    static boolean isPathUnsafe(String path) {\n+        // Check that the path does not have '/../', '\\..\\', %5C..%5C,\n+        // %2F..%2F, nor '/..', '\\..', %5C.., %2F..\n+        try {\n+            path = URLDecoder.decode(path, StandardCharsets.UTF_8.name());\n+        } catch (UnsupportedEncodingException e) {\n+            throw new RuntimeException(\"An error occurred during decoding URL.\",", "originalCommit": "5519bacd3c97fa0e9e84f35151c0a0f13e3a1df9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}