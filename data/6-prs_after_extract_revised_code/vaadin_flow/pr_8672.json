{"pr_number": 8672, "pr_title": "Merge 2.2 to 2.3", "pr_createdAt": "2020-07-01T10:23:14Z", "pr_url": "https://github.com/vaadin/flow/pull/8672", "timeline": [{"oid": "c6bbbd75227eb60e5c626ba219ec70726ba20238", "url": "https://github.com/vaadin/flow/commit/c6bbbd75227eb60e5c626ba219ec70726ba20238", "message": "Push history when navigating to route-not-found view (#8630) (#8640)\n\nFixes #8544", "committedDate": "2020-06-29T12:06:05Z", "type": "commit"}, {"oid": "90b35089d8a32868f1b8b4c51eb128bcf6c24264", "url": "https://github.com/vaadin/flow/commit/90b35089d8a32868f1b8b4c51eb128bcf6c24264", "message": "Clear thread local instances on connection lost in push handler (#8567)\n\nFixes #8548\n# Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/server/communication/PushHandler.java\n#\tflow-server/src/test/java/com/vaadin/flow/server/communication/PushHandlerTest.java", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "58306fc566f0514139f9b57931f584f45d0213e2", "url": "https://github.com/vaadin/flow/commit/58306fc566f0514139f9b57931f584f45d0213e2", "message": "Avoid NPEs in WebBrowser (#8577)\n\nFixes #6955", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "0a2d24d410b5ffa7412c0642f3d57aaebeb34547", "url": "https://github.com/vaadin/flow/commit/0a2d24d410b5ffa7412c0642f3d57aaebeb34547", "message": "Push history when navigating to route-not-found view (#8630)\n\nFixes #8544", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "fea542125344098b098078a5302323dd9386f5c8", "url": "https://github.com/vaadin/flow/commit/fea542125344098b098078a5302323dd9386f5c8", "message": "Don't use preserve on refresh logic in case of the same UI (#8622)\n\nsetPreservedChain doesn't store Location in the cache but only a path.\r\nThis is logically correct for the router functionality since routing\r\nconsiders only path and not parameters. But the same view (and same UI)\r\nshould not trigger preserve on refresh logic if they only differ with a\r\nparameter.\r\n\r\nFixes #8605", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "700087d57742ca374ebde181868471b87ab2fc0b", "url": "https://github.com/vaadin/flow/commit/700087d57742ca374ebde181868471b87ab2fc0b", "message": "Destroy external frontend resources install process on JVM exit (#8610)\n\n* Destroy external frontend resources install process on JVM exit\n\nFixes #8597\n\n* Improve code a bit", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "e3ed1e217d96bb3206ac461fe8ccbef0b8264650", "url": "https://github.com/vaadin/flow/commit/e3ed1e217d96bb3206ac461fe8ccbef0b8264650", "message": "Check whether the lifecycle state is already terminated before terminate (#8626)\n\nFixes #8623", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "8c5ae7221fb18c4885c7bf95a2a1570e6bcaca56", "url": "https://github.com/vaadin/flow/commit/8c5ae7221fb18c4885c7bf95a2a1570e6bcaca56", "message": "Make Registration for Component::addListener idempotent (#8606)\n\nFixes #8506", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "b2b148bc11a263790543c08047027a3240b61f4c", "url": "https://github.com/vaadin/flow/commit/b2b148bc11a263790543c08047027a3240b61f4c", "message": "Fix compilation error after cherry-picks", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "e7beb2d21bca489b15b5711bfb717a05701bd22a", "url": "https://github.com/vaadin/flow/commit/e7beb2d21bca489b15b5711bfb717a05701bd22a", "message": "Correct next cherry-pick error", "committedDate": "2020-06-30T11:44:20Z", "type": "commit"}, {"oid": "039ac6a06a3c1c669d02f9126c476b6f40e59dec", "url": "https://github.com/vaadin/flow/commit/039ac6a06a3c1c669d02f9126c476b6f40e59dec", "message": "Update attribute value on attach (#7627) (#8642)\n\n* Fix the bug\r\n* Add IT tests for re-attaching a stream resource\r\n\r\nFixes #6478\r\n\r\n# Conflicts:\r\n#\tflow-tests/test-root-context/src/main/java/com/vaadin/flow/uitest/ui/StreamResourceView.java\r\n#\tflow-tests/test-root-context/src/test/java/com/vaadin/flow/uitest/ui/PreserveOnRefreshIT.java\r\n#\tflow-tests/test-root-context/src/test/java/com/vaadin/flow/uitest/ui/StreamResourceIT.java", "committedDate": "2020-06-30T12:19:07Z", "type": "commit"}, {"oid": "094494ccc7f7e8112b30e97e0b715852ed12c20f", "url": "https://github.com/vaadin/flow/commit/094494ccc7f7e8112b30e97e0b715852ed12c20f", "message": "Merge branch '2.2' into merge2.2-2.3\n\n# Solved Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/server/communication/PushHandler.java\n#\tflow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java\n#\tflow-server/src/test/java/com/vaadin/flow/server/communication/PushHandlerTest.java", "committedDate": "2020-07-01T09:33:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODI4OTA1MQ==", "url": "https://github.com/vaadin/flow/pull/8672#discussion_r448289051", "bodyText": "Reduce the number of conditional operators (4) used in the expression (maximum allowed 3).", "author": "vaadin-bot", "createdAt": "2020-07-01T11:07:44Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -265,10 +265,10 @@ private boolean shouldRunNpmInstall() {\n                     .listFiles(\n                             (dir, name) -> !ignoredNodeFolders.contains(name));\n             assert installedPackages != null;\n-            return installedPackages.length == 0 || (\n-                    installedPackages.length == 1 && FLOW_NPM_PACKAGE_NAME\n-                            .startsWith(installedPackages[0].getName())) || (\n-                    installedPackages.length > 0 && isVaadinHashUpdated());\n+            return installedPackages.length == 0", "originalCommit": "094494ccc7f7e8112b30e97e0b715852ed12c20f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}