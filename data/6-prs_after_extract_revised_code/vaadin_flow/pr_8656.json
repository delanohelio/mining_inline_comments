{"pr_number": 8656, "pr_title": "Cherry-picks to 2.2", "pr_createdAt": "2020-06-30T09:28:32Z", "pr_url": "https://github.com/vaadin/flow/pull/8656", "timeline": [{"oid": "e9c94ed1311dc726fd481e46ac146c64edf30731", "url": "https://github.com/vaadin/flow/commit/e9c94ed1311dc726fd481e46ac146c64edf30731", "message": "Clear thread local instances on connection lost in push handler (#8567)\n\nFixes #8548\n# Conflicts:\n#\tflow-server/src/main/java/com/vaadin/flow/server/communication/PushHandler.java\n#\tflow-server/src/test/java/com/vaadin/flow/server/communication/PushHandlerTest.java", "committedDate": "2020-06-30T08:54:19Z", "type": "commit"}, {"oid": "d8717b655eea955572f3413e3eefd9d8c8663477", "url": "https://github.com/vaadin/flow/commit/d8717b655eea955572f3413e3eefd9d8c8663477", "message": "Add client side API for listening DOM Node set for StateNode (#8590)\n\nPart of vaadin/multiplatform-runtime#72", "committedDate": "2020-06-30T08:55:56Z", "type": "commit"}, {"oid": "903a70ee8992a273dbd6b557b1840e2cc28d15fa", "url": "https://github.com/vaadin/flow/commit/903a70ee8992a273dbd6b557b1840e2cc28d15fa", "message": "Avoid NPEs in WebBrowser (#8577)\n\nFixes #6955", "committedDate": "2020-06-30T08:58:29Z", "type": "commit"}, {"oid": "e274c3ff27e3d82d3c80a8f21655590fcc83f5fe", "url": "https://github.com/vaadin/flow/commit/e274c3ff27e3d82d3c80a8f21655590fcc83f5fe", "message": "Push history when navigating to route-not-found view (#8630)\n\nFixes #8544", "committedDate": "2020-06-30T08:58:58Z", "type": "commit"}, {"oid": "00ee6fca559336720761be08bbc089e5d725f77e", "url": "https://github.com/vaadin/flow/commit/00ee6fca559336720761be08bbc089e5d725f77e", "message": "Don't use preserve on refresh logic in case of the same UI (#8622)\n\nsetPreservedChain doesn't store Location in the cache but only a path.\r\nThis is logically correct for the router functionality since routing\r\nconsiders only path and not parameters. But the same view (and same UI)\r\nshould not trigger preserve on refresh logic if they only differ with a\r\nparameter.\r\n\r\nFixes #8605", "committedDate": "2020-06-30T08:59:06Z", "type": "commit"}, {"oid": "630fbebb32c74cc9003d9cfcdf19bb4d86d4d98b", "url": "https://github.com/vaadin/flow/commit/630fbebb32c74cc9003d9cfcdf19bb4d86d4d98b", "message": "Destroy external frontend resources install process on JVM exit (#8610)\n\n* Destroy external frontend resources install process on JVM exit\n\nFixes #8597\n\n* Improve code a bit", "committedDate": "2020-06-30T09:11:32Z", "type": "commit"}, {"oid": "0769b6a65c365ce748090c85ca317724638ab56d", "url": "https://github.com/vaadin/flow/commit/0769b6a65c365ce748090c85ca317724638ab56d", "message": "Check whether the lifecycle state is already terminated before terminate (#8626)\n\nFixes #8623", "committedDate": "2020-06-30T09:14:41Z", "type": "commit"}, {"oid": "6855a6e63357229d6ec388deb62eb9afa26c01a4", "url": "https://github.com/vaadin/flow/commit/6855a6e63357229d6ec388deb62eb9afa26c01a4", "message": "Make Registration for Component::addListener idempotent (#8606)\n\nFixes #8506", "committedDate": "2020-06-30T09:25:30Z", "type": "commit"}, {"oid": "0a106f1af22875032ec787772b93e070df88634a", "url": "https://github.com/vaadin/flow/commit/0a106f1af22875032ec787772b93e070df88634a", "message": "Fix compilation error after cherry-picks", "committedDate": "2020-06-30T10:16:34Z", "type": "commit"}, {"oid": "3064cbe6a3f355125c298997d8f04f96701dd9be", "url": "https://github.com/vaadin/flow/commit/3064cbe6a3f355125c298997d8f04f96701dd9be", "message": "Correct next cherry-pick error", "committedDate": "2020-06-30T10:20:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYwMjQ1Mw==", "url": "https://github.com/vaadin/flow/pull/8656#discussion_r447602453", "bodyText": "Reduce the number of conditional operators (4) used in the expression (maximum allowed 3).", "author": "vaadin-bot", "createdAt": "2020-06-30T11:11:04Z", "path": "flow-server/src/main/java/com/vaadin/flow/server/frontend/TaskRunNpmInstall.java", "diffHunk": "@@ -181,10 +184,10 @@ private boolean shouldRunNpmInstall() {\n                     .listFiles(\n                             (dir, name) -> !ignoredNodeFolders.contains(name));\n             assert installedPackages != null;\n-            return installedPackages.length == 0 || (\n-                    installedPackages.length == 1 && FLOW_NPM_PACKAGE_NAME\n-                            .startsWith(installedPackages[0].getName())) || (\n-                    installedPackages.length > 0 && isVaadinHashUpdated());\n+            return installedPackages.length == 0", "originalCommit": "3064cbe6a3f355125c298997d8f04f96701dd9be", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}