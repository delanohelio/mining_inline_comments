{"pr_number": 5500, "pr_title": "GEODE-8486: record TransactionDataRebalancedException if tx put failed", "pr_createdAt": "2020-09-09T21:43:19Z", "pr_url": "https://github.com/apache/geode/pull/5500", "timeline": [{"oid": "64b7b0c74a3b1f0e42fc4eaaa0eb1a71f78d43d2", "url": "https://github.com/apache/geode/commit/64b7b0c74a3b1f0e42fc4eaaa0eb1a71f78d43d2", "message": "GEODE-8486: record TransactionDataRebalancedException if tx put failed\n\n  This is used to handle a retry of transactional put.", "committedDate": "2020-09-09T21:36:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTk1MDAzNw==", "url": "https://github.com/apache/geode/pull/5500#discussion_r485950037", "bodyText": "This might be better named \"failedEvents\" or \"eventExceptions.\"", "author": "DonalEvans", "createdAt": "2020-09-09T22:10:32Z", "path": "geode-core/src/main/java/org/apache/geode/internal/cache/TXState.java", "diffHunk": "@@ -146,7 +146,9 @@\n   /** keeps track of events, so as not to re-apply events */\n   protected Set<EventID> seenEvents = new HashSet<EventID>();\n   /** keeps track of results of txPutEntry */\n-  private Map<EventID, Boolean> seenResults = new HashMap<EventID, Boolean>();\n+  private Map<EventID, Boolean> seenResults = new HashMap<>();\n+  /** keeps track of TransactionDataRebalancedException during txPutEntry */\n+  private Map<EventID, TransactionDataRebalancedException> failedExceptions = new HashMap<>();", "originalCommit": "64b7b0c74a3b1f0e42fc4eaaa0eb1a71f78d43d2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1c8ce380171769df45020aed6cfdb48ea2a1a271", "chunk": "diff --git a/geode-core/src/main/java/org/apache/geode/internal/cache/TXState.java b/geode-core/src/main/java/org/apache/geode/internal/cache/TXState.java\nindex dcf1a793af..ea2cd01103 100644\n--- a/geode-core/src/main/java/org/apache/geode/internal/cache/TXState.java\n+++ b/geode-core/src/main/java/org/apache/geode/internal/cache/TXState.java\n\n@@ -148,7 +148,7 @@ public class TXState implements TXStateInterface {\n   /** keeps track of results of txPutEntry */\n   private Map<EventID, Boolean> seenResults = new HashMap<>();\n   /** keeps track of TransactionDataRebalancedException during txPutEntry */\n-  private Map<EventID, TransactionDataRebalancedException> failedExceptions = new HashMap<>();\n+  private Map<EventID, TransactionDataRebalancedException> eventExceptions = new HashMap<>();\n \n   @Immutable\n   static final TXEntryState ENTRY_EXISTS = new TXEntryState();\n"}}, {"oid": "1c8ce380171769df45020aed6cfdb48ea2a1a271", "url": "https://github.com/apache/geode/commit/1c8ce380171769df45020aed6cfdb48ea2a1a271", "message": "fix a review comment.", "committedDate": "2020-09-09T22:28:38Z", "type": "commit"}]}