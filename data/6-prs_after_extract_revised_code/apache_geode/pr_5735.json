{"pr_number": 5735, "pr_title": "GEODE-8685: change export to not deserialize region values", "pr_createdAt": "2020-11-12T01:27:20Z", "pr_url": "https://github.com/apache/geode/pull/5735", "timeline": [{"oid": "b0cf6602b7ee2dc28e7a67fa4b18616a672d3027", "url": "https://github.com/apache/geode/commit/b0cf6602b7ee2dc28e7a67fa4b18616a672d3027", "message": "modified test to fail if it attempts to deserialize values during export.\nFixed product export code to no longer deserialize and test now passes.", "committedDate": "2020-11-12T01:23:31Z", "type": "commit"}, {"oid": "a2328d299633b01506ae9329ff46185afd7c54b0", "url": "https://github.com/apache/geode/commit/a2328d299633b01506ae9329ff46185afd7c54b0", "message": "added a missing line of code", "committedDate": "2020-11-12T02:18:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzMwMTcxOQ==", "url": "https://github.com/apache/geode/pull/5735#discussion_r523301719", "bodyText": "Please rename variable to something more meaningful other than the character v", "author": "kohlmu-pivotal", "createdAt": "2020-11-14T00:40:56Z", "path": "geode-core/src/main/java/org/apache/geode/internal/cache/EntrySnapshot.java", "diffHunk": "@@ -123,6 +123,20 @@ public Object getRawValue(boolean forceCopy) {\n     return v;\n   }\n \n+  /**\n+   * If the value is available as a CachedDeserializable instance then return it.\n+   * Otherwise behave as if getValue() was called.\n+   */\n+  public Object getValuePreferringCachedDeserializable() {\n+    checkEntryDestroyed();\n+    Object v = this.regionEntry.getValue(null);", "originalCommit": "a2328d299633b01506ae9329ff46185afd7c54b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMyMjU5Nw==", "url": "https://github.com/apache/geode/pull/5735#discussion_r525322597", "bodyText": "done", "author": "dschneider-pivotal", "createdAt": "2020-11-17T16:55:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzMwMTcxOQ=="}], "type": "inlineReview", "revised_code": {"commit": "f7a6d69efe52926aabe483d074d4bb6434bbc0ca", "chunk": "diff --git a/geode-core/src/main/java/org/apache/geode/internal/cache/EntrySnapshot.java b/geode-core/src/main/java/org/apache/geode/internal/cache/EntrySnapshot.java\nindex cf9c64ec2c..84809f0bb1 100755\n--- a/geode-core/src/main/java/org/apache/geode/internal/cache/EntrySnapshot.java\n+++ b/geode-core/src/main/java/org/apache/geode/internal/cache/EntrySnapshot.java\n\n@@ -129,9 +129,9 @@ public class EntrySnapshot implements Region.Entry, DataSerializable {\n    */\n   public Object getValuePreferringCachedDeserializable() {\n     checkEntryDestroyed();\n-    Object v = this.regionEntry.getValue(null);\n-    if (v instanceof CachedDeserializable) {\n-      return v;\n+    Object value = regionEntry.getValue(null);\n+    if (value instanceof CachedDeserializable) {\n+      return value;\n     } else {\n       return getRawValue();\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzMwMjEwNQ==", "url": "https://github.com/apache/geode/pull/5735#discussion_r523302105", "bodyText": "Please refrain from using single character names", "author": "kohlmu-pivotal", "createdAt": "2020-11-14T00:42:36Z", "path": "geode-gfsh/src/integrationTest/java/org/apache/geode/management/internal/cli/commands/ExportDataIntegrationTest.java", "diffHunk": "@@ -53,10 +58,29 @@\n   @Rule\n   public TemporaryFolder tempDir = new TemporaryFolder();\n \n-  private Region<String, String> region;\n+  private Region<String, Object> region;\n   private Path snapshotFile;\n   private Path snapshotDir;\n \n+  public static class StringWrapper implements DataSerializable {\n+\n+    private String value;\n+\n+    public StringWrapper(String v) {\n+      value = v;", "originalCommit": "a2328d299633b01506ae9329ff46185afd7c54b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNTMyMjgwMQ==", "url": "https://github.com/apache/geode/pull/5735#discussion_r525322801", "bodyText": "done", "author": "dschneider-pivotal", "createdAt": "2020-11-17T16:56:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzMwMjEwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "f7a6d69efe52926aabe483d074d4bb6434bbc0ca", "chunk": "diff --git a/geode-gfsh/src/integrationTest/java/org/apache/geode/management/internal/cli/commands/ExportDataIntegrationTest.java b/geode-gfsh/src/integrationTest/java/org/apache/geode/management/internal/cli/commands/ExportDataIntegrationTest.java\nindex f9e1b9e73d..9a2d5970bd 100644\n--- a/geode-gfsh/src/integrationTest/java/org/apache/geode/management/internal/cli/commands/ExportDataIntegrationTest.java\n+++ b/geode-gfsh/src/integrationTest/java/org/apache/geode/management/internal/cli/commands/ExportDataIntegrationTest.java\n\n@@ -66,8 +66,8 @@ public class ExportDataIntegrationTest {\n \n     private String value;\n \n-    public StringWrapper(String v) {\n-      value = v;\n+    public StringWrapper(String string) {\n+      value = string;\n     }\n \n     @Override\n"}}, {"oid": "f7a6d69efe52926aabe483d074d4bb6434bbc0ca", "url": "https://github.com/apache/geode/commit/f7a6d69efe52926aabe483d074d4bb6434bbc0ca", "message": "changed two single character names to a full word", "committedDate": "2020-11-17T16:53:56Z", "type": "commit"}]}