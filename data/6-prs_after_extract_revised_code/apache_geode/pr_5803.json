{"pr_number": 5803, "pr_title": "GEODE-8742: fix list gateways command when dispatcher-threads is set \u2026", "pr_createdAt": "2020-12-02T10:01:27Z", "pr_url": "https://github.com/apache/geode/pull/5803", "timeline": [{"oid": "ba6d6e91c295f29f1f7746648226192d4c9f93c0", "url": "https://github.com/apache/geode/commit/ba6d6e91c295f29f1f7746648226192d4c9f93c0", "message": "GEODE-8742: fix list gateways command when dispatcher-threads is set to 1", "committedDate": "2020-12-02T08:58:32Z", "type": "commit"}, {"oid": "f5347ba918fd7baccf7f90f7196151cc3c280e65", "url": "https://github.com/apache/geode/commit/f5347ba918fd7baccf7f90f7196151cc3c280e65", "message": "empty commit to re-launch CI", "committedDate": "2020-12-02T12:10:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDM0NDY5OQ==", "url": "https://github.com/apache/geode/pull/5803#discussion_r534344699", "bodyText": "Instead of hard-coding the gfsh command, would it be possible to use CommandStringBuilder with the static strings found in CliStrings here?", "author": "DonalEvans", "createdAt": "2020-12-02T17:21:17Z", "path": "geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java", "diffHunk": "@@ -450,6 +450,30 @@ public void testListGatewaysReceiversOnlyFalseAndSendersOnlyFalseReturnsSendersA\n         .hasRowSize(expectedGwReceiverSectionSize).hasColumns().contains(\"Port\", \"Member\");\n   }\n \n+  @Test\n+  public void testListGatewaysWithOneDispatcherThread() {\n+    String command =\n+        \"create gateway-sender --id=ln_Serial --remote-distributed-system-id=2 --dispatcher-threads=1\";", "originalCommit": "f5347ba918fd7baccf7f90f7196151cc3c280e65", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "abd5c07ea0d4289399ff0f5ca611bdcbe5af696a", "chunk": "diff --git a/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java b/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java\nindex 1c4806b0b7..284c19633b 100644\n--- a/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java\n+++ b/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java\n\n@@ -452,8 +452,10 @@ public class ListGatewaysCommandDUnitTest implements Serializable {\n \n   @Test\n   public void testListGatewaysWithOneDispatcherThread() {\n-    String command =\n-        \"create gateway-sender --id=ln_Serial --remote-distributed-system-id=2 --dispatcher-threads=1\";\n+    String command = CliStrings.CREATE_GATEWAYSENDER + \" --\" + CliStrings.CREATE_GATEWAYSENDER__ID\n+        + \"=ln_Serial --\"\n+        + CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID + \"=2 --\"\n+        + CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS + \"=1\";\n \n     int lnPort = locatorSite1.getPort();\n \n"}}, {"oid": "abd5c07ea0d4289399ff0f5ca611bdcbe5af696a", "url": "https://github.com/apache/geode/commit/abd5c07ea0d4289399ff0f5ca611bdcbe5af696a", "message": "using CommandStringBuilder instead of hard-coding command", "committedDate": "2020-12-02T18:43:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxMDY2Mg==", "url": "https://github.com/apache/geode/pull/5803#discussion_r534410662", "bodyText": "If you use the CommandStringBuilder class with the addOption() method, you can avoid having to manually put in the dashes and equals signs, like so:\nString command = new CommandStringBuilder(CREATE_GATEWAYSENDER)\n        .addOption(CREATE_GATEWAYSENDER__ID, \"ln_Serial\")\n        .addOption(CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID, \"2\")\n        .addOption(CREATE_GATEWAYSENDER__DISPATCHERTHREADS, \"1\")\n        .getCommandString();\n\nThis helps make commands easier to read and reduces the chance of typos when writing them.", "author": "DonalEvans", "createdAt": "2020-12-02T19:02:18Z", "path": "geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java", "diffHunk": "@@ -452,8 +452,10 @@ public void testListGatewaysReceiversOnlyFalseAndSendersOnlyFalseReturnsSendersA\n \n   @Test\n   public void testListGatewaysWithOneDispatcherThread() {\n-    String command =\n-        \"create gateway-sender --id=ln_Serial --remote-distributed-system-id=2 --dispatcher-threads=1\";\n+    String command = CliStrings.CREATE_GATEWAYSENDER + \" --\" + CliStrings.CREATE_GATEWAYSENDER__ID", "originalCommit": "abd5c07ea0d4289399ff0f5ca611bdcbe5af696a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4OTc5NQ==", "url": "https://github.com/apache/geode/pull/5803#discussion_r534489795", "bodyText": "Nice! I take a look on test above, so I do on this way, but this proposal is better.", "author": "mkevo", "createdAt": "2020-12-02T21:22:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQxMDY2Mg=="}], "type": "inlineReview", "revised_code": {"commit": "35e3a1c16e2776af6b5f1b763f12f2b859b5e4fc", "chunk": "diff --git a/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java b/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java\nindex 284c19633b..b90159c8a1 100644\n--- a/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java\n+++ b/geode-wan/src/distributedTest/java/org/apache/geode/internal/cache/wan/wancommand/ListGatewaysCommandDUnitTest.java\n\n@@ -452,10 +453,11 @@ public class ListGatewaysCommandDUnitTest implements Serializable {\n \n   @Test\n   public void testListGatewaysWithOneDispatcherThread() {\n-    String command = CliStrings.CREATE_GATEWAYSENDER + \" --\" + CliStrings.CREATE_GATEWAYSENDER__ID\n-        + \"=ln_Serial --\"\n-        + CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID + \"=2 --\"\n-        + CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS + \"=1\";\n+    String command = new CommandStringBuilder(CliStrings.CREATE_GATEWAYSENDER)\n+        .addOption(CliStrings.CREATE_GATEWAYSENDER__ID, \"ln_Serial\")\n+        .addOption(CliStrings.CREATE_GATEWAYSENDER__REMOTEDISTRIBUTEDSYSTEMID, \"2\")\n+        .addOption(CliStrings.CREATE_GATEWAYSENDER__DISPATCHERTHREADS, \"1\")\n+        .getCommandString();\n \n     int lnPort = locatorSite1.getPort();\n \n"}}, {"oid": "35e3a1c16e2776af6b5f1b763f12f2b859b5e4fc", "url": "https://github.com/apache/geode/commit/35e3a1c16e2776af6b5f1b763f12f2b859b5e4fc", "message": "small test change", "committedDate": "2020-12-02T21:32:12Z", "type": "commit"}, {"oid": "1b60ce58eca84c310ff32022458543af5c8e3187", "url": "https://github.com/apache/geode/commit/1b60ce58eca84c310ff32022458543af5c8e3187", "message": "empty commit to re-launch CI", "committedDate": "2020-12-03T12:12:08Z", "type": "commit"}, {"oid": "f5fb20d1bfa6d7b2ebcb09ced17635da183d360f", "url": "https://github.com/apache/geode/commit/f5fb20d1bfa6d7b2ebcb09ced17635da183d360f", "message": "empty commit to re-launch CI", "committedDate": "2020-12-07T07:07:40Z", "type": "commit"}]}