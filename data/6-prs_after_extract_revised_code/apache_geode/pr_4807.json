{"pr_number": 4807, "pr_title": "GEODE-7710: Fix race condition in federation of MXBeans", "pr_createdAt": "2020-03-13T20:31:49Z", "pr_url": "https://github.com/apache/geode/pull/4807", "timeline": [{"oid": "c052eb3cb1a027e3ee7b18398ced8b9bc06f2358", "url": "https://github.com/apache/geode/commit/c052eb3cb1a027e3ee7b18398ced8b9bc06f2358", "message": "GEODE-7710: Fix race condition in federation of MXBeans\n\nJMX Manager may fail to federate one or more MXBeans during startup\nbecause of a race condition involving FederatingManager and\nManagementCacheListener.\n\nChange ManagementCacheListener to be ready upon construction.", "committedDate": "2020-03-13T20:35:55Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUwODIwOA==", "url": "https://github.com/apache/geode/pull/4807#discussion_r392508208", "bodyText": "Remove the custom debugging and then file an additional PR that changes SerializableTemporaryFolder to have that behavior by default.", "author": "kirklund", "createdAt": "2020-03-13T22:09:11Z", "path": "geode-core/src/distributedTest/java/org/apache/geode/management/JMXMBeanReconnectDUnitTest.java", "diffHunk": "@@ -116,7 +114,8 @@\n   @Rule\n   public DistributedRule distributedRule = new DistributedRule();\n   @Rule\n-  public SerializableTemporaryFolder temporaryFolder = new SerializableTemporaryFolder();\n+  public SerializableTemporaryFolder temporaryFolder = new SerializableTemporaryFolder()\n+      .copyTo(new File(getClass().getSimpleName())).when(FAILS);", "originalCommit": "c052eb3cb1a027e3ee7b18398ced8b9bc06f2358", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUxNzQxMA==", "url": "https://github.com/apache/geode/pull/4807#discussion_r392517410", "bodyText": "Done", "author": "kirklund", "createdAt": "2020-03-13T22:44:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjUwODIwOA=="}], "type": "inlineReview", "revised_code": {"commit": "62ec8f4cec8aa57146b2a3cf63e9872767ea2f40", "chunk": "diff --git a/geode-core/src/distributedTest/java/org/apache/geode/management/JMXMBeanReconnectDUnitTest.java b/geode-core/src/distributedTest/java/org/apache/geode/management/JMXMBeanReconnectDUnitTest.java\nindex 48aa090d8d..07866995b0 100644\n--- a/geode-core/src/distributedTest/java/org/apache/geode/management/JMXMBeanReconnectDUnitTest.java\n+++ b/geode-core/src/distributedTest/java/org/apache/geode/management/JMXMBeanReconnectDUnitTest.java\n\n@@ -114,8 +113,7 @@ public class JMXMBeanReconnectDUnitTest implements Serializable {\n   @Rule\n   public DistributedRule distributedRule = new DistributedRule();\n   @Rule\n-  public SerializableTemporaryFolder temporaryFolder = new SerializableTemporaryFolder()\n-      .copyTo(new File(getClass().getSimpleName())).when(FAILS);\n+  public SerializableTemporaryFolder temporaryFolder = new SerializableTemporaryFolder();\n   @Rule\n   public SharedErrorCollector errorCollector = new SharedErrorCollector();\n   @Rule\n"}}, {"oid": "62ec8f4cec8aa57146b2a3cf63e9872767ea2f40", "url": "https://github.com/apache/geode/commit/62ec8f4cec8aa57146b2a3cf63e9872767ea2f40", "message": "GEODE-7710: Fix race condition in federation of MXBeans\n\nJMX Manager may fail to federate one or more MXBeans during startup\nbecause of a race condition involving FederatingManager and\nManagementCacheListener.\n\nChange ManagementCacheListener to be ready upon construction.", "committedDate": "2020-03-13T22:56:22Z", "type": "forcePushed"}, {"oid": "5b05aa4eb42c28624413d6ed53abd249dc8cfc78", "url": "https://github.com/apache/geode/commit/5b05aa4eb42c28624413d6ed53abd249dc8cfc78", "message": "GEODE-7710: Fix race condition in federation of MXBeans\n\nJMX Manager may fail to federate one or more MXBeans during startup\nbecause of a race condition involving FederatingManager and\nManagementCacheListener.\n\nChange ManagementCacheListener to be ready upon construction.", "committedDate": "2020-03-16T16:37:55Z", "type": "commit"}, {"oid": "5b05aa4eb42c28624413d6ed53abd249dc8cfc78", "url": "https://github.com/apache/geode/commit/5b05aa4eb42c28624413d6ed53abd249dc8cfc78", "message": "GEODE-7710: Fix race condition in federation of MXBeans\n\nJMX Manager may fail to federate one or more MXBeans during startup\nbecause of a race condition involving FederatingManager and\nManagementCacheListener.\n\nChange ManagementCacheListener to be ready upon construction.", "committedDate": "2020-03-16T16:37:55Z", "type": "forcePushed"}, {"oid": "dcd49234147e43c7838bf48852693225c2ef2304", "url": "https://github.com/apache/geode/commit/dcd49234147e43c7838bf48852693225c2ef2304", "message": "Delete redundant regression test", "committedDate": "2020-03-16T20:35:34Z", "type": "commit"}, {"oid": "46b4c687445d6ffc6e92230db8640f797918306c", "url": "https://github.com/apache/geode/commit/46b4c687445d6ffc6e92230db8640f797918306c", "message": "Add javadoc describing ManagementCacheListenerTest", "committedDate": "2020-03-16T20:49:12Z", "type": "commit"}, {"oid": "46b4c687445d6ffc6e92230db8640f797918306c", "url": "https://github.com/apache/geode/commit/46b4c687445d6ffc6e92230db8640f797918306c", "message": "Add javadoc describing ManagementCacheListenerTest", "committedDate": "2020-03-16T20:49:12Z", "type": "forcePushed"}]}