{"pr_number": 4588, "pr_title": "GEODE-7691: Instance of parameter checked in equals method.", "pr_createdAt": "2020-01-13T18:09:28Z", "pr_url": "https://github.com/apache/geode/pull/4588", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMTMwNg==", "url": "https://github.com/apache/geode/pull/4588#discussion_r366011306", "bodyText": "I think this if check is no longer needed with the addition of the instanceof check", "author": "jhuynh1", "createdAt": "2020-01-13T20:27:34Z", "path": "geode-core/src/main/java/org/apache/geode/cache/query/internal/CqEntry.java", "diffHunk": "@@ -82,6 +82,9 @@ public int hashCode() {\n \n   @Override\n   public boolean equals(Object other) {\n+    if (!(other instanceof CqEntry)) {\n+      return false;\n+    }\n     if (other == null) {", "originalCommit": "8673591822429d2271061935a487ac85e8a3eb4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyODUzNQ==", "url": "https://github.com/apache/geode/pull/4588#discussion_r366128535", "bodyText": "my bad, I missed that!!", "author": "nabarunnag", "createdAt": "2020-01-14T02:37:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMTMwNg=="}], "type": "inlineReview", "revised_code": {"commit": "398adc0e308ba17db38f6c39a6797a5523003cb2", "chunk": "diff --git a/geode-core/src/main/java/org/apache/geode/cache/query/internal/CqEntry.java b/geode-core/src/main/java/org/apache/geode/cache/query/internal/CqEntry.java\nindex f3cfa5de0e..f7288381b3 100644\n--- a/geode-core/src/main/java/org/apache/geode/cache/query/internal/CqEntry.java\n+++ b/geode-core/src/main/java/org/apache/geode/cache/query/internal/CqEntry.java\n\n@@ -85,9 +85,6 @@ public class CqEntry implements DataSerializableFixedID {\n     if (!(other instanceof CqEntry)) {\n       return false;\n     }\n-    if (other == null) {\n-      return false;\n-    }\n     return this.key.equals(((CqEntry) other).getKey());\n   }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMjA0OA==", "url": "https://github.com/apache/geode/pull/4588#discussion_r366012048", "bodyText": "Not sure if we want this check here... the super implementation just checks values.  So a DummyQRegion could in theory be checked against a base QRegion and still return true.. in this case it would return false.", "author": "jhuynh1", "createdAt": "2020-01-13T20:29:23Z", "path": "geode-core/src/main/java/org/apache/geode/cache/query/internal/index/DummyQRegion.java", "diffHunk": "@@ -68,6 +68,9 @@ public DummyQRegion(Region region) {\n \n   @Override\n   public boolean equals(Object o) { // for findbugs\n+    if (!(o instanceof DummyQRegion)) {", "originalCommit": "8673591822429d2271061935a487ac85e8a3eb4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEzMTc5Ng==", "url": "https://github.com/apache/geode/pull/4588#discussion_r366131796", "bodyText": "My bad again. Modified the superclass to do an instance check.", "author": "nabarunnag", "createdAt": "2020-01-14T02:54:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMjA0OA=="}], "type": "inlineReview", "revised_code": {"commit": "398adc0e308ba17db38f6c39a6797a5523003cb2", "chunk": "diff --git a/geode-core/src/main/java/org/apache/geode/cache/query/internal/index/DummyQRegion.java b/geode-core/src/main/java/org/apache/geode/cache/query/internal/index/DummyQRegion.java\nindex 575f6abc22..4cd36edd21 100644\n--- a/geode-core/src/main/java/org/apache/geode/cache/query/internal/index/DummyQRegion.java\n+++ b/geode-core/src/main/java/org/apache/geode/cache/query/internal/index/DummyQRegion.java\n\n@@ -68,9 +68,6 @@ public class DummyQRegion extends QRegion {\n \n   @Override\n   public boolean equals(Object o) { // for findbugs\n-    if (!(o instanceof DummyQRegion)) {\n-      return false;\n-    }\n     return super.equals(o);\n   }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMjMxOQ==", "url": "https://github.com/apache/geode/pull/4588#discussion_r366012319", "bodyText": "same, this can probably be removed since the instanceof check will return early if other is null", "author": "jhuynh1", "createdAt": "2020-01-13T20:30:04Z", "path": "geode-core/src/main/java/org/apache/geode/internal/cache/PartitionedRegion.java", "diffHunk": "@@ -9665,7 +9665,9 @@ public String toString() {\n \n     @Override\n     public boolean equals(Object other) {\n-      // TODO: equals should always check the class of other\n+      if (!(other instanceof IndexTask)) {\n+        return false;\n+      }\n       if (other == null) {", "originalCommit": "8673591822429d2271061935a487ac85e8a3eb4f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjEyODU0MQ==", "url": "https://github.com/apache/geode/pull/4588#discussion_r366128541", "bodyText": "my bad, I missed that!!", "author": "nabarunnag", "createdAt": "2020-01-14T02:37:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjAxMjMxOQ=="}], "type": "inlineReview", "revised_code": {"commit": "398adc0e308ba17db38f6c39a6797a5523003cb2", "chunk": "diff --git a/geode-core/src/main/java/org/apache/geode/internal/cache/PartitionedRegion.java b/geode-core/src/main/java/org/apache/geode/internal/cache/PartitionedRegion.java\nindex 479ac273cb..a592eaf48e 100755\n--- a/geode-core/src/main/java/org/apache/geode/internal/cache/PartitionedRegion.java\n+++ b/geode-core/src/main/java/org/apache/geode/internal/cache/PartitionedRegion.java\n\n@@ -9668,9 +9668,6 @@ public class PartitionedRegion extends LocalRegion\n       if (!(other instanceof IndexTask)) {\n         return false;\n       }\n-      if (other == null) {\n-        return false;\n-      }\n       IndexTask otherIndexTask = (IndexTask) other;\n       if (this.indexName.equals(otherIndexTask.indexName)) {\n         return true;\n"}}, {"oid": "398adc0e308ba17db38f6c39a6797a5523003cb2", "url": "https://github.com/apache/geode/commit/398adc0e308ba17db38f6c39a6797a5523003cb2", "message": "GEODE-7691: Instance of parameter checked in equals method.", "committedDate": "2020-01-14T02:56:31Z", "type": "forcePushed"}, {"oid": "7eaaa59df81eabafcec00e762f3999f82d22a9d3", "url": "https://github.com/apache/geode/commit/7eaaa59df81eabafcec00e762f3999f82d22a9d3", "message": "GEODE-7691: Instance of parameter checked in equals method.", "committedDate": "2020-01-14T17:04:52Z", "type": "commit"}, {"oid": "7eaaa59df81eabafcec00e762f3999f82d22a9d3", "url": "https://github.com/apache/geode/commit/7eaaa59df81eabafcec00e762f3999f82d22a9d3", "message": "GEODE-7691: Instance of parameter checked in equals method.", "committedDate": "2020-01-14T17:04:52Z", "type": "forcePushed"}]}