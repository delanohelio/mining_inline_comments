{"pr_number": 4891, "pr_title": "GEODE-7919-fix-flaky: shut down threads after tests", "pr_createdAt": "2020-04-01T18:01:24Z", "pr_url": "https://github.com/apache/geode/pull/4891", "timeline": [{"oid": "0e2207e691bc9202d38f4cc74349f90bb787f6fb", "url": "https://github.com/apache/geode/commit/0e2207e691bc9202d38f4cc74349f90bb787f6fb", "message": "GEODE-7919-fix-flaky: shut down threads after tests", "committedDate": "2020-04-01T17:54:44Z", "type": "commit"}, {"oid": "f60949c2b252979a30b3217243018f138ccc8d54", "url": "https://github.com/apache/geode/commit/f60949c2b252979a30b3217243018f138ccc8d54", "message": "GEODE-7919-fix-flaky: add Awaitility to soak up latency", "committedDate": "2020-04-01T23:18:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQwMDY4NQ==", "url": "https://github.com/apache/geode/pull/4891#discussion_r402400685", "bodyText": "were these stop() calls omissions before?", "author": "echobravopapa", "createdAt": "2020-04-02T15:23:41Z", "path": "geode-membership/src/integrationTest/java/org/apache/geode/distributed/internal/membership/gms/MembershipIntegrationTest.java", "diffHunk": "@@ -102,21 +115,28 @@ public void twoLocatorsCanStartSequentially()\n \n     final MembershipLocator<MemberIdentifier> locator1 = createLocator(0);\n     locator1.start();\n+\n     final int locatorPort1 = locator1.getPort();\n \n     Membership<MemberIdentifier> membership1 = createMembership(locator1, locatorPort1);\n     start(membership1);\n \n     final MembershipLocator<MemberIdentifier> locator2 = createLocator(0, locatorPort1);\n     locator2.start();\n+\n     final int locatorPort2 = locator2.getPort();\n \n     Membership<MemberIdentifier> membership2 =\n         createMembership(locator2, locatorPort1, locatorPort2);\n     start(membership2);\n \n-    assertThat(membership1.getView().getMembers()).hasSize(2);\n-    assertThat(membership2.getView().getMembers()).hasSize(2);\n+    await().untilAsserted(\n+        () -> assertThat(membership1.getView().getMembers()).hasSize(2));\n+    await().untilAsserted(\n+        () -> assertThat(membership2.getView().getMembers()).hasSize(2));\n+\n+    stop(membership2, membership1);", "originalCommit": "f60949c2b252979a30b3217243018f138ccc8d54", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQyODU0Ng==", "url": "https://github.com/apache/geode/pull/4891#discussion_r402428546", "bodyText": "yes", "author": "Bill", "createdAt": "2020-04-02T16:01:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjQwMDY4NQ=="}], "type": "inlineReview", "revised_code": null}]}