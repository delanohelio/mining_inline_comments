{"pr_number": 2210, "pr_title": "GH-2209 Reproduce Changeset concurrent modification exception", "pr_createdAt": "2020-05-10T19:35:38Z", "pr_url": "https://github.com/eclipse/rdf4j/pull/2210", "timeline": [{"oid": "c23eac5c830c54616fdfa23314596b25f4843ae5", "url": "https://github.com/eclipse/rdf4j/commit/c23eac5c830c54616fdfa23314596b25f4843ae5", "message": "GH-2209 reproduce error\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-10T19:32:06Z", "type": "commit"}, {"oid": "41503e9f48a53b9660e64d4ef04d11a54a54bb9a", "url": "https://github.com/eclipse/rdf4j/commit/41503e9f48a53b9660e64d4ef04d11a54a54bb9a", "message": "fails faster and also a quick fix for GH-2211\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-10T21:20:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ2NTY4Ng==", "url": "https://github.com/eclipse/rdf4j/pull/2210#discussion_r423465686", "bodyText": "I assume this is here merely for testing/demonstration purposes, and not intended to be a fix for anything?", "author": "jeenbroekstra", "createdAt": "2020-05-12T05:11:34Z", "path": "core/model/src/main/java/org/eclipse/rdf4j/model/impl/LinkedHashModel.java", "diffHunk": "@@ -200,7 +200,9 @@ public Iterator iterator() {\n \n \t@Override\n \tpublic boolean contains(Resource subj, IRI pred, Value obj, Resource... contexts) {\n-\t\treturn matchPattern(subj, pred, obj, contexts).hasNext();\n+\t\tModelIterator modelIterator = matchPattern(subj, pred, obj, contexts);\n+\t\tThread.yield();\n+\t\treturn modelIterator.hasNext();", "originalCommit": "41503e9f48a53b9660e64d4ef04d11a54a54bb9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ5NTE3Nw==", "url": "https://github.com/eclipse/rdf4j/pull/2210#discussion_r423495177", "bodyText": "Just increases the likelihood of the error occurring.", "author": "hmottestad", "createdAt": "2020-05-12T06:39:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzQ2NTY4Ng=="}], "type": "inlineReview", "revised_code": {"commit": "fb94904e10957bc39ccf5067a5b2b52fd8d4ec97", "chunk": "diff --git a/core/model/src/main/java/org/eclipse/rdf4j/model/impl/LinkedHashModel.java b/core/model/src/main/java/org/eclipse/rdf4j/model/impl/LinkedHashModel.java\nindex 4ebdcb8abb..352b6424d3 100644\n--- a/core/model/src/main/java/org/eclipse/rdf4j/model/impl/LinkedHashModel.java\n+++ b/core/model/src/main/java/org/eclipse/rdf4j/model/impl/LinkedHashModel.java\n\n@@ -200,9 +200,7 @@ public class LinkedHashModel extends AbstractModel {\n \n \t@Override\n \tpublic boolean contains(Resource subj, IRI pred, Value obj, Resource... contexts) {\n-\t\tModelIterator modelIterator = matchPattern(subj, pred, obj, contexts);\n-\t\tThread.yield();\n-\t\treturn modelIterator.hasNext();\n+\t\treturn matchPattern(subj, pred, obj, contexts).hasNext();\n \t}\n \n \t@Override\n"}}, {"oid": "d5411faafca0e566e640f48bde382ad49774e2d6", "url": "https://github.com/eclipse/rdf4j/commit/d5411faafca0e566e640f48bde382ad49774e2d6", "message": "internalized the models and synchronized all calls\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-12T09:30:01Z", "type": "commit"}, {"oid": "902a373042b95a829f819f4a451c8bd5c7a4c876", "url": "https://github.com/eclipse/rdf4j/commit/902a373042b95a829f819f4a451c8bd5c7a4c876", "message": "some cleanup\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-12T20:39:20Z", "type": "commit"}, {"oid": "307ea8f495390c06b2d29849d1133cef64540191", "url": "https://github.com/eclipse/rdf4j/commit/307ea8f495390c06b2d29849d1133cef64540191", "message": "more cleanup\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-12T20:44:13Z", "type": "commit"}, {"oid": "0c84d079c138752fe2d1ea66803b809dbc5e28da", "url": "https://github.com/eclipse/rdf4j/commit/0c84d079c138752fe2d1ea66803b809dbc5e28da", "message": "temporarily disable code compatability checks so we can run the tests\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-12T20:52:40Z", "type": "commit"}, {"oid": "5ec8bd2e2473af4cf8ef33b43f2f167d842c3127", "url": "https://github.com/eclipse/rdf4j/commit/5ec8bd2e2473af4cf8ef33b43f2f167d842c3127", "message": "Update pom.xml", "committedDate": "2020-05-13T05:20:39Z", "type": "commit"}, {"oid": "fb94904e10957bc39ccf5067a5b2b52fd8d4ec97", "url": "https://github.com/eclipse/rdf4j/commit/fb94904e10957bc39ccf5067a5b2b52fd8d4ec97", "message": "reverting some code used while testing\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-14T12:17:59Z", "type": "commit"}, {"oid": "fb94904e10957bc39ccf5067a5b2b52fd8d4ec97", "url": "https://github.com/eclipse/rdf4j/commit/fb94904e10957bc39ccf5067a5b2b52fd8d4ec97", "message": "reverting some code used while testing\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-14T12:17:59Z", "type": "forcePushed"}, {"oid": "73cc40fc255727c28681d351aba90055d40882ab", "url": "https://github.com/eclipse/rdf4j/commit/73cc40fc255727c28681d351aba90055d40882ab", "message": "added test and reduced public methods", "committedDate": "2020-05-14T13:31:38Z", "type": "commit"}, {"oid": "8010cd48c4f46afffc670dd45ba12f43e867da68", "url": "https://github.com/eclipse/rdf4j/commit/8010cd48c4f46afffc670dd45ba12f43e867da68", "message": "revert publiv methods and more thread safety", "committedDate": "2020-05-14T13:39:00Z", "type": "commit"}, {"oid": "e7a3d2d2e16bd6f18a64a7851b3dfe77b5ad4b34", "url": "https://github.com/eclipse/rdf4j/commit/e7a3d2d2e16bd6f18a64a7851b3dfe77b5ad4b34", "message": "fix nullpointer exception that causes build to time out", "committedDate": "2020-05-15T09:17:26Z", "type": "commit"}, {"oid": "de31c9c693d432d6e055d7a931b7d3f4869c5749", "url": "https://github.com/eclipse/rdf4j/commit/de31c9c693d432d6e055d7a931b7d3f4869c5749", "message": "Merge branch 'master' into GH-2209-changeset-concurrent-modification\n\nSigned-off-by: Ha\u030avard Ottestad <hmottestad@gmail.com>", "committedDate": "2020-05-15T10:19:16Z", "type": "commit"}]}