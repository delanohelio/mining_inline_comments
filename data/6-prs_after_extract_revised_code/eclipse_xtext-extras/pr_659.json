{"pr_number": 659, "pr_title": "[eclipse/xtext#1837] converted more code to java", "pr_createdAt": "2020-11-01T10:58:44Z", "pr_url": "https://github.com/eclipse/xtext-extras/pull/659", "timeline": [{"oid": "a536683e1c28ff05e837f037a3a65453505eb969", "url": "https://github.com/eclipse/xtext-extras/commit/a536683e1c28ff05e837f037a3a65453505eb969", "message": "[eclipse/xtext#1837] converted more code to java\n\nSigned-off-by: Christian Dietrich <christian.dietrich@itemis.de>", "committedDate": "2020-11-01T16:04:26Z", "type": "forcePushed"}, {"oid": "28214db9bf9ce946ec0eb0e64c2439f79f61bb6a", "url": "https://github.com/eclipse/xtext-extras/commit/28214db9bf9ce946ec0eb0e64c2439f79f61bb6a", "message": "[eclipse/xtext#1837] converted more code to java\n\nSigned-off-by: Christian Dietrich <christian.dietrich@itemis.de>", "committedDate": "2020-11-01T16:45:10Z", "type": "forcePushed"}, {"oid": "f7fdf0de75c5bb40242454660b585a526ca6a14e", "url": "https://github.com/eclipse/xtext-extras/commit/f7fdf0de75c5bb40242454660b585a526ca6a14e", "message": "[eclipse/xtext#1837] converted more code to java\n\nSigned-off-by: Christian Dietrich <christian.dietrich@itemis.de>", "committedDate": "2020-11-01T16:48:57Z", "type": "forcePushed"}, {"oid": "b0a1cdbb47626140ba5360937f34ef6a8233ce5d", "url": "https://github.com/eclipse/xtext-extras/commit/b0a1cdbb47626140ba5360937f34ef6a8233ce5d", "message": "[eclipse/xtext#1837] converted more code to java\n\nSigned-off-by: Christian Dietrich <christian.dietrich@itemis.de>", "committedDate": "2020-11-01T17:16:50Z", "type": "forcePushed"}, {"oid": "06b790fc996ae78a3d1d9c7d1763df231497260a", "url": "https://github.com/eclipse/xtext-extras/commit/06b790fc996ae78a3d1d9c7d1763df231497260a", "message": "[eclipse/xtext#1837] converted more code to java\n\nSigned-off-by: Christian Dietrich <christian.dietrich@itemis.de>", "committedDate": "2020-11-01T17:18:50Z", "type": "commit"}, {"oid": "06b790fc996ae78a3d1d9c7d1763df231497260a", "url": "https://github.com/eclipse/xtext-extras/commit/06b790fc996ae78a3d1d9c7d1763df231497260a", "message": "[eclipse/xtext#1837] converted more code to java\n\nSigned-off-by: Christian Dietrich <christian.dietrich@itemis.de>", "committedDate": "2020-11-01T17:18:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTkyNjc2OA==", "url": "https://github.com/eclipse/xtext-extras/pull/659#discussion_r515926768", "bodyText": "The space after resolved wasn't there on purpose since getTypeName may return the empty string.", "author": "szarnekow", "createdAt": "2020-11-02T12:04:23Z", "path": "org.eclipse.xtext.xbase/src/org/eclipse/xtext/xbase/annotations/validation/UnresolvedFeatureCallTypeAwareMessageProvider.java", "diffHunk": "@@ -0,0 +1,156 @@\n+/**\n+ * Copyright (c) 2015, 2020 itemis AG (http://www.itemis.eu) and others.\n+ * This program and the accompanying materials are made available under the\n+ * terms of the Eclipse Public License 2.0 which is available at\n+ * http://www.eclipse.org/legal/epl-2.0.\n+ * \n+ * SPDX-License-Identifier: EPL-2.0\n+ */\n+package org.eclipse.xtext.xbase.annotations.validation;\n+\n+import org.eclipse.emf.ecore.EClass;\n+import org.eclipse.emf.ecore.EObject;\n+import org.eclipse.emf.ecore.EStructuralFeature;\n+import org.eclipse.xtext.EcoreUtil2;\n+import org.eclipse.xtext.common.types.TypesPackage;\n+import org.eclipse.xtext.diagnostics.Diagnostic;\n+import org.eclipse.xtext.diagnostics.DiagnosticMessage;\n+import org.eclipse.xtext.diagnostics.Severity;\n+import org.eclipse.xtext.linking.ILinkingDiagnosticMessageProvider;\n+import org.eclipse.xtext.linking.impl.IllegalNodeException;\n+import org.eclipse.xtext.linking.impl.LinkingDiagnosticMessageProvider;\n+import org.eclipse.xtext.xbase.XAbstractFeatureCall;\n+import org.eclipse.xtext.xbase.XFeatureCall;\n+import org.eclipse.xtext.xbase.XMemberFeatureCall;\n+import org.eclipse.xtext.xbase.XbasePackage;\n+import org.eclipse.xtext.xbase.annotations.xAnnotations.XAnnotationsPackage;\n+import org.eclipse.xtext.xbase.lib.Extension;\n+import org.eclipse.xtext.xbase.lib.IterableExtensions;\n+import org.eclipse.xtext.xbase.typesystem.IResolvedTypes;\n+import org.eclipse.xtext.xbase.typesystem.internal.FeatureLinkHelper;\n+import org.eclipse.xtext.xbase.typesystem.internal.TypeAwareLinkingDiagnosticContext;\n+import org.eclipse.xtext.xbase.typesystem.references.LightweightTypeReference;\n+import org.eclipse.xtext.xbase.util.FeatureCallAsTypeLiteralHelper;\n+\n+import com.google.common.collect.Lists;\n+import com.google.inject.Inject;\n+\n+/**\n+ * @author Dennis Huebner - Initial contribution and API\n+ */\n+public class UnresolvedFeatureCallTypeAwareMessageProvider extends LinkingDiagnosticMessageProvider {\n+\t/**\n+\t * A user data entry that indicates a broken feature link which could also\n+\t * be a type literal, e.g. 'String::CASE_INSENSITIVE'.\n+\t */\n+\tpublic static final String TYPE_LITERAL = \"key:TypeLiteral\";\n+\n+\tpublic static final String FEATURE_CALL = \"key:FeatureCall\";\n+\n+\t@Inject\n+\tprivate FeatureCallAsTypeLiteralHelper typeLiteralHelper;\n+\n+\t@Inject\n+\t@Extension\n+\tprivate FeatureLinkHelper featureLinkHelper;\n+\n+\t@Override\n+\tpublic DiagnosticMessage getUnresolvedProxyMessage(\n+\t\t\tILinkingDiagnosticMessageProvider.ILinkingDiagnosticContext context) {\n+\t\tString linkText = null;\n+\t\ttry {\n+\t\t\tlinkText = context.getLinkText();\n+\t\t} catch (IllegalNodeException e) {\n+\t\t\tlinkText = e.getNode().getText();\n+\t\t}\n+\t\tif (linkText == null) {\n+\t\t\treturn null;\n+\t\t}\n+\t\tEObject contextObject = context.getContext();\n+\t\tif (isStaticMemberCallTarget(contextObject)) {\n+\t\t\treturn new DiagnosticMessage(linkText + \" cannot be resolved to a type.\", Severity.ERROR,\n+\t\t\t\t\tDiagnostic.LINKING_DIAGNOSTIC, UnresolvedFeatureCallTypeAwareMessageProvider.TYPE_LITERAL);\n+\t\t}\n+\t\tif (contextObject instanceof XAbstractFeatureCall) {\n+\t\t\tif (!((XAbstractFeatureCall) contextObject).isOperation()) {\n+\t\t\t\treturn handleUnresolvedFeatureCall(context, ((XAbstractFeatureCall) contextObject), linkText);\n+\t\t\t}\n+\t\t}\n+\t\tEClass referenceType = context.getReference().getEReferenceType();\n+\t\tString msg = linkText + \" cannot be resolved \"+ getTypeName(referenceType, context.getReference()) + \".\";", "originalCommit": "06b790fc996ae78a3d1d9c7d1763df231497260a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}