{"pr_number": 3246, "pr_title": "Migrates to Datastax Driver v4", "pr_createdAt": "2020-10-18T08:30:37Z", "pr_url": "https://github.com/openzipkin/zipkin/pull/3246", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzA0MzE5MQ==", "url": "https://github.com/openzipkin/zipkin/pull/3246#discussion_r507043191", "bodyText": "@jeqo this is the style you can use for kafka (not the commenting out :P)", "author": "codefromthecrypt", "createdAt": "2020-10-18T08:33:17Z", "path": "zipkin-server/src/main/java/zipkin2/server/internal/cassandra3/ZipkinCassandra3StorageConfiguration.java", "diffHunk": "@@ -84,11 +82,11 @@ StorageComponent storage(\n     }\n \n     @Override public Object postProcessAfterInitialization(Object bean, String beanName) {\n-      if (bean instanceof SessionFactory && beanFactory.containsBean(\"tracing\")) {\n-        SessionFactory delegate = (SessionFactory) bean;\n-        Tracing tracing = beanFactory.getBean(Tracing.class);\n-        return (SessionFactory) storage -> TracingSession.create(tracing, delegate.create(storage));\n-      }\n+      //if (bean instanceof SessionFactory && beanFactory.containsBean(\"tracing\")) {", "originalCommit": "d615cd0a09c1f114af5a93e3906e77beb46a97b9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzA0MzM4NQ==", "url": "https://github.com/openzipkin/zipkin/pull/3246#discussion_r507043385", "bodyText": "instant -> timestamp column", "author": "codefromthecrypt", "createdAt": "2020-10-18T08:34:02Z", "path": "zipkin-storage/cassandra-v1/src/main/java/zipkin2/storage/cassandra/v1/CassandraUtil.java", "diffHunk": "@@ -144,10 +146,10 @@ static ByteBuffer toByteBuffer(String string) {\n   }\n \n   @SuppressWarnings(\"JdkObsolete\")\n-  static List<Date> getDays(long endTs, @Nullable Long lookback) {\n-    List<Date> result = new ArrayList<>();\n+  static List<Instant> getDays(long endTs, @Nullable Long lookback) {\n+    List<Instant> result = new ArrayList<>();", "originalCommit": "d615cd0a09c1f114af5a93e3906e77beb46a97b9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "ce60e5bad360c5efda6077eed91b77b2154cc9cc", "url": "https://github.com/openzipkin/zipkin/commit/ce60e5bad360c5efda6077eed91b77b2154cc9cc", "message": "Migrates to Datastax Driver v4\n\nThis migrates to the Netty-based Datastax Driver v4, which no longer\nuses guava. This is very different library architecture, most obvious in\nhow configuration is managed. This migration tries to be as conventional\nas possible while retaining defaults as close to as they were as\npossible.", "committedDate": "2020-10-21T02:54:54Z", "type": "commit"}, {"oid": "ce60e5bad360c5efda6077eed91b77b2154cc9cc", "url": "https://github.com/openzipkin/zipkin/commit/ce60e5bad360c5efda6077eed91b77b2154cc9cc", "message": "Migrates to Datastax Driver v4\n\nThis migrates to the Netty-based Datastax Driver v4, which no longer\nuses guava. This is very different library architecture, most obvious in\nhow configuration is managed. This migration tries to be as conventional\nas possible while retaining defaults as close to as they were as\npossible.", "committedDate": "2020-10-21T02:54:54Z", "type": "forcePushed"}]}