{"pr_number": 3208, "pr_title": "Migrates Elasticsearch demo images to OSS license", "pr_createdAt": "2020-09-17T08:00:16Z", "pr_url": "https://github.com/openzipkin/zipkin/pull/3208", "timeline": [{"oid": "7406bc5c000d78fcfbe11c9a89e38685be0c7222", "url": "https://github.com/openzipkin/zipkin/commit/7406bc5c000d78fcfbe11c9a89e38685be0c7222", "message": "Migrates Elasticsearch test images to OSS license\n\nThis uses OSS license for Elasticsearch 6 and 7, reducing the size of\nthe images. Image size is further reduced in 7 by using a recent change\nto our JRE that allows Thai segmentation support (module jdk.localedata)\n\nThis also reduces test execution time by only executing the 7.8+ schema\ntest vs the entire suite again.", "committedDate": "2020-09-17T07:56:53Z", "type": "commit"}, {"oid": "fdcd2533fa4e6596e1ee33f382f70eb87acae055", "url": "https://github.com/openzipkin/zipkin/commit/fdcd2533fa4e6596e1ee33f382f70eb87acae055", "message": "typo", "committedDate": "2020-09-17T08:02:28Z", "type": "commit"}, {"oid": "718b3e8026d58c25fcc3db8f61e77270020fbabd", "url": "https://github.com/openzipkin/zipkin/commit/718b3e8026d58c25fcc3db8f61e77270020fbabd", "message": "no verbose", "committedDate": "2020-09-17T08:03:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490050407", "bodyText": "this has so far not helped, but maybe it will here?", "author": "codefromthecrypt", "createdAt": "2020-09-17T08:05:28Z", "path": "zipkin-storage/elasticsearch/src/test/java/zipkin2/elasticsearch/integration/ElasticsearchStorageExtension.java", "diffHunk": "@@ -36,10 +35,16 @@\n \n class ElasticsearchStorageExtension implements BeforeAllCallback, AfterAllCallback {\n   static final Logger LOGGER = LoggerFactory.getLogger(ElasticsearchStorageExtension.class);\n+\n+  static {\n+    // Gives better context when there's an exception such as AbortedStreamException\n+    System.setProperty(\"com.linecorp.armeria.verboseExceptions\", \"always\");", "originalCommit": "7406bc5c000d78fcfbe11c9a89e38685be0c7222", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1Mjg3MQ==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490052871", "bodyText": "Dunno if this static block runs early enough for Armeria to pick it up, armeria reads the property only once at initialization", "author": "anuraaga", "createdAt": "2020-09-17T08:09:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDExNzQyOQ==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490117429", "bodyText": "yeah I was hoping to not rely on build config, so will move it up farther if this one doesn't work :P", "author": "codefromthecrypt", "createdAt": "2020-09-17T09:51:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDExNzg3Mg==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490117872", "bodyText": "@minwoox @ikhoon @trustin ps any way we can do this without system properties?", "author": "codefromthecrypt", "createdAt": "2020-09-17T09:52:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDEzMjgzMQ==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490132831", "bodyText": "I think using system properties is the only way to change the value. \ud83e\udd14", "author": "minwoox", "createdAt": "2020-09-17T10:18:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE0NjUzOQ==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490146539", "bodyText": "I think the easy verification is to add a debug statement and see if Armeria already logged it's flags-related stuff, if so too late. If not, it should work :)\nAgree with the sentiment of not mucking with build, but for five lines maybe it's still worth not worrying about ordering issues\nhttp://maven.apache.org/surefire/maven-surefire-plugin/examples/system-properties.html\n<plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-surefire-plugin</artifactId>\n        <version>3.0.0-M5</version>\n        <configuration>\n          <systemPropertyVariables>\n            <propertyName>propertyValue</propertyName>", "author": "anuraaga", "createdAt": "2020-09-17T10:43:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDE3MTU5NA==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490171594", "bodyText": "it is also that I often run in IDE and it wouldn't catch those lines, but then again it never fails in the IDE..", "author": "codefromthecrypt", "createdAt": "2020-09-17T11:32:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDYxNjYyMw==", "url": "https://github.com/openzipkin/zipkin/pull/3208#discussion_r490616623", "bodyText": "5eec6f3", "author": "codefromthecrypt", "createdAt": "2020-09-17T23:29:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDA1MDQwNw=="}], "type": "inlineReview", "revised_code": null}]}