{"pr_number": 1241, "pr_title": "Fix log framework docs and log4j2 error instrumentation", "pr_createdAt": "2020-06-17T10:13:39Z", "pr_url": "https://github.com/elastic/apm-agent-java/pull/1241", "timeline": [{"oid": "f6adf433eccc2112beda14060e82bae82ac5b278", "url": "https://github.com/elastic/apm-agent-java/commit/f6adf433eccc2112beda14060e82bae82ac5b278", "message": "Fix log framework docs and log4j2 error instrumentation", "committedDate": "2020-06-17T10:12:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0MzkwNg==", "url": "https://github.com/elastic/apm-agent-java/pull/1241#discussion_r441443906", "bodyText": "\ud83e\udd26  How come the test passed? We shade the tests as well?", "author": "eyalkoren", "createdAt": "2020-06-17T10:24:37Z", "path": "apm-agent-plugins/apm-error-logging-plugin/src/main/java/co/elastic/apm/agent/error/logging/Log4j2LoggerErrorCapturingInstrumentation.java", "diffHunk": "@@ -29,18 +29,19 @@\n \n import java.util.Collection;\n \n+import static co.elastic.apm.agent.error.logging.Slf4jLoggerErrorCapturingInstrumentation.SLF4J_LOGGER;\n import static net.bytebuddy.matcher.ElementMatchers.hasSuperType;\n import static net.bytebuddy.matcher.ElementMatchers.named;\n import static net.bytebuddy.matcher.ElementMatchers.not;\n \n-public class Log4jLoggingInstrumentation extends AbstractLoggingInstrumentation {\n+public class Log4j2LoggerErrorCapturingInstrumentation extends AbstractLoggerErrorCapturingInstrumentation {\n \n-    // prevents the shade plugin from relocating org.slf4j.Logger to co.elastic.apm.agent.shaded.slf4j.Logger\n-    private static final String SLF4J_LOGGER = \"org!slf4j!Logger\".replace('!', '.');\n+    // prevents the shade plugin from relocating org.apache.logging.log4j.Logger to co.elastic.apm.agent.shaded.logging.log4j.Logger\n+    static final String LOG4J2_LOGGER = \"org!apache!logging!log4j!Logger\".replace('!', '.');", "originalCommit": "f6adf433eccc2112beda14060e82bae82ac5b278", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0ODc5NQ==", "url": "https://github.com/elastic/apm-agent-java/pull/1241#discussion_r441448795", "bodyText": "We don\u2019t shade the test, that\u2019s why it succeeded in tests.", "author": "felixbarny", "createdAt": "2020-06-17T10:34:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0MzkwNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ1MzIyNg==", "url": "https://github.com/elastic/apm-agent-java/pull/1241#discussion_r441453226", "bodyText": "Ohh, I guess you mean we test with non shaded agent code...", "author": "eyalkoren", "createdAt": "2020-06-17T10:42:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTQ0MzkwNg=="}], "type": "inlineReview", "revised_code": null}]}