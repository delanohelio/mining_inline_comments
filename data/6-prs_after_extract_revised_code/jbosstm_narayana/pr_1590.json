{"pr_number": 1590, "pr_title": "JBTM-3273 -> Avoid implementing InvocationHandler in jtaLogger", "pr_createdAt": "2020-04-08T07:15:01Z", "pr_url": "https://github.com/jbosstm/narayana/pull/1590", "timeline": [{"oid": "9bf6bae00c8224933cd7139cfa222b29e5a5b3e1", "url": "https://github.com/jbosstm/narayana/commit/9bf6bae00c8224933cd7139cfa222b29e5a5b3e1", "message": "JBTM-3273 -> Avoid implementing InvocationHandler in jtaLogger", "committedDate": "2020-04-08T13:50:53Z", "type": "forcePushed"}, {"oid": "7fc53a60a33a23199f803aa70ac8c00604d14d42", "url": "https://github.com/jbosstm/narayana/commit/7fc53a60a33a23199f803aa70ac8c00604d14d42", "message": "JBTM-3273 -> Avoid implementing InvocationHandler in jtaLogger", "committedDate": "2020-04-08T15:53:42Z", "type": "forcePushed"}, {"oid": "e1a7c8d74123a20030463978d367215b955ffa0e", "url": "https://github.com/jbosstm/narayana/commit/e1a7c8d74123a20030463978d367215b955ffa0e", "message": "JBTM-3273 -> Avoid implementing InvocationHandler in jtaLogger", "committedDate": "2020-04-09T07:32:39Z", "type": "commit"}, {"oid": "e1a7c8d74123a20030463978d367215b955ffa0e", "url": "https://github.com/jbosstm/narayana/commit/e1a7c8d74123a20030463978d367215b955ffa0e", "message": "JBTM-3273 -> Avoid implementing InvocationHandler in jtaLogger", "committedDate": "2020-04-09T07:32:39Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3NjE4Ng==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r408976186", "bodyText": "I'm not sure about the placing the class under the logging package. As it informs about recovery processing it makes more sense to me to put it under recovery package. What was your reasoning about placing it here?", "author": "ochaloup", "createdAt": "2020-04-15T16:30:34Z", "path": "ArjunaJTA/jta/classes/com/arjuna/ats/jta/logging/RecoveryRequired.java", "diffHunk": "@@ -0,0 +1,14 @@\n+package com.arjuna.ats.jta.logging;", "originalCommit": "e1a7c8d74123a20030463978d367215b955ffa0e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM5MTc5Mw==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r409391793", "bodyText": "Since this class is only used by jtaLogger for now, therefore I thought of placing it under com.arjuna.ats.jta.logging package would be fine for now. Maybe later if any other package requires it, then we could move it under recovery package?", "author": "mayankkunwar", "createdAt": "2020-04-16T08:54:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3NjE4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQ0NTA4Mw==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r409445083", "bodyText": "I will move it to recovery package", "author": "mayankkunwar", "createdAt": "2020-04-16T10:18:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3NjE4Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3NjM2NA==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r408976364", "bodyText": "What is your reasoning for naming the class as RecoveryRequired?", "author": "ochaloup", "createdAt": "2020-04-15T16:30:53Z", "path": "ArjunaJTA/jta/classes/com/arjuna/ats/jta/logging/RecoveryRequired.java", "diffHunk": "@@ -0,0 +1,14 @@\n+package com.arjuna.ats.jta.logging;\n+\n+public class RecoveryRequired {", "originalCommit": "e1a7c8d74123a20030463978d367215b955ffa0e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQwMjQ2Ng==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r409402466", "bodyText": "I thought it would add meaning to the action, that user has to take after he gets the result.", "author": "mayankkunwar", "createdAt": "2020-04-16T09:10:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3NjM2NA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3OTkzNA==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r408979934", "bodyText": "As this is a flag which is used to mark if a recovery problem occurs and this flag could be accessed from different threads and value could be set from the different threads then the code has to(!) consider that. The property should be of type atomic.", "author": "ochaloup", "createdAt": "2020-04-15T16:36:44Z", "path": "ArjunaJTA/jta/classes/com/arjuna/ats/jta/logging/RecoveryRequired.java", "diffHunk": "@@ -0,0 +1,14 @@\n+package com.arjuna.ats.jta.logging;\n+\n+public class RecoveryRequired {\n+\n+    private static boolean recoveryProblems;", "originalCommit": "e1a7c8d74123a20030463978d367215b955ffa0e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQwMzE5Ng==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r409403196", "bodyText": "Sorry I missed this thought. Thanks for pointing this out. I will make it thread safe.", "author": "mayankkunwar", "createdAt": "2020-04-16T09:11:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk3OTkzNA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4MTE4MQ==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r408981181", "bodyText": "I think this is a good comment but I consider it should be put into the class jtaI18Logger as it's the place where new methods for logging are added (and where the methods are named). I think when it's here it's better chance to be missed.", "author": "ochaloup", "createdAt": "2020-04-15T16:38:34Z", "path": "ArjunaJTA/jta/classes/com/arjuna/ats/jta/logging/jtaLogger.java", "diffHunk": "@@ -33,47 +33,22 @@\n \n import org.jboss.logging.Logger;\n \n-import java.lang.reflect.InvocationHandler;\n-import java.lang.reflect.InvocationTargetException;\n-import java.lang.reflect.Method;\n-import java.lang.reflect.Proxy;\n-\n-public class jtaLogger implements InvocationHandler\n+public class jtaLogger\n {\n     public static final Logger logger = Logger.getLogger(\"com.arjuna.ats.jta\");\n-    public static final jtaI18NLogger i18NLogger = (jtaI18NLogger) Proxy.newProxyInstance(\n-            jtaI18NLogger.class.getClassLoader(),\n-            new Class[] { jtaI18NLogger.class },\n-            new jtaLogger(Logger.getMessageLogger(jtaI18NLogger.class, \"com.arjuna.ats.jta\")));\n+\n+    /**\n+     * For jtaI18NLogger, if any method, prefixed with <b>\"warn_recovery\"</b> is called then,", "originalCommit": "e1a7c8d74123a20030463978d367215b955ffa0e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQwNDg4Mw==", "url": "https://github.com/jbosstm/narayana/pull/1590#discussion_r409404883", "bodyText": "Sure, I will move the comments to jtaI18Logger", "author": "mayankkunwar", "createdAt": "2020-04-16T09:14:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk4MTE4MQ=="}], "type": "inlineReview", "revised_code": null}]}