{"pr_number": 10296, "pr_title": "Respect jdk.tls.client.enableSessionTicketExtension and jdk.tls.serve\u2026", "pr_createdAt": "2020-05-14T12:27:24Z", "pr_url": "https://github.com/netty/netty/pull/10296", "timeline": [{"oid": "ba3dc1e617a9db8397fc24625dabb655401cf5de", "url": "https://github.com/netty/netty/commit/ba3dc1e617a9db8397fc24625dabb655401cf5de", "message": "Respect jdk.tls.client.enableSessionTicketExtension and jdk.tls.server.enableSessionTicketExtension when using native SSL impl\n\nMotivation:\n\nWe should respect jdk.tls.client.enableSessionTicketExtension and jdk.tls.server.enableSessionTicketExtension when using the native SSL implementation as well to make the usage of it easier and more consistent. These properties were introduced by JDK13:\n\nhttps://seanjmullan.org/blog/2019/08/05/jdk13\n\nModifications:\n\nCheck if the properties are set to true and if so enable tickets\n\nResult:\n\nEasier to enable tickets and be more consistent", "committedDate": "2020-05-14T12:25:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MzAzMQ==", "url": "https://github.com/netty/netty/pull/10296#discussion_r425263031", "bodyText": "FYI: in JDK provider these system properties control only RFC 5077 (TLS Session Resumption Without Server-Side State) for TLSv1.2, but have no effect for TLSv1.3 its PreShaked Keys.\nOpenSSL provider (BoringSSL as well) behaves differently. It uses SSL_OP_NO_TICKET to control tickets for both TLSv1.2 and TLSv1.3 [2].\nBecause we anyway set SSL_OP_NO_TICKET by default for OpenSSL provider, it's not an issue.\n[1] https://docs.oracle.com/en/java/javase/11/security/java-secure-socket-extension-jsse-reference-guide.html#GUID-64D7EAF6-D2EE-4719-8616-25E2829CF810\n[2] https://github.com/google/boringssl/blob/3e4dfbb2f81493e1f25b3ce83fee3ed999373a6c/ssl/tls13_server.cc#L106", "author": "idelpivnitskiy", "createdAt": "2020-05-14T16:17:59Z", "path": "handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslClientContext.java", "diffHunk": "@@ -56,6 +57,8 @@\n                           OpenSslKeyMaterialManager.KEY_TYPE_EC,\n                           OpenSslKeyMaterialManager.KEY_TYPE_EC_RSA,\n                           OpenSslKeyMaterialManager.KEY_TYPE_EC_EC)));\n+    private static final boolean ENABLE_SESSION_TICKET =\n+            SystemPropertyUtil.getBoolean(\"jdk.tls.client.enableSessionTicketExtension\", false);", "originalCommit": "ba3dc1e617a9db8397fc24625dabb655401cf5de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTYwMjUyMw==", "url": "https://github.com/netty/netty/pull/10296#discussion_r425602523", "bodyText": "Yeah I think this is ok for now...", "author": "normanmaurer", "createdAt": "2020-05-15T06:56:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI2MzAzMQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM3NDIxMw==", "url": "https://github.com/netty/netty/pull/10296#discussion_r425374213", "bodyText": "FYI: JDK provider also has jdk.tls.server.sessionTicketTimeout option (default to 24 hours) [1], but IIUC BoringSSL does not provide API to change default rotation interval and always uses 48 hours [2].\n[1] https://docs.oracle.com/en/java/javase/11/security/java-secure-socket-extension-jsse-reference-guide.html#GUID-A41282C3-19A3-400A-A40F-86F4DA22ABA9\n[2] https://commondatastorage.googleapis.com/chromium-boringssl-docs/ssl.h.html#SSL_DEFAULT_TICKET_KEY_ROTATION_INTERVAL", "author": "idelpivnitskiy", "createdAt": "2020-05-14T19:18:33Z", "path": "handler/src/main/java/io/netty/handler/ssl/ReferenceCountedOpenSslServerContext.java", "diffHunk": "@@ -51,6 +52,9 @@\n     private static final byte[] ID = {'n', 'e', 't', 't', 'y'};\n     private final OpenSslServerSessionContext sessionContext;\n \n+    private static final boolean ENABLE_SESSION_TICKET =\n+            SystemPropertyUtil.getBoolean(\"jdk.tls.server.enableSessionTicketExtension\", false);", "originalCommit": "ba3dc1e617a9db8397fc24625dabb655401cf5de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTYwMjY0MA==", "url": "https://github.com/netty/netty/pull/10296#discussion_r425602640", "bodyText": "yep there is no API To change this in BoringSSL.", "author": "normanmaurer", "createdAt": "2020-05-15T06:56:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM3NDIxMw=="}], "type": "inlineReview", "revised_code": null}]}