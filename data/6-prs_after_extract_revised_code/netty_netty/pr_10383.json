{"pr_number": 10383, "pr_title": "Fix #10378,ResourceLeakDetectorFactory.newResourceLeakDetector(Class, int) ignores \u00a0sampling interval", "pr_createdAt": "2020-06-30T11:30:26Z", "pr_url": "https://github.com/netty/netty/pull/10383", "timeline": [{"oid": "aac7a965f4686dfda3983ba53d9bf4c48d1ec27d", "url": "https://github.com/netty/netty/commit/aac7a965f4686dfda3983ba53d9bf4c48d1ec27d", "message": "Fix #10378,ResourceLeakDetectorFactory.newResourceLeakDetector(Class, int) ignores \u00a0sampling interval", "committedDate": "2020-06-30T11:21:55Z", "type": "commit"}, {"oid": "87531c7cb87c3038d052481f45c38b3643130a00", "url": "https://github.com/netty/netty/commit/87531c7cb87c3038d052481f45c38b3643130a00", "message": "format code", "committedDate": "2020-06-30T11:25:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYxNDg0Mg==", "url": "https://github.com/netty/netty/pull/10383#discussion_r447614842", "bodyText": "Can you please revert any change which is just reformatting ?", "author": "normanmaurer", "createdAt": "2020-06-30T11:35:48Z", "path": "common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java", "diffHunk": "@@ -56,23 +56,22 @@ public static void setResourceLeakDetectorFactory(ResourceLeakDetectorFactory fa\n      * Returns a new instance of a {@link ResourceLeakDetector} with the given resource class.\n      *\n      * @param resource the resource class used to initialize the {@link ResourceLeakDetector}\n-     * @param <T> the type of the resource class\n+     * @param <T>      the type of the resource class", "originalCommit": "87531c7cb87c3038d052481f45c38b3643130a00", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYxNTg5MQ==", "url": "https://github.com/netty/netty/pull/10383#discussion_r447615891", "bodyText": "ok,i will revert any code format", "author": "skyguard1", "createdAt": "2020-06-30T11:37:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYxNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYxODE3Nw==", "url": "https://github.com/netty/netty/pull/10383#discussion_r447618177", "bodyText": "Sorry, forgive me for not understanding the formatting style of netty code, if there is pr in the future, I will pay attention to this", "author": "skyguard1", "createdAt": "2020-06-30T11:42:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYxNDg0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYzMTc3MQ==", "url": "https://github.com/netty/netty/pull/10383#discussion_r447631771", "bodyText": "@skyguard1 don't worry... thanks for the PR :)", "author": "normanmaurer", "createdAt": "2020-06-30T12:07:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzYxNDg0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "0f04075e87e6091d277f0d24356773427bda38f5", "chunk": "diff --git a/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java b/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java\nindex e7683af360..583f7fc1c9 100644\n--- a/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java\n+++ b/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java\n\n@@ -56,7 +56,7 @@ public abstract class ResourceLeakDetectorFactory {\n      * Returns a new instance of a {@link ResourceLeakDetector} with the given resource class.\n      *\n      * @param resource the resource class used to initialize the {@link ResourceLeakDetector}\n-     * @param <T>      the type of the resource class\n+     * @param <T> the type of the resource class\n      * @return a new instance of {@link ResourceLeakDetector}\n      */\n     public final <T> ResourceLeakDetector<T> newResourceLeakDetector(Class<T> resource) {\n"}}, {"oid": "0f04075e87e6091d277f0d24356773427bda38f5", "url": "https://github.com/netty/netty/commit/0f04075e87e6091d277f0d24356773427bda38f5", "message": "Revert \"format code\"\n\nThis reverts commit 87531c7c", "committedDate": "2020-06-30T11:38:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxMDQ5Mg==", "url": "https://github.com/netty/netty/pull/10383#discussion_r447710492", "bodyText": "What about to add a check ObjectUtil.checkPositive(samplingInterval, \"samplingInterval\") ?", "author": "amizurov", "createdAt": "2020-06-30T14:06:36Z", "path": "common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java", "diffHunk": "@@ -88,7 +88,7 @@ public static void setResourceLeakDetectorFactory(ResourceLeakDetectorFactory fa\n      */\n     @SuppressWarnings(\"deprecation\")\n     public <T> ResourceLeakDetector<T> newResourceLeakDetector(Class<T> resource, int samplingInterval) {\n-        return newResourceLeakDetector(resource, ResourceLeakDetector.SAMPLING_INTERVAL, Long.MAX_VALUE);", "originalCommit": "aac7a965f4686dfda3983ba53d9bf4c48d1ec27d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODA3NDA2Nw==", "url": "https://github.com/netty/netty/pull/10383#discussion_r448074067", "bodyText": "Yes, this is feasible. It is possible that this parameter is the user's configuration. Is it appropriate to make an assertion here?@normanmaurer", "author": "skyguard1", "createdAt": "2020-07-01T02:00:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NzcxMDQ5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "d7b6d678ccff023ec74a10b0995d98a1266c4692", "chunk": "diff --git a/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java b/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java\nindex 583f7fc1c9..e9fe09c606 100644\n--- a/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java\n+++ b/common/src/main/java/io/netty/util/ResourceLeakDetectorFactory.java\n\n@@ -88,6 +88,7 @@ public abstract class ResourceLeakDetectorFactory {\n      */\n     @SuppressWarnings(\"deprecation\")\n     public <T> ResourceLeakDetector<T> newResourceLeakDetector(Class<T> resource, int samplingInterval) {\n+        ObjectUtil.checkPositive(samplingInterval, \"samplingInterval\");\n         return newResourceLeakDetector(resource, samplingInterval, Long.MAX_VALUE);\n     }\n \n"}}, {"oid": "d7b6d678ccff023ec74a10b0995d98a1266c4692", "url": "https://github.com/netty/netty/commit/d7b6d678ccff023ec74a10b0995d98a1266c4692", "message": "Verify that the samplingInterval parameter is positive", "committedDate": "2020-07-01T05:36:10Z", "type": "commit"}]}