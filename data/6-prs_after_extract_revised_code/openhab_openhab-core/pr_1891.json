{"pr_number": 1891, "pr_title": "[oauth] User-defined scope in AccessTokenResponse", "pr_createdAt": "2020-12-05T13:16:40Z", "pr_url": "https://github.com/openhab/openhab-core/pull/1891", "timeline": [{"oid": "4296b0594b4a374901d5a23fb2038274f44d9215", "url": "https://github.com/openhab/openhab-core/commit/4296b0594b4a374901d5a23fb2038274f44d9215", "message": "Adressing issue #1888\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-05T13:13:49Z", "type": "commit"}, {"oid": "1346dcfccb9464534e632a2baf61e4c9af5d3cb4", "url": "https://github.com/openhab/openhab-core/commit/1346dcfccb9464534e632a2baf61e4c9af5d3cb4", "message": "Removing incompatible NonNull annotation\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-05T17:33:46Z", "type": "commit"}, {"oid": "6e83d8f01223eaabcf6487e92440696f5bf6a6c1", "url": "https://github.com/openhab/openhab-core/commit/6e83d8f01223eaabcf6487e92440696f5bf6a6c1", "message": "Spotless correction\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-06T08:57:26Z", "type": "commit"}, {"oid": "986cdd46a723f12336685f1947753f69af418319", "url": "https://github.com/openhab/openhab-core/commit/986cdd46a723f12336685f1947753f69af418319", "message": "Providing customizable deserializer\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-06T14:15:04Z", "type": "commit"}, {"oid": "6374305bd9fd801bba85889fe0ab7413ccd29909", "url": "https://github.com/openhab/openhab-core/commit/6374305bd9fd801bba85889fe0ab7413ccd29909", "message": "Removing test\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-06T14:29:26Z", "type": "commit"}, {"oid": "19e9053b924ef35d546f26518e3ad7e74deb87bf", "url": "https://github.com/openhab/openhab-core/commit/19e9053b924ef35d546f26518e3ad7e74deb87bf", "message": "Forgot to save changes\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-06T14:32:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjcxNjc2NA==", "url": "https://github.com/openhab/openhab-core/pull/1891#discussion_r542716764", "bodyText": "A minor reminder for later refactoring: This looks like a potential candidate to be used as singleton.", "author": "cweitkamp", "createdAt": "2020-12-14T20:00:24Z", "path": "bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/OAuthClientServiceImpl.java", "diffHunk": "@@ -150,7 +150,7 @@ public String getAuthorizationUrl(@Nullable String redirectURI, @Nullable String\n             throw new OAuthException(\"Missing client ID\");\n         }\n \n-        OAuthConnector connector = new OAuthConnector(httpClientFactory);\n+        OAuthConnector connector = new OAuthConnector(httpClientFactory, persistedParams.deserializerClassName);", "originalCommit": "19e9053b924ef35d546f26518e3ad7e74deb87bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIzOTMwNw==", "url": "https://github.com/openhab/openhab-core/pull/1891#discussion_r547239307", "bodyText": "A minor reminder for later refactoring: This looks like a potential candidate to be used as singleton.\n\nSorry, I'm afraid I did not get your point here", "author": "clinique", "createdAt": "2020-12-22T12:03:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MjcxNjc2NA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "8e76d3a86ee70a00b402044e81590c1c222880ca", "url": "https://github.com/openhab/openhab-core/commit/8e76d3a86ee70a00b402044e81590c1c222880ca", "message": "Implementing suggestion from cweitkamp\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-22T08:40:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTk0OQ==", "url": "https://github.com/openhab/openhab-core/pull/1891#discussion_r547161949", "bodyText": "Yes, this looks nice. Do we have to create a new instance here or can we use this?", "author": "cweitkamp", "createdAt": "2020-12-22T09:19:55Z", "path": "bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/OAuthClientServiceImpl.java", "diffHunk": "@@ -395,4 +397,17 @@ public boolean removeAccessTokenRefreshListener(AccessTokenRefreshListener liste\n     private String createNewState() {\n         return UUID.randomUUID().toString();\n     }\n+\n+    @Override\n+    public <T extends JsonDeserializer<?>> OAuthClientService withDeserializer(Class<T> deserializerClass) {\n+        OAuthClientServiceImpl clientService = new OAuthClientServiceImpl(handle, persistedParams.tokenExpiresInSeconds,", "originalCommit": "8e76d3a86ee70a00b402044e81590c1c222880ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIyMDE2Ng==", "url": "https://github.com/openhab/openhab-core/pull/1891#discussion_r547220166", "bodyText": "I did opt to create a new instance to avoid any side effect regarding other parameter changed, it was the most straitforward path", "author": "clinique", "createdAt": "2020-12-22T11:18:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTk0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIzMTc1Mg==", "url": "https://github.com/openhab/openhab-core/pull/1891#discussion_r547231752", "bodyText": "Understood. Sounds reasonable.", "author": "cweitkamp", "createdAt": "2020-12-22T11:44:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzE2MTk0OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIzMDU1NQ==", "url": "https://github.com/openhab/openhab-core/pull/1891#discussion_r547230555", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                String deserializerClassName;\n          \n          \n            \n                @Nullable String deserializerClassName;", "author": "cweitkamp", "createdAt": "2020-12-22T11:42:01Z", "path": "bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/PersistedParams.java", "diffHunk": "@@ -32,6 +32,7 @@\n     String state;\n     String redirectUri;\n     int tokenExpiresInSeconds = 60;\n+    String deserializerClassName;", "originalCommit": "8e76d3a86ee70a00b402044e81590c1c222880ca", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "88ff61ee7f1fb890d424d1f57f2ebada6b4199f7", "chunk": "diff --git a/bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/PersistedParams.java b/bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/PersistedParams.java\nindex c9a3c10a3..00b25dd66 100644\n--- a/bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/PersistedParams.java\n+++ b/bundles/org.openhab.core.auth.oauth2client/src/main/java/org/openhab/core/auth/oauth2client/internal/PersistedParams.java\n\n@@ -32,6 +33,7 @@ class PersistedParams {\n     String state;\n     String redirectUri;\n     int tokenExpiresInSeconds = 60;\n+    @Nullable\n     String deserializerClassName;\n \n     /**\n"}}, {"oid": "88ff61ee7f1fb890d424d1f57f2ebada6b4199f7", "url": "https://github.com/openhab/openhab-core/commit/88ff61ee7f1fb890d424d1f57f2ebada6b4199f7", "message": "Integrating cweitkamp comments\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-22T12:25:45Z", "type": "commit"}, {"oid": "535fd64a6965703b88460542942fd62714c4d57d", "url": "https://github.com/openhab/openhab-core/commit/535fd64a6965703b88460542942fd62714c4d57d", "message": "Applying spotless\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-23T07:37:59Z", "type": "commit"}, {"oid": "497b8cf418de110e00850154db7c72c355dff392", "url": "https://github.com/openhab/openhab-core/commit/497b8cf418de110e00850154db7c72c355dff392", "message": "spotless apply\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-12-23T13:22:44Z", "type": "commit"}]}