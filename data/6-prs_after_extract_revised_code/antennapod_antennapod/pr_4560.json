{"pr_number": 4560, "pr_title": "Update view after episode deletion when downloaded filter is enabled", "pr_createdAt": "2020-10-19T20:24:11Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/4560", "timeline": [{"oid": "6099f75726c199c1ba73ec6a075b987194528725", "url": "https://github.com/AntennaPod/AntennaPod/commit/6099f75726c199c1ba73ec6a075b987194528725", "message": "Update view after episode deletion when downloaded filter is enabled", "committedDate": "2020-10-19T20:20:08Z", "type": "commit"}, {"oid": "0eb779add0060e4a9eb97c853208a9f096904484", "url": "https://github.com/AntennaPod/AntennaPod/commit/0eb779add0060e4a9eb97c853208a9f096904484", "message": "Update view when episode is removed from db and downloaded filter is enabled", "committedDate": "2020-10-21T15:58:49Z", "type": "commit"}, {"oid": "69ee309448f2e037212e6ebe39c6c7f16ff00d66", "url": "https://github.com/AntennaPod/AntennaPod/commit/69ee309448f2e037212e6ebe39c6c7f16ff00d66", "message": "Insert empty line before return", "committedDate": "2020-10-21T16:50:30Z", "type": "commit"}, {"oid": "ba3b236cbe1e18679f1a4312db5f88a1a2a9a751", "url": "https://github.com/AntennaPod/AntennaPod/commit/ba3b236cbe1e18679f1a4312db5f88a1a2a9a751", "message": "Add missing whitespace", "committedDate": "2020-10-21T19:32:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5MjAwNw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4560#discussion_r510092007", "bodyText": "Items can be updated for other reasons, too. This line is missing a check if the item is actually no longer downloaded.", "author": "ByteHamster", "createdAt": "2020-10-22T11:40:34Z", "path": "app/src/main/java/de/danoeh/antennapod/fragment/AllEpisodesFragment.java", "diffHunk": "@@ -89,6 +89,18 @@ protected void updateFilter(Set<String> filterValues) {\n         filterDialog.openDialog();\n     }\n \n+    @Override\n+    protected boolean shouldUpdatedItemRemainInList(FeedItem item) {\n+        SharedPreferences prefs = getActivity().getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);\n+        FeedItemFilter feedItemFilter = new FeedItemFilter(prefs.getString(PREF_FILTER, \"\"));\n+\n+        if (feedItemFilter.isShowDownloaded()) {", "originalCommit": "ba3b236cbe1e18679f1a4312db5f88a1a2a9a751", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d0bb98954781913eb1ec8f129876324d13e64e90", "chunk": "diff --git a/app/src/main/java/de/danoeh/antennapod/fragment/AllEpisodesFragment.java b/app/src/main/java/de/danoeh/antennapod/fragment/AllEpisodesFragment.java\nindex 22a09bbff..0c75b7eea 100644\n--- a/app/src/main/java/de/danoeh/antennapod/fragment/AllEpisodesFragment.java\n+++ b/app/src/main/java/de/danoeh/antennapod/fragment/AllEpisodesFragment.java\n\n@@ -94,7 +94,7 @@ public class AllEpisodesFragment extends EpisodesListFragment {\n         SharedPreferences prefs = getActivity().getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);\n         FeedItemFilter feedItemFilter = new FeedItemFilter(prefs.getString(PREF_FILTER, \"\"));\n \n-        if (feedItemFilter.isShowDownloaded()) {\n+        if (feedItemFilter.isShowDownloaded() && (!item.hasMedia() || !item.getMedia().isDownloaded())) {\n             return false;\n         }\n \n"}}, {"oid": "d0bb98954781913eb1ec8f129876324d13e64e90", "url": "https://github.com/AntennaPod/AntennaPod/commit/d0bb98954781913eb1ec8f129876324d13e64e90", "message": "Add check if media is downloaded before removing from view", "committedDate": "2020-10-22T19:31:59Z", "type": "commit"}]}