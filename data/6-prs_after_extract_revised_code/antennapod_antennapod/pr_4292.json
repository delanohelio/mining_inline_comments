{"pr_number": 4292, "pr_title": "FIX:  In landscape mode, the album art overwhelms the playback screen #4009 ", "pr_createdAt": "2020-07-16T07:22:13Z", "pr_url": "https://github.com/AntennaPod/AntennaPod/pull/4292", "timeline": [{"oid": "62a6ac90780d8d96bb9ae19f4d95108e446e941f", "url": "https://github.com/AntennaPod/AntennaPod/commit/62a6ac90780d8d96bb9ae19f4d95108e446e941f", "message": "landscape layout", "committedDate": "2020-05-28T04:07:09Z", "type": "commit"}, {"oid": "0cad3bce6840069261b64fe5dc7e474df2b57315", "url": "https://github.com/AntennaPod/AntennaPod/commit/0cad3bce6840069261b64fe5dc7e474df2b57315", "message": "sync", "committedDate": "2020-07-15T05:52:55Z", "type": "commit"}, {"oid": "dba3aee7b0152805384f9f944cac38c8abada5d5", "url": "https://github.com/AntennaPod/AntennaPod/commit/dba3aee7b0152805384f9f944cac38c8abada5d5", "message": "finally fixed", "committedDate": "2020-07-16T07:06:01Z", "type": "commit"}, {"oid": "7f8ac6c681085c2c517e7dd352806a99e682d93b", "url": "https://github.com/AntennaPod/AntennaPod/commit/7f8ac6c681085c2c517e7dd352806a99e682d93b", "message": "remove unneeded code", "committedDate": "2020-07-16T07:14:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYwNjg0OA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4292#discussion_r455606848", "bodyText": "Can this be within the if statement above?", "author": "ByteHamster", "createdAt": "2020-07-16T08:16:25Z", "path": "app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java", "diffHunk": "@@ -159,6 +171,38 @@ private void displayCoverImage(int position) {\n         }\n     }\n \n+    @Override\n+    public void onConfigurationChanged(Configuration newConfig) {\n+        super.onConfigurationChanged(newConfig);\n+\n+        if (orientation != newConfig.orientation) {\n+            orientation = newConfig.orientation;\n+        }\n+        configureForOrientation(orientation, newConfig);", "originalCommit": "7f8ac6c681085c2c517e7dd352806a99e682d93b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc2MDgyMg==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4292#discussion_r455760822", "bodyText": "I wanted to leave this outside of the if for those devices that can change their screen sizes", "author": "tonytamsf", "createdAt": "2020-07-16T12:50:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYwNjg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTc3NjM0NA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4292#discussion_r455776344", "bodyText": "Okay then I think it is not really needed to store a global orientation and do the check above. You could just write something like configureForOrientation(newConfig)", "author": "ByteHamster", "createdAt": "2020-07-16T13:15:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYwNjg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTg0MjMyNA==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4292#discussion_r455842324", "bodyText": "good catch, I have fixed now.", "author": "tonytamsf", "createdAt": "2020-07-16T14:44:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTYwNjg0OA=="}], "type": "inlineReview", "revised_code": {"commit": "b3112701de533456166355ee73428e7412604367", "chunk": "diff --git a/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java b/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java\nindex a3f46542d..c9fd417cd 100644\n--- a/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java\n+++ b/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java\n\n@@ -175,10 +174,7 @@ public class CoverFragment extends Fragment {\n     public void onConfigurationChanged(Configuration newConfig) {\n         super.onConfigurationChanged(newConfig);\n \n-        if (orientation != newConfig.orientation) {\n-            orientation = newConfig.orientation;\n-        }\n-        configureForOrientation(orientation, newConfig);\n+        configureForOrientation(newConfig);\n     }\n \n     public float convertDpToPixel(float dp) {\n"}}, {"oid": "b3112701de533456166355ee73428e7412604367", "url": "https://github.com/AntennaPod/AntennaPod/commit/b3112701de533456166355ee73428e7412604367", "message": "remove global var for orientation", "committedDate": "2020-07-16T14:43:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA4MzQ5NQ==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4292#discussion_r456083495", "bodyText": "Setting this directly just sets the variables and does not re-layout. I think something like this would be more safe:\nViewGroup.LayoutParams params = imgvCover.getLayoutParams();\nparams.width = (int) (convertDpToPixel(newConfig.screenWidthDp) * .80);\nparams.height = imgvCover.getLayoutParams().width;\nimgvCover.setLayoutParams(params);", "author": "ByteHamster", "createdAt": "2020-07-16T21:18:08Z", "path": "app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java", "diffHunk": "@@ -159,6 +170,35 @@ private void displayCoverImage(int position) {\n         }\n     }\n \n+    @Override\n+    public void onConfigurationChanged(Configuration newConfig) {\n+        super.onConfigurationChanged(newConfig);\n+\n+        configureForOrientation(newConfig);\n+    }\n+\n+    public float convertDpToPixel(float dp) {\n+        Context context = this.getActivity().getApplicationContext();\n+        return dp * ((float) context.getResources().getDisplayMetrics().densityDpi / DisplayMetrics.DENSITY_DEFAULT);\n+    }\n+\n+    private void configureForOrientation(Configuration newConfig) {\n+        LinearLayout mainContainer = getView().findViewById(R.id.cover_fragment);\n+        if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {\n+            mainContainer.setOrientation(LinearLayout.VERTICAL);\n+            if (newConfig.screenWidthDp > 0) {\n+                imgvCover.getLayoutParams().width = (int) (convertDpToPixel(newConfig.screenWidthDp) * .80);\n+                imgvCover.getLayoutParams().height = imgvCover.getLayoutParams().width;", "originalCommit": "b3112701de533456166355ee73428e7412604367", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjIzMDg3Nw==", "url": "https://github.com/AntennaPod/AntennaPod/pull/4292#discussion_r456230877", "bodyText": "Done", "author": "tonytamsf", "createdAt": "2020-07-17T05:46:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjA4MzQ5NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ac8f6f9a3e3ffd27ff82cea82256007c6676c764", "chunk": "diff --git a/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java b/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java\nindex c9fd417cd..0bb657e51 100644\n--- a/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java\n+++ b/app/src/main/java/de/danoeh/antennapod/fragment/CoverFragment.java\n\n@@ -184,17 +184,21 @@ public class CoverFragment extends Fragment {\n \n     private void configureForOrientation(Configuration newConfig) {\n         LinearLayout mainContainer = getView().findViewById(R.id.cover_fragment);\n+        ViewGroup.LayoutParams params = imgvCover.getLayoutParams();\n+\n         if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {\n             mainContainer.setOrientation(LinearLayout.VERTICAL);\n             if (newConfig.screenWidthDp > 0) {\n-                imgvCover.getLayoutParams().width = (int) (convertDpToPixel(newConfig.screenWidthDp) * .80);\n-                imgvCover.getLayoutParams().height = imgvCover.getLayoutParams().width;\n+                params.width = (int) (convertDpToPixel(newConfig.screenWidthDp) * .80);\n+                params.height= params.width;\n+                imgvCover.setLayoutParams(params);\n             }\n         } else {\n             mainContainer.setOrientation(LinearLayout.HORIZONTAL);\n             if (newConfig.screenHeightDp > 0) {\n-                imgvCover.getLayoutParams().height = (int) (convertDpToPixel(newConfig.screenHeightDp) * .40);\n-                imgvCover.getLayoutParams().width = imgvCover.getLayoutParams().height;\n+                params.height = (int) (convertDpToPixel(newConfig.screenHeightDp) * .40);\n+                params.width = params.height;\n+                imgvCover.setLayoutParams(params);\n             }\n         }\n     }\n"}}, {"oid": "ac8f6f9a3e3ffd27ff82cea82256007c6676c764", "url": "https://github.com/AntennaPod/AntennaPod/commit/ac8f6f9a3e3ffd27ff82cea82256007c6676c764", "message": "layout params", "committedDate": "2020-07-17T05:45:59Z", "type": "commit"}, {"oid": "98edefea08672df15b99a59561e5de939867194f", "url": "https://github.com/AntennaPod/AntennaPod/commit/98edefea08672df15b99a59561e5de939867194f", "message": "a bit more margin", "committedDate": "2020-07-17T05:56:19Z", "type": "commit"}, {"oid": "e53db91ee38173be33fb2273070ec2f76d05763a", "url": "https://github.com/AntennaPod/AntennaPod/commit/e53db91ee38173be33fb2273070ec2f76d05763a", "message": "fix checkstyle", "committedDate": "2020-07-18T00:53:28Z", "type": "commit"}]}