{"pr_number": 1241, "pr_title": "TestPublisherSubscriber API updates", "pr_createdAt": "2020-12-05T01:45:40Z", "pr_url": "https://github.com/apple/servicetalk/pull/1241", "timeline": [{"oid": "92e831e98162997421742163cb5fa8c6708aa0bd", "url": "https://github.com/apple/servicetalk/commit/92e831e98162997421742163cb5fa8c6708aa0bd", "message": "TestPublisherSubscriber API updates\n\nMotivation:\nTestPublisherSubscriber supports some consumers which can be tested via\nother means. TestPublisherSubscriber#pollTerminal doesn't inform the\ncaller as to which terminal event has arrived, and there are only\nblocking alternatives to get the terminal event, so if you call the\nwrong method you may block indefinitely.\n\nModifications:\n- Remove onSubscribe and onNext Consumers\n- Change the return type of TestPublisherSubscriber#pollTerminal so the\ncaller knows which type of terminal was processed\n- Change the pollOnNext to avoid a null Optional value which is\ngenerally discouraged, and make the API more inline with pollTerminal\n\nResult:\nTestPublisherSubscriber has smaller API surface and poll methods provide\nresults in a more consistent fashion.", "committedDate": "2020-12-05T01:40:34Z", "type": "commit"}, {"oid": "ca262b9062865618c6cb2dd18cb1cad647076634", "url": "https://github.com/apple/servicetalk/commit/ca262b9062865618c6cb2dd18cb1cad647076634", "message": "checkstyle", "committedDate": "2020-12-05T02:00:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3MTA0Mg==", "url": "https://github.com/apple/servicetalk/pull/1241#discussion_r537171042", "bodyText": "It returns Supplier, not an item", "author": "idelpivnitskiy", "createdAt": "2020-12-07T01:17:10Z", "path": "servicetalk-concurrent-test-internal/src/main/java/io/servicetalk/concurrent/test/internal/TestPublisherSubscriber.java", "diffHunk": "@@ -246,12 +217,13 @@ public T takeOnNext() {\n      *\n      * @param timeout The amount of time to wait.\n      * @param unit The units of {@code timeout}.\n-     * @return item delivered to {@link #onNext(Object)}, or {@code null} if a timeout occurred.\n+     * @return item delivered to {@link #onNext(Object)}, or {@code null} if a timeout occurred or a terminal signal", "originalCommit": "ca262b9062865618c6cb2dd18cb1cad647076634", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzgxMTAyNg==", "url": "https://github.com/apple/servicetalk/pull/1241#discussion_r537811026", "bodyText": "fixed", "author": "Scottmitch", "createdAt": "2020-12-07T20:30:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzE3MTA0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "64477b533a1115a19e0d61cd8e83e997cffeb500", "chunk": "diff --git a/servicetalk-concurrent-test-internal/src/main/java/io/servicetalk/concurrent/test/internal/TestPublisherSubscriber.java b/servicetalk-concurrent-test-internal/src/main/java/io/servicetalk/concurrent/test/internal/TestPublisherSubscriber.java\nindex 6910d927c..382855daf 100644\n--- a/servicetalk-concurrent-test-internal/src/main/java/io/servicetalk/concurrent/test/internal/TestPublisherSubscriber.java\n+++ b/servicetalk-concurrent-test-internal/src/main/java/io/servicetalk/concurrent/test/internal/TestPublisherSubscriber.java\n\n@@ -217,8 +217,8 @@ public final class TestPublisherSubscriber<T> implements Subscriber<T> {\n      *\n      * @param timeout The amount of time to wait.\n      * @param unit The units of {@code timeout}.\n-     * @return item delivered to {@link #onNext(Object)}, or {@code null} if a timeout occurred or a terminal signal\n-     * has been received.\n+     * @return A {@link Supplier} that returns the signal delivered to {@link #onNext(Object)},\n+     * or {@code null} if a timeout occurred or a terminal signal has been received.\n      */\n     @Nullable\n     public Supplier<T> pollOnNext(long timeout, TimeUnit unit) {\n"}}, {"oid": "64477b533a1115a19e0d61cd8e83e997cffeb500", "url": "https://github.com/apple/servicetalk/commit/64477b533a1115a19e0d61cd8e83e997cffeb500", "message": "fix javadoc", "committedDate": "2020-12-07T20:30:00Z", "type": "commit"}]}