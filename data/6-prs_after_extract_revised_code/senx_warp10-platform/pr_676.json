{"pr_number": 676, "pr_title": "fix #635", "pr_createdAt": "2020-02-27T11:09:40Z", "pr_url": "https://github.com/senx/warp10-platform/pull/676", "timeline": [{"oid": "a86ef0c56462731d3aa926e95e27d58ca2eb0823", "url": "https://github.com/senx/warp10-platform/commit/a86ef0c56462731d3aa926e95e27d58ca2eb0823", "message": "fix #635", "committedDate": "2020-02-27T11:00:11Z", "type": "commit"}, {"oid": "2c666129b9321d62052a840c4430c16c093af2de", "url": "https://github.com/senx/warp10-platform/commit/2c666129b9321d62052a840c4430c16c093af2de", "message": "fix copyright notice", "committedDate": "2020-02-27T11:17:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjE3MQ==", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786171", "bodyText": "Until now I think all empty GTSs are of type UNDEFINED. I understand the logic but are you sure it does not break anything?\nWhat is your opinion @hbs?", "author": "ftence", "createdAt": "2020-03-17T15:56:48Z", "path": "warp10/src/main/java/io/warp10/script/binary/DIV.java", "diffHunk": "@@ -55,6 +55,14 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie gts1 = (GeoTimeSerie) op1;\n       GeoTimeSerie gts2 = (GeoTimeSerie) op2;\n \n+      // Returns immediately a new gts if both inputs are empty\n+      if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n+        GeoTimeSerie result = new GeoTimeSerie();\n+        result.setType(TYPE.DOUBLE);", "originalCommit": "2c666129b9321d62052a840c4430c16c093af2de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/binary/DIV.java b/warp10/src/main/java/io/warp10/script/binary/DIV.java\nindex b9f7b30d..c661c731 100644\n--- a/warp10/src/main/java/io/warp10/script/binary/DIV.java\n+++ b/warp10/src/main/java/io/warp10/script/binary/DIV.java\n\n@@ -58,7 +58,6 @@ public class DIV extends NamedWarpScriptFunction implements WarpScriptStackFunct\n       // Returns immediately a new gts if both inputs are empty\n       if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n         GeoTimeSerie result = new GeoTimeSerie();\n-        result.setType(TYPE.DOUBLE);\n         stack.push(result);\n         return stack;\n       }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjI2Nw==", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786267", "bodyText": "Ditto.", "author": "ftence", "createdAt": "2020-03-17T15:56:55Z", "path": "warp10/src/main/java/io/warp10/script/binary/DIV.java", "diffHunk": "@@ -152,6 +160,13 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie result = op1gts ? ((GeoTimeSerie) op1).cloneEmpty(n) : ((GeoTimeSerie) op2).cloneEmpty();\n       GeoTimeSerie gts = op1gts ? (GeoTimeSerie) op1 : (GeoTimeSerie) op2;\n \n+      // Returns immediately a new clone if gts is empty.\n+      if (0 == n) {\n+        result.setType(TYPE.DOUBLE);", "originalCommit": "2c666129b9321d62052a840c4430c16c093af2de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/binary/DIV.java b/warp10/src/main/java/io/warp10/script/binary/DIV.java\nindex b9f7b30d..c661c731 100644\n--- a/warp10/src/main/java/io/warp10/script/binary/DIV.java\n+++ b/warp10/src/main/java/io/warp10/script/binary/DIV.java\n\n@@ -162,7 +161,6 @@ public class DIV extends NamedWarpScriptFunction implements WarpScriptStackFunct\n \n       // Returns immediately a new clone if gts is empty.\n       if (0 == n) {\n-        result.setType(TYPE.DOUBLE);\n         stack.push(result);\n         return stack;\n       }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjQxMA==", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786410", "bodyText": "Ditto.", "author": "ftence", "createdAt": "2020-03-17T15:57:07Z", "path": "warp10/src/main/java/io/warp10/script/binary/MUL.java", "diffHunk": "@@ -68,6 +68,14 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie gts1 = (GeoTimeSerie) op1;\n       GeoTimeSerie gts2 = (GeoTimeSerie) op2;\n \n+      // Returns immediately a new gts if both inputs are empty\n+      if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n+        GeoTimeSerie result = new GeoTimeSerie();\n+        result.setType(TYPE.DOUBLE);", "originalCommit": "2c666129b9321d62052a840c4430c16c093af2de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/binary/MUL.java b/warp10/src/main/java/io/warp10/script/binary/MUL.java\nindex 2b264f7a..1f2c7cb1 100644\n--- a/warp10/src/main/java/io/warp10/script/binary/MUL.java\n+++ b/warp10/src/main/java/io/warp10/script/binary/MUL.java\n\n@@ -71,7 +71,6 @@ public class MUL extends NamedWarpScriptFunction implements WarpScriptStackFunct\n       // Returns immediately a new gts if both inputs are empty\n       if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n         GeoTimeSerie result = new GeoTimeSerie();\n-        result.setType(TYPE.DOUBLE);\n         stack.push(result);\n         return stack;\n       }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NjU3NA==", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393786574", "bodyText": "Ditto.", "author": "ftence", "createdAt": "2020-03-17T15:57:19Z", "path": "warp10/src/main/java/io/warp10/script/binary/MUL.java", "diffHunk": "@@ -161,6 +169,13 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie result = op1gts ? ((GeoTimeSerie) op1).cloneEmpty(n) : ((GeoTimeSerie) op2).cloneEmpty();\n       GeoTimeSerie gts = op1gts ? (GeoTimeSerie) op1 : (GeoTimeSerie) op2;\n \n+      // Returns immediately a new clone if gts is empty.\n+      if (0 == n) {\n+        result.setType(TYPE.DOUBLE);", "originalCommit": "2c666129b9321d62052a840c4430c16c093af2de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/binary/MUL.java b/warp10/src/main/java/io/warp10/script/binary/MUL.java\nindex 2b264f7a..1f2c7cb1 100644\n--- a/warp10/src/main/java/io/warp10/script/binary/MUL.java\n+++ b/warp10/src/main/java/io/warp10/script/binary/MUL.java\n\n@@ -171,7 +170,6 @@ public class MUL extends NamedWarpScriptFunction implements WarpScriptStackFunct\n \n       // Returns immediately a new clone if gts is empty.\n       if (0 == n) {\n-        result.setType(TYPE.DOUBLE);\n         stack.push(result);\n         return stack;\n       }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NzA0OA==", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393787048", "bodyText": "Ditto.", "author": "ftence", "createdAt": "2020-03-17T15:57:55Z", "path": "warp10/src/main/java/io/warp10/script/binary/SUB.java", "diffHunk": "@@ -58,6 +58,14 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie gts1 = (GeoTimeSerie) op1;\n       GeoTimeSerie gts2 = (GeoTimeSerie) op2;\n \n+      // Returns immediately a new gts if both inputs are empty\n+      if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n+        GeoTimeSerie result = new GeoTimeSerie();\n+        result.setType(TYPE.DOUBLE);", "originalCommit": "2c666129b9321d62052a840c4430c16c093af2de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/binary/SUB.java b/warp10/src/main/java/io/warp10/script/binary/SUB.java\nindex a22f0d59..6fdf3853 100644\n--- a/warp10/src/main/java/io/warp10/script/binary/SUB.java\n+++ b/warp10/src/main/java/io/warp10/script/binary/SUB.java\n\n@@ -61,7 +61,6 @@ public class SUB extends NamedWarpScriptFunction implements WarpScriptStackFunct\n       // Returns immediately a new gts if both inputs are empty\n       if (0 == GTSHelper.nvalues(gts1) || 0 == GTSHelper.nvalues(gts2)) {\n         GeoTimeSerie result = new GeoTimeSerie();\n-        result.setType(TYPE.DOUBLE);\n         stack.push(result);\n         return stack;\n       }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc4NzEyMA==", "url": "https://github.com/senx/warp10-platform/pull/676#discussion_r393787120", "bodyText": "Ditto.", "author": "ftence", "createdAt": "2020-03-17T15:58:01Z", "path": "warp10/src/main/java/io/warp10/script/binary/SUB.java", "diffHunk": "@@ -155,6 +163,13 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       GeoTimeSerie result = op1gts ? ((GeoTimeSerie) op1).cloneEmpty(n) : ((GeoTimeSerie) op2).cloneEmpty();\n       GeoTimeSerie gts = op1gts ? (GeoTimeSerie) op1 : (GeoTimeSerie) op2;\n \n+      // Returns immediately a new clone if gts is empty.\n+      if (0 == n) {\n+        result.setType(TYPE.DOUBLE);", "originalCommit": "2c666129b9321d62052a840c4430c16c093af2de", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/binary/SUB.java b/warp10/src/main/java/io/warp10/script/binary/SUB.java\nindex a22f0d59..6fdf3853 100644\n--- a/warp10/src/main/java/io/warp10/script/binary/SUB.java\n+++ b/warp10/src/main/java/io/warp10/script/binary/SUB.java\n\n@@ -165,7 +164,6 @@ public class SUB extends NamedWarpScriptFunction implements WarpScriptStackFunct\n \n       // Returns immediately a new clone if gts is empty.\n       if (0 == n) {\n-        result.setType(TYPE.DOUBLE);\n         stack.push(result);\n         return stack;\n       }\n"}}, {"oid": "e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "url": "https://github.com/senx/warp10-platform/commit/e5d7ae9f8c215bfcff032d4064a72fc12a8d9156", "message": "untyped output for empty gts to gts operations", "committedDate": "2020-03-18T07:34:30Z", "type": "commit"}]}