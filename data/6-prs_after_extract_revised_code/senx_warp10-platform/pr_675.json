{"pr_number": 675, "pr_title": "Added support for GTSEncoder instances in META", "pr_createdAt": "2020-02-27T10:05:45Z", "pr_url": "https://github.com/senx/warp10-platform/pull/675", "timeline": [{"oid": "7517b1f4caaced43969658b3dadbd579da4cfc55", "url": "https://github.com/senx/warp10-platform/commit/7517b1f4caaced43969658b3dadbd579da4cfc55", "message": "Added support for GTSEncoder instances in META", "committedDate": "2020-02-27T10:04:53Z", "type": "commit"}, {"oid": "3980145e65d0a978161a853108a68307c6955f0f", "url": "https://github.com/senx/warp10-platform/commit/3980145e65d0a978161a853108a68307c6955f0f", "message": "Merge branch 'master' into meta-encoders", "committedDate": "2020-03-03T15:21:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc0NjIxNQ==", "url": "https://github.com/senx/warp10-platform/pull/675#discussion_r393746215", "bodyText": "Variable name should be changed to reflect the type.", "author": "ftence", "createdAt": "2020-03-17T15:03:41Z", "path": "warp10/src/main/java/io/warp10/script/functions/META.java", "diffHunk": "@@ -66,27 +68,31 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n     Object otoken = stack.pop();\n     \n     if (!(otoken instanceof String)) {\n-      throw new WarpScriptException(getName() + \" expects a token on top of the stack.\");\n+      throw new WarpScriptException(getName() + \" expects a token.\");\n     }\n     \n     String token = (String) otoken;\n \n-    List<GeoTimeSerie> series = new ArrayList<GeoTimeSerie>();\n+    List<Metadata> series = new ArrayList<Metadata>();", "originalCommit": "7517b1f4caaced43969658b3dadbd579da4cfc55", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "75ed1d3f30c3bb9b199e2221165cfff27953576f", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/functions/META.java b/warp10/src/main/java/io/warp10/script/functions/META.java\nindex 6d961d7b..e21fc4d5 100644\n--- a/warp10/src/main/java/io/warp10/script/functions/META.java\n+++ b/warp10/src/main/java/io/warp10/script/functions/META.java\n\n@@ -73,20 +73,20 @@ public class META extends NamedWarpScriptFunction implements WarpScriptStackFunc\n     \n     String token = (String) otoken;\n \n-    List<Metadata> series = new ArrayList<Metadata>();\n+    List<Metadata> metas = new ArrayList<Metadata>();\n     \n     Object o = stack.pop();\n     \n     if (o instanceof GeoTimeSerie) {\n-      series.add(((GeoTimeSerie) o).getMetadata());\n+      metas.add(((GeoTimeSerie) o).getMetadata());\n     } else if (o instanceof GTSEncoder) {\n-      series.add(((GTSEncoder) o).getMetadata());      \n+      metas.add(((GTSEncoder) o).getMetadata());      \n     } else if (o instanceof List) {\n       for (Object oo: (List<Object>) o) {\n         if (oo instanceof GeoTimeSerie) {\n-          series.add(((GeoTimeSerie) oo).getMetadata());\n+          metas.add(((GeoTimeSerie) oo).getMetadata());\n         } else if (oo instanceof GTSEncoder) {\n-          series.add(((GTSEncoder) oo).getMetadata());\n+          metas.add(((GTSEncoder) oo).getMetadata());\n         } else {\n           throw new WarpScriptException(getName() + \" can only operate on Geo Time Series, GTS Encoders or a list thereof.\");\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mzc0ODQyMA==", "url": "https://github.com/senx/warp10-platform/pull/675#discussion_r393748420", "bodyText": "Variable name should be changed to reflect the type.", "author": "ftence", "createdAt": "2020-03-17T15:06:43Z", "path": "warp10/src/main/java/io/warp10/script/functions/META.java", "diffHunk": "@@ -158,11 +164,11 @@ public Object apply(WarpScriptStack stack) throws WarpScriptException {\n       \n       StringBuilder sb = new StringBuilder();\n       \n-      for (GeoTimeSerie gts: series) {\n+      for (Metadata gts: series) {", "originalCommit": "7517b1f4caaced43969658b3dadbd579da4cfc55", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "75ed1d3f30c3bb9b199e2221165cfff27953576f", "chunk": "diff --git a/warp10/src/main/java/io/warp10/script/functions/META.java b/warp10/src/main/java/io/warp10/script/functions/META.java\nindex 6d961d7b..e21fc4d5 100644\n--- a/warp10/src/main/java/io/warp10/script/functions/META.java\n+++ b/warp10/src/main/java/io/warp10/script/functions/META.java\n\n@@ -164,11 +164,11 @@ public class META extends NamedWarpScriptFunction implements WarpScriptStackFunc\n       \n       StringBuilder sb = new StringBuilder();\n       \n-      for (Metadata gts: series) {\n+      for (Metadata meta: metas) {\n         sb.setLength(0);\n         // Expose all labels as producer/owner will have been dropped by the meta endpoint\n-        GTSHelper.metadataToString(sb, gts.getName(), gts.getLabels(), true);\n-        Map<String,String> attributes = null != gts.getAttributes() ? gts.getAttributes() : new HashMap<String,String>();\n+        GTSHelper.metadataToString(sb, meta.getName(), meta.getLabels(), true);\n+        Map<String,String> attributes = null != meta.getAttributes() ? meta.getAttributes() : new HashMap<String,String>();\n         // Always expose attributes\n         GTSHelper.labelsToString(sb, attributes, true);\n         pw.println(sb.toString());\n"}}, {"oid": "75ed1d3f30c3bb9b199e2221165cfff27953576f", "url": "https://github.com/senx/warp10-platform/commit/75ed1d3f30c3bb9b199e2221165cfff27953576f", "message": "Renamed variable", "committedDate": "2020-03-17T15:56:23Z", "type": "commit"}]}