{"pr_number": 4832, "pr_title": "feat(clients/java): add user-agent to java client requests", "pr_createdAt": "2020-06-26T11:40:44Z", "pr_url": "https://github.com/camunda-cloud/zeebe/pull/4832", "timeline": [{"oid": "0addfe02a3daf31dd23f75629088fa7d87bb0883", "url": "https://github.com/camunda-cloud/zeebe/commit/0addfe02a3daf31dd23f75629088fa7d87bb0883", "message": "feat(clients/java): add user-agent to java client requests", "committedDate": "2020-06-26T14:27:12Z", "type": "forcePushed"}, {"oid": "92d6d5d89261f9d2fb253e4d3bd2c415e27fce2a", "url": "https://github.com/camunda-cloud/zeebe/commit/92d6d5d89261f9d2fb253e4d3bd2c415e27fce2a", "message": "feat(clients/java): set client info in requests", "committedDate": "2020-06-30T09:09:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r448309662", "bodyText": "This format seems a bit uncommon for user-agent. Usually, it has the format <product>/<version> (e.g. zeebe-client-java/0.24.0).\nWhat do you think about changing it?", "author": "saig0", "createdAt": "2020-07-01T11:51:10Z", "path": "clients/java/src/main/java/io/zeebe/client/impl/oauth/OAuthCredentialsProvider.java", "diffHunk": "@@ -162,6 +163,8 @@ private ZeebeClientCredentials fetchCredentials() throws IOException {\n     connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n     connection.setRequestProperty(\"Accept\", \"application/json\");\n     connection.setDoOutput(true);\n+    connection.setRequestProperty(\n+        \"User-Agent\", \"client: java, version: \" + VersionUtil.getVersion());", "originalCommit": "92d6d5d89261f9d2fb253e4d3bd2c415e27fce2a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODM4NzU1MA==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r448387550", "bodyText": "I'd happily change it but this is the format used in the C# and node clients so I figured it was better to stick to one format. Do you think it's better to break from that and change it here and in the Go clients?", "author": "MiguelPires", "createdAt": "2020-07-01T14:06:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc1MTc5Nw==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r448751797", "bodyText": "You're right. I also prefer one format for all clients. But I would also prefer a more common format.\nLet's shortly ask the maintainers @Zelldon and @jwulf what they are thinking of changing the user-agent format?", "author": "saig0", "createdAt": "2020-07-02T05:08:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAyMzAxMg==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r450023012", "bodyText": "@jwulf @Zelldon \ud83d\udece\ufe0f Your input is requested.", "author": "saig0", "createdAt": "2020-07-06T07:06:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAyNDQxNw==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r450024417", "bodyText": "I fine with that. In the end it doesn't matter. It is just to find out which client is used at the cloud.", "author": "Zelldon", "createdAt": "2020-07-06T07:10:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDAyNTM1NA==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r450025354", "bodyText": "Please create then issues in the corresponding clients.", "author": "Zelldon", "createdAt": "2020-07-06T07:12:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDA0NTU5Mw==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r450045593", "bodyText": "Related issues:\ncamunda-community-hub/zeebe-client-node-js#170\ncamunda-community-hub/zeebe-client-csharp#144", "author": "MiguelPires", "createdAt": "2020-07-06T07:54:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODMwOTY2Mg=="}], "type": "inlineReview", "revised_code": {"commit": "c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "chunk": "diff --git a/clients/java/src/main/java/io/zeebe/client/impl/oauth/OAuthCredentialsProvider.java b/clients/java/src/main/java/io/zeebe/client/impl/oauth/OAuthCredentialsProvider.java\nindex df801d016..3f2239e55 100644\n--- a/clients/java/src/main/java/io/zeebe/client/impl/oauth/OAuthCredentialsProvider.java\n+++ b/clients/java/src/main/java/io/zeebe/client/impl/oauth/OAuthCredentialsProvider.java\n\n@@ -163,8 +163,7 @@ public final class OAuthCredentialsProvider implements CredentialsProvider {\n     connection.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n     connection.setRequestProperty(\"Accept\", \"application/json\");\n     connection.setDoOutput(true);\n-    connection.setRequestProperty(\n-        \"User-Agent\", \"client: java, version: \" + VersionUtil.getVersion());\n+    connection.setRequestProperty(\"User-Agent\", \"zeebe-client-java/\" + VersionUtil.getVersion());\n \n     try (final OutputStream os = connection.getOutputStream()) {\n       final byte[] input = payload.getBytes(StandardCharsets.UTF_8);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODM1MTM2Nw==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r448351367", "bodyText": "Same as for the OAuthCredentialsProvider.", "author": "saig0", "createdAt": "2020-07-01T13:10:09Z", "path": "clients/java/src/main/java/io/zeebe/client/impl/ZeebeClientImpl.java", "diffHunk": "@@ -123,6 +124,7 @@ public static ManagedChannel buildChannel(final ZeebeClientConfiguration config)\n \n     configureConnectionSecurity(config, channelBuilder);\n     channelBuilder.keepAliveTime(config.getKeepAlive().toMillis(), TimeUnit.MILLISECONDS);\n+    channelBuilder.userAgent(\"client: java, version: \" + VersionUtil.getVersion());", "originalCommit": "92d6d5d89261f9d2fb253e4d3bd2c415e27fce2a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "chunk": "diff --git a/clients/java/src/main/java/io/zeebe/client/impl/ZeebeClientImpl.java b/clients/java/src/main/java/io/zeebe/client/impl/ZeebeClientImpl.java\nindex 8826f7e2a..36779efa7 100644\n--- a/clients/java/src/main/java/io/zeebe/client/impl/ZeebeClientImpl.java\n+++ b/clients/java/src/main/java/io/zeebe/client/impl/ZeebeClientImpl.java\n\n@@ -124,7 +124,7 @@ public final class ZeebeClientImpl implements ZeebeClient {\n \n     configureConnectionSecurity(config, channelBuilder);\n     channelBuilder.keepAliveTime(config.getKeepAlive().toMillis(), TimeUnit.MILLISECONDS);\n-    channelBuilder.userAgent(\"client: java, version: \" + VersionUtil.getVersion());\n+    channelBuilder.userAgent(\"zeebe-client-java/\" + VersionUtil.getVersion());\n \n     return channelBuilder.build();\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODM1Mjc2OA==", "url": "https://github.com/camunda-cloud/zeebe/pull/4832#discussion_r448352768", "bodyText": "The logger package looks a bit uncommon with .util. Maybe, we can have a logger for general or managing things io.zeebe.client.", "author": "saig0", "createdAt": "2020-07-01T13:12:23Z", "path": "clients/java/src/main/java/io/zeebe/client/impl/Loggers.java", "diffHunk": "@@ -24,4 +24,5 @@\n       LoggerFactory.getLogger(\"io.zeebe.client.job.poller\");\n   public static final Logger JOB_WORKER_LOGGER =\n       LoggerFactory.getLogger(\"io.zeebe.client.job.worker\");\n+  public static final Logger VERSION_LOGGER = LoggerFactory.getLogger(\"io.zeebe.client.util\");", "originalCommit": "92d6d5d89261f9d2fb253e4d3bd2c415e27fce2a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "chunk": "diff --git a/clients/java/src/main/java/io/zeebe/client/impl/Loggers.java b/clients/java/src/main/java/io/zeebe/client/impl/Loggers.java\nindex 80a3bb1c4..e58de9959 100644\n--- a/clients/java/src/main/java/io/zeebe/client/impl/Loggers.java\n+++ b/clients/java/src/main/java/io/zeebe/client/impl/Loggers.java\n\n@@ -24,5 +24,5 @@ public final class Loggers {\n       LoggerFactory.getLogger(\"io.zeebe.client.job.poller\");\n   public static final Logger JOB_WORKER_LOGGER =\n       LoggerFactory.getLogger(\"io.zeebe.client.job.worker\");\n-  public static final Logger VERSION_LOGGER = LoggerFactory.getLogger(\"io.zeebe.client.util\");\n+  public static final Logger LOGGER = LoggerFactory.getLogger(\"io.zeebe.client\");\n }\n"}}, {"oid": "c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "url": "https://github.com/camunda-cloud/zeebe/commit/c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "message": "feat(clients/java): set client info in requests' user-agent", "committedDate": "2020-07-07T07:59:47Z", "type": "commit"}, {"oid": "c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "url": "https://github.com/camunda-cloud/zeebe/commit/c3bcdfc027f45cf28c25e71cdab4f96c32ec069b", "message": "feat(clients/java): set client info in requests' user-agent", "committedDate": "2020-07-07T07:59:47Z", "type": "forcePushed"}]}