{"pr_number": 2539, "pr_title": "[Bugfix] Fix issue with zero point exercises with bonus points", "pr_createdAt": "2020-12-12T14:40:13Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2539", "timeline": [{"oid": "94a6d100ccc5bd303d842e6ed5ec95969823ea72", "url": "https://github.com/ls1intum/Artemis/commit/94a6d100ccc5bd303d842e6ed5ec95969823ea72", "message": "fix wrong call for bonusPoints", "committedDate": "2020-12-12T14:37:31Z", "type": "commit"}, {"oid": "5a123d29d4d03489fe8ed45a299432a13a933361", "url": "https://github.com/ls1intum/Artemis/commit/5a123d29d4d03489fe8ed45a299432a13a933361", "message": "fix dividing through 0 in score calculation", "committedDate": "2020-12-12T15:22:12Z", "type": "commit"}, {"oid": "01294e9d9fa95b9ec8c7e5b1ce43a297faef60d8", "url": "https://github.com/ls1intum/Artemis/commit/01294e9d9fa95b9ec8c7e5b1ce43a297faef60d8", "message": "fix score chart for bonus exercises", "committedDate": "2020-12-12T15:47:16Z", "type": "commit"}, {"oid": "8443f5407e4ccf68215d70b77196625ef6c09b43", "url": "https://github.com/ls1intum/Artemis/commit/8443f5407e4ccf68215d70b77196625ef6c09b43", "message": "Merge branch 'bugfix/programming-exercises/fix-zero-point-exercise-bonus' of github.com:ls1intum/Artemis into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-12T15:47:56Z", "type": "commit"}, {"oid": "7d56f4e74e1c6ffa460cffe61b1702166e667801", "url": "https://github.com/ls1intum/Artemis/commit/7d56f4e74e1c6ffa460cffe61b1702166e667801", "message": "fix codacy and add client test", "committedDate": "2020-12-12T22:34:30Z", "type": "commit"}, {"oid": "2bcb1124a9c2faef1bc2a7b44d68e04d22940bea", "url": "https://github.com/ls1intum/Artemis/commit/2bcb1124a9c2faef1bc2a7b44d68e04d22940bea", "message": "add server test", "committedDate": "2020-12-12T23:27:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg1MzIzNw==", "url": "https://github.com/ls1intum/Artemis/pull/2539#discussion_r541853237", "bodyText": "This seems very weird to me. Could we discuss that again? I think this is a bad way to handle pure bonus exercises because the score should still reflect the percentage of the gotten bonus points. I am also wondering how that influences the computation of the course-total points.", "author": "MaisiKoleni", "createdAt": "2020-12-13T05:56:06Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseGradingService.java", "diffHunk": "@@ -402,7 +402,14 @@ private void updateScore(Result result, Set<ProgrammingExerciseTestCase> success\n             }\n \n             // The score is calculated as a percentage of the maximum points\n-            long score = Math.round(successfulTestPoints / maxScoreRespectingZeroPointExercises * 100.0);\n+            long score;\n+            if (maxScoreRespectingZeroPointExercises > 0) {\n+                score = Math.round(successfulTestPoints / maxScoreRespectingZeroPointExercises * 100.0);\n+            }\n+            else {\n+                // special case when exercise has no regular points, but bonus points (e.g. 0 points, 5 bonus points -> score between 100% and 105%)\n+                score = Math.round((PLACEHOLDER_POINTS_FOR_ZERO_POINT_EXERCISES + successfulTestPoints) / PLACEHOLDER_POINTS_FOR_ZERO_POINT_EXERCISES * 100.0);", "originalCommit": "2bcb1124a9c2faef1bc2a7b44d68e04d22940bea", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg3MjQzOQ==", "url": "https://github.com/ls1intum/Artemis/pull/2539#discussion_r541872439", "bodyText": "Yes, the statement in the comment is wrong. Basically, percentages do not make much sense here, because the base value (points) is 0. I think we need to solve this case differently.\nMaybe it would be better to split the score for normal points and the score for bonus points in the future to support this case in a better way.\nAn we need to make sure the course-total points and the export in the course scores are correct", "author": "krusche", "createdAt": "2020-12-13T08:06:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg1MzIzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA5MjQ3NQ==", "url": "https://github.com/ls1intum/Artemis/pull/2539#discussion_r545092475", "bodyText": "As discussed in the meeting, we are allowing a max score of 100% as maxPoints are the amount of bonus points.\ne.g. exercise with 0 normal points 5 bonus points -> 2 tests (each giving 1 bonus point) correct -> 40% score as 2/5.", "author": "fde312", "createdAt": "2020-12-17T13:33:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg1MzIzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTA5MzE3Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2539#discussion_r545093172", "bodyText": "Tests concerning the course-score points can be done in a follow up.", "author": "fde312", "createdAt": "2020-12-17T13:34:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTg1MzIzNw=="}], "type": "inlineReview", "revised_code": {"commit": "ca253ea429be04d039656f66c0d6b5b9a9d1bd69", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseGradingService.java b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseGradingService.java\nindex 591891498..98375922d 100644\n--- a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseGradingService.java\n+++ b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseGradingService.java\n\n@@ -407,8 +407,8 @@ public class ProgrammingExerciseGradingService {\n                 score = Math.round(successfulTestPoints / maxScoreRespectingZeroPointExercises * 100.0);\n             }\n             else {\n-                // special case when exercise has no regular points, but bonus points (e.g. 0 points, 5 bonus points -> score between 100% and 105%)\n-                score = Math.round((PLACEHOLDER_POINTS_FOR_ZERO_POINT_EXERCISES + successfulTestPoints) / PLACEHOLDER_POINTS_FOR_ZERO_POINT_EXERCISES * 100.0);\n+                // special case when exercise has no regular points, but bonus points (e.g. 0 points, 5 bonus points -> score between 0% and 100% whereas 100% = 5 bonus points)\n+                score = Math.round((successfulTestPoints) / programmingExercise.getBonusPoints() * 100.0);\n             }\n \n             result.setScore(score);\n"}}, {"oid": "56542d6ed48f2f52499424dfc08d031519672dde", "url": "https://github.com/ls1intum/Artemis/commit/56542d6ed48f2f52499424dfc08d031519672dde", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-17T10:02:42Z", "type": "commit"}, {"oid": "ca253ea429be04d039656f66c0d6b5b9a9d1bd69", "url": "https://github.com/ls1intum/Artemis/commit/ca253ea429be04d039656f66c0d6b5b9a9d1bd69", "message": "adapt server as discussed", "committedDate": "2020-12-17T11:54:06Z", "type": "commit"}, {"oid": "2e8a277b43a74be39d9dee41b71445271aa14d8e", "url": "https://github.com/ls1intum/Artemis/commit/2e8a277b43a74be39d9dee41b71445271aa14d8e", "message": "adapt changes in client", "committedDate": "2020-12-17T12:19:48Z", "type": "commit"}, {"oid": "99c2102ce2e165051ccd76c07ac838e5bbc213d5", "url": "https://github.com/ls1intum/Artemis/commit/99c2102ce2e165051ccd76c07ac838e5bbc213d5", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-17T12:19:57Z", "type": "commit"}, {"oid": "cd1b55fd38d43a5cd705f957940db52aacce94b2", "url": "https://github.com/ls1intum/Artemis/commit/cd1b55fd38d43a5cd705f957940db52aacce94b2", "message": "fix codacy issue unrelated to this PR", "committedDate": "2020-12-17T12:30:12Z", "type": "commit"}, {"oid": "39b4c8ea4cced80de22aed690aebfd693a1454be", "url": "https://github.com/ls1intum/Artemis/commit/39b4c8ea4cced80de22aed690aebfd693a1454be", "message": "Revert \"fix codacy issue unrelated to this PR\"\n\nThis reverts commit cd1b55fd38d43a5cd705f957940db52aacce94b2.", "committedDate": "2020-12-17T13:05:51Z", "type": "commit"}, {"oid": "17688ddbd77401e0b4045788bee697bfc2fee498", "url": "https://github.com/ls1intum/Artemis/commit/17688ddbd77401e0b4045788bee697bfc2fee498", "message": "Merge branch 'develop' into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-17T20:23:05Z", "type": "commit"}, {"oid": "ec011f018bf175bafd0a4ee525e512b815b6aa17", "url": "https://github.com/ls1intum/Artemis/commit/ec011f018bf175bafd0a4ee525e512b815b6aa17", "message": "refactor the calculation for zero points with bonus and adapt test accordingly and extend it a bit", "committedDate": "2020-12-17T21:43:30Z", "type": "commit"}, {"oid": "5c0122d6f7abf0280ab0fc74ce679de7f026b6c2", "url": "https://github.com/ls1intum/Artemis/commit/5c0122d6f7abf0280ab0fc74ce679de7f026b6c2", "message": "Merge branch 'develop' into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-17T22:06:28Z", "type": "commit"}, {"oid": "c43f0bf3f53bfda83e6f71e5f6f107b648e0f0d1", "url": "https://github.com/ls1intum/Artemis/commit/c43f0bf3f53bfda83e6f71e5f6f107b648e0f0d1", "message": "adapt changes accordingly on client", "committedDate": "2020-12-17T22:37:48Z", "type": "commit"}, {"oid": "1fb6ba2244bd2a84f054e9b28ade970caabcef30", "url": "https://github.com/ls1intum/Artemis/commit/1fb6ba2244bd2a84f054e9b28ade970caabcef30", "message": "Merge branch 'bugfix/programming-exercises/fix-zero-point-exercise-bonus' of https://github.com/ls1intum/Artemis into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-17T22:37:54Z", "type": "commit"}, {"oid": "8fcc40f8862eb3aa06630dd876b01d71913758ab", "url": "https://github.com/ls1intum/Artemis/commit/8fcc40f8862eb3aa06630dd876b01d71913758ab", "message": "Adjust score table calculation for pure bonus exercises", "committedDate": "2020-12-17T23:47:07Z", "type": "commit"}, {"oid": "4a5b1f7c583b63837cf95044673d4fe6491e8bd3", "url": "https://github.com/ls1intum/Artemis/commit/4a5b1f7c583b63837cf95044673d4fe6491e8bd3", "message": "Merge branch 'develop' into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-18T16:49:29Z", "type": "commit"}, {"oid": "c77df8a07f9e198fd2efed1f83459424268419cc", "url": "https://github.com/ls1intum/Artemis/commit/c77df8a07f9e198fd2efed1f83459424268419cc", "message": "try to fix issue with course statistics", "committedDate": "2020-12-18T20:45:07Z", "type": "commit"}, {"oid": "b53c4d8b250b67c7b3fc731953612d1d6728f69e", "url": "https://github.com/ls1intum/Artemis/commit/b53c4d8b250b67c7b3fc731953612d1d6728f69e", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into bugfix/programming-exercises/fix-zero-point-exercise-bonus", "committedDate": "2020-12-18T20:45:27Z", "type": "commit"}, {"oid": "14fe53372ce673759a8b6a9dc73424813cca538f", "url": "https://github.com/ls1intum/Artemis/commit/14fe53372ce673759a8b6a9dc73424813cca538f", "message": "fix codacy issue", "committedDate": "2020-12-18T22:03:03Z", "type": "commit"}]}