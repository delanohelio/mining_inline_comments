{"pr_number": 1219, "pr_title": "Chore/test coverage/programming exercise resource", "pr_createdAt": "2020-02-01T20:31:16Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1219", "timeline": [{"oid": "d92c38e8574e59c196d423ef7785623b2ed1c693", "url": "https://github.com/ls1intum/Artemis/commit/d92c38e8574e59c196d423ef7785623b2ed1c693", "message": "Increase line coverage for checkProgrammingExerciseForError", "committedDate": "2020-02-01T18:39:37Z", "type": "commit"}, {"oid": "132df4e2e1e0356b76708ec459e2f45985db53d8", "url": "https://github.com/ls1intum/Artemis/commit/132df4e2e1e0356b76708ec459e2f45985db53d8", "message": "Increase line coverage for programming exercise setup", "committedDate": "2020-02-01T19:18:26Z", "type": "commit"}, {"oid": "4355087cfb052e96a6f21585278805eb256f0fa9", "url": "https://github.com/ls1intum/Artemis/commit/4355087cfb052e96a6f21585278805eb256f0fa9", "message": "Mock programming exercise setup project already exists in Bitbucket", "committedDate": "2020-02-01T19:50:41Z", "type": "commit"}, {"oid": "08c024773971125396506545ef2a8fa8577aad40", "url": "https://github.com/ls1intum/Artemis/commit/08c024773971125396506545ef2a8fa8577aad40", "message": "Mock programming exercise setup project already exists in Bamboo", "committedDate": "2020-02-01T20:11:55Z", "type": "commit"}, {"oid": "eb85d6987831f070bffa9e4f2b4a1de8b2298c29", "url": "https://github.com/ls1intum/Artemis/commit/eb85d6987831f070bffa9e4f2b4a1de8b2298c29", "message": "Better exception handling in ProgrammingExerciseResource setup", "committedDate": "2020-02-01T20:15:26Z", "type": "commit"}, {"oid": "7e0a06674d45e9b13646e160f3f86c23f2abeb25", "url": "https://github.com/ls1intum/Artemis/commit/7e0a06674d45e9b13646e160f3f86c23f2abeb25", "message": "Increase coverage for ProgrammingExerciseResource import", "committedDate": "2020-02-01T20:27:55Z", "type": "commit"}, {"oid": "42db0ec825ee801d918f3da2a210b7d97acb0ea7", "url": "https://github.com/ls1intum/Artemis/commit/42db0ec825ee801d918f3da2a210b7d97acb0ea7", "message": "Add JavaDoc", "committedDate": "2020-02-01T20:37:00Z", "type": "commit"}, {"oid": "0a0d381d9834f6a49a676c99a867dd56acce0c4c", "url": "https://github.com/ls1intum/Artemis/commit/0a0d381d9834f6a49a676c99a867dd56acce0c4c", "message": "Increase coverage for ProgrammingExerciseResource export submissions", "committedDate": "2020-02-01T20:57:19Z", "type": "commit"}, {"oid": "ea431edcd841172a52b99c59d0a727a5cd308a08", "url": "https://github.com/ls1intum/Artemis/commit/ea431edcd841172a52b99c59d0a727a5cd308a08", "message": "Increase coverage for ProgrammingExerciseResource oracle generation", "committedDate": "2020-02-01T21:17:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwMjk5NA==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373802994", "bodyText": "Not needed since the findByIdWIth.... method already throws an exception in this case", "author": "ungaralex", "createdAt": "2020-02-01T21:19:56Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -529,11 +514,6 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n         ProgrammingExercise programmingExercise = programmingExerciseService.findByIdWithEagerStudentParticipationsAndSubmissions(exerciseId);\n         User user = userService.getUserWithGroupsAndAuthorities();\n \n-        if (Optional.ofNullable(programmingExercise).isEmpty()) {", "originalCommit": "ea431edcd841172a52b99c59d0a727a5cd308a08", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwMzA3Mw==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373803073", "bodyText": "Not needed since we fetch the course from the database a couple of lines before this check", "author": "ungaralex", "createdAt": "2020-02-01T21:21:43Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -188,12 +182,6 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n                     .body(null);\n         }\n \n-        // Check if course shortname is set\n-        if (course.getShortName() == null || course.getShortName().length() < 3) {", "originalCommit": "ea431edcd841172a52b99c59d0a727a5cd308a08", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwNzYyNQ==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373807625", "bodyText": "The short name could still be empty or too short as we don\u2019t have a database constraint here, I guess this check does not harm!", "author": "krusche", "createdAt": "2020-02-01T23:10:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwMzA3Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1MjA5MA==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373852090", "bodyText": "I reverted the change", "author": "ungaralex", "createdAt": "2020-02-02T14:55:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwMzA3Mw=="}], "type": "inlineReview", "revised_code": {"commit": "a5fd86b3b9b226e2f3d35cfde64f8f21ae789317", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\nindex 2d1d9ae0f..871fce351 100644\n--- a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n+++ b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n\n@@ -182,6 +182,12 @@ public class ProgrammingExerciseResource {\n                     .body(null);\n         }\n \n+        // Check if course shortname is set\n+        if (course.getShortName() == null || course.getShortName().length() < 3) {\n+            return ResponseEntity.badRequest().headers(HeaderUtil.createAlert(applicationName, \"The shortname of the course is not set or too short\", \"courseShortnameInvalid\"))\n+                    .body(null);\n+        }\n+\n         // Check if exercise shortname matches regex\n         Matcher shortNameMatcher = SHORT_NAME_PATTERN.matcher(programmingExercise.getShortName());\n         if (!shortNameMatcher.matches()) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzgwMzExMw==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373803113", "bodyText": "Can never be null, because Spring does not allow null values for @RequestBody (default behavior).", "author": "ungaralex", "createdAt": "2020-02-01T21:22:33Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -148,10 +146,6 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n     @FeatureToggle(Feature.PROGRAMMING_EXERCISES)\n     public ResponseEntity<ProgrammingExercise> setupProgrammingExercise(@RequestBody ProgrammingExercise programmingExercise) {\n         log.debug(\"REST request to setup ProgrammingExercise : {}\", programmingExercise);\n-        if (programmingExercise == null) {", "originalCommit": "ea431edcd841172a52b99c59d0a727a5cd308a08", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "a5fd86b3b9b226e2f3d35cfde64f8f21ae789317", "url": "https://github.com/ls1intum/Artemis/commit/a5fd86b3b9b226e2f3d35cfde64f8f21ae789317", "message": "Revert course name check removal", "committedDate": "2020-02-02T14:49:45Z", "type": "commit"}, {"oid": "efd25766f3d7bf110c77d70a3d44a26f41625b74", "url": "https://github.com/ls1intum/Artemis/commit/efd25766f3d7bf110c77d70a3d44a26f41625b74", "message": "Fix error message for existing VCS project on setup", "committedDate": "2020-02-02T14:55:20Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzY0NQ==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373857645", "bodyText": "Is this change really correct? I am not sure but I thought the previous version remove all whitespaces, right?", "author": "krusche", "createdAt": "2020-02-02T16:20:26Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -552,7 +538,7 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n         List<String> studentList = new ArrayList<>();\n         if (!repositoryExportOptions.isExportAllStudents()) {\n             studentIds = studentIds.replaceAll(\" \", \"\");\n-            studentList = Arrays.asList(studentIds.split(\"\\\\s*,\\\\s*\"));\n+            studentList = Arrays.asList(studentIds.split(\",\"));", "originalCommit": "efd25766f3d7bf110c77d70a3d44a26f41625b74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1ODU4MA==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373858580", "bodyText": "Yes, but it is redundant since we already remove all whitespaces in the previous line.", "author": "ungaralex", "createdAt": "2020-02-02T16:33:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1OTU0NQ==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373859545", "bodyText": "Only spaces. What happens to other whitespaces?", "author": "krusche", "createdAt": "2020-02-02T16:48:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2Njg4Nw==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373866887", "bodyText": "I think we should change the previous line to\nstudentIds = studentIds.replaceAll(\"\\\\s+\", \"\");", "author": "krusche", "createdAt": "2020-02-02T18:53:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NjkwMw==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373866903", "bodyText": "then it would be fine", "author": "krusche", "createdAt": "2020-02-02T18:53:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzY0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NzU5OQ==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373867599", "bodyText": "Fixed", "author": "ungaralex", "createdAt": "2020-02-02T19:06:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzY0NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7f7ed5fbcd661210a414f3bdd68b6ff4a5848ba2", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\nindex a29613e71..695455ec7 100644\n--- a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n+++ b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n\n@@ -537,7 +540,7 @@ public class ProgrammingExerciseResource {\n \n         List<String> studentList = new ArrayList<>();\n         if (!repositoryExportOptions.isExportAllStudents()) {\n-            studentIds = studentIds.replaceAll(\" \", \"\");\n+            studentIds = studentIds.replaceAll(\"\\\\s\", \"\");\n             studentList = Arrays.asList(studentIds.split(\",\"));\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzczNg==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373857736", "bodyText": "Is the todo really resolved? If yes, we can keep the comment as documentation, right?\nIf not, we should keep it.", "author": "krusche", "createdAt": "2020-02-02T16:21:55Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -291,8 +284,6 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n         HttpHeaders responseHeaders;\n         programmingExerciseImportService.importRepositories(originalProgrammingExercise, importedProgrammingExercise);\n         try {\n-            // TODO: We have removed the automatic build trigger from test to base for new programming exercises. We need to also remove this build trigger manually on the case of\n-            // an import as the source exercise might still have this trigger.", "originalCommit": "efd25766f3d7bf110c77d70a3d44a26f41625b74", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NjA5Ng==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373866096", "bodyText": "Yes, this was resolved about two months ago, when we merged the triggerUpdate parameters for build plan updates.\nI removed the TODO and updated the comment to fit the current implementation", "author": "ungaralex", "createdAt": "2020-02-02T18:40:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg1NzczNg=="}], "type": "inlineReview", "revised_code": {"commit": "5af20ac32a8f099885103c706ae2c5f3ca518c86", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\nindex a29613e71..e033d9a25 100644\n--- a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n+++ b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n\n@@ -284,6 +284,9 @@ public class ProgrammingExerciseResource {\n         HttpHeaders responseHeaders;\n         programmingExerciseImportService.importRepositories(originalProgrammingExercise, importedProgrammingExercise);\n         try {\n+            // We have removed the automatic build trigger from test to base for new programming exercises.\n+            // We also remove this build trigger in the case of an import as the source exercise might still have this trigger.\n+            // The importBuildPlans method includes this process\n             programmingExerciseImportService.importBuildPlans(originalProgrammingExercise, importedProgrammingExercise);\n             responseHeaders = HeaderUtil.createEntityCreationAlert(applicationName, true, ENTITY_NAME, importedProgrammingExercise.getTitle());\n         }\n"}}, {"oid": "e2d871a5abb23fc980812f35c61f34b07df4368c", "url": "https://github.com/ls1intum/Artemis/commit/e2d871a5abb23fc980812f35c61f34b07df4368c", "message": "Merge branch 'develop' into chore/test-coverage/programming-exercise-resource", "committedDate": "2020-02-02T16:22:37Z", "type": "commit"}, {"oid": "5af20ac32a8f099885103c706ae2c5f3ca518c86", "url": "https://github.com/ls1intum/Artemis/commit/5af20ac32a8f099885103c706ae2c5f3ca518c86", "message": "Add comment", "committedDate": "2020-02-02T18:39:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2Njk0MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373866941", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        studentIds = studentIds.replaceAll(\" \", \"\");\n          \n          \n            \n                        studentIds = studentIds.replaceAll(\"\\\\s+\", \"\");", "author": "krusche", "createdAt": "2020-02-02T18:53:59Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -552,7 +541,7 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n         List<String> studentList = new ArrayList<>();\n         if (!repositoryExportOptions.isExportAllStudents()) {\n             studentIds = studentIds.replaceAll(\" \", \"\");", "originalCommit": "5af20ac32a8f099885103c706ae2c5f3ca518c86", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NzU0Mw==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373867543", "bodyText": "Done", "author": "ungaralex", "createdAt": "2020-02-02T19:05:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2Njk0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "7f7ed5fbcd661210a414f3bdd68b6ff4a5848ba2", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\nindex e033d9a25..695455ec7 100644\n--- a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n+++ b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n\n@@ -540,7 +540,7 @@ public class ProgrammingExerciseResource {\n \n         List<String> studentList = new ArrayList<>();\n         if (!repositoryExportOptions.isExportAllStudents()) {\n-            studentIds = studentIds.replaceAll(\" \", \"\");\n+            studentIds = studentIds.replaceAll(\"\\\\s\", \"\");\n             studentList = Arrays.asList(studentIds.split(\",\"));\n         }\n \n"}}, {"oid": "7f7ed5fbcd661210a414f3bdd68b6ff4a5848ba2", "url": "https://github.com/ls1intum/Artemis/commit/7f7ed5fbcd661210a414f3bdd68b6ff4a5848ba2", "message": "Use \\\\s for space regex", "committedDate": "2020-02-02T19:04:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2ODYzOQ==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373868639", "bodyText": "According to https://stackoverflow.com/questions/15633228/how-to-remove-all-white-spaces-in-java/36444332 the following version is better", "author": "krusche", "createdAt": "2020-02-02T19:23:58Z", "path": "src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "diffHunk": "@@ -551,8 +540,8 @@ public ProgrammingExerciseResource(ProgrammingExerciseRepository programmingExer\n \n         List<String> studentList = new ArrayList<>();\n         if (!repositoryExportOptions.isExportAllStudents()) {\n-            studentIds = studentIds.replaceAll(\" \", \"\");\n-            studentList = Arrays.asList(studentIds.split(\"\\\\s*,\\\\s*\"));\n+            studentIds = studentIds.replaceAll(\"\\\\s\", \"\");", "originalCommit": "7f7ed5fbcd661210a414f3bdd68b6ff4a5848ba2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2ODY2NA==", "url": "https://github.com/ls1intum/Artemis/pull/1219#discussion_r373868664", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        studentIds = studentIds.replaceAll(\"\\\\s\", \"\");\n          \n          \n            \n                        studentIds = studentIds.replaceAll(\"\\\\s+\", \"\");", "author": "krusche", "createdAt": "2020-02-02T19:24:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2ODYzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "7d6ccf2d1e1f081fbc9f54ea4c2b487d9202f97e", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\nindex 695455ec7..780c5d3dc 100644\n--- a/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n+++ b/src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java\n\n@@ -540,7 +540,7 @@ public class ProgrammingExerciseResource {\n \n         List<String> studentList = new ArrayList<>();\n         if (!repositoryExportOptions.isExportAllStudents()) {\n-            studentIds = studentIds.replaceAll(\"\\\\s\", \"\");\n+            studentIds = studentIds.replaceAll(\"\\\\s+\", \"\");\n             studentList = Arrays.asList(studentIds.split(\",\"));\n         }\n \n"}}, {"oid": "7d6ccf2d1e1f081fbc9f54ea4c2b487d9202f97e", "url": "https://github.com/ls1intum/Artemis/commit/7d6ccf2d1e1f081fbc9f54ea4c2b487d9202f97e", "message": "Update src/main/java/de/tum/in/www1/artemis/web/rest/ProgrammingExerciseResource.java", "committedDate": "2020-02-02T19:24:21Z", "type": "commit"}]}