{"pr_number": 1368, "pr_title": "Remove unnecessary restcall which caused problems", "pr_createdAt": "2020-04-30T15:08:25Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1368", "timeline": [{"oid": "08cac4d541b9c41d92457b871dc70a5597294fb6", "url": "https://github.com/ls1intum/Artemis/commit/08cac4d541b9c41d92457b871dc70a5597294fb6", "message": "removed unnecessary restcall and refactored the code", "committedDate": "2020-04-30T15:06:27Z", "type": "commit"}, {"oid": "2972fd1d49be26a2c90e8436ba0e37f7ef13ba9a", "url": "https://github.com/ls1intum/Artemis/commit/2972fd1d49be26a2c90e8436ba0e37f7ef13ba9a", "message": "Merge branch 'develop' into bugfix/remove-unnecessary-restcall", "committedDate": "2020-04-30T15:08:36Z", "type": "commit"}, {"oid": "5596d6824c85f4c53091b80ba233b49a51b5241a", "url": "https://github.com/ls1intum/Artemis/commit/5596d6824c85f4c53091b80ba233b49a51b5241a", "message": "added JavaDoc", "committedDate": "2020-04-30T16:12:54Z", "type": "commit"}, {"oid": "e117fdcee393fd514fae751d1b02f05015aef19b", "url": "https://github.com/ls1intum/Artemis/commit/e117fdcee393fd514fae751d1b02f05015aef19b", "message": "removed unnecessary check", "committedDate": "2020-04-30T16:14:03Z", "type": "commit"}, {"oid": "6782106ec2f7c76133e0da4e99b30c74d392d9b6", "url": "https://github.com/ls1intum/Artemis/commit/6782106ec2f7c76133e0da4e99b30c74d392d9b6", "message": "Merge remote-tracking branch 'origin/bugfix/remove-unnecessary-restcall' into bugfix/remove-unnecessary-restcall", "committedDate": "2020-04-30T16:14:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4NzkyOA==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418187928", "bodyText": "Why do you fetch again? I think you can simply cast the java object here", "author": "krusche", "createdAt": "2020-04-30T17:54:37Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java", "diffHunk": "@@ -372,4 +372,15 @@ private void setAssignedTeamIdForExerciseAndUser(Exercise exercise, User user) {\n             });\n         }\n     }\n+\n+    /**\n+     * Sets the transient attribute \"testRepositoryUrl\" if the exercises is a programming exercise\n+     *\n+     * @param exercise the exercise for which to set the url\n+     */\n+    public void setTestRepositoryUrlForProgrammingExercise(Exercise exercise) {\n+        if (exercise instanceof ProgrammingExercise) {\n+            exercise.setTestRepositoryUrlTransient(programmingExerciseService.findByIdWithEagerStudentParticipations(exercise.getId()).getTestRepositoryUrl());", "originalCommit": "6782106ec2f7c76133e0da4e99b30c74d392d9b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODIxNzQ0MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418217441", "bodyText": "Yes, you are right, thank you for the tip", "author": "F4lka", "createdAt": "2020-04-30T18:47:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4NzkyOA=="}], "type": "inlineReview", "revised_code": {"commit": "47ea7aef26c96fec20f6953369aeeb8f91ea887b", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java b/src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java\nindex b73c83554f..443c4007c6 100644\n--- a/src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java\n+++ b/src/main/java/de/tum/in/www1/artemis/service/ExerciseService.java\n\n@@ -380,7 +380,8 @@ public class ExerciseService {\n      */\n     public void setTestRepositoryUrlForProgrammingExercise(Exercise exercise) {\n         if (exercise instanceof ProgrammingExercise) {\n-            exercise.setTestRepositoryUrlTransient(programmingExerciseService.findByIdWithEagerStudentParticipations(exercise.getId()).getTestRepositoryUrl());\n+            boolean isLocalSimulation = (((ProgrammingExercise) exercise).getTestRepositoryUrl()).contains(\"artemislocalhost\");\n+            exercise.setIsLocalSimulation(isLocalSimulation);\n         }\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4ODg5MQ==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418188891", "bodyText": "You misunderstood me. Do not set the string again here. Use a transient Boolean in ProgrammingExercise called isLocalSimulation (or similar) and only set this to true if the url includes artemislocal (Same Check as on the client)", "author": "krusche", "createdAt": "2020-04-30T17:56:18Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Exercise.java", "diffHunk": "@@ -172,6 +172,9 @@\n     @Transient\n     private Long studentAssignedTeamIdTransient; // id of the team that the logged-in user is assigned to (only relevant if team mode is enabled)\n \n+    @Transient\n+    private String testRepositoryUrlTransient;\n+", "originalCommit": "6782106ec2f7c76133e0da4e99b30c74d392d9b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODIzNjk2NQ==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418236965", "bodyText": "please still move this to ProgrammingExercise.java", "author": "krusche", "createdAt": "2020-04-30T19:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4ODg5MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODIzODQxNw==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418238417", "bodyText": "Alright, i updated the transient property", "author": "F4lka", "createdAt": "2020-04-30T19:26:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODE4ODg5MQ=="}], "type": "inlineReview", "revised_code": {"commit": "47ea7aef26c96fec20f6953369aeeb8f91ea887b", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Exercise.java b/src/main/java/de/tum/in/www1/artemis/domain/Exercise.java\nindex 27b5437d37..4021310818 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Exercise.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Exercise.java\n\n@@ -173,7 +173,7 @@ public abstract class Exercise implements Serializable {\n     private Long studentAssignedTeamIdTransient; // id of the team that the logged-in user is assigned to (only relevant if team mode is enabled)\n \n     @Transient\n-    private String testRepositoryUrlTransient;\n+    private boolean isLocalSimulationTransient;\n \n     // jhipster-needle-entity-add-field - JHipster will add fields here, do not remove\n     public Long getId() {\n"}}, {"oid": "47ea7aef26c96fec20f6953369aeeb8f91ea887b", "url": "https://github.com/ls1intum/Artemis/commit/47ea7aef26c96fec20f6953369aeeb8f91ea887b", "message": "changed transient variable to boolean and renamed the variable to isLocalSimulation", "committedDate": "2020-04-30T18:39:50Z", "type": "commit"}, {"oid": "b2387024a2532d0d8c29c1066f55937863fddcb9", "url": "https://github.com/ls1intum/Artemis/commit/b2387024a2532d0d8c29c1066f55937863fddcb9", "message": "added TestrepositoryUrl for the testcase testGetExerciseDetails()", "committedDate": "2020-04-30T19:24:24Z", "type": "commit"}, {"oid": "a56d640f0915b12b1066dbaa8ff135a1c3f5782c", "url": "https://github.com/ls1intum/Artemis/commit/a56d640f0915b12b1066dbaa8ff135a1c3f5782c", "message": "moved transient property from exercise to programming-exercise", "committedDate": "2020-04-30T19:40:47Z", "type": "commit"}, {"oid": "70c02d337089cfa864ab9e32e4f5d8e6e135ab6e", "url": "https://github.com/ls1intum/Artemis/commit/70c02d337089cfa864ab9e32e4f5d8e6e135ab6e", "message": "moved transient property from exercise to programming-exercise (server-side)", "committedDate": "2020-04-30T19:56:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ3NTUxMg==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418475512", "bodyText": "please rename the method, it does not reflect what is done here.", "author": "krusche", "createdAt": "2020-05-01T09:23:54Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java", "diffHunk": "@@ -777,4 +777,16 @@ public long countSubmissionsByCourseIdSubmitted(Long courseId) {\n         log.debug(\"countSubmissionsByCourseIdSubmitted took \" + (System.currentTimeMillis() - start) + \"ms\");\n         return count;\n     }\n+\n+    /**\n+     * Sets the transient attribute \"testRepositoryUrl\" if the exercises is a programming exercise\n+     *\n+     * @param exercise the exercise for which to set the url\n+     */\n+    public void setTestRepositoryUrlForProgrammingExercise(Exercise exercise) {", "originalCommit": "70c02d337089cfa864ab9e32e4f5d8e6e135ab6e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUzNDkyMg==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418534922", "bodyText": "i renamed the method to checksAndSetsIfProgrammingExerciseIsLocalSimulation", "author": "F4lka", "createdAt": "2020-05-01T13:13:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ3NTUxMg=="}], "type": "inlineReview", "revised_code": {"commit": "1d22420eaf0d0d66f714b8195575c20d67594d1a", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java\nindex 93c298c1c0..c984b5811c 100644\n--- a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java\n+++ b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java\n\n@@ -779,14 +779,14 @@ public class ProgrammingExerciseService {\n     }\n \n     /**\n-     * Sets the transient attribute \"testRepositoryUrl\" if the exercises is a programming exercise\n-     *\n-     * @param exercise the exercise for which to set the url\n+     * Sets the transient attribute \"isLocalSimulation\" if the exercises is a programming exercise\n+     * and the testRepositoryUrl contains the String \"artemislocalhost\" which is the indicator that the programming exercise has\n+     * no connection to a version control and continuous integration server\n+     * @param exercise the exercise for which to set if it is a local simulation\n      */\n-    public void setTestRepositoryUrlForProgrammingExercise(Exercise exercise) {\n-        if (exercise instanceof ProgrammingExercise) {\n-            boolean isLocalSimulation = (((ProgrammingExercise) exercise).getTestRepositoryUrl()).contains(\"artemislocalhost\");\n-            ((ProgrammingExercise) exercise).setIsLocalSimulation(isLocalSimulation);\n+    public void checksAndSetsIfProgrammingExerciseIsLocalSimulation(Exercise exercise) {\n+        if (exercise instanceof ProgrammingExercise && (((ProgrammingExercise) exercise).getTestRepositoryUrl()).contains(\"artemislocalhost\")) {\n+            ((ProgrammingExercise) exercise).setIsLocalSimulation(true);\n         }\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ3NTU4OQ==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418475589", "bodyText": "I would only set this value if it is a local simulation", "author": "krusche", "createdAt": "2020-05-01T09:24:09Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java", "diffHunk": "@@ -777,4 +777,16 @@ public long countSubmissionsByCourseIdSubmitted(Long courseId) {\n         log.debug(\"countSubmissionsByCourseIdSubmitted took \" + (System.currentTimeMillis() - start) + \"ms\");\n         return count;\n     }\n+\n+    /**\n+     * Sets the transient attribute \"testRepositoryUrl\" if the exercises is a programming exercise\n+     *\n+     * @param exercise the exercise for which to set the url\n+     */\n+    public void setTestRepositoryUrlForProgrammingExercise(Exercise exercise) {\n+        if (exercise instanceof ProgrammingExercise) {\n+            boolean isLocalSimulation = (((ProgrammingExercise) exercise).getTestRepositoryUrl()).contains(\"artemislocalhost\");\n+            ((ProgrammingExercise) exercise).setIsLocalSimulation(isLocalSimulation);", "originalCommit": "70c02d337089cfa864ab9e32e4f5d8e6e135ab6e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODUzNTIxNA==", "url": "https://github.com/ls1intum/Artemis/pull/1368#discussion_r418535214", "bodyText": "now the value will be only set if it is a local simulation", "author": "F4lka", "createdAt": "2020-05-01T13:14:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxODQ3NTU4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "1d22420eaf0d0d66f714b8195575c20d67594d1a", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java\nindex 93c298c1c0..c984b5811c 100644\n--- a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java\n+++ b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseService.java\n\n@@ -779,14 +779,14 @@ public class ProgrammingExerciseService {\n     }\n \n     /**\n-     * Sets the transient attribute \"testRepositoryUrl\" if the exercises is a programming exercise\n-     *\n-     * @param exercise the exercise for which to set the url\n+     * Sets the transient attribute \"isLocalSimulation\" if the exercises is a programming exercise\n+     * and the testRepositoryUrl contains the String \"artemislocalhost\" which is the indicator that the programming exercise has\n+     * no connection to a version control and continuous integration server\n+     * @param exercise the exercise for which to set if it is a local simulation\n      */\n-    public void setTestRepositoryUrlForProgrammingExercise(Exercise exercise) {\n-        if (exercise instanceof ProgrammingExercise) {\n-            boolean isLocalSimulation = (((ProgrammingExercise) exercise).getTestRepositoryUrl()).contains(\"artemislocalhost\");\n-            ((ProgrammingExercise) exercise).setIsLocalSimulation(isLocalSimulation);\n+    public void checksAndSetsIfProgrammingExerciseIsLocalSimulation(Exercise exercise) {\n+        if (exercise instanceof ProgrammingExercise && (((ProgrammingExercise) exercise).getTestRepositoryUrl()).contains(\"artemislocalhost\")) {\n+            ((ProgrammingExercise) exercise).setIsLocalSimulation(true);\n         }\n     }\n }\n"}}, {"oid": "1d22420eaf0d0d66f714b8195575c20d67594d1a", "url": "https://github.com/ls1intum/Artemis/commit/1d22420eaf0d0d66f714b8195575c20d67594d1a", "message": "code refactoring and only set the transient property, if the programming exercise is a local simulation", "committedDate": "2020-05-01T12:25:03Z", "type": "commit"}, {"oid": "cc5825d1a692c495e8e2e3ecb3161ec7ce0d8a6f", "url": "https://github.com/ls1intum/Artemis/commit/cc5825d1a692c495e8e2e3ecb3161ec7ce0d8a6f", "message": "Merge branch 'develop' into bugfix/remove-unnecessary-restcall", "committedDate": "2020-05-01T12:26:17Z", "type": "commit"}]}