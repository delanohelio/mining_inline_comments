{"pr_number": 2520, "pr_title": "[Bugfix] Grading Configuration sum of test case weights 0", "pr_createdAt": "2020-12-08T18:03:22Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2520", "timeline": [{"oid": "993c378695e9d6b108a89157e1225f2113d37353", "url": "https://github.com/ls1intum/Artemis/commit/993c378695e9d6b108a89157e1225f2113d37353", "message": "throw error when the sum of all test case weights are <= 0", "committedDate": "2020-12-08T12:42:20Z", "type": "commit"}, {"oid": "07a9813c390e90db18e9d55761455faa3eb749c0", "url": "https://github.com/ls1intum/Artemis/commit/07a9813c390e90db18e9d55761455faa3eb749c0", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into bugfix/programming-exercises/grading-configuration", "committedDate": "2020-12-08T17:43:16Z", "type": "commit"}, {"oid": "0a693495218e6246cf0a7321b90869a50de36c7b", "url": "https://github.com/ls1intum/Artemis/commit/0a693495218e6246cf0a7321b90869a50de36c7b", "message": "fix check as it was on the wrong place", "committedDate": "2020-12-08T19:13:44Z", "type": "commit"}, {"oid": "aac10cc8bf69e3142075ad0acd18bf627d129b97", "url": "https://github.com/ls1intum/Artemis/commit/aac10cc8bf69e3142075ad0acd18bf627d129b97", "message": "add check also on client to", "committedDate": "2020-12-08T20:09:44Z", "type": "commit"}, {"oid": "43eb3120d16db784dfae7d627b6cc3f17b74fc08", "url": "https://github.com/ls1intum/Artemis/commit/43eb3120d16db784dfae7d627b6cc3f17b74fc08", "message": "add server test", "committedDate": "2020-12-08T20:26:01Z", "type": "commit"}, {"oid": "a0865e6f99dc264f7369c287184506697ace33c1", "url": "https://github.com/ls1intum/Artemis/commit/a0865e6f99dc264f7369c287184506697ace33c1", "message": "add client test", "committedDate": "2020-12-09T01:33:39Z", "type": "commit"}, {"oid": "36b5159773f3461bf62dc65a41d79e5b596e119d", "url": "https://github.com/ls1intum/Artemis/commit/36b5159773f3461bf62dc65a41d79e5b596e119d", "message": "Update src/test/javascript/spec/component/programming-exercise/programming-exercise-configure-grading.component.spec.ts", "committedDate": "2020-12-09T01:40:32Z", "type": "commit"}, {"oid": "2161943d20a84122092680b4d6dbfdb930b6bc10", "url": "https://github.com/ls1intum/Artemis/commit/2161943d20a84122092680b4d6dbfdb930b6bc10", "message": "Merge branch 'develop' into bugfix/programming-exercises/grading-configuration", "committedDate": "2020-12-09T12:30:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY3NzIxNg==", "url": "https://github.com/ls1intum/Artemis/pull/2520#discussion_r539677216", "bodyText": "Will getWeight ever return null? I think this method will fail in this case. I am asking because I think in the client you are testinf if weight is undefined", "author": "stefanwaldhauser", "createdAt": "2020-12-09T21:55:03Z", "path": "src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseTestCaseService.java", "diffHunk": "@@ -77,6 +78,13 @@ public ProgrammingExerciseTestCaseService(ProgrammingExerciseTestCaseRepository\n             matchingTestCase.setBonusPoints(programmingExerciseTestCaseDTO.getBonusPoints());\n             updatedTests.add(matchingTestCase);\n         }\n+\n+        // Make sure that at least one test has a weight so that students can still achieve 100% score\n+        var testWeightsSum = existingTestCases.stream().mapToDouble(ProgrammingExerciseTestCase::getWeight).sum();", "originalCommit": "2161943d20a84122092680b4d6dbfdb930b6bc10", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyOTc5Ng==", "url": "https://github.com/ls1intum/Artemis/pull/2520#discussion_r539729796", "bodyText": "Done in 2b46a47", "author": "fde312", "createdAt": "2020-12-09T23:38:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY3NzIxNg=="}], "type": "inlineReview", "revised_code": {"commit": "2b46a4701db95d63217508be78c3c679ff6949a9", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseTestCaseService.java b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseTestCaseService.java\nindex e8e89f669b..f40c1bd095 100644\n--- a/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseTestCaseService.java\n+++ b/src/main/java/de/tum/in/www1/artemis/service/ProgrammingExerciseTestCaseService.java\n\n@@ -80,7 +80,7 @@ public class ProgrammingExerciseTestCaseService {\n         }\n \n         // Make sure that at least one test has a weight so that students can still achieve 100% score\n-        var testWeightsSum = existingTestCases.stream().mapToDouble(ProgrammingExerciseTestCase::getWeight).sum();\n+        var testWeightsSum = existingTestCases.stream().mapToDouble(testCase -> Optional.ofNullable(testCase.getWeight()).orElse(0.0)).sum();\n         if (testWeightsSum <= 0) {\n             throw new BadRequestAlertException(\"The sum of all test case weights is 0 or below.\", \"TestCaseGrading\", \"weightSumError\");\n         }\n"}}, {"oid": "3f4cbadbc010fe6bab625bc358bf493311a90140", "url": "https://github.com/ls1intum/Artemis/commit/3f4cbadbc010fe6bab625bc358bf493311a90140", "message": "Merge branch 'develop' of https://github.com/ls1intum/Artemis into bugfix/programming-exercises/grading-configuration", "committedDate": "2020-12-09T22:53:57Z", "type": "commit"}, {"oid": "8177c86a2ee986a85ed7292b3d561cf31612195f", "url": "https://github.com/ls1intum/Artemis/commit/8177c86a2ee986a85ed7292b3d561cf31612195f", "message": "include feedback for client test", "committedDate": "2020-12-09T23:25:21Z", "type": "commit"}, {"oid": "2b46a4701db95d63217508be78c3c679ff6949a9", "url": "https://github.com/ls1intum/Artemis/commit/2b46a4701db95d63217508be78c3c679ff6949a9", "message": "add null check for getWeight", "committedDate": "2020-12-09T23:37:57Z", "type": "commit"}, {"oid": "16df0615c74e14d70ef51deefa16516b63483bd7", "url": "https://github.com/ls1intum/Artemis/commit/16df0615c74e14d70ef51deefa16516b63483bd7", "message": "integrate feedback for weight calculation on client", "committedDate": "2020-12-09T23:39:20Z", "type": "commit"}]}