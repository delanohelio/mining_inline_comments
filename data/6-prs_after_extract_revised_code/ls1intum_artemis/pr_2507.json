{"pr_number": 2507, "pr_title": "[Enhancement] multiple results for submissions in client", "pr_createdAt": "2020-12-06T17:57:53Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/2507", "timeline": [{"oid": "9dec8dafee60026806b4d490bcb161a97e0f0210", "url": "https://github.com/ls1intum/Artemis/commit/9dec8dafee60026806b4d490bcb161a97e0f0210", "message": "result \u2014> results\n\nalso add functions for getLatestResult and getLatestResult", "committedDate": "2020-12-04T13:52:22Z", "type": "commit"}, {"oid": "a7eb926c754135104f0b40331971cc3ac6628595", "url": "https://github.com/ls1intum/Artemis/commit/a7eb926c754135104f0b40331971cc3ac6628595", "message": "fixed first files", "committedDate": "2020-12-06T09:56:40Z", "type": "commit"}, {"oid": "365150e4972a9769764a6f58133027e50985c130", "url": "https://github.com/ls1intum/Artemis/commit/365150e4972a9769764a6f58133027e50985c130", "message": "fixed some more tests, added testing check function", "committedDate": "2020-12-06T11:15:09Z", "type": "commit"}, {"oid": "7c4eabb7ebaccc9bbedaff2d6995e7197e381d3c", "url": "https://github.com/ls1intum/Artemis/commit/7c4eabb7ebaccc9bbedaff2d6995e7197e381d3c", "message": "fixed some more errors", "committedDate": "2020-12-06T11:49:31Z", "type": "commit"}, {"oid": "4575306e05490ff40f59bb09f139c8f3d4da9dc6", "url": "https://github.com/ls1intum/Artemis/commit/4575306e05490ff40f59bb09f139c8f3d4da9dc6", "message": "fixed some more errors", "committedDate": "2020-12-06T11:56:40Z", "type": "commit"}, {"oid": "8fba7acdcda5f6aa5532e5fc6937d2f09770f120", "url": "https://github.com/ls1intum/Artemis/commit/8fba7acdcda5f6aa5532e5fc6937d2f09770f120", "message": "fixed errors in spec file", "committedDate": "2020-12-06T12:23:43Z", "type": "commit"}, {"oid": "03b5a91f9bfae7776b635996834cdd37a6e34ec2", "url": "https://github.com/ls1intum/Artemis/commit/03b5a91f9bfae7776b635996834cdd37a6e34ec2", "message": "fixed errors in spec files", "committedDate": "2020-12-06T12:33:54Z", "type": "commit"}, {"oid": "d158a8fd3a221fc40598ee1cec744683f2bbe22c", "url": "https://github.com/ls1intum/Artemis/commit/d158a8fd3a221fc40598ee1cec744683f2bbe22c", "message": "fixed errors in spec files", "committedDate": "2020-12-06T12:46:26Z", "type": "commit"}, {"oid": "fbab381ab9ebecdc08c886ed3677aefa8522ab12", "url": "https://github.com/ls1intum/Artemis/commit/fbab381ab9ebecdc08c886ed3677aefa8522ab12", "message": "first try at fixed occurrences of submission.result", "committedDate": "2020-12-06T12:46:37Z", "type": "commit"}, {"oid": "2fdcbbdbfd8721abb5b34e3ef0be2c8c5f166c16", "url": "https://github.com/ls1intum/Artemis/commit/2fdcbbdbfd8721abb5b34e3ef0be2c8c5f166c16", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client", "committedDate": "2020-12-06T12:46:58Z", "type": "commit"}, {"oid": "1ee22031e26821868b04d7a8dbe06d2adae81c9a", "url": "https://github.com/ls1intum/Artemis/commit/1ee22031e26821868b04d7a8dbe06d2adae81c9a", "message": "fixed spec tests", "committedDate": "2020-12-06T13:02:26Z", "type": "commit"}, {"oid": "edde474f0ebe9a73047c7706f7dcc7a5a8785e49", "url": "https://github.com/ls1intum/Artemis/commit/edde474f0ebe9a73047c7706f7dcc7a5a8785e49", "message": "fixed bad condition in checkForResultsLength()", "committedDate": "2020-12-06T13:09:36Z", "type": "commit"}, {"oid": "0ae8ff5944940cb6c24967f607a871155e883916", "url": "https://github.com/ls1intum/Artemis/commit/0ae8ff5944940cb6c24967f607a871155e883916", "message": "typo", "committedDate": "2020-12-06T13:11:14Z", "type": "commit"}, {"oid": "51bee81bc076fb131cd4d8de4328dd8173e50201", "url": "https://github.com/ls1intum/Artemis/commit/51bee81bc076fb131cd4d8de4328dd8173e50201", "message": "fixed spec test", "committedDate": "2020-12-06T13:46:28Z", "type": "commit"}, {"oid": "640dead070589345a3645b68706b13c4736862f1", "url": "https://github.com/ls1intum/Artemis/commit/640dead070589345a3645b68706b13c4736862f1", "message": "Revert \"fixed some more errors\"\n\nThis reverts commit 4575306e05490ff40f59bb09f139c8f3d4da9dc6.", "committedDate": "2020-12-06T18:37:56Z", "type": "commit"}, {"oid": "40707ce32c1c4f2e12f824aa96f7bac10f978633", "url": "https://github.com/ls1intum/Artemis/commit/40707ce32c1c4f2e12f824aa96f7bac10f978633", "message": "put changes back", "committedDate": "2020-12-06T18:43:13Z", "type": "commit"}, {"oid": "34767e6f13a9bbc0bcfa185058f4b75e48269b2e", "url": "https://github.com/ls1intum/Artemis/commit/34767e6f13a9bbc0bcfa185058f4b75e48269b2e", "message": "fixed last failing test in modeling-assessment-editor", "committedDate": "2020-12-06T20:06:47Z", "type": "commit"}, {"oid": "cf8db352966de339edc60ac550fde4fa9538e019", "url": "https://github.com/ls1intum/Artemis/commit/cf8db352966de339edc60ac550fde4fa9538e019", "message": "changes to meet client code style guidlines", "committedDate": "2020-12-06T20:54:32Z", "type": "commit"}, {"oid": "86376bcb5bc53e40b20b9cfca2dbac11f894fac1", "url": "https://github.com/ls1intum/Artemis/commit/86376bcb5bc53e40b20b9cfca2dbac11f894fac1", "message": "Fix html issues by importing function to component", "committedDate": "2020-12-06T21:01:44Z", "type": "commit"}, {"oid": "f98ba4737712820021b999e910f6d06971e1389a", "url": "https://github.com/ls1intum/Artemis/commit/f98ba4737712820021b999e910f6d06971e1389a", "message": "added missing import", "committedDate": "2020-12-06T21:09:46Z", "type": "commit"}, {"oid": "9af55970679344ca9adf963d0872147cb504dbce", "url": "https://github.com/ls1intum/Artemis/commit/9af55970679344ca9adf963d0872147cb504dbce", "message": "fixed errors in html files", "committedDate": "2020-12-06T21:42:57Z", "type": "commit"}, {"oid": "428a22a3d37a8644a4323c96215dda05dede4a81", "url": "https://github.com/ls1intum/Artemis/commit/428a22a3d37a8644a4323c96215dda05dede4a81", "message": "fixed warning", "committedDate": "2020-12-06T21:43:32Z", "type": "commit"}, {"oid": "1674b2bfa71da77c782f28d9a0337f49df46fc6c", "url": "https://github.com/ls1intum/Artemis/commit/1674b2bfa71da77c782f28d9a0337f49df46fc6c", "message": "tried fixing build issues", "committedDate": "2020-12-06T22:15:31Z", "type": "commit"}, {"oid": "d559a1816231e5a7b33264b5c39c3f01e061a53f", "url": "https://github.com/ls1intum/Artemis/commit/d559a1816231e5a7b33264b5c39c3f01e061a53f", "message": "fixed last errors in html files", "committedDate": "2020-12-06T22:32:47Z", "type": "commit"}, {"oid": "d40f85febb98261ab43bba0ea3b526316c2d30d7", "url": "https://github.com/ls1intum/Artemis/commit/d40f85febb98261ab43bba0ea3b526316c2d30d7", "message": "Revert \"fixed last errors in html files\"\n\nThis reverts commit d559a181", "committedDate": "2020-12-06T22:34:23Z", "type": "commit"}, {"oid": "068d4de4fa37ce1c44086eb83a0c1c68ddc3e226", "url": "https://github.com/ls1intum/Artemis/commit/068d4de4fa37ce1c44086eb83a0c1c68ddc3e226", "message": "changed JSON handling in Submission.java, and refactored getResult() to getLatestResult()", "committedDate": "2020-12-08T01:01:19Z", "type": "commit"}, {"oid": "e4f4667f6f14b128dd850d7b05aa9a45755748dc", "url": "https://github.com/ls1intum/Artemis/commit/e4f4667f6f14b128dd850d7b05aa9a45755748dc", "message": "changed JSON handling, to fix deserialization errors", "committedDate": "2020-12-08T08:05:23Z", "type": "commit"}, {"oid": "ffe577edce65ae0662074b49e1482873ed7e96d5", "url": "https://github.com/ls1intum/Artemis/commit/ffe577edce65ae0662074b49e1482873ed7e96d5", "message": "fixed test fails because of missing 's' in result(s)", "committedDate": "2020-12-08T10:27:30Z", "type": "commit"}, {"oid": "9eb65f4332f31736510c204315a058947fac4abf", "url": "https://github.com/ls1intum/Artemis/commit/9eb65f4332f31736510c204315a058947fac4abf", "message": "refactored setResult(s) Methods", "committedDate": "2020-12-08T16:29:25Z", "type": "commit"}, {"oid": "761327180af3f764fce2cc6b89d6e5875930bb0d", "url": "https://github.com/ls1intum/Artemis/commit/761327180af3f764fce2cc6b89d6e5875930bb0d", "message": "refactored setResult to replaceLatestOrIfEmptyAddResult", "committedDate": "2020-12-08T17:24:16Z", "type": "commit"}, {"oid": "063bd8a967ca4a83575c7c5ed307ba06b0ba4429", "url": "https://github.com/ls1intum/Artemis/commit/063bd8a967ca4a83575c7c5ed307ba06b0ba4429", "message": "fixed client issues with relations via method setLatestResultMethod", "committedDate": "2020-12-08T18:43:08Z", "type": "commit"}, {"oid": "d74f49716e468b2e43442094d34ece94698694c3", "url": "https://github.com/ls1intum/Artemis/commit/d74f49716e468b2e43442094d34ece94698694c3", "message": "added some documentation about function use, fixed inconsistencies", "committedDate": "2020-12-08T22:56:52Z", "type": "commit"}, {"oid": "db386a68561aa554e691063c5ecd49dbb476a3e1", "url": "https://github.com/ls1intum/Artemis/commit/db386a68561aa554e691063c5ecd49dbb476a3e1", "message": "fixed some javadocs", "committedDate": "2020-12-09T07:52:48Z", "type": "commit"}, {"oid": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "url": "https://github.com/ls1intum/Artemis/commit/0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "message": "Merge branch 'develop' into feature/multiple-results-client", "committedDate": "2020-12-09T10:14:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMwOTE0Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539309147", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)", "author": "fde312", "createdAt": "2020-12-09T13:33:54Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)", "originalCommit": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d19f39ff648296564ec8aeeee402b517f45b04b1", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex eff0696aad..36a3638476 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -138,7 +138,6 @@ public abstract class Submission extends DomainObject {\n      *\n      * @param result\n      */\n-    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n     public void replaceLatestOrIfEmptyAddResult(Result result) {\n         if (this.results == null) {\n             this.results = new ArrayList<>();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMxMTc0Nw==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539311747", "bodyText": "I think something is odd in this method. I am not seeing where you are adding the result for the case when this.results == null", "author": "fde312", "createdAt": "2020-12-09T13:37:29Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void replaceLatestOrIfEmptyAddResult(Result result) {", "originalCommit": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMzOTc2Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539339762", "bodyText": "Yes, that's true, thanks for noticing. As it turns out the case this.results == null never occurs. (Or so far it should never occur) I'll remove it.", "author": "SimonEntholzer", "createdAt": "2020-12-09T14:14:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMxMTc0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "d19f39ff648296564ec8aeeee402b517f45b04b1", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex eff0696aad..36a3638476 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -138,7 +138,6 @@ public abstract class Submission extends DomainObject {\n      *\n      * @param result\n      */\n-    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n     public void replaceLatestOrIfEmptyAddResult(Result result) {\n         if (this.results == null) {\n             this.results = new ArrayList<>();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMDY5MA==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539320690", "bodyText": "I am not quire sure what is happening here. As far as I know we only have one result at the moment, therefore this would remove the last result (the one result at the moment) and then add the same result back, right? Or am I misunderstanding here something?", "author": "fde312", "createdAt": "2020-12-09T13:49:31Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void replaceLatestOrIfEmptyAddResult(Result result) {\n+        if (this.results == null) {\n             this.results = new ArrayList<>();\n         }\n+        else if (!this.results.isEmpty()) {\n+            results.set(results.size() - 1, result);", "originalCommit": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM1NDU3Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539354572", "bodyText": "It removes the last result, but the result passed to the method isn't the same result. So, a different result is set to the results list.", "author": "SimonEntholzer", "createdAt": "2020-12-09T14:32:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMDY5MA=="}], "type": "inlineReview", "revised_code": {"commit": "d19f39ff648296564ec8aeeee402b517f45b04b1", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex eff0696aad..36a3638476 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -138,7 +138,6 @@ public abstract class Submission extends DomainObject {\n      *\n      * @param result\n      */\n-    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n     public void replaceLatestOrIfEmptyAddResult(Result result) {\n         if (this.results == null) {\n             this.results = new ArrayList<>();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMTY3Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539321672", "bodyText": "I think that we should not delete any result at all except for special reasons", "author": "fde312", "createdAt": "2020-12-09T13:50:55Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,29 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n+    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void replaceLatestOrIfEmptyAddResult(Result result) {\n+        if (this.results == null) {\n             this.results = new ArrayList<>();\n         }\n+        else if (!this.results.isEmpty()) {\n+            results.set(results.size() - 1, result);\n+            // TODO: Make sure the deletion is saved in the database too (SE, NR)", "originalCommit": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTM1NTE4OA==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539355188", "bodyText": "We still should make sure that the deletion is also propagated to the database. We should write a test for that probably.", "author": "SimonEntholzer", "createdAt": "2020-12-09T14:33:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMTY3Mg=="}], "type": "inlineReview", "revised_code": {"commit": "d19f39ff648296564ec8aeeee402b517f45b04b1", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex eff0696aad..36a3638476 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -138,7 +138,6 @@ public abstract class Submission extends DomainObject {\n      *\n      * @param result\n      */\n-    // @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n     public void replaceLatestOrIfEmptyAddResult(Result result) {\n         if (this.results == null) {\n             this.results = new ArrayList<>();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMzc0OA==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539323748", "bodyText": "this returns the result with the highest Id right?", "author": "fde312", "createdAt": "2020-12-09T13:53:43Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -96,15 +96,14 @@ public Long getDurationInMinutes() {\n         return Duration.between(initilizationDate, submissionDate).toMinutes();\n     }\n \n-    // TODO Ruscher, Entholzer: Refactor to getLatestResult\n     /**\n      * Is used as a workaround for objects that expect submission to have 1 result\n      *\n      * @return the latest result\n      */\n     @Nullable\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.READ_ONLY)\n-    public Result getResult() {\n+    @JsonIgnore\n+    public Result getLatestResult() {", "originalCommit": "0610ea45db116c7c60ee831b29c81c1b8b6af9e3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY1MzUxMw==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539653513", "bodyText": "Technically \"latest\" means the newest result? It might be great to add that information in the comment above", "author": "ivanchimeno", "createdAt": "2020-12-09T21:16:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMzc0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDAwNjg3Mw==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r540006873", "bodyText": "We do not order the results by ID, we have a specific order_column which is handled by hibernate only. But yes, the latest result means the newest result", "author": "anditurdiu", "createdAt": "2020-12-10T09:25:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTMyMzc0OA=="}], "type": "inlineReview", "revised_code": {"commit": "497fb3098b6693b7c6a469c41d9c3d5945e838db", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex eff0696aad..7f0f212a9d 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -99,7 +99,7 @@ public abstract class Submission extends DomainObject {\n     /**\n      * Is used as a workaround for objects that expect submission to have 1 result\n      *\n-     * @return the latest result\n+     * @return the latest i.e newest result\n      */\n     @Nullable\n     @JsonIgnore\n"}}, {"oid": "d19f39ff648296564ec8aeeee402b517f45b04b1", "url": "https://github.com/ls1intum/Artemis/commit/d19f39ff648296564ec8aeeee402b517f45b04b1", "message": "Update src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\nCo-authored-by: Francisco De las Casas Young <41108487+fde312@users.noreply.github.com>", "committedDate": "2020-12-09T14:00:31Z", "type": "commit"}, {"oid": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92", "url": "https://github.com/ls1intum/Artemis/commit/6cc599e5bfaf04c2b194b48ea71030c92cca4c92", "message": "fixed replaceLatestOrIfEmptyAddResult to be easier understandable", "committedDate": "2020-12-09T14:20:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY1MjY1MQ==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r539652651", "bodyText": "Should the comment be removed since you renamed the ignored property?", "author": "ivanchimeno", "createdAt": "2020-12-09T21:14:59Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Result.java", "diffHunk": "@@ -79,7 +79,7 @@\n     @ManyToOne(fetch = FetchType.LAZY)\n     @JsonView(QuizView.Before.class)\n     // TODO: rename ignored property to \"results\" after change in client", "originalCommit": "6cc599e5bfaf04c2b194b48ea71030c92cca4c92", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDgzMjM4Ng==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r540832386", "bodyText": "Yes, we removed it", "author": "SimonEntholzer", "createdAt": "2020-12-11T10:06:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTY1MjY1MQ=="}], "type": "inlineReview", "revised_code": {"commit": "497fb3098b6693b7c6a469c41d9c3d5945e838db", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Result.java b/src/main/java/de/tum/in/www1/artemis/domain/Result.java\nindex fab9c496bf..c40d2c012f 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Result.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Result.java\n\n@@ -78,7 +78,6 @@ public class Result extends DomainObject {\n \n     @ManyToOne(fetch = FetchType.LAZY)\n     @JsonView(QuizView.Before.class)\n-    // TODO: rename ignored property to \"results\" after change in client\n     @JsonIgnoreProperties({ \"results\", \"participation\" })\n     private Submission submission;\n \n"}}, {"oid": "48977a51f79a869997fcad85a664c22b2be9c8d9", "url": "https://github.com/ls1intum/Artemis/commit/48977a51f79a869997fcad85a664c22b2be9c8d9", "message": "refactored and cleaned up use of getLatestSubmissionResult()", "committedDate": "2020-12-09T21:27:36Z", "type": "commit"}, {"oid": "497fb3098b6693b7c6a469c41d9c3d5945e838db", "url": "https://github.com/ls1intum/Artemis/commit/497fb3098b6693b7c6a469c41d9c3d5945e838db", "message": "small fix", "committedDate": "2020-12-10T08:38:53Z", "type": "commit"}, {"oid": "aeb0945e150b3afb4bf64ad676954e0d681ceabf", "url": "https://github.com/ls1intum/Artemis/commit/aeb0945e150b3afb4bf64ad676954e0d681ceabf", "message": "reset renaming of setResults()", "committedDate": "2020-12-10T09:02:54Z", "type": "commit"}, {"oid": "bf74343639064b67f5ca967cf3f5e7245de804b3", "url": "https://github.com/ls1intum/Artemis/commit/bf74343639064b67f5ca967cf3f5e7245de804b3", "message": "re-refactored replaceLatestOrIfEmptyAddResult to addResult", "committedDate": "2020-12-10T13:01:45Z", "type": "commit"}, {"oid": "9d4020b4fb47efe8600458d79645809507cfb80f", "url": "https://github.com/ls1intum/Artemis/commit/9d4020b4fb47efe8600458d79645809507cfb80f", "message": "refactored methods which didnt refactor automatically", "committedDate": "2020-12-10T20:53:04Z", "type": "commit"}, {"oid": "4c9f2e2521c047ad8320f68b9c36b2d0a396df51", "url": "https://github.com/ls1intum/Artemis/commit/4c9f2e2521c047ad8320f68b9c36b2d0a396df51", "message": "removed a redundant second submission.addResult in DatabaseUtilService", "committedDate": "2020-12-11T01:09:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg1NDc4Mg==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r540854782", "bodyText": "It looks like this is mostly/only used for clearing results. Wouldn't it make more sense to add a dedicated clear method? (This way we also don't allocate a new ArrayList each time we just want to throw the old results away.)", "author": "FrankeLukas", "createdAt": "2020-12-11T10:42:34Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -128,33 +133,19 @@ public Result getFirstResult() {\n         return null;\n     }\n \n-    // TODO NR, SE: remove redundant setter after relationship change on client. Currently we need two deserializing setters for \"result\" (client) and \"results\" (server)\n-    @JsonProperty(value = \"result\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResult(Result result) {\n-        this.setResults(result);\n-    }\n-\n-    // TODO Ruscher, Entholzer: refactor to addResult\n     /**\n-     * custom setter that supports the migration from 1...1 to 1...* in the submission->result(s) relationship\n-     * Will be refactore in the future\n-     * @param result the result that should be added, in case this is null, an empty list will be used instead\n+     * Used as a setResult method, as typically the latest result is used\n+     *\n+     * @param result\n      */\n-    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n-    public void setResults(Result result) {\n-        if (result == null) {\n-            // clear the list of results\n-            this.results = new ArrayList<>();\n-        }\n-        else {\n-            // addResult\n-            this.results.add(result);\n-        }\n+    public void addResult(Result result) {\n+        this.results.add(result);\n+        // At the moment only one result in results is allowed\n+        assert results.size() < 2;\n     }\n \n-    // TODO Ruscher, Entholzer: refactor to setResults\n-    @JsonIgnore()\n-    public void setResultsList(List<Result> results) {\n+    @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n+    public void setResults(List<Result> results) {", "originalCommit": "4c9f2e2521c047ad8320f68b9c36b2d0a396df51", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEyNTA2MA==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r541125060", "bodyText": "Yes for now its only used for that, but the method will be used for the upcoming multi correction feature, therefore we should keep the name for now.", "author": "nicolasruscher", "createdAt": "2020-12-11T17:55:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg1NDc4Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTE0MzY2OA==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r541143668", "bodyText": "I was more trying to suggest creating a new method which is just used for clearing. Or will clearing get obsolete once we have multi correction?", "author": "FrankeLukas", "createdAt": "2020-12-11T18:27:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDg1NDc4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "61e00e3342d93f03a0f01e48f40f3c4380742009", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex 371cf41ecf..b3b9a14c5b 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -141,7 +142,10 @@ public abstract class Submission extends DomainObject {\n     public void addResult(Result result) {\n         this.results.add(result);\n         // At the moment only one result in results is allowed\n-        assert results.size() < 2;\n+        // TODO remove when multi-correction is implemented!\n+        if (results.size() < 2) {\n+            throw new InternalServerErrorException(\"Sbmission.addResult(result): results.size() > 1 | the Submission.results list should not contain more than one element\");\n+        }\n     }\n \n     @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n"}}, {"oid": "c3cd8f73db26279c04c84573686095bf7d2059f9", "url": "https://github.com/ls1intum/Artemis/commit/c3cd8f73db26279c04c84573686095bf7d2059f9", "message": "Started refactoring of functions calls to getLatestSubmissionResult -> local property latestResultsBySubmissionMap", "committedDate": "2020-12-11T12:16:36Z", "type": "commit"}, {"oid": "07116d3076c4e54a8274cc903974daa7d5ab1dbd", "url": "https://github.com/ls1intum/Artemis/commit/07116d3076c4e54a8274cc903974daa7d5ab1dbd", "message": "fixed ExamQuizService, removed adding of a second result to a submission", "committedDate": "2020-12-11T12:42:21Z", "type": "commit"}, {"oid": "b7912a787582bf5e678710f0615439dc66900c19", "url": "https://github.com/ls1intum/Artemis/commit/b7912a787582bf5e678710f0615439dc66900c19", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client", "committedDate": "2020-12-11T12:43:53Z", "type": "commit"}, {"oid": "146615f4e02d06308b1fe87b53036853797281bf", "url": "https://github.com/ls1intum/Artemis/commit/146615f4e02d06308b1fe87b53036853797281bf", "message": "fixed wrong test", "committedDate": "2020-12-11T13:00:13Z", "type": "commit"}, {"oid": "6665dc5be697ea05c98a789800332cf4ac6a7a06", "url": "https://github.com/ls1intum/Artemis/commit/6665dc5be697ea05c98a789800332cf4ac6a7a06", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client", "committedDate": "2020-12-11T13:08:54Z", "type": "commit"}, {"oid": "484efdf8404ddf044cd1a6bb187b5cb19cc11279", "url": "https://github.com/ls1intum/Artemis/commit/484efdf8404ddf044cd1a6bb187b5cb19cc11279", "message": "Revert \"Started refactoring of functions calls to getLatestSubmissionResult -> local property latestResultsBySubmissionMap\"\n\nThis reverts commit c3cd8f73", "committedDate": "2020-12-11T13:59:24Z", "type": "commit"}, {"oid": "08642639dac984a58e9c5197ba91b6c57b800f60", "url": "https://github.com/ls1intum/Artemis/commit/08642639dac984a58e9c5197ba91b6c57b800f60", "message": "Merge branch 'develop' into feature/multiple-results-client", "committedDate": "2020-12-11T14:11:11Z", "type": "commit"}, {"oid": "8c85ec83e3e6dc80451c09b93cd7b9d5b4d736be", "url": "https://github.com/ls1intum/Artemis/commit/8c85ec83e3e6dc80451c09b93cd7b9d5b4d736be", "message": "Merge branch 'feature/multiple-results-client' of https://github.com/ls1intum/Artemis into feature/multiple-results-client", "committedDate": "2020-12-11T14:16:32Z", "type": "commit"}, {"oid": "7654dfaaf480b30a339c94684742e95fa994bfd6", "url": "https://github.com/ls1intum/Artemis/commit/7654dfaaf480b30a339c94684742e95fa994bfd6", "message": "fixed missing local function for getLatestSubmissionResult", "committedDate": "2020-12-11T14:48:31Z", "type": "commit"}, {"oid": "91f58a53f31e88139bad4be001cbc7f33fcebc01", "url": "https://github.com/ls1intum/Artemis/commit/91f58a53f31e88139bad4be001cbc7f33fcebc01", "message": "removed private from local function declaration", "committedDate": "2020-12-11T14:52:08Z", "type": "commit"}, {"oid": "61eac52225fd2d62b41a640c3df8da3aea7f41f6", "url": "https://github.com/ls1intum/Artemis/commit/61eac52225fd2d62b41a640c3df8da3aea7f41f6", "message": "small fix", "committedDate": "2020-12-11T15:02:54Z", "type": "commit"}, {"oid": "c6a1d84900e793a1689c8879d6601acd5a529cd7", "url": "https://github.com/ls1intum/Artemis/commit/c6a1d84900e793a1689c8879d6601acd5a529cd7", "message": "Merge branch 'develop' into feature/multiple-results-client", "committedDate": "2020-12-11T16:42:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEwOTgwOQ==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r541109809", "bodyText": "I have never seen this in production java code before. I also found this online. Could you maybe throw a normal Exception here? Or is there a specific reason you used assert here that I miss.\nhttps://en.wikibooks.org/wiki/Java_Programming/Keywords/assert#:~:text=assert%20is%20a%20Java%20keyword,runtime%20system%20throws%20an%20AssertionError%20.\nAssertions are usually used as a debugging aid. They should not be used instead of validating arguments to public methods, or in place of a more precise runtime error exception.", "author": "stefanwaldhauser", "createdAt": "2020-12-11T17:30:21Z", "path": "src/main/java/de/tum/in/www1/artemis/domain/Submission.java", "diffHunk": "@@ -138,13 +138,9 @@ public Result getFirstResult() {\n      *\n      * @param result\n      */\n-    public void replaceLatestOrIfEmptyAddResult(Result result) {\n-        if (this.results.isEmpty()) {\n-            this.results.add(result);\n-        }\n-        else {\n-            results.set(results.size() - 1, result);\n-        }\n+    public void addResult(Result result) {\n+        this.results.add(result);\n+        // At the moment only one result in results is allowed\n         assert results.size() < 2;", "originalCommit": "c6a1d84900e793a1689c8879d6601acd5a529cd7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTExOTYxMA==", "url": "https://github.com/ls1intum/Artemis/pull/2507#discussion_r541119610", "bodyText": "We changed it to throw an Exception. This check will be removed later, as with second corrections enabled we will need longer Submission.results lists.", "author": "SimonEntholzer", "createdAt": "2020-12-11T17:46:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEwOTgwOQ=="}], "type": "inlineReview", "revised_code": {"commit": "61e00e3342d93f03a0f01e48f40f3c4380742009", "chunk": "diff --git a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\nindex 371cf41ecf..b3b9a14c5b 100644\n--- a/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n+++ b/src/main/java/de/tum/in/www1/artemis/domain/Submission.java\n\n@@ -141,7 +142,10 @@ public abstract class Submission extends DomainObject {\n     public void addResult(Result result) {\n         this.results.add(result);\n         // At the moment only one result in results is allowed\n-        assert results.size() < 2;\n+        // TODO remove when multi-correction is implemented!\n+        if (results.size() < 2) {\n+            throw new InternalServerErrorException(\"Sbmission.addResult(result): results.size() > 1 | the Submission.results list should not contain more than one element\");\n+        }\n     }\n \n     @JsonProperty(value = \"results\", access = JsonProperty.Access.WRITE_ONLY)\n"}}, {"oid": "94c2f88ed5d080165277340ce26c78776839387e", "url": "https://github.com/ls1intum/Artemis/commit/94c2f88ed5d080165277340ce26c78776839387e", "message": "changed result to manual result in ProgrammingAssessmentIntegrationTest to fix build fail", "committedDate": "2020-12-11T17:37:15Z", "type": "commit"}, {"oid": "61e00e3342d93f03a0f01e48f40f3c4380742009", "url": "https://github.com/ls1intum/Artemis/commit/61e00e3342d93f03a0f01e48f40f3c4380742009", "message": "changed assert to Exception", "committedDate": "2020-12-11T17:45:03Z", "type": "commit"}, {"oid": "7c5f9ebcf4e45a50a7f97a2e6a9f67400bf16c2f", "url": "https://github.com/ls1intum/Artemis/commit/7c5f9ebcf4e45a50a7f97a2e6a9f67400bf16c2f", "message": "fixed Exception mistake", "committedDate": "2020-12-11T18:19:32Z", "type": "commit"}]}