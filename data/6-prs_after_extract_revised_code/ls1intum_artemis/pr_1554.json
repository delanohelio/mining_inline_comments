{"pr_number": 1554, "pr_title": "Integrationtest CourseResource: Improvement of testcoverage", "pr_createdAt": "2020-06-02T16:52:49Z", "pr_url": "https://github.com/ls1intum/Artemis/pull/1554", "timeline": [{"oid": "cf13e81efb531edf37ace70fd96aff3be6aaecbd", "url": "https://github.com/ls1intum/Artemis/commit/cf13e81efb531edf37ace70fd96aff3be6aaecbd", "message": "added test testCreateCourseWithSameShortName", "committedDate": "2020-06-01T16:02:38Z", "type": "commit"}, {"oid": "0ea5d09f48a7c86778e21b73206be714d82c5855", "url": "https://github.com/ls1intum/Artemis/commit/0ea5d09f48a7c86778e21b73206be714d82c5855", "message": "added test testCreateCourseWithCustomNonExistingGroupNames", "committedDate": "2020-06-01T16:59:25Z", "type": "commit"}, {"oid": "6ac20f560ee5b0254d854f2c0ea1bd65412dfb23", "url": "https://github.com/ls1intum/Artemis/commit/6ac20f560ee5b0254d854f2c0ea1bd65412dfb23", "message": "added testcases for testing the method validateComplaintsConfig", "committedDate": "2020-06-01T17:53:28Z", "type": "commit"}, {"oid": "494ddc43b447b3cf60b8983519e43a16bae8fbfa", "url": "https://github.com/ls1intum/Artemis/commit/494ddc43b447b3cf60b8983519e43a16bae8fbfa", "message": "added testcase for getCourseForDashboard", "committedDate": "2020-06-01T18:25:51Z", "type": "commit"}, {"oid": "877e5191168b72bbea54b23cdf04b6049fa9a140", "url": "https://github.com/ls1intum/Artemis/commit/877e5191168b72bbea54b23cdf04b6049fa9a140", "message": "added testcase for getAllCoursesWithUserStats", "committedDate": "2020-06-02T11:04:14Z", "type": "commit"}, {"oid": "b69a7ec985ca3bc2e1c333d29ca837cacc045d84", "url": "https://github.com/ls1intum/Artemis/commit/b69a7ec985ca3bc2e1c333d29ca837cacc045d84", "message": "updated the getCourseForDashboard testcase", "committedDate": "2020-06-02T11:34:48Z", "type": "commit"}, {"oid": "8d9c071c198aad2bffc5992f0a26a3797d9f6ce9", "url": "https://github.com/ls1intum/Artemis/commit/8d9c071c198aad2bffc5992f0a26a3797d9f6ce9", "message": "adjusted testAddStudentOrTutorOrInstructorToCourse(), testAddStudentOrTutorOrInstructorToCourse() and added testAddStudentOrTutorOrInstructorToCourse_WithNonExistingUser", "committedDate": "2020-06-02T12:39:11Z", "type": "commit"}, {"oid": "61cf7c4c64999637c9da589a2dd3b2be6133a94a", "url": "https://github.com/ls1intum/Artemis/commit/61cf7c4c64999637c9da589a2dd3b2be6133a94a", "message": "adjusted testRemoveStudentOrTutorOrInstructorFromCourse_AsInstructorOfOtherCourse_forbidden", "committedDate": "2020-06-02T13:12:45Z", "type": "commit"}, {"oid": "94164a61eee284fe5649cd2ee5f89af1a4ca2617", "url": "https://github.com/ls1intum/Artemis/commit/94164a61eee284fe5649cd2ee5f89af1a4ca2617", "message": "added testRemoveStudentOrTutorOrInstructorFromCourse_WithNonExistingUser", "committedDate": "2020-06-02T13:37:33Z", "type": "commit"}, {"oid": "f3d17335fe2660df51209a0c63d6ca585d171b65", "url": "https://github.com/ls1intum/Artemis/commit/f3d17335fe2660df51209a0c63d6ca585d171b65", "message": "adjusted testRemoveStudentOrTutorOrInstructorFromCourse and testRemoveStudentOrTutorOrInstructorFromCourse_forbidden", "committedDate": "2020-06-02T15:23:41Z", "type": "commit"}, {"oid": "8d9b061d2d131d2c1a06fea85a7f4e268b559cc4", "url": "https://github.com/ls1intum/Artemis/commit/8d9b061d2d131d2c1a06fea85a7f4e268b559cc4", "message": "updated testcase names", "committedDate": "2020-06-02T17:01:47Z", "type": "commit"}, {"oid": "73daa3dbbff129cc8a8080af8a646e49f73f8fea", "url": "https://github.com/ls1intum/Artemis/commit/73daa3dbbff129cc8a8080af8a646e49f73f8fea", "message": "merged two testcases into one", "committedDate": "2020-06-02T17:05:57Z", "type": "commit"}, {"oid": "6b0f98fb87af66610e0732ea5b7acfaacaba5e5b", "url": "https://github.com/ls1intum/Artemis/commit/6b0f98fb87af66610e0732ea5b7acfaacaba5e5b", "message": "Merge branch 'develop' into IntegrationTest/CourseResource", "committedDate": "2020-06-02T17:27:55Z", "type": "commit"}, {"oid": "6ad78f236309f54f1c8d8df6a840561915245809", "url": "https://github.com/ls1intum/Artemis/commit/6ad78f236309f54f1c8d8df6a840561915245809", "message": "splitted one testcase into two", "committedDate": "2020-06-02T18:05:55Z", "type": "commit"}, {"oid": "9e3b8a9917a935469c712a0e7da4657faa752ad2", "url": "https://github.com/ls1intum/Artemis/commit/9e3b8a9917a935469c712a0e7da4657faa752ad2", "message": "Merge remote-tracking branch 'origin/IntegrationTest/CourseResource' into IntegrationTest/CourseResource", "committedDate": "2020-06-02T18:06:14Z", "type": "commit"}, {"oid": "74a05ab7256a4e22bb24ba4e4a39954cf1097747", "url": "https://github.com/ls1intum/Artemis/commit/74a05ab7256a4e22bb24ba4e4a39954cf1097747", "message": "Merge branch 'develop' into IntegrationTest/CourseResource", "committedDate": "2020-06-02T18:06:46Z", "type": "commit"}, {"oid": "778bdaa56db55cdaadbf59355665ddd30110db64", "url": "https://github.com/ls1intum/Artemis/commit/778bdaa56db55cdaadbf59355665ddd30110db64", "message": "added testcase testCreateCourseWithNegativeMaxTeamComplainNumber, fixed testCreateCourseWithModifiedMaxComplainTimeDaysAndMaxComplains\nand merged two test cases in one", "committedDate": "2020-06-02T18:31:17Z", "type": "commit"}, {"oid": "b72c0e7d4c3bd309852ad9c066bbe21be949824c", "url": "https://github.com/ls1intum/Artemis/commit/b72c0e7d4c3bd309852ad9c066bbe21be949824c", "message": "Merge remote-tracking branch 'origin/IntegrationTest/CourseResource' into IntegrationTest/CourseResource", "committedDate": "2020-06-02T18:31:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEwMTcyNA==", "url": "https://github.com/ls1intum/Artemis/pull/1554#discussion_r434101724", "bodyText": "If I'm correct, this tests if the old course still exists, but not of the new one does not exist.", "author": "sleiss", "createdAt": "2020-06-02T18:45:39Z", "path": "src/test/java/de/tum/in/www1/artemis/CourseIntegrationTest.java", "diffHunk": "@@ -124,6 +124,101 @@ public void testCreateCourseWithPermission() throws Exception {\n         assertThat(courseRepo.findAll()).as(\"Course has not been stored\").contains(repoContent.toArray(new Course[0]));\n     }\n \n+    @Test\n+    @WithMockUser(username = \"admin\", roles = \"ADMIN\")\n+    public void testCreateCourseWithSameShortName() throws Exception {\n+        Course course = ModelFactory.generateCourse(null, null, null, new HashSet<>());\n+        course.setShortName(\"shortName\");\n+        jiraRequestMockProvider.enableMockingOfRequests();\n+        jiraRequestMockProvider.mockCreateGroup(course.getDefaultStudentGroupName());\n+        jiraRequestMockProvider.mockCreateGroup(course.getDefaultTeachingAssistantGroupName());\n+        jiraRequestMockProvider.mockCreateGroup(course.getDefaultInstructorGroupName());\n+        request.post(\"/api/courses\", course, HttpStatus.CREATED);\n+        List<Course> repoContent = courseRepo.findAll();\n+        assertThat(repoContent.size()).as(\"Course got stored\").isEqualTo(1);\n+        course = ModelFactory.generateCourse(null, null, null, new HashSet<>());\n+        course.setShortName(\"shortName\");\n+        request.post(\"/api/courses\", course, HttpStatus.BAD_REQUEST);\n+        assertThat(courseRepo.findAll()).as(\"Course has not been stored\").contains(repoContent.toArray(new Course[0]));", "originalCommit": "b72c0e7d4c3bd309852ad9c066bbe21be949824c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDExMzQ4NQ==", "url": "https://github.com/ls1intum/Artemis/pull/1554#discussion_r434113485", "bodyText": "thank you for the review, i adjusted the test case", "author": "F4lka", "createdAt": "2020-06-02T19:06:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDEwMTcyNA=="}], "type": "inlineReview", "revised_code": {"commit": "6ec3f9051bc4d2cf285563f24c267982638e063f", "chunk": "diff --git a/src/test/java/de/tum/in/www1/artemis/CourseIntegrationTest.java b/src/test/java/de/tum/in/www1/artemis/CourseIntegrationTest.java\nindex 7e7a4879a..096e1a646 100644\n--- a/src/test/java/de/tum/in/www1/artemis/CourseIntegrationTest.java\n+++ b/src/test/java/de/tum/in/www1/artemis/CourseIntegrationTest.java\n\n@@ -127,19 +127,19 @@ public class CourseIntegrationTest extends AbstractSpringIntegrationBambooBitbuc\n     @Test\n     @WithMockUser(username = \"admin\", roles = \"ADMIN\")\n     public void testCreateCourseWithSameShortName() throws Exception {\n-        Course course = ModelFactory.generateCourse(null, null, null, new HashSet<>());\n-        course.setShortName(\"shortName\");\n+        Course course1 = ModelFactory.generateCourse(null, null, null, new HashSet<>());\n+        course1.setShortName(\"shortName\");\n         jiraRequestMockProvider.enableMockingOfRequests();\n-        jiraRequestMockProvider.mockCreateGroup(course.getDefaultStudentGroupName());\n-        jiraRequestMockProvider.mockCreateGroup(course.getDefaultTeachingAssistantGroupName());\n-        jiraRequestMockProvider.mockCreateGroup(course.getDefaultInstructorGroupName());\n-        request.post(\"/api/courses\", course, HttpStatus.CREATED);\n-        List<Course> repoContent = courseRepo.findAll();\n-        assertThat(repoContent.size()).as(\"Course got stored\").isEqualTo(1);\n-        course = ModelFactory.generateCourse(null, null, null, new HashSet<>());\n-        course.setShortName(\"shortName\");\n-        request.post(\"/api/courses\", course, HttpStatus.BAD_REQUEST);\n-        assertThat(courseRepo.findAll()).as(\"Course has not been stored\").contains(repoContent.toArray(new Course[0]));\n+        jiraRequestMockProvider.mockCreateGroup(course1.getDefaultStudentGroupName());\n+        jiraRequestMockProvider.mockCreateGroup(course1.getDefaultTeachingAssistantGroupName());\n+        jiraRequestMockProvider.mockCreateGroup(course1.getDefaultInstructorGroupName());\n+        request.post(\"/api/courses\", course1, HttpStatus.CREATED);\n+        assertThat(courseRepo.findAll().size()).as(\"Course got stored\").isEqualTo(1);\n+\n+        Course course2 = ModelFactory.generateCourse(null, null, null, new HashSet<>(), \"tumuser\", \"tutor\", \"instructor\");\n+        course2.setShortName(\"shortName\");\n+        request.post(\"/api/courses\", course2, HttpStatus.BAD_REQUEST);\n+        assertThat(courseRepo.findAll().size()).as(\"Course has not been stored\").isEqualTo(1);\n     }\n \n     @Test\n"}}, {"oid": "6ec3f9051bc4d2cf285563f24c267982638e063f", "url": "https://github.com/ls1intum/Artemis/commit/6ec3f9051bc4d2cf285563f24c267982638e063f", "message": "adjusted test case testCreateCourseWithSameShortName", "committedDate": "2020-06-02T19:04:40Z", "type": "commit"}, {"oid": "0266d6996cc27858abd55f1fbdca2b34bb2e6e7f", "url": "https://github.com/ls1intum/Artemis/commit/0266d6996cc27858abd55f1fbdca2b34bb2e6e7f", "message": "Merge branch 'develop' into IntegrationTest/CourseResource", "committedDate": "2020-06-02T20:07:14Z", "type": "commit"}]}