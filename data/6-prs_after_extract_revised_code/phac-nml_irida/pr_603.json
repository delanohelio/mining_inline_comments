{"pr_number": 603, "pr_title": "Generic sequencing runs", "pr_createdAt": "2020-02-19T20:10:10Z", "pr_url": "https://github.com/phac-nml/irida/pull/603", "timeline": [{"oid": "bae25e63db28d3575ebcfd235fd394cd15aba705", "url": "https://github.com/phac-nml/irida/commit/bae25e63db28d3575ebcfd235fd394cd15aba705", "message": "created a seq run object that can take any type", "committedDate": "2019-03-22T21:01:23Z", "type": "commit"}, {"oid": "8f59bfd5dc503699c11ae7a3a4d579f9f87f8a4c", "url": "https://github.com/phac-nml/irida/commit/8f59bfd5dc503699c11ae7a3a4d579f9f87f8a4c", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2019-04-02T20:04:06Z", "type": "commit"}, {"oid": "0be7b7f4e3f58285aaaa4893205c29b40423e88b", "url": "https://github.com/phac-nml/irida/commit/0be7b7f4e3f58285aaaa4893205c29b40423e88b", "message": "fixed runtype param", "committedDate": "2019-04-02T20:19:05Z", "type": "commit"}, {"oid": "fb1f3a4ce9d9d82d085f7ab18709d1e0b1fa8f8a", "url": "https://github.com/phac-nml/irida/commit/fb1f3a4ce9d9d82d085f7ab18709d1e0b1fa8f8a", "message": "pulled generic seq run stuff up to seqrun and deleted that class", "committedDate": "2019-04-02T20:55:30Z", "type": "commit"}, {"oid": "71036f5d6399cd49ff95c0f6023a3c545afb73a3", "url": "https://github.com/phac-nml/irida/commit/71036f5d6399cd49ff95c0f6023a3c545afb73a3", "message": "added liquibase change to pull miseqrun stuff into the new props table", "committedDate": "2019-04-02T20:55:49Z", "type": "commit"}, {"oid": "330d56076a51d777571c37d39c0b2e34b1ad199d", "url": "https://github.com/phac-nml/irida/commit/330d56076a51d777571c37d39c0b2e34b1ad199d", "message": "updated run details page to be run type agnostic", "committedDate": "2019-04-03T13:55:16Z", "type": "commit"}, {"oid": "31ecf58c4602de496c4142fe67b48accca348ca7", "url": "https://github.com/phac-nml/irida/commit/31ecf58c4602de496c4142fe67b48accca348ca7", "message": "removed miseqrun class", "committedDate": "2019-04-03T15:39:48Z", "type": "commit"}, {"oid": "cc16b228ea9245d3f8cf978abc2ed2b79aaae238", "url": "https://github.com/phac-nml/irida/commit/cc16b228ea9245d3f8cf978abc2ed2b79aaae238", "message": "renamed seq run method", "committedDate": "2019-04-03T15:56:42Z", "type": "commit"}, {"oid": "3ee66a065a2b32829f36667adf581527e78d2370", "url": "https://github.com/phac-nml/irida/commit/3ee66a065a2b32829f36667adf581527e78d2370", "message": "remioved miseq_run from the test db files", "committedDate": "2019-04-03T17:27:27Z", "type": "commit"}, {"oid": "7b53468204fdc5e649f27e1ec158ef2e8d956c95", "url": "https://github.com/phac-nml/irida/commit/7b53468204fdc5e649f27e1ec158ef2e8d956c95", "message": "added sequencer_type field to liquibase", "committedDate": "2019-04-03T17:30:43Z", "type": "commit"}, {"oid": "81ce07a71b6159eee4dc85e04cd7c5a42ce7a53c", "url": "https://github.com/phac-nml/irida/commit/81ce07a71b6159eee4dc85e04cd7c5a42ce7a53c", "message": "added sequencertype to all test xml", "committedDate": "2019-04-03T18:17:50Z", "type": "commit"}, {"oid": "8af87ca2a8733f094a3f7e291c147bb738a27995", "url": "https://github.com/phac-nml/irida/commit/8af87ca2a8733f094a3f7e291c147bb738a27995", "message": "fixing test failures", "committedDate": "2019-04-03T19:06:19Z", "type": "commit"}, {"oid": "a54bd4d32c573114cde9bc0d94018e810da7b76d", "url": "https://github.com/phac-nml/irida/commit/a54bd4d32c573114cde9bc0d94018e810da7b76d", "message": "added new default param for sequencingrun since its notnull", "committedDate": "2019-04-03T19:18:11Z", "type": "commit"}, {"oid": "4563282f13ad6db79f4337b22744b3e44c250d86", "url": "https://github.com/phac-nml/irida/commit/4563282f13ad6db79f4337b22744b3e44c250d86", "message": "removing uploadStatus as a constructor arg to match what we were doing with miseqrun", "committedDate": "2019-04-03T19:50:21Z", "type": "commit"}, {"oid": "d1bb0de1ad8204e1d4bfb789080f0e5dcb63e16e", "url": "https://github.com/phac-nml/irida/commit/d1bb0de1ad8204e1d4bfb789080f0e5dcb63e16e", "message": "adding miseq type in aud table too", "committedDate": "2019-04-23T18:01:44Z", "type": "commit"}, {"oid": "7dcfbddfc54fd9925b6770cfaf12d9492654e562", "url": "https://github.com/phac-nml/irida/commit/7dcfbddfc54fd9925b6770cfaf12d9492654e562", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2019-04-23T18:02:34Z", "type": "commit"}, {"oid": "9c4a04f700915f1477fcb325aebee2397f61757f", "url": "https://github.com/phac-nml/irida/commit/9c4a04f700915f1477fcb325aebee2397f61757f", "message": "allowing null properties for miseq run conversion", "committedDate": "2019-04-23T18:23:21Z", "type": "commit"}, {"oid": "7d2d509c908d6ff55a8c7aed61089bfd2b1bc9e1", "url": "https://github.com/phac-nml/irida/commit/7d2d509c908d6ff55a8c7aed61089bfd2b1bc9e1", "message": "converting /miseqrun POSTS to miseq sequencer type for legacy uploaders", "committedDate": "2019-04-23T18:23:55Z", "type": "commit"}, {"oid": "a8d977105dfd46d11868f359ed1c9ac432a736d2", "url": "https://github.com/phac-nml/irida/commit/a8d977105dfd46d11868f359ed1c9ac432a736d2", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2020-02-19T15:40:16Z", "type": "commit"}, {"oid": "d408ef21f9dd0c47ba4969244075befe03284d70", "url": "https://github.com/phac-nml/irida/commit/d408ef21f9dd0c47ba4969244075befe03284d70", "message": "moved liquibase update", "committedDate": "2020-02-19T15:41:55Z", "type": "commit"}, {"oid": "a10bcc4b8f77f4f31da08f45a795b1c785fa2c77", "url": "https://github.com/phac-nml/irida/commit/a10bcc4b8f77f4f31da08f45a795b1c785fa2c77", "message": "forcing run type to lowercase", "committedDate": "2020-02-19T17:42:24Z", "type": "commit"}, {"oid": "742554009b595ed4291c6711127dd67c9e5c1378", "url": "https://github.com/phac-nml/irida/commit/742554009b595ed4291c6711127dd67c9e5c1378", "message": "added changeset 20.05 to all changes", "committedDate": "2020-02-19T17:42:40Z", "type": "commit"}, {"oid": "b446fae96ec1f42776204522511c87b062f36300", "url": "https://github.com/phac-nml/irida/commit/b446fae96ec1f42776204522511c87b062f36300", "message": "added validation to sequencer type", "committedDate": "2020-02-19T18:08:50Z", "type": "commit"}, {"oid": "e7533ad2b86e37a906dda585de7b65a611311df0", "url": "https://github.com/phac-nml/irida/commit/e7533ad2b86e37a906dda585de7b65a611311df0", "message": "added tests for new seq run endpoints", "committedDate": "2020-02-19T19:18:54Z", "type": "commit"}, {"oid": "c0896f9232c9cb5fd5364f6bad0e173860c24cb8", "url": "https://github.com/phac-nml/irida/commit/c0896f9232c9cb5fd5364f6bad0e173860c24cb8", "message": "removed old comment that doens't make sense anymore", "committedDate": "2020-02-19T19:19:26Z", "type": "commit"}, {"oid": "657af2543f4a2898302c771bfeb2c7e866ba2ad8", "url": "https://github.com/phac-nml/irida/commit/657af2543f4a2898302c771bfeb2c7e866ba2ad8", "message": "added updates to CHANGELOG and UPGRADING", "committedDate": "2020-02-19T20:13:31Z", "type": "commit"}, {"oid": "887893141b54918b8ad83a5e7f4bc24bc855cea1", "url": "https://github.com/phac-nml/irida/commit/887893141b54918b8ad83a5e7f4bc24bc855cea1", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2020-02-20T17:49:08Z", "type": "commit"}, {"oid": "27b14f8a2d2ff5bef9f17eef1f32cce953477929", "url": "https://github.com/phac-nml/irida/commit/27b14f8a2d2ff5bef9f17eef1f32cce953477929", "message": "reworded seq run changelog statement", "committedDate": "2020-02-20T17:49:21Z", "type": "commit"}, {"oid": "71f3d1e6fe00634690b7f6fe844ba38cb1ae94d0", "url": "https://github.com/phac-nml/irida/commit/71f3d1e6fe00634690b7f6fe844ba38cb1ae94d0", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2020-03-02T20:26:14Z", "type": "commit"}, {"oid": "e4f458bbba003a53fa05d350a234867580184126", "url": "https://github.com/phac-nml/irida/commit/e4f458bbba003a53fa05d350a234867580184126", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2020-03-04T19:32:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MjM5MQ==", "url": "https://github.com/phac-nml/irida/pull/603#discussion_r384192391", "bodyText": "This method should probably be changed from addSequenceFileToMiseqRun to something like addSequenceFileToSequencingRun", "author": "JeffreyThiessen", "createdAt": "2020-02-25T23:35:11Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunSequenceFilesController.java", "diffHunk": "@@ -47,7 +43,7 @@ public RESTSequencingRunSequenceFilesController(SequencingRunService service,\n \t}\n \n \t/**\n-\t * Add a relationship between a {@link MiseqRun} and a {@link SequenceFile}.\n+\t * Add a relationship between a {@link SequencingRun} and a {@link SequenceFile}.", "originalCommit": "27b14f8a2d2ff5bef9f17eef1f32cce953477929", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA0NzU4OA==", "url": "https://github.com/phac-nml/irida/pull/603#discussion_r389047588", "bodyText": "Done in\n2f2856e", "author": "tom114", "createdAt": "2020-03-06T17:42:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NDE5MjM5MQ=="}], "type": "inlineReview", "revised_code": {"commit": "2f2856ef315a46e69ce084e84557d1726a533d84", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunSequenceFilesController.java b/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunSequenceFilesController.java\nindex 0bcd270775..fb80a1f3ba 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunSequenceFilesController.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunSequenceFilesController.java\n\n@@ -38,24 +38,20 @@ public class RESTSequencingRunSequenceFilesController {\n \t@Autowired\n \tpublic RESTSequencingRunSequenceFilesController(SequencingRunService service,\n \t\t\tSequencingObjectService sequencingObjectService) {\n-\t\tthis.miseqRunService = service;\n+\t\tthis.sequencingRunService = service;\n \t\tthis.sequencingObjectService = sequencingObjectService;\n \t}\n \n \t/**\n \t * Add a relationship between a {@link SequencingRun} and a {@link SequenceFile}.\n \t *\n-\t * @param sequencingrunId\n-\t *            the id of the run to add sequence file to.\n-\t * @param representation\n-\t *            the JSON key-value pair that contains the identifier for the\n-\t *            sequenceFile\n-\t * @param response\n-\t *            a reference to the response.\n+\t * @param sequencingrunId the id of the run to add sequence file to.\n+\t * @param representation  the JSON key-value pair that contains the identifier for the sequenceFile\n+\t * @param response        a reference to the response.\n \t * @return a response indicating that the collection was modified.\n \t */\n \t@RequestMapping(value = \"/api/sequencingrun/{sequencingrunId}/sequenceFiles\", method = RequestMethod.POST)\n-\tpublic ModelMap addSequenceFileToMiseqRun(@PathVariable Long sequencingrunId,\n+\tpublic ModelMap addSequenceFilesToSequencingRun(@PathVariable Long sequencingrunId,\n \t\t\t@RequestBody Map<String, String> representation, HttpServletResponse response) {\n \t\tModelMap modelMap = new ModelMap();\n \t\tString stringId = representation.get(SEQUENCEFILE_ID_KEY);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODU5ODg3Nw==", "url": "https://github.com/phac-nml/irida/pull/603#discussion_r388598877", "bodyText": "MISEQ_REL below is related to issue uploading data as discussed in person.", "author": "JeffreyThiessen", "createdAt": "2020-03-05T22:15:02Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunController.java", "diffHunk": "@@ -1,35 +1,25 @@\n package ca.corefacility.bioinformatics.irida.web.controller.api.sequencingrun;\n \n-import static org.springframework.hateoas.mvc.ControllerLinkBuilder.linkTo;\n-import static org.springframework.hateoas.mvc.ControllerLinkBuilder.methodOn;\n-\n-import java.util.Collection;\n-\n-import javax.servlet.http.HttpServletResponse;\n-\n+import ca.corefacility.bioinformatics.irida.model.run.SequencingRun;\n+import ca.corefacility.bioinformatics.irida.service.ProjectService;\n+import ca.corefacility.bioinformatics.irida.service.SequencingRunService;\n+import ca.corefacility.bioinformatics.irida.web.assembler.resource.ResourceCollection;\n+import ca.corefacility.bioinformatics.irida.web.controller.api.RESTGenericController;\n+import ca.corefacility.bioinformatics.irida.web.controller.api.projects.RESTProjectsController;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.hateoas.Link;\n-import org.springframework.http.HttpStatus;\n import org.springframework.http.MediaType;\n import org.springframework.stereotype.Controller;\n import org.springframework.ui.ModelMap;\n-import org.springframework.web.bind.annotation.ExceptionHandler;\n+import org.springframework.web.bind.annotation.PathVariable;\n import org.springframework.web.bind.annotation.RequestBody;\n import org.springframework.web.bind.annotation.RequestMapping;\n import org.springframework.web.bind.annotation.RequestMethod;\n-import org.springframework.web.bind.annotation.ResponseStatus;\n \n-import ca.corefacility.bioinformatics.irida.model.run.MiseqRun;\n-import ca.corefacility.bioinformatics.irida.model.run.SequencingRun;\n-import ca.corefacility.bioinformatics.irida.service.ProjectService;\n-import ca.corefacility.bioinformatics.irida.service.SequencingRunService;\n-import ca.corefacility.bioinformatics.irida.web.assembler.resource.ResourceCollection;\n-import ca.corefacility.bioinformatics.irida.web.controller.api.RESTGenericController;\n-import ca.corefacility.bioinformatics.irida.web.controller.api.projects.RESTProjectsController;\n-\n-import com.fasterxml.jackson.databind.exc.InvalidDefinitionException;\n+import javax.servlet.http.HttpServletResponse;\n+import java.util.Collection;\n \n /**\n  *", "originalCommit": "e4f458bbba003a53fa05d350a234867580184126", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA0NzcwNw==", "url": "https://github.com/phac-nml/irida/pull/603#discussion_r389047707", "bodyText": "Added that rel back for legacy uploaders in 489e6df", "author": "tom114", "createdAt": "2020-03-06T17:42:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODU5ODg3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "489e6dfeebc42cbe7f772a4987fda372ce3fe201", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunController.java b/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunController.java\nindex d30cde18cc..c042732e72 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunController.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/web/controller/api/sequencingrun/RESTSequencingRunController.java\n\n@@ -21,6 +21,9 @@ import org.springframework.web.bind.annotation.RequestMethod;\n import javax.servlet.http.HttpServletResponse;\n import java.util.Collection;\n \n+import static org.springframework.hateoas.mvc.ControllerLinkBuilder.linkTo;\n+import static org.springframework.hateoas.mvc.ControllerLinkBuilder.methodOn;\n+\n /**\n  *\n  */\n"}}, {"oid": "2f2856ef315a46e69ce084e84557d1726a533d84", "url": "https://github.com/phac-nml/irida/commit/2f2856ef315a46e69ce084e84557d1726a533d84", "message": "updated method name to reflect that we're not just using miseq runs", "committedDate": "2020-03-06T17:35:51Z", "type": "commit"}, {"oid": "489e6dfeebc42cbe7f772a4987fda372ce3fe201", "url": "https://github.com/phac-nml/irida/commit/489e6dfeebc42cbe7f772a4987fda372ce3fe201", "message": "added old miseqrun endpoint back in the links for legacy uploader", "committedDate": "2020-03-06T17:41:45Z", "type": "commit"}, {"oid": "39a7166d62534b9606cced1bc1aca4c0c3e2e59b", "url": "https://github.com/phac-nml/irida/commit/39a7166d62534b9606cced1bc1aca4c0c3e2e59b", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2020-03-06T17:43:16Z", "type": "commit"}, {"oid": "77611cd9c992840c3efd8de94cf879a8c70b6ccd", "url": "https://github.com/phac-nml/irida/commit/77611cd9c992840c3efd8de94cf879a8c70b6ccd", "message": "updated sequencing run rest docs and added a deprecation notice to the miseqrun endpoint", "committedDate": "2020-03-06T21:27:09Z", "type": "commit"}, {"oid": "37e0f7bc1dc10402557e1f7d9c9c8ca52af9cf5c", "url": "https://github.com/phac-nml/irida/commit/37e0f7bc1dc10402557e1f7d9c9c8ca52af9cf5c", "message": "Merge branch 'development' into generic-sequencing-runs", "committedDate": "2020-03-09T20:41:38Z", "type": "commit"}]}