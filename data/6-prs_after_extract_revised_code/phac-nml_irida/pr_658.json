{"pr_number": 658, "pr_title": "Added analysis result image viewer", "pr_createdAt": "2020-04-16T21:15:23Z", "pr_url": "https://github.com/phac-nml/irida/pull/658", "timeline": [{"oid": "fd1f003f8121bb45a830ed8007e34f72324dea83", "url": "https://github.com/phac-nml/irida/commit/fd1f003f8121bb45a830ed8007e34f72324dea83", "message": "Added analysis result image viewer to output file preview page. Removed Row tags from output preview files that were misaligning the download buttons.", "committedDate": "2020-04-16T21:12:50Z", "type": "commit"}, {"oid": "cb5b74deab45a10292634dbcf66d84b2986d4ff8", "url": "https://github.com/phac-nml/irida/commit/cb5b74deab45a10292634dbcf66d84b2986d4ff8", "message": "Updated CHANGELOG and add missing comment to AnalysisOutputFile model", "committedDate": "2020-04-16T21:18:51Z", "type": "commit"}, {"oid": "d464a3ec8cde8a3343cd6cd1a793b8c45e5e66de", "url": "https://github.com/phac-nml/irida/commit/d464a3ec8cde8a3343cd6cd1a793b8c45e5e66de", "message": "Merge branch 'development' into add-analysis-image-viewer", "committedDate": "2020-04-16T21:43:14Z", "type": "commit"}, {"oid": "8f27e701e703d5bd262b2ed6d90f344e40c13780", "url": "https://github.com/phac-nml/irida/commit/8f27e701e703d5bd262b2ed6d90f344e40c13780", "message": "Updated comment. Added throws IOException to the getImageFile method", "committedDate": "2020-04-16T22:31:49Z", "type": "commit"}, {"oid": "9e13ed4ef68859bc41e2d44ff927383415da3432", "url": "https://github.com/phac-nml/irida/commit/9e13ed4ef68859bc41e2d44ff927383415da3432", "message": "Added try catch block", "committedDate": "2020-04-16T22:57:47Z", "type": "commit"}, {"oid": "1068fb1d2168a577299c23d72d475f87e6976eef", "url": "https://github.com/phac-nml/irida/commit/1068fb1d2168a577299c23d72d475f87e6976eef", "message": "Removed throws comment as we catch the exception", "committedDate": "2020-04-17T00:09:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE0MTAxOQ==", "url": "https://github.com/phac-nml/irida/pull/658#discussion_r410141019", "bodyText": "Instead of a straight out String, can we get in the habit of return ResponseEntity<String> it allows for better control of the response.  In the case, when you log the exception you could return an error state: ResponseEntity.status(HttpStatus.BAD_REQUEST).body(\"That was a terrible idea\").  That way the UI can response the the status of the request appropriately.", "author": "joshsadam", "createdAt": "2020-04-17T10:39:39Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisAjaxController.java", "diffHunk": "@@ -882,6 +882,39 @@ public void getAjaxDownloadAnalysisSubmissionIndividualFile(@PathVariable Long a\n \t\treturn ImmutableMap.of(\"newick\", lines.get(0));\n \t}\n \n+\t/**\n+\t * Get an image file associated with a specific {@link AnalysisSubmission} by file name.\n+\t *\n+\t * @param submissionId {@link Long} id for an {@link AnalysisSubmission}\n+\t * @param filename {@link String} filename for an {@link AnalysisOutputFile}\n+\t *\n+\t * @return {@link String} containing the image file contents as a base64 encoded string.\n+\t */\n+\t@RequestMapping(\"{submissionId}/image\")\n+\t@ResponseBody\n+\tpublic String getImageFile(@PathVariable Long submissionId, String filename){", "originalCommit": "1068fb1d2168a577299c23d72d475f87e6976eef", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDMyOTE2Nw==", "url": "https://github.com/phac-nml/irida/pull/658#discussion_r410329167", "bodyText": "Updated in a6f973b", "author": "deepsidhu85", "createdAt": "2020-04-17T16:18:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDE0MTAxOQ=="}], "type": "inlineReview", "revised_code": {"commit": "a6f973b9319bc3f2d954a416af2062bb5b776ba8", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisAjaxController.java b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisAjaxController.java\nindex c2d174352c..b7eb045292 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisAjaxController.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/analysis/AnalysisAjaxController.java\n\n@@ -892,7 +894,7 @@ public class AnalysisAjaxController {\n \t */\n \t@RequestMapping(\"{submissionId}/image\")\n \t@ResponseBody\n-\tpublic String getImageFile(@PathVariable Long submissionId, String filename){\n+\tpublic ResponseEntity<String> getImageFile(@PathVariable Long submissionId, String filename){\n \t\tAnalysisSubmission submission = analysisSubmissionService.read(submissionId);\n \t\tSet<AnalysisOutputFile> files = submission.getAnalysis()\n \t\t\t\t.getAnalysisOutputFiles();\n"}}, {"oid": "a6f973b9319bc3f2d954a416af2062bb5b776ba8", "url": "https://github.com/phac-nml/irida/commit/a6f973b9319bc3f2d954a416af2062bb5b776ba8", "message": "Refactored code to move checking if a preview is required for a certain file type into the context. Updated getImageFile in analysis ajax controller to return a ResponseEntity<String>", "committedDate": "2020-04-17T16:17:49Z", "type": "commit"}, {"oid": "cbf51db393fbb45b195bfb0d8a0dea2fcc2bbced", "url": "https://github.com/phac-nml/irida/commit/cbf51db393fbb45b195bfb0d8a0dea2fcc2bbced", "message": "Updated message returned if unable to read image file", "committedDate": "2020-04-17T17:11:02Z", "type": "commit"}, {"oid": "13472ccedbbc8a0c4d9cf16007570753f28702b2", "url": "https://github.com/phac-nml/irida/commit/13472ccedbbc8a0c4d9cf16007570753f28702b2", "message": "Added missing @param to method comment", "committedDate": "2020-04-17T18:00:50Z", "type": "commit"}]}