{"pr_number": 878, "pr_title": "Fixing adding samples to the cart", "pr_createdAt": "2020-12-01T16:53:32Z", "pr_url": "https://github.com/phac-nml/irida/pull/878", "timeline": [{"oid": "08826d4e99e7967b41ed760c86f26e18129edb89", "url": "https://github.com/phac-nml/irida/commit/08826d4e99e7967b41ed760c86f26e18129edb89", "message": "Fixing messages", "committedDate": "2020-11-30T21:43:02Z", "type": "commit"}, {"oid": "b829a4d8dfbb1982b6cc4fecc256a3c31a933f96", "url": "https://github.com/phac-nml/irida/commit/b829a4d8dfbb1982b6cc4fecc256a3c31a933f96", "message": "fix: correctly updates", "committedDate": "2020-12-01T16:10:18Z", "type": "commit"}, {"oid": "f3e078499de7df4791cd6ef6c1c1465354ccd924", "url": "https://github.com/phac-nml/irida/commit/f3e078499de7df4791cd6ef6c1c1465354ccd924", "message": "fix: correctly updates the cart and displays a message\n\nMessage for how many were added and how many already exist in the cart", "committedDate": "2020-12-01T16:11:04Z", "type": "commit"}, {"oid": "a41f9e52ddb856443d6c7b8ce9f14bf70fccc9bd", "url": "https://github.com/phac-nml/irida/commit/a41f9e52ddb856443d6c7b8ce9f14bf70fccc9bd", "message": "Update to ensure that no duplicate names are in the cart", "committedDate": "2020-12-01T19:26:46Z", "type": "commit"}, {"oid": "2df39f16f95e1bc1b57893979bc709d4a95b59cb", "url": "https://github.com/phac-nml/irida/commit/2df39f16f95e1bc1b57893979bc709d4a95b59cb", "message": "Cleaned up JavaDoc and remove unused method", "committedDate": "2020-12-02T11:11:31Z", "type": "commit"}, {"oid": "3af3443521efbe9adb8e74a82418a2389a4f1a0e", "url": "https://github.com/phac-nml/irida/commit/3af3443521efbe9adb8e74a82418a2389a4f1a0e", "message": "Merge branch 'development' into fix-adding-samples-response", "committedDate": "2020-12-02T19:08:34Z", "type": "commit"}, {"oid": "69a7cd042d15fefa9e40aff267f26a5410c9d9fa", "url": "https://github.com/phac-nml/irida/commit/69a7cd042d15fefa9e40aff267f26a5410c9d9fa", "message": "Cleaning up cart service", "committedDate": "2020-12-03T13:25:58Z", "type": "commit"}, {"oid": "82c8c2902e49ffa58ae3b7110fc718d10def84a2", "url": "https://github.com/phac-nml/irida/commit/82c8c2902e49ffa58ae3b7110fc718d10def84a2", "message": "Fixed issue with samples repeatedly showing in the cart", "committedDate": "2020-12-03T15:53:10Z", "type": "commit"}, {"oid": "e64845d5f52ebaa690b2a71f0a90b07ea1661ff1", "url": "https://github.com/phac-nml/irida/commit/e64845d5f52ebaa690b2a71f0a90b07ea1661ff1", "message": "Update JavaDoc", "committedDate": "2020-12-03T15:59:03Z", "type": "commit"}, {"oid": "42f2044042c7cf54419ef272af62a2b8cae67ea9", "url": "https://github.com/phac-nml/irida/commit/42f2044042c7cf54419ef272af62a2b8cae67ea9", "message": "Fixed JavaDoc param", "committedDate": "2020-12-03T16:08:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDMxMzc4Nw==", "url": "https://github.com/phac-nml/irida/pull/878#discussion_r534313787", "bodyText": "Typo", "author": "deepsidhu85", "createdAt": "2020-12-02T16:39:09Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UICartService.java", "diffHunk": "@@ -59,11 +132,13 @@ public void emptyCart() {\n \t/**\n \t * Remove a specific sample from the cart.\n \t *\n-\t * @param request Information about the samplet o remove from the cart\n+\t * @param request Information about the sample o remove from the cart", "originalCommit": "2df39f16f95e1bc1b57893979bc709d4a95b59cb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "69a7cd042d15fefa9e40aff267f26a5410c9d9fa", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UICartService.java b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UICartService.java\nindex 5cde2967ae..55f05e4201 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UICartService.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UICartService.java\n\n@@ -135,10 +118,9 @@ public class UICartService {\n \t * @param request Information about the sample o remove from the cart\n \t * @return number of total samples in the cart\n \t */\n-\tpublic int removeSample(RemoveSampleRequest request) {\n-\t\tProject project = projectService.read(request.getProjectId());\n-\t\tSample sample = sampleService.read(request.getSampleId());\n-\t\treturn cart.removeSample(project, sample);\n+\tpublic int removeSample(Long sampleId) {\n+\t\tcart.remove(sampleId);\n+\t\treturn cart.size();\n \t}\n \n \t/**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNTQ5MjE4NA==", "url": "https://github.com/phac-nml/irida/pull/878#discussion_r535492184", "bodyText": "Add a response to the UI to display a notification that a sample was removed and also if a project is removed from the cart", "author": "deepsidhu85", "createdAt": "2020-12-03T18:47:48Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/ajax/CartAjaxController.java", "diffHunk": "@@ -51,9 +54,9 @@ public CartAjaxController(UICartService service) {\n \t * @param request Request to move a sample from the cart\n \t * @return the number of samples currently in the cart\n \t */\n-\t@DeleteMapping(\"/sample\")\n-\tpublic ResponseEntity<Integer> removeSample(@RequestBody RemoveSampleRequest request) {\n-\t\treturn ResponseEntity.ok(service.removeSample(request));\n+\t@DeleteMapping(\"/sample/{sampleId}\")\n+\tpublic ResponseEntity<Integer> removeSample(@PathVariable Long sampleId) {\n+\t\treturn ResponseEntity.ok(service.removeSample(sampleId));", "originalCommit": "82c8c2902e49ffa58ae3b7110fc718d10def84a2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ecbbb2a2ee779cdc9ae8173c36348ecc6dbff004", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/ajax/CartAjaxController.java b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/cart/CartAjaxController.java\nsimilarity index 76%\nrename from src/main/java/ca/corefacility/bioinformatics/irida/ria/web/ajax/CartAjaxController.java\nrename to src/main/java/ca/corefacility/bioinformatics/irida/ria/web/cart/CartAjaxController.java\nindex 05317b2a6c..b92e91c78b 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/ajax/CartAjaxController.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/cart/CartAjaxController.java\n\n@@ -51,12 +51,13 @@ public class CartAjaxController {\n \t/**\n \t * Remove a sample from the cart\n \t *\n-\t * @param request Request to move a sample from the cart\n+\t * @param sampleId Request to move a sample from the cart\n+\t * @param locale   Current users locale\n \t * @return the number of samples currently in the cart\n \t */\n \t@DeleteMapping(\"/sample/{sampleId}\")\n-\tpublic ResponseEntity<Integer> removeSample(@PathVariable Long sampleId) {\n-\t\treturn ResponseEntity.ok(service.removeSample(sampleId));\n+\tpublic ResponseEntity<CartUpdateResponse> removeSample(@PathVariable Long sampleId, Locale locale) {\n+\t\treturn ResponseEntity.ok(service.removeSample(sampleId, locale));\n \t}\n \n \t/**\n"}}, {"oid": "ecbbb2a2ee779cdc9ae8173c36348ecc6dbff004", "url": "https://github.com/phac-nml/irida/commit/ecbbb2a2ee779cdc9ae8173c36348ecc6dbff004", "message": "Added notifications for adding and removing samples\n\nRefactored how messages are displayed to the user through the cart.", "committedDate": "2020-12-04T13:43:56Z", "type": "commit"}, {"oid": "d23055d06a4ddf3412b2a524de1b842a940c6a45", "url": "https://github.com/phac-nml/irida/commit/d23055d06a4ddf3412b2a524de1b842a940c6a45", "message": "Removed unused imports", "committedDate": "2020-12-04T13:45:11Z", "type": "commit"}, {"oid": "b85ee12847a9271bbd48a534a5083b3cba81705c", "url": "https://github.com/phac-nml/irida/commit/b85ee12847a9271bbd48a534a5083b3cba81705c", "message": "Fixed typo in JavaDoc", "committedDate": "2020-12-04T15:00:10Z", "type": "commit"}, {"oid": "ec0b0c103dfd7bee2fccebdfa3909d53a05e6062", "url": "https://github.com/phac-nml/irida/commit/ec0b0c103dfd7bee2fccebdfa3909d53a05e6062", "message": "Fixed JavaDoc errors", "committedDate": "2020-12-04T16:25:33Z", "type": "commit"}, {"oid": "ce396eb84afa74fb0e3b4e45df0b3b35e0a7ca63", "url": "https://github.com/phac-nml/irida/commit/ce396eb84afa74fb0e3b4e45df0b3b35e0a7ca63", "message": "Updated JavaDoc", "committedDate": "2020-12-04T18:02:48Z", "type": "commit"}, {"oid": "70130660cc6ab5b8da58c53501cad70fa6ee56ec", "url": "https://github.com/phac-nml/irida/commit/70130660cc6ab5b8da58c53501cad70fa6ee56ec", "message": "Updated JavaDoc", "committedDate": "2020-12-04T18:09:35Z", "type": "commit"}]}