{"pr_number": 853, "pr_title": "Announcements upgrade backend", "pr_createdAt": "2020-11-05T17:04:24Z", "pr_url": "https://github.com/phac-nml/irida/pull/853", "timeline": [{"oid": "09ac12a5ce16f337604576b1577fe497e3ed7092", "url": "https://github.com/phac-nml/irida/commit/09ac12a5ce16f337604576b1577fe497e3ed7092", "message": "starting to update the announcements request, service, and controller", "committedDate": "2020-11-04T20:37:35Z", "type": "commit"}, {"oid": "4a2506e4f89ac2143ca5ca549ddffd766483aada", "url": "https://github.com/phac-nml/irida/commit/4a2506e4f89ac2143ca5ca549ddffd766483aada", "message": "working on tests", "committedDate": "2020-11-05T16:50:43Z", "type": "commit"}, {"oid": "59b7c2a4668b7f7ab70292c5963ce356aa000600", "url": "https://github.com/phac-nml/irida/commit/59b7c2a4668b7f7ab70292c5963ce356aa000600", "message": "adding title placeholder", "committedDate": "2020-11-05T19:46:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA0NTY0Ng==", "url": "https://github.com/phac-nml/irida/pull/853#discussion_r520045646", "bodyText": "Shouldn't \"title placeholder\" be replaced with announcementRequest.getTitle()?", "author": "deepsidhu85", "createdAt": "2020-11-09T19:00:19Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UIAnnouncementsService.java", "diffHunk": "@@ -68,7 +68,7 @@ public UIAnnouncementsService(AnnouncementService announcementService, UserServi\n \t */\n \tpublic void createNewAnnouncement(@RequestBody AnnouncementRequest announcementRequest, Principal principal) {\n \t\tUser user = userService.getUserByUsername(principal.getName());\n-\t\tAnnouncement announcement = new Announcement(announcementRequest.getMessage(), user);\n+\t\tAnnouncement announcement = new Announcement(\"title placeholder\", announcementRequest.getMessage(), false, user);", "originalCommit": "59b7c2a4668b7f7ab70292c5963ce356aa000600", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2MjA4Nw==", "url": "https://github.com/phac-nml/irida/pull/853#discussion_r520562087", "bodyText": "Preemptively removed deprecated constructor. Fixed. Please see f3b6c93.", "author": "ksierks", "createdAt": "2020-11-10T13:30:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA0NTY0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "f3b6c93640e43914b621c1edc043e65525a8c017", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UIAnnouncementsService.java b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UIAnnouncementsService.java\nindex 7a47f215ea..2dae998e65 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UIAnnouncementsService.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/ria/web/services/UIAnnouncementsService.java\n\n@@ -68,7 +68,7 @@ public class UIAnnouncementsService {\n \t */\n \tpublic void createNewAnnouncement(@RequestBody AnnouncementRequest announcementRequest, Principal principal) {\n \t\tUser user = userService.getUserByUsername(principal.getName());\n-\t\tAnnouncement announcement = new Announcement(\"title placeholder\", announcementRequest.getMessage(), false, user);\n+\t\tAnnouncement announcement = new Announcement(announcementRequest.getMessage(), user);\n \t\tannouncementService.create(announcement);\n \t}\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA0NjY3MQ==", "url": "https://github.com/phac-nml/irida/pull/853#discussion_r520046671", "bodyText": "Something seems a little weird with the formatting. Do you have intellij setup to use the irida style xml?", "author": "deepsidhu85", "createdAt": "2020-11-09T19:01:45Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/ria/web/announcements/AnnouncementsController.java", "diffHunk": "@@ -129,19 +129,27 @@ public String getControlCentreAdminPage(final Model model) {\n      *", "originalCommit": "59b7c2a4668b7f7ab70292c5963ce356aa000600", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDYxNDQ3Mw==", "url": "https://github.com/phac-nml/irida/pull/853#discussion_r520614473", "bodyText": "In IntelliJ, imported schema from https://irida.corefacility.ca/documentation/developer/getting-started/irida-code-format.xml, highlighted comment and method and pressed Ctrl+Alt+L keys.\nPlease see b7e3c83.", "author": "ksierks", "createdAt": "2020-11-10T14:42:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA0NjY3MQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA0ODk4Ng==", "url": "https://github.com/phac-nml/irida/pull/853#discussion_r520048986", "bodyText": "For this line and similar below. Change the first \"This is a message\" in new Announcement to \"This is a message title\" since that is what is being set for that argument", "author": "deepsidhu85", "createdAt": "2020-11-09T19:04:10Z", "path": "src/test/java/ca/corefacility/bioinformatics/irida/service/impl/integration/AnnouncementServiceImplIT.java", "diffHunk": "@@ -65,7 +65,7 @@\n     public void testCreateAnnouncementAsAdmin() {\n         final Authentication auth = SecurityContextHolder.getContext().getAuthentication();\n         final User user = userService.getUserByUsername(auth.getName());\n-        Announcement an = new Announcement(\"This is a message\", user);\n+        Announcement an = new Announcement(\"This is a message\", \"This is a message\", false, user);", "originalCommit": "59b7c2a4668b7f7ab70292c5963ce356aa000600", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDU2NTc2NQ==", "url": "https://github.com/phac-nml/irida/pull/853#discussion_r520565765", "bodyText": "Done! Please see f0780ca.", "author": "ksierks", "createdAt": "2020-11-10T13:36:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDA0ODk4Ng=="}], "type": "inlineReview", "revised_code": {"commit": "f0780ca71fa8d9c34a5fec1207e5b6b770f58e24", "chunk": "diff --git a/src/test/java/ca/corefacility/bioinformatics/irida/service/impl/integration/AnnouncementServiceImplIT.java b/src/test/java/ca/corefacility/bioinformatics/irida/service/impl/integration/AnnouncementServiceImplIT.java\nindex 60c5c2c83b..46feff8e69 100644\n--- a/src/test/java/ca/corefacility/bioinformatics/irida/service/impl/integration/AnnouncementServiceImplIT.java\n+++ b/src/test/java/ca/corefacility/bioinformatics/irida/service/impl/integration/AnnouncementServiceImplIT.java\n\n@@ -65,7 +65,7 @@ public class AnnouncementServiceImplIT {\n     public void testCreateAnnouncementAsAdmin() {\n         final Authentication auth = SecurityContextHolder.getContext().getAuthentication();\n         final User user = userService.getUserByUsername(auth.getName());\n-        Announcement an = new Announcement(\"This is a message\", \"This is a message\", false, user);\n+        Announcement an = new Announcement(\"This is a message title\", \"This is a message\", false, user);\n         try {\n             announcementService.create(an);\n         } catch (AccessDeniedException e) {\n"}}, {"oid": "f0780ca71fa8d9c34a5fec1207e5b6b770f58e24", "url": "https://github.com/phac-nml/irida/commit/f0780ca71fa8d9c34a5fec1207e5b6b770f58e24", "message": "modifying the title name when creating a new announcement", "committedDate": "2020-11-10T13:33:43Z", "type": "commit"}, {"oid": "b7e3c83ac6ef44b1e4f97b68f13ac9ada603a3c0", "url": "https://github.com/phac-nml/irida/commit/b7e3c83ac6ef44b1e4f97b68f13ac9ada603a3c0", "message": "fixed formatting", "committedDate": "2020-11-10T14:39:11Z", "type": "commit"}, {"oid": "f3b6c93640e43914b621c1edc043e65525a8c017", "url": "https://github.com/phac-nml/irida/commit/f3b6c93640e43914b621c1edc043e65525a8c017", "message": "reverting preemptively removing the deprecated constructor", "committedDate": "2020-11-10T14:57:41Z", "type": "commit"}]}