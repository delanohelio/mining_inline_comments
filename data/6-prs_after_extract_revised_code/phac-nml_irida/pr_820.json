{"pr_number": 820, "pr_title": "Syncing with older versions of IRIDA", "pr_createdAt": "2020-10-06T16:55:01Z", "pr_url": "https://github.com/phac-nml/irida/pull/820", "timeline": [{"oid": "d7dcbd535466aa0621446d45d102376347034dbf", "url": "https://github.com/phac-nml/irida/commit/d7dcbd535466aa0621446d45d102376347034dbf", "message": "added exception for when a link is not available in the rest api", "committedDate": "2020-10-06T14:01:50Z", "type": "commit"}, {"oid": "acaf0d0af322ffd9899fee93717e1d82ba650e7f", "url": "https://github.com/phac-nml/irida/commit/acaf0d0af322ffd9899fee93717e1d82ba650e7f", "message": "added exception thrown and handled when there are no assemblies\navailable in a given rest api version", "committedDate": "2020-10-06T14:02:14Z", "type": "commit"}, {"oid": "91d7afc64833e67c0c104f180794bf1666d596c2", "url": "https://github.com/phac-nml/irida/commit/91d7afc64833e67c0c104f180794bf1666d596c2", "message": "added some commenting", "committedDate": "2020-10-06T14:08:53Z", "type": "commit"}, {"oid": "45a0926dd9a0424c2a48dc7acafc19db984d926d", "url": "https://github.com/phac-nml/irida/commit/45a0926dd9a0424c2a48dc7acafc19db984d926d", "message": "updated pom to 20.09.2", "committedDate": "2020-10-06T15:06:01Z", "type": "commit"}, {"oid": "af7283e255d67eb7119c7ffe124c64173451dba2", "url": "https://github.com/phac-nml/irida/commit/af7283e255d67eb7119c7ffe124c64173451dba2", "message": "added changelog entry for fixing sync without assemblies", "committedDate": "2020-10-06T15:06:14Z", "type": "commit"}, {"oid": "5882faab21dcb1b69caf5249b8f4d5138e1e62eb", "url": "https://github.com/phac-nml/irida/commit/5882faab21dcb1b69caf5249b8f4d5138e1e62eb", "message": "added tests for sync without assemblies", "committedDate": "2020-10-06T15:59:19Z", "type": "commit"}, {"oid": "1dcf02486ce58566281d35d74d0fca61386ec81f", "url": "https://github.com/phac-nml/irida/commit/1dcf02486ce58566281d35d74d0fca61386ec81f", "message": "changed some strucutre to how the list is formed for assemblies", "committedDate": "2020-10-06T15:59:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1NTc1OQ==", "url": "https://github.com/phac-nml/irida/pull/820#discussion_r500455759", "bodyText": "Would it be possible to print the URL to the referenced IRIDA instance?", "author": "apetkau", "createdAt": "2020-10-06T17:00:43Z", "path": "src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java", "diffHunk": "@@ -371,8 +374,16 @@ private void syncProject(Project project) {\n \t\t\t}\n \t\t}\n \n-\t\t//list the remote assemblies for the sample\n-\t\tList<UploadedAssembly> genomeAssembliesForSample = assemblyRemoteService.getGenomeAssembliesForSample(sample);\n+\t\t//list the remote assemblies for the sample.\n+\t\tList<UploadedAssembly> genomeAssembliesForSample;\n+\t\ttry {\n+\t\t\tgenomeAssembliesForSample = assemblyRemoteService.getGenomeAssembliesForSample(sample);\n+\t\t} catch (LinkNotFoundException e) {\n+\t\t\t//if the target IRIDA doesn't support assemblies yet, warn and ignore assemblies.\n+\t\t\tlogger.warn(\"The referenced IRIDA instance doesn't support assemblies.\");", "originalCommit": "1dcf02486ce58566281d35d74d0fca61386ec81f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDUzNTMzMA==", "url": "https://github.com/phac-nml/irida/pull/820#discussion_r500535330", "bodyText": "Sure.  Added in ce0cf1f", "author": "tom114", "createdAt": "2020-10-06T19:12:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ1NTc1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "ce0cf1f8618498c34de675154fcead8c2d8422a7", "chunk": "diff --git a/src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java b/src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java\nindex 187d459d14..b27437ce3a 100644\n--- a/src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java\n+++ b/src/main/java/ca/corefacility/bioinformatics/irida/service/remote/ProjectSynchronizationService.java\n\n@@ -380,11 +380,10 @@ public class ProjectSynchronizationService {\n \t\t\tgenomeAssembliesForSample = assemblyRemoteService.getGenomeAssembliesForSample(sample);\n \t\t} catch (LinkNotFoundException e) {\n \t\t\t//if the target IRIDA doesn't support assemblies yet, warn and ignore assemblies.\n-\t\t\tlogger.warn(\"The referenced IRIDA instance doesn't support assemblies.\");\n+\t\t\tlogger.warn(\"The sample on the referenced IRIDA doesn't support assemblies: \" + sample.getSelfHref());\n \t\t\tgenomeAssembliesForSample = Lists.newArrayList();\n \t\t}\n \n-\n \t\t//for each assembly\n \t\tfor (UploadedAssembly file : genomeAssembliesForSample) {\n \t\t\t//if we haven't already sync'd this assembly, get it\n"}}, {"oid": "ce0cf1f8618498c34de675154fcead8c2d8422a7", "url": "https://github.com/phac-nml/irida/commit/ce0cf1f8618498c34de675154fcead8c2d8422a7", "message": "added url to sample if it does not support assemblies", "committedDate": "2020-10-06T19:11:19Z", "type": "commit"}]}