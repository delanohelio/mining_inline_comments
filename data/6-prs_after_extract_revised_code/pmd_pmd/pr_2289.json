{"pr_number": 2289, "pr_title": "[vm] Adapt VM module to the new javacc wrapper", "pr_createdAt": "2020-02-14T22:49:00Z", "pr_url": "https://github.com/pmd/pmd/pull/2289", "timeline": [{"oid": "e46a875f2cfe4d767be7bcda72cf65288392730e", "url": "https://github.com/pmd/pmd/commit/e46a875f2cfe4d767be7bcda72cf65288392730e", "message": "Port velocity module to new script\n\nRemove a bunch of useless copy pasted goo\n* LogUtil\n* TemplateParseException\n* MacroParseException\n* Many methods of AbstractVmNode\n\nRename ASTprocess to ASTTemplate.", "committedDate": "2020-02-14T22:20:57Z", "type": "commit"}, {"oid": "c1b7c1da2b8ece67f1ff186668c11f1a8d163d8c", "url": "https://github.com/pmd/pmd/commit/c1b7c1da2b8ece67f1ff186668c11f1a8d163d8c", "message": "Cleanup VM parser", "committedDate": "2020-02-14T22:47:29Z", "type": "commit"}, {"oid": "9983a52486613c5ca0e614977a93794b8048a225", "url": "https://github.com/pmd/pmd/commit/9983a52486613c5ca0e614977a93794b8048a225", "message": "Fix windows build", "committedDate": "2020-02-14T23:50:14Z", "type": "commit"}, {"oid": "9983a52486613c5ca0e614977a93794b8048a225", "url": "https://github.com/pmd/pmd/commit/9983a52486613c5ca0e614977a93794b8048a225", "message": "Fix windows build", "committedDate": "2020-02-14T23:50:14Z", "type": "forcePushed"}, {"oid": "5cd705dd35f3e7e0b1d29428aa79427bbab23c3f", "url": "https://github.com/pmd/pmd/commit/5cd705dd35f3e7e0b1d29428aa79427bbab23c3f", "message": "Restrict ctor visibility", "committedDate": "2020-02-15T08:26:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTkyMjk1OA==", "url": "https://github.com/pmd/pmd/pull/2289#discussion_r381922958", "bodyText": "Standard procedure: first deprecate/internalize on master, merge master into PMD 7, then merge this PR...", "author": "adangel", "createdAt": "2020-02-20T10:49:25Z", "path": "pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTAddNode.java", "diffHunk": "@@ -34,22 +34,11 @@\n  * @version $Id: ASTAddNode.java 712887 2008-11-11 00:27:50Z nbubna $\n  */\n public class ASTAddNode extends ASTMathNode {\n-    /**\n-     * @param id\n-     */\n-    public ASTAddNode(final int id) {\n+    ASTAddNode(int id) {", "originalCommit": "5cd705dd35f3e7e0b1d29428aa79427bbab23c3f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0680c4354b5cd2fce3bec40a10be2d1773e98122", "chunk": "diff --git a/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTAddNode.java b/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTAddNode.java\nindex a630907da0..05433404d7 100644\n--- a/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTAddNode.java\n+++ b/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTAddNode.java\n\n@@ -33,7 +33,7 @@ package net.sourceforge.pmd.lang.vm.ast;\n  * @author <a href=\"mailto:geirm@optonline.net\">Geir Magnusson Jr.</a>\n  * @version $Id: ASTAddNode.java 712887 2008-11-11 00:27:50Z nbubna $\n  */\n-public class ASTAddNode extends ASTMathNode {\n+public final class ASTAddNode extends ASTMathNode {\n     ASTAddNode(int id) {\n         super(id);\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTkzMDIwMA==", "url": "https://github.com/pmd/pmd/pull/2289#discussion_r381930200", "bodyText": "It seems we moved the JavaTokenManager as well from lang.java to sub-package lang.java.ast - without noting this incompatibility...", "author": "adangel", "createdAt": "2020-02-20T11:03:38Z", "path": "pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/VmTokenManager.java", "diffHunk": "@@ -1,22 +1,21 @@\n-/**\n+/*\n  * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n  */\n \n-package net.sourceforge.pmd.lang.vm;\n+package net.sourceforge.pmd.lang.vm.ast;", "originalCommit": "5cd705dd35f3e7e0b1d29428aa79427bbab23c3f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjA4OTAxOQ==", "url": "https://github.com/pmd/pmd/pull/2289#discussion_r392089019", "bodyText": "I think, it makes sense to internalize the VmTokenManager as well on master - the access should be through LanguageVersionHandler#getParser#getTokenManager and the interface TokenManager should be used.", "author": "adangel", "createdAt": "2020-03-13T08:31:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTkzMDIwMA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjE1OTg4NA==", "url": "https://github.com/pmd/pmd/pull/2289#discussion_r382159884", "bodyText": "Should be final\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            public class ASTBlock extends AbstractVmNode {\n          \n          \n            \n            public final class ASTBlock extends AbstractVmNode {", "author": "adangel", "createdAt": "2020-02-20T17:51:06Z", "path": "pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTBlock.java", "diffHunk": "@@ -0,0 +1,27 @@\n+/*\n+ * BSD-style license; for more info see http://pmd.sourceforge.net/license.html\n+ */\n+\n+package net.sourceforge.pmd.lang.vm.ast;\n+\n+import org.apache.commons.lang3.StringUtils;\n+\n+public class ASTBlock extends AbstractVmNode {", "originalCommit": "5cd705dd35f3e7e0b1d29428aa79427bbab23c3f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b7cbab5d470fb9b597085a67b8567442fc230596", "chunk": "diff --git a/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTBlock.java b/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTBlock.java\nindex c92bf64490..075f12a813 100644\n--- a/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTBlock.java\n+++ b/pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTBlock.java\n\n@@ -6,7 +6,7 @@ package net.sourceforge.pmd.lang.vm.ast;\n \n import org.apache.commons.lang3.StringUtils;\n \n-public class ASTBlock extends AbstractVmNode {\n+public final class ASTBlock extends AbstractVmNode {\n \n     ASTBlock(int id) {\n         super(id);\n"}}, {"oid": "b7cbab5d470fb9b597085a67b8567442fc230596", "url": "https://github.com/pmd/pmd/commit/b7cbab5d470fb9b597085a67b8567442fc230596", "message": "Update pmd-vm/src/main/java/net/sourceforge/pmd/lang/vm/ast/ASTBlock.java\n\nCo-Authored-By: Andreas Dangel <andreas.dangel@pmd-code.org>", "committedDate": "2020-02-21T13:42:52Z", "type": "commit"}, {"oid": "888340666ccb56efaa4577c2440c220d83b9672b", "url": "https://github.com/pmd/pmd/commit/888340666ccb56efaa4577c2440c220d83b9672b", "message": "Merge branch 'pmd/7.0.x' into pr-2289", "committedDate": "2020-03-12T20:19:43Z", "type": "commit"}, {"oid": "0680c4354b5cd2fce3bec40a10be2d1773e98122", "url": "https://github.com/pmd/pmd/commit/0680c4354b5cd2fce3bec40a10be2d1773e98122", "message": "[vm] Make AST nodes final", "committedDate": "2020-03-12T20:37:12Z", "type": "commit"}, {"oid": "0aa0333312ca3d16cbefa46efb7e665aa6490af9", "url": "https://github.com/pmd/pmd/commit/0aa0333312ca3d16cbefa46efb7e665aa6490af9", "message": "[vm] small refactoring for NodeUtils", "committedDate": "2020-03-12T20:44:47Z", "type": "commit"}, {"oid": "4fd87dab4a632899926ba3c7cf19ae8c7be00187", "url": "https://github.com/pmd/pmd/commit/4fd87dab4a632899926ba3c7cf19ae8c7be00187", "message": "[vm] Remove deprecated VelocityCharStream", "committedDate": "2020-03-12T20:45:05Z", "type": "commit"}, {"oid": "68a93e13c47bf18d5eaf1333001b6086994a9349", "url": "https://github.com/pmd/pmd/commit/68a93e13c47bf18d5eaf1333001b6086994a9349", "message": "[vm] Refactor ASTDirective\n\n* remove directive mapper\n* remove all directive helper classes", "committedDate": "2020-03-13T07:30:14Z", "type": "commit"}, {"oid": "e685c6aadeaa59310389e4710e944319b7a32bb2", "url": "https://github.com/pmd/pmd/commit/e685c6aadeaa59310389e4710e944319b7a32bb2", "message": "[vm] Refactor checkstyle warnings and suppressions", "committedDate": "2020-03-13T08:04:55Z", "type": "commit"}, {"oid": "36a23e108f9c8718bc10403cd5ca7b065cf2c4b7", "url": "https://github.com/pmd/pmd/commit/36a23e108f9c8718bc10403cd5ca7b065cf2c4b7", "message": "[vm] test data - whitespaces and CDATA", "committedDate": "2020-03-13T08:26:50Z", "type": "commit"}, {"oid": "1ac1cff01aeb43225ebda1a3584bae4c5df42a81", "url": "https://github.com/pmd/pmd/commit/1ac1cff01aeb43225ebda1a3584bae4c5df42a81", "message": "[vm] Fix more license headers", "committedDate": "2020-03-13T08:27:06Z", "type": "commit"}, {"oid": "bb58fcb47fda110f8b483d3b920628d56c0d3257", "url": "https://github.com/pmd/pmd/commit/bb58fcb47fda110f8b483d3b920628d56c0d3257", "message": "[vm] NodeUtils::tokenLiteral should be package private", "committedDate": "2020-03-13T08:27:21Z", "type": "commit"}]}