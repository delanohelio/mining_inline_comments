{"pr_number": 3190, "pr_title": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage", "pr_createdAt": "2020-10-27T05:58:21Z", "pr_url": "https://github.com/kiegroup/drools/pull/3190", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNTU5Mw==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512435593", "bodyText": "Basically, I will move test cases under org.drools.mvel.integrationtests which are usually DRL based tests. Once finished, I will likely check if there are any other good test cases to move.", "author": "tkobayas", "createdAt": "2020-10-27T06:04:39Z", "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;\n+\n+import java.util.Collection;\n+\n+import org.drools.mvel.compiler.Person;\n+import org.drools.testcoverage.common.util.KieBaseTestConfiguration;\n+import org.drools.testcoverage.common.util.KieBaseUtil;\n+import org.drools.testcoverage.common.util.TestParametersUtil;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import org.kie.api.KieBase;\n+import org.kie.api.runtime.KieSession;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+@RunWith(Parameterized.class)\n+public class AlphaNodeTest {", "originalCommit": "07265c3af57216870f8e206915c4d7faef1b61fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQ0MjY4MA==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512442680", "bodyText": "I heard that Luca (DROOLS-5731) will move drools-model-compiler test cases to a new module under drools-test-coverage (not test-compiler-integration) so we can keep the drools-model-compiler test cases almost unchanged.\nBut these drools-mvel tests are moved under test-compiler-integration. I don't have a strong reason but I thought they will fit well with existing test-compiler-integration test cases.", "author": "tkobayas", "createdAt": "2020-10-27T06:27:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNTU5Mw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNjM3Ng==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512436376", "bodyText": "Basically, I can replace CommonTestMethodBase.loadKnowledgeBaseFromString(drl) with KieBaseUtil methods. Now we can test with specified configurations (standard/flow/pattern).", "author": "tkobayas", "createdAt": "2020-10-27T06:07:27Z", "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;\n+\n+import java.util.Collection;\n+\n+import org.drools.mvel.compiler.Person;\n+import org.drools.testcoverage.common.util.KieBaseTestConfiguration;\n+import org.drools.testcoverage.common.util.KieBaseUtil;\n+import org.drools.testcoverage.common.util.TestParametersUtil;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import org.kie.api.KieBase;\n+import org.kie.api.runtime.KieSession;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+@RunWith(Parameterized.class)\n+public class AlphaNodeTest {\n+\n+    private final KieBaseTestConfiguration kieBaseTestConfiguration;\n+\n+    public AlphaNodeTest(final KieBaseTestConfiguration kieBaseTestConfiguration) {\n+        this.kieBaseTestConfiguration = kieBaseTestConfiguration;\n+    }\n+\n+    @Parameterized.Parameters(name = \"KieBase type={0}\")\n+    public static Collection<Object[]> getParameters() {\n+        return TestParametersUtil.getKieBaseCloudConfigurations(true);\n+    }\n+\n+    @Test\n+    public void testAlpha() {\n+        String str =\n+                \"import \" + Person.class.getCanonicalName() + \"\\n\" +\n+                \"rule R1 when\\n\" +\n+                \"  $p : Person(name == \\\"Mario\\\")\\n\" +\n+                \"then\\n\" +\n+                \"end\\n\";\n+\n+        KieBase kbase = KieBaseUtil.getKieBaseFromKieModuleFromDrl(\"test\", kieBaseTestConfiguration, str);", "originalCommit": "07265c3af57216870f8e206915c4d7faef1b61fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUxNDM4NQ==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512514385", "bodyText": "Yes good idea, I think one of the advantages of doing this is not having many different ways to instantiate a KieSession", "author": "lucamolteni", "createdAt": "2020-10-27T08:56:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNjM3Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzNjczOQ==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512436739", "bodyText": "I will follow the typical approach of test-compiler-integration", "author": "tkobayas", "createdAt": "2020-10-27T06:08:57Z", "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;\n+\n+import java.util.Collection;\n+\n+import org.drools.mvel.compiler.Person;\n+import org.drools.testcoverage.common.util.KieBaseTestConfiguration;\n+import org.drools.testcoverage.common.util.KieBaseUtil;\n+import org.drools.testcoverage.common.util.TestParametersUtil;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.Parameterized;\n+import org.kie.api.KieBase;\n+import org.kie.api.runtime.KieSession;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+@RunWith(Parameterized.class)\n+public class AlphaNodeTest {\n+\n+    private final KieBaseTestConfiguration kieBaseTestConfiguration;\n+\n+    public AlphaNodeTest(final KieBaseTestConfiguration kieBaseTestConfiguration) {\n+        this.kieBaseTestConfiguration = kieBaseTestConfiguration;\n+    }\n+\n+    @Parameterized.Parameters(name = \"KieBase type={0}\")\n+    public static Collection<Object[]> getParameters() {\n+        return TestParametersUtil.getKieBaseCloudConfigurations(true);\n+    }", "originalCommit": "07265c3af57216870f8e206915c4d7faef1b61fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzODI1OQ==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512438259", "bodyText": "At the moment, I use the same package name org.drools.mvel.integrationtests but probably it's not suitable after finishing the move because these tests are no longer specific to mvel. org.drools.compiler.integrationtests is already used by existing test cases. If you have a good candidate name, let me know :)", "author": "tkobayas", "createdAt": "2020-10-27T06:14:06Z", "path": "drools-test-coverage/test-compiler-integration/src/test/java/org/drools/mvel/integrationtests/AlphaNodeTest.java", "diffHunk": "@@ -0,0 +1,253 @@\n+/*\n+ * Copyright (c) 2020. Red Hat, Inc. and/or its affiliates.\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ *\n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.drools.mvel.integrationtests;", "originalCommit": "07265c3af57216870f8e206915c4d7faef1b61fc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjUxNjA0MQ==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r512516041", "bodyText": "I think that preserving the name might be better from the Git perspective but I'm not sure.\nWhile descoping I often change the package but I'm not sure it's a good idea", "author": "lucamolteni", "createdAt": "2020-10-27T08:59:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzODI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzE2NjM2Ng==", "url": "https://github.com/kiegroup/drools/pull/3190#discussion_r513166366", "bodyText": "Thank you for the input. Yeah, changing the name may just add extra works...", "author": "tkobayas", "createdAt": "2020-10-28T03:59:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjQzODI1OQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "0f559bb163ecfafec89f7fa19ef6b7d0e0221d06", "url": "https://github.com/kiegroup/drools/commit/0f559bb163ecfafec89f7fa19ef6b7d0e0221d06", "message": "- adding more test. WIP", "committedDate": "2020-11-02T07:07:09Z", "type": "forcePushed"}, {"oid": "678b65fde022f8aae660735bf15ee3ccb6239d98", "url": "https://github.com/kiegroup/drools/commit/678b65fde022f8aae660735bf15ee3ccb6239d98", "message": "- adding more test. WIP", "committedDate": "2020-11-02T10:13:48Z", "type": "forcePushed"}, {"oid": "2dc0e3452c9983fb85d8dc935d814eedba960172", "url": "https://github.com/kiegroup/drools/commit/2dc0e3452c9983fb85d8dc935d814eedba960172", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage", "committedDate": "2020-11-11T06:42:23Z", "type": "forcePushed"}, {"oid": "78d8850b3f3d45eea6132a5624c445da6d242ca6", "url": "https://github.com/kiegroup/drools/commit/78d8850b3f3d45eea6132a5624c445da6d242ca6", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage", "committedDate": "2020-11-12T07:08:31Z", "type": "commit"}, {"oid": "78d8850b3f3d45eea6132a5624c445da6d242ca6", "url": "https://github.com/kiegroup/drools/commit/78d8850b3f3d45eea6132a5624c445da6d242ca6", "message": "[DROOLS-5485] Move test cases from drools-mvel to drools-test-coverage", "committedDate": "2020-11-12T07:08:31Z", "type": "forcePushed"}, {"oid": "c1a09fbf6604dd7aa1643148cb68700a098b6468", "url": "https://github.com/kiegroup/drools/commit/c1a09fbf6604dd7aa1643148cb68700a098b6468", "message": "- Consolidate dependendies", "committedDate": "2020-11-13T05:50:19Z", "type": "commit"}]}