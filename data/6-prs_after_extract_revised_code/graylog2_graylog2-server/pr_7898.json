{"pr_number": 7898, "pr_title": "Add Jenkinsfile for new Jenkins server", "pr_createdAt": "2020-04-16T20:27:29Z", "pr_url": "https://github.com/Graylog2/graylog2-server/pull/7898", "timeline": [{"oid": "79768928a4e53b009d4aba42cccab19f6bdf7313", "url": "https://github.com/Graylog2/graylog2-server/commit/79768928a4e53b009d4aba42cccab19f6bdf7313", "message": "Add Jenkinsfile for new Jenkins server", "committedDate": "2020-04-16T20:10:28Z", "type": "commit"}, {"oid": "3868ccc3b5e78993333917d1426e1aeaeca10024", "url": "https://github.com/Graylog2/graylog2-server/commit/3868ccc3b5e78993333917d1426e1aeaeca10024", "message": "update method name", "committedDate": "2020-04-17T19:49:40Z", "type": "commit"}, {"oid": "dd72e36f396d11f3ec2f3b43ea45e46f5b62e8bc", "url": "https://github.com/Graylog2/graylog2-server/commit/dd72e36f396d11f3ec2f3b43ea45e46f5b62e8bc", "message": "testing Jenkins triggers", "committedDate": "2020-04-20T14:39:08Z", "type": "commit"}, {"oid": "fbd0211d5ddafe0b0dff0f242a5bfdc09b3b43c1", "url": "https://github.com/Graylog2/graylog2-server/commit/fbd0211d5ddafe0b0dff0f242a5bfdc09b3b43c1", "message": "testing triggers", "committedDate": "2020-04-20T15:10:31Z", "type": "commit"}, {"oid": "cca5cc0f76153e424c6bda2ac8281ec7568406bb", "url": "https://github.com/Graylog2/graylog2-server/commit/cca5cc0f76153e424c6bda2ac8281ec7568406bb", "message": "Merge branch 'master' into jenkins", "committedDate": "2020-04-22T13:17:22Z", "type": "commit"}, {"oid": "029282eb7a18d8c8731436a63c26a5749f419a44", "url": "https://github.com/Graylog2/graylog2-server/commit/029282eb7a18d8c8731436a63c26a5749f419a44", "message": "fix issue where test fails when building in docker", "committedDate": "2020-04-22T13:28:40Z", "type": "commit"}, {"oid": "d93abd0e946d975a44828e338fd05db8145d6bfa", "url": "https://github.com/Graylog2/graylog2-server/commit/d93abd0e946d975a44828e338fd05db8145d6bfa", "message": "Merge branch 'master' into jenkins", "committedDate": "2020-04-27T15:12:07Z", "type": "commit"}, {"oid": "0085469981c523bbd1270e06d20966979c959bc2", "url": "https://github.com/Graylog2/graylog2-server/commit/0085469981c523bbd1270e06d20966979c959bc2", "message": "change name of jenkins pipeline file", "committedDate": "2020-04-27T15:12:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk2MzY2Mg==", "url": "https://github.com/Graylog2/graylog2-server/pull/7898#discussion_r415963662", "bodyText": "I think this change to AbsoluteRange.java should not be in there. We need to do some more careful research & testing to ensure we can do this.", "author": "bernd", "createdAt": "2020-04-27T16:29:40Z", "path": "graylog2-server/src/main/java/org/graylog2/plugin/indexer/searches/timeranges/AbsoluteRange.java", "diffHunk": "@@ -115,14 +114,13 @@ private DateTime parseDateTime(String s) {\n                 throw new IllegalArgumentException(\"Null or empty string\");\n             }\n \n-            final DateTimeFormatter formatter;", "originalCommit": "0085469981c523bbd1270e06d20966979c959bc2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNjEyNDIxMw==", "url": "https://github.com/Graylog2/graylog2-server/pull/7898#discussion_r416124213", "bodyText": "You're right, I forgot to remove that. It's reverted now.", "author": "malcyon", "createdAt": "2020-04-27T20:26:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTk2MzY2Mg=="}], "type": "inlineReview", "revised_code": {"commit": "9adcc9e57e0db225040e6654b867958f13e77643", "chunk": "diff --git a/graylog2-server/src/main/java/org/graylog2/plugin/indexer/searches/timeranges/AbsoluteRange.java b/graylog2-server/src/main/java/org/graylog2/plugin/indexer/searches/timeranges/AbsoluteRange.java\nindex 57c127d65f..21a7a80781 100644\n--- a/graylog2-server/src/main/java/org/graylog2/plugin/indexer/searches/timeranges/AbsoluteRange.java\n+++ b/graylog2-server/src/main/java/org/graylog2/plugin/indexer/searches/timeranges/AbsoluteRange.java\n\n@@ -114,13 +115,14 @@ public abstract class AbsoluteRange extends TimeRange {\n                 throw new IllegalArgumentException(\"Null or empty string\");\n             }\n \n+            final DateTimeFormatter formatter;\n             if (s.contains(\"T\")) {\n-                // Use withOffsetParsed() to keep the timezone!\n-                return ISODateTimeFormat.dateTime().withOffsetParsed().parseDateTime(s);\n+                formatter = ISODateTimeFormat.dateTime();\n             } else {\n-                // Our Elasticsearch timestamp format is always UTC\n-                return Tools.timeFormatterWithOptionalMilliseconds().withZoneUTC().parseDateTime(s);\n+                formatter = Tools.timeFormatterWithOptionalMilliseconds();\n             }\n+            // Use withOffsetParsed() to keep the timezone!\n+            return formatter.withOffsetParsed().parseDateTime(s);\n         }\n     }\n }\n"}}, {"oid": "9adcc9e57e0db225040e6654b867958f13e77643", "url": "https://github.com/Graylog2/graylog2-server/commit/9adcc9e57e0db225040e6654b867958f13e77643", "message": "Undo timezone changes.", "committedDate": "2020-04-27T18:23:51Z", "type": "commit"}]}