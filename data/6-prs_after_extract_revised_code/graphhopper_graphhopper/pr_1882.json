{"pr_number": 1882, "pr_title": "Improve turn instructions when leaving the roads", "pr_createdAt": "2020-01-29T17:35:02Z", "pr_url": "https://github.com/graphhopper/graphhopper/pull/1882", "timeline": [{"oid": "e618ab543010286645ea64d90245f404222d0176", "url": "https://github.com/graphhopper/graphhopper/commit/e618ab543010286645ea64d90245f404222d0176", "message": "Improve turn instructions when leaving the roads", "committedDate": "2020-01-29T17:25:09Z", "type": "commit"}, {"oid": "248fed1431e56986fb70738324dfaaebeb7fd00d", "url": "https://github.com/graphhopper/graphhopper/commit/248fed1431e56986fb70738324dfaaebeb7fd00d", "message": "Merge branch 'master' into add_turns_when_leaving_the_road", "committedDate": "2020-02-03T16:09:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIwNTc1NA==", "url": "https://github.com/graphhopper/graphhopper/pull/1882#discussion_r374205754", "bodyText": "Can you refactor this to the normal Java style getAllowedTurns? (e.g. see GraphHopper.getWorkerThreads)", "author": "karussell", "createdAt": "2020-02-03T16:31:59Z", "path": "core/src/main/java/com/graphhopper/routing/InstructionsFromEdges.java", "diffHunk": "@@ -391,12 +391,12 @@ private int getTurn(EdgeIteratorState edge, int baseNode, int prevNode, int adjN\n             forceInstruction = true;\n         }\n \n-        InstructionsOutgoingEdges outgoingEdges = new InstructionsOutgoingEdges(prevEdge, edge, encoder, maxSpeedEnc, crossingExplorer, nodeAccess, prevNode, baseNode, adjNode);\n-        int nrOfPossibleTurns = outgoingEdges.nrOfAllowedOutgoingEdges();\n+        InstructionsOutgoingEdges outgoingEdges = new InstructionsOutgoingEdges(prevEdge, edge, encoder, maxSpeedEnc, roadClassEnc, roadClassLinkEnc, crossingExplorer, nodeAccess, prevNode, baseNode, adjNode);\n+        int nrOfPossibleTurns = outgoingEdges.nrOfAllowedTurns();", "originalCommit": "248fed1431e56986fb70738324dfaaebeb7fd00d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDc2ODAyMA==", "url": "https://github.com/graphhopper/graphhopper/pull/1882#discussion_r374768020", "bodyText": "Sure, I just pushed this change.", "author": "boldtrn", "createdAt": "2020-02-04T16:10:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDIwNTc1NA=="}], "type": "inlineReview", "revised_code": {"commit": "b9b71a0bcdf4524d7c3a5c6d7f1448b2e0de071c", "chunk": "diff --git a/core/src/main/java/com/graphhopper/routing/InstructionsFromEdges.java b/core/src/main/java/com/graphhopper/routing/InstructionsFromEdges.java\nindex e88b662f5..1d7a128d8 100644\n--- a/core/src/main/java/com/graphhopper/routing/InstructionsFromEdges.java\n+++ b/core/src/main/java/com/graphhopper/routing/InstructionsFromEdges.java\n\n@@ -392,11 +392,11 @@ public class InstructionsFromEdges implements Path.EdgeVisitor {\n         }\n \n         InstructionsOutgoingEdges outgoingEdges = new InstructionsOutgoingEdges(prevEdge, edge, encoder, maxSpeedEnc, roadClassEnc, roadClassLinkEnc, crossingExplorer, nodeAccess, prevNode, baseNode, adjNode);\n-        int nrOfPossibleTurns = outgoingEdges.nrOfAllowedTurns();\n+        int nrOfPossibleTurns = outgoingEdges.getAllowedTurns();\n \n         // there is no other turn possible\n         if (nrOfPossibleTurns <= 1) {\n-            if (Math.abs(sign) > 1 && outgoingEdges.nrOfVisibleTurns() > 1) {\n+            if (Math.abs(sign) > 1 && outgoingEdges.getVisibleTurns() > 1) {\n                 // This is an actual turn because |sign| > 1\n                 // There could be some confusion, if we would not create a turn instruction, even though it is the only\n                 // possible turn, also see #1048\n"}}, {"oid": "b9b71a0bcdf4524d7c3a5c6d7f1448b2e0de071c", "url": "https://github.com/graphhopper/graphhopper/commit/b9b71a0bcdf4524d7c3a5c6d7f1448b2e0de071c", "message": "Rename nrOf to get following default Java naming.", "committedDate": "2020-02-04T16:10:12Z", "type": "commit"}, {"oid": "d58ced31f51321c251adc3239853bb8ba188efbb", "url": "https://github.com/graphhopper/graphhopper/commit/d58ced31f51321c251adc3239853bb8ba188efbb", "message": "Merge branch 'master' into add_turns_when_leaving_the_road", "committedDate": "2020-02-04T16:11:20Z", "type": "commit"}]}