{"pr_number": 1892, "pr_title": "highway=path and bicycle=yes should not get speed for pushing section", "pr_createdAt": "2020-02-06T21:01:24Z", "pr_url": "https://github.com/graphhopper/graphhopper/pull/1892", "timeline": [{"oid": "0146ff5f5c504dd11597fc45fb4cb04115f8914c", "url": "https://github.com/graphhopper/graphhopper/commit/0146ff5f5c504dd11597fc45fb4cb04115f8914c", "message": "highway=pathPath and bicycle=yes should not get speed for pushing section\nSee https://discuss.graphhopper.com/t/bike-profil-highway-pathpath-and-bicycle-yes-should-not-get-speed-for-pushing-section/5148", "committedDate": "2020-02-06T20:51:03Z", "type": "commit"}, {"oid": "ef9bfe9891c3985cfe7f844865405d47dfebe939", "url": "https://github.com/graphhopper/graphhopper/commit/ef9bfe9891c3985cfe7f844865405d47dfebe939", "message": "Merge branch 'master' into highway=pathPathAndbicycle=yesNopushingSection", "committedDate": "2020-02-21T15:04:37Z", "type": "commit"}, {"oid": "5875fa4e58f2ac16b592b88cbacc08b74f19d464", "url": "https://github.com/graphhopper/graphhopper/commit/5875fa4e58f2ac16b592b88cbacc08b74f19d464", "message": "Reduce speed for bicycle=yes on a pushing section part from 14km/h to 10km/h.", "committedDate": "2020-02-22T16:32:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkyNzQyNQ==", "url": "https://github.com/graphhopper/graphhopper/pull/1892#discussion_r382927425", "bodyText": "For nested if-else blocks can you add the brackets?", "author": "karussell", "createdAt": "2020-02-22T17:18:17Z", "path": "core/src/main/java/com/graphhopper/routing/util/BikeCommonFlagEncoder.java", "diffHunk": "@@ -375,15 +376,22 @@ int getSpeed(ReaderWay way) {\n                     speed = PUSHING_SECTION_SPEED / 2;\n                 else\n                     speed = PUSHING_SECTION_SPEED;\n-            } else if (way.hasTag(\"bicycle\", \"designated\") || way.hasTag(\"bicycle\", \"official\")) {\n+            } else if (way.hasTag(\"bicycle\", \"designated\") || \n+                       way.hasTag(\"bicycle\", \"official\")   || \n+                       way.hasTag(\"segregated\", \"yes\")    ||\n+                       way.hasTag(\"bicycle\", \"yes\")) {\n                 // Here we handle the cases where the OSM tagging results in something similar to \"highway=cycleway\"\n-                speed = highwaySpeeds.get(\"cycleway\");\n-            } else {\n-                speed = PUSHING_SECTION_SPEED;\n-            }\n-            // Increase speed in case of segregated\n-            if (speed <= PUSHING_SECTION_SPEED && way.hasTag(\"segregated\", \"yes\"))\n-                speed = PUSHING_SECTION_SPEED * 2;\n+                    if (way.hasTag(\"segregated\", \"yes\"))\n+                        speed = highwaySpeeds.get(\"cycleway\");\n+                    else\n+                        if  (way.hasTag(\"bicycle\", \"yes\"))\n+                            speed = 10;\n+                        else\n+                            speed = highwaySpeeds.get(\"cycleway\");", "originalCommit": "5875fa4e58f2ac16b592b88cbacc08b74f19d464", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4abf31b395c525c17edf7cf521da073c4d3b3163", "chunk": "diff --git a/core/src/main/java/com/graphhopper/routing/util/BikeCommonFlagEncoder.java b/core/src/main/java/com/graphhopper/routing/util/BikeCommonFlagEncoder.java\nindex b3b97abb9..6c322acca 100644\n--- a/core/src/main/java/com/graphhopper/routing/util/BikeCommonFlagEncoder.java\n+++ b/core/src/main/java/com/graphhopper/routing/util/BikeCommonFlagEncoder.java\n\n@@ -378,20 +378,22 @@ abstract public class BikeCommonFlagEncoder extends AbstractFlagEncoder {\n                     speed = PUSHING_SECTION_SPEED;\n             } else if (way.hasTag(\"bicycle\", \"designated\") || \n                        way.hasTag(\"bicycle\", \"official\")   || \n-                       way.hasTag(\"segregated\", \"yes\")    ||\n-                       way.hasTag(\"bicycle\", \"yes\")) {\n-                // Here we handle the cases where the OSM tagging results in something similar to \"highway=cycleway\"\n-                    if (way.hasTag(\"segregated\", \"yes\"))\n-                        speed = highwaySpeeds.get(\"cycleway\");\n-                    else\n-                        if  (way.hasTag(\"bicycle\", \"yes\"))\n-                            speed = 10;\n-                        else\n-                            speed = highwaySpeeds.get(\"cycleway\");\n-                if ((surfaceSpeed>0) && (surfaceSpeed < speed))\n-                    //Here we overwrite our speed again in case we have a valid surface speed and if it is smaller as computed so far\n-                    speed = surfaceSpeed;\n-            } \n+                       way.hasTag(\"segregated\", \"yes\")     ||\n+                       way.hasTag(\"bicycle\", \"yes\"))   {\n+                          // Here we handle the cases where the OSM tagging results in something similar to \"highway=cycleway\"\n+                          if (way.hasTag(\"segregated\", \"yes\"))\n+                              speed = highwaySpeeds.get(\"cycleway\");\n+                          else   {\n+                              if  (way.hasTag(\"bicycle\", \"yes\"))\n+                                  speed = 10;\n+                              else\n+                                  speed = highwaySpeeds.get(\"cycleway\");\n+                          }\n+                          if ((surfaceSpeed>0) && (surfaceSpeed < speed))   {\n+                              //Here we overwrite our speed again in case we have a valid surface speed and if it is smaller as computed so far\n+                              speed = surfaceSpeed;\n+                          }\n+                       }\n         }\n         return speed;\n     }\n"}}, {"oid": "4abf31b395c525c17edf7cf521da073c4d3b3163", "url": "https://github.com/graphhopper/graphhopper/commit/4abf31b395c525c17edf7cf521da073c4d3b3163", "message": "Indentations fixed.", "committedDate": "2020-02-22T17:53:43Z", "type": "commit"}, {"oid": "34c3cda01cb56067d60b4b7e81f9b3b407080603", "url": "https://github.com/graphhopper/graphhopper/commit/34c3cda01cb56067d60b4b7e81f9b3b407080603", "message": "indentation", "committedDate": "2020-02-23T13:23:21Z", "type": "commit"}]}