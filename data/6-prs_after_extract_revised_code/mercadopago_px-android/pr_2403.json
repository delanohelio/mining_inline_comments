{"pr_number": 2403, "pr_title": "[Feature][ci size] Web Pay -  Bottom Sheet", "pr_createdAt": "2020-12-17T17:24:01Z", "pr_url": "https://github.com/mercadopago/px-android/pull/2403", "timeline": [{"oid": "7f20189f7061c4a16457d3881ef755b36fe9e234", "url": "https://github.com/mercadopago/px-android/commit/7f20189f7061c4a16457d3881ef755b36fe9e234", "message": "[Feature] Card form bottom sheet (#2390)\n\n* add sheet option model\r\n\r\n* card form bottom sheet\r\n\r\n* recycler view and adepter added\r\n\r\n* cardformoption click listener added\r\n\r\n* add init type to new card meta data\r\n\r\n* refactor recycler view adapter\r\n\r\n* revert changes\r\n\r\n* refactor open card form\r\n\r\n* add code\r\n\r\n* rename file\r\n\r\n* update text sizes\r\n\r\n* rename package\r\n\r\n* rename package again\r\n\r\n* review changes\r\n\r\n* update layout sheet option\r\n\r\n* refactor header bottom sheet\r\n\r\n* change name method", "committedDate": "2020-11-27T20:04:43Z", "type": "commit"}, {"oid": "bcfc9211ea73812aa8d230ade74c33d1b19396d9", "url": "https://github.com/mercadopago/px-android/commit/bcfc9211ea73812aa8d230ade74c33d1b19396d9", "message": "Merge branch 'master' of github.com:mercadopago/px-android into feature/web-pay", "committedDate": "2020-12-11T14:27:07Z", "type": "commit"}, {"oid": "c1bb9e5f149263fa7366b473ce69ec5a0e081333", "url": "https://github.com/mercadopago/px-android/commit/c1bb9e5f149263fa7366b473ce69ec5a0e081333", "message": "change margins sheet options row (#2395)", "committedDate": "2020-12-11T14:44:50Z", "type": "commit"}, {"oid": "68afbd05009fac59761b01735b03228787eb1d20", "url": "https://github.com/mercadopago/px-android/commit/68afbd05009fac59761b01735b03228787eb1d20", "message": "[Feature] card form web pay integration (#2402)\n\n* add sheet option model\r\n\r\n* card form bottom sheet\r\n\r\n* recycler view and adepter added\r\n\r\n* cardformoption click listener added\r\n\r\n* add init type to new card meta data\r\n\r\n* refactor recycler view adapter\r\n\r\n* revert changes\r\n\r\n* refactor open card form\r\n\r\n* add code\r\n\r\n* rename file\r\n\r\n* update text sizes\r\n\r\n* rename package\r\n\r\n* rename package again\r\n\r\n* review changes\r\n\r\n* update layout sheet option\r\n\r\n* refactor header bottom sheet\r\n\r\n* change name method\r\n\r\n* change margins sheet options row\r\n\r\n* card form web pay integration\r\n\r\n* process card form result\r\n\r\n* Update init cardform for webpay\r\n\r\n* card form webpay added\r\n\r\n* delete imports\r\n\r\n* logic step was to launch cardform to onetap fragment\r\n\r\n* card form option validation fixed", "committedDate": "2020-12-17T16:03:14Z", "type": "commit"}, {"oid": "639824a2c3ff1ed0ca73a513b69c655dba46cfba", "url": "https://github.com/mercadopago/px-android/commit/639824a2c3ff1ed0ca73a513b69c655dba46cfba", "message": "experimental configuration added", "committedDate": "2020-12-18T14:42:17Z", "type": "commit"}, {"oid": "5604fe6e7da46313eb4e9bce52e78aa771ffee68", "url": "https://github.com/mercadopago/px-android/commit/5604fe6e7da46313eb4e9bce52e78aa771ffee68", "message": "fixed", "committedDate": "2020-12-18T15:49:35Z", "type": "commit"}, {"oid": "b410ca2b73b66e0aff36965bed0a4d6b772ed829", "url": "https://github.com/mercadopago/px-android/commit/b410ca2b73b66e0aff36965bed0a4d6b772ed829", "message": "merge with master", "committedDate": "2020-12-18T16:26:07Z", "type": "commit"}, {"oid": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "url": "https://github.com/mercadopago/px-android/commit/34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "message": "Update cardform version and build gradle", "committedDate": "2021-01-06T20:42:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4NTY0MA==", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553385640", "bodyText": "qued\u00f3 de m\u00e1s", "author": "cgaggino", "createdAt": "2021-01-07T15:07:36Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java", "diffHunk": "@@ -53,10 +61,11 @@\n import com.mercadopago.android.px.internal.features.pay_button.PayButton;\n import com.mercadopago.android.px.internal.features.pay_button.PayButtonFragment;\n import com.mercadopago.android.px.internal.features.security_code.SecurityCodeFragment;\n-import com.mercadopago.android.px.internal.util.CardFormWithFragmentWrapper;\n+import com.mercadopago.android.px.internal.util.CardFormWrapper;\n import com.mercadopago.android.px.internal.util.ErrorUtil;\n import com.mercadopago.android.px.internal.util.Logger;\n import com.mercadopago.android.px.internal.util.VibrationUtils;\n+import com.mercadopago.android.px.internal.util.ViewUtils;", "originalCommit": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3acc191a017cf9e9f58248548315c55e49481d50", "chunk": "diff --git a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java\nindex 47a0c622f..403ac2ecd 100644\n--- a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java\n+++ b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/ExpressPaymentFragment.java\n\n@@ -65,7 +64,6 @@ import com.mercadopago.android.px.internal.util.CardFormWrapper;\n import com.mercadopago.android.px.internal.util.ErrorUtil;\n import com.mercadopago.android.px.internal.util.Logger;\n import com.mercadopago.android.px.internal.util.VibrationUtils;\n-import com.mercadopago.android.px.internal.util.ViewUtils;\n import com.mercadopago.android.px.internal.view.DiscountDetailDialog;\n import com.mercadopago.android.px.internal.view.DynamicHeightViewPager;\n import com.mercadopago.android.px.internal.view.ElementDescriptorView;\n"}}, {"oid": "3acc191a017cf9e9f58248548315c55e49481d50", "url": "https://github.com/mercadopago/px-android/commit/3acc191a017cf9e9f58248548315c55e49481d50", "message": "remove imports", "committedDate": "2021-01-07T15:16:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MTcwNw==", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553391707", "bodyText": "Podemos cambiarle el nombre a solo webpay? no dice mucho TBK", "author": "cgaggino", "createdAt": "2021-01-07T15:17:28Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java", "diffHunk": "@@ -145,15 +174,30 @@ protected void loadImage(@NonNull final View view, @DrawableRes final int imageR\n     }\n \n     @Override\n-    public void startCardForm(@NonNull final CardFormWithFragmentWrapper cardFormWithFragmentWrapper) {\n-        final FragmentManager manager;\n-        if (getParentFragment() != null && (manager = getParentFragment().getFragmentManager()) != null) {\n-            cardFormWithFragmentWrapper.getCardFormWithFragment()\n-                .start(manager, ExpressPaymentFragment.REQ_CODE_CARD_FORM, R.id.one_tap_fragment);\n+    public void startCardForm(@NonNull final CardFormWrapper cardFormWrapper, @NonNull final CardFormInitType initType) {\n+        switch (initType) {\n+            case STANDARD: {\n+                final FragmentManager manager;\n+                if (getParentFragment() != null && (manager = getParentFragment().getFragmentManager()) != null) {\n+                    cardFormWrapper.getCardFormWithFragment()\n+                        .start(manager, REQ_CODE_CARD_FORM, R.id.one_tap_fragment);\n+                }\n+                break;\n+            }\n+            case WEBPAY_TBK: {", "originalCommit": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MzU5OA==", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553393598", "bodyText": "Si se puede, lo cambio a WEB_PAY", "author": "jorGonzalez291292", "createdAt": "2021-01-07T15:20:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MTcwNw=="}], "type": "inlineReview", "revised_code": {"commit": "3e20a32a198c736cfda07a20179ef74431c52d45", "chunk": "diff --git a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java\nindex 493460729..323956cf2 100644\n--- a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java\n+++ b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodFragment.java\n\n@@ -184,7 +184,7 @@ public class OtherPaymentMethodFragment\n                 }\n                 break;\n             }\n-            case WEBPAY_TBK: {\n+            case WEB_PAY: {\n                 final Fragment fragment;\n                 if ((fragment = getParentFragment()) != null) {\n                     cardFormWrapper.getCardFormWithWebView().start(fragment, REQ_CARD_FORM_WEB_VIEW);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MTk3Ng==", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553391976", "bodyText": "Es nonnull?", "author": "cgaggino", "createdAt": "2021-01-07T15:17:50Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodPresenter.java", "diffHunk": "@@ -2,23 +2,19 @@\n \n import androidx.annotation.NonNull;\n import com.mercadopago.android.px.internal.base.BasePresenter;\n-import com.mercadopago.android.px.internal.repository.PaymentSettingRepository;\n-import com.mercadopago.android.px.internal.tracking.TrackingRepository;\n-import com.mercadopago.android.px.internal.util.CardFormWithFragmentWrapper;\n+import com.mercadopago.android.px.internal.util.CardFormWrapper;\n+import com.mercadopago.android.px.model.CardFormInitType;\n \n public class OtherPaymentMethodPresenter extends BasePresenter<AddNewCard.View> implements AddNewCard.Actions {\n \n-    private final PaymentSettingRepository settingRepository;\n-    @NonNull private final TrackingRepository trackingRepository;\n+    @NonNull private final CardFormWrapper cardFormWrapper;\n \n-    /* default */ OtherPaymentMethodPresenter(@NonNull final PaymentSettingRepository settingRepository,\n-        @NonNull final TrackingRepository trackingRepository) {\n-        this.settingRepository = settingRepository;\n-        this.trackingRepository = trackingRepository;\n+    /* default */ OtherPaymentMethodPresenter(@NonNull final CardFormWrapper cardFormWrapper) {\n+        this.cardFormWrapper = cardFormWrapper;\n     }\n \n     @Override\n-    public void onAddNewCardSelected() {\n-        getView().startCardForm(new CardFormWithFragmentWrapper(settingRepository, trackingRepository));\n+    public void onAddNewCardSelected(final CardFormInitType initType) {", "originalCommit": "34ca768dedd0bfcfe5c9c5fb7c961c4b87e28ab1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzQwODI2Ng==", "url": "https://github.com/mercadopago/px-android/pull/2403#discussion_r553408266", "bodyText": "Si, agrego el @nonnull.", "author": "jorGonzalez291292", "createdAt": "2021-01-07T15:42:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM5MTk3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "3e20a32a198c736cfda07a20179ef74431c52d45", "chunk": "diff --git a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodPresenter.java b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodPresenter.java\nindex 22e5629cf..488ff4fc3 100644\n--- a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodPresenter.java\n+++ b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/express/add_new_card/OtherPaymentMethodPresenter.java\n\n@@ -14,7 +14,7 @@ public class OtherPaymentMethodPresenter extends BasePresenter<AddNewCard.View>\n     }\n \n     @Override\n-    public void onAddNewCardSelected(final CardFormInitType initType) {\n+    public void onAddNewCardSelected(@NonNull final CardFormInitType initType) {\n         getView().startCardForm(cardFormWrapper, initType);\n     }\n }\n\\ No newline at end of file\n"}}, {"oid": "3e20a32a198c736cfda07a20179ef74431c52d45", "url": "https://github.com/mercadopago/px-android/commit/3e20a32a198c736cfda07a20179ef74431c52d45", "message": "request changes", "committedDate": "2021-01-07T15:39:18Z", "type": "commit"}, {"oid": "fb63b388b7dd5035e322b388e4496d3e9a4266cd", "url": "https://github.com/mercadopago/px-android/commit/fb63b388b7dd5035e322b388e4496d3e9a4266cd", "message": "add NonNull annotation", "committedDate": "2021-01-07T15:57:52Z", "type": "commit"}]}