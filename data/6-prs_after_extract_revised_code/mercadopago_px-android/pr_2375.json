{"pr_number": 2375, "pr_title": "[Feature] Autoreturn and dynamic congrats buttons from backend", "pr_createdAt": "2020-11-05T23:01:59Z", "pr_url": "https://github.com/mercadopago/px-android/pull/2375", "timeline": [{"oid": "9884c2d91895178ce047694397d3f0cbb80031f8", "url": "https://github.com/mercadopago/px-android/commit/9884c2d91895178ce047694397d3f0cbb80031f8", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-05T23:10:36Z", "type": "forcePushed"}, {"oid": "718def909a1f29e726feebf5c3bedcbbb387056f", "url": "https://github.com/mercadopago/px-android/commit/718def909a1f29e726feebf5c3bedcbbb387056f", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-06T15:54:00Z", "type": "forcePushed"}, {"oid": "52d1d60787ca77e165bbf3692c4e273e04acedc0", "url": "https://github.com/mercadopago/px-android/commit/52d1d60787ca77e165bbf3692c4e273e04acedc0", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-06T22:24:47Z", "type": "forcePushed"}, {"oid": "d365d54b632b505e2126530733622e753e5b8682", "url": "https://github.com/mercadopago/px-android/commit/d365d54b632b505e2126530733622e753e5b8682", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T14:45:00Z", "type": "forcePushed"}, {"oid": "6f469e680249fe2f6e20b44f4630502f7ebbf2fb", "url": "https://github.com/mercadopago/px-android/commit/6f469e680249fe2f6e20b44f4630502f7ebbf2fb", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T14:48:09Z", "type": "forcePushed"}, {"oid": "c00dbe6899a139d17053d5c5bfe4063d620963ee", "url": "https://github.com/mercadopago/px-android/commit/c00dbe6899a139d17053d5c5bfe4063d620963ee", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T14:49:42Z", "type": "forcePushed"}, {"oid": "18fb3c347c8bf541a9859ee59a0e2faaebe8842d", "url": "https://github.com/mercadopago/px-android/commit/18fb3c347c8bf541a9859ee59a0e2faaebe8842d", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T14:53:44Z", "type": "forcePushed"}, {"oid": "5c86b9fed8aabcf484a6f597ab5a267f23039976", "url": "https://github.com/mercadopago/px-android/commit/5c86b9fed8aabcf484a6f597ab5a267f23039976", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T14:57:07Z", "type": "forcePushed"}, {"oid": "44f170988c1185b09b3894a07723ea3060f571f6", "url": "https://github.com/mercadopago/px-android/commit/44f170988c1185b09b3894a07723ea3060f571f6", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T14:59:44Z", "type": "forcePushed"}, {"oid": "8c46111d03d66d6a6bca68312c14a12995af8302", "url": "https://github.com/mercadopago/px-android/commit/8c46111d03d66d6a6bca68312c14a12995af8302", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T18:32:42Z", "type": "forcePushed"}, {"oid": "10c6343af2053c8b5d04368a4a3abf75f9994145", "url": "https://github.com/mercadopago/px-android/commit/10c6343af2053c8b5d04368a4a3abf75f9994145", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-09T18:50:23Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDczMDY4NA==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520730684", "bodyText": "Esto lo vamos a dejar as\u00ed o lo vamos a revertir? si queda as\u00ed pongamosle un nombre representativo a cada key", "author": "cgaggino", "createdAt": "2020-11-10T17:13:35Z", "path": "example/src/main/java/com/mercadopago/android/px/utils/OneTapSamples.java", "diffHunk": "@@ -177,9 +175,9 @@ public static void addAll(final Collection<Pair<String, MercadoPagoCheckout.Buil\n             .setExpressPaymentEnable(true)\n             .build();\n \n-        return new MercadoPagoCheckout.Builder(ONE_TAP_DIRECT_DISCOUNT_MERCHANT_PUBLIC_KEY, preference,\n+        return new MercadoPagoCheckout.Builder(\"APP_USR-073af6f6-9b85-414f-8bc1-4792a0568a62\", \"506902649-2140324c-55c5-4f0a-a1bb-15666443f215\"/*preference*/,", "originalCommit": "10c6343af2053c8b5d04368a4a3abf75f9994145", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc2NTY2MA==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520765660", "bodyText": "Lo vamos a revertir", "author": "guchito9", "createdAt": "2020-11-10T18:06:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDczMDY4NA=="}], "type": "inlineReview", "revised_code": {"commit": "920640c83707d52ca2e62386cd13e3ddd77f431b", "chunk": "diff --git a/example/src/main/java/com/mercadopago/android/px/utils/OneTapSamples.java b/example/src/main/java/com/mercadopago/android/px/utils/OneTapSamples.java\nindex 4a2a3a200..f451a27b4 100644\n--- a/example/src/main/java/com/mercadopago/android/px/utils/OneTapSamples.java\n+++ b/example/src/main/java/com/mercadopago/android/px/utils/OneTapSamples.java\n\n@@ -175,9 +177,9 @@ public final class OneTapSamples {\n             .setExpressPaymentEnable(true)\n             .build();\n \n-        return new MercadoPagoCheckout.Builder(\"APP_USR-073af6f6-9b85-414f-8bc1-4792a0568a62\", \"506902649-2140324c-55c5-4f0a-a1bb-15666443f215\"/*preference*/,\n+        return new MercadoPagoCheckout.Builder(ONE_TAP_DIRECT_DISCOUNT_MERCHANT_PUBLIC_KEY, preference,\n             paymentConfiguration)\n-            .setPrivateKey(ONE_TAP_PAYER_2_ACCESS_TOKEN)\n+            .setPrivateKey(ONE_TAP_PAYER_1_ACCESS_TOKEN)\n             .setAdvancedConfiguration(advancedConfiguration)\n             .setTrackingConfiguration(trackingConfiguration);\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDczMTY3Ng==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520731676", "bodyText": "A esta altura estoy pensando que podriamos mandar el status detail por par\u00e1metro y que cada ejemplo use el rejected que quiera", "author": "cgaggino", "createdAt": "2020-11-10T17:14:58Z", "path": "example/src/main/java/com/mercadopago/android/px/utils/PaymentUtils.java", "diffHunk": "@@ -36,7 +37,7 @@ public static IParcelablePaymentDescriptor getGenericPaymentApproved() {\n     public static IParcelablePaymentDescriptor getGenericPaymentRejected() {\n         return GenericPaymentDescriptor.with(new GenericPayment.Builder(\n             Payment.StatusCodes.STATUS_REJECTED,\n-            Payment.StatusDetail.STATUS_DETAIL_CC_REJECTED_HIGH_RISK\n+            Payment.StatusDetail.STATUS_DETAIL_CC_REJECTED_CARD_DISABLED", "originalCommit": "10c6343af2053c8b5d04368a4a3abf75f9994145", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc2NTk1OA==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520765958", "bodyText": "Es buena esa", "author": "guchito9", "createdAt": "2020-11-10T18:06:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDczMTY3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "920640c83707d52ca2e62386cd13e3ddd77f431b", "chunk": "diff --git a/example/src/main/java/com/mercadopago/android/px/utils/PaymentUtils.java b/example/src/main/java/com/mercadopago/android/px/utils/PaymentUtils.java\nindex 9f3f41cb4..9627add51 100644\n--- a/example/src/main/java/com/mercadopago/android/px/utils/PaymentUtils.java\n+++ b/example/src/main/java/com/mercadopago/android/px/utils/PaymentUtils.java\n\n@@ -37,7 +37,7 @@ public final class PaymentUtils {\n     public static IParcelablePaymentDescriptor getGenericPaymentRejected() {\n         return GenericPaymentDescriptor.with(new GenericPayment.Builder(\n             Payment.StatusCodes.STATUS_REJECTED,\n-            Payment.StatusDetail.STATUS_DETAIL_CC_REJECTED_CARD_DISABLED\n+            Payment.StatusDetail.STATUS_DETAIL_CC_REJECTED_OTHER_REASON\n         ).setPaymentId(123L).createGenericPayment());\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc1NzA0Mw==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520757043", "bodyText": "Esto me sigue sin convencer, por que mapPaymentModel hace tantas cosas no relacionadas al mapeo?", "author": "cgaggino", "createdAt": "2020-11-10T17:52:41Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultPresenter.java", "diffHunk": "@@ -78,35 +76,44 @@ public void onAbort() {\n         getView().processCustomExit();\n     }\n \n-    @Override\n-    public void dispatch(final Action action) {\n-        if (action instanceof ExitAction) {\n-            if (action instanceof PrimaryExitAction) {\n-                new PrimaryActionEvent(viewTracker).track();\n-            } else if (action instanceof SecondaryExitAction) {\n-                new SecondaryActionEvent(viewTracker).track();\n-            }\n-            getView().processCustomExit((ExitAction) action);\n-        } else {\n-            throw new UnsupportedOperationException(\"this Action class can't be executed in this screen\");\n-        }\n-    }\n-\n     private void mapPaymentModel() {\n         final BusinessPaymentResultViewModel viewModel = new BusinessPaymentResultMapper().map(model);\n-        getView().configureViews(viewModel, this);\n-        getView().setStatusBarColor(viewModel.headerModel.getBackgroundColor());\n-        initAutoReturn(viewModel.shouldAutoReturn);\n+        getView().configureViews(viewModel, this, new PaymentResultFooter.Listener() {", "originalCommit": "10c6343af2053c8b5d04368a4a3abf75f9994145", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc2ODQyOQ==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520768429", "bodyText": "Reviso el flujo como viene y lo cambio. Tiene pinta igual de que un cambio de nombre alcanzar\u00eda", "author": "guchito9", "createdAt": "2020-11-10T18:11:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc1NzA0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "35fb91d8f9da80f2c6a9bc0affdae5793a1d98eb", "chunk": "diff --git a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultPresenter.java b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultPresenter.java\nindex 0628b97da..d1912cf99 100644\n--- a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultPresenter.java\n+++ b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultPresenter.java\n\n@@ -76,7 +76,7 @@ import com.mercadopago.android.px.tracking.internal.views.ResultViewTrack;\n         getView().processCustomExit();\n     }\n \n-    private void mapPaymentModel() {\n+    private void configureView() {\n         final BusinessPaymentResultViewModel viewModel = new BusinessPaymentResultMapper().map(model);\n         getView().configureViews(viewModel, this, new PaymentResultFooter.Listener() {\n             @Override\n"}}, {"oid": "35fb91d8f9da80f2c6a9bc0affdae5793a1d98eb", "url": "https://github.com/mercadopago/px-android/commit/35fb91d8f9da80f2c6a9bc0affdae5793a1d98eb", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-10T18:20:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDc1MzYzMw==", "url": "https://github.com/mercadopago/px-android/pull/2375#discussion_r520753633", "bodyText": "Hacer que para business payment result sea siempre visible y que los condicionales de mostrar o no el footer est\u00e9n el generic payment result.", "author": "jorGonzalez291292", "createdAt": "2020-11-10T17:47:27Z", "path": "px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultActivity.java", "diffHunk": "@@ -39,6 +42,8 @@ protected boolean shouldHaltSession(@NonNull final Session.State state) {\n     @Override\n     protected void onCreated(@Nullable final Bundle savedInstanceState) {\n         setContentView(R.layout.px_activity_payment_result);\n+        footer = findViewById(R.id.footer);\n+        footer.setVisibility(View.VISIBLE);", "originalCommit": "10c6343af2053c8b5d04368a4a3abf75f9994145", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "082123a2841c0ed53abd29bb4fad3138cc71a516", "chunk": "diff --git a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultActivity.java b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultActivity.java\nindex be4693194..e3aa96537 100644\n--- a/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultActivity.java\n+++ b/px-checkout/src/main/java/com/mercadopago/android/px/internal/features/business_result/BusinessPaymentResultActivity.java\n\n@@ -43,7 +43,6 @@ public class BusinessPaymentResultActivity extends PXActivity<BusinessPaymentRes\n     protected void onCreated(@Nullable final Bundle savedInstanceState) {\n         setContentView(R.layout.px_activity_payment_result);\n         footer = findViewById(R.id.footer);\n-        footer.setVisibility(View.VISIBLE);\n \n         presenter = createPresenter();\n         presenter.attachView(this);\n"}}, {"oid": "b3af27923c3ad09df4a0f7b16c2fefdea2e432f4", "url": "https://github.com/mercadopago/px-android/commit/b3af27923c3ad09df4a0f7b16c2fefdea2e432f4", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-12T14:41:26Z", "type": "forcePushed"}, {"oid": "082123a2841c0ed53abd29bb4fad3138cc71a516", "url": "https://github.com/mercadopago/px-android/commit/082123a2841c0ed53abd29bb4fad3138cc71a516", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-12T14:59:24Z", "type": "forcePushed"}, {"oid": "10a9580d2be11f341f57ac1cb4fc5adfaae5bb1d", "url": "https://github.com/mercadopago/px-android/commit/10a9580d2be11f341f57ac1cb4fc5adfaae5bb1d", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-12T15:09:44Z", "type": "forcePushed"}, {"oid": "31b97be4910475211d3802c03c5ebb85df9e515a", "url": "https://github.com/mercadopago/px-android/commit/31b97be4910475211d3802c03c5ebb85df9e515a", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-12T15:14:15Z", "type": "forcePushed"}, {"oid": "920640c83707d52ca2e62386cd13e3ddd77f431b", "url": "https://github.com/mercadopago/px-android/commit/920640c83707d52ca2e62386cd13e3ddd77f431b", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-12T15:41:34Z", "type": "commit"}, {"oid": "920640c83707d52ca2e62386cd13e3ddd77f431b", "url": "https://github.com/mercadopago/px-android/commit/920640c83707d52ca2e62386cd13e3ddd77f431b", "message": "Autoreturn and dynamic congrats buttons from backend", "committedDate": "2020-11-12T15:41:34Z", "type": "forcePushed"}]}