{"pr_number": 1948, "pr_title": "DBZ-2637 Enhance Postgres validation checks", "pr_createdAt": "2020-11-12T17:41:42Z", "pr_url": "https://github.com/debezium/debezium/pull/1948", "timeline": [{"oid": "7eacfdbbbf568cade29c66c42e4e0e77ce5fda8b", "url": "https://github.com/debezium/debezium/commit/7eacfdbbbf568cade29c66c42e4e0e77ce5fda8b", "message": "DBZ-2637 Enhance Postgres validation checks\n+ add wal_level config check\n+ add LOGIN and REPLICATION roles check\n+ add replication slot is already in use check", "committedDate": "2020-11-12T17:39:12Z", "type": "commit"}, {"oid": "17c4cb1cacafe48e8bda07336df234c03025700c", "url": "https://github.com/debezium/debezium/commit/17c4cb1cacafe48e8bda07336df234c03025700c", "message": "DBZ-2637 unrelated cleanup", "committedDate": "2020-11-12T17:40:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI5NTAyMA==", "url": "https://github.com/debezium/debezium/pull/1948#discussion_r522295020", "bodyText": "Unrelated cleanup in separate commit. Is it okay to show all possible values?", "author": "rk3rn3r", "createdAt": "2020-11-12T17:42:43Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/PostgresConnectorConfig.java", "diffHunk": "@@ -561,7 +561,13 @@ public static SchemaRefreshMode parse(String value) {\n             .withWidth(Width.MEDIUM)\n             .withImportance(Importance.MEDIUM)\n             .withDescription(\"The name of the Postgres logical decoding plugin installed on the server. \" +\n-                    \"Supported values are '\" + LogicalDecoder.DECODERBUFS.getValue() + \"' and '\" + LogicalDecoder.WAL2JSON.getValue() + \"'. \" +\n+                    \"Supported values are '\" + LogicalDecoder.DECODERBUFS.getValue()\n+                    + \"', '\" + LogicalDecoder.WAL2JSON.getValue()\n+                    + \"', '\" + LogicalDecoder.PGOUTPUT.getValue()\n+                    + \"', '\" + LogicalDecoder.WAL2JSON_STREAMING.getValue()\n+                    + \"', '\" + LogicalDecoder.WAL2JSON_RDS.getValue()\n+                    + \"' and '\" + LogicalDecoder.WAL2JSON_RDS_STREAMING.getValue()\n+                    + \"'. \" +", "originalCommit": "17c4cb1cacafe48e8bda07336df234c03025700c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjkyNjU0OQ==", "url": "https://github.com/debezium/debezium/pull/1948#discussion_r522926549", "bodyText": "This is fine. I wonder if you could create a utility method that would format the allow values for any enum.", "author": "jpechane", "createdAt": "2020-11-13T12:43:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI5NTAyMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1Mzk2OA==", "url": "https://github.com/debezium/debezium/pull/1948#discussion_r522953968", "bodyText": "I can, but after holidays.", "author": "rk3rn3r", "createdAt": "2020-11-13T13:36:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjI5NTAyMA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "9d5f95ae60914b410e676ce03ff7560e1a378e2d", "url": "https://github.com/debezium/debezium/commit/9d5f95ae60914b410e676ce03ff7560e1a378e2d", "message": "DBZ-2637 fix unit test timeouts", "committedDate": "2020-11-12T19:06:25Z", "type": "commit"}, {"oid": "9d5f95ae60914b410e676ce03ff7560e1a378e2d", "url": "https://github.com/debezium/debezium/commit/9d5f95ae60914b410e676ce03ff7560e1a378e2d", "message": "DBZ-2637 fix unit test timeouts", "committedDate": "2020-11-12T19:06:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjkzNTEyMQ==", "url": "https://github.com/debezium/debezium/pull/1948#discussion_r522935121", "bodyText": "The database is really named PostgreSQL :-)", "author": "jpechane", "createdAt": "2020-11-13T13:00:33Z", "path": "debezium-connector-postgres/src/main/java/io/debezium/connector/postgresql/connection/PostgresReplicationConnection.java", "diffHunk": "@@ -321,15 +321,15 @@ public void initConnection() throws SQLException, InterruptedException {\n \n     @Override\n     public Optional<SlotCreationResult> createReplicationSlot() throws SQLException {\n-        // note that some of these options are only supported in pg94+, additionally\n-        // the options are not yet exported by the jdbc api wrapper, therefore, we just do this ourselves\n-        // but eventually this should be moved back to the jdbc API\n+        // note that some of these options are only supported in Postgres 9.4+, additionally\n+        // the options are not yet exported by the jdbc api wrapper, therefore, we just do\n+        // this ourselves but eventually this should be moved back to the jdbc API\n         // see https://github.com/pgjdbc/pgjdbc/issues/1305\n \n         LOGGER.debug(\"Creating new replication slot '{}' for plugin '{}'\", slotName, plugin);\n         String tempPart = \"\";\n-        // Exported snapshots are supported in PostgreSQL 9.4+\n-        Boolean canExportSnapshot = pgConnection().haveMinimumServerVersion(ServerVersion.v9_4);\n+        // Exported snapshots are supported in Postgres 9.4+", "originalCommit": "9d5f95ae60914b410e676ce03ff7560e1a378e2d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjk1MjA5Mg==", "url": "https://github.com/debezium/debezium/pull/1948#discussion_r522952092", "bodyText": "I know. A PostgreSQL committer was my professor at university. Still, we tend to use Postgres in most places.", "author": "rk3rn3r", "createdAt": "2020-11-13T13:33:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjkzNTEyMQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "fc06a05e3ad0371b432b383a75c420283cabbb7e", "url": "https://github.com/debezium/debezium/commit/fc06a05e3ad0371b432b383a75c420283cabbb7e", "message": "DBZ-2637 apply feedback", "committedDate": "2020-11-13T13:30:24Z", "type": "commit"}]}