{"pr_number": 1733, "pr_title": "DBZ-2277 Disable tombstones when using Google PubSub sink", "pr_createdAt": "2020-08-03T18:00:34Z", "pr_url": "https://github.com/debezium/debezium/pull/1733", "timeline": [{"oid": "bc309a359315d9677614ebd1a146a39cc4b7be2a", "url": "https://github.com/debezium/debezium/commit/bc309a359315d9677614ebd1a146a39cc4b7be2a", "message": "DBZ-2277 Disable tombstones when using Google PubSub sink", "committedDate": "2020-08-03T17:59:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NDYzNTA2MQ==", "url": "https://github.com/debezium/debezium/pull/1733#discussion_r464635061", "bodyText": "How about having a method like supportsTombstoneEvents() on the ChangeConsumer contract instead of hard-wiring this?", "author": "gunnarmorling", "createdAt": "2020-08-03T20:07:38Z", "path": "debezium-server/debezium-server-core/src/main/java/io/debezium/server/DebeziumServer.java", "diffHunk": "@@ -122,6 +123,10 @@ else if (beans.size() > 1) {\n             props.setProperty(\"transforms\", transforms.get());\n             configToProperties(config, props, PROP_TRANSFORMS_PREFIX, \"transforms.\");\n         }\n+        if (\"pubsub\".equals(name)) {", "originalCommit": "bc309a359315d9677614ebd1a146a39cc4b7be2a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "964149560bef3f94e7b4ad6b4d7bbeff28b0f1c6", "chunk": "diff --git a/debezium-server/debezium-server-core/src/main/java/io/debezium/server/DebeziumServer.java b/debezium-server/debezium-server-core/src/main/java/io/debezium/server/DebeziumServer.java\nindex 7131c5f5e..b53c102c4 100644\n--- a/debezium-server/debezium-server-core/src/main/java/io/debezium/server/DebeziumServer.java\n+++ b/debezium-server/debezium-server-core/src/main/java/io/debezium/server/DebeziumServer.java\n\n@@ -123,8 +123,7 @@ else if (beans.size() > 1) {\n             props.setProperty(\"transforms\", transforms.get());\n             configToProperties(config, props, PROP_TRANSFORMS_PREFIX, \"transforms.\");\n         }\n-        if (\"pubsub\".equals(name)) {\n-            // DBZ-2277 explicitly disable tombstones when using Google PubSub as the sink\n+        if (!consumer.supportsTombstoneEvents()) {\n             props.setProperty(CommonConnectorConfig.TOMBSTONES_ON_DELETE.name(), Boolean.FALSE.toString());\n         }\n         props.setProperty(\"name\", name);\n"}}, {"oid": "964149560bef3f94e7b4ad6b4d7bbeff28b0f1c6", "url": "https://github.com/debezium/debezium/commit/964149560bef3f94e7b4ad6b4d7bbeff28b0f1c6", "message": "DBZ-2277 ChangeConsumer indicates if tombstones are to be emitted", "committedDate": "2020-08-04T14:33:09Z", "type": "commit"}]}