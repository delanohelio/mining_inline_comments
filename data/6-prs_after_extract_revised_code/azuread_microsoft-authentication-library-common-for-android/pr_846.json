{"pr_number": 846, "pr_title": "Use default scopes for foci request", "pr_createdAt": "2020-03-12T21:07:39Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/846", "timeline": [{"oid": "7373bb6843626bddcfc1a307db6a0ed71311e872", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/7373bb6843626bddcfc1a307db6a0ed71311e872", "message": "Use default scopes for foci request", "committedDate": "2020-03-12T21:07:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTg5Nzk4Mw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/846#discussion_r391897983", "bodyText": "There's a minor refactor/code-sharing opportunity we should take here.... Looks like we have defined two constants for this, would be great not to trip over this in the future because there are two fields.....\nThe first is here (which you've used).\nThe second is in BaseController -- can we make sure all the same constants are used everywhere in the code so if we change which scopes comprise the defaults we only have to do it in one place?\nI would probably add a static method to the BaseController to return the contents of the list with a \" \" delimiter.\nSeem OK?", "author": "iambmelt", "createdAt": "2020-03-12T21:16:14Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/migration/TokenCacheItemMigrationAdapter.java", "diffHunk": "@@ -156,7 +156,7 @@ public static boolean tryFociTokenWithGivenClientId(@NonNull final BrokerOAuth2T\n         final MicrosoftStsOAuth2Strategy strategy = new MicrosoftStsOAuth2Strategy(config, strategyParameters);\n \n         final String refreshToken = cacheRecord.getRefreshToken().getSecret();\n-        final String scopes = cacheRecord.getRefreshToken().getTarget();\n+        final String scopes = DEFAULT_SCOPES;", "originalCommit": "7373bb6843626bddcfc1a307db6a0ed71311e872", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTkwMjYzOQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/846#discussion_r391902639", "bodyText": "Yeah, sure", "author": "shahzaibj", "createdAt": "2020-03-12T21:24:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTg5Nzk4Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTkxMTI1OA==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/846#discussion_r391911258", "bodyText": "@iambmelt Addressed here: df82cb7", "author": "shahzaibj", "createdAt": "2020-03-12T21:35:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTg5Nzk4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "df82cb7678e8f1113b6bd014dfc1f8c14080a113", "chunk": "diff --git a/common/src/main/java/com/microsoft/identity/common/internal/migration/TokenCacheItemMigrationAdapter.java b/common/src/main/java/com/microsoft/identity/common/internal/migration/TokenCacheItemMigrationAdapter.java\nindex 23bd1d1c6..2301ff29b 100644\n--- a/common/src/main/java/com/microsoft/identity/common/internal/migration/TokenCacheItemMigrationAdapter.java\n+++ b/common/src/main/java/com/microsoft/identity/common/internal/migration/TokenCacheItemMigrationAdapter.java\n\n@@ -156,7 +156,7 @@ public class TokenCacheItemMigrationAdapter {\n         final MicrosoftStsOAuth2Strategy strategy = new MicrosoftStsOAuth2Strategy(config, strategyParameters);\n \n         final String refreshToken = cacheRecord.getRefreshToken().getSecret();\n-        final String scopes = DEFAULT_SCOPES;\n+        final String scopes = BaseController.getDelimitedDefaultScopeString();\n \n         // Create a correlation_id for the request\n         final UUID correlationId = UUID.randomUUID();\n"}}, {"oid": "df82cb7678e8f1113b6bd014dfc1f8c14080a113", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/df82cb7678e8f1113b6bd014dfc1f8c14080a113", "message": "Address comments", "committedDate": "2020-03-12T21:35:02Z", "type": "commit"}, {"oid": "f132eb85c1c369f778a5c2434c39821067c23fff", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f132eb85c1c369f778a5c2434c39821067c23fff", "message": "Fix pmd", "committedDate": "2020-03-12T21:46:10Z", "type": "commit"}, {"oid": "f83757d333b2fc469cd7cbd3dacd21b0d515ec2f", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/f83757d333b2fc469cd7cbd3dacd21b0d515ec2f", "message": "Remove capacity from default scope builder", "committedDate": "2020-03-12T22:09:30Z", "type": "commit"}]}