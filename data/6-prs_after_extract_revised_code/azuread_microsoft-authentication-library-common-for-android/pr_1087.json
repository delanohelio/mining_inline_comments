{"pr_number": 1087, "pr_title": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "pr_createdAt": "2020-10-16T00:12:53Z", "pr_url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMjc0Nw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#discussion_r507912747", "bodyText": "Is this return now @nonnull?  No.  Should it become that?", "author": "AdamBJohnsonx", "createdAt": "2020-10-19T17:04:55Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/OAuth2Strategy.java", "diffHunk": "@@ -126,21 +126,14 @@ public OAuth2Strategy(GenericOAuth2Configuration config,\n      */\n     public Future<AuthorizationResult> requestAuthorization(", "originalCommit": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a5440bbc359de888045e443ff6dec04d7535fed1", "chunk": "diff --git a/common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/OAuth2Strategy.java b/common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/OAuth2Strategy.java\nindex ef2b88469..32205ab90 100644\n--- a/common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/OAuth2Strategy.java\n+++ b/common/src/main/java/com/microsoft/identity/common/internal/providers/oauth2/OAuth2Strategy.java\n\n@@ -124,14 +124,14 @@ public abstract class OAuth2Strategy\n      * @param authorizationStrategy generic authorization strategy.\n      * @return GenericAuthorizationResponse\n      */\n-    public Future<AuthorizationResult> requestAuthorization(\n+    public @NonNull Future<AuthorizationResult> requestAuthorization(\n             final GenericAuthorizationRequest request,\n-            final GenericAuthorizationStrategy authorizationStrategy) throws UnsupportedEncodingException, ClientException {\n+            final GenericAuthorizationStrategy authorizationStrategy) throws ClientException {\n         validateAuthorizationRequest(request);\n \n         // Suppressing unchecked warnings due to casting an object in reference of current class to the child class GenericOAuth2Strategy while calling method requestAuthorization()\n         @SuppressWarnings(WarningType.unchecked_warning)\n-        Future<AuthorizationResult> authorizationFuture = authorizationStrategy.requestAuthorization(request, this);\n+        final Future<AuthorizationResult> authorizationFuture = authorizationStrategy.requestAuthorization(request, this);\n \n         return authorizationFuture;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMzM3Nw==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#discussion_r507913377", "bodyText": "How are we ending up with UnsupportedEncoding here?", "author": "AdamBJohnsonx", "createdAt": "2020-10-19T17:05:56Z", "path": "common/src/main/java/com/microsoft/identity/common/internal/controllers/LocalMSALController.java", "diffHunk": "@@ -213,7 +214,7 @@ public AcquireTokenResult acquireToken(\n     private AuthorizationResult performAuthorizationRequest(@NonNull final OAuth2Strategy strategy,\n                                                             @NonNull final Context context,\n                                                             @NonNull final InteractiveTokenCommandParameters parameters)\n-            throws ExecutionException, InterruptedException, ClientException {\n+            throws ExecutionException, InterruptedException, ClientException, UnsupportedEncodingException {", "originalCommit": "a0b3ec24668694234d0be33ccda8ba4f4a4f55c5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxNjAzNQ==", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/pull/1087#discussion_r507916035", "bodyText": "It looks like it's declared as thrown from requestAuthorization in both implementations, but is not actually thrown there.", "author": "AdamBJohnsonx", "createdAt": "2020-10-19T17:10:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkxMzM3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "2a7a5ec51b46b5834ea7dc87762b3c567838a053", "chunk": "diff --git a/common/src/main/java/com/microsoft/identity/common/internal/controllers/LocalMSALController.java b/common/src/main/java/com/microsoft/identity/common/internal/controllers/LocalMSALController.java\nindex e2aa0c8d1..8d9a185fc 100644\n--- a/common/src/main/java/com/microsoft/identity/common/internal/controllers/LocalMSALController.java\n+++ b/common/src/main/java/com/microsoft/identity/common/internal/controllers/LocalMSALController.java\n\n@@ -214,7 +212,7 @@ public class LocalMSALController extends BaseController {\n     private AuthorizationResult performAuthorizationRequest(@NonNull final OAuth2Strategy strategy,\n                                                             @NonNull final Context context,\n                                                             @NonNull final InteractiveTokenCommandParameters parameters)\n-            throws ExecutionException, InterruptedException, ClientException, UnsupportedEncodingException {\n+            throws ExecutionException, InterruptedException, ClientException {\n \n         throwIfNetworkNotAvailable(context, parameters.isPowerOptCheckEnabled());\n \n"}}, {"oid": "a5440bbc359de888045e443ff6dec04d7535fed1", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/a5440bbc359de888045e443ff6dec04d7535fed1", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "committedDate": "2020-10-20T22:15:56Z", "type": "forcePushed"}, {"oid": "2a7a5ec51b46b5834ea7dc87762b3c567838a053", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/2a7a5ec51b46b5834ea7dc87762b3c567838a053", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "committedDate": "2020-10-20T22:17:54Z", "type": "forcePushed"}, {"oid": "3c26af19c4e82e9cc0f3f162acc85bde378f7f4b", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/3c26af19c4e82e9cc0f3f162acc85bde378f7f4b", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "committedDate": "2020-10-20T22:23:10Z", "type": "forcePushed"}, {"oid": "6e1721b51169b1523266bf2aa2c6d931cd18af5d", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6e1721b51169b1523266bf2aa2c6d931cd18af5d", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "committedDate": "2020-10-20T22:30:33Z", "type": "commit"}, {"oid": "6e1721b51169b1523266bf2aa2c6d931cd18af5d", "url": "https://github.com/AzureAD/microsoft-authentication-library-common-for-android/commit/6e1721b51169b1523266bf2aa2c6d931cd18af5d", "message": "Do not silently swallow exception in requestAuthorization(), Launch AuthorizationActivity with different flags for broker and non-broker auth", "committedDate": "2020-10-20T22:30:33Z", "type": "forcePushed"}]}