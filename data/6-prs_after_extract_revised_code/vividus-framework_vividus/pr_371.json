{"pr_number": 371, "pr_title": "Add step to validate elements number using comparison rule", "pr_createdAt": "2020-03-05T14:20:04Z", "pr_url": "https://github.com/vividus-framework/vividus/pull/371", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODMyNTU3Ng==", "url": "https://github.com/vividus-framework/vividus/pull/371#discussion_r388325576", "bodyText": "Then number of elements found CSS selector `$cssSelector` in HTML `$html` is $comparisonRule `$quantity`", "author": "valfirst", "createdAt": "2020-03-05T14:25:41Z", "path": "vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java", "diffHunk": "@@ -56,6 +48,36 @@\n         return Optional.empty();\n     }\n \n+    /**\n+     * Checks if HTML contains elements according to rule by CSS selector\n+     * @param html HTML to check\n+     * @param comparisonRule The rule to compare values\n+     * <br>(<i>Possible values:</i>\n+     * <br> less than (&lt;),\n+     * <br> less than or equal to (&lt;=),\n+     * <br> greater than(&gt;)\n+     * <br> greater than or equal to(&gt;=),\n+     * <br> equal to(=))\n+     * @param number Number of elements\n+     * @param cssSelector CSS selector\n+     * @see <a href=\"https://www.w3schools.com/cssref/css_selectors.asp\"><i>CSS Selector Reference</i></a>\n+     * @see <a href=\"https://jsoup.org/apidocs/org/jsoup/select/Selector.html\"><i>Jsoup Selector API</i></a>\n+     * @return true if elements quantity corresponds to rule, false otherwise\n+     */\n+    @Then(\"HTML `$html` contains $comparisonRule $number elements by CSS selector `$cssSelector`\")", "originalCommit": "2a57335126e9d074acb0d9bb9480c5d0d318c1e3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a4115a5f188538facfd3c1a93053f43b1ebede83", "chunk": "diff --git a/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java b/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java\nindex 87f4f61a..ffc52d86 100644\n--- a/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java\n+++ b/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java\n\n@@ -50,6 +50,7 @@ public class HtmlSteps\n \n     /**\n      * Checks if HTML contains elements according to rule by CSS selector\n+     * @param cssSelector CSS selector\n      * @param html HTML to check\n      * @param comparisonRule The rule to compare values\n      * <br>(<i>Possible values:</i>\n"}}, {"oid": "a4115a5f188538facfd3c1a93053f43b1ebede83", "url": "https://github.com/vividus-framework/vividus/commit/a4115a5f188538facfd3c1a93053f43b1ebede83", "message": "Add step to validate elements number using comparison rule", "committedDate": "2020-03-05T15:23:20Z", "type": "forcePushed"}, {"oid": "648450e22c4cc1101fb8562f95ecca798b55dd7e", "url": "https://github.com/vividus-framework/vividus/commit/648450e22c4cc1101fb8562f95ecca798b55dd7e", "message": "Add step to validate elements number using comparison rule", "committedDate": "2020-03-05T15:57:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODgzODgyMg==", "url": "https://github.com/vividus-framework/vividus/pull/371#discussion_r388838822", "bodyText": "what about reusing here a logic from a new step?", "author": "valfirst", "createdAt": "2020-03-06T10:56:00Z", "path": "vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java", "diffHunk": "@@ -36,18 +37,9 @@\n     @Inject private ISoftAssert softAssert;\n     @Inject private IBddVariableContext bddVariableContext;\n \n-    /**\n-     * Checks if HTML contains element by CSS selector\n-     * @param html HTML to check\n-     * @param cssSelector CSS selector\n-     * @see <a href=\"https://www.w3schools.com/cssref/css_selectors.asp\"><i>CSS Selector Reference</i></a>\n-     * @see <a href=\"https://jsoup.org/apidocs/org/jsoup/select/Selector.html\"><i>Jsoup Selector API</i></a>\n-     * @return element by CSS selector\n-     */\n-    @Then(\"HTML `$html` contains element by CSS selector `$cssSelector`\")\n-    public Optional<Element> doesElementByCssSelectorExist(String html, String cssSelector)\n+    private Optional<Element> findElementByCssSelectorExist(String html, String cssSelector)\n     {\n-        Elements elements = HtmlUtils.getElements(html, cssSelector);\n+        Elements elements = findElements(html, cssSelector);\n         if (softAssert.assertThat(String.format(\"Number of elements found by css selector '%s'\", cssSelector),\n                 elements.size(), Matchers.equalTo(1)))", "originalCommit": "648450e22c4cc1101fb8562f95ecca798b55dd7e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1c94457c20253458b42b620d1693ff517e7d8875", "chunk": "diff --git a/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java b/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java\nindex ea1d9096..89e471a0 100644\n--- a/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java\n+++ b/vividus-plugin-html/src/main/java/org/vividus/bdd/steps/html/HtmlSteps.java\n\n@@ -40,8 +39,7 @@ public class HtmlSteps\n     private Optional<Element> findElementByCssSelectorExist(String html, String cssSelector)\n     {\n         Elements elements = findElements(html, cssSelector);\n-        if (softAssert.assertThat(String.format(\"Number of elements found by css selector '%s'\", cssSelector),\n-                elements.size(), Matchers.equalTo(1)))\n+        if (assertElements(cssSelector, ComparisonRule.EQUAL_TO, 1, elements))\n         {\n             return Optional.of(elements.first());\n         }\n"}}, {"oid": "1c94457c20253458b42b620d1693ff517e7d8875", "url": "https://github.com/vividus-framework/vividus/commit/1c94457c20253458b42b620d1693ff517e7d8875", "message": "Add step to validate elements number using comparison rule", "committedDate": "2020-03-06T13:18:30Z", "type": "commit"}, {"oid": "1c94457c20253458b42b620d1693ff517e7d8875", "url": "https://github.com/vividus-framework/vividus/commit/1c94457c20253458b42b620d1693ff517e7d8875", "message": "Add step to validate elements number using comparison rule", "committedDate": "2020-03-06T13:18:30Z", "type": "forcePushed"}]}