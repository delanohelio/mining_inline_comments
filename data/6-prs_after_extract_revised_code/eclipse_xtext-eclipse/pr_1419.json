{"pr_number": 1419, "pr_title": "Refactoring the org.eclipse.xtext.xtext.ui test cases.", "pr_createdAt": "2020-04-28T09:58:55Z", "pr_url": "https://github.com/eclipse/xtext-eclipse/pull/1419", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk3MTk5NA==", "url": "https://github.com/eclipse/xtext-eclipse/pull/1419#discussion_r419971994", "bodyText": "You can override setInjector() and mark it with @Inject which would allow to remove the injector field above.", "author": "szarnekow", "createdAt": "2020-05-05T09:18:46Z", "path": "org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/SemanticHighlightingTest.java", "diffHunk": "@@ -11,49 +11,49 @@\n import java.util.Set;\n \n import org.eclipse.jface.text.TypedRegion;\n-import org.eclipse.xtext.XtextRuntimeModule;\n-import org.eclipse.xtext.XtextStandaloneSetup;\n import org.eclipse.xtext.ide.editor.syntaxcoloring.IHighlightedPositionAcceptor;\n import org.eclipse.xtext.ide.editor.syntaxcoloring.ISemanticHighlightingCalculator;\n import org.eclipse.xtext.junit4.AbstractXtextTests;\n import org.eclipse.xtext.resource.XtextResource;\n-import org.eclipse.xtext.ui.shared.SharedStateModule;\n+import org.eclipse.xtext.testing.InjectWith;\n+import org.eclipse.xtext.testing.XtextRunner;\n import org.eclipse.xtext.util.CancelIndicator;\n-import org.eclipse.xtext.util.Modules2;\n-import org.eclipse.xtext.xtext.ui.Activator;\n+import org.eclipse.xtext.xtext.ui.XtextUiInjectorProvider;\n import org.eclipse.xtext.xtext.ui.editor.syntaxcoloring.SemanticHighlightingConfiguration;\n-import org.eclipse.xtext.xtext.ui.internal.XtextUIModuleInternal;\n import org.junit.Test;\n+import org.junit.runner.RunWith;\n \n import com.google.common.collect.Sets;\n-import com.google.inject.Guice;\n+import com.google.inject.Inject;\n import com.google.inject.Injector;\n \n /**\n  * @author Sebastian Zarnekow - Initial contribution and API\n  */\n+@RunWith(XtextRunner.class)\n+@InjectWith(XtextUiInjectorProvider.class)\n public class SemanticHighlightingTest extends AbstractXtextTests implements IHighlightedPositionAcceptor {\n-\t\n+\n+\t@Inject\n+\tprivate Injector injector;\n+\n+\t@Inject\n+\tprivate ISemanticHighlightingCalculator calculator;\n+\n \tprivate Set<TypedRegion> expectedRegions;\n-\t\n+\n \t@Override\n \tpublic void setUp() throws Exception {\n \t\tsuper.setUp();\n-\t\twith(new XtextStandaloneSetup() {\n-\t\t\t@Override\n-\t\t\tpublic Injector createInjector() {\n-\t\t\t\treturn Guice.createInjector(Modules2.mixin(new XtextRuntimeModule(),new XtextUIModuleInternal(Activator.getDefault()), new SharedStateModule()));\n-\t\t\t}\n-\t\t});\n \t\texpectedRegions = Sets.newLinkedHashSet();\n+\t\tsetInjector(injector);", "originalCommit": "65275889d154cf0a91cdcc31d0cf44d3ba9c2c9f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk4NjcxNA==", "url": "https://github.com/eclipse/xtext-eclipse/pull/1419#discussion_r419986714", "bodyText": "Fixed.", "author": "miklossy", "createdAt": "2020-05-05T09:44:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk3MTk5NA=="}], "type": "inlineReview", "revised_code": {"commit": "64e8959167f87b28a337824b7b51bc1c485246fa", "chunk": "diff --git a/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/SemanticHighlightingTest.java b/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/SemanticHighlightingTest.java\nindex a7f2301d0..5e6aa22cc 100644\n--- a/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/SemanticHighlightingTest.java\n+++ b/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/SemanticHighlightingTest.java\n\n@@ -34,9 +34,6 @@ import com.google.inject.Injector;\n @InjectWith(XtextUiInjectorProvider.class)\n public class SemanticHighlightingTest extends AbstractXtextTests implements IHighlightedPositionAcceptor {\n \n-\t@Inject\n-\tprivate Injector injector;\n-\n \t@Inject\n \tprivate ISemanticHighlightingCalculator calculator;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk3MzExMA==", "url": "https://github.com/eclipse/xtext-eclipse/pull/1419#discussion_r419973110", "bodyText": "I'd rather not keep a reference to the document. Please use a Provider<XtextDocument> to ensure that two subsequent calls to assertNotException(..) do not interfere with each other.", "author": "szarnekow", "createdAt": "2020-05-05T09:20:47Z", "path": "org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/outline/XtextOutlineTreeProviderTest.java", "diffHunk": "@@ -10,37 +10,42 @@\n \n import java.util.List;\n \n-import org.eclipse.xtext.ISetup;\n import org.eclipse.xtext.junit4.AbstractXtextTests;\n import org.eclipse.xtext.resource.XtextResource;\n+import org.eclipse.xtext.testing.InjectWith;\n+import org.eclipse.xtext.testing.XtextRunner;\n import org.eclipse.xtext.ui.editor.model.XtextDocument;\n import org.eclipse.xtext.ui.editor.outline.IOutlineNode;\n import org.eclipse.xtext.ui.editor.outline.impl.OutlineMode;\n import org.eclipse.xtext.util.ITextRegion;\n import org.eclipse.xtext.util.StringInputStream;\n-import org.eclipse.xtext.xtext.ui.Activator;\n+import org.eclipse.xtext.xtext.ui.XtextUiInjectorProvider;\n import org.junit.Test;\n+import org.junit.runner.RunWith;\n \n+import com.google.inject.Inject;\n import com.google.inject.Injector;\n \n /**\n  * @author Jan Koehnlein - Initial contribution and API\n  */\n+@RunWith(XtextRunner.class)\n+@InjectWith(XtextUiInjectorProvider.class)\n public class XtextOutlineTreeProviderTest extends AbstractXtextTests {\n \n+\t@Inject\n+\tprivate Injector injector;\n+\n+\t@Inject\n \tprivate XtextOutlineTreeProvider treeProvider;\n \n+\t@Inject", "originalCommit": "65275889d154cf0a91cdcc31d0cf44d3ba9c2c9f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk4Njc4NA==", "url": "https://github.com/eclipse/xtext-eclipse/pull/1419#discussion_r419986784", "bodyText": "Fixed.", "author": "miklossy", "createdAt": "2020-05-05T09:44:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTk3MzExMA=="}], "type": "inlineReview", "revised_code": {"commit": "64e8959167f87b28a337824b7b51bc1c485246fa", "chunk": "diff --git a/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/outline/XtextOutlineTreeProviderTest.java b/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/outline/XtextOutlineTreeProviderTest.java\nindex db9ec15f8..2308633b9 100644\n--- a/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/outline/XtextOutlineTreeProviderTest.java\n+++ b/org.eclipse.xtext.xtext.ui.tests/src/org/eclipse/xtext/xtext/ui/editor/outline/XtextOutlineTreeProviderTest.java\n\n@@ -25,6 +25,7 @@ import org.junit.runner.RunWith;\n \n import com.google.inject.Inject;\n import com.google.inject.Injector;\n+import com.google.inject.Provider;\n \n /**\n  * @author Jan Koehnlein - Initial contribution and API\n"}}, {"oid": "64e8959167f87b28a337824b7b51bc1c485246fa", "url": "https://github.com/eclipse/xtext-eclipse/commit/64e8959167f87b28a337824b7b51bc1c485246fa", "message": "Refactoring the org.eclipse.xtext.xtext.ui test cases.\n\n- Reusing the recently introduced XtextUiInjectorProvider class.\n- Reusing the inherited code from the org.eclipse.xtext.ui.testing\ninfrastructure.\n\nSigned-off-by: Tamas Miklossy <miklossy@itemis.de>", "committedDate": "2020-05-05T09:42:33Z", "type": "commit"}, {"oid": "64e8959167f87b28a337824b7b51bc1c485246fa", "url": "https://github.com/eclipse/xtext-eclipse/commit/64e8959167f87b28a337824b7b51bc1c485246fa", "message": "Refactoring the org.eclipse.xtext.xtext.ui test cases.\n\n- Reusing the recently introduced XtextUiInjectorProvider class.\n- Reusing the inherited code from the org.eclipse.xtext.ui.testing\ninfrastructure.\n\nSigned-off-by: Tamas Miklossy <miklossy@itemis.de>", "committedDate": "2020-05-05T09:42:33Z", "type": "forcePushed"}]}