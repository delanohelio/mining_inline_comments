{"pr_number": 8539, "pr_title": "ISPN-12103 Improve ContainerDatabase to add custom wait strategy", "pr_createdAt": "2020-07-09T16:01:03Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8539", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM1ODMyNQ==", "url": "https://github.com/infinispan/infinispan/pull/8539#discussion_r456358325", "bodyText": "The property should be documented and added to the TestSystemPropertyNames class", "author": "tristantarrant", "createdAt": "2020-07-17T10:26:26Z", "path": "server/testdriver/core/src/main/java/org/infinispan/server/test/core/persistence/ContainerDatabase.java", "diffHunk": "@@ -34,7 +37,17 @@\n                      .env(env)\n                      .build();\n             });\n-      container = new GenericContainer(image).withExposedPorts(port).waitingFor(Wait.forListeningPort());\n+      container = new GenericContainer(image)\n+            .withExposedPorts(port)\n+            .withPrivilegedMode(true)\n+            .waitingFor(Wait.forListeningPort());\n+\n+      String logMessageWaitStrategy = properties.getProperty(\"database.container.log.regex\");", "originalCommit": "e86732c21d61a514883a93f812a3b1daade48992", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQzNzQ5OQ==", "url": "https://github.com/infinispan/infinispan/pull/8539#discussion_r456437499", "bodyText": "@tristantarrant updated", "author": "gustavolira", "createdAt": "2020-07-17T13:21:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM1ODMyNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjQzODYwNw==", "url": "https://github.com/infinispan/infinispan/pull/8539#discussion_r456438607", "bodyText": "the PR is dirty, I will fix it", "author": "gustavolira", "createdAt": "2020-07-17T13:23:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NjM1ODMyNQ=="}], "type": "inlineReview", "revised_code": {"commit": "d3d358ca96f4b000189b3350dcefdcc3ae148d00", "chunk": "diff --git a/server/testdriver/core/src/main/java/org/infinispan/server/test/core/persistence/ContainerDatabase.java b/server/testdriver/core/src/main/java/org/infinispan/server/test/core/persistence/ContainerDatabase.java\nindex c3b1d0644a..a41e198ee0 100644\n--- a/server/testdriver/core/src/main/java/org/infinispan/server/test/core/persistence/ContainerDatabase.java\n+++ b/server/testdriver/core/src/main/java/org/infinispan/server/test/core/persistence/ContainerDatabase.java\n\n@@ -42,7 +43,7 @@\n             .withPrivilegedMode(true)\n             .waitingFor(Wait.forListeningPort());\n \n-      String logMessageWaitStrategy = properties.getProperty(\"database.container.log.regex\");\n+      String logMessageWaitStrategy = properties.getProperty(TestSystemPropertyNames.INFINISPAN_TEST_CONTAINER_DATABASE_LOG_MESSAGE);\n       if (logMessageWaitStrategy != null) {\n          container.waitingFor(new LogMessageWaitStrategy()\n                .withRegEx(logMessageWaitStrategy)\n"}}, {"oid": "d3d358ca96f4b000189b3350dcefdcc3ae148d00", "url": "https://github.com/infinispan/infinispan/commit/d3d358ca96f4b000189b3350dcefdcc3ae148d00", "message": "ISPN-12103 Improve ContainerDatabase to add custom wait strategy", "committedDate": "2020-07-17T13:19:54Z", "type": "forcePushed"}, {"oid": "4b8c3f8a0ebdf71acb147bff6f0956737a4c6546", "url": "https://github.com/infinispan/infinispan/commit/4b8c3f8a0ebdf71acb147bff6f0956737a4c6546", "message": "ISPN-12103 Improve ContainerDatabase to add custom wait strategy", "committedDate": "2020-07-17T13:21:33Z", "type": "forcePushed"}, {"oid": "259a63a341ccecba2a32697e5ca15ec2f792d820", "url": "https://github.com/infinispan/infinispan/commit/259a63a341ccecba2a32697e5ca15ec2f792d820", "message": "ISPN-12103 Improve ContainerDatabase to add custom wait strategy", "committedDate": "2020-07-17T13:29:58Z", "type": "forcePushed"}, {"oid": "65e79820534286d313d034c48d6edf40a84fda59", "url": "https://github.com/infinispan/infinispan/commit/65e79820534286d313d034c48d6edf40a84fda59", "message": "ISPN-12103 Improve ContainerDatabase to add custom wait strategy", "committedDate": "2020-07-30T18:59:24Z", "type": "commit"}, {"oid": "65e79820534286d313d034c48d6edf40a84fda59", "url": "https://github.com/infinispan/infinispan/commit/65e79820534286d313d034c48d6edf40a84fda59", "message": "ISPN-12103 Improve ContainerDatabase to add custom wait strategy", "committedDate": "2020-07-30T18:59:24Z", "type": "forcePushed"}]}