{"pr_number": 8059, "pr_title": "Transaction Cleanup", "pr_createdAt": "2020-03-16T14:58:54Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8059", "timeline": [{"oid": "4e9b994ffc4ae3771cfa3359c2d79a29e0de3e58", "url": "https://github.com/infinispan/infinispan/commit/4e9b994ffc4ae3771cfa3359c2d79a29e0de3e58", "message": "ISPN-11475 Remove EntryVersionsMap", "committedDate": "2020-03-16T14:56:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzODkxOA==", "url": "https://github.com/infinispan/infinispan/pull/8059#discussion_r393538918", "bodyText": "Random can be removed.\nAlso, newRemoteTransaction() can be removed from the enum since it is the same implementation in all values.", "author": "pruivo", "createdAt": "2020-03-17T09:18:43Z", "path": "core/src/main/java/org/infinispan/transaction/xa/TransactionFactory.java", "diffHunk": "@@ -251,11 +152,6 @@ protected long generateRandomId() {\n          return rnd.nextLong();", "originalCommit": "1a1d9ae1c39cc4f5bebee800e590a25ae0107980", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzU2NjQwOQ==", "url": "https://github.com/infinispan/infinispan/pull/8059#discussion_r393566409", "bodyText": "newRemoteTransaction() implementations are different in NODLD_RECOVERY_XA", "author": "ryanemerson", "createdAt": "2020-03-17T10:05:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzUzODkxOA=="}], "type": "inlineReview", "revised_code": {"commit": "d31e86e39514ac36f2b034ff00d9a6d63cd73c7d", "chunk": "diff --git a/core/src/main/java/org/infinispan/transaction/xa/TransactionFactory.java b/core/src/main/java/org/infinispan/transaction/xa/TransactionFactory.java\nindex d4a3ac174e..d215a84693 100644\n--- a/core/src/main/java/org/infinispan/transaction/xa/TransactionFactory.java\n+++ b/core/src/main/java/org/infinispan/transaction/xa/TransactionFactory.java\n\n@@ -148,22 +146,12 @@ public abstract LocalTransaction newLocalTransaction(Transaction tx, GlobalTrans\n       public abstract GlobalTransaction newGlobalTransaction(Address addr, boolean remote, VersionGenerator clusterIdGenerator, boolean clustered);\n       public abstract GlobalTransaction newGlobalTransaction();\n \n-      protected long generateRandomId() {\n-         return rnd.nextLong();\n-      }\n-\n-      /**\n-       * this class is internally synchronized, so it can be shared between instances\n-       */\n-      private final Random rnd = new Random();\n-\n       public abstract RemoteTransaction newRemoteTransaction(WriteCommand[] modifications, GlobalTransaction tx,\n                                                              int topologyId, long txCreationTime);\n \n       public abstract RemoteTransaction newRemoteTransaction(GlobalTransaction tx, int topologyId, long txCreationTime);\n    }\n \n-\n    public GlobalTransaction newGlobalTransaction() {\n       return txFactoryEnum.newGlobalTransaction();\n    }\n"}}, {"oid": "d31e86e39514ac36f2b034ff00d9a6d63cd73c7d", "url": "https://github.com/infinispan/infinispan/commit/d31e86e39514ac36f2b034ff00d9a6d63cd73c7d", "message": "ISPN-11476 Remove deprecated Transaction classes", "committedDate": "2020-03-17T10:22:16Z", "type": "commit"}, {"oid": "d31e86e39514ac36f2b034ff00d9a6d63cd73c7d", "url": "https://github.com/infinispan/infinispan/commit/d31e86e39514ac36f2b034ff00d9a6d63cd73c7d", "message": "ISPN-11476 Remove deprecated Transaction classes", "committedDate": "2020-03-17T10:22:16Z", "type": "forcePushed"}]}