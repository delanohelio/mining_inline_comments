{"pr_number": 7989, "pr_title": "ISPN-11198 rolling upgrade docs", "pr_createdAt": "2020-03-04T13:57:06Z", "pr_url": "https://github.com/infinispan/infinispan/pull/7989", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc0ODMzNQ==", "url": "https://github.com/infinispan/infinispan/pull/7989#discussion_r387748335", "bodyText": "@gustavonalle the migratorName should always be \"hotrod\" unless you use a custom migrator? could we set that as the default so users only need the parameter if they use some other migrator?", "author": "oraNod", "createdAt": "2020-03-04T15:37:58Z", "path": "core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java", "diffHunk": "@@ -40,10 +40,10 @@\n    @Inject GlobalConfiguration globalConfiguration;\n \n    @ManagedOperation(\n-         description = \"Synchronizes data from the old cluster to this using the specified migrator\",\n-         displayName = \"Synchronizes data from the old cluster to this using the specified migrator\"\n+         description = \"Synchronizes data from source clusters to target clusters with the specified migrator.\",\n+         displayName = \"Synchronizes data from source clusters to target clusters with the specified migrator.\"\n    )\n-   public long synchronizeData(@Parameter(name=\"migratorName\", description=\"The name of the migrator to use\") String migratorName) throws Exception {\n+   public long synchronizeData(@Parameter(name=\"migratorName\", description=\"Specifies the name of the migrator to use. Set hotrod as the value unless using custom migrators.\") String migratorName) throws Exception {", "originalCommit": "dd719a6030cbd5669cb9b0c565354175d11b0bf3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc2NjU1Nw==", "url": "https://github.com/infinispan/infinispan/pull/7989#discussion_r389766557", "bodyText": "The only one usable is 'hotrod'. We could set it as 'default'\nhttps://issues.redhat.com/browse/ISPN-11442", "author": "gustavonalle", "createdAt": "2020-03-09T15:27:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc0ODMzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc5MjcwOA==", "url": "https://github.com/infinispan/infinispan/pull/7989#discussion_r389792708", "bodyText": "nice, one less parameter", "author": "oraNod", "createdAt": "2020-03-09T16:06:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Nzc0ODMzNQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "74a6630f547b15dd42f500f5807a1491934e624b", "url": "https://github.com/infinispan/infinispan/commit/74a6630f547b15dd42f500f5807a1491934e624b", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-03-04T16:23:38Z", "type": "forcePushed"}, {"oid": "b289402e19ba6a6f1745f031397f4f55e9c2868a", "url": "https://github.com/infinispan/infinispan/commit/b289402e19ba6a6f1745f031397f4f55e9c2868a", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-03-10T10:01:26Z", "type": "forcePushed"}, {"oid": "3b54cacf4ee050cb037c9b544e277cf74520d23d", "url": "https://github.com/infinispan/infinispan/commit/3b54cacf4ee050cb037c9b544e277cf74520d23d", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-03-13T14:41:56Z", "type": "forcePushed"}, {"oid": "d889e70972ce7834e15e11152877ba1a407883af", "url": "https://github.com/infinispan/infinispan/commit/d889e70972ce7834e15e11152877ba1a407883af", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-03-19T11:45:06Z", "type": "forcePushed"}, {"oid": "d84bd260e467e9c352bed48f9b053dbb076b1627", "url": "https://github.com/infinispan/infinispan/commit/d84bd260e467e9c352bed48f9b053dbb076b1627", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-03-24T12:53:45Z", "type": "forcePushed"}, {"oid": "d2597afce97eabc3bf6a7dde5f2389b47aaead2a", "url": "https://github.com/infinispan/infinispan/commit/d2597afce97eabc3bf6a7dde5f2389b47aaead2a", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-03-26T09:30:44Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTE0NQ==", "url": "https://github.com/infinispan/infinispan/pull/7989#discussion_r402841145", "bodyText": "You can migrate to same version as well", "author": "gustavonalle", "createdAt": "2020-04-03T08:41:01Z", "path": "core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java", "diffHunk": "@@ -22,14 +22,14 @@\n import org.infinispan.util.logging.LogFactory;\n \n /**\n- * This component handles the control hooks to handle migrating from one version of Infinispan to\n- * another.\n+ * RollingUpgradeManager handles the synchronization of data between Infinispan\n+ * clusters when performing rolling upgrades.\n  *\n  * @author Manik Surtani\n  * @author Tristan Tarrant\n  * @since 5.2\n  */\n-@MBean(objectName = \"RollingUpgradeManager\", description = \"This component handles the control hooks to handle migrating data from one version of Infinispan to another\")\n+@MBean(objectName = \"RollingUpgradeManager\", description = \"Handles the migration of data when upgrading to new versions.\")", "originalCommit": "d2597afce97eabc3bf6a7dde5f2389b47aaead2a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fd575a3b91683b052e5f311fa14413ebe32a5f37", "chunk": "diff --git a/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java b/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java\nindex ffb10fa02d..66f063ea6a 100644\n--- a/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java\n+++ b/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java\n\n@@ -29,7 +29,7 @@\n  * @author Tristan Tarrant\n  * @since 5.2\n  */\n-@MBean(objectName = \"RollingUpgradeManager\", description = \"Handles the migration of data when upgrading to new versions.\")\n+@MBean(objectName = \"RollingUpgradeManager\", description = \"Handles the migration of data when upgrading between versions.\")\n @Scope(value = Scopes.NAMED_CACHE)\n @SurvivesRestarts\n public class RollingUpgradeManager {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMjg0MTk0Nw==", "url": "https://github.com/infinispan/infinispan/pull/7989#discussion_r402841947", "bodyText": "The 'read batch' is just how many entries are read at a time, not synchronized", "author": "gustavonalle", "createdAt": "2020-04-03T08:41:58Z", "path": "core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java", "diffHunk": "@@ -53,12 +53,12 @@ public long synchronizeData(@Parameter(name=\"migratorName\", description=\"The nam\n    }\n \n    @ManagedOperation(\n-           description = \"Synchronizes data from the old cluster to this using the specified migrator\",\n-           displayName = \"Synchronizes data from the old cluster to this using the specified migrator\"\n+           description = \"Synchronizes data from source clusters to target clusters with the specified migrator.\",\n+           displayName = \"Synchronizes data from source clusters to target clusters with the specified migrator.\"\n    )\n-   public long synchronizeData(@Parameter(name = \"migratorName\", description = \"The name of the migrator to use\") String migratorName,\n-                               @Parameter(name = \"readBatch\", description = \"Numbers of entries transferred at a time from the old cluster\") int readBatch,\n-                               @Parameter(name = \"threads\", description = \"Number of threads per node used to write data to the new cluster\") int threads) throws Exception {\n+   public long synchronizeData(@Parameter(name = \"migratorName\", description = \"Specifies the name of the migrator to use. Set hotrod as the value unless using custom migrators.\") String migratorName,\n+                               @Parameter(name = \"readBatch\", description = \"Specifies how many entries to synchronize at a time from source clusters. Default is 10000.\") int readBatch,", "originalCommit": "d2597afce97eabc3bf6a7dde5f2389b47aaead2a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fd575a3b91683b052e5f311fa14413ebe32a5f37", "chunk": "diff --git a/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java b/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java\nindex ffb10fa02d..66f063ea6a 100644\n--- a/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java\n+++ b/core/src/main/java/org/infinispan/upgrade/RollingUpgradeManager.java\n\n@@ -57,7 +57,7 @@ public long synchronizeData(@Parameter(name=\"migratorName\", description=\"Specifi\n            displayName = \"Synchronizes data from source clusters to target clusters with the specified migrator.\"\n    )\n    public long synchronizeData(@Parameter(name = \"migratorName\", description = \"Specifies the name of the migrator to use. Set hotrod as the value unless using custom migrators.\") String migratorName,\n-                               @Parameter(name = \"readBatch\", description = \"Specifies how many entries to synchronize at a time from source clusters. Default is 10000.\") int readBatch,\n+                               @Parameter(name = \"readBatch\", description = \"Specifies how many entries to read at a time from source clusters. Default is 10000.\") int readBatch,\n                                @Parameter(name = \"threads\", description = \"Specifies the number of threads to use per node when writing data to target clusters. Defaults to number of available processors.\") int threads) throws Exception {\n       TargetMigrator migrator = getMigrator(migratorName);\n       long start = timeService.time();\n"}}, {"oid": "fd575a3b91683b052e5f311fa14413ebe32a5f37", "url": "https://github.com/infinispan/infinispan/commit/fd575a3b91683b052e5f311fa14413ebe32a5f37", "message": "ISPN-11198 RU add REST invocations + feedback", "committedDate": "2020-04-22T17:04:36Z", "type": "forcePushed"}, {"oid": "bf1e3ea065bd8a1ecfbcc8e7aea9ca5976cf96e1", "url": "https://github.com/infinispan/infinispan/commit/bf1e3ea065bd8a1ecfbcc8e7aea9ca5976cf96e1", "message": "ISPN-11198 RU add REST invocations + feedback", "committedDate": "2020-04-28T07:43:50Z", "type": "forcePushed"}, {"oid": "724f3705088449ed705b1ccfa3713e4358847663", "url": "https://github.com/infinispan/infinispan/commit/724f3705088449ed705b1ccfa3713e4358847663", "message": "fixing upgrade guide", "committedDate": "2020-04-28T16:50:39Z", "type": "forcePushed"}, {"oid": "fc6138bbccd7825261aea50d9506d1e2fd9d3179", "url": "https://github.com/infinispan/infinispan/commit/fc6138bbccd7825261aea50d9506d1e2fd9d3179", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-04-29T11:52:03Z", "type": "forcePushed"}, {"oid": "5bc7ef55eef1886742292b37d7182025a0aa3cac", "url": "https://github.com/infinispan/infinispan/commit/5bc7ef55eef1886742292b37d7182025a0aa3cac", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-04-30T08:14:48Z", "type": "commit"}, {"oid": "5bc7ef55eef1886742292b37d7182025a0aa3cac", "url": "https://github.com/infinispan/infinispan/commit/5bc7ef55eef1886742292b37d7182025a0aa3cac", "message": "ISPN-11198 rolling upgrade docs", "committedDate": "2020-04-30T08:14:48Z", "type": "forcePushed"}]}