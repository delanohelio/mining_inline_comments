{"pr_number": 8046, "pr_title": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics \u2026", "pr_createdAt": "2020-03-12T10:28:58Z", "pr_url": "https://github.com/infinispan/infinispan/pull/8046", "timeline": [{"oid": "786c64cd7231fe953781e5a2da51d09abb7a66be", "url": "https://github.com/infinispan/infinispan/commit/786c64cd7231fe953781e5a2da51d09abb7a66be", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-12T10:53:57Z", "type": "forcePushed"}, {"oid": "a1c59c6a18a7f3120117ae08e75ac3102e0c45b5", "url": "https://github.com/infinispan/infinispan/commit/a1c59c6a18a7f3120117ae08e75ac3102e0c45b5", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-12T11:24:45Z", "type": "forcePushed"}, {"oid": "0f149fd0e630a0c5f7e70c97d17bb5974153f434", "url": "https://github.com/infinispan/infinispan/commit/0f149fd0e630a0c5f7e70c97d17bb5974153f434", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-16T10:20:05Z", "type": "forcePushed"}, {"oid": "e9ef6ffce53983505bfa689ec306e40ca722096e", "url": "https://github.com/infinispan/infinispan/commit/e9ef6ffce53983505bfa689ec306e40ca722096e", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-17T17:39:53Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzY4NQ==", "url": "https://github.com/infinispan/infinispan/pull/8046#discussion_r395647685", "bodyText": "This method was extracted just in case we need to replace it for quarkus.", "author": "anistor", "createdAt": "2020-03-20T13:48:44Z", "path": "server/rest/src/main/java/org/infinispan/rest/resources/MetricsResource.java", "diffHunk": "@@ -42,6 +42,10 @@\n    private final MetricsRequestHandler requestHandler = new MetricsRequestHandler();\n \n    public MetricsResource() {\n+      registerBaseMetrics();\n+   }\n+\n+   private void registerBaseMetrics() {", "originalCommit": "e9ef6ffce53983505bfa689ec306e40ca722096e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzI0MzkzNw==", "url": "https://github.com/infinispan/infinispan/pull/8046#discussion_r397243937", "bodyText": "shouldn't be protected?", "author": "pruivo", "createdAt": "2020-03-24T15:29:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzcxNjcxMQ==", "url": "https://github.com/infinispan/infinispan/pull/8046#discussion_r397716711", "bodyText": "For quarkus? I don't know. Maybe @wburns ?", "author": "anistor", "createdAt": "2020-03-25T09:34:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzczNzYzNw==", "url": "https://github.com/infinispan/infinispan/pull/8046#discussion_r397737637", "bodyText": "@anistor I'm pretty sure Quarkus can replace a private method, so it doesn't need to be protected. But it would be nice to have a comment in the code, to prevent others from trying to inline it and finding out that we need it for Quarkus after the PR is integrated.", "author": "danberindei", "createdAt": "2020-03-25T10:08:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzY4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODUwNjc4Ng==", "url": "https://github.com/infinispan/infinispan/pull/8046#discussion_r398506786", "bodyText": "done!", "author": "anistor", "createdAt": "2020-03-26T11:41:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY0NzY4NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ea8072542935b8e1541ec591ad4afef5d947f912", "chunk": "diff --git a/server/rest/src/main/java/org/infinispan/rest/resources/MetricsResource.java b/server/rest/src/main/java/org/infinispan/rest/resources/MetricsResource.java\nindex fbb91e6927..b06b413395 100644\n--- a/server/rest/src/main/java/org/infinispan/rest/resources/MetricsResource.java\n+++ b/server/rest/src/main/java/org/infinispan/rest/resources/MetricsResource.java\n\n@@ -45,6 +45,7 @@ public MetricsResource() {\n       registerBaseMetrics();\n    }\n \n+   // this is kept separate just in case Quarkus needs to replace it with nil\n    private void registerBaseMetrics() {\n       try {\n          new JmxRegistrar().init();\n"}}, {"oid": "0bf74bb69b9f6b5f927104a840ee1e5debc121c7", "url": "https://github.com/infinispan/infinispan/commit/0bf74bb69b9f6b5f927104a840ee1e5debc121c7", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-20T17:40:41Z", "type": "forcePushed"}, {"oid": "32d30ecd0fa7821274bdbf2eaec4880a12d2559b", "url": "https://github.com/infinispan/infinispan/commit/32d30ecd0fa7821274bdbf2eaec4880a12d2559b", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-23T11:05:57Z", "type": "forcePushed"}, {"oid": "ea8072542935b8e1541ec591ad4afef5d947f912", "url": "https://github.com/infinispan/infinispan/commit/ea8072542935b8e1541ec591ad4afef5d947f912", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-26T11:40:35Z", "type": "commit"}, {"oid": "ea8072542935b8e1541ec591ad4afef5d947f912", "url": "https://github.com/infinispan/infinispan/commit/ea8072542935b8e1541ec591ad4afef5d947f912", "message": "ISPN-11463 Cache manager stats are mistakenly exported as MP metrics even when stats disabled", "committedDate": "2020-03-26T11:40:35Z", "type": "forcePushed"}]}