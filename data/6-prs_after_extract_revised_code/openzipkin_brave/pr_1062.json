{"pr_number": 1062, "pr_title": "Updates dependency versions, notably gRPC which has some changes", "pr_createdAt": "2020-01-22T08:37:33Z", "pr_url": "https://github.com/openzipkin/brave/pull/1062", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNjk4Nw==", "url": "https://github.com/openzipkin/brave/pull/1062#discussion_r369426987", "bodyText": "a separate change would need to make the next version of dubbo not crash tests. this just avoids referencing a constant they later deleted", "author": "codefromthecrypt", "createdAt": "2020-01-22T08:38:42Z", "path": "instrumentation/dubbo/src/main/java/brave/dubbo/DubboParser.java", "diffHunk": "@@ -19,9 +19,6 @@\n import org.apache.dubbo.rpc.Invoker;\n import org.apache.dubbo.rpc.support.RpcUtils;\n \n-import static org.apache.dubbo.rpc.Constants.$INVOKE;", "originalCommit": "6d69ffc0afe5189e55972209ffb01b0bcd9e6aff", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "6d69ffc0afe5189e55972209ffb01b0bcd9e6aff", "url": "https://github.com/openzipkin/brave/commit/6d69ffc0afe5189e55972209ffb01b0bcd9e6aff", "message": "Updates dependency versions, notably gRPC which has some changes\n\n* gRPC 1.22 census integration stopped propagating \"method\", so caused test drift\n* gRPC also removed the parameter to withPlainText\n* Dubbo 2.7.5 removed some constants, but tests fail. I removed use of the constants.", "committedDate": "2020-01-22T08:38:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTQyNzQyMQ==", "url": "https://github.com/openzipkin/brave/pull/1062#discussion_r369427421", "bodyText": "diff didn't notice this file was just renamed with one method added.", "author": "codefromthecrypt", "createdAt": "2020-01-22T08:39:49Z", "path": "instrumentation/grpc/src/test/java/brave/grpc/BaseITTracingClientInterceptor.java", "diffHunk": "@@ -0,0 +1,395 @@\n+/*\n+ * Copyright 2013-2020 The OpenZipkin Authors\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except\n+ * in compliance with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n+ */\n+package brave.grpc;\n+\n+import brave.ScopedSpan;\n+import brave.SpanCustomizer;\n+import brave.Tracer;\n+import brave.Tracing;\n+import brave.context.log4j2.ThreadContextScopeDecorator;\n+import brave.propagation.StrictScopeDecorator;\n+import brave.propagation.ThreadLocalCurrentTraceContext;\n+import brave.propagation.TraceContext;\n+import brave.propagation.TraceContextOrSamplingFlags;\n+import brave.rpc.RpcRuleSampler;\n+import brave.rpc.RpcTracing;\n+import brave.sampler.Sampler;\n+import com.google.common.util.concurrent.ListenableFuture;\n+import io.grpc.CallOptions;\n+import io.grpc.Channel;\n+import io.grpc.ClientCall;\n+import io.grpc.ClientInterceptor;\n+import io.grpc.ForwardingClientCall;\n+import io.grpc.ManagedChannel;\n+import io.grpc.ManagedChannelBuilder;\n+import io.grpc.Metadata;\n+import io.grpc.MethodDescriptor;\n+import io.grpc.StatusRuntimeException;\n+import io.grpc.examples.helloworld.GraterGrpc;\n+import io.grpc.examples.helloworld.GreeterGrpc;\n+import io.grpc.examples.helloworld.HelloReply;\n+import io.grpc.examples.helloworld.HelloRequest;\n+import java.io.IOException;\n+import java.util.Arrays;\n+import java.util.Iterator;\n+import java.util.concurrent.BlockingQueue;\n+import java.util.concurrent.LinkedBlockingQueue;\n+import java.util.concurrent.TimeUnit;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.junit.After;\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.TestRule;\n+import org.junit.rules.TestWatcher;\n+import org.junit.runner.Description;\n+import zipkin2.Annotation;\n+import zipkin2.Span;\n+\n+import static brave.grpc.GreeterImpl.HELLO_REQUEST;\n+import static brave.rpc.RpcRequestMatchers.methodEquals;\n+import static brave.rpc.RpcRequestMatchers.serviceEquals;\n+import static brave.sampler.Sampler.ALWAYS_SAMPLE;\n+import static brave.sampler.Sampler.NEVER_SAMPLE;\n+import static org.assertj.core.api.Assertions.assertThat;\n+import static org.assertj.core.api.Assertions.catchThrowableOfType;\n+import static org.assertj.core.api.Assertions.entry;\n+import static org.assertj.core.api.Assertions.failBecauseExceptionWasNotThrown;\n+import static org.junit.Assume.assumeTrue;\n+\n+public abstract class BaseITTracingClientInterceptor {", "originalCommit": "6d69ffc0afe5189e55972209ffb01b0bcd9e6aff", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}