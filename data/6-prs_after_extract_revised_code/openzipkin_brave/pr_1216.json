{"pr_number": 1216, "pr_title": "Polish based on use in secondary sampling and sleuth", "pr_createdAt": "2020-05-17T06:38:09Z", "pr_url": "https://github.com/openzipkin/brave/pull/1216", "timeline": [{"oid": "cf720539bcb4745305daa3f02f9cf88a1034b0cc", "url": "https://github.com/openzipkin/brave/commit/cf720539bcb4745305daa3f02f9cf88a1034b0cc", "message": "Adds accidentally forgotten unset methods", "committedDate": "2020-05-17T06:39:01Z", "type": "commit"}, {"oid": "8d1f3db94d25447a20a95643ec9da80100efabb0", "url": "https://github.com/openzipkin/brave/commit/8d1f3db94d25447a20a95643ec9da80100efabb0", "message": "fix bug", "committedDate": "2020-05-17T07:10:24Z", "type": "commit"}, {"oid": "97b5fcdbf5a7c4e605515c46e0d3c9202fa8d09c", "url": "https://github.com/openzipkin/brave/commit/97b5fcdbf5a7c4e605515c46e0d3c9202fa8d09c", "message": "add really long timeout for SpringBootTest", "committedDate": "2020-05-17T07:50:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzMDE2Ng==", "url": "https://github.com/openzipkin/brave/pull/1216#discussion_r426230166", "bodyText": "I always wanted this to be less, but I feel like moving it to 5s will just result in another PR to move it to 10", "author": "codefromthecrypt", "createdAt": "2020-05-17T07:54:20Z", "path": "brave-tests/src/main/java/brave/test/IntegrationTestSpanHandler.java", "diffHunk": "@@ -146,7 +146,9 @@ public MutableSpan takeLocalSpan() {\n   MutableSpan doTakeSpan(boolean flushed) {\n     MutableSpan result;\n     try {\n-      result = spans.poll(3, TimeUnit.SECONDS);\n+      // Same rationale as ITRemote: tests should never take 5s in normal circumstances.\n+      // In practice, @SpringBootTest tests overrun 3-5 seconds in CI.\n+      result = spans.poll(20, TimeUnit.SECONDS);", "originalCommit": "97b5fcdbf5a7c4e605515c46e0d3c9202fa8d09c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzMTI4Ng==", "url": "https://github.com/openzipkin/brave/pull/1216#discussion_r426231286", "bodyText": "So how about set to 10? ;)", "author": "anuraaga", "createdAt": "2020-05-17T08:07:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIzMDE2Ng=="}], "type": "inlineReview", "revised_code": {"commit": "ebf5598d48b799b716965ad0d6f45236b54d3f4c", "chunk": "diff --git a/brave-tests/src/main/java/brave/test/IntegrationTestSpanHandler.java b/brave-tests/src/main/java/brave/test/IntegrationTestSpanHandler.java\nindex 02cb22c3c..fbdab5541 100644\n--- a/brave-tests/src/main/java/brave/test/IntegrationTestSpanHandler.java\n+++ b/brave-tests/src/main/java/brave/test/IntegrationTestSpanHandler.java\n\n@@ -147,7 +147,7 @@ public final class IntegrationTestSpanHandler extends SpanHandler implements Tes\n     MutableSpan result;\n     try {\n       // Same rationale as ITRemote: tests should never take 5s in normal circumstances.\n-      // In practice, @SpringBootTest tests overrun 3-5 seconds in CI.\n+      // However, @SpringBootTest with web environment and a lot in the classpath can take >3s\n       result = spans.poll(20, TimeUnit.SECONDS);\n     } catch (InterruptedException e) {\n       Thread.currentThread().interrupt();\n"}}, {"oid": "ebf5598d48b799b716965ad0d6f45236b54d3f4c", "url": "https://github.com/openzipkin/brave/commit/ebf5598d48b799b716965ad0d6f45236b54d3f4c", "message": "clarify", "committedDate": "2020-05-17T07:55:00Z", "type": "commit"}, {"oid": "73dae4fea18facac49f8a37f83fa95f0051917f0", "url": "https://github.com/openzipkin/brave/commit/73dae4fea18facac49f8a37f83fa95f0051917f0", "message": "and the number for the counting is 10.. 4 is right out", "committedDate": "2020-05-17T08:16:24Z", "type": "commit"}]}