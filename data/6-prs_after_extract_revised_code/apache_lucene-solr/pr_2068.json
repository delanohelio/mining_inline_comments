{"pr_number": 2068, "pr_title": "LUCENE-8982: Separate out native code to another module to allow cpp build with gradle", "pr_createdAt": "2020-11-07T06:52:46Z", "pr_url": "https://github.com/apache/lucene-solr/pull/2068", "timeline": [{"oid": "56cfaf6a391dba407c92c6480700fd9399d99f4a", "url": "https://github.com/apache/lucene-solr/commit/56cfaf6a391dba407c92c6480700fd9399d99f4a", "message": "LUCENE-8982: Separate out native code to another module to allow cpp build with gradle", "committedDate": "2020-11-07T06:47:02Z", "type": "commit"}, {"oid": "55212151aa81d745ff8fef7276dae523abea0e0d", "url": "https://github.com/apache/lucene-solr/commit/55212151aa81d745ff8fef7276dae523abea0e0d", "message": "Condition native build by using -Pbuild.native=true attribute", "committedDate": "2020-11-09T00:07:31Z", "type": "commit"}, {"oid": "b6c16c00faaad2c626a93495f9dfbf878d62968b", "url": "https://github.com/apache/lucene-solr/commit/b6c16c00faaad2c626a93495f9dfbf878d62968b", "message": "Use rootProject.ext.runtimeJava instead of plain vanilla java.home", "committedDate": "2020-11-09T01:02:33Z", "type": "commit"}, {"oid": "31f10be6219e4a745aaae0ec29b75202e391d234", "url": "https://github.com/apache/lucene-solr/commit/31f10be6219e4a745aaae0ec29b75202e391d234", "message": "Check include folder exist before using", "committedDate": "2020-11-09T03:46:07Z", "type": "commit"}, {"oid": "085c71c384442ceb7b2a0ca371429321e7b1b4fe", "url": "https://github.com/apache/lucene-solr/commit/085c71c384442ceb7b2a0ca371429321e7b1b4fe", "message": "Windows build. Cleanups.", "committedDate": "2020-11-09T21:10:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDM4NTU5Ng==", "url": "https://github.com/apache/lucene-solr/pull/2068#discussion_r520385596", "bodyText": "I removed the flag and forgot to update the docs here.", "author": "dweiss", "createdAt": "2020-11-10T08:46:04Z", "path": "lucene/misc/src/java/org/apache/lucene/store/NativeUnixDirectory.java", "diffHunk": "@@ -47,10 +47,10 @@\n  *\n  * <p>To use this you must compile\n  * NativePosixUtil.cpp (exposes Linux-specific APIs through\n- * JNI) for your platform, by running <code>ant\n- * build-native-unix</code>, and then putting the resulting\n- * <code>libNativePosixUtil.so</code> (from\n- * <code>lucene/build/native</code>) onto your dynamic\n+ * JNI) for your platform, by running <code>\n+ * ./gradlew build -Pbuild.native=true</code>, and then putting the resulting", "originalCommit": "085c71c384442ceb7b2a0ca371429321e7b1b4fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTA2ODU0NA==", "url": "https://github.com/apache/lucene-solr/pull/2068#discussion_r521068544", "bodyText": "Updated.", "author": "zacharymorn", "createdAt": "2020-11-11T03:08:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDM4NTU5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "ac440fa1ee5b901130d1ee712c1af7880a508a35", "chunk": "diff --git a/lucene/misc/src/java/org/apache/lucene/store/NativeUnixDirectory.java b/lucene/misc/src/java/org/apache/lucene/store/NativeUnixDirectory.java\nindex b800ed67846..19ddfa6cc04 100644\n--- a/lucene/misc/src/java/org/apache/lucene/store/NativeUnixDirectory.java\n+++ b/lucene/misc/src/java/org/apache/lucene/store/NativeUnixDirectory.java\n\n@@ -47,10 +47,9 @@ import org.apache.lucene.util.SuppressForbidden;\n  *\n  * <p>To use this you must compile\n  * NativePosixUtil.cpp (exposes Linux-specific APIs through\n- * JNI) for your platform, by running <code>\n- * ./gradlew build -Pbuild.native=true</code>, and then putting the resulting\n- * <code>libNativePosixUtil.so</code> or <code>libNativePosixUtil.dylib</code>\n- * (from <code>lucene/native/build/lib/release/platform/</code>) onto your dynamic\n+ * JNI) for your platform, by running <code>./gradlew build</code>, and then putting the resulting\n+ * <code>libLuceneNativeIO.so</code> or <code>libLuceneNativeIO.dylib</code>\n+ * (from <code>lucene/misc/native/build/lib/release/platform/</code>) onto your dynamic\n  * linker search path.\n  *\n  * <p><b>WARNING</b>: this code is very new and quite easily\n"}}, {"oid": "ac440fa1ee5b901130d1ee712c1af7880a508a35", "url": "https://github.com/apache/lucene-solr/commit/ac440fa1ee5b901130d1ee712c1af7880a508a35", "message": "Update naming, references and documentation", "committedDate": "2020-11-11T03:07:39Z", "type": "commit"}, {"oid": "6557a17fedcb31b933d7cba1b85e6e0d455e7751", "url": "https://github.com/apache/lucene-solr/commit/6557a17fedcb31b933d7cba1b85e6e0d455e7751", "message": "Merge branch 'master' into LUCENE-8982-NativeBuild", "committedDate": "2020-11-11T03:17:54Z", "type": "commit"}, {"oid": "d7322ef0a4e0dafa12e2f24034fbdea68fdb2f4b", "url": "https://github.com/apache/lucene-solr/commit/d7322ef0a4e0dafa12e2f24034fbdea68fdb2f4b", "message": "Remove outdated files created during merge conflict resolution, this would cause git to think there's a move for the 2 files", "committedDate": "2020-11-11T04:05:02Z", "type": "commit"}, {"oid": "90763e71290986160f1cfc7fb7ac8bb11d317a41", "url": "https://github.com/apache/lucene-solr/commit/90763e71290986160f1cfc7fb7ac8bb11d317a41", "message": "Add 'build.native' kill switch.", "committedDate": "2020-11-11T20:34:23Z", "type": "commit"}, {"oid": "1a27baf8ff39e5240635de9cccbe93a6b67aa87f", "url": "https://github.com/apache/lucene-solr/commit/1a27baf8ff39e5240635de9cccbe93a6b67aa87f", "message": "Merge branch 'master' into LUCENE-8982-NativeBuild", "committedDate": "2020-11-12T03:28:30Z", "type": "commit"}, {"oid": "948f873ba59315d4d79b72d0010b01cb75f72054", "url": "https://github.com/apache/lucene-solr/commit/948f873ba59315d4d79b72d0010b01cb75f72054", "message": "Update native code and overview.html to reflect the new locations / way of buildling native code", "committedDate": "2020-11-12T03:28:51Z", "type": "commit"}, {"oid": "e4dac53d510bcdce5056cd68073ba5dc4c7a187c", "url": "https://github.com/apache/lucene-solr/commit/e4dac53d510bcdce5056cd68073ba5dc4c7a187c", "message": "Add test and fix WindowsDirectory library name", "committedDate": "2020-11-12T05:37:55Z", "type": "commit"}, {"oid": "9b60b0c0988dcd437fc3076c530fd4ee1d3f4718", "url": "https://github.com/apache/lucene-solr/commit/9b60b0c0988dcd437fc3076c530fd4ee1d3f4718", "message": "Clean up the overview a bit.", "committedDate": "2020-11-13T08:16:10Z", "type": "commit"}, {"oid": "22a1bdcabe62c4eaa08093e13a8b5e73c0346a7f", "url": "https://github.com/apache/lucene-solr/commit/22a1bdcabe62c4eaa08093e13a8b5e73c0346a7f", "message": "Run or ignore native tests on multiple platforms.", "committedDate": "2020-11-13T10:03:09Z", "type": "commit"}, {"oid": "a635b564a1d4701ec26e8adf927c030c639c3ecb", "url": "https://github.com/apache/lucene-solr/commit/a635b564a1d4701ec26e8adf927c030c639c3ecb", "message": "Add require permission on linux.", "committedDate": "2020-11-13T10:08:54Z", "type": "commit"}, {"oid": "e959967fd587874af7eb4efb1e92dbe402415f2f", "url": "https://github.com/apache/lucene-solr/commit/e959967fd587874af7eb4efb1e92dbe402415f2f", "message": "Merge remote-tracking branch 'origin/master' into LUCENE-8982-NativeBuild", "committedDate": "2020-11-16T07:58:30Z", "type": "commit"}, {"oid": "3eb8faf6fc1977d9d6b0431ab6f9a2e199371089", "url": "https://github.com/apache/lucene-solr/commit/3eb8faf6fc1977d9d6b0431ab6f9a2e199371089", "message": "Added changes entry.", "committedDate": "2020-11-16T08:08:49Z", "type": "commit"}]}