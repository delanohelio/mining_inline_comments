{"pr_number": 1546, "pr_title": "SOLR: Use absolute paths for server paths.", "pr_createdAt": "2020-05-31T05:20:35Z", "pr_url": "https://github.com/apache/lucene-solr/pull/1546", "timeline": [{"oid": "b96bc84a0b378911a62bdf2039a8dc4833e0c7dd", "url": "https://github.com/apache/lucene-solr/commit/b96bc84a0b378911a62bdf2039a8dc4833e0c7dd", "message": "SOLR: Use absolute paths for server paths.\nFixes relative path ambiguities when the current working directory is atypical.", "committedDate": "2020-05-31T05:16:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjkxMDk2OQ==", "url": "https://github.com/apache/lucene-solr/pull/1546#discussion_r432910969", "bodyText": "Just a little change to make the var effectively final, which is clearer.", "author": "dsmiley", "createdAt": "2020-05-31T05:21:32Z", "path": "solr/core/src/java/org/apache/solr/handler/admin/CoreAdminOperation.java", "diffHunk": "@@ -77,7 +77,7 @@\n     String coreName = params.required().get(CoreAdminParams.NAME);\n     Map<String, String> coreParams = buildCoreParams(params);\n     CoreContainer coreContainer = it.handler.coreContainer;\n-    Path instancePath = coreContainer.getCoreRootDirectory().resolve(coreName);\n+    Path instancePath;", "originalCommit": "b96bc84a0b378911a62bdf2039a8dc4833e0c7dd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "e374c5c92e7a6964ef1c275a3ebb5b1f9b217fb7", "url": "https://github.com/apache/lucene-solr/commit/e374c5c92e7a6964ef1c275a3ebb5b1f9b217fb7", "message": "SOLR: Also use absolute paths for SolrCore instanceDir.\nRemoved needless toAbsolutePath and normalize or needless resolving known-absolute paths with something else.\nNodeConfig: Moved toAbsolutePath to setters.", "committedDate": "2020-06-02T05:05:16Z", "type": "commit"}, {"oid": "4eb2be42918be1e190d1addc98c91c4a42f31b6c", "url": "https://github.com/apache/lucene-solr/commit/4eb2be42918be1e190d1addc98c91c4a42f31b6c", "message": "almost done.", "committedDate": "2020-06-02T18:11:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA2MDc4Nw==", "url": "https://github.com/apache/lucene-solr/pull/1546#discussion_r439060787", "bodyText": "A bit late, but I don't think this is necessary, as all callers will send absolute paths. And if you ever get a relative path, resolving it with toAbsolutePath() leads to it being relative to whatever CWD the app is started with, while the typical resolving of relative instanceDir is to resolve it relative to CoreContainer#coreRootDirectory.", "author": "janhoy", "createdAt": "2020-06-11T20:44:18Z", "path": "solr/core/src/java/org/apache/solr/core/CoreDescriptor.java", "diffHunk": "@@ -182,7 +182,7 @@ public CoreDescriptor(String coreName, CoreDescriptor other) {\n    */\n   public CoreDescriptor(String name, Path instanceDir, Map<String, String> coreProps,\n                         Properties containerProperties, ZkController zkController) {\n-    this.instanceDir = instanceDir;\n+    this.instanceDir = instanceDir.toAbsolutePath();", "originalCommit": "4eb2be42918be1e190d1addc98c91c4a42f31b6c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA4MzkzMA==", "url": "https://github.com/apache/lucene-solr/pull/1546#discussion_r439083930", "bodyText": "That makes sense; thanks.  I see that all callers send absolute paths already.  So I think I should change this to throw an exception if it isn't absolute to protect us from mistakes.\nI'll push a new commit here for review.  I've never done that for an already merged PR; we'll see how it goes.", "author": "dsmiley", "createdAt": "2020-06-11T21:37:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTA2MDc4Nw=="}], "type": "inlineReview", "revised_code": null}]}