{"pr_number": 1214, "pr_title": "Fix#1142 datasource lookup with tomcat jndi prefix", "pr_createdAt": "2020-10-29T09:04:40Z", "pr_url": "https://github.com/ibissource/iaf/pull/1214", "timeline": [{"oid": "012aa368545be8060453d1de96fd8db3c2a6b6a1", "url": "https://github.com/ibissource/iaf/commit/012aa368545be8060453d1de96fd8db3c2a6b6a1", "message": "Fix#1142 datasource lookup with tomcat jndi prefix", "committedDate": "2020-10-29T09:00:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkxODMzOA==", "url": "https://github.com/ibissource/iaf/pull/1214#discussion_r514918338", "bodyText": "I don't understand why this is necessary", "author": "gvanbrakel", "createdAt": "2020-10-30T07:42:58Z", "path": "core/src/main/java/nl/nn/adapterframework/jms/JNDIBase.java", "diffHunk": "@@ -60,6 +65,13 @@\n \n \tprivate Context context = null;\n \n+\t@Override\n+\tpublic void configure() throws ConfigurationException {\n+\t\tif(StringUtils.isEmpty(jndiContextPrefix)) {\n+\t\t\tjndiContextPrefix = AppConstants.getInstance(configurationClassLoader).getString(\"jndiContextPrefix\",\"\");", "originalCommit": "012aa368545be8060453d1de96fd8db3c2a6b6a1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNzQ2NjcyNA==", "url": "https://github.com/ibissource/iaf/pull/1214#discussion_r517466724", "bodyText": "When a database is not initialized through Spring you manually have to set the jndiContextPrefix.. Maybe good to add as comment?", "author": "nielsm5", "createdAt": "2020-11-04T16:22:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNDkxODMzOA=="}], "type": "inlineReview", "revised_code": {"commit": "5c40feb7a8aa1d31d23034047471a146aedccd25", "chunk": "diff --git a/core/src/main/java/nl/nn/adapterframework/jms/JNDIBase.java b/core/src/main/java/nl/nn/adapterframework/jms/JNDIBase.java\nindex 74953d99e..f5244d4b9 100644\n--- a/core/src/main/java/nl/nn/adapterframework/jms/JNDIBase.java\n+++ b/core/src/main/java/nl/nn/adapterframework/jms/JNDIBase.java\n\n@@ -67,6 +67,8 @@ public class JNDIBase implements IConfigurable{\n \n \t@Override\n \tpublic void configure() throws ConfigurationException {\n+\t\t// somewhere a sender is being initialized without setting the property\n+\t\t// TODO get rid of the workaround and find out why spring does not set the prefix\n \t\tif(StringUtils.isEmpty(jndiContextPrefix)) {\n \t\t\tjndiContextPrefix = AppConstants.getInstance(configurationClassLoader).getString(\"jndiContextPrefix\",\"\");\n \t\t}\n"}}, {"oid": "5c40feb7a8aa1d31d23034047471a146aedccd25", "url": "https://github.com/ibissource/iaf/commit/5c40feb7a8aa1d31d23034047471a146aedccd25", "message": "comment on the change", "committedDate": "2020-11-05T09:45:34Z", "type": "commit"}]}