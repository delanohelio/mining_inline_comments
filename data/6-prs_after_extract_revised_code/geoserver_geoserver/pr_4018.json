{"pr_number": 4018, "pr_title": "[GEOS-9479] Add Backward compatibility on new Cascaded WMS settings", "pr_createdAt": "2020-01-30T08:02:26Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4018", "timeline": [{"oid": "4f17a7cf0cf7df62a2bcb5bce3ec4a8ba8f1de7a", "url": "https://github.com/geoserver/geoserver/commit/4f17a7cf0cf7df62a2bcb5bce3ec4a8ba8f1de7a", "message": "[GEOS-9479] Add Backward compatibility on new Cascaded WMS settings\n\n-added WMSLayerInfo legacy XML converter to init null fields\n-added unit tests\n   -XMLPersister\n   -WMS UI", "committedDate": "2020-01-31T06:40:21Z", "type": "forcePushed"}, {"oid": "a662f6594fecb2414a151becaf14594ebed981ad", "url": "https://github.com/geoserver/geoserver/commit/a662f6594fecb2414a151becaf14594ebed981ad", "message": "[GEOS-9479] Add Backward compatibility on new Cascaded WMS settings\n\n-added WMSLayerInfo legacy XML converter to init null fields\n-added unit tests\n   -XMLPersister\n   -WMS UI", "committedDate": "2020-01-31T10:03:30Z", "type": "commit"}, {"oid": "a662f6594fecb2414a151becaf14594ebed981ad", "url": "https://github.com/geoserver/geoserver/commit/a662f6594fecb2414a151becaf14594ebed981ad", "message": "[GEOS-9479] Add Backward compatibility on new Cascaded WMS settings\n\n-added WMSLayerInfo legacy XML converter to init null fields\n-added unit tests\n   -XMLPersister\n   -WMS UI", "committedDate": "2020-01-31T10:03:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDExNDAwOQ==", "url": "https://github.com/geoserver/geoserver/pull/4018#discussion_r374114009", "bodyText": "This is the WMSLayerInfo converter, no need to add legacy. Or... next time we add a parameter that needs defaulting, are we going to call it LegacyLegacyConverter?", "author": "aaime", "createdAt": "2020-02-03T13:55:12Z", "path": "src/main/src/main/java/org/geoserver/config/util/XStreamPersister.java", "diffHunk": "@@ -2529,4 +2530,27 @@ public String toString(Object obj) {\n             return obj.toString();\n         }\n     }\n+\n+    /** Converter for WMSLayerInfoImpl class ensure backwards compatibility with old directories */\n+    class WMSLayerInfoLegacyConverter extends AbstractCatalogInfoConverter {", "originalCommit": "a662f6594fecb2414a151becaf14594ebed981ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5Nzc4NA==", "url": "https://github.com/geoserver/geoserver/pull/4018#discussion_r374197784", "bodyText": "will change name to WMSLayerInfo", "author": "imranrajjad", "createdAt": "2020-02-03T16:18:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDExNDAwOQ=="}], "type": "inlineReview", "revised_code": {"commit": "1aa1be4dab33275c405cbe839cff01a3a330dfbd", "chunk": "diff --git a/src/main/src/main/java/org/geoserver/config/util/XStreamPersister.java b/src/main/src/main/java/org/geoserver/config/util/XStreamPersister.java\nindex e72d253224..7772908540 100644\n--- a/src/main/src/main/java/org/geoserver/config/util/XStreamPersister.java\n+++ b/src/main/src/main/java/org/geoserver/config/util/XStreamPersister.java\n\n@@ -2531,10 +2531,13 @@ public class XStreamPersister {\n         }\n     }\n \n-    /** Converter for WMSLayerInfoImpl class ensure backwards compatibility with old directories */\n-    class WMSLayerInfoLegacyConverter extends AbstractCatalogInfoConverter {\n+    /**\n+     * Converter for WMSLayerInfoImpl class ensure backwards compatibility with <= 2.16.2 data\n+     * directories\n+     */\n+    class WMSLayerInfoConverter extends AbstractCatalogInfoConverter {\n \n-        public WMSLayerInfoLegacyConverter() {\n+        public WMSLayerInfoConverter() {\n             super(WMSLayerInfoImpl.class);\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDExNDc2Mw==", "url": "https://github.com/geoserver/geoserver/pull/4018#discussion_r374114763", "bodyText": "2.16.2 is affected?", "author": "aaime", "createdAt": "2020-02-03T13:56:28Z", "path": "src/web/wms/src/test/java/org/geoserver/wms/web/data/publish/WMSLayerConfigTest.java", "diffHunk": "@@ -262,4 +268,144 @@ private boolean cascadedControlsVisible(WicketTester tester) {\n                 && tester.getComponentFromLastRenderedPage(\"form:panel:metaDataCheckBoxContainer\")\n                         != null;\n     }\n+\n+    @Test\n+    public void testWMSCascadeSettingsLegacyBean() throws Exception {\n+        // this test asserts that the wmslayer settings do not break\n+        // when user has switched from 2.16.2 and less version", "originalCommit": "a662f6594fecb2414a151becaf14594ebed981ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDE5ODEyMQ==", "url": "https://github.com/geoserver/geoserver/pull/4018#discussion_r374198121", "bodyText": "yes", "author": "imranrajjad", "createdAt": "2020-02-03T16:19:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDExNDc2Mw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "1aa1be4dab33275c405cbe839cff01a3a330dfbd", "url": "https://github.com/geoserver/geoserver/commit/1aa1be4dab33275c405cbe839cff01a3a330dfbd", "message": "[GEOS-9479] review 1\n\n-address AA request changes", "committedDate": "2020-02-04T05:52:20Z", "type": "commit"}]}