{"pr_number": 4408, "pr_title": "[GEOS-9689] WFS-NG Other URNOGC SRS fmt not passed in remote WMS request.", "pr_createdAt": "2020-07-13T06:34:25Z", "pr_url": "https://github.com/geoserver/geoserver/pull/4408", "timeline": [{"oid": "4d20271e76e06f9c07635a0213a05d7e17430d25", "url": "https://github.com/geoserver/geoserver/commit/4d20271e76e06f9c07635a0213a05d7e17430d25", "message": "[GEOS-9689] WFS-NG Other URNOGC SRS fmt not passed in remote WMS req.\n\n-improved WMS/WFS request SRS comparison with list of other SRS\n-updated WFS and WMS unit tests", "committedDate": "2020-07-13T06:26:32Z", "type": "commit"}, {"oid": "6cc1f8f46c6648831b31ad86e26bcbed92c4b6ad", "url": "https://github.com/geoserver/geoserver/commit/6cc1f8f46c6648831b31ad86e26bcbed92c4b6ad", "message": "[GEOS-9689] unit test fixed", "committedDate": "2020-08-28T12:12:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0MTI1Nw==", "url": "https://github.com/geoserver/geoserver/pull/4408#discussion_r480041257", "bodyText": "Won't this go NPE if otherSrsStr is null? Unless configured it will be missing and thus null no?", "author": "aaime", "createdAt": "2020-08-31T10:41:09Z", "path": "src/wfs/src/main/java/org/geoserver/wfs/GetFeature.java", "diffHunk": "@@ -589,20 +590,29 @@ public FeatureCollectionResponse run(GetFeatureRequest request) throws WFSExcept\n                                         .getConnectionParameters()\n                                         .get(WFSDataStoreFactory.USEDEFAULTSRS.key)\n                                         .toString())) {\n-                            String otherSRS =\n-                                    (String) meta.getMetadata().get(FeatureTypeInfo.OTHER_SRS);\n+\n                             if (query.getSrsName() != null) {\n-                                if (otherSRS.contains(query.getSrsName().toString())) {\n-                                    if (hints == null) hints = new Hints();\n-                                    try {\n-                                        hints.put(\n-                                                ResourcePool.MAP_CRS,\n-                                                CRS.decode(query.getSrsName().toString()));\n-                                    } catch (NoSuchAuthorityCodeException ne) {\n-                                        LOGGER.log(Level.SEVERE, ne.getMessage(), ne);\n-                                    } catch (FactoryException e) {\n-                                        LOGGER.log(Level.SEVERE, e.getMessage(), e);\n+                                String otherSrsStr =\n+                                        (String) meta.getMetadata().get(FeatureTypeInfo.OTHER_SRS);\n+                                // create list of other srs\n+                                List<String> otherSRSList = Arrays.asList(otherSrsStr.split(\",\"));", "originalCommit": "6cc1f8f46c6648831b31ad86e26bcbed92c4b6ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDgyNjU5Ng==", "url": "https://github.com/geoserver/geoserver/pull/4408#discussion_r480826596", "bodyText": "@aaime\nPlease see line 585, this block will not execute if otherSrsStr is NULL in first place.", "author": "imranrajjad", "createdAt": "2020-09-01T05:19:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDA0MTI1Nw=="}], "type": "inlineReview", "revised_code": null}]}