{"pr_number": 2790, "pr_title": "CorfuStore: Stream tails per table api needed for search", "pr_createdAt": "2020-10-14T18:08:08Z", "pr_url": "https://github.com/CorfuDB/CorfuDB/pull/2790", "timeline": [{"oid": "c5776d6686856fc30387f069931f108ac483450f", "url": "https://github.com/CorfuDB/CorfuDB/commit/c5776d6686856fc30387f069931f108ac483450f", "message": "CorfuStore: Stream tails per table api needed for search", "committedDate": "2020-10-14T21:32:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5NzY2NQ==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505097665", "bodyText": "Missing @return in javadoc", "author": "WenbinZhu", "createdAt": "2020-10-15T00:35:40Z", "path": "runtime/src/main/java/org/corfudb/runtime/collections/Table.java", "diffHunk": "@@ -293,6 +293,14 @@ public int count() {\n         return corfuTable.keySet();\n     }\n \n+    /**\n+     * Return the address of the latest updated made in this table.\n+     *", "originalCommit": "c5776d6686856fc30387f069931f108ac483450f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzNzg3OA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505937878", "bodyText": "added, thanks", "author": "hisundar", "createdAt": "2020-10-16T00:32:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5NzY2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "9a8f434355dea3284863919f1f0568c3b40e7426", "chunk": "diff --git a/runtime/src/main/java/org/corfudb/runtime/collections/Table.java b/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\nindex 47c3dfe8bfb..46c2d6558ab 100644\n--- a/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\n+++ b/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\n\n@@ -296,6 +296,7 @@ public class Table<K extends Message, V extends Message, M extends Message> {\n     /**\n      * Return the address of the latest updated made in this table.\n      *\n+     * @return stream tail of this table.\n      */\n     public long getHighestSequence() {\n         return corfuRuntime.getSequencerView().query(this.streamUUID);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5ODU3Mw==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505098573", "bodyText": "typo - update", "author": "pankti-m", "createdAt": "2020-10-15T00:39:08Z", "path": "runtime/src/main/java/org/corfudb/runtime/collections/Table.java", "diffHunk": "@@ -293,6 +293,14 @@ public int count() {\n         return corfuTable.keySet();\n     }\n \n+    /**\n+     * Return the address of the latest updated made in this table.", "originalCommit": "c5776d6686856fc30387f069931f108ac483450f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzNzkwNw==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505937907", "bodyText": "fixed, thanks", "author": "hisundar", "createdAt": "2020-10-16T00:32:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5ODU3Mw=="}], "type": "inlineReview", "revised_code": {"commit": "9a8f434355dea3284863919f1f0568c3b40e7426", "chunk": "diff --git a/runtime/src/main/java/org/corfudb/runtime/collections/Table.java b/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\nindex 47c3dfe8bfb..46c2d6558ab 100644\n--- a/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\n+++ b/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\n\n@@ -296,6 +296,7 @@ public class Table<K extends Message, V extends Message, M extends Message> {\n     /**\n      * Return the address of the latest updated made in this table.\n      *\n+     * @return stream tail of this table.\n      */\n     public long getHighestSequence() {\n         return corfuRuntime.getSequencerView().query(this.streamUUID);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5OTUwNA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505099504", "bodyText": "should we add an api in CorfuStore for this?  Otherwise users will directly access the table", "author": "pankti-m", "createdAt": "2020-10-15T00:42:14Z", "path": "runtime/src/main/java/org/corfudb/runtime/collections/Table.java", "diffHunk": "@@ -293,6 +293,14 @@ public int count() {\n         return corfuTable.keySet();\n     }\n \n+    /**\n+     * Return the address of the latest updated made in this table.\n+     *\n+     */\n+    public long getHighestSequence() {", "originalCommit": "c5776d6686856fc30387f069931f108ac483450f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzODExMQ==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505938111", "bodyText": "We can, but I am strictly following the ask, that's why I put it here. we do expose the table directly anyway in UFO", "author": "hisundar", "createdAt": "2020-10-16T00:33:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTA5OTUwNA=="}], "type": "inlineReview", "revised_code": {"commit": "9a8f434355dea3284863919f1f0568c3b40e7426", "chunk": "diff --git a/runtime/src/main/java/org/corfudb/runtime/collections/Table.java b/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\nindex 47c3dfe8bfb..46c2d6558ab 100644\n--- a/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\n+++ b/runtime/src/main/java/org/corfudb/runtime/collections/Table.java\n\n@@ -296,6 +296,7 @@ public class Table<K extends Message, V extends Message, M extends Message> {\n     /**\n      * Return the address of the latest updated made in this table.\n      *\n+     * @return stream tail of this table.\n      */\n     public long getHighestSequence() {\n         return corfuRuntime.getSequencerView().query(this.streamUUID);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTExMjY5NA==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505112694", "bodyText": "can we rename the test to something more explanatory?  something like testSecondaryIndexes()", "author": "pankti-m", "createdAt": "2020-10-15T01:33:11Z", "path": "test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java", "diffHunk": "@@ -104,6 +109,58 @@ public void checkDirtyReads() throws Exception {\n         log.debug(table.getMetrics().toString());\n     }\n \n+    @Test\n+    public void checkIndexes() throws Exception {", "originalCommit": "c5776d6686856fc30387f069931f108ac483450f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkzODE0Mw==", "url": "https://github.com/CorfuDB/CorfuDB/pull/2790#discussion_r505938143", "bodyText": "done", "author": "hisundar", "createdAt": "2020-10-16T00:33:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTExMjY5NA=="}], "type": "inlineReview", "revised_code": {"commit": "9a8f434355dea3284863919f1f0568c3b40e7426", "chunk": "diff --git a/test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java b/test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java\nindex 2b7aef5ce38..3690cb89a32 100644\n--- a/test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java\n+++ b/test/src/test/java/org/corfudb/runtime/collections/CorfuStoreShimTest.java\n\n@@ -109,8 +109,13 @@ public class CorfuStoreShimTest extends AbstractViewTest {\n         log.debug(table.getMetrics().toString());\n     }\n \n+    /**\n+     * Simple example to see how secondary indexes work. Please see sample_schema.proto.\n+     *\n+     * @throws Exception\n+     */\n     @Test\n-    public void checkIndexes() throws Exception {\n+    public void testSecondaryIndexes() throws Exception {\n \n         // Get a Corfu Runtime instance.\n         CorfuRuntime corfuRuntime = getDefaultRuntime();\n"}}, {"oid": "9a8f434355dea3284863919f1f0568c3b40e7426", "url": "https://github.com/CorfuDB/CorfuDB/commit/9a8f434355dea3284863919f1f0568c3b40e7426", "message": "CorfuStore: Stream tails per table api needed for search\n\nMinor fix to getRecord() to handle null values.", "committedDate": "2020-10-17T00:07:52Z", "type": "forcePushed"}, {"oid": "8e7ae9bf4753de73bc8b7bc69e1ad0675169e1ca", "url": "https://github.com/CorfuDB/CorfuDB/commit/8e7ae9bf4753de73bc8b7bc69e1ad0675169e1ca", "message": "CorfuStore: Stream tails per table api needed for search\n\nMinor fix to getRecord() to handle null values.\nUse getOrCreate on SharedMetricRegistry for compatability with 3.1.0", "committedDate": "2020-10-17T00:21:09Z", "type": "commit"}, {"oid": "8e7ae9bf4753de73bc8b7bc69e1ad0675169e1ca", "url": "https://github.com/CorfuDB/CorfuDB/commit/8e7ae9bf4753de73bc8b7bc69e1ad0675169e1ca", "message": "CorfuStore: Stream tails per table api needed for search\n\nMinor fix to getRecord() to handle null values.\nUse getOrCreate on SharedMetricRegistry for compatability with 3.1.0", "committedDate": "2020-10-17T00:21:09Z", "type": "forcePushed"}, {"oid": "98ca3ff545a00650b76b3ba7cd753347c5c57780", "url": "https://github.com/CorfuDB/CorfuDB/commit/98ca3ff545a00650b76b3ba7cd753347c5c57780", "message": "Merge branch 'master' into ufo-table-tails", "committedDate": "2020-10-21T17:33:34Z", "type": "commit"}]}