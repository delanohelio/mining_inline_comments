{"pr_number": 120, "pr_title": "Added thread interceptor", "pr_createdAt": "2020-06-22T03:11:14Z", "pr_url": "https://github.com/temporalio/sdk-java/pull/120", "timeline": [{"oid": "12b4ed93055ab6a7631c78d7a5d76626a9c0dd84", "url": "https://github.com/temporalio/sdk-java/commit/12b4ed93055ab6a7631c78d7a5d76626a9c0dd84", "message": "Update dependencies to the latest version", "committedDate": "2020-06-21T18:57:22Z", "type": "commit"}, {"oid": "e136f1797c906904ab582f2ca45903c4590ae26b", "url": "https://github.com/temporalio/sdk-java/commit/e136f1797c906904ab582f2ca45903c4590ae26b", "message": "Merge branch 'master' of github.com:temporalio/temporal-java-sdk into dependencies", "committedDate": "2020-06-21T18:59:58Z", "type": "commit"}, {"oid": "822ef50409f044a24f8afe4f0310ea9431e83b10", "url": "https://github.com/temporalio/sdk-java/commit/822ef50409f044a24f8afe4f0310ea9431e83b10", "message": "Implemented newThread interceptor. Root thread is missing", "committedDate": "2020-06-21T22:15:36Z", "type": "commit"}, {"oid": "f8854dc9c248c38a11c514b4d1bb4ed2918be98c", "url": "https://github.com/temporalio/sdk-java/commit/f8854dc9c248c38a11c514b4d1bb4ed2918be98c", "message": "Wired interceptor", "committedDate": "2020-06-21T22:29:40Z", "type": "commit"}, {"oid": "71cf5ecb5df8b3d158f36cad2b5605c363642a9c", "url": "https://github.com/temporalio/sdk-java/commit/71cf5ecb5df8b3d158f36cad2b5605c363642a9c", "message": "Wired root thread", "committedDate": "2020-06-22T03:09:27Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMwODI3Nw==", "url": "https://github.com/temporalio/sdk-java/pull/120#discussion_r443308277", "bodyText": "I'm trying to understand why this additional API is needed?  Why can't there be a no-op interceptor which does nothing.  It would be good to provide some context as part of API documentation.", "author": "samarabbas", "createdAt": "2020-06-22T04:09:48Z", "path": "src/main/java/io/temporal/internal/sync/DeterministicRunner.java", "diffHunk": "@@ -121,4 +122,14 @@ static DeterministicRunner newRunner(\n    * called before runUntilAllBlocked.\n    */\n   void executeInWorkflowThread(String name, Runnable r);\n+\n+  /**\n+   * Creates a new instance of a workflow thread. To be called only from another workflow thread.\n+   */\n+  WorkflowThread newThread(Runnable runnable, boolean detached, String name);\n+\n+  /** Only to be called by SyncDecisionContext. */\n+  WorkflowThread newThreadNoInterceptor(Runnable runnable, boolean detached, String name);", "originalCommit": "71cf5ecb5df8b3d158f36cad2b5605c363642a9c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzcyNzY4NA==", "url": "https://github.com/temporalio/sdk-java/pull/120#discussion_r443727684", "bodyText": "Refactored to remove the need for newThreadNoInterceptor.", "author": "mfateev", "createdAt": "2020-06-22T17:49:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzMwODI3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "7eb2a1e7705e426c5ec5773a6c5e6792cc711e06", "chunk": "diff --git a/src/main/java/io/temporal/internal/sync/DeterministicRunner.java b/src/main/java/io/temporal/internal/sync/DeterministicRunner.java\nindex 899335a0..a5679e83 100644\n--- a/src/main/java/io/temporal/internal/sync/DeterministicRunner.java\n+++ b/src/main/java/io/temporal/internal/sync/DeterministicRunner.java\n\n@@ -122,14 +121,4 @@ interface DeterministicRunner {\n    * called before runUntilAllBlocked.\n    */\n   void executeInWorkflowThread(String name, Runnable r);\n-\n-  /**\n-   * Creates a new instance of a workflow thread. To be called only from another workflow thread.\n-   */\n-  WorkflowThread newThread(Runnable runnable, boolean detached, String name);\n-\n-  /** Only to be called by SyncDecisionContext. */\n-  WorkflowThread newThreadNoInterceptor(Runnable runnable, boolean detached, String name);\n-\n-  void setInterceptorHead(WorkflowCallsInterceptor interceptorHead);\n }\n"}}, {"oid": "7eb2a1e7705e426c5ec5773a6c5e6792cc711e06", "url": "https://github.com/temporalio/sdk-java/commit/7eb2a1e7705e426c5ec5773a6c5e6792cc711e06", "message": "Merge branch 'master' of github.com:temporalio/temporal-java-sdk into dependencies", "committedDate": "2020-06-22T04:54:41Z", "type": "commit"}, {"oid": "808de3981ba3f5ffcf16587695cd88a909cd073a", "url": "https://github.com/temporalio/sdk-java/commit/808de3981ba3f5ffcf16587695cd88a909cd073a", "message": "Removed DeterministicRunner.newThreadNoInterceptor", "committedDate": "2020-06-22T17:43:14Z", "type": "commit"}, {"oid": "079149533b9bd4fbd01e94d562dd8a19287f67c3", "url": "https://github.com/temporalio/sdk-java/commit/079149533b9bd4fbd01e94d562dd8a19287f67c3", "message": "fixed runner wiring", "committedDate": "2020-06-22T19:52:10Z", "type": "commit"}, {"oid": "708d113b93052f7af062ac3b547da8a9963b0b3b", "url": "https://github.com/temporalio/sdk-java/commit/708d113b93052f7af062ac3b547da8a9963b0b3b", "message": "Merge branch 'master' of github.com:temporalio/temporal-java-sdk into dependencies", "committedDate": "2020-06-23T03:22:30Z", "type": "commit"}, {"oid": "6a7a7cdbdc1660f58520ec6cd94bf8ad14d05803", "url": "https://github.com/temporalio/sdk-java/commit/6a7a7cdbdc1660f58520ec6cd94bf8ad14d05803", "message": "Updated to the latest dependency versions.", "committedDate": "2020-06-23T03:59:29Z", "type": "commit"}, {"oid": "a7d29ce135047f9d2a994ddb7cb3d86721000706", "url": "https://github.com/temporalio/sdk-java/commit/a7d29ce135047f9d2a994ddb7cb3d86721000706", "message": "Merge branch 'master' of github.com:temporalio/temporal-java-sdk into interceptor", "committedDate": "2020-06-23T15:30:23Z", "type": "commit"}, {"oid": "0a0ec71e6fbaf7b7c342c0954daad1d35a1843a2", "url": "https://github.com/temporalio/sdk-java/commit/0a0ec71e6fbaf7b7c342c0954daad1d35a1843a2", "message": "Fixed interceptors", "committedDate": "2020-06-23T18:47:12Z", "type": "commit"}, {"oid": "1a79da63753050379c7c139fb495a222e06f46a6", "url": "https://github.com/temporalio/sdk-java/commit/1a79da63753050379c7c139fb495a222e06f46a6", "message": "unit test of interceptor list", "committedDate": "2020-06-23T18:50:45Z", "type": "commit"}, {"oid": "a747816f8c009d00882121142fbc342794230eef", "url": "https://github.com/temporalio/sdk-java/commit/a747816f8c009d00882121142fbc342794230eef", "message": "BaseInterceptor renamed to InterceptorBase", "committedDate": "2020-06-23T19:00:23Z", "type": "commit"}, {"oid": "05f26021c629136f0df0f096f973a0208290aa1f", "url": "https://github.com/temporalio/sdk-java/commit/05f26021c629136f0df0f096f973a0208290aa1f", "message": "Moved client interceptor to the interceptor package", "committedDate": "2020-06-23T19:01:39Z", "type": "commit"}, {"oid": "5d5149ec19c814b52f8f88266369a7db4c285ed3", "url": "https://github.com/temporalio/sdk-java/commit/5d5149ec19c814b52f8f88266369a7db4c285ed3", "message": "Merge branch 'dependencies' into interceptor", "committedDate": "2020-06-24T02:28:54Z", "type": "commit"}, {"oid": "707554057680500f915259b935bbc80771cf1cd7", "url": "https://github.com/temporalio/sdk-java/commit/707554057680500f915259b935bbc80771cf1cd7", "message": "updated dependencies", "committedDate": "2020-06-24T02:32:52Z", "type": "commit"}]}