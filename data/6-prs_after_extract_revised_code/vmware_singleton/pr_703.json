{"pr_number": 703, "pr_title": "Add create timezone name list feature API", "pr_createdAt": "2020-08-04T06:16:35Z", "pr_url": "https://github.com/vmware/singleton/pull/703", "timeline": [{"oid": "fe80fc0c3102b6ddbf30d87a560676a173c365f4", "url": "https://github.com/vmware/singleton/commit/fe80fc0c3102b6ddbf30d87a560676a173c365f4", "message": "add the jars", "committedDate": "2020-06-24T09:33:33Z", "type": "commit"}, {"oid": "14815bc25d0075a09323997d48362a6e316fbaf5", "url": "https://github.com/vmware/singleton/commit/14815bc25d0075a09323997d48362a6e316fbaf5", "message": "add the CSP token feature", "committedDate": "2020-07-08T06:54:30Z", "type": "commit"}, {"oid": "f5c95e230d4b4e7fe42be3452180091c57dc459a", "url": "https://github.com/vmware/singleton/commit/f5c95e230d4b4e7fe42be3452180091c57dc459a", "message": "add the CSP token feature", "committedDate": "2020-07-08T07:07:33Z", "type": "commit"}, {"oid": "ddd799c2bf4c4af3d2941a713290ed2d765673d2", "url": "https://github.com/vmware/singleton/commit/ddd799c2bf4c4af3d2941a713290ed2d765673d2", "message": "Merge branch 'master' into master", "committedDate": "2020-07-09T07:15:14Z", "type": "commit"}, {"oid": "61eb2fee1eac45123b5b43e9889130b536889535", "url": "https://github.com/vmware/singleton/commit/61eb2fee1eac45123b5b43e9889130b536889535", "message": "add the whitelist feature of l10n", "committedDate": "2020-07-15T03:42:02Z", "type": "commit"}, {"oid": "b2554db64192063be06769d728ee24b5141a6e58", "url": "https://github.com/vmware/singleton/commit/b2554db64192063be06769d728ee24b5141a6e58", "message": "Merge branch 'master' into master", "committedDate": "2020-07-15T06:26:07Z", "type": "commit"}, {"oid": "221df03e5e80ebf417df07644bf90ede08757e31", "url": "https://github.com/vmware/singleton/commit/221df03e5e80ebf417df07644bf90ede08757e31", "message": "add the bundle.json location", "committedDate": "2020-07-16T02:37:08Z", "type": "commit"}, {"oid": "2accaf27509d83e022c57603da245412cab97176", "url": "https://github.com/vmware/singleton/commit/2accaf27509d83e022c57603da245412cab97176", "message": "add the unit test", "committedDate": "2020-07-16T03:15:23Z", "type": "commit"}, {"oid": "a3504f7f0f11fc7809d6e53b3c649dcbf2fcd8a8", "url": "https://github.com/vmware/singleton/commit/a3504f7f0f11fc7809d6e53b3c649dcbf2fcd8a8", "message": "upgrade the tomcat jars", "committedDate": "2020-07-21T03:59:30Z", "type": "commit"}, {"oid": "2fe1ced2011b70bcd09485297e4b3b1d567ad002", "url": "https://github.com/vmware/singleton/commit/2fe1ced2011b70bcd09485297e4b3b1d567ad002", "message": "upgrade the tomcat jars", "committedDate": "2020-07-21T06:36:54Z", "type": "commit"}, {"oid": "e3103e7dfd5341e96d4dc2ea878b3922c8de0e84", "url": "https://github.com/vmware/singleton/commit/e3103e7dfd5341e96d4dc2ea878b3922c8de0e84", "message": "Merge branch 'master' into master", "committedDate": "2020-07-21T06:42:25Z", "type": "commit"}, {"oid": "a6f4084bf3ed6c126dba73b8fb6776a7465839b3", "url": "https://github.com/vmware/singleton/commit/a6f4084bf3ed6c126dba73b8fb6776a7465839b3", "message": "fixed the l10n bugs", "committedDate": "2020-07-22T01:24:43Z", "type": "commit"}, {"oid": "62bfefc7ac16208eff6de713c5003c2081a4795b", "url": "https://github.com/vmware/singleton/commit/62bfefc7ac16208eff6de713c5003c2081a4795b", "message": "fixed the unit test error", "committedDate": "2020-07-22T06:10:23Z", "type": "commit"}, {"oid": "01bf500b40bdca488c158fdba84db9df1e49a183", "url": "https://github.com/vmware/singleton/commit/01bf500b40bdca488c158fdba84db9df1e49a183", "message": "Merge branch 'master' into master", "committedDate": "2020-07-22T06:15:25Z", "type": "commit"}, {"oid": "354d24f6f6fd09a8296adde5ead2711316f2fcb1", "url": "https://github.com/vmware/singleton/commit/354d24f6f6fd09a8296adde5ead2711316f2fcb1", "message": "add the key base translation", "committedDate": "2020-07-23T06:37:33Z", "type": "commit"}, {"oid": "337de429b88d94ade144e78cf0b41a2cbd165209", "url": "https://github.com/vmware/singleton/commit/337de429b88d94ade144e78cf0b41a2cbd165209", "message": "add get the timezone name list cldr data", "committedDate": "2020-07-28T07:01:34Z", "type": "commit"}, {"oid": "8fea97c676519ae0924e491f8c8a5be55d88b678", "url": "https://github.com/vmware/singleton/commit/8fea97c676519ae0924e491f8c8a5be55d88b678", "message": "Merge branch 'master' into master", "committedDate": "2020-07-28T07:27:07Z", "type": "commit"}, {"oid": "d43d44e080de1facf8a3afc0a5ace32435671cc2", "url": "https://github.com/vmware/singleton/commit/d43d44e080de1facf8a3afc0a5ace32435671cc2", "message": "fixed the comments", "committedDate": "2020-07-30T08:47:15Z", "type": "commit"}, {"oid": "d0f5d3b464c1798dc616bd9af8dbd0d802bb82fe", "url": "https://github.com/vmware/singleton/commit/d0f5d3b464c1798dc616bd9af8dbd0d802bb82fe", "message": "fixed the comments", "committedDate": "2020-07-30T09:26:54Z", "type": "commit"}, {"oid": "4b2e08a88f7ffb6f62285c3f241f7d85cca63c6b", "url": "https://github.com/vmware/singleton/commit/4b2e08a88f7ffb6f62285c3f241f7d85cca63c6b", "message": "format the code", "committedDate": "2020-08-03T08:04:17Z", "type": "commit"}, {"oid": "c54423e4476ebdfb43543f6a35cde912b234a162", "url": "https://github.com/vmware/singleton/commit/c54423e4476ebdfb43543f6a35cde912b234a162", "message": "the API of the timezone name list", "committedDate": "2020-08-04T06:28:29Z", "type": "commit"}, {"oid": "014eee5137e6ebced8d5f3d8ec3780d0229fac69", "url": "https://github.com/vmware/singleton/commit/014eee5137e6ebced8d5f3d8ec3780d0229fac69", "message": "fix conflict issue", "committedDate": "2020-08-04T06:59:56Z", "type": "commit"}, {"oid": "24cabc870e12f48154837a045b59514ddccaa05d", "url": "https://github.com/vmware/singleton/commit/24cabc870e12f48154837a045b59514ddccaa05d", "message": "Merge branch 'master' into master", "committedDate": "2020-08-04T07:28:50Z", "type": "commit"}, {"oid": "2ee7692b17e49b9cd1ae6be63ff4bd61ad40e864", "url": "https://github.com/vmware/singleton/commit/2ee7692b17e49b9cd1ae6be63ff4bd61ad40e864", "message": "fix conflict issue", "committedDate": "2020-08-04T08:13:05Z", "type": "commit"}, {"oid": "f0d17f1473b7b761c88c68bff5e9f7d81ace080a", "url": "https://github.com/vmware/singleton/commit/f0d17f1473b7b761c88c68bff5e9f7d81ace080a", "message": "fixed the conflict", "committedDate": "2020-08-04T10:12:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ3MDExNA==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r465470114", "bodyText": "a boolean value to get the default territory timezone name or not, default is true.", "author": "linr211", "createdAt": "2020-08-05T04:48:07Z", "path": "g11n-ws/modules/md-restful-api/src/main/java/com/vmware/vip/api/rest/APIParamValue.java", "diffHunk": "@@ -30,6 +30,8 @@\n \tpublic final static String REGION         = \"a string which represents region, e.g. US, PT, CN\";\n \tpublic final static String COMBINE        = \"an integer which represents combine type number 1 or 2\";\n \tpublic final static String SCOPE_FILTER   = \"a String for filtering the pattern data, separated by comma and underline. e.g. 'dates_eras,dates_dayPeriodsFormat'\";\n+\tpublic final static String DEFAULT_TERRITORY = \"a boolean which represents get the default territory timezone name or not. (default is true)\";", "originalCommit": "f0d17f1473b7b761c88c68bff5e9f7d81ace080a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE0MTIyNg==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r466141226", "bodyText": "done", "author": "tigershi", "createdAt": "2020-08-06T04:38:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ3MDExNA=="}], "type": "inlineReview", "revised_code": {"commit": "13a7af8bb2420b05cff81cd742d1420709423295", "chunk": "diff --git a/g11n-ws/modules/md-restful-api/src/main/java/com/vmware/vip/api/rest/APIParamValue.java b/g11n-ws/modules/md-restful-api/src/main/java/com/vmware/vip/api/rest/APIParamValue.java\nindex 4d915877..f6e303cf 100644\n--- a/g11n-ws/modules/md-restful-api/src/main/java/com/vmware/vip/api/rest/APIParamValue.java\n+++ b/g11n-ws/modules/md-restful-api/src/main/java/com/vmware/vip/api/rest/APIParamValue.java\n\n@@ -30,7 +30,7 @@ public class APIParamValue {\n \tpublic final static String REGION         = \"a string which represents region, e.g. US, PT, CN\";\n \tpublic final static String COMBINE        = \"an integer which represents combine type number 1 or 2\";\n \tpublic final static String SCOPE_FILTER   = \"a String for filtering the pattern data, separated by comma and underline. e.g. 'dates_eras,dates_dayPeriodsFormat'\";\n-\tpublic final static String DEFAULT_TERRITORY = \"a boolean which represents get the default territory timezone name or not. (default is true)\";\n+\tpublic final static String DEFAULT_TERRITORY = \"a boolean value to get the default territory timezone name or not, default is true\";\n \tpublic final static String DISPLAY_CITY   = \"a flag for displaying all the cities, e.g. true, false\";\n \tpublic final static String REGIONS    \t  = \"a string which represents regions, separated by commas. e.g. US, PT, CN\";\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ3MDk2Ng==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r465470966", "bodyText": "I don't see where to use the oldLocale, is it a invalid parameter?", "author": "linr211", "createdAt": "2020-08-05T04:51:06Z", "path": "g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/service/date/DateFormatService.java", "diffHunk": "@@ -39,4 +64,54 @@ public String formatDate(String locale, long date, String pattern) throws L2APIE\n \t\t}\n \t}\n \n+\t\n+\t/**\n+   \t * @param locale\n+   \t * @param default territory\n+   \t * @return matching locale TimeZoneName\n+   \t */\n+\t@Override\n+\tpublic TimeZoneName getTimeZoneName(String oldLocale, boolean defaultTerritory) throws L2APIException {\n+\t\t// TODO Auto-generated method stub\n+\t\tString locale = oldLocale.replace(\"_\", \"-\");", "originalCommit": "f0d17f1473b7b761c88c68bff5e9f7d81ace080a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE0MTE4NA==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r466141184", "bodyText": "done", "author": "tigershi", "createdAt": "2020-08-06T04:38:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTQ3MDk2Ng=="}], "type": "inlineReview", "revised_code": {"commit": "13a7af8bb2420b05cff81cd742d1420709423295", "chunk": "diff --git a/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/service/date/DateFormatService.java b/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/service/date/DateFormatService.java\nindex 070a451b..819b989d 100644\n--- a/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/service/date/DateFormatService.java\n+++ b/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/service/date/DateFormatService.java\n\n@@ -67,36 +64,35 @@ public class DateFormatService implements IDateFormatService{\n \t\n \t/**\n    \t * @param locale\n-   \t * @param default territory\n+   \t * @param boolean value is default territory or not\n    \t * @return matching locale TimeZoneName\n    \t */\n \t@Override\n-\tpublic TimeZoneName getTimeZoneName(String oldLocale, boolean defaultTerritory) throws L2APIException {\n+\tpublic TimeZoneName getTimeZoneName(String locale, boolean defaultTerritory) throws L2APIException {\n \t\t// TODO Auto-generated method stub\n-\t\tString locale = oldLocale.replace(\"_\", \"-\");\n-\t\tString newLocale = CommonUtil.getCLDRLocale(locale, localePathMap, localeAliasesMap);\n+\t\tString newLocale = locale.replace(\"_\", \"-\");\n+\t\tnewLocale = CommonUtil.getCLDRLocale(newLocale, localePathMap, localeAliasesMap);\n \t\tif (CommonUtil.isEmpty(newLocale)){\n \t\t\tlogger.info(\"Invalid locale!\");\n-\t\t\tthrow new L2APIException(String.format(ValidationMsg.LOCALENAME_NOT_SUPPORTED, oldLocale));\n+\t\t\tthrow new L2APIException(String.format(ValidationMsg.LOCALENAME_NOT_SUPPORTED, locale));\n \t\t}\n-\t\tlocale = newLocale;\n \t\tString timezoneNameJson = null;\n \t\ttry {\n-\t\t\ttimezoneNameJson = TranslationCache3.getCachedObject(CacheName.PATTERN, getTimeZoneNameKey(locale, defaultTerritory), String.class);\n+\t\t\ttimezoneNameJson = TranslationCache3.getCachedObject(CacheName.PATTERN, getTimeZoneNameKey(newLocale, defaultTerritory), String.class);\n \t\t} catch (VIPCacheException e) {\n \t\t\ttimezoneNameJson = null;\n \t\t}\n \t\tTimeZoneName timeZoneName = null;\n \t\tif (StringUtils.isEmpty(timezoneNameJson)) {\n \t\t\tlogger.info(\"get timezoneNameJson data from file\");\n-\t\t\ttimeZoneName = patternDao.getTimeZoneName(locale, defaultTerritory);\n+\t\t\ttimeZoneName = patternDao.getTimeZoneName(newLocale, defaultTerritory);\n \t\t\tif (StringUtils.isEmpty(timeZoneName)) {\n \t\t\t\tlogger.info(\"file data don't exist\");\n \t\t\t\treturn null;\n \t\t\t}\n \t\t\ttry {\n \t\t\t\ttimezoneNameJson = new ObjectMapper().writeValueAsString(timeZoneName);\n-\t\t\t\tTranslationCache3.addCachedObject(CacheName.PATTERN, getTimeZoneNameKey(locale, defaultTerritory),\n+\t\t\t\tTranslationCache3.addCachedObject(CacheName.PATTERN, getTimeZoneNameKey(newLocale, defaultTerritory),\n \t\t\t\t\t\tString.class, timezoneNameJson);\n \t\t\t} catch (Exception e) {\n \t\t\t\tthrow new L2APIException(e.getMessage());\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTUxNjQzOQ==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r465516439", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * @param default territory\n          \n          \n            \n            \t * @param boolean value representing default territory", "author": "Xiaochao8", "createdAt": "2020-08-05T07:04:09Z", "path": "g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java", "diffHunk": "@@ -15,6 +17,17 @@ public String getPattern(String locale, String categories) {\n \t\tlocale = locale.replace(\"_\", \"-\");\n \t\treturn PatternUtil.getPatternFromLib(locale, categories);\n \t}\n+\t\n+\t\n+\t/**\n+\t * @param locale\n+\t * @param default territory", "originalCommit": "f0d17f1473b7b761c88c68bff5e9f7d81ace080a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE0MTI5Mw==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r466141293", "bodyText": "done", "author": "tigershi", "createdAt": "2020-08-06T04:39:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTUxNjQzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "13a7af8bb2420b05cff81cd742d1420709423295", "chunk": "diff --git a/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java b/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java\nindex f8bb9bbc..0e80ff78 100644\n--- a/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java\n+++ b/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java\n\n@@ -21,8 +21,8 @@ public class PatternDaoImpl implements IPatternDao {\n \t\n \t/**\n \t * @param locale\n-\t * @param default territory\n-\t * @return matching locale TimeZoneName\n+\t * @param boolean value representing default territory\n+\t * @return timezone name of the locale\n \t */\n \tpublic TimeZoneName getTimeZoneName(String locale, boolean defaultTerritory) {\n \t\tlocale = locale.replace(\"_\", \"-\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTUxNjcyMQ==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r465516721", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t * @return matching locale TimeZoneName\n          \n          \n            \n            \t * @return timezone name of the locale", "author": "Xiaochao8", "createdAt": "2020-08-05T07:04:48Z", "path": "g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java", "diffHunk": "@@ -15,6 +17,17 @@ public String getPattern(String locale, String categories) {\n \t\tlocale = locale.replace(\"_\", \"-\");\n \t\treturn PatternUtil.getPatternFromLib(locale, categories);\n \t}\n+\t\n+\t\n+\t/**\n+\t * @param locale\n+\t * @param default territory\n+\t * @return matching locale TimeZoneName", "originalCommit": "f0d17f1473b7b761c88c68bff5e9f7d81ace080a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjE0MTMzMQ==", "url": "https://github.com/vmware/singleton/pull/703#discussion_r466141331", "bodyText": "done", "author": "tigershi", "createdAt": "2020-08-06T04:39:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTUxNjcyMQ=="}], "type": "inlineReview", "revised_code": {"commit": "13a7af8bb2420b05cff81cd742d1420709423295", "chunk": "diff --git a/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java b/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java\nindex f8bb9bbc..0e80ff78 100644\n--- a/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java\n+++ b/g11n-ws/modules/md-service-i18n-l2/src/main/java/com/vmware/i18n/l2/dao/pattern/PatternDaoImpl.java\n\n@@ -21,8 +21,8 @@ public class PatternDaoImpl implements IPatternDao {\n \t\n \t/**\n \t * @param locale\n-\t * @param default territory\n-\t * @return matching locale TimeZoneName\n+\t * @param boolean value representing default territory\n+\t * @return timezone name of the locale\n \t */\n \tpublic TimeZoneName getTimeZoneName(String locale, boolean defaultTerritory) {\n \t\tlocale = locale.replace(\"_\", \"-\");\n"}}, {"oid": "13a7af8bb2420b05cff81cd742d1420709423295", "url": "https://github.com/vmware/singleton/commit/13a7af8bb2420b05cff81cd742d1420709423295", "message": "fixed the comments", "committedDate": "2020-08-06T04:37:29Z", "type": "commit"}]}