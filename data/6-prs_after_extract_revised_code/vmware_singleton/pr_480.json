{"pr_number": 480, "pr_title": "add new validate for singleton service", "pr_createdAt": "2020-03-26T07:20:39Z", "pr_url": "https://github.com/vmware/singleton/pull/480", "timeline": [{"oid": "4596ca7e006d27e23c267d7e03b9db1c08ec018f", "url": "https://github.com/vmware/singleton/commit/4596ca7e006d27e23c267d7e03b9db1c08ec018f", "message": "add and format the version fallback APIs", "committedDate": "2020-02-26T02:37:41Z", "type": "commit"}, {"oid": "061c835dea17a65f9951a5bf77606b206d1c9b41", "url": "https://github.com/vmware/singleton/commit/061c835dea17a65f9951a5bf77606b206d1c9b41", "message": "update the bug of version fallback", "committedDate": "2020-02-26T07:07:39Z", "type": "commit"}, {"oid": "6443a0b37304cca42b0309c997461fd7850f1066", "url": "https://github.com/vmware/singleton/commit/6443a0b37304cca42b0309c997461fd7850f1066", "message": "Merge branch 'master' into master", "committedDate": "2020-03-04T07:02:29Z", "type": "commit"}, {"oid": "b427f7077007a8f5b388da54a75c2c8ca5048439", "url": "https://github.com/vmware/singleton/commit/b427f7077007a8f5b388da54a75c2c8ca5048439", "message": "Merge branch 'master' into master", "committedDate": "2020-03-04T10:17:15Z", "type": "commit"}, {"oid": "fa519d432220423f9ea23d2ed5f8b9c030c45e8c", "url": "https://github.com/vmware/singleton/commit/fa519d432220423f9ea23d2ed5f8b9c030c45e8c", "message": "add support languager version fallback", "committedDate": "2020-03-04T10:39:46Z", "type": "commit"}, {"oid": "aabccda0c997a31b570c686fc22584c698d2e93c", "url": "https://github.com/vmware/singleton/commit/aabccda0c997a31b570c686fc22584c698d2e93c", "message": "add the unit test for version fallback", "committedDate": "2020-03-05T07:21:13Z", "type": "commit"}, {"oid": "71843b50f42576845956b8370e367ce320a7efde", "url": "https://github.com/vmware/singleton/commit/71843b50f42576845956b8370e367ce320a7efde", "message": "Merge branch 'master' into master", "committedDate": "2020-03-05T09:00:23Z", "type": "commit"}, {"oid": "fe96fd7227b2e529c6965e39bd543433c47dee3d", "url": "https://github.com/vmware/singleton/commit/fe96fd7227b2e529c6965e39bd543433c47dee3d", "message": "fixed the comment", "committedDate": "2020-03-09T08:51:27Z", "type": "commit"}, {"oid": "ffea6c114cf4c561fec9e60093fd5c31614a9f34", "url": "https://github.com/vmware/singleton/commit/ffea6c114cf4c561fec9e60093fd5c31614a9f34", "message": "fixed the comment", "committedDate": "2020-03-09T09:03:38Z", "type": "commit"}, {"oid": "afaeb215805b29774a4da9f01b4e79f778ea65d9", "url": "https://github.com/vmware/singleton/commit/afaeb215805b29774a4da9f01b4e79f778ea65d9", "message": "fixed the comment of the colin", "committedDate": "2020-03-10T01:24:35Z", "type": "commit"}, {"oid": "c179a31b5029d60f5144ae5fd3b713403be072bf", "url": "https://github.com/vmware/singleton/commit/c179a31b5029d60f5144ae5fd3b713403be072bf", "message": "Miss copyright and license headers", "committedDate": "2020-03-10T10:46:10Z", "type": "commit"}, {"oid": "d0d390f925fa0bc9d60809408d82c0d494b637ca", "url": "https://github.com/vmware/singleton/commit/d0d390f925fa0bc9d60809408d82c0d494b637ca", "message": "Merge branch 'master' into master", "committedDate": "2020-03-10T11:12:45Z", "type": "commit"}, {"oid": "1d682f53993f10d3f7e3a6f0f0816e0d160fc43a", "url": "https://github.com/vmware/singleton/commit/1d682f53993f10d3f7e3a6f0f0816e0d160fc43a", "message": "Merge branch 'master' into master", "committedDate": "2020-03-11T01:59:50Z", "type": "commit"}, {"oid": "b612e7b05721d299951e3d6fc739d511a4db4c3f", "url": "https://github.com/vmware/singleton/commit/b612e7b05721d299951e3d6fc739d511a4db4c3f", "message": "add the validate for get translation and pattern", "committedDate": "2020-03-16T03:59:30Z", "type": "commit"}, {"oid": "6dce6df105fedb70301f2fb8c65e37d8ed301a75", "url": "https://github.com/vmware/singleton/commit/6dce6df105fedb70301f2fb8c65e37d8ed301a75", "message": "Merge branch 'master' into master", "committedDate": "2020-03-16T05:03:16Z", "type": "commit"}, {"oid": "82184100744be4207fa48621c32baf4d5bf478bc", "url": "https://github.com/vmware/singleton/commit/82184100744be4207fa48621c32baf4d5bf478bc", "message": "Merge branch 'master' into master", "committedDate": "2020-03-18T06:46:22Z", "type": "commit"}, {"oid": "5e5feec50643be5fd9fcce9bd823d5e1bf2a0749", "url": "https://github.com/vmware/singleton/commit/5e5feec50643be5fd9fcce9bd823d5e1bf2a0749", "message": "fixed the comment of the validate parameters", "committedDate": "2020-03-19T02:07:20Z", "type": "commit"}, {"oid": "c881bb76eee0f154f4dff52b1f601fb77c265ddc", "url": "https://github.com/vmware/singleton/commit/c881bb76eee0f154f4dff52b1f601fb77c265ddc", "message": "fixed the comment of the validate parameters", "committedDate": "2020-03-19T03:54:39Z", "type": "commit"}, {"oid": "e7524b79d2df6352544c26677ba0ddd645a53691", "url": "https://github.com/vmware/singleton/commit/e7524b79d2df6352544c26677ba0ddd645a53691", "message": "add the cache controll feature", "committedDate": "2020-03-20T01:25:34Z", "type": "commit"}, {"oid": "a83dd0d03ac641d26477382cad2a369fc50f6323", "url": "https://github.com/vmware/singleton/commit/a83dd0d03ac641d26477382cad2a369fc50f6323", "message": "add the comment for method", "committedDate": "2020-03-20T01:38:48Z", "type": "commit"}, {"oid": "33fae1f0f555b14195903f7d53a18ddb4bc628b6", "url": "https://github.com/vmware/singleton/commit/33fae1f0f555b14195903f7d53a18ddb4bc628b6", "message": "add the copyright header for new file", "committedDate": "2020-03-20T01:47:44Z", "type": "commit"}, {"oid": "d21abbbf81055556513233b3d72614744f0701fa", "url": "https://github.com/vmware/singleton/commit/d21abbbf81055556513233b3d72614744f0701fa", "message": "Merge branch 'master' into master", "committedDate": "2020-03-20T01:48:42Z", "type": "commit"}, {"oid": "68b2ce794a2e2cd9998ae8b2c116f84df82ca50b", "url": "https://github.com/vmware/singleton/commit/68b2ce794a2e2cd9998ae8b2c116f84df82ca50b", "message": "formate the code", "committedDate": "2020-03-20T07:56:33Z", "type": "commit"}, {"oid": "43eaf51f680db8db7aa551cb6b04e6648c92932c", "url": "https://github.com/vmware/singleton/commit/43eaf51f680db8db7aa551cb6b04e6648c92932c", "message": "formate the code", "committedDate": "2020-03-20T08:06:20Z", "type": "commit"}, {"oid": "22343aaa0d7dc31d0e9748b6e88f8f7bc070d472", "url": "https://github.com/vmware/singleton/commit/22343aaa0d7dc31d0e9748b6e88f8f7bc070d472", "message": "Merge branch 'master' into master", "committedDate": "2020-03-20T08:09:48Z", "type": "commit"}, {"oid": "e00c97e4d60ab6136e5786013f8c361d5bc54110", "url": "https://github.com/vmware/singleton/commit/e00c97e4d60ab6136e5786013f8c361d5bc54110", "message": "add the new validate feature", "committedDate": "2020-03-26T04:42:12Z", "type": "commit"}, {"oid": "4f6a420f17af2390abec6f08ec1775677b744b78", "url": "https://github.com/vmware/singleton/commit/4f6a420f17af2390abec6f08ec1775677b744b78", "message": "Merge branch 'master' into master", "committedDate": "2020-03-26T07:20:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM4MDA0Nw==", "url": "https://github.com/vmware/singleton/pull/480#discussion_r398380047", "bodyText": "Is this way more effcient?\nString region = pathVariables.get(APIParamName.REGION);\nif (region == null) {\nregion = request.getParameter(APIParamName.REGION);\n}", "author": "Xiaochao8", "createdAt": "2020-03-26T08:06:35Z", "path": "g11n-ws/modules/md-service-authen/src/main/java/com/vmware/vip/core/validation/ParameterValidation.java", "diffHunk": "@@ -93,6 +98,85 @@ private void validateComponent(HttpServletRequest request)\n \t\t}\n \t}\n \n+\t@SuppressWarnings(\"unchecked\")\n+\tprivate void validateRegion(HttpServletRequest request)\n+\t\t\tthrows ValidationException {\n+\t\tMap<String, String> pathVariables = (Map<String, String>) request\n+\t\t\t\t.getAttribute(HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE);\n+\t\tString region = pathVariables.get(APIParamName.REGION) == null ? request\n+\t\t\t\t.getParameter(APIParamName.REGION) : pathVariables\n+\t\t\t\t.get(APIParamName.REGION);", "originalCommit": "4f6a420f17af2390abec6f08ec1775677b744b78", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODQzMDg1OQ==", "url": "https://github.com/vmware/singleton/pull/480#discussion_r398430859", "bodyText": "the same with your written", "author": "tigershi", "createdAt": "2020-03-26T09:34:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM4MDA0Nw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODM4MDU4Mg==", "url": "https://github.com/vmware/singleton/pull/480#discussion_r398380582", "bodyText": "Same as above.", "author": "Xiaochao8", "createdAt": "2020-03-26T08:07:43Z", "path": "g11n-ws/modules/md-service-authen/src/main/java/com/vmware/vip/core/validation/ParameterValidation.java", "diffHunk": "@@ -93,6 +98,85 @@ private void validateComponent(HttpServletRequest request)\n \t\t}\n \t}\n \n+\t@SuppressWarnings(\"unchecked\")\n+\tprivate void validateRegion(HttpServletRequest request)\n+\t\t\tthrows ValidationException {\n+\t\tMap<String, String> pathVariables = (Map<String, String>) request\n+\t\t\t\t.getAttribute(HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE);\n+\t\tString region = pathVariables.get(APIParamName.REGION) == null ? request\n+\t\t\t\t.getParameter(APIParamName.REGION) : pathVariables\n+\t\t\t\t.get(APIParamName.REGION);\n+\t\tif (StringUtils.isEmpty(region)) {\n+\t\t\treturn;\n+\t\t}\n+\t\tif (!RegExpValidatorUtils.IsLetterAndNumberAndValidchar(region)) {\n+\t\t\tthrow new ValidationException(ValidationMsg.REGION_NOT_VALIDE);\n+\t\t}\n+\t}\n+\t\n+\t@SuppressWarnings(\"unchecked\")\n+\tprivate void validateScope(HttpServletRequest request)\n+\t\t\tthrows ValidationException {\n+\t\tMap<String, String> pathVariables = (Map<String, String>) request\n+\t\t\t\t.getAttribute(HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE);\n+\t\tString scope = pathVariables.get(APIParamName.SCOPE) == null ? request\n+\t\t\t\t.getParameter(APIParamName.SCOPE) : pathVariables\n+\t\t\t\t.get(APIParamName.SCOPE);", "originalCommit": "4f6a420f17af2390abec6f08ec1775677b744b78", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}