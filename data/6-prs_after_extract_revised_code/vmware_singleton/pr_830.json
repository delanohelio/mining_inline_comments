{"pr_number": 830, "pr_title": "G11n java client - vipcfg cleanup", "pr_createdAt": "2020-10-19T23:21:55Z", "pr_url": "https://github.com/vmware/singleton/pull/830", "timeline": [{"oid": "0a7738666c4ef3842d5d51e8833d2f65c7d7342b", "url": "https://github.com/vmware/singleton/commit/0a7738666c4ef3842d5d51e8833d2f65c7d7342b", "message": "Code cleanup - use setter methods", "committedDate": "2020-10-19T23:15:09Z", "type": "commit"}, {"oid": "9b8cb9e2e72da539ef301d1c3b4740e91e40b2b5", "url": "https://github.com/vmware/singleton/commit/9b8cb9e2e72da539ef301d1c3b4740e91e40b2b5", "message": "removing if block because VIPCfg.moduleCfgs.get(productName) is always NOT null at this point", "committedDate": "2020-10-19T23:19:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk0MTM3Nw==", "url": "https://github.com/vmware/singleton/pull/830#discussion_r508941377", "bodyText": "Because service takes priority over offline bundles, so we should make sure service will be before offline bundles despite calling sequence.", "author": "Xiaochao8", "createdAt": "2020-10-21T01:51:59Z", "path": "src/main/java/com/vmware/vipclient/i18n/VIPCfg.java", "diffHunk": "@@ -319,6 +312,7 @@ public String getVipServer() {\n \n     public void setVipServer(String vipServer) {\n         this.vipServer = vipServer;\n+        this.addMsgOriginsQueue(DataSourceEnum.VIP);", "originalCommit": "9b8cb9e2e72da539ef301d1c3b4740e91e40b2b5", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTY5NDk5Mw==", "url": "https://github.com/vmware/singleton/pull/830#discussion_r509694993", "bodyText": "We make sure of this sequence (VIP first before offline) when VIPCfg.initialize(configfile) is used (no change there).\nHowever, product teams are also able to call individual setter methods whenever they prefer (no change here either, except that now, they don't  have to call setMsgOriginsQueue separately.\nWhether we should always enforce the order is a question that is outside of this PR. I do not want to change any logic here as this is only for code clean up. In my opinion, they product teams should be able to set whatever order they choose, but we can discuss this separately,. In the meantime, please approve this PR as is.", "author": "jessiejuachon", "createdAt": "2020-10-21T21:04:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwODk0MTM3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "f7cc110e6ab0da71e6ff6aea16a496bf31593cc8", "chunk": "diff --git a/src/main/java/com/vmware/vipclient/i18n/VIPCfg.java b/src/main/java/com/vmware/vipclient/i18n/VIPCfg.java\nindex e03cdabb..88b830b3 100644\n--- a/src/main/java/com/vmware/vipclient/i18n/VIPCfg.java\n+++ b/src/main/java/com/vmware/vipclient/i18n/VIPCfg.java\n\n@@ -307,12 +299,18 @@ public class VIPCfg {\n     }\n \n     public String getVipServer() {\n-        return vipServer;\n+        if (this.getVipService() == null)\n+            return null;\n+        return this.getVipService().getVipServer();\n     }\n \n     public void setVipServer(String vipServer) {\n-        this.vipServer = vipServer;\n-        this.addMsgOriginsQueue(DataSourceEnum.VIP);\n+        try {\n+            this.vipService = new VIPService(vipServer);\n+            this.addMsgOriginsQueue(DataSourceEnum.VIP);\n+        } catch (Exception e) {\n+            logger.error(\"'vipServer' \" + this.getVipServer() + \" in configuration isn't a valid URL!\");\n+        }\n     }\n \n     public boolean isPseudo() {\n"}}, {"oid": "f7cc110e6ab0da71e6ff6aea16a496bf31593cc8", "url": "https://github.com/vmware/singleton/commit/f7cc110e6ab0da71e6ff6aea16a496bf31593cc8", "message": "Merge branch 'g11n-java-client' into g11n-java-client-vipcfg-cleanup", "committedDate": "2020-10-23T16:43:40Z", "type": "commit"}]}