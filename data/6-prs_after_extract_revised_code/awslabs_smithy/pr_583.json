{"pr_number": 583, "pr_title": "Add additional default CORS headers with config", "pr_createdAt": "2020-09-29T16:09:19Z", "pr_url": "https://github.com/awslabs/smithy/pull/583", "timeline": [{"oid": "6a014d07f96044e84a190fdffae3cfb6acbe05d6", "url": "https://github.com/awslabs/smithy/commit/6a014d07f96044e84a190fdffae3cfb6acbe05d6", "message": "Add additional default CORS headers with config", "committedDate": "2020-09-29T20:54:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzEwMDE2OQ==", "url": "https://github.com/awslabs/smithy/pull/583#discussion_r497100169", "bodyText": "nit: headerNames.addAll(additionalAllowedHeaders)", "author": "mtdowling", "createdAt": "2020-09-29T22:36:39Z", "path": "smithy-aws-apigateway-openapi/src/main/java/software/amazon/smithy/aws/apigateway/openapi/AddCorsPreflightIntegration.java", "diffHunk": "@@ -112,6 +112,14 @@ private static PathItem addPreflightIntegration(\n         // add headers during the Smithy to OpenAPI conversion process will need to update this\n         // list of headers accordingly.\n         Set<String> headerNames = new TreeSet<>(corsTrait.getAdditionalAllowedHeaders());\n+\n+        // Sets additional allowed headers from the API Gateway config.\n+        List<String> additionalAllowedHeaders = context.getConfig().getExtensions(ApiGatewayConfig.class)\n+                .getAdditionalAllowedCorsHeaders();\n+        for (String header : additionalAllowedHeaders) {", "originalCommit": "6a014d07f96044e84a190fdffae3cfb6acbe05d6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d1d54c179cfc4b16d2b087bcbc5193b5850fe9f7", "chunk": "diff --git a/smithy-aws-apigateway-openapi/src/main/java/software/amazon/smithy/aws/apigateway/openapi/AddCorsPreflightIntegration.java b/smithy-aws-apigateway-openapi/src/main/java/software/amazon/smithy/aws/apigateway/openapi/AddCorsPreflightIntegration.java\nindex 1456ea9b7..bebfb9b97 100644\n--- a/smithy-aws-apigateway-openapi/src/main/java/software/amazon/smithy/aws/apigateway/openapi/AddCorsPreflightIntegration.java\n+++ b/smithy-aws-apigateway-openapi/src/main/java/software/amazon/smithy/aws/apigateway/openapi/AddCorsPreflightIntegration.java\n\n@@ -116,10 +116,7 @@ final class AddCorsPreflightIntegration implements ApiGatewayMapper {\n         // Sets additional allowed headers from the API Gateway config.\n         List<String> additionalAllowedHeaders = context.getConfig().getExtensions(ApiGatewayConfig.class)\n                 .getAdditionalAllowedCorsHeaders();\n-        for (String header : additionalAllowedHeaders) {\n-            headerNames.add(header);\n-        }\n-\n+        headerNames.addAll(additionalAllowedHeaders);\n         headerNames.addAll(findAllHeaders(path, pathItem));\n \n         // Add all headers generated by security schemes.\n"}}, {"oid": "d1d54c179cfc4b16d2b087bcbc5193b5850fe9f7", "url": "https://github.com/awslabs/smithy/commit/d1d54c179cfc4b16d2b087bcbc5193b5850fe9f7", "message": "Add additional default CORS headers with config", "committedDate": "2020-09-29T22:42:04Z", "type": "commit"}, {"oid": "d1d54c179cfc4b16d2b087bcbc5193b5850fe9f7", "url": "https://github.com/awslabs/smithy/commit/d1d54c179cfc4b16d2b087bcbc5193b5850fe9f7", "message": "Add additional default CORS headers with config", "committedDate": "2020-09-29T22:42:04Z", "type": "forcePushed"}]}