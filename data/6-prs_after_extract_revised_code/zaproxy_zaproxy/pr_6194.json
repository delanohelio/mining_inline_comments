{"pr_number": 6194, "pr_title": "Custom Pages analyzer fallback & clean code", "pr_createdAt": "2020-09-23T17:45:20Z", "pr_url": "https://github.com/zaproxy/zaproxy/pull/6194", "timeline": [{"oid": "27b6f1bfd0c3bb706b8615a26e6ee6246e69ff94", "url": "https://github.com/zaproxy/zaproxy/commit/27b6f1bfd0c3bb706b8615a26e6ee6246e69ff94", "message": "Custom Pages analyzer fallback & clean code\n\n- In HostProcess have isCustomPage fallback to use Analyser.isFileExist\nin cases where CustomPage.Type.NOTFOUND_404.\n- Tweak various references to CustomPageType -> CustomPage.Type.\n\nSigned-off-by: Kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-09-24T11:50:42Z", "type": "forcePushed"}, {"oid": "c9f1898cc7ebc2468b197e4e7c052cb5b76885a5", "url": "https://github.com/zaproxy/zaproxy/commit/c9f1898cc7ebc2468b197e4e7c052cb5b76885a5", "message": "Custom Pages analyzer fallback & clean code\n\n- In AbstractPlugin.isPage404 fallback to use Analyser.isFileExist. In\nAbstractplugin.isFileExist check isPage200 first then use Analyser.\n- Tweak various references to CustomPageType -> CustomPage.Type.\n\nSigned-off-by: Kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-09-24T11:59:42Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMzNzcwMQ==", "url": "https://github.com/zaproxy/zaproxy/pull/6194#discussion_r494337701", "bodyText": "This could be done in the isPage200 and this method call that one.", "author": "thc202", "createdAt": "2020-09-24T13:52:54Z", "path": "zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractPlugin.java", "diffHunk": "@@ -580,17 +580,19 @@ protected void bingo(\n     }\n \n     /**\n-     * Tells whether or not the file exists, based on previous analysis.\n+     * Tells whether or not the file exists, based on {@code CustomPage} definition or previous\n+     * analysis.\n      *\n      * @param msg the message that will be checked\n      * @return {@code true} if the file exists, {@code false} otherwise\n      */\n     protected boolean isFileExist(HttpMessage msg) {\n-        return parent.getAnalyser().isFileExist(msg);\n+        boolean isFileExist = isPage200(msg);\n+        return isFileExist ? isFileExist : parent.getAnalyser().isFileExist(msg);", "originalCommit": "c9f1898cc7ebc2468b197e4e7c052cb5b76885a5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0e73b95c5aec99023ce566caeabfe4e6e722b3d8", "chunk": "diff --git a/zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractPlugin.java b/zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractPlugin.java\nindex bef43188d..12aec4a0a 100644\n--- a/zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractPlugin.java\n+++ b/zap/src/main/java/org/parosproxy/paros/core/scanner/AbstractPlugin.java\n\n@@ -587,8 +587,7 @@ public abstract class AbstractPlugin implements Plugin, Comparable<Object> {\n      * @return {@code true} if the file exists, {@code false} otherwise\n      */\n     protected boolean isFileExist(HttpMessage msg) {\n-        boolean isFileExist = isPage200(msg);\n-        return isFileExist ? isFileExist : parent.getAnalyser().isFileExist(msg);\n+        return isPage200(msg);\n     }\n \n     /**\n"}}, {"oid": "0e73b95c5aec99023ce566caeabfe4e6e722b3d8", "url": "https://github.com/zaproxy/zaproxy/commit/0e73b95c5aec99023ce566caeabfe4e6e722b3d8", "message": "Custom Pages analyzer fallback & clean code\n\n- In AbstractPlugin.isPage404 fallback to use Analyser.isFileExist. In\nAbstractplugin.isFileExist check isPage200 first then use Analyser.\n- Tweak various references to CustomPageType -> CustomPage.Type.\n\nSigned-off-by: Kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-09-24T14:15:43Z", "type": "forcePushed"}, {"oid": "5e06daab23f8423efd9fd72347baf41d944a99a7", "url": "https://github.com/zaproxy/zaproxy/commit/5e06daab23f8423efd9fd72347baf41d944a99a7", "message": "Custom Pages analyzer fallback & clean code\n\n- In AbstractPlugin.isPage404 fallback to use Analyser.isFileExist. In\nAbstractplugin.isFileExist check isPage200 first then use Analyser.\n- Tweak various references to CustomPageType -> CustomPage.Type.\n\nSigned-off-by: Kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-09-24T14:18:02Z", "type": "forcePushed"}, {"oid": "544d14282292b506c5d65c86e0ca19c688938525", "url": "https://github.com/zaproxy/zaproxy/commit/544d14282292b506c5d65c86e0ca19c688938525", "message": "Custom Pages analyzer fallback & clean code\n\n- In AbstractPlugin.isPage404 fallback to use Analyser.isFileExist. In\nAbstractplugin.isFileExist check isPage200 first then use Analyser.\n- Tweak various references to CustomPageType -> CustomPage.Type.\n\nSigned-off-by: Kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-09-24T14:24:23Z", "type": "commit"}, {"oid": "544d14282292b506c5d65c86e0ca19c688938525", "url": "https://github.com/zaproxy/zaproxy/commit/544d14282292b506c5d65c86e0ca19c688938525", "message": "Custom Pages analyzer fallback & clean code\n\n- In AbstractPlugin.isPage404 fallback to use Analyser.isFileExist. In\nAbstractplugin.isFileExist check isPage200 first then use Analyser.\n- Tweak various references to CustomPageType -> CustomPage.Type.\n\nSigned-off-by: Kingthorin <kingthorin@users.noreply.github.com>", "committedDate": "2020-09-24T14:24:23Z", "type": "forcePushed"}]}