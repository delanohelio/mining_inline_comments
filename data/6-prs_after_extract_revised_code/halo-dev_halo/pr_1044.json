{"pr_number": 1044, "pr_title": "\u2728 Feat: \u901a\u8fc7slug\u83b7\u53d6sheet\u6216\u8005\u6587\u7ae0", "pr_createdAt": "2020-08-25T12:50:31Z", "pr_url": "https://github.com/halo-dev/halo/pull/1044", "timeline": [{"oid": "83b8c7fb3272e551eaf00f49d66dd06445e92de8", "url": "https://github.com/halo-dev/halo/commit/83b8c7fb3272e551eaf00f49d66dd06445e92de8", "message": "\u2728 Feat: \u901a\u8fc7fullpath\u83b7\u53d6sheet\u6216\u8005\u6587\u7ae0", "committedDate": "2020-08-25T12:48:28Z", "type": "commit"}, {"oid": "ab93ae239b3bf5893db809efe3b85f4569cb7d64", "url": "https://github.com/halo-dev/halo/commit/ab93ae239b3bf5893db809efe3b85f4569cb7d64", "message": "\ud83d\ude80 Deploy: Fix CI", "committedDate": "2020-08-25T12:58:29Z", "type": "commit"}, {"oid": "b627658c575c6a88df585de5d1b55b9aee19f408", "url": "https://github.com/halo-dev/halo/commit/b627658c575c6a88df585de5d1b55b9aee19f408", "message": "\u2728 Feat: \u901a\u8fc7slug\u83b7\u53d6\u6587\u7ae0\u8be6\u60c5", "committedDate": "2020-08-26T00:44:28Z", "type": "commit"}, {"oid": "8d9c70810a5f83860548af69befe125a2e43b9b3", "url": "https://github.com/halo-dev/halo/commit/8d9c70810a5f83860548af69befe125a2e43b9b3", "message": "\ud83d\udd28 Refactor: \u5220\u9664\u591a\u4f59\u7684import", "committedDate": "2020-08-26T00:45:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk3OTI5Nw==", "url": "https://github.com/halo-dev/halo/pull/1044#discussion_r476979297", "bodyText": "\u53ef\u4ee5\u4e0d\u8981\u4e86\u3002", "author": "ruibaby", "createdAt": "2020-08-26T02:09:30Z", "path": "src/main/java/run/halo/app/controller/content/api/SheetController.java", "diffHunk": "@@ -78,6 +78,28 @@ public SheetDetailVO getBy(@PathVariable(\"sheetId\") Integer sheetId,\n         return sheetDetailVO;\n     }\n \n+    @GetMapping(\"/slug\")", "originalCommit": "8d9c70810a5f83860548af69befe125a2e43b9b3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "4cacc970fc9f62451b8d03e6c26be8585e8fac6f", "chunk": "diff --git a/src/main/java/run/halo/app/controller/content/api/SheetController.java b/src/main/java/run/halo/app/controller/content/api/SheetController.java\nindex c37e89d3..bb1a2f2d 100644\n--- a/src/main/java/run/halo/app/controller/content/api/SheetController.java\n+++ b/src/main/java/run/halo/app/controller/content/api/SheetController.java\n\n@@ -79,11 +79,11 @@ public class SheetController {\n     }\n \n     @GetMapping(\"/slug\")\n-    @ApiOperation(\"Gets a sheet by fullPath\")\n-    public SheetDetailVO getBy(@RequestParam(\"fullPath\") String fullPath,\n+    @ApiOperation(\"Gets a sheet by slug\")\n+    public SheetDetailVO getBy(@RequestParam(\"slug\") String slug,\n             @RequestParam(value = \"formatDisabled\", required = false, defaultValue = \"true\") Boolean formatDisabled,\n             @RequestParam(value = \"sourceDisabled\", required = false, defaultValue = \"false\") Boolean sourceDisabled) {\n-        SheetDetailVO sheetDetailVO = sheetService.convertToDetailVo(sheetService.getSheetByFullPath(fullPath));\n+        SheetDetailVO sheetDetailVO = sheetService.convertToDetailVo(sheetService.getBySlug(slug));\n \n         if (formatDisabled) {\n             // Clear the format content\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk3OTQ1Nw==", "url": "https://github.com/halo-dev/halo/pull/1044#discussion_r476979457", "bodyText": "\u53ef\u4ee5\u4e0d\u8981\u4e86", "author": "ruibaby", "createdAt": "2020-08-26T02:09:48Z", "path": "src/main/java/run/halo/app/service/SheetService.java", "diffHunk": "@@ -131,4 +132,10 @@\n      * @param sheetId sheetId must not be null\n      */\n     void publishVisitEvent(@NonNull Integer sheetId);\n+\n+    /**\n+     * sheet full path\n+     * @return sheet\n+     */\n+    Sheet getSheetByFullPath(@NotBlank String fullPath);", "originalCommit": "8d9c70810a5f83860548af69befe125a2e43b9b3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk4MjQzNA==", "url": "https://github.com/halo-dev/halo/pull/1044#discussion_r476982434", "bodyText": "\u4f60\u89c9\u5f97\u83b7\u53d6sheet\u5185\u5bb9\u53ea\u7528\u901a\u8fc7 slug\uff0c\u4e0d\u9700\u8981\u901a\u8fc7\u5168\u8def\u5f84\u5417\uff1f\u6211\u4e2a\u4eba\u8ba4\u4e3a\uff0c\u83b7\u53d6sheet\u4f7f\u7528\u5168\u8def\u5f84\u6bd4\u8f83\u597d\uff0c\u56e0\u4e3a prefix \u6211\u770b\u5728\u540e\u53f0\u662f\u53ef\u4ee5\u914d\u7f6e\u7684", "author": "xzhuz", "createdAt": "2020-08-26T02:14:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk3OTQ1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "4cacc970fc9f62451b8d03e6c26be8585e8fac6f", "chunk": "diff --git a/src/main/java/run/halo/app/service/SheetService.java b/src/main/java/run/halo/app/service/SheetService.java\nindex fa11413c..e136f7b2 100644\n--- a/src/main/java/run/halo/app/service/SheetService.java\n+++ b/src/main/java/run/halo/app/service/SheetService.java\n\n@@ -133,9 +133,4 @@ public interface SheetService extends BasePostService<Sheet> {\n      */\n     void publishVisitEvent(@NonNull Integer sheetId);\n \n-    /**\n-     * sheet full path\n-     * @return sheet\n-     */\n-    Sheet getSheetByFullPath(@NotBlank String fullPath);\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk3OTYyMg==", "url": "https://github.com/halo-dev/halo/pull/1044#discussion_r476979622", "bodyText": "\u8fd9\u91cc\u7684\u8def\u7531\u5f62\u5f0f\u6709\u5f85\u5546\u69b7\u3002", "author": "ruibaby", "createdAt": "2020-08-26T02:10:03Z", "path": "src/main/java/run/halo/app/controller/content/api/PostController.java", "diffHunk": "@@ -88,6 +88,28 @@ public PostDetailVO getBy(@PathVariable(\"postId\") Integer postId,\n         return postDetailVO;\n     }\n \n+    @GetMapping(\"{slug}/slug\")", "originalCommit": "8d9c70810a5f83860548af69befe125a2e43b9b3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk4MjU0OQ==", "url": "https://github.com/halo-dev/halo/pull/1044#discussion_r476982549", "bodyText": "\u4f7f\u7528\u4e0a\u9762\u8001\u54e5\u8bf4\u7684 /slug/{slug}", "author": "xzhuz", "createdAt": "2020-08-26T02:14:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Njk3OTYyMg=="}], "type": "inlineReview", "revised_code": {"commit": "4cacc970fc9f62451b8d03e6c26be8585e8fac6f", "chunk": "diff --git a/src/main/java/run/halo/app/controller/content/api/PostController.java b/src/main/java/run/halo/app/controller/content/api/PostController.java\nindex 5ec9274b..5cee406f 100644\n--- a/src/main/java/run/halo/app/controller/content/api/PostController.java\n+++ b/src/main/java/run/halo/app/controller/content/api/PostController.java\n\n@@ -88,9 +88,9 @@ public class PostController {\n         return postDetailVO;\n     }\n \n-    @GetMapping(\"{slug}/slug\")\n+    @GetMapping(\"/slug\")\n     @ApiOperation(\"Gets a post\")\n-    public PostDetailVO getBy(@PathVariable(\"slug\") String slug,\n+    public PostDetailVO getBy(@RequestParam(\"slug\") String slug,\n             @RequestParam(value = \"formatDisabled\", required = false, defaultValue = \"true\") Boolean formatDisabled,\n             @RequestParam(value = \"sourceDisabled\", required = false, defaultValue = \"false\") Boolean sourceDisabled) {\n         PostDetailVO postDetailVO = postService.convertToDetailVo(postService.getBySlug(slug));\n"}}, {"oid": "4cacc970fc9f62451b8d03e6c26be8585e8fac6f", "url": "https://github.com/halo-dev/halo/commit/4cacc970fc9f62451b8d03e6c26be8585e8fac6f", "message": "\u26a1\ufe0f Update: \u91cd\u5199\u81ea\u5b9a\u4e49\u9875\u9762\u7684\u63a5\u53e3,\u53ea\u4f7f\u7528slug\u83b7\u53d6\u9875\u9762", "committedDate": "2020-08-27T15:59:05Z", "type": "commit"}, {"oid": "2f958bea098d11549a277976bf6c428e3a68605f", "url": "https://github.com/halo-dev/halo/commit/2f958bea098d11549a277976bf6c428e3a68605f", "message": "Update: Remove unused import", "committedDate": "2020-08-27T16:03:57Z", "type": "commit"}]}