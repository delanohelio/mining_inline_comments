{"pr_number": 4302, "pr_title": "[WFCORE-5089] FailedOperationTransformationConfig: correct all attrib\u2026", "pr_createdAt": "2020-08-13T11:18:36Z", "pr_url": "https://github.com/wildfly/wildfly-core/pull/4302", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA1ODEzOQ==", "url": "https://github.com/wildfly/wildfly-core/pull/4302#discussion_r470058139", "bodyText": "It might be safer to track whether 'op' has been modified (ie the 'if (checkValue...' block was entered) and return 'operation' if not.\nThe op.get call at L429 may modify 'op' without really changing its semantic content and then there is other code that checks if the return val from this method equals what was passed in. Having a different result from that check when there was no actual change might mess something up.", "author": "bstansberry", "createdAt": "2020-08-13T15:59:17Z", "path": "model-test/src/main/java/org/jboss/as/model/test/FailedOperationTransformationConfig.java", "diffHunk": "@@ -437,10 +437,9 @@ public ModelNode correctOperation(ModelNode operation) {\n                     } else {\n                         op.get(attr).set(complexChildConfig.correctOperation(operation.get(attr)));\n                     }\n-                    return op;\n                 }\n             }\n-            return operation;\n+            return op;", "originalCommit": "a892adeff54fedc59603f3e23404107e2eacf2c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTUyNjE2Ng==", "url": "https://github.com/wildfly/wildfly-core/pull/4302#discussion_r471526166", "bodyText": "fixed", "author": "tadamski", "createdAt": "2020-08-17T14:40:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDA1ODEzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "7b46824991c7d5674a12693a991767294d8dedae", "chunk": "diff --git a/model-test/src/main/java/org/jboss/as/model/test/FailedOperationTransformationConfig.java b/model-test/src/main/java/org/jboss/as/model/test/FailedOperationTransformationConfig.java\nindex c3e71354b3..f44c6952e6 100644\n--- a/model-test/src/main/java/org/jboss/as/model/test/FailedOperationTransformationConfig.java\n+++ b/model-test/src/main/java/org/jboss/as/model/test/FailedOperationTransformationConfig.java\n\n@@ -438,8 +439,13 @@ public class FailedOperationTransformationConfig {\n                         op.get(attr).set(complexChildConfig.correctOperation(operation.get(attr)));\n                     }\n                 }\n+                corrected = true;\n+            }\n+            if (corrected) {\n+                return op;\n+            } else {\n+                return operation;\n             }\n-            return op;\n         }\n \n         protected boolean correctUndefinedValue() {\n"}}, {"oid": "7b46824991c7d5674a12693a991767294d8dedae", "url": "https://github.com/wildfly/wildfly-core/commit/7b46824991c7d5674a12693a991767294d8dedae", "message": "[WFCORE-5089] FailedOperationTransformationConfig: correct all attributes", "committedDate": "2020-08-17T14:17:59Z", "type": "commit"}, {"oid": "7b46824991c7d5674a12693a991767294d8dedae", "url": "https://github.com/wildfly/wildfly-core/commit/7b46824991c7d5674a12693a991767294d8dedae", "message": "[WFCORE-5089] FailedOperationTransformationConfig: correct all attributes", "committedDate": "2020-08-17T14:17:59Z", "type": "forcePushed"}]}