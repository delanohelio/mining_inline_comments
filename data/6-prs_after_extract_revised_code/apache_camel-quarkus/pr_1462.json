{"pr_number": 1462, "pr_title": "Extension for camel-threadpoolfactory-vertx #1430", "pr_createdAt": "2020-07-07T13:57:25Z", "pr_url": "https://github.com/apache/camel-quarkus/pull/1462", "timeline": [{"oid": "c268494b4a53f5efc46f7b54636239e5f14c65f6", "url": "https://github.com/apache/camel-quarkus/commit/c268494b4a53f5efc46f7b54636239e5f14c65f6", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-07-08T07:22:37Z", "type": "forcePushed"}, {"oid": "7313407c95e85e0c327db576d2c01237c993d673", "url": "https://github.com/apache/camel-quarkus/commit/7313407c95e85e0c327db576d2c01237c993d673", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-07-10T14:35:55Z", "type": "forcePushed"}, {"oid": "60bbebc1614c369232787067f45cd3b58271ea34", "url": "https://github.com/apache/camel-quarkus/commit/60bbebc1614c369232787067f45cd3b58271ea34", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-07-10T16:38:07Z", "type": "forcePushed"}, {"oid": "d913ac9684b346701e6c5ae12dbe61c972d8c278", "url": "https://github.com/apache/camel-quarkus/commit/d913ac9684b346701e6c5ae12dbe61c972d8c278", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-07-28T06:49:31Z", "type": "forcePushed"}, {"oid": "c7cdf2339215aec0ca2fca7235e3b79ce2146072", "url": "https://github.com/apache/camel-quarkus/commit/c7cdf2339215aec0ca2fca7235e3b79ce2146072", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-07-28T07:37:22Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1MjUzNw==", "url": "https://github.com/apache/camel-quarkus/pull/1462#discussion_r463452537", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n          \n          \n            \n                        if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {\n          \n          \n            \n                    final ... nodeIdFactory = camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory();\n          \n          \n            \n                    for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n          \n          \n            \n                        if (route.idOrCreate(nodeIdFactory).equals(id)) {\n          \n      \n    \n    \n  \n\nIt would be more effective to get the factory once before starting the loop.", "author": "ppalaga", "createdAt": "2020-07-31T07:35:23Z", "path": "extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java", "diffHunk": "@@ -110,6 +112,91 @@ public synchronized RouteDefinition getRouteDefinition(String id) {\n         return null;\n     }\n \n+    @Override\n+    public List<RouteTemplateDefinition> getRouteTemplateDefinitions() {\n+        return routeTemplateDefinitions;\n+    }\n+\n+    @Override\n+    public RouteTemplateDefinition getRouteTemplateDefinition(String id) {\n+        for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n+            if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {", "originalCommit": "c7cdf2339215aec0ca2fca7235e3b79ce2146072", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1NDUzNg==", "url": "https://github.com/apache/camel-quarkus/pull/1462#discussion_r463454536", "bodyText": "No problem, I'll refactor it", "author": "JiriOndrusek", "createdAt": "2020-07-31T07:40:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1MjUzNw=="}], "type": "inlineReview", "revised_code": {"commit": "3c8deb8ca920794c224cdf8fa1a584ec31f427e4", "chunk": "diff --git a/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java b/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\nindex e08704eee..ce7fd3ff1 100644\n--- a/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\n+++ b/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\n\n@@ -119,8 +120,9 @@ public abstract class BaseModel implements Model {\n \n     @Override\n     public RouteTemplateDefinition getRouteTemplateDefinition(String id) {\n+        NodeIdFactory nodeIdFactory = camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory();\n         for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n-            if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {\n+            if (route.idOrCreate(nodeIdFactory).equals(id)) {\n                 return route;\n             }\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1MzQwNQ==", "url": "https://github.com/apache/camel-quarkus/pull/1462#discussion_r463453405", "bodyText": "Does not look right. Perhaps this?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    this.routeTemplateDefinitions.addAll(routeTemplateDefinitions);\n          \n          \n            \n                    this.routeTemplateDefinitions.addAll(routeTemplateDefinition);", "author": "ppalaga", "createdAt": "2020-07-31T07:37:31Z", "path": "extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java", "diffHunk": "@@ -110,6 +112,91 @@ public synchronized RouteDefinition getRouteDefinition(String id) {\n         return null;\n     }\n \n+    @Override\n+    public List<RouteTemplateDefinition> getRouteTemplateDefinitions() {\n+        return routeTemplateDefinitions;\n+    }\n+\n+    @Override\n+    public RouteTemplateDefinition getRouteTemplateDefinition(String id) {\n+        for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n+            if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {\n+                return route;\n+            }\n+        }\n+        return null;\n+    }\n+\n+    @Override\n+    public void addRouteTemplateDefinitions(Collection<RouteTemplateDefinition> routeTemplateDefinitions) throws Exception {\n+        if (routeTemplateDefinitions == null || routeTemplateDefinitions.isEmpty()) {\n+            return;\n+        }\n+        this.routeTemplateDefinitions.addAll(routeTemplateDefinitions);\n+    }\n+\n+    @Override\n+    public void addRouteTemplateDefinition(RouteTemplateDefinition routeTemplateDefinition) throws Exception {\n+        this.routeTemplateDefinitions.addAll(routeTemplateDefinitions);", "originalCommit": "c7cdf2339215aec0ca2fca7235e3b79ce2146072", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1NDkwOQ==", "url": "https://github.com/apache/camel-quarkus/pull/1462#discussion_r463454909", "bodyText": "I agree that current state doesn't make sense. I'll fix it.", "author": "JiriOndrusek", "createdAt": "2020-07-31T07:41:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1MzQwNQ=="}], "type": "inlineReview", "revised_code": {"commit": "3c8deb8ca920794c224cdf8fa1a584ec31f427e4", "chunk": "diff --git a/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java b/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\nindex e08704eee..ce7fd3ff1 100644\n--- a/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\n+++ b/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\n\n@@ -119,8 +120,9 @@ public abstract class BaseModel implements Model {\n \n     @Override\n     public RouteTemplateDefinition getRouteTemplateDefinition(String id) {\n+        NodeIdFactory nodeIdFactory = camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory();\n         for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n-            if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {\n+            if (route.idOrCreate(nodeIdFactory).equals(id)) {\n                 return route;\n             }\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MzQ1MzgzOA==", "url": "https://github.com/apache/camel-quarkus/pull/1462#discussion_r463453838", "bodyText": "Does not look right either. Maybe this?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    routeTemplateDefinitions.removeAll(routeTemplateDefinitions);\n          \n          \n            \n                    this.routeTemplateDefinitions.removeAll(routeTemplateDefinitions);", "author": "ppalaga", "createdAt": "2020-07-31T07:38:36Z", "path": "extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java", "diffHunk": "@@ -110,6 +112,91 @@ public synchronized RouteDefinition getRouteDefinition(String id) {\n         return null;\n     }\n \n+    @Override\n+    public List<RouteTemplateDefinition> getRouteTemplateDefinitions() {\n+        return routeTemplateDefinitions;\n+    }\n+\n+    @Override\n+    public RouteTemplateDefinition getRouteTemplateDefinition(String id) {\n+        for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n+            if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {\n+                return route;\n+            }\n+        }\n+        return null;\n+    }\n+\n+    @Override\n+    public void addRouteTemplateDefinitions(Collection<RouteTemplateDefinition> routeTemplateDefinitions) throws Exception {\n+        if (routeTemplateDefinitions == null || routeTemplateDefinitions.isEmpty()) {\n+            return;\n+        }\n+        this.routeTemplateDefinitions.addAll(routeTemplateDefinitions);\n+    }\n+\n+    @Override\n+    public void addRouteTemplateDefinition(RouteTemplateDefinition routeTemplateDefinition) throws Exception {\n+        this.routeTemplateDefinitions.addAll(routeTemplateDefinitions);\n+    }\n+\n+    @Override\n+    public void removeRouteTemplateDefinitions(Collection<RouteTemplateDefinition> routeTemplateDefinitions) throws Exception {\n+        routeTemplateDefinitions.removeAll(routeTemplateDefinitions);", "originalCommit": "c7cdf2339215aec0ca2fca7235e3b79ce2146072", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3c8deb8ca920794c224cdf8fa1a584ec31f427e4", "chunk": "diff --git a/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java b/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\nindex e08704eee..ce7fd3ff1 100644\n--- a/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\n+++ b/extensions-core/core/runtime/src/main/java/org/apache/camel/quarkus/core/BaseModel.java\n\n@@ -119,8 +120,9 @@ public abstract class BaseModel implements Model {\n \n     @Override\n     public RouteTemplateDefinition getRouteTemplateDefinition(String id) {\n+        NodeIdFactory nodeIdFactory = camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory();\n         for (RouteTemplateDefinition route : routeTemplateDefinitions) {\n-            if (route.idOrCreate(camelContext.adapt(ExtendedCamelContext.class).getNodeIdFactory()).equals(id)) {\n+            if (route.idOrCreate(nodeIdFactory).equals(id)) {\n                 return route;\n             }\n         }\n"}}, {"oid": "3c8deb8ca920794c224cdf8fa1a584ec31f427e4", "url": "https://github.com/apache/camel-quarkus/commit/3c8deb8ca920794c224cdf8fa1a584ec31f427e4", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-07-31T08:16:33Z", "type": "forcePushed"}, {"oid": "f4fe535aea5718f54efd8057cca580c4f42ffe0b", "url": "https://github.com/apache/camel-quarkus/commit/f4fe535aea5718f54efd8057cca580c4f42ffe0b", "message": "Fixed setter and getter for RouteTemplateDefinition + small optimization", "committedDate": "2020-07-31T11:09:49Z", "type": "forcePushed"}, {"oid": "9574eb269da786dcfe3fb2709f2625d45ad87d57", "url": "https://github.com/apache/camel-quarkus/commit/9574eb269da786dcfe3fb2709f2625d45ad87d57", "message": "Extension for camel-threadpoolfactory-vertx #1430", "committedDate": "2020-08-17T09:58:56Z", "type": "commit"}, {"oid": "4d2a0f7be8727317df90f84410fce39d7f47afe5", "url": "https://github.com/apache/camel-quarkus/commit/4d2a0f7be8727317df90f84410fce39d7f47afe5", "message": "Fixed setter and getter for RouteTemplateDefinition + small optimization", "committedDate": "2020-08-17T09:59:12Z", "type": "commit"}, {"oid": "4d2a0f7be8727317df90f84410fce39d7f47afe5", "url": "https://github.com/apache/camel-quarkus/commit/4d2a0f7be8727317df90f84410fce39d7f47afe5", "message": "Fixed setter and getter for RouteTemplateDefinition + small optimization", "committedDate": "2020-08-17T09:59:12Z", "type": "forcePushed"}]}