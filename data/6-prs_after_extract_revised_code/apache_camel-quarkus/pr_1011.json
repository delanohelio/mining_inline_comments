{"pr_number": 1011, "pr_title": "Fix native images issues on Java 11", "pr_createdAt": "2020-04-01T12:22:54Z", "pr_url": "https://github.com/apache/camel-quarkus/pull/1011", "timeline": [{"oid": "9305905f154d11827b9700b4756750c1e57cfba2", "url": "https://github.com/apache/camel-quarkus/commit/9305905f154d11827b9700b4756750c1e57cfba2", "message": "Use ASM to replace a method", "committedDate": "2020-04-01T07:03:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401577094", "bodyText": "Shouldn't Resilience4jConfigurationProperties be listed below where other org.apache.camel.main.Resilience4j* classes are listed?", "author": "ppalaga", "createdAt": "2020-04-01T12:30:11Z", "path": "extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java", "diffHunk": "@@ -302,7 +302,17 @@ void process(\n                     org.apache.camel.main.DefaultConfigurationProperties.class,\n                     org.apache.camel.main.MainConfigurationProperties.class,\n                     org.apache.camel.main.HystrixConfigurationProperties.class,\n+                    org.apache.camel.main.Resilience4jConfigurationProperties.class,", "originalCommit": "f5d7ccb91f5acc3271d5f100ff0442729b834ea8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4NjM0NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401586345", "bodyText": "the other are form different packages unless you means some other location", "author": "lburgazzoli", "createdAt": "2020-04-01T12:45:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU4ODQyNw==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401588427", "bodyText": "Yes, I have not noticed they are from a different package, but I rather meant the same TODO applies to Resilience4jConfigurationProperties", "author": "ppalaga", "createdAt": "2020-04-01T12:49:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU5OTE2MA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401599160", "bodyText": "ah yeah (btw, we probably wont need them any more with camel 3.2.0)", "author": "lburgazzoli", "createdAt": "2020-04-01T13:05:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTU3NzA5NA=="}], "type": "inlineReview", "revised_code": {"commit": "75a008ea7bc1223b9d6572781590c934e994289b", "chunk": "diff --git a/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java b/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java\nindex b7845e690..89ce069b6 100644\n--- a/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java\n+++ b/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java\n\n@@ -302,17 +302,7 @@ public class NativeImageProcessor {\n                     org.apache.camel.main.DefaultConfigurationProperties.class,\n                     org.apache.camel.main.MainConfigurationProperties.class,\n                     org.apache.camel.main.HystrixConfigurationProperties.class,\n-                    org.apache.camel.main.Resilience4jConfigurationProperties.class,\n                     org.apache.camel.main.RestConfigurationProperties.class));\n-\n-            // TODO: The classes below are needed to fix https://github.com/apache/camel-quarkus/issues/1005\n-            //       but we need to investigate why it does not fail with Java 1.8\n-            reflectiveClass.produce(new ReflectiveClassBuildItem(\n-                    true,\n-                    false,\n-                    org.apache.camel.model.Resilience4jConfigurationDefinition.class,\n-                    org.apache.camel.model.Resilience4jConfigurationCommon.class,\n-                    org.apache.camel.spi.RestConfiguration.class));\n         }\n     }\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401693549", "bodyText": "Nitpick: you wanted to move Resilience4jConfigurationProperties, not RestConfigurationProperties", "author": "ppalaga", "createdAt": "2020-04-01T15:13:30Z", "path": "extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java", "diffHunk": "@@ -302,14 +302,14 @@ void process(\n                     org.apache.camel.main.DefaultConfigurationProperties.class,\n                     org.apache.camel.main.MainConfigurationProperties.class,\n                     org.apache.camel.main.HystrixConfigurationProperties.class,\n-                    org.apache.camel.main.Resilience4jConfigurationProperties.class,\n-                    org.apache.camel.main.RestConfigurationProperties.class));\n+                    org.apache.camel.main.Resilience4jConfigurationProperties.class));", "originalCommit": "d416fe2fb64e56d86af036183a62d08eb5f63054", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5NTU2NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401695565", "bodyText": "damn, will fix it later to avoid another build", "author": "lburgazzoli", "createdAt": "2020-04-01T15:16:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTcwMjgxMA==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401702810", "bodyText": "Let it be!", "author": "ppalaga", "createdAt": "2020-04-01T15:25:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTc1NjU0NQ==", "url": "https://github.com/apache/camel-quarkus/pull/1011#discussion_r401756545", "bodyText": "fixed", "author": "lburgazzoli", "createdAt": "2020-04-01T16:41:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTY5MzU0OQ=="}], "type": "inlineReview", "revised_code": {"commit": "75a008ea7bc1223b9d6572781590c934e994289b", "chunk": "diff --git a/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java b/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java\nindex 7e1611e75..89ce069b6 100644\n--- a/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java\n+++ b/extensions-core/core/deployment/src/main/java/org/apache/camel/quarkus/core/deployment/NativeImageProcessor.java\n\n@@ -302,17 +302,7 @@ public class NativeImageProcessor {\n                     org.apache.camel.main.DefaultConfigurationProperties.class,\n                     org.apache.camel.main.MainConfigurationProperties.class,\n                     org.apache.camel.main.HystrixConfigurationProperties.class,\n-                    org.apache.camel.main.Resilience4jConfigurationProperties.class));\n-\n-            // TODO: The classes below are needed to fix https://github.com/apache/camel-quarkus/issues/1005\n-            //       but we need to investigate why it does not fail with Java 1.8\n-            reflectiveClass.produce(new ReflectiveClassBuildItem(\n-                    true,\n-                    false,\n-                    org.apache.camel.main.RestConfigurationProperties.class,\n-                    org.apache.camel.model.Resilience4jConfigurationDefinition.class,\n-                    org.apache.camel.model.Resilience4jConfigurationCommon.class,\n-                    org.apache.camel.spi.RestConfiguration.class));\n+                    org.apache.camel.main.RestConfigurationProperties.class));\n         }\n     }\n }\n"}}, {"oid": "75a008ea7bc1223b9d6572781590c934e994289b", "url": "https://github.com/apache/camel-quarkus/commit/75a008ea7bc1223b9d6572781590c934e994289b", "message": "Set Java 11 as default", "committedDate": "2020-04-01T15:59:40Z", "type": "commit"}, {"oid": "4112a5a94a1179db6be102f10d9b1750808fcddc", "url": "https://github.com/apache/camel-quarkus/commit/4112a5a94a1179db6be102f10d9b1750808fcddc", "message": "Fix native images issues on Java 11 #1000 #1005 #999", "committedDate": "2020-04-01T15:59:40Z", "type": "commit"}, {"oid": "11808db115f6324ec799c5f4a6499b4c12b9b010", "url": "https://github.com/apache/camel-quarkus/commit/11808db115f6324ec799c5f4a6499b4c12b9b010", "message": "Fix findings", "committedDate": "2020-04-01T15:59:41Z", "type": "forcePushed"}, {"oid": "69ade679a0baf0aa3ed699084096cef27457f770", "url": "https://github.com/apache/camel-quarkus/commit/69ade679a0baf0aa3ed699084096cef27457f770", "message": "Fix findings", "committedDate": "2020-04-01T16:41:33Z", "type": "commit"}, {"oid": "9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "url": "https://github.com/apache/camel-quarkus/commit/9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "message": "camle-tagsoup extension tests fails in native mode on Jdk 11 #1010", "committedDate": "2020-04-01T16:41:34Z", "type": "commit"}, {"oid": "9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "url": "https://github.com/apache/camel-quarkus/commit/9af2546d1602788a3ba9981b1b1976e9c0f90ff0", "message": "camle-tagsoup extension tests fails in native mode on Jdk 11 #1010", "committedDate": "2020-04-01T16:41:34Z", "type": "forcePushed"}, {"oid": "db646b3fade47c2d89cfd43057e48ff074ff8699", "url": "https://github.com/apache/camel-quarkus/commit/db646b3fade47c2d89cfd43057e48ff074ff8699", "message": "Workaround for RestProducer on Java 11", "committedDate": "2020-04-02T09:16:09Z", "type": "commit"}, {"oid": "db646b3fade47c2d89cfd43057e48ff074ff8699", "url": "https://github.com/apache/camel-quarkus/commit/db646b3fade47c2d89cfd43057e48ff074ff8699", "message": "Workaround for RestProducer on Java 11", "committedDate": "2020-04-02T09:16:09Z", "type": "forcePushed"}]}