{"pr_number": 876, "pr_title": "Fixed kafka itests as @Inject is not supported in native tests", "pr_createdAt": "2020-03-11T15:37:25Z", "pr_url": "https://github.com/apache/camel-quarkus/pull/876", "timeline": [{"oid": "36f3c5bc90a3c60b5455328c7d243ca6d5c1fc86", "url": "https://github.com/apache/camel-quarkus/commit/36f3c5bc90a3c60b5455328c7d243ca6d5c1fc86", "message": "Fixed kafka itests as @Inject is not supported in native tests", "committedDate": "2020-03-11T15:36:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391063903", "bodyText": "Note that this line would have been invoked in native mode only due to distinct class loaders. But then @Inject is not authorized.", "author": "aldettinger", "createdAt": "2020-03-11T15:38:28Z", "path": "integration-tests/kafka/src/test/java/org/apache/camel/quarkus/component/kafka/it/CamelKafkaTestResource.java", "diffHunk": "@@ -32,14 +31,6 @@\n     private static final String CONFLUENT_PLATFORM_VERSION = \"5.3.1\";\n \n     private KafkaContainer container;\n-    private CamelMain main;\n-\n-    @Override\n-    public void inject(Object testInstance) {\n-        if (testInstance instanceof CamelKafkaTest) {\n-            this.main = ((CamelKafkaTest) testInstance).main;", "originalCommit": "36f3c5bc90a3c60b5455328c7d243ca6d5c1fc86", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2NDMzNA==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391064334", "bodyText": "is that something documented on quarkus side or a bug ?", "author": "lburgazzoli", "createdAt": "2020-03-11T15:39:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2NTQzMg==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391065432", "bodyText": "Honestly, I don't know but I could take a look.", "author": "aldettinger", "createdAt": "2020-03-11T15:40:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2Njg2MQ==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391066861", "bodyText": "yes please as this was working before and it has been used to avoid having warnings at the end of the tests", "author": "lburgazzoli", "createdAt": "2020-03-11T15:42:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA3MTEyNg==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391071126", "bodyText": "It was a change introduced in 1.3.0.CR1. See quarkusio/quarkus@2cea862.\nI had to make a similar change for the Infinispan tests.", "author": "jamesnetherton", "createdAt": "2020-03-11T15:48:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA3MzI2MA==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391073260", "bodyText": "it looks strange as the pr is about the @Inject annotation", "author": "lburgazzoli", "createdAt": "2020-03-11T15:50:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTExMDAwMw==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391110003", "bodyText": "There must be 2 subjects:\n@Inject not supported in native mode is documented there, so it could have behaved differently previously but it's no more the case.\ntestInstance instanceof CamelKafkaTest == false because of distinct class loaders, I found no mention, so I would better open a question on quarkus side so that we know what behavior we can rely on.", "author": "aldettinger", "createdAt": "2020-03-11T16:42:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTExMjEwNA==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391112104", "bodyText": "oh now I realized what the issue, sorry for taking so much time. so this change is ok, there may ne something similar elsewhere", "author": "lburgazzoli", "createdAt": "2020-03-11T16:45:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTExNjU3MQ==", "url": "https://github.com/apache/camel-quarkus/pull/876#discussion_r391116571", "bodyText": "For the record, question on quarkus side. ok, I'm gonna check if I can find similar thing elsewhere in the context of another ticket.", "author": "aldettinger", "createdAt": "2020-03-11T16:52:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTA2MzkwMw=="}], "type": "inlineReview", "revised_code": null}]}