{"pr_number": 1281, "pr_title": "Update EIP-1559 implementation according to the latest changes", "pr_createdAt": "2020-08-06T15:09:55Z", "pr_url": "https://github.com/hyperledger/besu/pull/1281", "timeline": [{"oid": "772e19e09324475b1afb3dd6c219501f93099864", "url": "https://github.com/hyperledger/besu/commit/772e19e09324475b1afb3dd6c219501f93099864", "message": "Update EIP-1559 implementation\n\n- renamed `DECAY_RANGE` to `MIGRATION_DURATION_IN_BLOCKS`\n- removed `TARGET_GAS_USED`, `SLACK_COEFFICIENT` and `PER_TRANSACTION_LIMIT`\n- updated `computeBaseFee` method to use target gas used depending on block number rather than the hard coded limit\n- added `targetGasUsed` method to compute the actual target gas used depending on the block number to manage correctly the transition period\n- updated gas budget calculator logic\n- updated block header validation rule to check the base fee based on the computed target gas used\n- updated test accordingly\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-06-30T15:56:26Z", "type": "commit"}, {"oid": "2141bf4473e125ffed70b86cfbee09f26d38c431", "url": "https://github.com/hyperledger/besu/commit/2141bf4473e125ffed70b86cfbee09f26d38c431", "message": "fixed unit test\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-06-30T16:46:07Z", "type": "commit"}, {"oid": "0c06cac136e8edb162df182d6d21687e451852be", "url": "https://github.com/hyperledger/besu/commit/0c06cac136e8edb162df182d6d21687e451852be", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-01T07:09:25Z", "type": "commit"}, {"oid": "94b4ea126dce71585d91a297f61c658c24eaa541", "url": "https://github.com/hyperledger/besu/commit/94b4ea126dce71585d91a297f61c658c24eaa541", "message": "Add json test case file\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-01T08:11:38Z", "type": "commit"}, {"oid": "9fa48fb3a83fac0ea1f532084d550d2298783344", "url": "https://github.com/hyperledger/besu/commit/9fa48fb3a83fac0ea1f532084d550d2298783344", "message": "Rename targetGasUsed to parentTargetGasUsed for clarity\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-01T11:45:27Z", "type": "commit"}, {"oid": "61227c2644efbe71ad8905101b4d42dbe3913fd1", "url": "https://github.com/hyperledger/besu/commit/61227c2644efbe71ad8905101b4d42dbe3913fd1", "message": "Refactored test\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-01T12:15:56Z", "type": "commit"}, {"oid": "b811c5eef6042e445543fdc088bc014b3a1dff1f", "url": "https://github.com/hyperledger/besu/commit/b811c5eef6042e445543fdc088bc014b3a1dff1f", "message": "Fix transaction price calculator issue\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-02T13:10:28Z", "type": "commit"}, {"oid": "ddb36a463fce6e30c4725a8aadfcc7e6e3d10d1d", "url": "https://github.com/hyperledger/besu/commit/ddb36a463fce6e30c4725a8aadfcc7e6e3d10d1d", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-02T13:10:34Z", "type": "commit"}, {"oid": "cfa0b4bc319d46557d9ef3c125f46b9a69a96206", "url": "https://github.com/hyperledger/besu/commit/cfa0b4bc319d46557d9ef3c125f46b9a69a96206", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-06T07:41:23Z", "type": "commit"}, {"oid": "0e79cb1d63090b6847cb8c580d9cc67b9fef092f", "url": "https://github.com/hyperledger/besu/commit/0e79cb1d63090b6847cb8c580d9cc67b9fef092f", "message": "Fix gas pool allocation according to latest EIP-1559 change\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-06T07:59:16Z", "type": "commit"}, {"oid": "76983a9c2fb29523461a9a9d10ac3277b75824fa", "url": "https://github.com/hyperledger/besu/commit/76983a9c2fb29523461a9a9d10ac3277b75824fa", "message": "Fix unit tests\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-06T08:30:47Z", "type": "commit"}, {"oid": "f86b5603c88b064a4c986fac1c3dcfa2e3f4a20c", "url": "https://github.com/hyperledger/besu/commit/f86b5603c88b064a4c986fac1c3dcfa2e3f4a20c", "message": "Fix consensus failure. Using floorDiv instead of /\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-06T11:52:01Z", "type": "commit"}, {"oid": "b2ec2deaa28b1619bf7586bba92fd9255ad45e53", "url": "https://github.com/hyperledger/besu/commit/b2ec2deaa28b1619bf7586bba92fd9255ad45e53", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-07T08:42:51Z", "type": "commit"}, {"oid": "3c81450ead8fc0a304fd88b5e6aacb274a09a3bc", "url": "https://github.com/hyperledger/besu/commit/3c81450ead8fc0a304fd88b5e6aacb274a09a3bc", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-07T14:01:29Z", "type": "commit"}, {"oid": "55706eb50e67f7b4f15a2af234565e5ee766fcf5", "url": "https://github.com/hyperledger/besu/commit/55706eb50e67f7b4f15a2af234565e5ee766fcf5", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-08T06:49:58Z", "type": "commit"}, {"oid": "86604b11b01ef208fd4b8147ab70e67b44956d98", "url": "https://github.com/hyperledger/besu/commit/86604b11b01ef208fd4b8147ab70e67b44956d98", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-09T07:08:10Z", "type": "commit"}, {"oid": "19f094072be388df7212e0cd1e8eb54549a36d70", "url": "https://github.com/hyperledger/besu/commit/19f094072be388df7212e0cd1e8eb54549a36d70", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-10T14:21:48Z", "type": "commit"}, {"oid": "8b4228c7754492495a0e9ae639e9af8f2195d6ab", "url": "https://github.com/hyperledger/besu/commit/8b4228c7754492495a0e9ae639e9af8f2195d6ab", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-15T06:54:22Z", "type": "commit"}, {"oid": "bc6df98c29282e51678b313768fd18f4e99ac8ba", "url": "https://github.com/hyperledger/besu/commit/bc6df98c29282e51678b313768fd18f4e99ac8ba", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-16T06:52:08Z", "type": "commit"}, {"oid": "d917102aa079851e12631024a6c310e778dcca89", "url": "https://github.com/hyperledger/besu/commit/d917102aa079851e12631024a6c310e778dcca89", "message": "Implement batch send raw transaction\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-17T08:48:34Z", "type": "commit"}, {"oid": "3efe188e82df087548bb2586a287bcde6be6869c", "url": "https://github.com/hyperledger/besu/commit/3efe188e82df087548bb2586a287bcde6be6869c", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-17T08:49:06Z", "type": "commit"}, {"oid": "d887aff33a01413e25fa71e70d316fe05987e56c", "url": "https://github.com/hyperledger/besu/commit/d887aff33a01413e25fa71e70d316fe05987e56c", "message": "Add SPDX header\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-17T08:54:41Z", "type": "commit"}, {"oid": "e9104ba706a59aee1c553dbbc6f0c9e8b09641ac", "url": "https://github.com/hyperledger/besu/commit/e9104ba706a59aee1c553dbbc6f0c9e8b09641ac", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-21T10:47:14Z", "type": "commit"}, {"oid": "f74d9c0038f8a35a5b6f4c1623a616424c61e630", "url": "https://github.com/hyperledger/besu/commit/f74d9c0038f8a35a5b6f4c1623a616424c61e630", "message": "Process legacy transactions exactly as before EIP-1559 during the transition period.\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-22T07:00:15Z", "type": "commit"}, {"oid": "d9bfdc42b2741d39710707dea129d8a777e1ce12", "url": "https://github.com/hyperledger/besu/commit/d9bfdc42b2741d39710707dea129d8a777e1ce12", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-22T07:00:22Z", "type": "commit"}, {"oid": "f861f8cb7bf33c518d741efb76d56311006450a4", "url": "https://github.com/hyperledger/besu/commit/f861f8cb7bf33c518d741efb76d56311006450a4", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-24T06:56:08Z", "type": "commit"}, {"oid": "1fabd936250b90a2e54a07ea71a00e5608ca12b7", "url": "https://github.com/hyperledger/besu/commit/1fabd936250b90a2e54a07ea71a00e5608ca12b7", "message": "Merge remote-tracking branch 'upstream/master' into 1170\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-27T06:56:25Z", "type": "commit"}, {"oid": "8813ca8731e5214bac8a9b432be8ac29be9ddad5", "url": "https://github.com/hyperledger/besu/commit/8813ca8731e5214bac8a9b432be8ac29be9ddad5", "message": "Fix clique consensus issue\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-27T07:04:59Z", "type": "commit"}, {"oid": "3ed11e0ee68eb16540b423e03b04a9b29aad9ed0", "url": "https://github.com/hyperledger/besu/commit/3ed11e0ee68eb16540b423e03b04a9b29aad9ed0", "message": "Spotless apply\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-07-27T07:29:05Z", "type": "commit"}, {"oid": "7f8a6c123047ab01872d530c300c402625171d6a", "url": "https://github.com/hyperledger/besu/commit/7f8a6c123047ab01872d530c300c402625171d6a", "message": "Merge branch 'master/pr/1176' into feature/EIP-1559-Fix-testnet-issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-06T14:29:03Z", "type": "commit"}, {"oid": "21387afe2c5054d9b704f4cc254da5a3c89bfc69", "url": "https://github.com/hyperledger/besu/commit/21387afe2c5054d9b704f4cc254da5a3c89bfc69", "message": "fix testnet issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-06T14:31:22Z", "type": "commit"}, {"oid": "2b92959900d1cb64230064985decd829ade2b6f2", "url": "https://github.com/hyperledger/besu/commit/2b92959900d1cb64230064985decd829ade2b6f2", "message": "Merge branch 'master' into feature/EIP-1559-Fix-testnet-issues", "committedDate": "2020-08-06T15:10:59Z", "type": "commit"}, {"oid": "72cd244bdcffc7885b319420531bcfd54b6f248b", "url": "https://github.com/hyperledger/besu/commit/72cd244bdcffc7885b319420531bcfd54b6f248b", "message": "fix invalid transaction with GasPrice not less than the current BaseFee\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-07T16:10:36Z", "type": "commit"}, {"oid": "63eabe6c85b492198e19f83e83c15ea530576fe5", "url": "https://github.com/hyperledger/besu/commit/63eabe6c85b492198e19f83e83c15ea530576fe5", "message": "add test\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-10T15:31:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMDE0MA==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r468010140", "bodyText": "Unless this is a standard (or standards track) API I think we should either take it out of the eth_ namespace (debug_ or an new one) or make it obviously bogus, like  eth_x_batchSendRawTransaction", "author": "shemnon", "createdAt": "2020-08-10T15:56:38Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/RpcMethod.java", "diffHunk": "@@ -94,6 +94,7 @@\n   ETH_NEW_PENDING_TRANSACTION_FILTER(\"eth_newPendingTransactionFilter\"),\n   ETH_PROTOCOL_VERSION(\"eth_protocolVersion\"),\n   ETH_SEND_RAW_TRANSACTION(\"eth_sendRawTransaction\"),\n+  ETH_BATCH_RAW_TRANSACTION(\"eth_batchSendRawTransaction\"),", "originalCommit": "2b92959900d1cb64230064985decd829ade2b6f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5NzA4OQ==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r469197089", "bodyText": "Removed from this PR\ncc - @abdelhamidbakhta", "author": "matkt", "createdAt": "2020-08-12T11:43:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMDE0MA=="}], "type": "inlineReview", "revised_code": {"commit": "d8d2ef4d702c894cd3b8890ba5ffa274d1b1b400", "chunk": "diff --git a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/RpcMethod.java b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/RpcMethod.java\nindex 4e220cd1d6..b6f9431358 100644\n--- a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/RpcMethod.java\n+++ b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/RpcMethod.java\n\n@@ -94,7 +94,6 @@ public enum RpcMethod {\n   ETH_NEW_PENDING_TRANSACTION_FILTER(\"eth_newPendingTransactionFilter\"),\n   ETH_PROTOCOL_VERSION(\"eth_protocolVersion\"),\n   ETH_SEND_RAW_TRANSACTION(\"eth_sendRawTransaction\"),\n-  ETH_BATCH_RAW_TRANSACTION(\"eth_batchSendRawTransaction\"),\n   ETH_SEND_TRANSACTION(\"eth_sendTransaction\"),\n   ETH_SUBMIT_WORK(\"eth_submitWork\"),\n   ETH_SUBSCRIBE(\"eth_subscribe\"),\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMTE4Nw==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r468011187", "bodyText": "What happens when one transaction in the middle would fail the addLocalTransaction call? Or the decode call? Did the TXes all before get processed OK?  Do the TXes after it it still get added?  Should we return success count and failure count?  Return errors with indexes?  A black hole concerns me.\nPerhaps we stop at the first error.  All prior TXes are submitted and we send an error response including the index of the error and the error.  This may involve changing this to a traditional for loop.", "author": "shemnon", "createdAt": "2020-08-10T15:58:23Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthBatchSendRawTransaction.java", "diffHunk": "@@ -0,0 +1,54 @@\n+/*\n+ * Copyright ConsenSys AG.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n+ * the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations under the License.\n+ *\n+ * SPDX-License-Identifier: Apache-2.0\n+ */\n+package org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods;\n+\n+import org.hyperledger.besu.ethereum.api.jsonrpc.RpcMethod;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.JsonRpcRequestContext;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.response.JsonRpcResponse;\n+import org.hyperledger.besu.ethereum.api.jsonrpc.internal.response.JsonRpcSuccessResponse;\n+import org.hyperledger.besu.ethereum.api.util.DomainObjectDecodeUtils;\n+import org.hyperledger.besu.ethereum.eth.transactions.TransactionPool;\n+\n+import java.util.function.Supplier;\n+import java.util.stream.IntStream;\n+\n+import com.google.common.base.Suppliers;\n+\n+public class EthBatchSendRawTransaction implements JsonRpcMethod {\n+\n+  private final Supplier<TransactionPool> transactionPool;\n+\n+  public EthBatchSendRawTransaction(final TransactionPool transactionPool) {\n+    this(Suppliers.ofInstance(transactionPool));\n+  }\n+\n+  public EthBatchSendRawTransaction(final Supplier<TransactionPool> transactionPool) {\n+    this.transactionPool = transactionPool;\n+  }\n+\n+  @Override\n+  public String getName() {\n+    return RpcMethod.ETH_BATCH_RAW_TRANSACTION.getMethodName();\n+  }\n+\n+  @Override\n+  public JsonRpcResponse response(final JsonRpcRequestContext requestContext) {\n+    IntStream.range(0, requestContext.getRequest().getParamLength())", "originalCommit": "2b92959900d1cb64230064985decd829ade2b6f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTE5NzE1Mw==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r469197153", "bodyText": "Removed from this PR\ncc - @abdelhamidbakhta", "author": "matkt", "createdAt": "2020-08-12T11:43:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODAxMTE4Nw=="}], "type": "inlineReview", "revised_code": {"commit": "d8d2ef4d702c894cd3b8890ba5ffa274d1b1b400", "chunk": "diff --git a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthBatchSendRawTransaction.java b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthBatchSendRawTransaction.java\ndeleted file mode 100644\nindex 34cb835012..0000000000\n--- a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthBatchSendRawTransaction.java\n+++ /dev/null\n\n@@ -1,54 +0,0 @@\n-/*\n- * Copyright ConsenSys AG.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with\n- * the License. You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on\n- * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the\n- * specific language governing permissions and limitations under the License.\n- *\n- * SPDX-License-Identifier: Apache-2.0\n- */\n-package org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods;\n-\n-import org.hyperledger.besu.ethereum.api.jsonrpc.RpcMethod;\n-import org.hyperledger.besu.ethereum.api.jsonrpc.internal.JsonRpcRequestContext;\n-import org.hyperledger.besu.ethereum.api.jsonrpc.internal.response.JsonRpcResponse;\n-import org.hyperledger.besu.ethereum.api.jsonrpc.internal.response.JsonRpcSuccessResponse;\n-import org.hyperledger.besu.ethereum.api.util.DomainObjectDecodeUtils;\n-import org.hyperledger.besu.ethereum.eth.transactions.TransactionPool;\n-\n-import java.util.function.Supplier;\n-import java.util.stream.IntStream;\n-\n-import com.google.common.base.Suppliers;\n-\n-public class EthBatchSendRawTransaction implements JsonRpcMethod {\n-\n-  private final Supplier<TransactionPool> transactionPool;\n-\n-  public EthBatchSendRawTransaction(final TransactionPool transactionPool) {\n-    this(Suppliers.ofInstance(transactionPool));\n-  }\n-\n-  public EthBatchSendRawTransaction(final Supplier<TransactionPool> transactionPool) {\n-    this.transactionPool = transactionPool;\n-  }\n-\n-  @Override\n-  public String getName() {\n-    return RpcMethod.ETH_BATCH_RAW_TRANSACTION.getMethodName();\n-  }\n-\n-  @Override\n-  public JsonRpcResponse response(final JsonRpcRequestContext requestContext) {\n-    IntStream.range(0, requestContext.getRequest().getParamLength())\n-        .mapToObj(i -> requestContext.getRequiredParameter(i, String.class))\n-        .map(DomainObjectDecodeUtils::decodeRawTransaction)\n-        .forEach(transactionPool.get()::addLocalTransaction);\n-    return new JsonRpcSuccessResponse(requestContext.getRequest().getId());\n-  }\n-}\n"}}, {"oid": "a7d501755ece8c19bb1ed17224abf47d119e5635", "url": "https://github.com/hyperledger/besu/commit/a7d501755ece8c19bb1ed17224abf47d119e5635", "message": "Merge pull request #18 from matkt/feature/EIP-1559-Fix-testnet-issues-part2\n\n- Update eip1559 Pool and Legacy pool part based on the last version of the EIP (https://eips.ethereum.org/EIPS/eip-1559). there was also a problem converting long to int which made the value invalid\r\n- Update BlockTransactionSelector to use the transactionGasBudgetCalculator in order to fix the second part of the illegal block mined issue (Transaction processing error: transaction gas limit 21000 exceeds available block budget remaining XXX)\r\n- We had an issue calculating gasUsed at the AbstractBlockProcessor level. We must have a separate counter for eip1559 and Legacy transactions because they have different pools\r\n- Add check to verify that gasPrice is not less than the current BaseFee\r\n- Add missing block header validator for Clique network\r\n\r\nSigned-off-by: Karim TAAM karim.t2am@gmail.com", "committedDate": "2020-08-11T11:56:29Z", "type": "commit"}, {"oid": "d8d2ef4d702c894cd3b8890ba5ffa274d1b1b400", "url": "https://github.com/hyperledger/besu/commit/d8d2ef4d702c894cd3b8890ba5ffa274d1b1b400", "message": "remove batch send raw transaction JSON RPC method\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-11T11:58:01Z", "type": "commit"}, {"oid": "3d9500b9ea1110d28a550c81402a063db86c6b94", "url": "https://github.com/hyperledger/besu/commit/3d9500b9ea1110d28a550c81402a063db86c6b94", "message": "Merge branch 'upstream/master' into feature/EIP-1559-Fix-testnet-issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-11T11:59:20Z", "type": "commit"}, {"oid": "f15bf9acf65448f8eff24deced7ee8a81f8a7416", "url": "https://github.com/hyperledger/besu/commit/f15bf9acf65448f8eff24deced7ee8a81f8a7416", "message": "Merge branch 'upstream/master' into feature/EIP-1559-Fix-testnet-issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-11T12:01:38Z", "type": "commit"}, {"oid": "44a61ee42ef35ceb9275bad8d424d27192529605", "url": "https://github.com/hyperledger/besu/commit/44a61ee42ef35ceb9275bad8d424d27192529605", "message": "fix transaction pool test issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-12T11:05:00Z", "type": "commit"}, {"oid": "7d68b9991610eac2a37488751294c888bfe05db8", "url": "https://github.com/hyperledger/besu/commit/7d68b9991610eac2a37488751294c888bfe05db8", "message": "fix circle ci\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-12T11:12:31Z", "type": "commit"}, {"oid": "35df2bf53b79132f2eaa32f95d2e8bf63ba3e7ee", "url": "https://github.com/hyperledger/besu/commit/35df2bf53b79132f2eaa32f95d2e8bf63ba3e7ee", "message": "fix circle ci\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-12T11:18:32Z", "type": "commit"}, {"oid": "2c4622cf455838075dd15ed024c4d3192befa7c2", "url": "https://github.com/hyperledger/besu/commit/2c4622cf455838075dd15ed024c4d3192befa7c2", "message": "Merge branch 'master' into feature/EIP-1559-Fix-testnet-issues", "committedDate": "2020-08-12T11:19:24Z", "type": "commit"}, {"oid": "a93c309af2b70dfc3d455f0f4bc613cd00c32e41", "url": "https://github.com/hyperledger/besu/commit/a93c309af2b70dfc3d455f0f4bc613cd00c32e41", "message": "Merge branch 'master' into feature/EIP-1559-Fix-testnet-issues", "committedDate": "2020-08-13T08:20:23Z", "type": "commit"}, {"oid": "0d6205ab7f121cb65cba2335d472d9e768653a8c", "url": "https://github.com/hyperledger/besu/commit/0d6205ab7f121cb65cba2335d472d9e768653a8c", "message": "fix illegal block mined during mining\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-13T14:33:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMzNTAzMw==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r470335033", "bodyText": "Let's stick with just @Parameters", "author": "shemnon", "createdAt": "2020-08-14T00:37:58Z", "path": "ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java", "diffHunk": "@@ -14,60 +14,69 @@\n  */\n package org.hyperledger.besu.ethereum.core.fees;\n \n+import static com.google.common.base.Preconditions.checkState;\n import static org.assertj.core.api.Assertions.assertThat;\n \n import org.hyperledger.besu.config.experimental.ExperimentalEIPs;\n \n-import java.util.Arrays;\n+import java.net.URL;\n+import java.util.ArrayList;\n import java.util.Collection;\n+import java.util.List;\n \n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.google.common.base.Charsets;\n+import com.google.common.io.Resources;\n import org.junit.After;\n import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.junit.runners.Parameterized;\n-import org.junit.runners.Parameterized.Parameters;\n \n @RunWith(Parameterized.class)\n public class EIP1559BaseFeeTest {\n \n-  private static final long MARKER_BASE_FEE = 1049238967;\n-  private final EIP1559 eip1559 = new EIP1559(0L);\n-  private static final FeeMarket FEE_MARKET = FeeMarket.eip1559();\n+  private final EIP1559 eip1559 = new EIP1559(0);\n \n-  @Parameters\n+  @Parameterized.Parameters", "originalCommit": "0d6205ab7f121cb65cba2335d472d9e768653a8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU2NDA1Ng==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r470564056", "bodyText": "Done", "author": "matkt", "createdAt": "2020-08-14T11:17:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMzNTAzMw=="}], "type": "inlineReview", "revised_code": {"commit": "1a03813d98920593ac59c05f45e618c3c8e35701", "chunk": "diff --git a/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java b/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java\nindex d0a8c372bd..ee7d39e4d4 100644\n--- a/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java\n+++ b/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java\n\n@@ -32,13 +32,14 @@ import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.junit.runners.Parameterized;\n+import org.junit.runners.Parameterized.Parameters;\n \n @RunWith(Parameterized.class)\n public class EIP1559BaseFeeTest {\n \n   private final EIP1559 eip1559 = new EIP1559(0);\n \n-  @Parameterized.Parameters\n+  @Parameters\n   public static Collection<Object[]> data() {\n     try {\n       final List<Object[]> data = new ArrayList<>();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMzNTI1MA==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r470335250", "bodyText": "This import should be restored. for the below comment", "author": "shemnon", "createdAt": "2020-08-14T00:38:20Z", "path": "ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java", "diffHunk": "@@ -14,60 +14,69 @@\n  */\n package org.hyperledger.besu.ethereum.core.fees;\n \n+import static com.google.common.base.Preconditions.checkState;\n import static org.assertj.core.api.Assertions.assertThat;\n \n import org.hyperledger.besu.config.experimental.ExperimentalEIPs;\n \n-import java.util.Arrays;\n+import java.net.URL;\n+import java.util.ArrayList;\n import java.util.Collection;\n+import java.util.List;\n \n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import com.google.common.base.Charsets;\n+import com.google.common.io.Resources;\n import org.junit.After;\n import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.junit.runners.Parameterized;\n-import org.junit.runners.Parameterized.Parameters;", "originalCommit": "0d6205ab7f121cb65cba2335d472d9e768653a8c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDU2NDAwOQ==", "url": "https://github.com/hyperledger/besu/pull/1281#discussion_r470564009", "bodyText": "Done", "author": "matkt", "createdAt": "2020-08-14T11:17:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDMzNTI1MA=="}], "type": "inlineReview", "revised_code": {"commit": "1a03813d98920593ac59c05f45e618c3c8e35701", "chunk": "diff --git a/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java b/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java\nindex d0a8c372bd..ee7d39e4d4 100644\n--- a/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java\n+++ b/ethereum/core/src/test/java/org/hyperledger/besu/ethereum/core/fees/EIP1559BaseFeeTest.java\n\n@@ -32,13 +32,14 @@ import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.junit.runners.Parameterized;\n+import org.junit.runners.Parameterized.Parameters;\n \n @RunWith(Parameterized.class)\n public class EIP1559BaseFeeTest {\n \n   private final EIP1559 eip1559 = new EIP1559(0);\n \n-  @Parameterized.Parameters\n+  @Parameters\n   public static Collection<Object[]> data() {\n     try {\n       final List<Object[]> data = new ArrayList<>();\n"}}, {"oid": "1a03813d98920593ac59c05f45e618c3c8e35701", "url": "https://github.com/hyperledger/besu/commit/1a03813d98920593ac59c05f45e618c3c8e35701", "message": "fix review issues\n\nSigned-off-by: Karim TAAM <karim.t2am@gmail.com>", "committedDate": "2020-08-14T11:16:59Z", "type": "commit"}]}