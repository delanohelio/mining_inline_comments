{"pr_number": 851, "pr_title": "Add current block number to eth_getWork response", "pr_createdAt": "2020-05-06T15:19:26Z", "pr_url": "https://github.com/hyperledger/besu/pull/851", "timeline": [{"oid": "665c978838d441b58c7f27b07c4b7e675822c0cf", "url": "https://github.com/hyperledger/besu/commit/665c978838d441b58c7f27b07c4b7e675822c0cf", "message": "Add current block number to eth_getWork response\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-05-06T15:18:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg3OTg0Mw==", "url": "https://github.com/hyperledger/besu/pull/851#discussion_r420879843", "bodyText": "Would it make sense to use Quantity here?", "author": "RatanRSur", "createdAt": "2020-05-06T15:24:09Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java", "diffHunk": "@@ -54,7 +54,8 @@ public JsonRpcResponse response(final JsonRpcRequestContext requestContext) {\n       final String[] result = {\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(rawResult.getPrePowHash()),\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(dagSeed),\n-        rawResult.getTarget().toHexString()\n+        rawResult.getTarget().toHexString(),\n+        \"0x\" + Long.toHexString(rawResult.getBlockNumber())", "originalCommit": "665c978838d441b58c7f27b07c4b7e675822c0cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg4MTI5MA==", "url": "https://github.com/hyperledger/besu/pull/851#discussion_r420881290", "bodyText": "Nice catch", "author": "abdelhamidbakhta", "createdAt": "2020-05-06T15:25:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg3OTg0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg4MjQzOA==", "url": "https://github.com/hyperledger/besu/pull/851#discussion_r420882438", "bodyText": "Fixed", "author": "abdelhamidbakhta", "createdAt": "2020-05-06T15:27:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg3OTg0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "9eaa96b31eedcb3a1a1add16d5ba5b7619c65123", "chunk": "diff --git a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java\nindex 20b4f4b32..8b4f78079 100644\n--- a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java\n+++ b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java\n\n@@ -55,7 +56,7 @@ public class EthGetWork implements JsonRpcMethod {\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(rawResult.getPrePowHash()),\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(dagSeed),\n         rawResult.getTarget().toHexString(),\n-        \"0x\" + Long.toHexString(rawResult.getBlockNumber())\n+        Quantity.create(rawResult.getBlockNumber())\n       };\n       return new JsonRpcSuccessResponse(requestContext.getRequest().getId(), result);\n     } else {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg4MDc0Nw==", "url": "https://github.com/hyperledger/besu/pull/851#discussion_r420880747", "bodyText": "Do we have any confirmation that were we to add the block number it should be slotted in the fourth array position?  For example, documentation or other client implementations?", "author": "shemnon", "createdAt": "2020-05-06T15:25:19Z", "path": "ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java", "diffHunk": "@@ -54,7 +54,8 @@ public JsonRpcResponse response(final JsonRpcRequestContext requestContext) {\n       final String[] result = {\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(rawResult.getPrePowHash()),\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(dagSeed),\n-        rawResult.getTarget().toHexString()\n+        rawResult.getTarget().toHexString(),\n+        \"0x\" + Long.toHexString(rawResult.getBlockNumber())", "originalCommit": "665c978838d441b58c7f27b07c4b7e675822c0cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg4MTA0Mg==", "url": "https://github.com/hyperledger/besu/pull/851#discussion_r420881042", "bodyText": "Yeah i have confirmation from Geth implementation", "author": "abdelhamidbakhta", "createdAt": "2020-05-06T15:25:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg4MDc0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "9eaa96b31eedcb3a1a1add16d5ba5b7619c65123", "chunk": "diff --git a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java\nindex 20b4f4b32..8b4f78079 100644\n--- a/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java\n+++ b/ethereum/api/src/main/java/org/hyperledger/besu/ethereum/api/jsonrpc/internal/methods/EthGetWork.java\n\n@@ -55,7 +56,7 @@ public class EthGetWork implements JsonRpcMethod {\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(rawResult.getPrePowHash()),\n         \"0x\" + BaseEncoding.base16().lowerCase().encode(dagSeed),\n         rawResult.getTarget().toHexString(),\n-        \"0x\" + Long.toHexString(rawResult.getBlockNumber())\n+        Quantity.create(rawResult.getBlockNumber())\n       };\n       return new JsonRpcSuccessResponse(requestContext.getRequest().getId(), result);\n     } else {\n"}}, {"oid": "9eaa96b31eedcb3a1a1add16d5ba5b7619c65123", "url": "https://github.com/hyperledger/besu/commit/9eaa96b31eedcb3a1a1add16d5ba5b7619c65123", "message": "Use Quantity to format block number\n\nSigned-off-by: Abdelhamid Bakhta <abdelhamid.bakhta@consensys.net>", "committedDate": "2020-05-06T15:28:10Z", "type": "commit"}]}