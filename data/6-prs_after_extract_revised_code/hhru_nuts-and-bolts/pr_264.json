{"pr_number": 264, "pr_title": "Hh 117688", "pr_createdAt": "2020-10-13T09:34:32Z", "pr_url": "https://github.com/hhru/nuts-and-bolts/pull/264", "timeline": [{"oid": "122dd02196680b3a45dccd12f6b4f982ca0181ed", "url": "https://github.com/hhru/nuts-and-bolts/commit/122dd02196680b3a45dccd12f6b4f982ca0181ed", "message": "HH-117688 update public pom", "committedDate": "2020-10-12T11:01:46Z", "type": "commit"}, {"oid": "75a2d4d701049cb7870b7e945398b1ef1922d2a2", "url": "https://github.com/hhru/nuts-and-bolts/commit/75a2d4d701049cb7870b7e945398b1ef1922d2a2", "message": "HH-117688 take plugin versions from public pom", "committedDate": "2020-10-12T11:06:55Z", "type": "commit"}, {"oid": "375e3aeecbec18ff04f17585a076ec7a41b5c0a5", "url": "https://github.com/hhru/nuts-and-bolts/commit/375e3aeecbec18ff04f17585a076ec7a41b5c0a5", "message": "HH-117688 move jetty settings keys to constants", "committedDate": "2020-10-12T12:25:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzgxNzY3Mw==", "url": "https://github.com/hhru/nuts-and-bolts/pull/264#discussion_r503817673", "bodyText": "\u0431\u0443\u0434\u0435\u0442 \u043b\u0430\u043a\u043e\u043d\u0438\u0447\u043d\u0435\u0435 \u0441 \n  \n    \n      nuts-and-bolts/nab-common/src/main/java/ru/hh/nab/common/properties/FileSettings.java\n    \n    \n         Line 21\n      in\n      4faa23d\n    \n    \n    \n    \n\n        \n          \n           public int getInteger(String key, int defaultValue) {", "author": "heruv1m", "createdAt": "2020-10-13T09:48:50Z", "path": "nab-starter/src/main/java/ru/hh/nab/starter/server/jetty/JettyServer.java", "diffHunk": "@@ -111,15 +120,15 @@ private void configureRequestLogger() {\n   }\n \n   private void configureStopTimeout() {\n-    server.setStopTimeout(ofNullable(jettySettings.getInteger(\"stopTimeoutMs\")).orElse(5_000));\n+    server.setStopTimeout(ofNullable(jettySettings.getInteger(STOP_TIMEOUT_SIZE)).orElse(5_000));\n   }\n \n   private static HttpConnectionFactory createHttpConnectionFactory(FileSettings jettySettings) {\n     final HttpConfiguration httpConfiguration = new HttpConfiguration();\n-    httpConfiguration.setSecurePort(Optional.ofNullable(jettySettings.getInteger(\"securePort\")).orElse(8443));\n-    httpConfiguration.setOutputBufferSize(Optional.ofNullable(jettySettings.getInteger(\"outputBufferSize\")).orElse(65536));\n-    httpConfiguration.setRequestHeaderSize(Optional.ofNullable(jettySettings.getInteger(\"requestHeaderSize\")).orElse(16384));\n-    httpConfiguration.setResponseHeaderSize(Optional.ofNullable(jettySettings.getInteger(\"responseHeaderSize\")).orElse(65536));\n+    httpConfiguration.setSecurePort(Optional.ofNullable(jettySettings.getInteger(SECURE_PORT)).orElse(8443));", "originalCommit": "375e3aeecbec18ff04f17585a076ec7a41b5c0a5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6ab6c0152f0830878dd7d66cf64c37a516409636", "chunk": "diff --git a/nab-starter/src/main/java/ru/hh/nab/starter/server/jetty/JettyServer.java b/nab-starter/src/main/java/ru/hh/nab/starter/server/jetty/JettyServer.java\nindex 7ff69d0d..0b4efeaa 100644\n--- a/nab-starter/src/main/java/ru/hh/nab/starter/server/jetty/JettyServer.java\n+++ b/nab-starter/src/main/java/ru/hh/nab/starter/server/jetty/JettyServer.java\n\n@@ -120,15 +120,15 @@ public final class JettyServer {\n   }\n \n   private void configureStopTimeout() {\n-    server.setStopTimeout(ofNullable(jettySettings.getInteger(STOP_TIMEOUT_SIZE)).orElse(5_000));\n+    server.setStopTimeout(jettySettings.getInteger(STOP_TIMEOUT_SIZE, 5_000));\n   }\n \n   private static HttpConnectionFactory createHttpConnectionFactory(FileSettings jettySettings) {\n     final HttpConfiguration httpConfiguration = new HttpConfiguration();\n-    httpConfiguration.setSecurePort(Optional.ofNullable(jettySettings.getInteger(SECURE_PORT)).orElse(8443));\n-    httpConfiguration.setOutputBufferSize(Optional.ofNullable(jettySettings.getInteger(OUTPUT_BUFFER_SIZE)).orElse(65536));\n-    httpConfiguration.setRequestHeaderSize(Optional.ofNullable(jettySettings.getInteger(REQUEST_HEADER_SIZE)).orElse(16384));\n-    httpConfiguration.setResponseHeaderSize(Optional.ofNullable(jettySettings.getInteger(RESPONSE_HEADER_SIZE)).orElse(65536));\n+    httpConfiguration.setSecurePort(jettySettings.getInteger(SECURE_PORT, 8443));\n+    httpConfiguration.setOutputBufferSize(jettySettings.getInteger(OUTPUT_BUFFER_SIZE, 65536));\n+    httpConfiguration.setRequestHeaderSize(jettySettings.getInteger(REQUEST_HEADER_SIZE, 16384));\n+    httpConfiguration.setResponseHeaderSize(jettySettings.getInteger(RESPONSE_HEADER_SIZE, 65536));\n     httpConfiguration.setSendServerVersion(false);\n     // \u044f \u043d\u0435 \u043f\u043e\u043d\u0438\u043c\u0430\u044e \u043a\u0430\u043a \u0442\u0430\u0439\u043c\u0430\u0443\u0442 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c \u043d\u0430 \u0442\u0435\u043c\u043f.\n     // org.eclipse.jetty.server.HttpConfiguration.setMinResponseDataRate \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0440\u044b\u0432\u0430\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043d\u0435 \u0447\u0435\u0440\u0435\u0437 5 \u0441\u0435\u043a\u0443\u043d\u0434, \u0430 \u0443\u0436\u0435 \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0432\u043e\u0439 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438,\n"}}, {"oid": "6ab6c0152f0830878dd7d66cf64c37a516409636", "url": "https://github.com/hhru/nuts-and-bolts/commit/6ab6c0152f0830878dd7d66cf64c37a516409636", "message": "HH-117688 use built-in default fallback for jetty settings instead of Optional", "committedDate": "2020-10-13T10:15:19Z", "type": "commit"}]}