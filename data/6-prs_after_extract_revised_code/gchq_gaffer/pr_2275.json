{"pr_number": 2275, "pr_title": "Gh 2270 JUnit5 upgrade (modules: cache, common-utils, data, exception)", "pr_createdAt": "2020-04-30T14:00:35Z", "pr_url": "https://github.com/gchq/Gaffer/pull/2275", "timeline": [{"oid": "a2de7d32c1df0280546b9181ab285400be26684a", "url": "https://github.com/gchq/Gaffer/commit/a2de7d32c1df0280546b9181ab285400be26684a", "message": "Added JUnit5 tests to increase coverage", "committedDate": "2020-03-11T12:35:02Z", "type": "commit"}, {"oid": "cca2be001c1e5ffa522394939ca705bb5288bd92", "url": "https://github.com/gchq/Gaffer/commit/cca2be001c1e5ffa522394939ca705bb5288bd92", "message": "Added JUnit5 tests to increase coverage", "committedDate": "2020-03-11T12:35:15Z", "type": "commit"}, {"oid": "6574b9103ebefcacef37beeaba9eedf9a70487a3", "url": "https://github.com/gchq/Gaffer/commit/6574b9103ebefcacef37beeaba9eedf9a70487a3", "message": "Fixed warnings", "committedDate": "2020-03-13T10:38:58Z", "type": "commit"}, {"oid": "00d06dd61499d33ba68fcd06084c5a89b3b65a8b", "url": "https://github.com/gchq/Gaffer/commit/00d06dd61499d33ba68fcd06084c5a89b3b65a8b", "message": "Updated the accumulo-store README how to set scan auths", "committedDate": "2020-03-18T17:14:32Z", "type": "commit"}, {"oid": "6cd469dc5bca549ee49a618e89a6c413e62baa9e", "url": "https://github.com/gchq/Gaffer/commit/6cd469dc5bca549ee49a618e89a6c413e62baa9e", "message": "Further updated to accumulo-store README", "committedDate": "2020-03-18T17:54:53Z", "type": "commit"}, {"oid": "f3fe7cfb9e9c2af3a71f523dbd83e3275f5e3c55", "url": "https://github.com/gchq/Gaffer/commit/f3fe7cfb9e9c2af3a71f523dbd83e3275f5e3c55", "message": "Moved junit5 module dependencies to top level pom", "committedDate": "2020-03-19T11:12:53Z", "type": "commit"}, {"oid": "9de3b6993e6b1c23767c587c69ecf153e5c6c572", "url": "https://github.com/gchq/Gaffer/commit/9de3b6993e6b1c23767c587c69ecf153e5c6c572", "message": "Organised imports", "committedDate": "2020-03-19T16:15:08Z", "type": "commit"}, {"oid": "745620c0664b3024f21652c6de477d47c10ed4c1", "url": "https://github.com/gchq/Gaffer/commit/745620c0664b3024f21652c6de477d47c10ed4c1", "message": "Temp change - allow branch build on Travis", "committedDate": "2020-03-19T16:23:06Z", "type": "commit"}, {"oid": "5ea24ca466ca3724f090898a4a998f440e55b43b", "url": "https://github.com/gchq/Gaffer/commit/5ea24ca466ca3724f090898a4a998f440e55b43b", "message": "Revert temp change for Travis", "committedDate": "2020-03-19T16:30:10Z", "type": "commit"}, {"oid": "49ada9221cf6ccf18c2ec6c3303e399d49b03f2e", "url": "https://github.com/gchq/Gaffer/commit/49ada9221cf6ccf18c2ec6c3303e399d49b03f2e", "message": "Fixed Checkstyle errors", "committedDate": "2020-03-20T10:13:43Z", "type": "commit"}, {"oid": "56a5bb201e08a247c62a8b0246e674c7ed3bb82d", "url": "https://github.com/gchq/Gaffer/commit/56a5bb201e08a247c62a8b0246e674c7ed3bb82d", "message": "Renamed test display name", "committedDate": "2020-03-23T09:34:13Z", "type": "commit"}, {"oid": "08166bd2898d915152e761b4d2d8ab318fec08fe", "url": "https://github.com/gchq/Gaffer/commit/08166bd2898d915152e761b4d2d8ab318fec08fe", "message": "Merge branch 'develop' of github.com:gchq/Gaffer into gh-000-JUnit5-upgrade\n\n# Conflicts:\n#\tlibrary/spark/spark-accumulo-library/src/test/java/uk/gov/gchq/gaffer/sparkaccumulo/integration/operation/handler/scalardd/GetRDDOfAllElementsHandlerIT.java\n#\tlibrary/spark/spark-accumulo-library/src/test/java/uk/gov/gchq/gaffer/sparkaccumulo/integration/rfilereaderrdd/RFileReaderRddIT.java\n#\tlibrary/spark/spark-accumulo-library/src/test/java/uk/gov/gchq/gaffer/sparkaccumulo/operation/rfilereaderrdd/AccumuloTabletTest.java\n#\tlibrary/spark/spark-accumulo-library/src/test/java/uk/gov/gchq/gaffer/sparkaccumulo/operation/rfilereaderrdd/RFileReaderIteratorTest.java\n#\tstore-implementation/accumulo-store/src/test/java/uk/gov/gchq/gaffer/accumulostore/AccumuloStoreTest.java\n#\tstore-implementation/accumulo-store/src/test/java/uk/gov/gchq/gaffer/accumulostore/utils/AddUpdateTableIteratorTest.java\n#\tstore-implementation/accumulo-store/src/test/resources/empty-store.properties", "committedDate": "2020-04-15T10:29:51Z", "type": "commit"}, {"oid": "a636bee2fb12bf293a4b799f920baafd177bd07c", "url": "https://github.com/gchq/Gaffer/commit/a636bee2fb12bf293a4b799f920baafd177bd07c", "message": "HashMapCacheTest upgraded", "committedDate": "2020-04-27T15:04:15Z", "type": "commit"}, {"oid": "a179400771f6fed1e32728b179e8f782786e22ae", "url": "https://github.com/gchq/Gaffer/commit/a179400771f6fed1e32728b179e8f782786e22ae", "message": "Core cache module JUnit5 upgrade", "committedDate": "2020-04-27T16:16:48Z", "type": "commit"}, {"oid": "aecaff7d8629beb6e9b6bf015a70c23f3e31ba5d", "url": "https://github.com/gchq/Gaffer/commit/aecaff7d8629beb6e9b6bf015a70c23f3e31ba5d", "message": "Merge branch 'develop' of github.com:gchq/Gaffer into gh-2270-JUnit5-upgrade", "committedDate": "2020-04-27T16:21:57Z", "type": "commit"}, {"oid": "12f7ee247719a8ed3fe9090468f14768ce4d62f7", "url": "https://github.com/gchq/Gaffer/commit/12f7ee247719a8ed3fe9090468f14768ce4d62f7", "message": "Core common-util JUnit5 upgrade", "committedDate": "2020-04-28T14:29:11Z", "type": "commit"}, {"oid": "ab9df82e1f1866dd3c64adcca0f5db9b36a032a1", "url": "https://github.com/gchq/Gaffer/commit/ab9df82e1f1866dd3c64adcca0f5db9b36a032a1", "message": "Core common-util JUnit5 upgrade", "committedDate": "2020-04-28T17:19:29Z", "type": "commit"}, {"oid": "aa5fd985c5f621705e960552f508a7451a147113", "url": "https://github.com/gchq/Gaffer/commit/aa5fd985c5f621705e960552f508a7451a147113", "message": "Upgraded ErrorTest to use JUnit5", "committedDate": "2020-04-29T10:49:02Z", "type": "commit"}, {"oid": "9517d1d5ea2fd1575571e5da804538f44b2dc0b6", "url": "https://github.com/gchq/Gaffer/commit/9517d1d5ea2fd1575571e5da804538f44b2dc0b6", "message": "Formatting", "committedDate": "2020-04-29T10:49:23Z", "type": "commit"}, {"oid": "a5f6d276379f1af84ddc74ba8001efaf9dc3896a", "url": "https://github.com/gchq/Gaffer/commit/a5f6d276379f1af84ddc74ba8001efaf9dc3896a", "message": "Removed duplicate tests in ComparableOrToStringComparatorTest", "committedDate": "2020-04-29T11:05:43Z", "type": "commit"}, {"oid": "1258a74d8dbdccf86364b634b3ca77fc8fbd5043", "url": "https://github.com/gchq/Gaffer/commit/1258a74d8dbdccf86364b634b3ca77fc8fbd5043", "message": "ElementComparison upgrade to JUnit5", "committedDate": "2020-04-29T11:42:49Z", "type": "commit"}, {"oid": "1c9caa3f5b47156eabdc8869f50d794ea89acaf4", "url": "https://github.com/gchq/Gaffer/commit/1c9caa3f5b47156eabdc8869f50d794ea89acaf4", "message": "Upgrade data & exception modules to JUnit5", "committedDate": "2020-04-30T13:54:45Z", "type": "commit"}, {"oid": "8ab5c7727936115a15fc4bcf237e20a2fa5bdcb5", "url": "https://github.com/gchq/Gaffer/commit/8ab5c7727936115a15fc4bcf237e20a2fa5bdcb5", "message": "Merge branch 'develop' of github.com:gchq/Gaffer into gh-2270-JUnit5-upgrade", "committedDate": "2020-04-30T13:56:16Z", "type": "commit"}, {"oid": "70427fd13dfb061aec4dd86c3a6159b53a3883ce", "url": "https://github.com/gchq/Gaffer/commit/70427fd13dfb061aec4dd86c3a6159b53a3883ce", "message": "Increased Flink verifyElements sleep 2->3secs to stop failing test", "committedDate": "2020-04-30T15:04:24Z", "type": "commit"}, {"oid": "c4fe8b9e327bf596496443672276b7b2d658bec8", "url": "https://github.com/gchq/Gaffer/commit/c4fe8b9e327bf596496443672276b7b2d658bec8", "message": "Added ChainedIterableTest tests", "committedDate": "2020-05-04T10:30:47Z", "type": "commit"}, {"oid": "fa711a346c68997c357f1770a87b03241d78a5b3", "url": "https://github.com/gchq/Gaffer/commit/fa711a346c68997c357f1770a87b03241d78a5b3", "message": "Reviewed work changes", "committedDate": "2020-05-04T10:57:36Z", "type": "commit"}, {"oid": "9c11e246a1a336021adb4ad8ed5c476855ad427d", "url": "https://github.com/gchq/Gaffer/commit/9c11e246a1a336021adb4ad8ed5c476855ad427d", "message": "Removed spark-acc JUnit5 tests to new branch", "committedDate": "2020-05-04T15:22:00Z", "type": "commit"}, {"oid": "6665467a381cc864e0fe232401e9eaa11107fc15", "url": "https://github.com/gchq/Gaffer/commit/6665467a381cc864e0fe232401e9eaa11107fc15", "message": "Formatting and Codestyle fixes", "committedDate": "2020-05-04T15:54:41Z", "type": "commit"}, {"oid": "e05db011d4205768d89c91d797ebfd4242a08ed1", "url": "https://github.com/gchq/Gaffer/commit/e05db011d4205768d89c91d797ebfd4242a08ed1", "message": "JUnit5 abstract FunctionTest", "committedDate": "2020-05-05T10:51:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5ODExMQ==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r427898111", "bodyText": "All public methods in this class should keep the same name as external tests may depend on it.", "author": "d47853", "createdAt": "2020-05-20T10:15:45Z", "path": "core/common-util/src/test/java/uk/gov/gchq/gaffer/commonutil/JsonAssert.java", "diffHunk": "@@ -17,25 +17,27 @@\n package uk.gov.gchq.gaffer.commonutil;\n \n import com.fasterxml.jackson.databind.ObjectMapper;\n-import org.junit.Assert;\n \n import java.io.IOException;\n import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotEquals;\n+\n public final class JsonAssert {\n     private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();\n \n     private JsonAssert() {\n         //Private to prevent instantiation\n     }\n \n-    public static void assertEquals(final String expectedJson, final String actualJson) {\n+    public static void assertJsonEquals(final String expectedJson, final String actualJson) {", "originalCommit": "e05db011d4205768d89c91d797ebfd4242a08ed1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzIyNDI5MQ==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r433224291", "bodyText": "Agreed I've reverted this back to original method name", "author": "macenturalxl1", "createdAt": "2020-06-01T13:10:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzg5ODExMQ=="}], "type": "inlineReview", "revised_code": {"commit": "cbe30dcb499c608e489e8adbb659533a3af647c3", "chunk": "diff --git a/core/common-util/src/test/java/uk/gov/gchq/gaffer/commonutil/JsonAssert.java b/core/common-util/src/test/java/uk/gov/gchq/gaffer/commonutil/JsonAssert.java\nindex 858e57f549..d3f351f15a 100644\n--- a/core/common-util/src/test/java/uk/gov/gchq/gaffer/commonutil/JsonAssert.java\n+++ b/core/common-util/src/test/java/uk/gov/gchq/gaffer/commonutil/JsonAssert.java\n\n@@ -17,13 +17,13 @@\n package uk.gov.gchq.gaffer.commonutil;\n \n import com.fasterxml.jackson.databind.ObjectMapper;\n+import org.junit.jupiter.api.Assertions;\n \n import java.io.IOException;\n import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n-import static org.junit.jupiter.api.Assertions.assertEquals;\n import static org.junit.jupiter.api.Assertions.assertNotEquals;\n \n public final class JsonAssert {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkxODg1Nw==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r427918857", "bodyText": "There should probably be a comment on this class saying it is copied from Koryphe and should only be used while Koryphe and Gaffer use different versions of Junit.", "author": "d47853", "createdAt": "2020-05-20T10:54:46Z", "path": "core/data/src/test/java/uk/gov/gchq/gaffer/data/element/function/FunctionTest.java", "diffHunk": "@@ -0,0 +1,113 @@\n+/*", "originalCommit": "e05db011d4205768d89c91d797ebfd4242a08ed1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzIyNDgyNg==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r433224826", "bodyText": "I've added documentation to this class with a @see annotation to reference the koryphe dependency and why (in regards to JUnit5)", "author": "macenturalxl1", "createdAt": "2020-06-01T13:12:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkxODg1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "b73511bf6f92201df0b9a75714d304242e3e12e9", "chunk": "diff --git a/core/data/src/test/java/uk/gov/gchq/gaffer/data/element/function/FunctionTest.java b/core/data/src/test/java/uk/gov/gchq/gaffer/data/element/function/FunctionTest.java\nindex dc3a022bd2..4dfa5ed9c6 100644\n--- a/core/data/src/test/java/uk/gov/gchq/gaffer/data/element/function/FunctionTest.java\n+++ b/core/data/src/test/java/uk/gov/gchq/gaffer/data/element/function/FunctionTest.java\n\n@@ -32,6 +32,12 @@ import static org.junit.jupiter.api.Assertions.assertNotEquals;\n import static org.junit.jupiter.api.Assertions.assertNotNull;\n import static org.junit.jupiter.api.Assertions.assertTrue;\n \n+/**\n+ * This class is copied from Koryphe and updated to run JUnit5 tests in Gaffer whilst Gaffer and Korphe are using\n+ * different versions of JUnit\n+ *\n+ * @see uk.gov.gchq.koryphe.function.FunctionTest\n+ */\n public abstract class FunctionTest {\n \n     private static final ObjectMapper MAPPER = createObjectMapper();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkyNzY0Mg==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r427927642", "bodyText": "Is this failing at the moment?", "author": "d47853", "createdAt": "2020-05-20T11:11:46Z", "path": "library/flink-library/src/test/java/uk/gov/gchq/gaffer/flink/operation/FlinkTest.java", "diffHunk": "@@ -122,7 +122,7 @@ public static Store createStore() {\n \n     public static void verifyElements(final Graph graph) throws OperationException, InterruptedException {\n         // Wait for the elements to be ingested.\n-        Thread.sleep(2000);\n+        Thread.sleep(3000);", "originalCommit": "e05db011d4205768d89c91d797ebfd4242a08ed1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzIyNTk1NA==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r433225954", "bodyText": "I think it originally failed once on the pipeline and intermittently on my personal machine (maybe it is slightly slower in some test runs) so the assertion runs too early and fails the test or breaks pipeline\nI can change it back to 2000?", "author": "macenturalxl1", "createdAt": "2020-06-01T13:14:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkyNzY0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMzgxMzA0Mg==", "url": "https://github.com/gchq/Gaffer/pull/2275#discussion_r433813042", "bodyText": "No it's fine just might be worth noting if it's unreliable.", "author": "d47853", "createdAt": "2020-06-02T11:43:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkyNzY0Mg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "cbe30dcb499c608e489e8adbb659533a3af647c3", "url": "https://github.com/gchq/Gaffer/commit/cbe30dcb499c608e489e8adbb659533a3af647c3", "message": "Reverted assertJsonEquals name change", "committedDate": "2020-05-29T09:24:19Z", "type": "commit"}, {"oid": "b73511bf6f92201df0b9a75714d304242e3e12e9", "url": "https://github.com/gchq/Gaffer/commit/b73511bf6f92201df0b9a75714d304242e3e12e9", "message": "Added docs for FunctionTest JUnit5 tests", "committedDate": "2020-05-29T10:54:33Z", "type": "commit"}, {"oid": "e12e2d0b0160d7fedf1bf18d13e107564869feb8", "url": "https://github.com/gchq/Gaffer/commit/e12e2d0b0160d7fedf1bf18d13e107564869feb8", "message": "Solution to FunctionTest abstraction errors", "committedDate": "2020-05-31T21:38:51Z", "type": "commit"}, {"oid": "b11e50bc34fc8f07a81ebf8850bbff5ffd9cafd8", "url": "https://github.com/gchq/Gaffer/commit/b11e50bc34fc8f07a81ebf8850bbff5ffd9cafd8", "message": "Merge branch 'develop' of github.com:gchq/Gaffer into gh-2270-JUnit5-upgrade", "committedDate": "2020-05-31T22:11:15Z", "type": "commit"}, {"oid": "5c6823bcd0394387eccdd38e7f1eaab4b6cc4155", "url": "https://github.com/gchq/Gaffer/commit/5c6823bcd0394387eccdd38e7f1eaab4b6cc4155", "message": "Solution to FunctionTest abstraction errors", "committedDate": "2020-05-31T22:14:13Z", "type": "commit"}]}