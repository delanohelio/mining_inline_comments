{"pr_number": 7744, "pr_title": "[broker] Make resetting cursor in REST API asynchronous", "pr_createdAt": "2020-08-04T09:52:21Z", "pr_url": "https://github.com/apache/pulsar/pull/7744", "timeline": [{"oid": "11e6e3f17a519101ece6d35090bd37b143185c70", "url": "https://github.com/apache/pulsar/commit/11e6e3f17a519101ece6d35090bd37b143185c70", "message": "Make resetting cursor in REST API asynchronous", "committedDate": "2020-08-05T00:58:08Z", "type": "commit"}, {"oid": "5fe7e5fc2937d4b8baa99d798083b89974072819", "url": "https://github.com/apache/pulsar/commit/5fe7e5fc2937d4b8baa99d798083b89974072819", "message": "Enable automatic topic creation", "committedDate": "2020-08-05T00:58:09Z", "type": "commit"}, {"oid": "5fe7e5fc2937d4b8baa99d798083b89974072819", "url": "https://github.com/apache/pulsar/commit/5fe7e5fc2937d4b8baa99d798083b89974072819", "message": "Enable automatic topic creation", "committedDate": "2020-08-05T00:58:09Z", "type": "forcePushed"}, {"oid": "0d8f2397f36ecbaf5661c772d2c4a1e154c899cf", "url": "https://github.com/apache/pulsar/commit/0d8f2397f36ecbaf5661c772d2c4a1e154c899cf", "message": "Get cause of CompletionException", "committedDate": "2020-08-05T05:01:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTY4NjI5Mw==", "url": "https://github.com/apache/pulsar/pull/7744#discussion_r465686293", "bodyText": "This test fails if allowAutoTopicCreation is false.\nWe are testing if the subscription creation is successful here. However, if allowAutoTopicCreation is false, the topic cannot be created and the subscription creation should also fail.\n\n  \n    \n      pulsar/pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/PersistentTopicsBase.java\n    \n    \n        Lines 1787 to 1789\n      in\n      8061c54\n    \n    \n    \n    \n\n        \n          \n           boolean isAllowAutoTopicCreation = pulsar().getConfiguration().isAllowAutoTopicCreation(); \n        \n\n        \n          \n           PersistentTopic topic = (PersistentTopic) pulsar().getBrokerService() \n        \n\n        \n          \n                   .getTopic(topicName.toString(), isAllowAutoTopicCreation).thenApply(Optional::get).join(); \n        \n    \n  \n\n\nI think it's a mistake to set allowAutoTopicCreation to false here. Previously this test passed because the REST API was not able to return the error response correctly.", "author": "massakam", "createdAt": "2020-08-05T12:22:03Z", "path": "pulsar-broker/src/test/java/org/apache/pulsar/broker/admin/PersistentTopicsTest.java", "diffHunk": "@@ -232,7 +232,6 @@ public void testTerminatePartitionedTopic() {\n \n     @Test\n     public void testNonPartitionedTopics() {\n-        pulsar.getConfiguration().setAllowAutoTopicCreation(false);", "originalCommit": "0d8f2397f36ecbaf5661c772d2c4a1e154c899cf", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}