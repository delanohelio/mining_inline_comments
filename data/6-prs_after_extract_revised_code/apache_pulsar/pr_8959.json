{"pr_number": 8959, "pr_title": "Fix the metadata setup compatibility issue", "pr_createdAt": "2020-12-15T06:17:22Z", "pr_url": "https://github.com/apache/pulsar/pull/8959", "timeline": [{"oid": "c2ff9fecaa86f4961249fffb463984cacc6dcaa0", "url": "https://github.com/apache/pulsar/commit/c2ff9fecaa86f4961249fffb463984cacc6dcaa0", "message": "Fix the metadata setup compatibility issue\n---\n\n*Motivation*\n\nFor keeping the compatibility of the setup metadata command.\nWe should avoid delete the existing arguments. If we need to\nchange it, it's better to keep the old arguments and mark it\ndeprecate and hide it.", "committedDate": "2020-12-15T06:11:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzIzNDUxNA==", "url": "https://github.com/apache/pulsar/pull/8959#discussion_r543234514", "bodyText": "This annotation is not really meaningful here by itself, can we add a comment?", "author": "eolivelli", "createdAt": "2020-12-15T10:42:16Z", "path": "pulsar-broker/src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java", "diffHunk": "@@ -115,6 +115,13 @@\n                 description = \"The metadata service URI of the existing BookKeeper cluster that you want to use\")\n         private String existingBkMetadataServiceUri;\n ", "originalCommit": "c2ff9fecaa86f4961249fffb463984cacc6dcaa0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NDA1MDU5MA==", "url": "https://github.com/apache/pulsar/pull/8959#discussion_r544050590", "bodyText": "Which annotation? Do you mean @Deprecated?", "author": "zymap", "createdAt": "2020-12-16T07:01:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzIzNDUxNA=="}], "type": "inlineReview", "revised_code": {"commit": "07c3f787f465a43ef9a999425157000b9bc0f8cf", "chunk": "diff --git a/pulsar-broker/src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java b/pulsar-broker/src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java\nindex fa033eef3eb..c7e1531521d 100644\n--- a/pulsar-broker/src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java\n+++ b/pulsar-broker/src/main/java/org/apache/pulsar/PulsarClusterMetadataSetup.java\n\n@@ -115,6 +115,8 @@ public class PulsarClusterMetadataSetup {\n                 description = \"The metadata service URI of the existing BookKeeper cluster that you want to use\")\n         private String existingBkMetadataServiceUri;\n \n+        // Hide and marked as deprecated this flag because we use the new name '--existing-bk-metadata-service-uri' to\n+        // pass the service url. For compatibility of the command, we should keep both to avoid the exceptions.\n         @Deprecated\n         @Parameter(names = {\n             \"--bookkeeper-metadata-service-uri\"},\n"}}, {"oid": "07c3f787f465a43ef9a999425157000b9bc0f8cf", "url": "https://github.com/apache/pulsar/commit/07c3f787f465a43ef9a999425157000b9bc0f8cf", "message": "Add unit test for this", "committedDate": "2020-12-16T07:13:46Z", "type": "commit"}]}