{"pr_number": 6951, "pr_title": "[pulsar-broker] Fix response when set offload policies", "pr_createdAt": "2020-05-13T09:46:24Z", "pr_url": "https://github.com/apache/pulsar/pull/6951", "timeline": [{"oid": "7497dc8656557b4a8957d5f533de87a7e28ac629", "url": "https://github.com/apache/pulsar/commit/7497dc8656557b4a8957d5f533de87a7e28ac629", "message": "Fix response when set offload policies.", "committedDate": "2020-05-13T09:44:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyOTc3OA==", "url": "https://github.com/apache/pulsar/pull/6951#discussion_r424829778", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        globalZk().setData(path, jsonMapper().writeValueAsBytes(policies), nodeStat.getVersion(),\n          \n          \n            \n                        globalZk().setData(path, updatedOffloadPolicies, nodeStat.getVersion(),", "author": "codelipenghui", "createdAt": "2020-05-14T02:04:32Z", "path": "pulsar-broker/src/main/java/org/apache/pulsar/broker/admin/impl/NamespacesBase.java", "diffHunk": "@@ -2611,10 +2611,14 @@ protected void internalSetOffloadPolicies(AsyncResponse asyncResponse, OffloadPo\n             }\n \n             policies.offload_policies = offloadPolicies;\n+            String updatedOffloadPolicies = jsonMapper().writeValueAsString(policies.offload_policies);\n             globalZk().setData(path, jsonMapper().writeValueAsBytes(policies), nodeStat.getVersion(),", "originalCommit": "7497dc8656557b4a8957d5f533de87a7e28ac629", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDg0MDk5OA==", "url": "https://github.com/apache/pulsar/pull/6951#discussion_r424840998", "bodyText": "Thanks, the variable updatedOffloadPolicies here is just used to print logs and byte [] policies is written to znode.", "author": "murong00", "createdAt": "2020-05-14T02:49:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyOTc3OA=="}], "type": "inlineReview", "revised_code": null}]}