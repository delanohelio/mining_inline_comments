{"pr_number": 577, "pr_title": "Better null handling in ChunkResolver", "pr_createdAt": "2020-12-29T18:07:59Z", "pr_url": "https://github.com/HubSpot/jinjava/pull/577", "timeline": [{"oid": "99fa4fb534d0b2a9e11b3e8ed3773c803ae2ee28", "url": "https://github.com/HubSpot/jinjava/commit/99fa4fb534d0b2a9e11b3e8ed3773c803ae2ee28", "message": "It returns an empty Jinjava string for null values", "committedDate": "2020-12-29T15:27:27Z", "type": "commit"}, {"oid": "ab1ceeb803515552eb2bca2841ce1a163ac50828", "url": "https://github.com/HubSpot/jinjava/commit/ab1ceeb803515552eb2bca2841ce1a163ac50828", "message": "Merge branch 'master' of github.com:HubSpot/jinjava into chunk-resolver-fix", "committedDate": "2020-12-29T17:21:54Z", "type": "commit"}, {"oid": "aa4eef9a2cc4e9ba8d85df975b8820430a74e4a5", "url": "https://github.com/HubSpot/jinjava/commit/aa4eef9a2cc4e9ba8d85df975b8820430a74e4a5", "message": "Treat null values as null while resolving", "committedDate": "2020-12-29T17:57:09Z", "type": "commit"}, {"oid": "d6e2f752f8fa7dd1e204536fa9f3f79c554b6230", "url": "https://github.com/HubSpot/jinjava/commit/d6e2f752f8fa7dd1e204536fa9f3f79c554b6230", "message": "Use constant for \"null\"", "committedDate": "2020-12-29T17:59:58Z", "type": "commit"}, {"oid": "ba2fcabf8215a79b95153afea2a2fba2459e071f", "url": "https://github.com/HubSpot/jinjava/commit/ba2fcabf8215a79b95153afea2a2fba2459e071f", "message": "Use constant for jinjava empty string", "committedDate": "2020-12-29T18:04:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc5OTc3NA==", "url": "https://github.com/HubSpot/jinjava/pull/577#discussion_r549799774", "bodyText": "This should be the only place where null needs to be swapped out for the empty string as this is the last step where the object must be resolved to a string. (That string could be presented in the final output of the render)", "author": "jasmith-hs", "createdAt": "2020-12-29T18:11:08Z", "path": "src/main/java/com/hubspot/jinjava/util/ChunkResolver.java", "diffHunk": "@@ -105,7 +107,12 @@ public String resolveChunks() {\n       .getThrowInterpreterErrors();\n     try {\n       interpreter.getContext().setThrowInterpreterErrors(true);\n-      return String.join(\"\", getChunk(null));\n+      String expression = String.join(\"\", getChunk(null));\n+      if (JINJAVA_NULL.equals(expression)) {\n+        // Resolved value of null as a string is ''.\n+        return JINJAVA_EMPTY_STRING;", "originalCommit": "ba2fcabf8215a79b95153afea2a2fba2459e071f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDIzNDkxOA==", "url": "https://github.com/HubSpot/jinjava/pull/577#discussion_r550234918", "bodyText": "See https://private.hubteam.com/opengrok/xref/all/github.com-HubSpot-jinjava%23master/src/main/java/com/hubspot/jinjava/lib/expression/DefaultExpressionStrategy.java#22 where null is replaced with empty when converting to a string.", "author": "jasmith-hs", "createdAt": "2020-12-30T15:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTc5OTc3NA=="}], "type": "inlineReview", "revised_code": null}]}