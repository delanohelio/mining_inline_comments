{"pr_number": 2345, "pr_title": "[#2133] Improve message mapping API", "pr_createdAt": "2020-12-07T00:54:25Z", "pr_url": "https://github.com/eclipse/hono/pull/2345", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5OTM3MA==", "url": "https://github.com/eclipse/hono/pull/2345#discussion_r539999370", "bodyText": "why do we need to introduce this additional case that the client needs to check for? Can't we simply do the same as for a 2xx != 200 status code, i.e. completing the future with a mapped message containing the original device payload and target address? That way the client wouldn't need to handle a null result specifically, would it?", "author": "sophokles73", "createdAt": "2020-12-10T09:14:49Z", "path": "adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/MessageMapping.java", "diffHunk": "@@ -31,15 +31,23 @@\n \n     /**\n      * Maps a message uploaded by a device.\n+     * <p>\n+     * If a mapping service is not configured for a gateway or a protocol adapter, this method returns\n+     * a successful future containing a {@code null} value. If a mapping service is configured for a gateway", "originalCommit": "750a0ea5dde9fe902e2852b151cba892438c7883", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDc1NjA4MA==", "url": "https://github.com/eclipse/hono/pull/2345#discussion_r540756080", "bodyText": "make sense. i was interpreting this requirement you stated in the issue\n\nNo mapping service is configured for the gateway -> Nothing to be done at all\n\nI interpreted doing nothing to mean returning null as a way to inform the client that nothing has been done. but will fix", "author": "Alfusainey", "createdAt": "2020-12-11T07:57:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk5OTM3MA=="}], "type": "inlineReview", "revised_code": {"commit": "d60c71cd1809466170f74a931d4f4abfc12efd18", "chunk": "diff --git a/adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/MessageMapping.java b/adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/MessageMapping.java\nindex 0f017c094..ec0f293d7 100644\n--- a/adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/MessageMapping.java\n+++ b/adapters/mqtt-vertx-base/src/main/java/org/eclipse/hono/adapter/mqtt/MessageMapping.java\n\n@@ -33,11 +33,11 @@ public interface MessageMapping<T extends ExecutionContext> {\n      * Maps a message uploaded by a device.\n      * <p>\n      * If a mapping service is not configured for a gateway or a protocol adapter, this method returns\n-     * a successful future containing a {@code null} value. If a mapping service is configured for a gateway\n+     * a successful future containing the original device payload and target address. If a mapping service is configured for a gateway\n      * or a protocol adapter and the mapping service returns a 200 OK HTTP status code, then this method returns a successful\n      * future containing the mapped payload.\n      * <p>\n-     * For all other 2XX HTTP status code, this method returns a mapped message containing the original device payload and \n+     * For all other 2XX HTTP status codes, this method returns a mapped message containing the original device payload and \n      * target address. In all other cases, this method returns a failed future with a {@link org.eclipse.hono.client.ServiceInvocationException}.\n      *\n      * @param ctx              The context in which the message has been uploaded.\n"}}, {"oid": "d60c71cd1809466170f74a931d4f4abfc12efd18", "url": "https://github.com/eclipse/hono/commit/d60c71cd1809466170f74a931d4f4abfc12efd18", "message": "[#2133] Improve message mapping API\n\nSigned-off-by: Alfusainey Jallow <alf.jallow@gmail.com>", "committedDate": "2020-12-15T00:11:55Z", "type": "commit"}, {"oid": "d60c71cd1809466170f74a931d4f4abfc12efd18", "url": "https://github.com/eclipse/hono/commit/d60c71cd1809466170f74a931d4f4abfc12efd18", "message": "[#2133] Improve message mapping API\n\nSigned-off-by: Alfusainey Jallow <alf.jallow@gmail.com>", "committedDate": "2020-12-15T00:11:55Z", "type": "forcePushed"}]}