{"pr_number": 2269, "pr_title": "Remove obsolete code", "pr_createdAt": "2020-10-27T14:33:21Z", "pr_url": "https://github.com/eclipse/hono/pull/2269", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2NDAwMg==", "url": "https://github.com/eclipse/hono/pull/2269#discussion_r512764002", "bodyText": "It seems to me the KEY_CONNECTION_ID constant itself and the other remaining places where it is used can be removed as well. As far as I see it, the id was used in connection with the long removed Hono messaging component (?).", "author": "calohmn", "createdAt": "2020-10-27T14:56:34Z", "path": "core/src/main/java/org/eclipse/hono/util/Constants.java", "diffHunk": "@@ -309,17 +295,6 @@ public static void copyProperties(final ProtonConnection source, final ProtonLin\n         target.attachments().set(Constants.KEY_CONNECTION_ID, String.class, getConnectionId(source));\n     }\n \n-    /**\n-     * Gets the (surrogate) identifier of the AMQP connection that a link is part of.\n-     *\n-     * @param link The link to determine the connection id for.\n-     * @return The identifier retrieved from the link's <em>attachment</em> using key {@link #KEY_CONNECTION_ID}\n-     *         or {@code null} if the attachments do not contain a value for that a key.\n-     */\n-    public static String getConnectionId(final ProtonLink<?> link) {\n-        return link.attachments().get(KEY_CONNECTION_ID, String.class);", "originalCommit": "0f7560b5982ca14b8566eaccb9aab757cfb26361", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc5NzY4MQ==", "url": "https://github.com/eclipse/hono/pull/2269#discussion_r512797681", "bodyText": "As I understood, KEY_CONNECTION_ID is being used by copyProperties(...) and getConnectionId(final ProtonConnection connection). And copyProperties(...) is in use in AmqpServiceBase and SimpleAuthenticationServer.", "author": "kaniyan", "createdAt": "2020-10-27T15:36:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2NDAwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjgzNDgwNQ==", "url": "https://github.com/eclipse/hono/pull/2269#discussion_r512834805", "bodyText": "Yes, but the ID is only ever set in the attachments. Except for the copyProperties method, the ID is not read (see usage of getConnectionId). See also the long removed HonoMessaging class.", "author": "calohmn", "createdAt": "2020-10-27T16:18:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2NDAwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzM2MDgxNQ==", "url": "https://github.com/eclipse/hono/pull/2269#discussion_r513360815", "bodyText": "Good point. I have now removed the obsolete code regarding connection-id which is being set in AMQP connection attachments.", "author": "kaniyan", "createdAt": "2020-10-28T11:13:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMjc2NDAwMg=="}], "type": "inlineReview", "revised_code": {"commit": "c36eef59f60e682f3dad1f42198880f95a5cd775", "chunk": "diff --git a/core/src/main/java/org/eclipse/hono/util/Constants.java b/core/src/main/java/org/eclipse/hono/util/Constants.java\nindex 29e5236da..1f06f5704 100644\n--- a/core/src/main/java/org/eclipse/hono/util/Constants.java\n+++ b/core/src/main/java/org/eclipse/hono/util/Constants.java\n\n@@ -278,32 +272,4 @@ public final class Constants {\n         attachments.set(KEY_CLIENT_PRINCIPAL, HonoUser.class, principal);\n     }\n \n-    /**\n-     * Copies properties from a connection's attachments to a link's attachments.\n-     * <p>\n-     * The properties copied are\n-     * <ul>\n-     * <li>{@link #KEY_CONNECTION_ID}</li>\n-     * </ul>\n-     *\n-     * @param source The connection.\n-     * @param target The link.\n-     */\n-    public static void copyProperties(final ProtonConnection source, final ProtonLink<?> target) {\n-        Objects.requireNonNull(source);\n-        Objects.requireNonNull(target);\n-        target.attachments().set(Constants.KEY_CONNECTION_ID, String.class, getConnectionId(source));\n-    }\n-\n-    /**\n-     * Gets the (surrogate) identifier of an AMQP connection.\n-     *\n-     * @param connection The connection to determine the connection id for.\n-     * @return The identifier retrieved from the connection's <em>attachments</em> using key {@link #KEY_CONNECTION_ID}\n-     *         or {@code null} if the attachments do not contain a value for that a key.\n-     */\n-    public static String getConnectionId(final ProtonConnection connection) {\n-        return connection.attachments().get(KEY_CONNECTION_ID, String.class);\n-    }\n-\n }\n"}}, {"oid": "d9f9039f13ec366941be96062e5f05b63d7b87a9", "url": "https://github.com/eclipse/hono/commit/d9f9039f13ec366941be96062e5f05b63d7b87a9", "message": "Remove obsolete constants and methods\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-10-28T10:57:28Z", "type": "commit"}, {"oid": "c36eef59f60e682f3dad1f42198880f95a5cd775", "url": "https://github.com/eclipse/hono/commit/c36eef59f60e682f3dad1f42198880f95a5cd775", "message": "Remove obsolete code regarding connection-id set in AMQP connection attachments\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-10-28T11:02:45Z", "type": "commit"}, {"oid": "c36eef59f60e682f3dad1f42198880f95a5cd775", "url": "https://github.com/eclipse/hono/commit/c36eef59f60e682f3dad1f42198880f95a5cd775", "message": "Remove obsolete code regarding connection-id set in AMQP connection attachments\n\nSigned-off-by: Kartheeswaran Kalidass <kartheeswaran.kalidass@bosch.io>", "committedDate": "2020-10-28T11:02:45Z", "type": "forcePushed"}]}