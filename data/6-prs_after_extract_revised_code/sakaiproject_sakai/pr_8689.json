{"pr_number": 8689, "pr_title": "SAK-43941 Profile: name pronunciation not saved", "pr_createdAt": "2020-10-14T12:22:39Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8689", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5OTMxMA==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r504699310", "bodyText": "What about this?\nString errorMessage = userProfile.getPhoneticPronunciation() == null ? \"error.profile.save.phonetic.alert\" : \"error.profile.save.info.failed\";\nformFeedback.setDefaultModel(new ResourceModel(errorMessage));", "author": "mpellicer", "createdAt": "2020-10-14T13:57:04Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -203,7 +203,13 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                     }\n \n                 } else {\n-                    formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n+                    UserProfile userProfile = (UserProfile) form.getModelObject();\n+                    \n+                    if (userProfile.getPhoneticPronunciation()==null) {\n+                        formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.phonetic.alert\"));", "originalCommit": "e06aff176a3690ec999c9e96d5f55ea893d44b3a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "chunk": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 64ccac9bb8..592b8133da 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n\n@@ -203,13 +203,8 @@ public class MyNamePronunciationEdit extends Panel {\n                     }\n \n                 } else {\n-                    UserProfile userProfile = (UserProfile) form.getModelObject();\n+                    formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n                     \n-                    if (userProfile.getPhoneticPronunciation()==null) {\n-                        formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.phonetic.alert\"));\n-                    } else {\n-                        formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    }\n                     formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDY5OTU1OA==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r504699558", "bodyText": "userProfile.getPhoneticPronunciation() == null\nSpaces in the comparison.", "author": "mpellicer", "createdAt": "2020-10-14T13:57:21Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -247,6 +253,10 @@ private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n \n+        if (userProfile.getPhoneticPronunciation()==null) {", "originalCommit": "e06aff176a3690ec999c9e96d5f55ea893d44b3a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "chunk": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 64ccac9bb8..592b8133da 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n\n@@ -252,10 +247,6 @@ public class MyNamePronunciationEdit extends Panel {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-\n-        if (userProfile.getPhoneticPronunciation()==null) {\n-        \treturn false;\n-        } \n         \n         //get userId from the UserProfile (because admin could be editing), then get existing SakaiPerson for that userId\n         String userId = userProfile.getUserUuid();\n"}}, {"oid": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "url": "https://github.com/sakaiproject/sakai/commit/02ff147cf48d62ef5f845348e249599bb4f0f0a8", "message": "SAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-15T12:00:38Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjEyMTMxMg==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r506121312", "bodyText": "Revert this change please.", "author": "mpellicer", "createdAt": "2020-10-16T07:27:55Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -204,6 +204,7 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n+                    ", "originalCommit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "chunk": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133da..1120b6aae1 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n\n@@ -204,7 +204,6 @@ public class MyNamePronunciationEdit extends Panel {\n \n                 } else {\n                     formFeedback.setDefaultModel(new ResourceModel(\"error.profile.save.info.failed\"));\n-                    \n                     formFeedback.add(new AttributeModifier(\"class\", true, new Model<>(\"save-failed-error\")));\n                     target.add(formFeedback);\n                 }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjEyMTQyNA==", "url": "https://github.com/sakaiproject/sakai/pull/8689#discussion_r506121424", "bodyText": "Revert this change please.", "author": "mpellicer", "createdAt": "2020-10-16T07:28:00Z", "path": "profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java", "diffHunk": "@@ -246,7 +247,7 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-\n+        ", "originalCommit": "02ff147cf48d62ef5f845348e249599bb4f0f0a8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "chunk": "diff --git a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\nindex 592b8133da..1120b6aae1 100644\n--- a/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n+++ b/profile2/tool/src/java/org/sakaiproject/profile2/tool/pages/panels/MyNamePronunciationEdit.java\n\n@@ -247,7 +246,7 @@ public class MyNamePronunciationEdit extends Panel {\n     private boolean save(Form form) {\n         //get the backing model\n         UserProfile userProfile = (UserProfile) form.getModelObject();\n-        \n+\n         //get userId from the UserProfile (because admin could be editing), then get existing SakaiPerson for that userId\n         String userId = userProfile.getUserUuid();\n         SakaiPerson sakaiPerson = sakaiProxy.getSakaiPerson(userId);\n"}}, {"oid": "c7df64fb0754cc7a94dce79691681714ac30f4e4", "url": "https://github.com/sakaiproject/sakai/commit/c7df64fb0754cc7a94dce79691681714ac30f4e4", "message": "Revert \"SAK-43941 Profile: name pronunciation not saved\"\n\nThis reverts commit 02ff147cf48d62ef5f845348e249599bb4f0f0a8.\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-16T07:35:08Z", "type": "forcePushed"}, {"oid": "8c13b0eaaaa7a9141fbf89bc881e26b250238085", "url": "https://github.com/sakaiproject/sakai/commit/8c13b0eaaaa7a9141fbf89bc881e26b250238085", "message": "SAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nRevert \"SAK-43941 Profile: name pronunciation not saved\"\n\nThis reverts commit 02ff147cf48d62ef5f845348e249599bb4f0f0a8.\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-16T07:36:05Z", "type": "commit"}, {"oid": "8c13b0eaaaa7a9141fbf89bc881e26b250238085", "url": "https://github.com/sakaiproject/sakai/commit/8c13b0eaaaa7a9141fbf89bc881e26b250238085", "message": "SAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nSAK-43941 Profile: name pronunciation not saved\n\n\nRevert \"SAK-43941 Profile: name pronunciation not saved\"\n\nThis reverts commit 02ff147cf48d62ef5f845348e249599bb4f0f0a8.\n\nSAK-43941 Profile: name pronunciation not saved", "committedDate": "2020-10-16T07:36:05Z", "type": "forcePushed"}]}