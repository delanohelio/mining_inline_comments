{"pr_number": 8515, "pr_title": "SAK-27821 include category averages in export", "pr_createdAt": "2020-09-02T19:36:42Z", "pr_url": "https://github.com/sakaiproject/sakai/pull/8515", "timeline": [{"oid": "18b006805f809beafe4bb9ca7371040f62af4c09", "url": "https://github.com/sakaiproject/sakai/commit/18b006805f809beafe4bb9ca7371040f62af4c09", "message": "SAK-27821 include category averages in export", "committedDate": "2020-09-02T17:54:05Z", "type": "commit"}, {"oid": "43c8ca13da8947001dd93d69dc55379634fa38b7", "url": "https://github.com/sakaiproject/sakai/commit/43c8ca13da8947001dd93d69dc55379634fa38b7", "message": "SAK-27821 more work on it", "committedDate": "2020-09-02T19:35:40Z", "type": "commit"}, {"oid": "fe1266b361b3d4f7480d0a943ed4ee200f47a9d2", "url": "https://github.com/sakaiproject/sakai/commit/fe1266b361b3d4f7480d0a943ed4ee200f47a9d2", "message": "SAK-27821 better formatting on cat percentage", "committedDate": "2020-09-02T19:48:20Z", "type": "commit"}, {"oid": "21cc07a9aab235657fead17a20eea90ed395beb3", "url": "https://github.com/sakaiproject/sakai/commit/21cc07a9aab235657fead17a20eea90ed395beb3", "message": "SAK-27821 only display weight if using weights", "committedDate": "2020-09-02T20:03:21Z", "type": "commit"}, {"oid": "f405dbf84eef5270a3cdcaa499a1c57c78305879", "url": "https://github.com/sakaiproject/sakai/commit/f405dbf84eef5270a3cdcaa499a1c57c78305879", "message": "SAK-27821 dont display option if categories are not enabled", "committedDate": "2020-09-02T20:14:29Z", "type": "commit"}, {"oid": "1e02c8f146466e7001e36d515ed97d34ec305c93", "url": "https://github.com/sakaiproject/sakai/commit/1e02c8f146466e7001e36d515ed97d34ec305c93", "message": "SAK-27821 removed unused imports", "committedDate": "2020-09-02T20:19:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyODA3NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8515#discussion_r482528075", "bodyText": "Maybe this should be moved to after line 458 as it's not used", "author": "ern", "createdAt": "2020-09-02T22:15:25Z", "path": "gradebookng/tool/src/java/org/sakaiproject/gradebookng/tool/panels/importExport/ExportPanel.java", "diffHunk": "@@ -391,9 +428,14 @@ private File buildFile(final boolean isCustomExport) {\n \t\t\t\t\tif (isCustomExport && this.includeSectionMembership) {\n \t\t\t\t\t\tline.add((userSections.size() > 0) ? userSections.get(0) : getString(\"sections.label.none\"));\n \t\t\t\t\t}\n-\t\t\t\t\tif (!isCustomExport || this.includeGradeItemScores || this.includeGradeItemComments) {\n-\t\t\t\t\t\tassignments.forEach(assignment -> {\n-\t\t\t\t\t\t\tfinal GbGradeInfo gradeInfo = studentGradeInfo.getGrades().get(assignment.getId());\n+\t\t\t\t\tif (!isCustomExport || this.includeGradeItemScores || this.includeGradeItemComments || this.includeCategoryAverages) {\n+\t\t\t\t\t\tfinal Map<Long, Double> categoryAverages = studentGradeInfo.getCategoryAverages();", "originalCommit": "1e02c8f146466e7001e36d515ed97d34ec305c93", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjYwNjc1NQ==", "url": "https://github.com/sakaiproject/sakai/pull/8515#discussion_r482606755", "bodyText": "yes but then it would be in the assignment loop!", "author": "ottenhoff", "createdAt": "2020-09-02T23:57:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjUyODA3NQ=="}], "type": "inlineReview", "revised_code": null}]}