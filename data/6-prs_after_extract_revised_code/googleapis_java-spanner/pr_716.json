{"pr_number": 716, "pr_title": "feat: introduce TransactionOptions and UpdateOptions", "pr_createdAt": "2020-12-11T10:40:32Z", "pr_url": "https://github.com/googleapis/java-spanner/pull/716", "timeline": [{"oid": "b56892d50637a545456fe4217557ecbb9fd56a50", "url": "https://github.com/googleapis/java-spanner/commit/b56892d50637a545456fe4217557ecbb9fd56a50", "message": "feat: introduce TransactionOptions and UpdateOptions\n\nAdds TransactionOptions and UpdateOptions for read/write transactions and statements.\nThese can be used in the future to specify options to affect how transactions and\nstatements will be executed.", "committedDate": "2020-12-11T10:36:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNDU0OQ==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541134549", "bodyText": "Can we add test for this?", "author": "mayurkale22", "createdAt": "2020-12-11T18:12:01Z", "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/Options.java", "diffHunk": "@@ -287,6 +294,26 @@ static Options fromQueryOptions(QueryOption... options) {\n     return readOptions;\n   }\n \n+  static Options fromUpdateOptions(UpdateOption... options) {", "originalCommit": "b56892d50637a545456fe4217557ecbb9fd56a50", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIzMTM0OA==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541231348", "bodyText": "I've added a couple of (placeholder) tests for it. As this implementation does not contain any actual UpdateOption yet, the test case cannot check very much.", "author": "olavloite", "createdAt": "2020-12-11T20:06:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNDU0OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNDY1MA==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541134650", "bodyText": "Same here.", "author": "mayurkale22", "createdAt": "2020-12-11T18:12:13Z", "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/Options.java", "diffHunk": "@@ -287,6 +294,26 @@ static Options fromQueryOptions(QueryOption... options) {\n     return readOptions;\n   }\n \n+  static Options fromUpdateOptions(UpdateOption... options) {\n+    Options updateOptions = new Options();\n+    for (UpdateOption option : options) {\n+      if (option instanceof InternalOption) {\n+        ((InternalOption) option).appendToOptions(updateOptions);\n+      }\n+    }\n+    return updateOptions;\n+  }\n+\n+  static Options fromTransactionOptions(TransactionOption... options) {", "originalCommit": "b56892d50637a545456fe4217557ecbb9fd56a50", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIzMTUzNw==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541231537", "bodyText": "Done.", "author": "olavloite", "createdAt": "2020-12-11T20:06:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNDY1MA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNTkxMA==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541135910", "bodyText": "Can this be just TransactionOption instead of Options?", "author": "mayurkale22", "createdAt": "2020-12-11T18:14:29Z", "path": "google-cloud-spanner/src/main/java/com/google/cloud/spanner/SessionImpl.java", "diffHunk": "@@ -340,10 +343,11 @@ public void run() {\n     return res;\n   }\n \n-  TransactionContextImpl newTransaction() {\n+  TransactionContextImpl newTransaction(Options options) {", "originalCommit": "b56892d50637a545456fe4217557ecbb9fd56a50", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIzMzY2Nw==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541233667", "bodyText": "That would be possible (assuming you mean TransactionOption...), but I would prefer to keep this as the Options object. This makes it a required argument, making it less likely to be missed by accident as it will cause a compile error if you don't supply an Options object. If we change it to TransactionOption... it would not cause a compile time error if we forget to pass in the options somewhere.", "author": "olavloite", "createdAt": "2020-12-11T20:08:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNTkxMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTIzNDQ3MA==", "url": "https://github.com/googleapis/java-spanner/pull/716#discussion_r541234470", "bodyText": "Hmm, makes sense.", "author": "mayurkale22", "createdAt": "2020-12-11T20:09:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTEzNTkxMA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "ae2cf93393f4f254c973b27149bcf5353214b7df", "url": "https://github.com/googleapis/java-spanner/commit/ae2cf93393f4f254c973b27149bcf5353214b7df", "message": "test: add options tests", "committedDate": "2020-12-11T20:05:03Z", "type": "commit"}]}