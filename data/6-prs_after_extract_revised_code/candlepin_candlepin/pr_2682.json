{"pr_number": 2682, "pr_title": "ENT-1859: Port EnvironmentDTO to openapi spec", "pr_createdAt": "2020-04-17T09:24:03Z", "pr_url": "https://github.com/candlepin/candlepin/pull/2682", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDIyMDQ5Mg==", "url": "https://github.com/candlepin/candlepin/pull/2682#discussion_r410220492", "bodyText": "Nitpick: No need for Arrays.asList here if only 1 element is being added, you can create empty HashSet and then add it", "author": "nikosmoum", "createdAt": "2020-04-17T13:26:15Z", "path": "server/src/test/java/org/candlepin/dto/api/v1/ConsumerDTOTest.java", "diffHunk": "@@ -92,6 +92,22 @@ public ConsumerDTOTest() {\n \n         NestedOwnerDTO owner = new NestedOwnerDTO().id(\"OwnerId\").displayName(\"Name\").key(\"12345\");\n \n+        ContentDTO cDTO = new ContentDTO()\n+            .id(\"ContentId\")\n+            .name(\"ContentName\")\n+            .modifiedProductIds(new HashSet<>(Arrays.asList(\"ID1\", \"ID2\")));\n+\n+        Set<EnvironmentContentDTO> envContentDTO = new HashSet<>(Arrays.asList(new EnvironmentContentDTO()", "originalCommit": "a90f0addd888d84307c8edc083b076b62f8ab325", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM2OTk3NA==", "url": "https://github.com/candlepin/candlepin/pull/2682#discussion_r410369974", "bodyText": "There's also Collections.singleton and Util.asSet", "author": "Ceiu", "createdAt": "2020-04-17T17:34:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDIyMDQ5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA5OTgzMQ==", "url": "https://github.com/candlepin/candlepin/pull/2682#discussion_r411099831", "bodyText": "Done.", "author": "wolfdale", "createdAt": "2020-04-20T05:20:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDIyMDQ5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "a00a36345c1ccb67d1428190ee783b61d83c6511", "chunk": "diff --git a/server/src/test/java/org/candlepin/dto/api/v1/ConsumerDTOTest.java b/server/src/test/java/org/candlepin/dto/api/v1/ConsumerDTOTest.java\nindex 3cfb60d93..593546982 100644\n--- a/server/src/test/java/org/candlepin/dto/api/v1/ConsumerDTOTest.java\n+++ b/server/src/test/java/org/candlepin/dto/api/v1/ConsumerDTOTest.java\n\n@@ -97,9 +98,9 @@ public class ConsumerDTOTest extends AbstractDTOTest<ConsumerDTO> {\n             .name(\"ContentName\")\n             .modifiedProductIds(new HashSet<>(Arrays.asList(\"ID1\", \"ID2\")));\n \n-        Set<EnvironmentContentDTO> envContentDTO = new HashSet<>(Arrays.asList(new EnvironmentContentDTO()\n+        Set<EnvironmentContentDTO> envContentDTO = Util.asSet(new EnvironmentContentDTO()\n             .content(cDTO)\n-            .enabled(false)));\n+            .enabled(false));\n \n         EnvironmentDTO envDTO = new EnvironmentDTO()\n             .id(\"envID\")\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDI0MjQ0MQ==", "url": "https://github.com/candlepin/candlepin/pull/2682#discussion_r410242441", "bodyText": "One more minor change, that we could apply in general from now on: Use org.candlepin.util.Util.toDateTime() to as a utility converter from Date to OffsetDateTime", "author": "nikosmoum", "createdAt": "2020-04-17T14:00:17Z", "path": "server/src/main/java/org/candlepin/dto/api/v1/EnvironmentTranslator.java", "diffHunk": "@@ -64,35 +62,48 @@ public EnvironmentDTO populate(Environment source, EnvironmentDTO dest) {\n     public EnvironmentDTO populate(ModelTranslator translator, Environment source,\n         EnvironmentDTO dest) {\n \n-        dest = super.populate(translator, source, dest);\n+        if (source == null) {\n+            throw new IllegalArgumentException(\"source is null\");\n+        }\n+\n+        if (dest == null) {\n+            throw new IllegalArgumentException(\"destination is null\");\n+        }\n \n-        dest.setId(source.getId());\n-        dest.setName(source.getName());\n-        dest.setDescription(source.getDescription());\n+        Date created = source.getCreated();\n+        dest.created(created != null ? created.toInstant().atOffset(ZoneOffset.UTC) : null);\n+\n+        Date updated = source.getUpdated();\n+        dest.updated(updated != null ? updated.toInstant().atOffset(ZoneOffset.UTC) : null);", "originalCommit": "a90f0addd888d84307c8edc083b076b62f8ab325", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMTA5OTkwNg==", "url": "https://github.com/candlepin/candlepin/pull/2682#discussion_r411099906", "bodyText": "Fixed.", "author": "wolfdale", "createdAt": "2020-04-20T05:20:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDI0MjQ0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "a00a36345c1ccb67d1428190ee783b61d83c6511", "chunk": "diff --git a/server/src/main/java/org/candlepin/dto/api/v1/EnvironmentTranslator.java b/server/src/main/java/org/candlepin/dto/api/v1/EnvironmentTranslator.java\nindex 02199a9a2..3f75f063a 100644\n--- a/server/src/main/java/org/candlepin/dto/api/v1/EnvironmentTranslator.java\n+++ b/server/src/main/java/org/candlepin/dto/api/v1/EnvironmentTranslator.java\n\n@@ -70,13 +69,9 @@ public class EnvironmentTranslator implements ObjectTranslator<Environment, Envi\n             throw new IllegalArgumentException(\"destination is null\");\n         }\n \n-        Date created = source.getCreated();\n-        dest.created(created != null ? created.toInstant().atOffset(ZoneOffset.UTC) : null);\n-\n-        Date updated = source.getUpdated();\n-        dest.updated(updated != null ? updated.toInstant().atOffset(ZoneOffset.UTC) : null);\n-\n-        dest.id(source.getId())\n+        dest.created(Util.toDateTime(source.getCreated()))\n+            .updated(Util.toDateTime(source.getUpdated()))\n+            .id(source.getId())\n             .name(source.getName())\n             .description(source.getDescription());\n \n"}}, {"oid": "a00a36345c1ccb67d1428190ee783b61d83c6511", "url": "https://github.com/candlepin/candlepin/commit/a00a36345c1ccb67d1428190ee783b61d83c6511", "message": "ENT-1859: Port EnvironmentDTO to openapi spec", "committedDate": "2020-04-20T05:17:18Z", "type": "commit"}, {"oid": "a00a36345c1ccb67d1428190ee783b61d83c6511", "url": "https://github.com/candlepin/candlepin/commit/a00a36345c1ccb67d1428190ee783b61d83c6511", "message": "ENT-1859: Port EnvironmentDTO to openapi spec", "committedDate": "2020-04-20T05:17:18Z", "type": "forcePushed"}]}