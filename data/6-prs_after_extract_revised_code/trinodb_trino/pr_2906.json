{"pr_number": 2906, "pr_title": "Add access control check for SHOW CRETAE TABLE and VIEW", "pr_createdAt": "2020-02-21T22:46:07Z", "pr_url": "https://github.com/trinodb/trino/pull/2906", "timeline": [{"oid": "6d36bedd2bade7c4121ca0eb74f6e164e27e74d3", "url": "https://github.com/trinodb/trino/commit/6d36bedd2bade7c4121ca0eb74f6e164e27e74d3", "message": "Add access control check for SHOW CRETAE TABLE and VIEW", "committedDate": "2020-02-22T00:19:33Z", "type": "commit"}, {"oid": "6d36bedd2bade7c4121ca0eb74f6e164e27e74d3", "url": "https://github.com/trinodb/trino/commit/6d36bedd2bade7c4121ca0eb74f6e164e27e74d3", "message": "Add access control check for SHOW CRETAE TABLE and VIEW", "committedDate": "2020-02-22T00:19:33Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDI1Ng==", "url": "https://github.com/trinodb/trino/pull/2906#discussion_r382934256", "bodyText": "I think we should remove this method like #2899. Users should be allowed to display list of columns that they are allowed to query.", "author": "kokosing", "createdAt": "2020-02-22T19:09:53Z", "path": "presto-main/src/main/java/io/prestosql/sql/rewrite/ShowQueriesRewrite.java", "diffHunk": "@@ -460,7 +459,7 @@ protected Node visitShowCreate(ShowCreate node, Void context)\n                     throw semanticException(TABLE_NOT_FOUND, node, \"Table '%s' does not exist\", objectName);\n                 }\n \n-                accessControl.checkCanShowColumnsMetadata(session.toSecurityContext(), new CatalogSchemaTableName(tableHandle.get().getCatalogName().getCatalogName(), objectName.asSchemaTableName()));", "originalCommit": "6d36bedd2bade7c4121ca0eb74f6e164e27e74d3", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDUxMw==", "url": "https://github.com/trinodb/trino/pull/2906#discussion_r382934513", "bodyText": "(no change requested) it is strange that one has ALL and other has OWNERSHIP. Should I file an issue for that?", "author": "kokosing", "createdAt": "2020-02-22T19:14:14Z", "path": "presto-plugin-toolkit/src/main/java/io/prestosql/plugin/base/security/FileBasedSystemAccessControl.java", "diffHunk": "@@ -352,6 +353,14 @@ public void checkCanShowSchemas(SystemSecurityContext context, String catalogNam\n         return schemaNames;\n     }\n \n+    @Override\n+    public void checkCanShowCreateTable(SystemSecurityContext context, CatalogSchemaTableName table)\n+    {\n+        if (!canAccessCatalog(context.getIdentity(), table.getCatalogName(), ALL)) {", "originalCommit": "6d36bedd2bade7c4121ca0eb74f6e164e27e74d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4Mjk0OTUwMw==", "url": "https://github.com/trinodb/trino/pull/2906#discussion_r382949503", "bodyText": "That is weird.  I actually like to extend the system level file rules to support everything in the connector level.", "author": "dain", "createdAt": "2020-02-22T23:27:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjkzNDUxMw=="}], "type": "inlineReview", "revised_code": null}]}