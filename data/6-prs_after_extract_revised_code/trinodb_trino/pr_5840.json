{"pr_number": 5840, "pr_title": "Add Hive view syntax smoke test", "pr_createdAt": "2020-11-05T14:30:37Z", "pr_url": "https://github.com/trinodb/trino/pull/5840", "timeline": [{"oid": "6f0ef8d8e6da0a0cdc0692222bfcead113a6523a", "url": "https://github.com/trinodb/trino/commit/6f0ef8d8e6da0a0cdc0692222bfcead113a6523a", "message": "Add Hive view syntax smoke test", "committedDate": "2020-11-05T14:30:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODA5NDA5Ng==", "url": "https://github.com/trinodb/trino/pull/5840#discussion_r518094096", "bodyText": "#5837", "author": "findepi", "createdAt": "2020-11-05T14:30:52Z", "path": "presto-product-tests/src/main/java/io/prestosql/tests/hive/TestHiveViews.java", "diffHunk": "@@ -137,6 +137,40 @@ public void testUnsupportedLateralViews()\n         assertThat(query(\"SELECT COUNT(*) FROM hive_lateral_view\")).contains(row(0));\n     }\n \n+    /**\n+     * Test view containing IF, IN, LIKE, BETWEEN, CASE, COALESCE, operators, delimited and non-delimited columns, an inline comment\n+     */\n+    @Test(groups = HIVE_VIEWS)\n+    public void testRichSqlSyntax()\n+    {\n+        onHive().executeQuery(\"DROP VIEW IF EXISTS view_with_rich_syntax\");\n+        onHive().executeQuery(\"CREATE VIEW view_with_rich_syntax AS \" +\n+                \"SELECT \\n\" +\n+                \"   `n_nationkey`, \\n\" + // grave accent\n+                \"   n_name, \\n\" + // no grave accent\n+                \"   `n_regionkey` AS `n_regionkey`, \\n\" + // alias\n+                \"   n_regionkey BETWEEN 1 AND 2 AS region_between_1_2, \\n\" + // BETWEEN, boolean\n+                \"   IF(`n`.`n_name` IN ('ALGERIA', 'ARGENTINA'), 1, 0) AS `starts_with_a`, \\n\" +\n+                \"   IF(`n`.`n_name` != 'PERU', 1, 0) `not_peru`, \\n\" + // no \"AS\" here\n+                \"   IF(`n`.`n_name` LIKE '%N%', 1, 0) `CONTAINS_N`, \\n\" + // LIKE, uppercase column name\n+                // TODO (https://github.com/prestosql/presto/issues/5837) \"   CASE n_regionkey WHEN 0 THEN 'Africa' WHEN 1 THEN 'America' END region_name, \\n\" + // simple CASE", "originalCommit": "6f0ef8d8e6da0a0cdc0692222bfcead113a6523a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}