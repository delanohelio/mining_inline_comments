{"pr_number": 5621, "pr_title": "Update rubix version to 0.3.18", "pr_createdAt": "2020-10-21T04:14:12Z", "pr_url": "https://github.com/trinodb/trino/pull/5621", "timeline": [{"oid": "7fb8c2e645b1a6e3ac0812f514207ab9cf001f62", "url": "https://github.com/trinodb/trino/commit/7fb8c2e645b1a6e3ac0812f514207ab9cf001f62", "message": "Update rubix version to 0.3.18", "committedDate": "2020-10-21T09:12:06Z", "type": "commit"}, {"oid": "7fb8c2e645b1a6e3ac0812f514207ab9cf001f62", "url": "https://github.com/trinodb/trino/commit/7fb8c2e645b1a6e3ac0812f514207ab9cf001f62", "message": "Update rubix version to 0.3.18", "committedDate": "2020-10-21T09:12:06Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTE4MQ==", "url": "https://github.com/trinodb/trino/pull/5621#discussion_r509129181", "bodyText": "just curious, how this relates to version update?", "author": "findepi", "createdAt": "2020-10-21T09:28:01Z", "path": "presto-hive/src/test/java/io/prestosql/plugin/hive/rubix/TestRubixCaching.java", "diffHunk": "@@ -328,7 +328,7 @@ public void testGetBlockLocations()\n         cachingFileSystem = getCachingFileSystem();\n \n         FileStatus file1 = new FileStatus(3, false, 0, 3, 0, new Path(\"aaa\"));\n-        FileStatus file2 = new FileStatus(3, false, 0, 3, 0, new Path(\"bbb\"));\n+        FileStatus file2 = new FileStatus(3, false, 0, 3, 0, new Path(\"zzzz\"));", "originalCommit": "7fb8c2e645b1a6e3ac0812f514207ab9cf001f62", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEzMjM2OA==", "url": "https://github.com/trinodb/trino/pull/5621#discussion_r509132368", "bodyText": "The hashing function changed with qubole/rubix@7e797a5\nWith the new function, the paths in this test started mapping to the same worker node.\nSo I changed the path to get the test to pass :)", "author": "raunaqmorarka", "createdAt": "2020-10-21T09:32:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTE4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTMzMjcyMg==", "url": "https://github.com/trinodb/trino/pull/5621#discussion_r509332722", "bodyText": "How many \"apparent nodes\" do we have here?\ncan the new hashing function increase collusions % ?", "author": "findepi", "createdAt": "2020-10-21T14:24:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTE4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM3MDM1MA==", "url": "https://github.com/trinodb/trino/pull/5621#discussion_r509370350", "bodyText": "This test was meant to test that block locations are actually correctly propagated and not about hash function effectiveness.", "author": "sopel39", "createdAt": "2020-10-21T15:08:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTE4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTg3NDkxOA==", "url": "https://github.com/trinodb/trino/pull/5621#discussion_r509874918", "bodyText": "The new hashing function is expected to be better as it switches from guava's MD5+consistent hash to Metro hash + consistent hash from a library which has a better implementation of consistent hashing https://github.com/ishugaliy/allgood-consistent-hash.\nSince there are only 2 nodes here, I don't think we can conclude much about quality of hash function here.", "author": "raunaqmorarka", "createdAt": "2020-10-22T04:38:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTEyOTE4MQ=="}], "type": "inlineReview", "revised_code": null}]}