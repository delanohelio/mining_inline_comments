{"pr_number": 3648, "pr_title": "Optimize system.jdbc.columns metadata calls", "pr_createdAt": "2020-05-06T14:53:06Z", "pr_url": "https://github.com/trinodb/trino/pull/3648", "timeline": [{"oid": "53fcc625392eb2dfc494b9c1218ac31e3a7e13af", "url": "https://github.com/trinodb/trino/commit/53fcc625392eb2dfc494b9c1218ac31e3a7e13af", "message": "Remove redundant condition\n\nThe method is used to get `varchar` `Domain`'s value, so we know the\nvalue is a `Slice`.", "committedDate": "2020-05-06T15:37:14Z", "type": "commit"}, {"oid": "e881624eb3d998382a168104e7f1b7add2f2d3d0", "url": "https://github.com/trinodb/trino/commit/e881624eb3d998382a168104e7f1b7add2f2d3d0", "message": "Rename method and make more flexible", "committedDate": "2020-05-06T15:37:15Z", "type": "commit"}, {"oid": "46b104c0f5faee70e62a985dee98ecb4cca746f7", "url": "https://github.com/trinodb/trino/commit/46b104c0f5faee70e62a985dee98ecb4cca746f7", "message": "Replace FilterUtil.filter method\n\nReplace the method with better API.", "committedDate": "2020-05-06T15:37:16Z", "type": "commit"}, {"oid": "0e0a8ccf73b236910db1d89950a226351a98242f", "url": "https://github.com/trinodb/trino/commit/0e0a8ccf73b236910db1d89950a226351a98242f", "message": "Simplify control flow", "committedDate": "2020-05-06T15:37:17Z", "type": "commit"}, {"oid": "e13b802b1f8429471472711ce5551b24231ff45f", "url": "https://github.com/trinodb/trino/commit/e13b802b1f8429471472711ce5551b24231ff45f", "message": "Move empty table name check to MetadataManager\n\n`MetadataManager` does not correctly behave when asked for `new\nQualifiedObjectName(\"\", \"\", \"\")` table or view.\n\nThis was previously worked around in the `information_schema`\nconnector, but since it applies to other metadata users, it should be\nfixed in `MetadataManager` directly.", "committedDate": "2020-05-07T21:42:50Z", "type": "commit"}, {"oid": "2b82112eb15004567793b2c72a115918c93283b6", "url": "https://github.com/trinodb/trino/commit/2b82112eb15004567793b2c72a115918c93283b6", "message": "Optimize system.jdbc.columns metadata calls", "committedDate": "2020-05-07T21:42:50Z", "type": "commit"}, {"oid": "2b82112eb15004567793b2c72a115918c93283b6", "url": "https://github.com/trinodb/trino/commit/2b82112eb15004567793b2c72a115918c93283b6", "message": "Optimize system.jdbc.columns metadata calls", "committedDate": "2020-05-07T21:42:50Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTk2Mjk2NA==", "url": "https://github.com/trinodb/trino/pull/3648#discussion_r421962964", "bodyText": "Nice!", "author": "kokosing", "createdAt": "2020-05-08T06:23:58Z", "path": "presto-jdbc/src/test/java/io/prestosql/jdbc/TestPrestoDatabaseMetaData.java", "diffHunk": "@@ -1169,22 +1169,52 @@ public void testGetColumnsMetadataCalls()\n                         list(\"TABLE_CAT\", \"TABLE_SCHEM\", \"TABLE_NAME\", \"COLUMN_NAME\", \"TYPE_NAME\")),\n                 list(list(COUNTING_CATALOG, \"test_schema1\", \"test_table1\", \"column_17\", \"varchar\")),\n                 new MetadataCallsCount()\n-                        .withListSchemasCount(1)\n-                        .withListTablesCount(2)\n-                        .withGetColumnsCount(3000));", "originalCommit": "2b82112eb15004567793b2c72a115918c93283b6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}