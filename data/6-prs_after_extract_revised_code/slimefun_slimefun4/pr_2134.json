{"pr_number": 2134, "pr_title": "Backwards-compatibility mode disabled on new servers", "pr_createdAt": "2020-07-25T21:27:03Z", "pr_url": "https://github.com/Slimefun/Slimefun4/pull/2134", "timeline": [{"oid": "46998740fe5744aca90ade34edbb9c5a52d1ecb4", "url": "https://github.com/Slimefun/Slimefun4/commit/46998740fe5744aca90ade34edbb9c5a52d1ecb4", "message": "Update config.yml", "committedDate": "2020-07-25T21:25:31Z", "type": "commit"}, {"oid": "e9650c1ca6968cf3a206124937b9f440833dd5fa", "url": "https://github.com/Slimefun/Slimefun4/commit/e9650c1ca6968cf3a206124937b9f440833dd5fa", "message": "Revert the changed config", "committedDate": "2020-07-25T21:58:18Z", "type": "commit"}, {"oid": "ea2795d5b7afd5cfd5b52462e7e9fa1f9e1c9924", "url": "https://github.com/Slimefun/Slimefun4/commit/ea2795d5b7afd5cfd5b52462e7e9fa1f9e1c9924", "message": "Implemented requested changes", "committedDate": "2020-07-25T22:20:59Z", "type": "commit"}, {"oid": "b8d399a92c741a8e1dd08e50dab004741397db10", "url": "https://github.com/Slimefun/Slimefun4/commit/b8d399a92c741a8e1dd08e50dab004741397db10", "message": "World-changing fix", "committedDate": "2020-07-25T22:22:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1MjQ2MA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2134#discussion_r460452460", "bodyText": "This is always set to the same thing. It makes no sense for this not to be final.", "author": "WalshyDev", "createdAt": "2020-07-25T22:24:40Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java", "diffHunk": "@@ -176,6 +177,15 @@ else if (getServer().getPluginManager().isPluginEnabled(\"CS-CoreLib\")) {\n                 return;\n             }\n \n+            // Disabling backwards-compatibility for fresh Slimefun installs\n+            if (!new File(\"plugins/\" + getName().replace(\" \", \"_\"), \"config.yml\").exists()) {\n+                config = new Config(this);", "originalCommit": "b8d399a92c741a8e1dd08e50dab004741397db10", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1Mjg4NQ==", "url": "https://github.com/Slimefun/Slimefun4/pull/2134#discussion_r460452885", "bodyText": "Sure, but when declaring the config, it just creates itself, so where can we check if it was created for the first time?", "author": "poma123", "createdAt": "2020-07-25T22:30:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1MjQ2MA=="}], "type": "inlineReview", "revised_code": {"commit": "0d11d5ae8972304f32bf9c50e924998c84ced930", "chunk": "diff --git a/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java b/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\nindex a7cfa8d87..60ab03eb5 100644\n--- a/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\n+++ b/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\n\n@@ -178,12 +177,9 @@ public final class SlimefunPlugin extends JavaPlugin implements SlimefunAddon {\n             }\n \n             // Disabling backwards-compatibility for fresh Slimefun installs\n-            if (!new File(\"plugins/\" + getName().replace(\" \", \"_\"), \"config.yml\").exists()) {\n-                config = new Config(this);\n+            if (!new File(\"data-storage/Slimefun\").exists()) {\n                 config.setValue(\"options.backwards-compatibility\", false);\n                 config.save();\n-            } else {\n-                config = new Config(this);\n             }\n \n             // Creating all necessary Folders\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1MjQ4Nw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2134#discussion_r460452487", "bodyText": "JavaPlugin#getDataFolder", "author": "WalshyDev", "createdAt": "2020-07-25T22:24:54Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java", "diffHunk": "@@ -176,6 +177,15 @@ else if (getServer().getPluginManager().isPluginEnabled(\"CS-CoreLib\")) {\n                 return;\n             }\n \n+            // Disabling backwards-compatibility for fresh Slimefun installs\n+            if (!new File(\"plugins/\" + getName().replace(\" \", \"_\"), \"config.yml\").exists()) {", "originalCommit": "b8d399a92c741a8e1dd08e50dab004741397db10", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0d11d5ae8972304f32bf9c50e924998c84ced930", "chunk": "diff --git a/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java b/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\nindex a7cfa8d87..60ab03eb5 100644\n--- a/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\n+++ b/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\n\n@@ -178,12 +177,9 @@ public final class SlimefunPlugin extends JavaPlugin implements SlimefunAddon {\n             }\n \n             // Disabling backwards-compatibility for fresh Slimefun installs\n-            if (!new File(\"plugins/\" + getName().replace(\" \", \"_\"), \"config.yml\").exists()) {\n-                config = new Config(this);\n+            if (!new File(\"data-storage/Slimefun\").exists()) {\n                 config.setValue(\"options.backwards-compatibility\", false);\n                 config.save();\n-            } else {\n-                config = new Config(this);\n             }\n \n             // Creating all necessary Folders\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1MjU2Mw==", "url": "https://github.com/Slimefun/Slimefun4/pull/2134#discussion_r460452563", "bodyText": "I'm thinking maybe data storage should be checked. Since that's a good indication of a new server and it's w good way to see if there's existing items.", "author": "WalshyDev", "createdAt": "2020-07-25T22:26:01Z", "path": "src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java", "diffHunk": "@@ -176,6 +177,15 @@ else if (getServer().getPluginManager().isPluginEnabled(\"CS-CoreLib\")) {\n                 return;\n             }\n \n+            // Disabling backwards-compatibility for fresh Slimefun installs\n+            if (!new File(\"plugins/\" + getName().replace(\" \", \"_\"), \"config.yml\").exists()) {\n+                config = new Config(this);\n+                config.setValue(\"options.backwards-compatibility\", false);\n+                config.save();", "originalCommit": "b8d399a92c741a8e1dd08e50dab004741397db10", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1MzAxNA==", "url": "https://github.com/Slimefun/Slimefun4/pull/2134#discussion_r460453014", "bodyText": "Hmm, good idea", "author": "poma123", "createdAt": "2020-07-25T22:32:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDQ1MjU2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "0d11d5ae8972304f32bf9c50e924998c84ced930", "chunk": "diff --git a/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java b/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\nindex a7cfa8d87..60ab03eb5 100644\n--- a/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\n+++ b/src/main/java/io/github/thebusybiscuit/slimefun4/implementation/SlimefunPlugin.java\n\n@@ -178,12 +177,9 @@ public final class SlimefunPlugin extends JavaPlugin implements SlimefunAddon {\n             }\n \n             // Disabling backwards-compatibility for fresh Slimefun installs\n-            if (!new File(\"plugins/\" + getName().replace(\" \", \"_\"), \"config.yml\").exists()) {\n-                config = new Config(this);\n+            if (!new File(\"data-storage/Slimefun\").exists()) {\n                 config.setValue(\"options.backwards-compatibility\", false);\n                 config.save();\n-            } else {\n-                config = new Config(this);\n             }\n \n             // Creating all necessary Folders\n"}}, {"oid": "0d11d5ae8972304f32bf9c50e924998c84ced930", "url": "https://github.com/Slimefun/Slimefun4/commit/0d11d5ae8972304f32bf9c50e924998c84ced930", "message": "Requested changes", "committedDate": "2020-07-25T22:33:33Z", "type": "commit"}]}