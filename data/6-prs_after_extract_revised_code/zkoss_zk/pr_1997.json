{"pr_number": 1997, "pr_title": "ZK-4569: MVVM support calling commands in other view model", "pr_createdAt": "2020-05-12T08:51:21Z", "pr_url": "https://github.com/zkoss/zk/pull/1997", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzYyNjExOQ==", "url": "https://github.com/zkoss/zk/pull/1997#discussion_r423626119", "bodyText": "Binder", "author": "scribetw", "createdAt": "2020-05-12T10:22:57Z", "path": "zkbind/src/org/zkoss/bind/BindComposer.java", "diffHunk": "@@ -442,6 +442,15 @@ private AnnotateBinder initBinder(BindEvaluatorX evalx, Component comp) {\n \t\tcomp.setAttribute(bname, binder);\n \t\tcomp.setAttribute(BINDER_ID, bname);\n \n+\t\t//ZK-4569\n+\t\tDesktop desktop = comp.getDesktop();\n+\t\tMap<String, Object> relationMap = (Map<String, Object>) desktop.getAttribute(BinderCtrl.VIEWMODELID_BINDER_MAP_KEY);", "originalCommit": "932b298d4495d0b26f5ec9a51e59f8c137d349e2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0e6105bf63c47715d9775986a9ac316d37bf48fc", "chunk": "diff --git a/zkbind/src/org/zkoss/bind/BindComposer.java b/zkbind/src/org/zkoss/bind/BindComposer.java\nindex b21e32dfa6..1ba103d2f9 100644\n--- a/zkbind/src/org/zkoss/bind/BindComposer.java\n+++ b/zkbind/src/org/zkoss/bind/BindComposer.java\n\n@@ -444,12 +444,12 @@ public class BindComposer<T extends Component>\n \n \t\t//ZK-4569\n \t\tDesktop desktop = comp.getDesktop();\n-\t\tMap<String, Object> relationMap = (Map<String, Object>) desktop.getAttribute(BinderCtrl.VIEWMODELID_BINDER_MAP_KEY);\n+\t\tMap<String, Binder> relationMap = (Map<String, Binder>) desktop.getAttribute(BinderCtrl.VIEWMODELID_BINDER_MAP_KEY);\n \t\tif (relationMap == null) {\n \t\t\trelationMap = new HashMap<>(4);\n \t\t\tdesktop.setAttribute(BinderCtrl.VIEWMODELID_BINDER_MAP_KEY, relationMap);\n \t\t}\n-\t\trelationMap.put((String) comp.getAttribute(BindComposer.VM_ID), binder);\n+\t\trelationMap.put((String) comp.getAttribute(BindComposer.VM_ID), (Binder) binder);\n \n \t\treturn (AnnotateBinder) binder;\n \t}\n"}}, {"oid": "0e6105bf63c47715d9775986a9ac316d37bf48fc", "url": "https://github.com/zkoss/zk/commit/0e6105bf63c47715d9775986a9ac316d37bf48fc", "message": "ZK-4569: MVVM support calling commands in other view model", "committedDate": "2020-05-13T07:38:05Z", "type": "forcePushed"}, {"oid": "85d30ad0e0bcabeccc6d73fa308842677a5c6a96", "url": "https://github.com/zkoss/zk/commit/85d30ad0e0bcabeccc6d73fa308842677a5c6a96", "message": "ZK-4569: MVVM support calling commands in other view model", "committedDate": "2020-05-14T07:44:48Z", "type": "commit"}, {"oid": "85d30ad0e0bcabeccc6d73fa308842677a5c6a96", "url": "https://github.com/zkoss/zk/commit/85d30ad0e0bcabeccc6d73fa308842677a5c6a96", "message": "ZK-4569: MVVM support calling commands in other view model", "committedDate": "2020-05-14T07:44:48Z", "type": "forcePushed"}]}