{"pr_number": 755, "pr_title": "JENA-1913: Multiple --file on the Fuseki command line", "pr_createdAt": "2020-06-07T10:07:46Z", "pr_url": "https://github.com/apache/jena/pull/755", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0NzAwNg==", "url": "https://github.com/apache/jena/pull/755#discussion_r436347006", "bodyText": ".get(0)? (Spent the day looking at JS and Python, and on mobile, so I might be confusing langs... if so ignore please)", "author": "kinow", "createdAt": "2020-06-07T10:12:31Z", "path": "jena-fuseki2/jena-fuseki-webapp/src/main/java/org/apache/jena/fuseki/cmd/FusekiCmd.java", "diffHunk": "@@ -246,21 +247,26 @@ protected void processModulesAndArgs() {\n             }\n \n             if ( contains(argFile) ) {\n-                String filename = getValue(argFile);\n-                log.info(\"Dataset: in-memory: load file: \" + filename);\n-                String pathname = filename;\n-                if ( filename.startsWith(\"file:\") )\n-                    pathname = filename.substring(\"file:\".length());\n-                if ( !FileOps.exists(filename) )\n-                    throw new CmdException(\"File not found: \" + filename);\n-                cmdLineConfig.datasetDescription = \"file: \"+filename;\n+                List<String> filenames = getValues(argFile);\n                 // Directly populate the dataset.\n                 cmdLineConfig.reset();\n                 cmdLineConfig.dsg = DatasetGraphFactory.createTxnMem();\n-                Lang language = RDFLanguages.filenameToLang(filename);\n-                if ( language == null )\n-                    throw new CmdException(\"Can't guess language for file: \" + filename);\n-                Txn.executeWrite(cmdLineConfig.dsg, ()->RDFDataMgr.read(cmdLineConfig.dsg, filename));\n+                String desc = filenames.size() == 1\n+                    ? \"file: \"+filenames.get(1)", "originalCommit": "8c5c277821e958218cd497d271164b3149ea7792", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0ODY0NA==", "url": "https://github.com/apache/jena/pull/755#discussion_r436348644", "bodyText": "Arrg! .get(0) both times (quick fix applied).\nThe messages need refining as well. Logging works different in the two different server startup sequences (\"legacy\" - sigh).", "author": "afs", "createdAt": "2020-06-07T10:32:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0NzAwNg=="}], "type": "inlineReview", "revised_code": {"commit": "2494957b489a0d010ee51e3455fb33f891a1d90c", "chunk": "diff --git a/jena-fuseki2/jena-fuseki-webapp/src/main/java/org/apache/jena/fuseki/cmd/FusekiCmd.java b/jena-fuseki2/jena-fuseki-webapp/src/main/java/org/apache/jena/fuseki/cmd/FusekiCmd.java\nindex 1f8fac5121..ee08c783b9 100644\n--- a/jena-fuseki2/jena-fuseki-webapp/src/main/java/org/apache/jena/fuseki/cmd/FusekiCmd.java\n+++ b/jena-fuseki2/jena-fuseki-webapp/src/main/java/org/apache/jena/fuseki/cmd/FusekiCmd.java\n\n@@ -252,7 +252,7 @@ public class FusekiCmd {\n                 cmdLineConfig.reset();\n                 cmdLineConfig.dsg = DatasetGraphFactory.createTxnMem();\n                 String desc = filenames.size() == 1\n-                    ? \"file: \"+filenames.get(1)\n+                    ? \"file: \"+filenames.get(0)\n                     : \"files: \"+filenames;\n                 cmdLineConfig.datasetDescription = desc;\n                 for ( String filename : filenames ) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjM0NzA4MQ==", "url": "https://github.com/apache/jena/pull/755#discussion_r436347081", "bodyText": "Isn't the parameter the index of the element? Or is it the number of elements to pop/shift?", "author": "kinow", "createdAt": "2020-06-07T10:13:28Z", "path": "jena-fuseki2/jena-fuseki-main/src/main/java/org/apache/jena/fuseki/main/cmds/FusekiMain.java", "diffHunk": "@@ -282,21 +282,26 @@ protected void processModulesAndArgs() {\n         }\n \n         if ( contains(argFile) ) {\n-            String filename = getValue(argFile);\n-            String pathname = filename;\n-            if ( filename.startsWith(\"file:\") )\n-                pathname = filename.substring(\"file:\".length());\n-\n-            serverConfig.datasetDescription = \"file:\"+filename;\n-            if ( !FileOps.exists(pathname) )\n-                throw new CmdException(\"File not found: \" + filename);\n-            serverConfig.dsg = DatasetGraphFactory.createTxnMem();\n-\n-            // INITIAL DATA.\n-            Lang language = RDFLanguages.filenameToLang(filename);\n-            if ( language == null )\n-                throw new CmdException(\"Can't guess language for file: \" + filename);\n-            Txn.executeWrite(serverConfig.dsg,  ()->RDFDataMgr.read(serverConfig.dsg, filename));\n+            List<String> filenames = getValues(argFile);\n+            String desc = filenames.size() == 1\n+                ? \"file: \"+filenames.get(1)", "originalCommit": "8c5c277821e958218cd497d271164b3149ea7792", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2494957b489a0d010ee51e3455fb33f891a1d90c", "chunk": "diff --git a/jena-fuseki2/jena-fuseki-main/src/main/java/org/apache/jena/fuseki/main/cmds/FusekiMain.java b/jena-fuseki2/jena-fuseki-main/src/main/java/org/apache/jena/fuseki/main/cmds/FusekiMain.java\nindex c837668728..ef9196d823 100644\n--- a/jena-fuseki2/jena-fuseki-main/src/main/java/org/apache/jena/fuseki/main/cmds/FusekiMain.java\n+++ b/jena-fuseki2/jena-fuseki-main/src/main/java/org/apache/jena/fuseki/main/cmds/FusekiMain.java\n\n@@ -284,7 +284,7 @@ public class FusekiMain extends CmdARQ {\n         if ( contains(argFile) ) {\n             List<String> filenames = getValues(argFile);\n             String desc = filenames.size() == 1\n-                ? \"file: \"+filenames.get(1)\n+                ? \"file: \"+filenames.get(0)\n                 : \"files: \"+filenames;\n              serverConfig.datasetDescription = desc;\n              serverConfig.dsg = DatasetGraphFactory.createTxnMem();\n"}}, {"oid": "2494957b489a0d010ee51e3455fb33f891a1d90c", "url": "https://github.com/apache/jena/commit/2494957b489a0d010ee51e3455fb33f891a1d90c", "message": "JENA-1913: Multiple --file on the Fuseki command line", "committedDate": "2020-06-07T10:18:22Z", "type": "forcePushed"}, {"oid": "07382a566d1bd0a7d274daaf06722d5254a8bf9e", "url": "https://github.com/apache/jena/commit/07382a566d1bd0a7d274daaf06722d5254a8bf9e", "message": "JENA-1913: Multiple --file on the Fuseki command line", "committedDate": "2020-06-07T10:51:14Z", "type": "commit"}, {"oid": "07382a566d1bd0a7d274daaf06722d5254a8bf9e", "url": "https://github.com/apache/jena/commit/07382a566d1bd0a7d274daaf06722d5254a8bf9e", "message": "JENA-1913: Multiple --file on the Fuseki command line", "committedDate": "2020-06-07T10:51:14Z", "type": "forcePushed"}]}