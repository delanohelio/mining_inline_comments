{"pr_number": 694, "pr_title": "Move consumer.close() to a try-catch block in AbstractKafkaBasedConnectorTask", "pr_createdAt": "2020-03-14T00:35:55Z", "pr_url": "https://github.com/linkedin/brooklin/pull/694", "timeline": [{"oid": "e5cbdc3ce4376ade5563c55ecd52cad5e40c5dc6", "url": "https://github.com/linkedin/brooklin/commit/e5cbdc3ce4376ade5563c55ecd52cad5e40c5dc6", "message": "Move consumer.close() to a try-catch block in AbstractKafkaBasedConnectorTask to ensure postShutdownHook gets called", "committedDate": "2020-03-14T00:31:21Z", "type": "commit"}, {"oid": "5338fff0e9f73d35db22660948d0d9370caa61d2", "url": "https://github.com/linkedin/brooklin/commit/5338fff0e9f73d35db22660948d0d9370caa61d2", "message": "Fix up test", "committedDate": "2020-03-14T01:34:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU1MjAzMw==", "url": "https://github.com/linkedin/brooklin/pull/694#discussion_r392552033", "bodyText": "should we have retries for this?", "author": "gauravrkulkarni", "createdAt": "2020-03-14T03:19:39Z", "path": "datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/AbstractKafkaBasedConnectorTask.java", "diffHunk": "@@ -352,7 +352,11 @@ public void run() {\n     } finally {\n       _stoppedLatch.countDown();\n       if (null != _consumer) {\n-        _consumer.close();\n+        try {\n+          _consumer.close();", "originalCommit": "5338fff0e9f73d35db22660948d0d9370caa61d2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU1MjkzNw==", "url": "https://github.com/linkedin/brooklin/pull/694#discussion_r392552937", "bodyText": "I don\u2019t think retry is necessary since we are anyways on the shutdown path. Let me know if you have a reason for why you think retry may be helpful", "author": "somandal", "createdAt": "2020-03-14T03:34:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU1MjAzMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIxOTc2Ng==", "url": "https://github.com/linkedin/brooklin/pull/694#discussion_r393219766", "bodyText": "synced with Sonam offline, it looks like assign can be called on same set of partitions. And since the task will be shut down, we won't use the consumer for polling again even if its not closed.", "author": "gauravrkulkarni", "createdAt": "2020-03-16T18:09:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjU1MjAzMw=="}], "type": "inlineReview", "revised_code": null}]}