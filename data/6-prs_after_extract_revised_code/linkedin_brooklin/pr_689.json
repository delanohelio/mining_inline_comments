{"pr_number": 689, "pr_title": "Make KafkaTopicPartitionStatsResponse a Kafka connector utility method", "pr_createdAt": "2020-03-09T19:04:34Z", "pr_url": "https://github.com/linkedin/brooklin/pull/689", "timeline": [{"oid": "2786940a4ea237ae2877172b2e73c882167d6cb6", "url": "https://github.com/linkedin/brooklin/commit/2786940a4ea237ae2877172b2e73c882167d6cb6", "message": "Move reduce method for KafkaTopicPartitionResponse to DiagnosticsAware\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T20:55:27Z", "type": "forcePushed"}, {"oid": "35c5dd758d758e422db5acbca399890aa08df16c", "url": "https://github.com/linkedin/brooklin/commit/35c5dd758d758e422db5acbca399890aa08df16c", "message": "Move reduce method for KafkaTopicPartitionResponse to DiagnosticsAware\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T20:59:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk2MjE0Mg==", "url": "https://github.com/linkedin/brooklin/pull/689#discussion_r389962142", "bodyText": "You might want to consider passing a logger to this method, or to a KafkaConnectorUtils  ctor. This way, log statements printed by this method would have the appropriate connector/task type name instead of KafkaConnectorUtils.", "author": "ahmedahamid", "createdAt": "2020-03-09T21:07:22Z", "path": "datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/**\n+ *  Copyright 2020 LinkedIn Corporation. All rights reserved.\n+ *  Licensed under the BSD 2-Clause License. See the LICENSE file in the project root for license information.\n+ *  See the NOTICE file in the project root for additional information regarding copyright ownership.\n+ */\n+\n+package com.linkedin.datastream.connectors.kafka;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.codehaus.jackson.type.TypeReference;\n+import org.slf4j.Logger;\n+\n+import com.linkedin.datastream.common.JsonUtils;\n+import org.slf4j.LoggerFactory;\n+\n+\n+/**\n+ * Utility class for Kafka based connectors\n+ */\n+public class KafkaConnectorUtils {\n+  private static final Logger LOG = LoggerFactory.getLogger(KafkaConnectorUtils.class.getName());\n+  /**\n+   * Reduce/Merge the KafkaTopicPartitionStatsResponse responses of a collection of host/instance into one response\n+   */\n+  public static String reduceTopicPartitionStatsResponses(Map<String, String> responses) {", "originalCommit": "35c5dd758d758e422db5acbca399890aa08df16c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk2NDE5OA==", "url": "https://github.com/linkedin/brooklin/pull/689#discussion_r389964198", "bodyText": "Good point. Done.", "author": "vishwajith-s", "createdAt": "2020-03-09T21:11:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk2MjE0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "fcc4d4005820d5f6ccd8bfc11ae9ffa05710a27f", "chunk": "diff --git a/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java b/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorDiagUtils.java\nsimilarity index 86%\nrename from datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java\nrename to datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorDiagUtils.java\nindex 59f1588f..398853cf 100644\n--- a/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java\n+++ b/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorDiagUtils.java\n\n@@ -23,12 +23,11 @@ import org.slf4j.LoggerFactory;\n /**\n  * Utility class for Kafka based connectors\n  */\n-public class KafkaConnectorUtils {\n-  private static final Logger LOG = LoggerFactory.getLogger(KafkaConnectorUtils.class.getName());\n+public class KafkaConnectorDiagUtils {\n   /**\n    * Reduce/Merge the KafkaTopicPartitionStatsResponse responses of a collection of host/instance into one response\n    */\n-  public static String reduceTopicPartitionStatsResponses(Map<String, String> responses) {\n+  public static String reduceTopicPartitionStatsResponses(Map<String, String> responses, Logger logger) {\n     Map<String, KafkaTopicPartitionStatsResponse> result = new HashMap<>();\n \n     responses.forEach((instance, json) -> {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk2MjczMQ==", "url": "https://github.com/linkedin/brooklin/pull/689#discussion_r389962731", "bodyText": "Would it be a good idea to rename this to KafkaConnectorDiagUtils to make it a little more specific?", "author": "ahmedahamid", "createdAt": "2020-03-09T21:08:35Z", "path": "datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java", "diffHunk": "@@ -0,0 +1,66 @@\n+/**\n+ *  Copyright 2020 LinkedIn Corporation. All rights reserved.\n+ *  Licensed under the BSD 2-Clause License. See the LICENSE file in the project root for license information.\n+ *  See the NOTICE file in the project root for additional information regarding copyright ownership.\n+ */\n+\n+package com.linkedin.datastream.connectors.kafka;\n+\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.codehaus.jackson.type.TypeReference;\n+import org.slf4j.Logger;\n+\n+import com.linkedin.datastream.common.JsonUtils;\n+import org.slf4j.LoggerFactory;\n+\n+\n+/**\n+ * Utility class for Kafka based connectors\n+ */\n+public class KafkaConnectorUtils {", "originalCommit": "35c5dd758d758e422db5acbca399890aa08df16c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fcc4d4005820d5f6ccd8bfc11ae9ffa05710a27f", "chunk": "diff --git a/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java b/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorDiagUtils.java\nsimilarity index 86%\nrename from datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java\nrename to datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorDiagUtils.java\nindex 59f1588f..398853cf 100644\n--- a/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorUtils.java\n+++ b/datastream-kafka-connector/src/main/java/com/linkedin/datastream/connectors/kafka/KafkaConnectorDiagUtils.java\n\n@@ -23,12 +23,11 @@ import org.slf4j.LoggerFactory;\n /**\n  * Utility class for Kafka based connectors\n  */\n-public class KafkaConnectorUtils {\n-  private static final Logger LOG = LoggerFactory.getLogger(KafkaConnectorUtils.class.getName());\n+public class KafkaConnectorDiagUtils {\n   /**\n    * Reduce/Merge the KafkaTopicPartitionStatsResponse responses of a collection of host/instance into one response\n    */\n-  public static String reduceTopicPartitionStatsResponses(Map<String, String> responses) {\n+  public static String reduceTopicPartitionStatsResponses(Map<String, String> responses, Logger logger) {\n     Map<String, KafkaTopicPartitionStatsResponse> result = new HashMap<>();\n \n     responses.forEach((instance, json) -> {\n"}}, {"oid": "fcc4d4005820d5f6ccd8bfc11ae9ffa05710a27f", "url": "https://github.com/linkedin/brooklin/commit/fcc4d4005820d5f6ccd8bfc11ae9ffa05710a27f", "message": "Move reduce method for KafkaTopicPartitionResponse to DiagnosticsAware\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T21:18:24Z", "type": "forcePushed"}, {"oid": "0c7f8d3f577fd3ad4f780fa038b227763883e9f7", "url": "https://github.com/linkedin/brooklin/commit/0c7f8d3f577fd3ad4f780fa038b227763883e9f7", "message": "Make KafkaTopicPartitionStatsResponse a Kafka connector utility method\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T21:43:43Z", "type": "forcePushed"}, {"oid": "baaee89282f003d2cef99306fe6ad9ae4db53c47", "url": "https://github.com/linkedin/brooklin/commit/baaee89282f003d2cef99306fe6ad9ae4db53c47", "message": "Make KafkaTopicPartitionStatsResponse a Kafka connector utility method\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T21:45:30Z", "type": "forcePushed"}, {"oid": "5e5a25af5b0e38ae637f98bfb0371df666390b61", "url": "https://github.com/linkedin/brooklin/commit/5e5a25af5b0e38ae637f98bfb0371df666390b61", "message": "Make KafkaTopicPartitionStatsResponse a Kafka connector utility method\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T21:53:14Z", "type": "commit"}, {"oid": "5e5a25af5b0e38ae637f98bfb0371df666390b61", "url": "https://github.com/linkedin/brooklin/commit/5e5a25af5b0e38ae637f98bfb0371df666390b61", "message": "Make KafkaTopicPartitionStatsResponse a Kafka connector utility method\n\nAll the connectors KMM, Espresso and Oracle have common implemetations\nof reduce methos for KafkaTopicPartitionResponse. Hence, moving it to the\nDiagnosticsAware interface to eliminate duplciate code.", "committedDate": "2020-03-09T21:53:14Z", "type": "forcePushed"}]}