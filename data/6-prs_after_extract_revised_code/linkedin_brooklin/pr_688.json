{"pr_number": 688, "pr_title": "Fix keys getting discarded before sending the record to the destination", "pr_createdAt": "2020-03-05T17:56:21Z", "pr_url": "https://github.com/linkedin/brooklin/pull/688", "timeline": [{"oid": "7b904be470c32691d0f4b0b996e484e45353ef83", "url": "https://github.com/linkedin/brooklin/commit/7b904be470c32691d0f4b0b996e484e45353ef83", "message": "Fix keys getting discarded before sending the record to the destination", "committedDate": "2020-03-05T17:49:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODYzODE1NA==", "url": "https://github.com/linkedin/brooklin/pull/688#discussion_r388638154", "bodyText": "I understand you're trying to minimize changes but I think the code would be slightly clearer/better if we avoid the redundant assignment, i.e.\nif (record.getPartitionKey().isPresent()) {\n    keyValue = record.getPartitionKey().get().getBytes(StandardCharsets.UTF_8);\n}", "author": "ahmedahamid", "createdAt": "2020-03-06T00:12:53Z", "path": "datastream-kafka/src/main/java/com/linkedin/datastream/kafka/KafkaTransportProvider.java", "diffHunk": "@@ -119,7 +119,7 @@ public KafkaTransportProvider(DatastreamTask datastreamTask, List<KafkaProducerW\n       // If the partition is not specified. We use the partitionKey as the key. Kafka will use the hash of that\n       // to determine the partition. If partitionKey does not exist, use the key value.\n       keyValue = record.getPartitionKey().isPresent()\n-          ? record.getPartitionKey().get().getBytes(StandardCharsets.UTF_8) : null;\n+              ? record.getPartitionKey().get().getBytes(StandardCharsets.UTF_8) : keyValue;", "originalCommit": "7b904be470c32691d0f4b0b996e484e45353ef83", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc4NTQ0MQ==", "url": "https://github.com/linkedin/brooklin/pull/688#discussion_r389785441", "bodyText": "Thanks for the review @ahmedahamid. I agree with your feedback.\nI was trying to make the code look as it was prior to this commit.\nLet me know if you feel strongly about the code style. I can make that change and run a quick round of tests.", "author": "sdomalap", "createdAt": "2020-03-09T15:55:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODYzODE1NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDY0OTAwMg==", "url": "https://github.com/linkedin/brooklin/pull/688#discussion_r400649002", "bodyText": "Thanks for your contribution, @sdomalap", "author": "ahmedahamid", "createdAt": "2020-03-31T05:17:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4ODYzODE1NA=="}], "type": "inlineReview", "revised_code": null}]}