{"pr_number": 4605, "pr_title": "NIFI-7932 Allow MonitorActivity's \"Threshold Duration\" property to use variables", "pr_createdAt": "2020-10-15T20:03:10Z", "pr_url": "https://github.com/apache/nifi/pull/4605", "timeline": [{"oid": "c757c4636c23b6482f51716c56c33cd1e6b30e7f", "url": "https://github.com/apache/nifi/commit/c757c4636c23b6482f51716c56c33cd1e6b30e7f", "message": "MonitorActivity THRESHOLD to use Variables\n\nWhen using MonitorActivity, it would be interesting to use variables in \"Threshold Duration\", which will help maintain Version Control in ProcessGroups (Avoiding \"breaking\" versions when including the value manually). \r\n\r\nI've included the option expressionLanguageSupported(ExpressionLanguageScope.VARIABLE_REGISTRY), so we can use variables in \"Threshold Duration\".", "committedDate": "2020-10-15T18:50:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyODYwOQ==", "url": "https://github.com/apache/nifi/pull/4605#discussion_r505928609", "bodyText": "Added support for Expression Language, within scope VARIABLE_REGISTRY", "author": "kevinbsilva", "createdAt": "2020-10-15T23:57:07Z", "path": "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/MonitorActivity.java", "diffHunk": "@@ -85,6 +85,7 @@\n             .description(\"Determines how much time must elapse before considering the flow to be inactive\")\n             .required(true)\n             .addValidator(StandardValidators.TIME_PERIOD_VALIDATOR)\n+            .expressionLanguageSupported(ExpressionLanguageScope.VARIABLE_REGISTRY)", "originalCommit": "c757c4636c23b6482f51716c56c33cd1e6b30e7f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTkyODg3NA==", "url": "https://github.com/apache/nifi/pull/4605#discussion_r505928874", "bodyText": "Added Evaluation for Attribute Expressions (Threshold Duration property)", "author": "kevinbsilva", "createdAt": "2020-10-15T23:58:03Z", "path": "nifi-nar-bundles/nifi-standard-bundle/nifi-standard-processors/src/main/java/org/apache/nifi/processors/standard/MonitorActivity.java", "diffHunk": "@@ -242,7 +243,7 @@ private boolean shouldReportOnlyOnPrimary(boolean isClusterScope, final ProcessC\n \n     @Override\n     public void onTrigger(final ProcessContext context, final ProcessSession session) {\n-        final long thresholdMillis = context.getProperty(THRESHOLD).asTimePeriod(TimeUnit.MILLISECONDS);\n+        final long thresholdMillis = context.getProperty(THRESHOLD).evaluateAttributeExpressions().asTimePeriod(TimeUnit.MILLISECONDS);", "originalCommit": "c757c4636c23b6482f51716c56c33cd1e6b30e7f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}