{"pr_number": 4111, "pr_title": "NIFI-7119 Implement boundary checking for Argon2 cost parameters", "pr_createdAt": "2020-03-04T19:12:07Z", "pr_url": "https://github.com/apache/nifi/pull/4111", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkzNDc5Ng==", "url": "https://github.com/apache/nifi/pull/4111#discussion_r387934796", "bodyText": "Should be long rather than double.", "author": "alopresto", "createdAt": "2020-03-04T21:07:32Z", "path": "nifi-commons/nifi-security-utils/src/main/java/org/apache/nifi/security/util/crypto/Argon2SecureHasher.java", "diffHunk": "@@ -53,11 +53,14 @@\n     private final int iterations;\n     private final int saltLength;\n \n-    private final boolean usingStaticSalt;\n+    private boolean usingStaticSalt;\n \n     // A 16 byte salt (nonce) is recommended for password hashing\n     private static final byte[] staticSalt = \"NiFi Static Salt\".getBytes(StandardCharsets.UTF_8);\n \n+    // Upper boundary for several cost parameters\n+    private static final double upperBoundary = Math.pow(2, 32) - 1;", "originalCommit": "73755b8c88580e5c89054e62cad83354d922967a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkzNjg3Mw==", "url": "https://github.com/apache/nifi/pull/4111#discussion_r387936873", "bodyText": "As 2^32 - 1 is 4*10^12, an int can hold 2^32 possible values, but signed, so the Integer.MAX_VALUE is 2....*10^12. A long is required for all of these fields.", "author": "alopresto", "createdAt": "2020-03-04T21:11:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkzNDc5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMxNDQxMg==", "url": "https://github.com/apache/nifi/pull/4111#discussion_r391314412", "bodyText": "Used Integer to hold unsigned ints.", "author": "alopresto", "createdAt": "2020-03-11T22:50:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzkzNDc5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "dd643889523c3376d65b98701d299779539abcaf", "chunk": "diff --git a/nifi-commons/nifi-security-utils/src/main/java/org/apache/nifi/security/util/crypto/Argon2SecureHasher.java b/nifi-commons/nifi-security-utils/src/main/java/org/apache/nifi/security/util/crypto/Argon2SecureHasher.java\nindex 9c842b6246..9f6f36a2f3 100644\n--- a/nifi-commons/nifi-security-utils/src/main/java/org/apache/nifi/security/util/crypto/Argon2SecureHasher.java\n+++ b/nifi-commons/nifi-security-utils/src/main/java/org/apache/nifi/security/util/crypto/Argon2SecureHasher.java\n\n@@ -53,14 +53,11 @@ public class Argon2SecureHasher implements SecureHasher {\n     private final int iterations;\n     private final int saltLength;\n \n-    private boolean usingStaticSalt;\n+    private final boolean usingStaticSalt;\n \n     // A 16 byte salt (nonce) is recommended for password hashing\n     private static final byte[] staticSalt = \"NiFi Static Salt\".getBytes(StandardCharsets.UTF_8);\n \n-    // Upper boundary for several cost parameters\n-    private static final double upperBoundary = Math.pow(2, 32) - 1;\n-\n     /**\n      * Instantiates an Argon2 secure hasher using the default cost parameters\n      * ({@code hashLength = }{@link #DEFAULT_HASH_LENGTH},\n"}}, {"oid": "dd643889523c3376d65b98701d299779539abcaf", "url": "https://github.com/apache/nifi/commit/dd643889523c3376d65b98701d299779539abcaf", "message": "NIFI-7119 Implemented parameter boundary enforcement for Argon2SecureHasher constructor.\nAdded unit tests for validating each parameter check.", "committedDate": "2020-03-09T18:53:19Z", "type": "commit"}, {"oid": "66d58b1c2214b078e4771f2e85ab41934a780808", "url": "https://github.com/apache/nifi/commit/66d58b1c2214b078e4771f2e85ab41934a780808", "message": "NIFI-7119 Refactored parameter validations. Added more test sizes to boundary checkers. Changed logger severity to error and added bounds to messages.", "committedDate": "2020-03-09T18:53:19Z", "type": "commit"}, {"oid": "66d58b1c2214b078e4771f2e85ab41934a780808", "url": "https://github.com/apache/nifi/commit/66d58b1c2214b078e4771f2e85ab41934a780808", "message": "NIFI-7119 Refactored parameter validations. Added more test sizes to boundary checkers. Changed logger severity to error and added bounds to messages.", "committedDate": "2020-03-09T18:53:19Z", "type": "forcePushed"}, {"oid": "916e0b1648d5c450dfc965e4841fb27ba6e163d9", "url": "https://github.com/apache/nifi/commit/916e0b1648d5c450dfc965e4841fb27ba6e163d9", "message": "NIFI-7119 Refactored Argon2 parameter data types to handle unsigned integer boundary values.\nUpdated unit tests.", "committedDate": "2020-03-09T19:08:47Z", "type": "commit"}]}