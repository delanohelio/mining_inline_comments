{"pr_number": 772, "pr_title": "Split Kube notifications based on scheduler type (Fenzo/Kube)", "pr_createdAt": "2020-02-13T23:11:42Z", "pr_url": "https://github.com/Netflix/titus-control-plane/pull/772", "timeline": [{"oid": "a161cf7d00d3b669f58cea173020411576f10a73", "url": "https://github.com/Netflix/titus-control-plane/commit/a161cf7d00d3b669f58cea173020411576f10a73", "message": "Split Kube notifications based on scheduler type (Fenzo/Kube)", "committedDate": "2020-02-13T23:09:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3OTE4MjA0Mw==", "url": "https://github.com/Netflix/titus-control-plane/pull/772#discussion_r379182043", "bodyText": "minor nit: rename the variable to reflect its new meaning", "author": "fabiokung", "createdAt": "2020-02-13T23:45:24Z", "path": "titus-server-master/src/main/java/com/netflix/titus/master/jobmanager/service/JobAndTaskMetrics.java", "diffHunk": "@@ -257,7 +256,7 @@ private void updateJobCounts(List<Pair<Job, List<Task>>> jobsAndTasks) {\n             if (JobFunctions.getJobDesiredSize(job) == 0) {\n                 emptyJobs++;\n             } else {\n-                boolean hasPods = tasks.stream().anyMatch(this::hasPod);\n+                boolean hasPods = tasks.stream().anyMatch(JobFunctions::hasOwnedByKubeSchedulerAttribute);", "originalCommit": "a161cf7d00d3b669f58cea173020411576f10a73", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "27fe8ec57be26fd78d0d002dab6e8b90b4451fb7", "chunk": "diff --git a/titus-server-master/src/main/java/com/netflix/titus/master/jobmanager/service/JobAndTaskMetrics.java b/titus-server-master/src/main/java/com/netflix/titus/master/jobmanager/service/JobAndTaskMetrics.java\nindex 074124a3d..7e1183e4c 100644\n--- a/titus-server-master/src/main/java/com/netflix/titus/master/jobmanager/service/JobAndTaskMetrics.java\n+++ b/titus-server-master/src/main/java/com/netflix/titus/master/jobmanager/service/JobAndTaskMetrics.java\n\n@@ -256,20 +256,20 @@ public class JobAndTaskMetrics {\n             if (JobFunctions.getJobDesiredSize(job) == 0) {\n                 emptyJobs++;\n             } else {\n-                boolean hasPods = tasks.stream().anyMatch(JobFunctions::hasOwnedByKubeSchedulerAttribute);\n+                boolean ownedByKubeScheduler = tasks.stream().anyMatch(JobFunctions::hasOwnedByKubeSchedulerAttribute);\n                 boolean serviceJob = JobFunctions.isServiceJob(job);\n \n-                if (hasPods) {\n+                if (ownedByKubeScheduler) {\n                     if (serviceJob) {\n-                        serviceJobsWithPods++;\n+                        serviceJobsOwnedByKubeScheduler++;\n                     } else {\n-                        batchJobsWithPods++;\n+                        batchJobsOwnedByKubeScheduler++;\n                     }\n                 } else {\n                     if (serviceJob) {\n-                        serviceJobsWithoutPods++;\n+                        serviceJobsOwnedByFenzo++;\n                     } else {\n-                        batchJobsWithoutPods++;\n+                        batchJobsOwnedByFenzo++;\n                     }\n                 }\n             }\n"}}, {"oid": "27fe8ec57be26fd78d0d002dab6e8b90b4451fb7", "url": "https://github.com/Netflix/titus-control-plane/commit/27fe8ec57be26fd78d0d002dab6e8b90b4451fb7", "message": "Code review updates", "committedDate": "2020-02-14T16:14:38Z", "type": "commit"}]}