{"pr_number": 8077, "pr_title": "Add API Categories Feature", "pr_createdAt": "2020-01-14T04:22:50Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8077", "timeline": [{"oid": "dba621a58286ee6bac5586b61ae732c01ed866c8", "url": "https://github.com/wso2/carbon-apimgt/commit/dba621a58286ee6bac5586b61ae732c01ed866c8", "message": "Add api-categories/ GET POST resources to admin-api", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "79efa37a688b09f0015afe0ecb298a7746366f3f", "url": "https://github.com/wso2/carbon-apimgt/commit/79efa37a688b09f0015afe0ecb298a7746366f3f", "message": "Add GET /api-categories resource to publisher and store REST APIs", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "098ad2bca3a0b69a79e394ea68e999f0a700b910", "url": "https://github.com/wso2/carbon-apimgt/commit/098ad2bca3a0b69a79e394ea68e999f0a700b910", "message": "Support api search by api-category", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "a7d8d893964b66fb17c09705c114c9b4ce027f62", "url": "https://github.com/wso2/carbon-apimgt/commit/a7d8d893964b66fb17c09705c114c9b4ce027f62", "message": "Add api-categories PUT resource", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "f49f7e75f0f243862c5d9325eab642fa9b14dede", "url": "https://github.com/wso2/carbon-apimgt/commit/f49f7e75f0f243862c5d9325eab642fa9b14dede", "message": "Store Category UUID in api rxt for category to API mapping", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "6f6ad8182a69a17052e7301a3b6a3b551f3649d0", "url": "https://github.com/wso2/carbon-apimgt/commit/6f6ad8182a69a17052e7301a3b6a3b551f3649d0", "message": "Allow to modify category name in category update", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "d4d9ed9bb5d64258bb9106110fd00837cf18d618", "url": "https://github.com/wso2/carbon-apimgt/commit/d4d9ed9bb5d64258bb9106110fd00837cf18d618", "message": "Add api-categories delete resource", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "39e2945b40b253eba523387cc74dc463a7cd8ef1", "url": "https://github.com/wso2/carbon-apimgt/commit/39e2945b40b253eba523387cc74dc463a7cd8ef1", "message": "Add admin jaggery UI for API Categories", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "7384009ac5615291ef21cd72bcb1f51ad22b5014", "url": "https://github.com/wso2/carbon-apimgt/commit/7384009ac5615291ef21cd72bcb1f51ad22b5014", "message": "Move methods in APICategoryUtil to APIAdmin", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "b99faaa0fe4237a2394e1e213a0425068f3c0850", "url": "https://github.com/wso2/carbon-apimgt/commit/b99faaa0fe4237a2394e1e213a0425068f3c0850", "message": "Add Publisher UI changes to support API Categories", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "32e75738b2743a83d52f154cb00299fe63e70fb0", "url": "https://github.com/wso2/carbon-apimgt/commit/32e75738b2743a83d52f154cb00299fe63e70fb0", "message": "Add API-Categories to APIProducts", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "25c4daeb71f6d33c7e7f9c2b0213901a5b2874fa", "url": "https://github.com/wso2/carbon-apimgt/commit/25c4daeb71f6d33c7e7f9c2b0213901a5b2874fa", "message": "Add devportal UI changes to support API Categories", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "963fd7ed24a6e4f650068d87923c5a25ef9bfb30", "url": "https://github.com/wso2/carbon-apimgt/commit/963fd7ed24a6e4f650068d87923c5a25ef9bfb30", "message": "Add api category thumbnail rest API", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "a0fbea4fe0f78dfbae321d4b6d16b63147579008", "url": "https://github.com/wso2/carbon-apimgt/commit/a0fbea4fe0f78dfbae321d4b6d16b63147579008", "message": "Fix merge conflict", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "f11338618d3ba2cc77b3c68d32a33f5b802af244", "url": "https://github.com/wso2/carbon-apimgt/commit/f11338618d3ba2cc77b3c68d32a33f5b802af244", "message": "Fix issues in API Category feature", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "d4398a1d83c66a7038d436d234ceb3321e2d91d3", "url": "https://github.com/wso2/carbon-apimgt/commit/d4398a1d83c66a7038d436d234ceb3321e2d91d3", "message": "revert devportal changes to support api-categories", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "d6a36ca8db6ebc8cdd4ae599ed5085cfd1da2e82", "url": "https://github.com/wso2/carbon-apimgt/commit/d6a36ca8db6ebc8cdd4ae599ed5085cfd1da2e82", "message": "add devportal changes for category feature", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "228d957de95100c36ec585eff38942aec7badf8b", "url": "https://github.com/wso2/carbon-apimgt/commit/228d957de95100c36ec585eff38942aec7badf8b", "message": "Revert back to using category name in rxt to fix issues with content search", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "cf7cb5d832f502ae7545ea557d1e6de55758a9da", "url": "https://github.com/wso2/carbon-apimgt/commit/cf7cb5d832f502ae7545ea557d1e6de55758a9da", "message": "Add no of APIs column to category listing page", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "eca9fec06c0d3b46f91ffcea5e5f5d55f96bdd02", "url": "https://github.com/wso2/carbon-apimgt/commit/eca9fec06c0d3b46f91ffcea5e5f5d55f96bdd02", "message": "Block category deletion when there are attached APIs", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "633923b9262763032f8266e67cb13b304ba33b1f", "url": "https://github.com/wso2/carbon-apimgt/commit/633923b9262763032f8266e67cb13b304ba33b1f", "message": "Rename API Category side menu to API Categories", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "3a9ac35956be23f394e499206ff0657d9237b289", "url": "https://github.com/wso2/carbon-apimgt/commit/3a9ac35956be23f394e499206ff0657d9237b289", "message": "Add API category validation", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "d327850f28009561c864cfd42ffa2e5711d87299", "url": "https://github.com/wso2/carbon-apimgt/commit/d327850f28009561c864cfd42ffa2e5711d87299", "message": "Remove api-category thumbnail api", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "19d206bfad4476a311621e16f3b395124fa0ee54", "url": "https://github.com/wso2/carbon-apimgt/commit/19d206bfad4476a311621e16f3b395124fa0ee54", "message": "Add db changes", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "fd18d17648eb58ae157cdc201c200dc011e1def5", "url": "https://github.com/wso2/carbon-apimgt/commit/fd18d17648eb58ae157cdc201c200dc011e1def5", "message": "Fix NPEs while running unit tests", "committedDate": "2020-01-13T15:11:11Z", "type": "commit"}, {"oid": "112a10e0698934b9abd70839432b998009efb292", "url": "https://github.com/wso2/carbon-apimgt/commit/112a10e0698934b9abd70839432b998009efb292", "message": "Refactor API Categories code", "committedDate": "2020-01-14T04:15:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE1MDE0Ng==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366150146", "bodyText": "extra space", "author": "ruks", "createdAt": "2020-01-14T04:40:50Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java", "diffHunk": "@@ -280,4 +287,70 @@ public void addBotDataEmailConfiguration(String email) throws APIManagementExcep\n     public void deleteBotDataEmailList(String uuid) throws APIManagementException, SQLException {\n         apiMgtDAO.deleteBotDataEmailList(uuid);\n     }\n+\n+    public APICategory addCategory(APICategory category, String userName) throws APIManagementException {\n+        int tenantID = APIUtil.getTenantId(userName);\n+        if (isCategoryNameExists(category.getName(), null, tenantID)) {\n+            APIUtil.handleException(\"Category with name '\" + category.getName() + \"' already exists\");\n+        }\n+        return apiMgtDAO.addCategory(tenantID, category);\n+    }\n+\n+    public void updateCategory(APICategory apiCategory) throws APIManagementException {\n+        apiMgtDAO.updateCategory(apiCategory);\n+    }\n+\n+    public void deleteCategory(String categoryID, String username) throws APIManagementException {\n+        APICategory category = getAPICategoryByID(categoryID);\n+        int attchedAPICount = isCategoryAttached(category, username);\n+        if ( attchedAPICount > 0) {\n+            APIUtil.handleException(\"Unable to delete the category. It is attached to API(s)\");\n+        }\n+        apiMgtDAO.deleteCategory(categoryID);\n+    }\n+\n+    public List<APICategory> getAllAPICategoriesOfTenant(int tenantId) throws APIManagementException {\n+        return apiMgtDAO.getAllCategories(tenantId);\n+    }\n+\n+    public List<APICategory> getAllAPICategoriesOfTenantForAdminListing(String username) throws APIManagementException{\n+        int tenantID = APIUtil.getTenantId(username);\n+        List<APICategory> categories = getAllAPICategoriesOfTenant(tenantID);\n+        if (categories.size() > 0) {\n+            for (APICategory category : categories) {\n+                int length = isCategoryAttached(category, username);\n+                category.setNumberOfAPIs(length);\n+            }\n+", "originalCommit": "112a10e0698934b9abd70839432b998009efb292", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE2Njk2Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366166963", "bodyText": "fixed in e646d5a", "author": "msm1992", "createdAt": "2020-01-14T06:16:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE1MDE0Ng=="}], "type": "inlineReview", "revised_code": {"commit": "e646d5a8cbf82d6fb2ba2cd090e252a4dfaca540", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\nindex 6094872203c..87173e2f665 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\n\n@@ -321,7 +321,6 @@ public class APIAdminImpl implements APIAdmin {\n                 int length = isCategoryAttached(category, username);\n                 category.setNumberOfAPIs(length);\n             }\n-\n         }\n         return categories;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE1MDI3NA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366150274", "bodyText": "no need both logging and throwing exception", "author": "ruks", "createdAt": "2020-01-14T04:41:39Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java", "diffHunk": "@@ -280,4 +287,70 @@ public void addBotDataEmailConfiguration(String email) throws APIManagementExcep\n     public void deleteBotDataEmailList(String uuid) throws APIManagementException, SQLException {\n         apiMgtDAO.deleteBotDataEmailList(uuid);\n     }\n+\n+    public APICategory addCategory(APICategory category, String userName) throws APIManagementException {\n+        int tenantID = APIUtil.getTenantId(userName);\n+        if (isCategoryNameExists(category.getName(), null, tenantID)) {\n+            APIUtil.handleException(\"Category with name '\" + category.getName() + \"' already exists\");\n+        }\n+        return apiMgtDAO.addCategory(tenantID, category);\n+    }\n+\n+    public void updateCategory(APICategory apiCategory) throws APIManagementException {\n+        apiMgtDAO.updateCategory(apiCategory);\n+    }\n+\n+    public void deleteCategory(String categoryID, String username) throws APIManagementException {\n+        APICategory category = getAPICategoryByID(categoryID);\n+        int attchedAPICount = isCategoryAttached(category, username);\n+        if ( attchedAPICount > 0) {\n+            APIUtil.handleException(\"Unable to delete the category. It is attached to API(s)\");\n+        }\n+        apiMgtDAO.deleteCategory(categoryID);\n+    }\n+\n+    public List<APICategory> getAllAPICategoriesOfTenant(int tenantId) throws APIManagementException {\n+        return apiMgtDAO.getAllCategories(tenantId);\n+    }\n+\n+    public List<APICategory> getAllAPICategoriesOfTenantForAdminListing(String username) throws APIManagementException{\n+        int tenantID = APIUtil.getTenantId(username);\n+        List<APICategory> categories = getAllAPICategoriesOfTenant(tenantID);\n+        if (categories.size() > 0) {\n+            for (APICategory category : categories) {\n+                int length = isCategoryAttached(category, username);\n+                category.setNumberOfAPIs(length);\n+            }\n+\n+        }\n+        return categories;\n+    }\n+\n+    public boolean isCategoryNameExists(String categoryName, String uuid, int tenantID) throws APIManagementException {\n+        return ApiMgtDAO.getInstance().isAPICategoryNameExists(categoryName, uuid, tenantID);\n+    }\n+\n+    public APICategory getAPICategoryByID(String apiCategoryId) throws APIManagementException {\n+        APICategory apiCategory = ApiMgtDAO.getInstance().getAPICategoryByID(apiCategoryId);\n+        if (apiCategory != null) {\n+            return apiCategory;\n+        }else {\n+            String msg = \"Failed to get APICategory. API category corresponding to UUID \" + apiCategoryId\n+                    + \" does not exist\";\n+            log.error(msg);", "originalCommit": "112a10e0698934b9abd70839432b998009efb292", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE2NzAwMA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366167000", "bodyText": "fixed in e646d5a", "author": "msm1992", "createdAt": "2020-01-14T06:16:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE1MDI3NA=="}], "type": "inlineReview", "revised_code": {"commit": "e646d5a8cbf82d6fb2ba2cd090e252a4dfaca540", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\nindex 6094872203c..87173e2f665 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\n\n@@ -321,7 +321,6 @@ public class APIAdminImpl implements APIAdmin {\n                 int length = isCategoryAttached(category, username);\n                 category.setNumberOfAPIs(length);\n             }\n-\n         }\n         return categories;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE1MDQ5MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366150490", "bodyText": "extra spaces in this method", "author": "ruks", "createdAt": "2020-01-14T04:43:00Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java", "diffHunk": "@@ -14321,4 +14322,167 @@ public void removeExpiredJWTs() throws APIManagementException {\n             handleException(\"Error while deleting expired JWTs from revoke table.\", e);\n         }\n     }\n+\n+    /**\n+     * Adds an API category\n+     *\n+     * @param tenantID     Logged in user's tenant ID\n+     * @param category     Category\n+     * @return Category\n+     */\n+    public APICategory addCategory(int tenantID, APICategory category) throws APIManagementException {\n+        String uuid = UUID.randomUUID().toString();\n+        category.setId(uuid);\n+        try (Connection connection = APIMgtDBUtil.getConnection();\n+            PreparedStatement statement = connection.prepareStatement(SQLConstants.ADD_CATEGORY_SQL)) {\n+            statement.setString(1, uuid);\n+            statement.setString(2, category.getName());\n+            statement.setString(3, category.getDescription());\n+            statement.setInt(4, tenantID);\n+            statement.executeUpdate();\n+        } catch (SQLException e) {\n+            handleException(\"Failed to add Category: \" + uuid, e);\n+        }\n+        return category;\n+    }\n+\n+    /**\n+     * Update API Category\n+     *\n+     * @param apiCategory API category object with updated details\n+     * @throws APIManagementException\n+     */\n+    public void updateCategory(APICategory apiCategory) throws APIManagementException {\n+        try (Connection connection = APIMgtDBUtil.getConnection();\n+                PreparedStatement statement = connection.prepareStatement(SQLConstants.UPDATE_API_CATEGORY)) {\n+            statement.setString(1, apiCategory.getDescription());\n+            statement.setString(2, apiCategory.getName());\n+            statement.setString(3, apiCategory.getId());\n+            statement.execute();\n+        } catch (SQLException e) {\n+            handleException(\"Failed to update API Category : \" + apiCategory.getName() + \" of tenant \" +\n+                    APIUtil.getTenantDomainFromTenantId(apiCategory.getTenantID()), e);\n+        }\n+    }\n+\n+    /**\n+     * Get all available API categories of the tenant\n+     *\n+     * @param tenantID\n+     * @return API Categories List\n+     */\n+    public List<APICategory> getAllCategories(int tenantID) throws APIManagementException {\n+        List<APICategory> categoriesList = new ArrayList<>();\n+        try (Connection connection = APIMgtDBUtil.getConnection();\n+            PreparedStatement statement = connection.prepareStatement(SQLConstants.GET_CATEGORIES_BY_TENANT_ID_SQL)) {\n+            statement.setInt(1, tenantID);\n+\n+            ResultSet rs = statement.executeQuery();\n+            while(rs.next()) {\n+                String id = rs.getString(\"UUID\");\n+                String name = rs.getString(\"NAME\");\n+                String description = rs.getString(\"DESCRIPTION\");\n+\n+                APICategory category = new APICategory();\n+                category.setId(id);\n+                category.setName(name);\n+                category.setDescription(description);\n+                category.setTenantID(tenantID);\n+\n+                categoriesList.add(category);\n+            }\n+        } catch (SQLException e) {\n+            handleException(\"Failed to retrieve API categories for tenant \" + tenantID, e);\n+        }\n+", "originalCommit": "112a10e0698934b9abd70839432b998009efb292", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE2NzAzMw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366167033", "bodyText": "fixed in e646d5a", "author": "msm1992", "createdAt": "2020-01-14T06:17:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjE1MDQ5MA=="}], "type": "inlineReview", "revised_code": {"commit": "e646d5a8cbf82d6fb2ba2cd090e252a4dfaca540", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java\nindex 24bb94b2e0e..e7dcdd37943 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/dao/ApiMgtDAO.java\n\n@@ -14394,7 +14394,6 @@ public class ApiMgtDAO {\n         } catch (SQLException e) {\n             handleException(\"Failed to retrieve API categories for tenant \" + tenantID, e);\n         }\n-\n         return categoriesList;\n     }\n \n"}}, {"oid": "e646d5a8cbf82d6fb2ba2cd090e252a4dfaca540", "url": "https://github.com/wso2/carbon-apimgt/commit/e646d5a8cbf82d6fb2ba2cd090e252a4dfaca540", "message": "Add review fixes", "committedDate": "2020-01-14T06:15:29Z", "type": "commit"}, {"oid": "c6c0ee00e2fc4d641567d19b696b59a2a92f077b", "url": "https://github.com/wso2/carbon-apimgt/commit/c6c0ee00e2fc4d641567d19b696b59a2a92f077b", "message": "Fix formatting issues in jag files", "committedDate": "2020-01-14T09:26:18Z", "type": "commit"}, {"oid": "3dda94e83243cdd801e9cf1a1dc4ce3ade4d00ad", "url": "https://github.com/wso2/carbon-apimgt/commit/3dda94e83243cdd801e9cf1a1dc4ce3ade4d00ad", "message": "Fix formatting issues", "committedDate": "2020-01-14T09:42:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI0MDA5OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366240099", "bodyText": "Formatting issue", "author": "mushthaq33", "createdAt": "2020-01-14T09:49:08Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java", "diffHunk": "@@ -0,0 +1,128 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+\n+package org.wso2.carbon.apimgt.rest.api.admin.impl;\n+\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.api.APIAdmin;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.model.APICategory;\n+import org.wso2.carbon.apimgt.impl.APIAdminImpl;\n+import org.wso2.carbon.apimgt.impl.utils.APIUtil;\n+import org.wso2.carbon.apimgt.rest.api.admin.ApiCategoriesApiService;\n+import org.wso2.carbon.apimgt.rest.api.admin.dto.APICategoryDTO;\n+import org.wso2.carbon.apimgt.rest.api.admin.dto.APICategoryListDTO;\n+import org.wso2.carbon.apimgt.rest.api.admin.utils.mappings.APICategoryMappingUtil;\n+import org.wso2.carbon.apimgt.rest.api.util.RestApiConstants;\n+import org.wso2.carbon.apimgt.rest.api.util.utils.RestApiUtil;\n+import org.wso2.carbon.utils.multitenancy.MultitenantUtils;\n+\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.List;\n+import javax.ws.rs.core.Response;\n+\n+public class ApiCategoriesApiServiceImpl extends ApiCategoriesApiService {\n+    private static final Log log = LogFactory.getLog(ApiCategoriesApiServiceImpl.class);\n+\n+    public Response apiCategoriesGet(){\n+        try {\n+            APIAdmin apiAdmin = new APIAdminImpl();\n+            String tenantDomain = RestApiUtil.getLoggedInUserTenantDomain();\n+            int tenantID = APIUtil.getTenantIdFromTenantDomain(tenantDomain);\n+            List<APICategory> categoryList = apiAdmin.getAllAPICategoriesOfTenant(tenantID);\n+            APICategoryListDTO categoryListDTO =\n+                    APICategoryMappingUtil.fromCategoryListToCategoryListDTO(categoryList);\n+            return Response.ok().entity(categoryListDTO).build();\n+        } catch (APIManagementException e) {\n+            String errorMessage = \"Error while retrieving API categories\";\n+            RestApiUtil.handleInternalServerError(errorMessage, e, log);\n+        }\n+        return null;\n+    }\n+\n+    public Response apiCategoriesPost(APICategoryDTO body){", "originalCommit": "3dda94e83243cdd801e9cf1a1dc4ce3ade4d00ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI3MjgwMQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366272801", "bodyText": "fixed", "author": "msm1992", "createdAt": "2020-01-14T10:54:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI0MDA5OQ=="}], "type": "inlineReview", "revised_code": {"commit": "97cf5d4612b07a004822eb67bf9600b230a8f492", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java\nindex e658627a2ea..67adc4485b8 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java\n\n@@ -40,7 +40,7 @@ import javax.ws.rs.core.Response;\n public class ApiCategoriesApiServiceImpl extends ApiCategoriesApiService {\n     private static final Log log = LogFactory.getLog(ApiCategoriesApiServiceImpl.class);\n \n-    public Response apiCategoriesGet(){\n+    public Response apiCategoriesGet() {\n         try {\n             APIAdmin apiAdmin = new APIAdminImpl();\n             String tenantDomain = RestApiUtil.getLoggedInUserTenantDomain();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI0MDE2Mg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366240162", "bodyText": "Formatting issue", "author": "mushthaq33", "createdAt": "2020-01-14T09:49:15Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java", "diffHunk": "@@ -0,0 +1,128 @@\n+/*\n+ *  Copyright (c) 2020, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n+ *\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ *\n+ *  http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+\n+package org.wso2.carbon.apimgt.rest.api.admin.impl;\n+\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.wso2.carbon.apimgt.api.APIAdmin;\n+import org.wso2.carbon.apimgt.api.APIManagementException;\n+import org.wso2.carbon.apimgt.api.model.APICategory;\n+import org.wso2.carbon.apimgt.impl.APIAdminImpl;\n+import org.wso2.carbon.apimgt.impl.utils.APIUtil;\n+import org.wso2.carbon.apimgt.rest.api.admin.ApiCategoriesApiService;\n+import org.wso2.carbon.apimgt.rest.api.admin.dto.APICategoryDTO;\n+import org.wso2.carbon.apimgt.rest.api.admin.dto.APICategoryListDTO;\n+import org.wso2.carbon.apimgt.rest.api.admin.utils.mappings.APICategoryMappingUtil;\n+import org.wso2.carbon.apimgt.rest.api.util.RestApiConstants;\n+import org.wso2.carbon.apimgt.rest.api.util.utils.RestApiUtil;\n+import org.wso2.carbon.utils.multitenancy.MultitenantUtils;\n+\n+import java.net.URI;\n+import java.net.URISyntaxException;\n+import java.util.List;\n+import javax.ws.rs.core.Response;\n+\n+public class ApiCategoriesApiServiceImpl extends ApiCategoriesApiService {\n+    private static final Log log = LogFactory.getLog(ApiCategoriesApiServiceImpl.class);\n+\n+    public Response apiCategoriesGet(){", "originalCommit": "3dda94e83243cdd801e9cf1a1dc4ce3ade4d00ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI3Mjg4MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366272880", "bodyText": "fixed", "author": "msm1992", "createdAt": "2020-01-14T10:55:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI0MDE2Mg=="}], "type": "inlineReview", "revised_code": {"commit": "97cf5d4612b07a004822eb67bf9600b230a8f492", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java\nindex e658627a2ea..67adc4485b8 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApiCategoriesApiServiceImpl.java\n\n@@ -40,7 +40,7 @@ import javax.ws.rs.core.Response;\n public class ApiCategoriesApiServiceImpl extends ApiCategoriesApiService {\n     private static final Log log = LogFactory.getLog(ApiCategoriesApiServiceImpl.class);\n \n-    public Response apiCategoriesGet(){\n+    public Response apiCategoriesGet() {\n         try {\n             APIAdmin apiAdmin = new APIAdminImpl();\n             String tenantDomain = RestApiUtil.getLoggedInUserTenantDomain();\n"}}, {"oid": "23c74606dfc0a984514b54746a88230dd537e013", "url": "https://github.com/wso2/carbon-apimgt/commit/23c74606dfc0a984514b54746a88230dd537e013", "message": "Fix formatting issues", "committedDate": "2020-01-14T10:02:15Z", "type": "commit"}, {"oid": "97cf5d4612b07a004822eb67bf9600b230a8f492", "url": "https://github.com/wso2/carbon-apimgt/commit/97cf5d4612b07a004822eb67bf9600b230a8f492", "message": "Fix formatting issues", "committedDate": "2020-01-14T10:25:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI2MzU4Nw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366263587", "bodyText": "There is an additional space", "author": "mushthaq33", "createdAt": "2020-01-14T10:35:19Z", "path": "components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java", "diffHunk": "@@ -280,4 +287,68 @@ public void addBotDataEmailConfiguration(String email) throws APIManagementExcep\n     public void deleteBotDataEmailList(String uuid) throws APIManagementException, SQLException {\n         apiMgtDAO.deleteBotDataEmailList(uuid);\n     }\n+\n+    public APICategory addCategory(APICategory category, String userName) throws APIManagementException {\n+        int tenantID = APIUtil.getTenantId(userName);\n+        if (isCategoryNameExists(category.getName(), null, tenantID)) {\n+            APIUtil.handleException(\"Category with name '\" + category.getName() + \"' already exists\");\n+        }\n+        return apiMgtDAO.addCategory(tenantID, category);\n+    }\n+\n+    public void updateCategory(APICategory apiCategory) throws APIManagementException {\n+        apiMgtDAO.updateCategory(apiCategory);\n+    }\n+\n+    public void deleteCategory(String categoryID, String username) throws APIManagementException {\n+        APICategory category = getAPICategoryByID(categoryID);\n+        int attchedAPICount = isCategoryAttached(category, username);\n+        if ( attchedAPICount > 0) {", "originalCommit": "97cf5d4612b07a004822eb67bf9600b230a8f492", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI3Mzk3Mw==", "url": "https://github.com/wso2/carbon-apimgt/pull/8077#discussion_r366273973", "bodyText": "fixed", "author": "msm1992", "createdAt": "2020-01-14T10:57:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjI2MzU4Nw=="}], "type": "inlineReview", "revised_code": {"commit": "db6d8a90fe198806ba56e067c845be921e342a3d", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\nindex 87173e2f665..ac1870d832b 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.impl/src/main/java/org/wso2/carbon/apimgt/impl/APIAdminImpl.java\n\n@@ -303,7 +303,7 @@ public class APIAdminImpl implements APIAdmin {\n     public void deleteCategory(String categoryID, String username) throws APIManagementException {\n         APICategory category = getAPICategoryByID(categoryID);\n         int attchedAPICount = isCategoryAttached(category, username);\n-        if ( attchedAPICount > 0) {\n+        if (attchedAPICount > 0) {\n             APIUtil.handleException(\"Unable to delete the category. It is attached to API(s)\");\n         }\n         apiMgtDAO.deleteCategory(categoryID);\n"}}, {"oid": "db6d8a90fe198806ba56e067c845be921e342a3d", "url": "https://github.com/wso2/carbon-apimgt/commit/db6d8a90fe198806ba56e067c845be921e342a3d", "message": "Fix formatting issues", "committedDate": "2020-01-14T10:56:28Z", "type": "commit"}]}