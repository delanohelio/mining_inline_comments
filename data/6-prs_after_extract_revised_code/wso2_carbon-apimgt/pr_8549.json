{"pr_number": 8549, "pr_title": "[Admin REST API] - API to update block condition status", "pr_createdAt": "2020-05-21T10:52:48Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8549", "timeline": [{"oid": "b76bd36c4a4f91faceddacc01c02ef8edf0083ba", "url": "https://github.com/wso2/carbon-apimgt/commit/b76bd36c4a4f91faceddacc01c02ef8edf0083ba", "message": "Added REST API to update condition status and reformatted the code.", "committedDate": "2020-05-21T10:46:57Z", "type": "commit"}, {"oid": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca", "url": "https://github.com/wso2/carbon-apimgt/commit/13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca", "message": "Optimised unused imports.", "committedDate": "2020-05-21T10:51:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU4ODczMg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8549#discussion_r428588732", "bodyText": "Don't we need to throw 404 - handleResourceNotFoundError within else part to handle the case if the condition does not exist", "author": "vithu30", "createdAt": "2020-05-21T11:09:48Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin.v1/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/v1/impl/ThrottlingApiServiceImpl.java", "diffHunk": "@@ -979,6 +987,48 @@ public Response throttlingBlacklistConditionIdDelete(String conditionId, String\n         return null;\n     }\n \n+    /**\n+     * Updates an existing condition status of a blocking condition\n+     *\n+     * @param conditionId       Id of the block condition\n+     * @param body              content to update\n+     * @param contentType       Content-Type header\n+     * @param ifMatch           If-Match header value\n+     * @param ifUnmodifiedSince If-Unmodified-Since header value\n+     * @return 200 response if successful\n+     */\n+    @Override\n+    public Response throttlingBlacklistConditionIdPatch(String conditionId, BlockingConditionStatusDTO body,\n+                                                        String contentType, String ifMatch, String ifUnmodifiedSince,\n+                                                        MessageContext messageContext) {\n+        try {\n+            APIProvider apiProvider = RestApiUtil.getLoggedInUserProvider();\n+            String username = RestApiUtil.getLoggedInUsername();\n+\n+            //This will give BlockConditionNotFoundException if there's no block condition exists with UUID\n+            BlockConditionsDTO existingCondition = apiProvider.getBlockConditionByUUID(conditionId);\n+            if (!RestApiAdminUtils.isBlockConditionAccessibleToUser(username, existingCondition)) {\n+                RestApiUtil.handleAuthorizationFailure(RestApiConstants.RESOURCE_BLOCK_CONDITION, conditionId, log);", "originalCommit": "13fc6762fe81c9ef5b0e1a69f8bfeff2b1a227ca", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODcxOTY0OQ==", "url": "https://github.com/wso2/carbon-apimgt/pull/8549#discussion_r428719649", "bodyText": "404 - handleResourceNotFoundError is handled in the catch block", "author": "Meruja", "createdAt": "2020-05-21T15:15:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODU4ODczMg=="}], "type": "inlineReview", "revised_code": null}]}