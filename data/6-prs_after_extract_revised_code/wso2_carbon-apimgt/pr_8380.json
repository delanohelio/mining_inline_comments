{"pr_number": 8380, "pr_title": "Modifying listing all the applications for a tenant", "pr_createdAt": "2020-03-21T06:53:03Z", "pr_url": "https://github.com/wso2/carbon-apimgt/pull/8380", "timeline": [{"oid": "6efefdb882bb346df61f734c16ae8de8b4a1a006", "url": "https://github.com/wso2/carbon-apimgt/commit/6efefdb882bb346df61f734c16ae8de8b4a1a006", "message": "modify listing all applications for a tenant", "committedDate": "2020-03-20T16:40:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwNzUzNg==", "url": "https://github.com/wso2/carbon-apimgt/pull/8380#discussion_r396207536", "bodyText": "formatting issue", "author": "malinthaprasan", "createdAt": "2020-03-23T04:26:52Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java", "diffHunk": "@@ -65,8 +69,18 @@ public Response applicationsGet(String user, Integer limit, Integer offset, Stri\n                     return Response.status(Response.Status.FORBIDDEN).entity(errorMsg).build();\n                 }\n                 APIConsumer apiConsumer = APIManagerFactory.getInstance().getAPIConsumer(user);\n-                allMatchedApps = apiConsumer.getApplicationsByOwner(user);\n \n+                // If no user is passed, get the applications for the tenant (not only for the user)\n+                if (givenUser == null || StringUtils.isEmpty(givenUser)) {\n+                    APIAdmin apiAdmin = new APIAdminImpl();\n+                    int tenantId = APIUtil.getTenantId(user);\n+                    allMatchedApps = apiAdmin.getApplicationsByTenantIdWithPagination(tenantId, 0, limit,\n+                            \"\", \"\", ApplicationMappingUtil.getApplicationSortByField(\"name\"),\n+                            RestApiConstants.DEFAULT_SORT_ORDER).toArray(new Application[0]);\n+                }\n+                else {", "originalCommit": "6efefdb882bb346df61f734c16ae8de8b4a1a006", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8cb57edc58e7946d0fd971d48e50a865f18ec411", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java\nindex 378cd8d4a27..cadef97fbe7 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java\n\n@@ -75,10 +76,9 @@ public class ApplicationsApiServiceImpl extends ApplicationsApiService {\n                     APIAdmin apiAdmin = new APIAdminImpl();\n                     int tenantId = APIUtil.getTenantId(user);\n                     allMatchedApps = apiAdmin.getApplicationsByTenantIdWithPagination(tenantId, 0, limit,\n-                            \"\", \"\", ApplicationMappingUtil.getApplicationSortByField(\"name\"),\n+                            \"\", \"\", APIConstants.APPLICATION_NAME,\n                             RestApiConstants.DEFAULT_SORT_ORDER).toArray(new Application[0]);\n-                }\n-                else {\n+                } else {\n                     allMatchedApps = apiConsumer.getApplicationsByOwner(user);\n                 }\n             } else { // flow at migration process\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjIwNzU3MA==", "url": "https://github.com/wso2/carbon-apimgt/pull/8380#discussion_r396207570", "bodyText": "Please use a const for \"name\"", "author": "malinthaprasan", "createdAt": "2020-03-23T04:27:03Z", "path": "components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java", "diffHunk": "@@ -65,8 +69,18 @@ public Response applicationsGet(String user, Integer limit, Integer offset, Stri\n                     return Response.status(Response.Status.FORBIDDEN).entity(errorMsg).build();\n                 }\n                 APIConsumer apiConsumer = APIManagerFactory.getInstance().getAPIConsumer(user);\n-                allMatchedApps = apiConsumer.getApplicationsByOwner(user);\n \n+                // If no user is passed, get the applications for the tenant (not only for the user)\n+                if (givenUser == null || StringUtils.isEmpty(givenUser)) {\n+                    APIAdmin apiAdmin = new APIAdminImpl();\n+                    int tenantId = APIUtil.getTenantId(user);\n+                    allMatchedApps = apiAdmin.getApplicationsByTenantIdWithPagination(tenantId, 0, limit,\n+                            \"\", \"\", ApplicationMappingUtil.getApplicationSortByField(\"name\"),", "originalCommit": "6efefdb882bb346df61f734c16ae8de8b4a1a006", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8cb57edc58e7946d0fd971d48e50a865f18ec411", "chunk": "diff --git a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java\nindex 378cd8d4a27..cadef97fbe7 100644\n--- a/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java\n+++ b/components/apimgt/org.wso2.carbon.apimgt.rest.api.admin/src/main/java/org/wso2/carbon/apimgt/rest/api/admin/impl/ApplicationsApiServiceImpl.java\n\n@@ -75,10 +76,9 @@ public class ApplicationsApiServiceImpl extends ApplicationsApiService {\n                     APIAdmin apiAdmin = new APIAdminImpl();\n                     int tenantId = APIUtil.getTenantId(user);\n                     allMatchedApps = apiAdmin.getApplicationsByTenantIdWithPagination(tenantId, 0, limit,\n-                            \"\", \"\", ApplicationMappingUtil.getApplicationSortByField(\"name\"),\n+                            \"\", \"\", APIConstants.APPLICATION_NAME,\n                             RestApiConstants.DEFAULT_SORT_ORDER).toArray(new Application[0]);\n-                }\n-                else {\n+                } else {\n                     allMatchedApps = apiConsumer.getApplicationsByOwner(user);\n                 }\n             } else { // flow at migration process\n"}}, {"oid": "8cb57edc58e7946d0fd971d48e50a865f18ec411", "url": "https://github.com/wso2/carbon-apimgt/commit/8cb57edc58e7946d0fd971d48e50a865f18ec411", "message": "change formatting issues", "committedDate": "2020-03-23T08:34:32Z", "type": "commit"}]}