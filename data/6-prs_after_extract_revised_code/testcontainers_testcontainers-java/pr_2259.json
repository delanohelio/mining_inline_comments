{"pr_number": 2259, "pr_title": "Expand Container `dependsOn` parameters to accept `Iterable`", "pr_createdAt": "2020-01-18T19:49:15Z", "pr_url": "https://github.com/testcontainers/testcontainers-java/pull/2259", "timeline": [{"oid": "de987ac76fedd5422accf7dd374aeee11f24a94d", "url": "https://github.com/testcontainers/testcontainers-java/commit/de987ac76fedd5422accf7dd374aeee11f24a94d", "message": "Expand `dependsOn` parameters to accept `Iterable`", "committedDate": "2020-01-18T19:46:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI0NTExMw==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2259#discussion_r368245113", "bodyText": "Note that there seem to be a lot of import movements. I'm not sure why this is suddenly happening, but I'm confident that the .editorconfig rules we have set up are being respected:\n[*.java]\nindent_style = space\nindent_size = 4\n# Never use star imports\nij_java_names_count_to_use_import_on_demand = 99\nij_java_class_count_to_use_import_on_demand = 99\nij_java_layout_static_imports_separately = true\n\nMaybe recent edits to these files have not been picking up the rules?", "author": "rnorth", "createdAt": "2020-01-18T19:51:30Z", "path": "core/src/main/java/org/testcontainers/containers/GenericContainer.java", "diffHunk": "@@ -26,9 +26,6 @@\n import lombok.Setter;\n import lombok.SneakyThrows;\n import org.apache.commons.codec.digest.DigestUtils;\n-import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;", "originalCommit": "de987ac76fedd5422accf7dd374aeee11f24a94d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c50ee500b37cc2b9f3d242a87e96993c8e9d7f85", "chunk": "diff --git a/core/src/main/java/org/testcontainers/containers/GenericContainer.java b/core/src/main/java/org/testcontainers/containers/GenericContainer.java\nindex c3aaef1e..945d1e1a 100644\n--- a/core/src/main/java/org/testcontainers/containers/GenericContainer.java\n+++ b/core/src/main/java/org/testcontainers/containers/GenericContainer.java\n\n@@ -20,12 +20,12 @@ import com.github.dockerjava.api.model.VolumesFrom;\n import com.google.common.annotations.VisibleForTesting;\n import com.google.common.base.Strings;\n import com.google.common.collect.ImmutableMap;\n+import com.google.common.hash.Hashing;\n import lombok.AccessLevel;\n import lombok.Data;\n import lombok.NonNull;\n import lombok.Setter;\n import lombok.SneakyThrows;\n-import org.apache.commons.codec.digest.DigestUtils;\n import org.apache.commons.io.FileUtils;\n import org.apache.commons.lang.StringUtils;\n import org.jetbrains.annotations.NotNull;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYwMDQ5NA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2259#discussion_r385600494", "bodyText": "this will break binary compatibility", "author": "bsideup", "createdAt": "2020-02-28T09:51:18Z", "path": "core/src/main/java/org/testcontainers/containers/GenericContainer.java", "diffHunk": "@@ -278,10 +268,10 @@ public SELF dependsOn(Startable... startables) {\n      * Note that the circular dependencies are not supported.\n      *\n      * @param startables a list of {@link Startable} to depend on\n-     * @see Startables#deepStart(Collection)\n+     * @see Startables#deepStart(Iterable)\n      */\n-    public SELF dependsOn(List<Startable> startables) {\n-        dependencies.addAll(startables);\n+    public SELF dependsOn(Iterable<? extends Startable> startables) {", "originalCommit": "de987ac76fedd5422accf7dd374aeee11f24a94d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjEyMTg4NQ==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2259#discussion_r386121885", "bodyText": "Pushing a commit now to reinstate dependsOn(List)", "author": "rnorth", "createdAt": "2020-03-01T16:36:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NTYwMDQ5NA=="}], "type": "inlineReview", "revised_code": {"commit": "fc2e321e7c3778bc0ecfa05e7d89dd834368da28", "chunk": "diff --git a/core/src/main/java/org/testcontainers/containers/GenericContainer.java b/core/src/main/java/org/testcontainers/containers/GenericContainer.java\nindex c3aaef1e..9be1e61c 100644\n--- a/core/src/main/java/org/testcontainers/containers/GenericContainer.java\n+++ b/core/src/main/java/org/testcontainers/containers/GenericContainer.java\n\n@@ -263,6 +263,13 @@ public class GenericContainer<SELF extends GenericContainer<SELF>>\n         return self();\n     }\n \n+    /**\n+     * @see #dependsOn(Iterable)\n+     */\n+    public SELF dependsOn(List<? extends Startable> startables) {\n+        return this.dependsOn((Iterable<? extends Startable>) startables);\n+    }\n+\n     /**\n      * Delays this container's creation and start until provided {@link Startable}s start first.\n      * Note that the circular dependencies are not supported.\n"}}, {"oid": "fc2e321e7c3778bc0ecfa05e7d89dd834368da28", "url": "https://github.com/testcontainers/testcontainers-java/commit/fc2e321e7c3778bc0ecfa05e7d89dd834368da28", "message": "Reinstate a `dependsOn(List)` method, for binary backwards compatibility", "committedDate": "2020-03-01T16:35:37Z", "type": "commit"}, {"oid": "c50ee500b37cc2b9f3d242a87e96993c8e9d7f85", "url": "https://github.com/testcontainers/testcontainers-java/commit/c50ee500b37cc2b9f3d242a87e96993c8e9d7f85", "message": "Merge branch 'master' into depends-on-iterable", "committedDate": "2020-04-04T19:44:18Z", "type": "commit"}, {"oid": "ce2cc98be70ec069e1c4fa7a54d8cc3227c0cba2", "url": "https://github.com/testcontainers/testcontainers-java/commit/ce2cc98be70ec069e1c4fa7a54d8cc3227c0cba2", "message": "Merge remote-tracking branch 'origin/master' into depends-on-iterable", "committedDate": "2020-04-05T06:17:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY1NTY5NA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2259#discussion_r403655694", "bodyText": "Whoops, japicmp has flagged this!\nJust as we did in GenericContainer, I'll reinstate the previous method signature for binary compatibility.", "author": "rnorth", "createdAt": "2020-04-05T06:22:33Z", "path": "core/src/main/java/org/testcontainers/lifecycle/Startables.java", "diffHunk": "@@ -27,8 +30,8 @@ public Thread newThread(Runnable r) {\n     /**\n      * @see #deepStart(Stream)\n      */\n-    public CompletableFuture<Void> deepStart(Collection<? extends Startable> startables) {\n-        return deepStart(startables.stream());\n+    public CompletableFuture<Void> deepStart(Iterable<? extends Startable> startables) {", "originalCommit": "c50ee500b37cc2b9f3d242a87e96993c8e9d7f85", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY1NzM2MA==", "url": "https://github.com/testcontainers/testcontainers-java/pull/2259#discussion_r403657360", "bodyText": "Reinstated.", "author": "rnorth", "createdAt": "2020-04-05T06:42:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMzY1NTY5NA=="}], "type": "inlineReview", "revised_code": {"commit": "822f1067222c313525cd0b381e3a644736f04c5f", "chunk": "diff --git a/core/src/main/java/org/testcontainers/lifecycle/Startables.java b/core/src/main/java/org/testcontainers/lifecycle/Startables.java\nindex 47ceaa04..292e1ab1 100644\n--- a/core/src/main/java/org/testcontainers/lifecycle/Startables.java\n+++ b/core/src/main/java/org/testcontainers/lifecycle/Startables.java\n\n@@ -27,6 +28,13 @@ public class Startables {\n         }\n     });\n \n+    /**\n+     * @see #deepStart(Stream)\n+     */\n+    public CompletableFuture<Void> deepStart(Collection<? extends Startable> startables) {\n+        return deepStart((Iterable<? extends Startable>) startables);\n+    }\n+\n     /**\n      * @see #deepStart(Stream)\n      */\n"}}, {"oid": "822f1067222c313525cd0b381e3a644736f04c5f", "url": "https://github.com/testcontainers/testcontainers-java/commit/822f1067222c313525cd0b381e3a644736f04c5f", "message": "Reinstate `deepStart(Collection<? extends Startable>)` method", "committedDate": "2020-04-05T06:41:33Z", "type": "commit"}]}