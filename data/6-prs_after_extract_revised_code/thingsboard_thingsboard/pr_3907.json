{"pr_number": 3907, "pr_title": "removed ServiceId from kafka consumer groupId", "pr_createdAt": "2020-12-29T18:04:55Z", "pr_url": "https://github.com/thingsboard/thingsboard/pull/3907", "timeline": [{"oid": "c1915ef74eec2be8d6be64601247de642b63f5c8", "url": "https://github.com/thingsboard/thingsboard/commit/c1915ef74eec2be8d6be64601247de642b63f5c8", "message": "removed ServiceId from kafka consumer groupId", "committedDate": "2020-12-29T18:03:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDE4NDUxMg==", "url": "https://github.com/thingsboard/thingsboard/pull/3907#discussion_r550184512", "bodyText": "This is redundant. Please rollback such changes for notification topics.", "author": "ashvayka", "createdAt": "2020-12-30T12:51:11Z", "path": "common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java", "diffHunk": "@@ -189,7 +189,7 @@ public KafkaMonolithQueueFactory(PartitionService partitionService, TbKafkaSetti\n         consumerBuilder.settings(kafkaSettings);\n         consumerBuilder.topic(partitionService.getNotificationsTopic(ServiceType.TB_CORE, serviceInfoProvider.getServiceId()).getFullTopicName());\n         consumerBuilder.clientId(\"monolith-core-notifications-consumer-\" + serviceInfoProvider.getServiceId());\n-        consumerBuilder.groupId(\"monolith-core-notifications-consumer-\" + serviceInfoProvider.getServiceId());\n+        consumerBuilder.groupId(\"monolith-core-notifications-consumer\");", "originalCommit": "c1915ef74eec2be8d6be64601247de642b63f5c8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1a51f63c749a7fd947c8acfbfab1750833e0da23", "chunk": "diff --git a/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java b/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java\nindex 68a3922de0..a138f8c40f 100644\n--- a/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java\n+++ b/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java\n\n@@ -189,7 +189,7 @@ public class KafkaMonolithQueueFactory implements TbCoreQueueFactory, TbRuleEngi\n         consumerBuilder.settings(kafkaSettings);\n         consumerBuilder.topic(partitionService.getNotificationsTopic(ServiceType.TB_CORE, serviceInfoProvider.getServiceId()).getFullTopicName());\n         consumerBuilder.clientId(\"monolith-core-notifications-consumer-\" + serviceInfoProvider.getServiceId());\n-        consumerBuilder.groupId(\"monolith-core-notifications-consumer\");\n+        consumerBuilder.groupId(\"monolith-core-notifications-consumer-\" + serviceInfoProvider.getServiceId());\n         consumerBuilder.decoder(msg -> new TbProtoQueueMsg<>(msg.getKey(), ToCoreNotificationMsg.parseFrom(msg.getData()), msg.getHeaders()));\n         consumerBuilder.admin(notificationAdmin);\n         return consumerBuilder.build();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDE4NDYyOA==", "url": "https://github.com/thingsboard/thingsboard/pull/3907#discussion_r550184628", "bodyText": "same as above.", "author": "ashvayka", "createdAt": "2020-12-30T12:51:33Z", "path": "common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java", "diffHunk": "@@ -230,7 +230,7 @@ public KafkaMonolithQueueFactory(PartitionService partitionService, TbKafkaSetti\n         responseBuilder.settings(kafkaSettings);\n         responseBuilder.topic(jsInvokeSettings.getResponseTopic() + \".\" + serviceInfoProvider.getServiceId());\n         responseBuilder.clientId(\"js-\" + serviceInfoProvider.getServiceId());\n-        responseBuilder.groupId(\"rule-engine-node-\" + serviceInfoProvider.getServiceId());\n+        responseBuilder.groupId(\"rule-engine-node\");", "originalCommit": "c1915ef74eec2be8d6be64601247de642b63f5c8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1a51f63c749a7fd947c8acfbfab1750833e0da23", "chunk": "diff --git a/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java b/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java\nindex 68a3922de0..a138f8c40f 100644\n--- a/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java\n+++ b/common/queue/src/main/java/org/thingsboard/server/queue/provider/KafkaMonolithQueueFactory.java\n\n@@ -230,7 +230,7 @@ public class KafkaMonolithQueueFactory implements TbCoreQueueFactory, TbRuleEngi\n         responseBuilder.settings(kafkaSettings);\n         responseBuilder.topic(jsInvokeSettings.getResponseTopic() + \".\" + serviceInfoProvider.getServiceId());\n         responseBuilder.clientId(\"js-\" + serviceInfoProvider.getServiceId());\n-        responseBuilder.groupId(\"rule-engine-node\");\n+        responseBuilder.groupId(\"rule-engine-node-\" + serviceInfoProvider.getServiceId());\n         responseBuilder.decoder(msg -> {\n                     JsInvokeProtos.RemoteJsResponse.Builder builder = JsInvokeProtos.RemoteJsResponse.newBuilder();\n                     JsonFormat.parser().ignoringUnknownFields().merge(new String(msg.getData(), StandardCharsets.UTF_8), builder);\n"}}, {"oid": "1a51f63c749a7fd947c8acfbfab1750833e0da23", "url": "https://github.com/thingsboard/thingsboard/commit/1a51f63c749a7fd947c8acfbfab1750833e0da23", "message": "refactored", "committedDate": "2020-12-30T13:13:23Z", "type": "commit"}]}