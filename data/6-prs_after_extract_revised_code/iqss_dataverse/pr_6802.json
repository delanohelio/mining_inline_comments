{"pr_number": 6802, "pr_title": "6781 my data render", "pr_createdAt": "2020-04-09T17:19:07Z", "pr_url": "https://github.com/IQSS/dataverse/pull/6802", "timeline": [{"oid": "f54e58c307c89e77f6c3bb4aec0f228cd411561b", "url": "https://github.com/IQSS/dataverse/commit/f54e58c307c89e77f6c3bb4aec0f228cd411561b", "message": "#6781 test for version before adding details", "committedDate": "2020-04-09T15:03:31Z", "type": "commit"}, {"oid": "13edb2f262c34e355cc5e8c3931a760222e9af2e", "url": "https://github.com/IQSS/dataverse/commit/13edb2f262c34e355cc5e8c3931a760222e9af2e", "message": "#6781 rely on versionId to get correct version", "committedDate": "2020-04-09T17:10:11Z", "type": "commit"}, {"oid": "f5e586dfdde2731e319f0846e110f2ac084d7203", "url": "https://github.com/IQSS/dataverse/commit/f5e586dfdde2731e319f0846e110f2ac084d7203", "message": "#6781 source format", "committedDate": "2020-04-09T17:20:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM5NDY4OQ==", "url": "https://github.com/IQSS/dataverse/pull/6802#discussion_r406394689", "bodyText": "This is good, but let's move this logic onto a method on Dataset (in case we need to use it elsewhere some time, and then it makes this fewer lines, ie.\nDatasetVersion dv = ds.getVersion(this.datasetVersionId);", "author": "scolapasta", "createdAt": "2020-04-09T18:26:07Z", "path": "src/main/java/edu/harvard/iq/dataverse/search/SolrSearchResult.java", "diffHunk": "@@ -560,16 +560,18 @@ public JsonObjectBuilder json(boolean showRelevance, boolean showEntityIds, bool\n         }\n         \n         if (this.entity == null) {\n-            \n+\n         } else {\n             if (this.entity.isInstanceofDataset()) {\n                 nullSafeJsonBuilder.add(\"storageIdentifier\", this.entity.getStorageIdentifier());\n                 Dataset ds = (Dataset) this.entity;\n-                DatasetVersion dv;\n-                if (this.isDraftState()) {\n-                    dv = ds.getLatestVersion();\n-                } else {\n-                    dv = ds.getReleasedVersion();\n+                DatasetVersion dv = null;\n+\n+                for (DatasetVersion v : ds.getVersions()) {", "originalCommit": "f5e586dfdde2731e319f0846e110f2ac084d7203", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjQ0MTM5NA==", "url": "https://github.com/IQSS/dataverse/pull/6802#discussion_r406441394", "bodyText": "added the suggested method to Dataset", "author": "sekmiller", "createdAt": "2020-04-09T19:54:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjM5NDY4OQ=="}], "type": "inlineReview", "revised_code": {"commit": "d80b448d1d8a6e91c083f3c2ee31140704774721", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/search/SolrSearchResult.java b/src/main/java/edu/harvard/iq/dataverse/search/SolrSearchResult.java\nindex e73c268d9..8d70d9aff 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/search/SolrSearchResult.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/search/SolrSearchResult.java\n\n@@ -565,14 +565,7 @@ public class SolrSearchResult {\n             if (this.entity.isInstanceofDataset()) {\n                 nullSafeJsonBuilder.add(\"storageIdentifier\", this.entity.getStorageIdentifier());\n                 Dataset ds = (Dataset) this.entity;\n-                DatasetVersion dv = null;\n-\n-                for (DatasetVersion v : ds.getVersions()) {\n-                    if (v.getId().equals(this.datasetVersionId)) {\n-                        dv = v;\n-                        break;\n-                    }\n-                }\n+                DatasetVersion dv = ds.getVersionFromId(this.datasetVersionId);\n \n                 if (!dv.getKeywords().isEmpty()) {\n                     JsonArrayBuilder keyWords = Json.createArrayBuilder();\n"}}, {"oid": "d80b448d1d8a6e91c083f3c2ee31140704774721", "url": "https://github.com/IQSS/dataverse/commit/d80b448d1d8a6e91c083f3c2ee31140704774721", "message": "#6781 move getVersion to ds object", "committedDate": "2020-04-09T19:52:59Z", "type": "commit"}]}