{"pr_number": 7057, "pr_title": "7056 Skip unknown types in a dataset which cause the whole dataset to\u2026", "pr_createdAt": "2020-07-06T00:12:36Z", "pr_url": "https://github.com/IQSS/dataverse/pull/7057", "timeline": [{"oid": "e4fef1dab0c339d5bf5f75d4beeddafdf5ba0947", "url": "https://github.com/IQSS/dataverse/commit/e4fef1dab0c339d5bf5f75d4beeddafdf5ba0947", "message": "7056 Skip unknown types in a dataset which cause the whole dataset to fail from being harvested", "committedDate": "2020-07-06T00:06:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwNTc1Mw==", "url": "https://github.com/IQSS/dataverse/pull/7057#discussion_r452305753", "bodyText": "I mentioned this in a review on another pull request but we favor using the full import statement instead of wildcards.", "author": "pdurbin", "createdAt": "2020-07-09T15:31:30Z", "path": "src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java", "diffHunk": "@@ -1,23 +1,7 @@\n package edu.harvard.iq.dataverse.util.json;\n \n import com.google.gson.Gson;\n-import edu.harvard.iq.dataverse.ControlledVocabularyValue;\n-import edu.harvard.iq.dataverse.DataFile;\n-import edu.harvard.iq.dataverse.DataFileCategory;\n-import edu.harvard.iq.dataverse.Dataset;\n-import edu.harvard.iq.dataverse.DatasetField;\n-import edu.harvard.iq.dataverse.DatasetFieldConstant;\n-import edu.harvard.iq.dataverse.DatasetFieldCompoundValue;\n-import edu.harvard.iq.dataverse.DatasetFieldServiceBean;\n-import edu.harvard.iq.dataverse.DatasetFieldType;\n-import edu.harvard.iq.dataverse.DatasetFieldValue;\n-import edu.harvard.iq.dataverse.DatasetVersion;\n-import edu.harvard.iq.dataverse.Dataverse;\n-import edu.harvard.iq.dataverse.DataverseContact;\n-import edu.harvard.iq.dataverse.DataverseTheme;\n-import edu.harvard.iq.dataverse.FileMetadata;\n-import edu.harvard.iq.dataverse.MetadataBlockServiceBean;\n-import edu.harvard.iq.dataverse.TermsOfUseAndAccess;\n+import edu.harvard.iq.dataverse.*;", "originalCommit": "e4fef1dab0c339d5bf5f75d4beeddafdf5ba0947", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjU2OTExOQ==", "url": "https://github.com/IQSS/dataverse/pull/7057#discussion_r452569119", "bodyText": "I'll reverse the change, my Intellij automatically does this. Super nice feature though otherwise.", "author": "JingMa87", "createdAt": "2020-07-10T01:05:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwNTc1Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mjk0NTg2MQ==", "url": "https://github.com/IQSS/dataverse/pull/7057#discussion_r452945861", "bodyText": "Yeah, I've heard that about Intellij. Thanks for reversing the change.", "author": "pdurbin", "createdAt": "2020-07-10T16:24:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMwNTc1Mw=="}], "type": "inlineReview", "revised_code": {"commit": "1e0ea12d77393cfc765d8b2233cc49b844ab9819", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java b/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java\nindex 565af9779..0f908accd 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java\n\n@@ -1,7 +1,23 @@\n package edu.harvard.iq.dataverse.util.json;\n \n import com.google.gson.Gson;\n-import edu.harvard.iq.dataverse.*;\n+import edu.harvard.iq.dataverse.ControlledVocabularyValue;\n+import edu.harvard.iq.dataverse.DataFile;\n+import edu.harvard.iq.dataverse.DataFileCategory;\n+import edu.harvard.iq.dataverse.Dataset;\n+import edu.harvard.iq.dataverse.DatasetField;\n+import edu.harvard.iq.dataverse.DatasetFieldConstant;\n+import edu.harvard.iq.dataverse.DatasetFieldCompoundValue;\n+import edu.harvard.iq.dataverse.DatasetFieldServiceBean;\n+import edu.harvard.iq.dataverse.DatasetFieldType;\n+import edu.harvard.iq.dataverse.DatasetFieldValue;\n+import edu.harvard.iq.dataverse.DatasetVersion;\n+import edu.harvard.iq.dataverse.Dataverse;\n+import edu.harvard.iq.dataverse.DataverseContact;\n+import edu.harvard.iq.dataverse.DataverseTheme;\n+import edu.harvard.iq.dataverse.FileMetadata;\n+import edu.harvard.iq.dataverse.MetadataBlockServiceBean;\n+import edu.harvard.iq.dataverse.TermsOfUseAndAccess;\n import edu.harvard.iq.dataverse.TermsOfUseAndAccess.License;\n import edu.harvard.iq.dataverse.api.Util;\n import edu.harvard.iq.dataverse.api.dto.FieldDTO;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMxMDE1NA==", "url": "https://github.com/IQSS/dataverse/pull/7057#discussion_r452310154", "bodyText": "Is this going to happen a lot? If so, should it be reduced from \"info\" to \"fine\" so it doesn't clutter the logs?", "author": "pdurbin", "createdAt": "2020-07-09T15:37:58Z", "path": "src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java", "diffHunk": "@@ -566,7 +553,8 @@ public DatasetField parseField(JsonObject json, Boolean testType) throws JsonPar\n     \n \n         if (type == null) {\n-            throw new JsonParseException(\"Can't find type '\" + json.getString(\"typeName\", \"\") + \"'\");\n+            logger.info(\"Can't find type '\" + json.getString(\"typeName\", \"\") + \"'\");", "originalCommit": "e4fef1dab0c339d5bf5f75d4beeddafdf5ba0947", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjYyMTY5OQ==", "url": "https://github.com/IQSS/dataverse/pull/7057#discussion_r452621699", "bodyText": "@pdurbin This'll happen potentially multiple thousands of times when doing a harvesting run on a big OAI set for the first time. So I'll just change it to \"fine\".", "author": "JingMa87", "createdAt": "2020-07-10T04:56:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMxMDE1NA=="}], "type": "inlineReview", "revised_code": {"commit": "1e0ea12d77393cfc765d8b2233cc49b844ab9819", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java b/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java\nindex 565af9779..0f908accd 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/util/json/JsonParser.java\n\n@@ -553,7 +569,7 @@ public class JsonParser {\n     \n \n         if (type == null) {\n-            logger.info(\"Can't find type '\" + json.getString(\"typeName\", \"\") + \"'\");\n+            logger.fine(\"Can't find type '\" + json.getString(\"typeName\", \"\") + \"'\");\n             return null;\n         }\n         if (testType && type.isAllowMultiples() != json.getBoolean(\"multiple\")) {\n"}}, {"oid": "1e0ea12d77393cfc765d8b2233cc49b844ab9819", "url": "https://github.com/IQSS/dataverse/commit/1e0ea12d77393cfc765d8b2233cc49b844ab9819", "message": "4597 Change log level to fine.", "committedDate": "2020-07-10T05:00:19Z", "type": "commit"}, {"oid": "057a8af4935817c551b3c05739ff3a769704e552", "url": "https://github.com/IQSS/dataverse/commit/057a8af4935817c551b3c05739ff3a769704e552", "message": "4597 Change back to full import statements.", "committedDate": "2020-07-10T05:06:55Z", "type": "commit"}]}