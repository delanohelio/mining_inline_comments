{"pr_number": 7414, "pr_title": "Iqss/6497 semantic api", "pr_createdAt": "2020-11-16T20:54:52Z", "pr_url": "https://github.com/IQSS/dataverse/pull/7414", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU0MzIyOA==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r662543228", "bodyText": "Jenkins is showing an error (400, BAD REQUEST) instead of a 200 here: https://jenkins.dataverse.org/blue/organizations/jenkins/IQSS-Dataverse-Develop-PR/detail/PR-7414/64/tests", "author": "pdurbin", "createdAt": "2021-07-01T19:32:29Z", "path": "src/test/java/edu/harvard/iq/dataverse/api/DatasetsIT.java", "diffHunk": "@@ -2164,4 +2157,111 @@ public void testRestrictFileExportDdi() throws IOException {\n                 .body(\"message\", equalTo(\"You do not have permission to download this file.\"));\n     }\n \n+    @Test\n+    public void testSemanticMetadataAPIs() {\n+        Response createUser = UtilIT.createRandomUser();\n+        createUser.prettyPrint();\n+        String username = UtilIT.getUsernameFromResponse(createUser);\n+        String apiToken = UtilIT.getApiTokenFromResponse(createUser);\n+\n+        Response createDataverseResponse = UtilIT.createRandomDataverse(apiToken);\n+        createDataverseResponse.prettyPrint();\n+        String dataverseAlias = UtilIT.getAliasFromResponse(createDataverseResponse);\n+\n+        // Create a dataset using native api\n+        Response createDatasetResponse = UtilIT.createRandomDatasetViaNativeApi(dataverseAlias, apiToken);\n+        createDatasetResponse.prettyPrint();\n+        Integer datasetId = UtilIT.getDatasetIdFromResponse(createDatasetResponse);\n+\n+        // Get the metadata with the semantic api\n+        Response response = UtilIT.getDatasetJsonLDMetadata(datasetId, apiToken);\n+        response.then().assertThat().statusCode(OK.getStatusCode());\n+        // Compare the metadata with an expected value - the metadatablock entries\n+        // should be the same but there will be additional fields with values related to\n+        // the dataset's creation (e.g. new id)\n+        String jsonLDString = getData(response.getBody().asString());\n+        JsonObject jo = null;\n+        try {\n+            jo = JSONLDUtil.decontextualizeJsonLD(jsonLDString);\n+        } catch (NoSuchMethodError e) {\n+            logger.info(ExceptionUtils.getStackTrace(e));\n+        }\n+        \n+\n+        String expectedJsonLD = UtilIT.getDatasetJson(\"scripts/search/tests/data/dataset-finch1.jsonld\");\n+        jo = Json.createObjectBuilder(jo).remove(\"@id\").remove(\"http://schema.org/dateModified\").build();\n+        String jsonLD = jo.toString();\n+\n+        // ToDo: Are the static pars as expected\n+        JSONAssert.assertEquals(expectedJsonLD, jsonLD, false);\n+        // Now change the title\n+        response = UtilIT.updateDatasetJsonLDMetadata(datasetId, apiToken,\n+                \"{\\\"Title\\\": \\\"New Title\\\", \\\"@context\\\":{\\\"Title\\\": \\\"http://purl.org/dc/terms/title\\\"}}\", true);\n+        response.then().assertThat().statusCode(OK.getStatusCode());\n+\n+        response = UtilIT.getDatasetJsonLDMetadata(datasetId, apiToken);\n+        response.then().assertThat().statusCode(OK.getStatusCode());\n+\n+        // Check that the semantic api returns the new title\n+        jsonLDString = getData(response.getBody().asString());\n+        JsonObject jsonLDObject = JSONLDUtil.decontextualizeJsonLD(jsonLDString);\n+        assertEquals(\"New Title\", jsonLDObject.getString(\"http://purl.org/dc/terms/title\"));\n+\n+        // Add an additional description (which is multi-valued and compound)\n+        // Also add new terms of use (single value so would fail with replace false if a\n+        // value existed)\n+        String newDescription = \"{\\\"citation:Description\\\": {\\\"dsDescription:Text\\\": \\\"New description\\\", \\\"https://dataverse.org/schema/core#termsOfUse\\\": \\\"New terms\\\"} \\\"@context\\\":{\\\"citation\\\": \\\"https://dataverse.org/schema/citation/\\\",\\\"dsDescription\\\": \\\"https://dataverse.org/schema/citation/dsDescription#\\\"}}\";\n+        response = UtilIT.updateDatasetJsonLDMetadata(datasetId, apiToken, newDescription, false);\n+        response.then().assertThat().statusCode(OK.getStatusCode());", "originalCommit": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzEyNTA0NA==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r663125044", "bodyText": "Some typos in the json-ld -should be fixed", "author": "qqmyers", "createdAt": "2021-07-02T16:22:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU0MzIyOA=="}], "type": "inlineReview", "revised_code": {"commit": "e159003877928889aa5f3293b4ae64b99dfbf8d2", "chunk": "diff --git a/src/test/java/edu/harvard/iq/dataverse/api/DatasetsIT.java b/src/test/java/edu/harvard/iq/dataverse/api/DatasetsIT.java\nindex 7074c55d6..e8f1e71e2 100644\n--- a/src/test/java/edu/harvard/iq/dataverse/api/DatasetsIT.java\n+++ b/src/test/java/edu/harvard/iq/dataverse/api/DatasetsIT.java\n\n@@ -2210,7 +2210,7 @@ createDataset = UtilIT.createRandomDatasetViaNativeApi(dataverse1Alias, apiToken\n         // Add an additional description (which is multi-valued and compound)\n         // Also add new terms of use (single value so would fail with replace false if a\n         // value existed)\n-        String newDescription = \"{\\\"citation:Description\\\": {\\\"dsDescription:Text\\\": \\\"New description\\\", \\\"https://dataverse.org/schema/core#termsOfUse\\\": \\\"New terms\\\"} \\\"@context\\\":{\\\"citation\\\": \\\"https://dataverse.org/schema/citation/\\\",\\\"dsDescription\\\": \\\"https://dataverse.org/schema/citation/dsDescription#\\\"}}\";\n+        String newDescription = \"{\\\"citation:Description\\\": {\\\"dsDescription:Text\\\": \\\"New description\\\"}, \\\"https://dataverse.org/schema/core#termsOfUse\\\": \\\"New terms\\\", \\\"@context\\\":{\\\"citation\\\": \\\"https://dataverse.org/schema/citation/\\\",\\\"dsDescription\\\": \\\"https://dataverse.org/schema/citation/dsDescription#\\\"}}\";\n         response = UtilIT.updateDatasetJsonLDMetadata(datasetId, apiToken, newDescription, false);\n         response.then().assertThat().statusCode(OK.getStatusCode());\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU2NjY5Ng==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r662566696", "bodyText": "I'm happy to see someone updating this old API. \ud83d\ude04", "author": "pdurbin", "createdAt": "2021-07-01T20:19:39Z", "path": "src/main/java/edu/harvard/iq/dataverse/api/DatasetFieldServiceApi.java", "diffHunk": "@@ -168,7 +169,8 @@ public Response getByName(@PathParam(\"name\") String name) {\n                     .add(\"parentAllowsMultiples\", parentAllowsMultiplesDisplay)\n                     .add(\"solrFieldSearchable\", solrFieldSearchable)\n                     .add(\"solrFieldFacetable\", solrFieldFacetable)\n-                    .add(\"isRequired\", isRequired));\n+                    .add(\"isRequired\", isRequired)\n+                    .add(\"uri\", uri));", "originalCommit": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzE2NjcyOA==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r663166728", "bodyText": "This is mostly a separate thing. Slava pointed out that this API didn't include the URI for a term (which was added with the OAI-ORE/Bag work from QDR). Since this was a one line change related to semantics, I added it here but the rest of the changes do not depend on this API having the extra field.", "author": "qqmyers", "createdAt": "2021-07-02T17:45:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU2NjY5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NDgwMzQ1Ng==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r664803456", "bodyText": "Cool. Why not.", "author": "pdurbin", "createdAt": "2021-07-06T18:54:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU2NjY5Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NDE4Mg==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r662574182", "bodyText": "This should be deleted or set to fine.", "author": "pdurbin", "createdAt": "2021-07-01T20:31:23Z", "path": "src/main/java/edu/harvard/iq/dataverse/api/Datasets.java", "diffHunk": "@@ -651,6 +651,96 @@ public Response updateDraftVersion( String jsonBody, @PathParam(\"id\") String id,\n             \n         }\n     }\n+  \n+    @GET\n+    @Path(\"{id}/versions/{versionId}/metadata\")\n+    @Produces(\"application/ld+json, application/json-ld\")\n+    public Response getVersionJsonLDMetadata(@PathParam(\"id\") String id, @PathParam(\"versionId\") String versionId, @Context UriInfo uriInfo, @Context HttpHeaders headers) {\n+        try {\n+            DataverseRequest req = createDataverseRequest(findUserOrDie());\n+            DatasetVersion dsv = getDatasetVersionOrDie(req, versionId, findDatasetOrDie(id), uriInfo, headers);\n+            OREMap ore = new OREMap(dsv,\n+                    settingsService.isTrueForKey(SettingsServiceBean.Key.ExcludeEmailFromExport, false));\n+            return ok(ore.getOREMapBuilder(true));\n+\n+        } catch (WrappedResponse ex) {\n+            ex.printStackTrace();\n+            return ex.getResponse();\n+        } catch (Exception jpe) {\n+            logger.log(Level.SEVERE, \"Error getting jsonld metadata for dsv: \", jpe.getLocalizedMessage());\n+            jpe.printStackTrace();\n+            return error(Response.Status.INTERNAL_SERVER_ERROR, jpe.getLocalizedMessage());\n+        }\n+    }\n+\n+    @GET\n+    @Path(\"{id}/metadata\")\n+    @Produces(\"application/ld+json, application/json-ld\")\n+    public Response getVersionJsonLDMetadata(@PathParam(\"id\") String id, @Context UriInfo uriInfo, @Context HttpHeaders headers) {\n+        return getVersionJsonLDMetadata(id, \":draft\", uriInfo, headers);\n+    }\n+            \n+    @PUT\n+    @Path(\"{id}/metadata\")\n+    @Consumes(\"application/ld+json, application/json-ld\")\n+    public Response updateVersionMetadata(String jsonLDBody, @PathParam(\"id\") String id, @DefaultValue(\"false\") @QueryParam(\"replace\") boolean replaceTerms) {\n+\n+        try {\n+            Dataset ds = findDatasetOrDie(id);\n+            DataverseRequest req = createDataverseRequest(findUserOrDie());\n+            DatasetVersion dsv = ds.getEditVersion();\n+            boolean updateDraft = ds.getLatestVersion().isDraft();\n+            dsv = JSONLDUtil.updateDatasetVersionMDFromJsonLD(dsv, jsonLDBody, metadataBlockService, datasetFieldSvc, !replaceTerms, false);\n+            \n+            DatasetVersion managedVersion;\n+            if (updateDraft) {\n+                Dataset managedDataset = execCommand(new UpdateDatasetVersionCommand(ds, req));\n+                managedVersion = managedDataset.getEditVersion();\n+            } else {\n+                managedVersion = execCommand(new CreateDatasetVersionCommand(req, ds, dsv));\n+            }\n+            String info = updateDraft ? \"Version Updated\" : \"Version Created\";\n+            return ok(Json.createObjectBuilder().add(info, managedVersion.getVersionDate()));\n+\n+        } catch (WrappedResponse ex) {\n+            return ex.getResponse();\n+        } catch (JsonParsingException jpe) {\n+            logger.log(Level.SEVERE, \"Error parsing dataset json. Json: {0}\", jsonLDBody);\n+            return error(Status.BAD_REQUEST, \"Error parsing Json: \" + jpe.getMessage());\n+        }\n+    }\n+    \n+    @PUT\n+    @Path(\"{id}/metadata/delete\")\n+    @Consumes(\"application/ld+json, application/json-ld\")\n+    public Response deleteMetadata(String jsonLDBody, @PathParam(\"id\") String id) {\n+        logger.info(\"In delteMetadata\");", "originalCommit": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzE2Nzc0Ng==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r663167746", "bodyText": "removed", "author": "qqmyers", "createdAt": "2021-07-02T17:46:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NDE4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "1d54c68fe4b515e56fee490a302cd8464d278d2d", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java b/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java\nindex 608d9554f..645b3cc83 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java\n\n@@ -714,14 +714,12 @@ public class Datasets extends AbstractApiBean {\n     @Path(\"{id}/metadata/delete\")\n     @Consumes(\"application/ld+json, application/json-ld\")\n     public Response deleteMetadata(String jsonLDBody, @PathParam(\"id\") String id) {\n-        logger.info(\"In delteMetadata\");\n         try {\n             Dataset ds = findDatasetOrDie(id);\n             DataverseRequest req = createDataverseRequest(findUserOrDie());\n             DatasetVersion dsv = ds.getEditVersion();\n             boolean updateDraft = ds.getLatestVersion().isDraft();\n             dsv = JSONLDUtil.deleteDatasetVersionMDFromJsonLD(dsv, jsonLDBody, metadataBlockService, datasetFieldSvc);\n-            logger.info(\"Updating ver\");\n             DatasetVersion managedVersion;\n             if (updateDraft) {\n                 Dataset managedDataset = execCommand(new UpdateDatasetVersionCommand(ds, req));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NDMyNw==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r662574327", "bodyText": "Same. Delete or set to fine.", "author": "pdurbin", "createdAt": "2021-07-01T20:31:41Z", "path": "src/main/java/edu/harvard/iq/dataverse/api/Datasets.java", "diffHunk": "@@ -651,6 +651,96 @@ public Response updateDraftVersion( String jsonBody, @PathParam(\"id\") String id,\n             \n         }\n     }\n+  \n+    @GET\n+    @Path(\"{id}/versions/{versionId}/metadata\")\n+    @Produces(\"application/ld+json, application/json-ld\")\n+    public Response getVersionJsonLDMetadata(@PathParam(\"id\") String id, @PathParam(\"versionId\") String versionId, @Context UriInfo uriInfo, @Context HttpHeaders headers) {\n+        try {\n+            DataverseRequest req = createDataverseRequest(findUserOrDie());\n+            DatasetVersion dsv = getDatasetVersionOrDie(req, versionId, findDatasetOrDie(id), uriInfo, headers);\n+            OREMap ore = new OREMap(dsv,\n+                    settingsService.isTrueForKey(SettingsServiceBean.Key.ExcludeEmailFromExport, false));\n+            return ok(ore.getOREMapBuilder(true));\n+\n+        } catch (WrappedResponse ex) {\n+            ex.printStackTrace();\n+            return ex.getResponse();\n+        } catch (Exception jpe) {\n+            logger.log(Level.SEVERE, \"Error getting jsonld metadata for dsv: \", jpe.getLocalizedMessage());\n+            jpe.printStackTrace();\n+            return error(Response.Status.INTERNAL_SERVER_ERROR, jpe.getLocalizedMessage());\n+        }\n+    }\n+\n+    @GET\n+    @Path(\"{id}/metadata\")\n+    @Produces(\"application/ld+json, application/json-ld\")\n+    public Response getVersionJsonLDMetadata(@PathParam(\"id\") String id, @Context UriInfo uriInfo, @Context HttpHeaders headers) {\n+        return getVersionJsonLDMetadata(id, \":draft\", uriInfo, headers);\n+    }\n+            \n+    @PUT\n+    @Path(\"{id}/metadata\")\n+    @Consumes(\"application/ld+json, application/json-ld\")\n+    public Response updateVersionMetadata(String jsonLDBody, @PathParam(\"id\") String id, @DefaultValue(\"false\") @QueryParam(\"replace\") boolean replaceTerms) {\n+\n+        try {\n+            Dataset ds = findDatasetOrDie(id);\n+            DataverseRequest req = createDataverseRequest(findUserOrDie());\n+            DatasetVersion dsv = ds.getEditVersion();\n+            boolean updateDraft = ds.getLatestVersion().isDraft();\n+            dsv = JSONLDUtil.updateDatasetVersionMDFromJsonLD(dsv, jsonLDBody, metadataBlockService, datasetFieldSvc, !replaceTerms, false);\n+            \n+            DatasetVersion managedVersion;\n+            if (updateDraft) {\n+                Dataset managedDataset = execCommand(new UpdateDatasetVersionCommand(ds, req));\n+                managedVersion = managedDataset.getEditVersion();\n+            } else {\n+                managedVersion = execCommand(new CreateDatasetVersionCommand(req, ds, dsv));\n+            }\n+            String info = updateDraft ? \"Version Updated\" : \"Version Created\";\n+            return ok(Json.createObjectBuilder().add(info, managedVersion.getVersionDate()));\n+\n+        } catch (WrappedResponse ex) {\n+            return ex.getResponse();\n+        } catch (JsonParsingException jpe) {\n+            logger.log(Level.SEVERE, \"Error parsing dataset json. Json: {0}\", jsonLDBody);\n+            return error(Status.BAD_REQUEST, \"Error parsing Json: \" + jpe.getMessage());\n+        }\n+    }\n+    \n+    @PUT\n+    @Path(\"{id}/metadata/delete\")\n+    @Consumes(\"application/ld+json, application/json-ld\")\n+    public Response deleteMetadata(String jsonLDBody, @PathParam(\"id\") String id) {\n+        logger.info(\"In delteMetadata\");\n+        try {\n+            Dataset ds = findDatasetOrDie(id);\n+            DataverseRequest req = createDataverseRequest(findUserOrDie());\n+            DatasetVersion dsv = ds.getEditVersion();\n+            boolean updateDraft = ds.getLatestVersion().isDraft();\n+            dsv = JSONLDUtil.deleteDatasetVersionMDFromJsonLD(dsv, jsonLDBody, metadataBlockService, datasetFieldSvc);\n+            logger.info(\"Updating ver\");", "originalCommit": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzE2NzY2NA==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r663167664", "bodyText": "removed", "author": "qqmyers", "createdAt": "2021-07-02T17:46:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NDMyNw=="}], "type": "inlineReview", "revised_code": {"commit": "1d54c68fe4b515e56fee490a302cd8464d278d2d", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java b/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java\nindex 608d9554f..645b3cc83 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/api/Datasets.java\n\n@@ -714,14 +714,12 @@ public class Datasets extends AbstractApiBean {\n     @Path(\"{id}/metadata/delete\")\n     @Consumes(\"application/ld+json, application/json-ld\")\n     public Response deleteMetadata(String jsonLDBody, @PathParam(\"id\") String id) {\n-        logger.info(\"In delteMetadata\");\n         try {\n             Dataset ds = findDatasetOrDie(id);\n             DataverseRequest req = createDataverseRequest(findUserOrDie());\n             DatasetVersion dsv = ds.getEditVersion();\n             boolean updateDraft = ds.getLatestVersion().isDraft();\n             dsv = JSONLDUtil.deleteDatasetVersionMDFromJsonLD(dsv, jsonLDBody, metadataBlockService, datasetFieldSvc);\n-            logger.info(\"Updating ver\");\n             DatasetVersion managedVersion;\n             if (updateDraft) {\n                 Dataset managedDataset = execCommand(new UpdateDatasetVersionCommand(ds, req));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NjU1Ng==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r662576556", "bodyText": "Should this be getAsString?", "author": "pdurbin", "createdAt": "2021-07-01T20:36:00Z", "path": "src/main/java/edu/harvard/iq/dataverse/util/bagit/BagGenerator.java", "diffHunk": "@@ -816,7 +824,7 @@ private String generateInfoFile() {\n         } else {\r\n             info.append(\r\n                     // FixMe - handle description having subfields better\r\n-                    WordUtils.wrap(getSingleValue(aggregation.getAsJsonObject(descriptionTerm.getLabel()),\r\n+                    WordUtils.wrap(getSingleValue(aggregation.get(descriptionTerm.getLabel()),\r", "originalCommit": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzE2OTc1Mw==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r663169753", "bodyText": "Description is a multi-valued field so this could be a JsonObject or JsonArray. The added logic here handles both cases. Nominally this is also separable from the API itself - just caught in testing along the way. Could be moved to a separate PR.", "author": "qqmyers", "createdAt": "2021-07-02T17:51:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NjU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NDgwNDUwOA==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r664804508", "bodyText": "Oh, I see the added logic now. Thanks.", "author": "pdurbin", "createdAt": "2021-07-06T18:56:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU3NjU1Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU4MDIzNQ==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r662580235", "bodyText": "Ah, it seems like maybe all installations do need the new .tsv file. If so, it should be added to the script that adds them all during installation.", "author": "pdurbin", "createdAt": "2021-07-01T20:43:07Z", "path": "src/main/java/edu/harvard/iq/dataverse/util/json/JsonLDTerm.java", "diffHunk": "@@ -48,6 +45,8 @@\n     public static JsonLDTerm totalSize = JsonLDTerm.DVCore(\"totalSize\");\r\n     public static JsonLDTerm fileCount = JsonLDTerm.DVCore(\"fileCount\");\r\n     public static JsonLDTerm maxFileSize = JsonLDTerm.DVCore(\"maxFileSize\");\r\n+    \r\n+    public static JsonLDTerm metadataOnOrig = JsonLDTerm.DVCore(\"metadataOnOrig\");\r", "originalCommit": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MzE3MDI1Ng==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r663170256", "bodyText": "As noted above, this is optional/not needed by default. If we decide to remove the functionality, this line would also go.", "author": "qqmyers", "createdAt": "2021-07-02T17:52:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU4MDIzNQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NjQ0NDkyMg==", "url": "https://github.com/IQSS/dataverse/pull/7414#discussion_r666444922", "bodyText": "Removed in a5a745d.", "author": "pdurbin", "createdAt": "2021-07-08T18:57:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2MjU4MDIzNQ=="}], "type": "inlineReview", "revised_code": {"commit": "a5a745d157036972194ddd790d3320c140219e6e", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/util/json/JsonLDTerm.java b/src/main/java/edu/harvard/iq/dataverse/util/json/JsonLDTerm.java\nindex 18e865b2f..20aeceda7 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/util/json/JsonLDTerm.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/util/json/JsonLDTerm.java\n\n@@ -45,8 +45,6 @@ public class JsonLDTerm {\n     public static JsonLDTerm totalSize = JsonLDTerm.DVCore(\"totalSize\");\n     public static JsonLDTerm fileCount = JsonLDTerm.DVCore(\"fileCount\");\n     public static JsonLDTerm maxFileSize = JsonLDTerm.DVCore(\"maxFileSize\");\n-    \n-    public static JsonLDTerm metadataOnOrig = JsonLDTerm.DVCore(\"metadataOnOrig\");\n \n     public JsonLDTerm(JsonLDNamespace namespace, String term) {\n         this.namespace = namespace;\n"}}, {"oid": "e159003877928889aa5f3293b4ae64b99dfbf8d2", "url": "https://github.com/IQSS/dataverse/commit/e159003877928889aa5f3293b4ae64b99dfbf8d2", "message": "fix test", "committedDate": "2021-07-02T16:20:55Z", "type": "commit"}, {"oid": "cf8b2b52f4f795c9717cef2702e53be377651a92", "url": "https://github.com/IQSS/dataverse/commit/cf8b2b52f4f795c9717cef2702e53be377651a92", "message": "Update doc/release-notes/6497-semantic-api.md\n\nCo-authored-by: Philip Durbin <philipdurbin@gmail.com>", "committedDate": "2021-07-02T16:24:48Z", "type": "commit"}, {"oid": "d5ff95563970fb5aac3622bea613fcae70a1d86c", "url": "https://github.com/IQSS/dataverse/commit/d5ff95563970fb5aac3622bea613fcae70a1d86c", "message": "Update doc/sphinx-guides/source/developers/dataset-semantic-metadata-api.rst\n\nCo-authored-by: Philip Durbin <philipdurbin@gmail.com>", "committedDate": "2021-07-02T16:30:10Z", "type": "commit"}, {"oid": "61627d161911424e3d586e2f4ffea498c02f7a80", "url": "https://github.com/IQSS/dataverse/commit/61627d161911424e3d586e2f4ffea498c02f7a80", "message": "add create example, remove solr schema copies file", "committedDate": "2021-07-02T17:23:48Z", "type": "commit"}, {"oid": "1d54c68fe4b515e56fee490a302cd8464d278d2d", "url": "https://github.com/IQSS/dataverse/commit/1d54c68fe4b515e56fee490a302cd8464d278d2d", "message": "removed debug logging", "committedDate": "2021-07-02T17:55:19Z", "type": "commit"}, {"oid": "bc821808c71334ecb180deff1bbc8e467a77db8b", "url": "https://github.com/IQSS/dataverse/commit/bc821808c71334ecb180deff1bbc8e467a77db8b", "message": "Merge branch 'IQSS/6497-semantic_api' of https://github.com/GlobalDataverseCommunityConsortium/dataverse.git into IQSS/6497-semantic_api", "committedDate": "2021-07-02T18:06:16Z", "type": "commit"}, {"oid": "4c1d31a59aa4b0be7de74a95efc8d1c08f693a36", "url": "https://github.com/IQSS/dataverse/commit/4c1d31a59aa4b0be7de74a95efc8d1c08f693a36", "message": "missing header", "committedDate": "2021-07-02T18:20:29Z", "type": "commit"}, {"oid": "a5a745d157036972194ddd790d3320c140219e6e", "url": "https://github.com/IQSS/dataverse/commit/a5a745d157036972194ddd790d3320c140219e6e", "message": "remove metadataOnOrig per review", "committedDate": "2021-07-08T16:32:14Z", "type": "commit"}, {"oid": "bd37e3023489aa903393fee0f4283ee166a80900", "url": "https://github.com/IQSS/dataverse/commit/bd37e3023489aa903393fee0f4283ee166a80900", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2021-07-08T16:32:33Z", "type": "commit"}, {"oid": "0138ebb8a8909ed4943c00c2345278258992d2cf", "url": "https://github.com/IQSS/dataverse/commit/0138ebb8a8909ed4943c00c2345278258992d2cf", "message": "add missing create method (in migrate PR)", "committedDate": "2021-07-13T16:54:35Z", "type": "commit"}, {"oid": "13a7841b3e08e84460fbdf1a8a0405adc53bb4a4", "url": "https://github.com/IQSS/dataverse/commit/13a7841b3e08e84460fbdf1a8a0405adc53bb4a4", "message": "No \"@id\" npe fix", "committedDate": "2021-07-13T18:41:24Z", "type": "commit"}, {"oid": "86a08e3362e84de51226f26cae258b52dab107af", "url": "https://github.com/IQSS/dataverse/commit/86a08e3362e84de51226f26cae258b52dab107af", "message": "avoid npe in logging", "committedDate": "2021-07-13T18:52:21Z", "type": "commit"}, {"oid": "0c64c68dff6be42299f1d0d27a9da3431167632b", "url": "https://github.com/IQSS/dataverse/commit/0c64c68dff6be42299f1d0d27a9da3431167632b", "message": "only require \"@id\" when migrating", "committedDate": "2021-07-13T19:39:11Z", "type": "commit"}, {"oid": "8e9f2f72223453f85dd81ff425c959582a127b9e", "url": "https://github.com/IQSS/dataverse/commit/8e9f2f72223453f85dd81ff425c959582a127b9e", "message": "fix logging in create case", "committedDate": "2021-07-13T20:36:15Z", "type": "commit"}, {"oid": "4d7097170d7e1399f751846e3dd6de07c853fc2f", "url": "https://github.com/IQSS/dataverse/commit/4d7097170d7e1399f751846e3dd6de07c853fc2f", "message": "initial semantic API endpoint", "committedDate": "2020-03-23T17:37:31Z", "type": "commit"}, {"oid": "b2befca1c389f2d170cde88083e434d923e84147", "url": "https://github.com/IQSS/dataverse/commit/b2befca1c389f2d170cde88083e434d923e84147", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497", "committedDate": "2020-03-23T17:50:08Z", "type": "commit"}, {"oid": "fb6421bbd1573f2eb012f1ab49f4e9daed704372", "url": "https://github.com/IQSS/dataverse/commit/fb6421bbd1573f2eb012f1ab49f4e9daed704372", "message": "merge new fields with existing ones", "committedDate": "2020-03-24T20:29:29Z", "type": "commit"}, {"oid": "8bc3df6a800e53530b41887de3b2f46ff449a876", "url": "https://github.com/IQSS/dataverse/commit/8bc3df6a800e53530b41887de3b2f46ff449a876", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497", "committedDate": "2020-03-27T14:27:50Z", "type": "commit"}, {"oid": "5b828aa78acf217858fd4de645151213613afe48", "url": "https://github.com/IQSS/dataverse/commit/5b828aa78acf217858fd4de645151213613afe48", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497", "committedDate": "2020-04-17T18:28:04Z", "type": "commit"}, {"oid": "f472b6c17f6419380447d8fde1095f0598318086", "url": "https://github.com/IQSS/dataverse/commit/f472b6c17f6419380447d8fde1095f0598318086", "message": "differences from IQSS/develop that break compilation", "committedDate": "2020-04-17T18:31:00Z", "type": "commit"}, {"oid": "bab11f0927cb0660baddb5b49fd1bd40bed4b645", "url": "https://github.com/IQSS/dataverse/commit/bab11f0927cb0660baddb5b49fd1bd40bed4b645", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tsrc/main/java/edu/harvard/iq/dataverse/api/Datasets.java", "committedDate": "2020-08-31T16:26:42Z", "type": "commit"}, {"oid": "d30586709792d3383d77d380521549022a3f729b", "url": "https://github.com/IQSS/dataverse/commit/d30586709792d3383d77d380521549022a3f729b", "message": "Add jsonld lib to compact to local context", "committedDate": "2020-09-08T20:01:50Z", "type": "commit"}, {"oid": "98d978e45faa9e436eff53559174e6a7f2dd52e3", "url": "https://github.com/IQSS/dataverse/commit/98d978e45faa9e436eff53559174e6a7f2dd52e3", "message": "use expand/compact, refactor, add :startmigration endpoint", "committedDate": "2020-09-11T19:37:24Z", "type": "commit"}, {"oid": "244370246eba5e3e02681a478a59b2373ce21f17", "url": "https://github.com/IQSS/dataverse/commit/244370246eba5e3e02681a478a59b2373ce21f17", "message": "try fix for parse error", "committedDate": "2020-09-16T20:53:57Z", "type": "commit"}, {"oid": "d44264321edc00e2744a20b6b16bd199b3dda6ba", "url": "https://github.com/IQSS/dataverse/commit/d44264321edc00e2744a20b6b16bd199b3dda6ba", "message": "log value", "committedDate": "2020-09-16T20:55:01Z", "type": "commit"}, {"oid": "fdeac97e24b9740ca7ea95759e20d6aece254f4b", "url": "https://github.com/IQSS/dataverse/commit/fdeac97e24b9740ca7ea95759e20d6aece254f4b", "message": "return dataset", "committedDate": "2020-09-16T21:30:39Z", "type": "commit"}, {"oid": "554e62091b8b31d79b3c65882311b6dbe3db69a8", "url": "https://github.com/IQSS/dataverse/commit/554e62091b8b31d79b3c65882311b6dbe3db69a8", "message": "manage versionState, add debug output", "committedDate": "2020-09-17T14:04:16Z", "type": "commit"}, {"oid": "bee7731fe34153ba1f89dc00b6e474d9c5b33a01", "url": "https://github.com/IQSS/dataverse/commit/bee7731fe34153ba1f89dc00b6e474d9c5b33a01", "message": "move debug ore generation after configuring dataset", "committedDate": "2020-09-17T14:25:44Z", "type": "commit"}, {"oid": "f4cecd3f39992c895a73bbdf5bd2396518b0ce2c", "url": "https://github.com/IQSS/dataverse/commit/f4cecd3f39992c895a73bbdf5bd2396518b0ce2c", "message": "set versionstate, simplify, move terms init outside loop", "committedDate": "2020-09-17T16:16:56Z", "type": "commit"}, {"oid": "a4189de0f3332ec75216c57374562a50cc4f5944", "url": "https://github.com/IQSS/dataverse/commit/a4189de0f3332ec75216c57374562a50cc4f5944", "message": "parse version number", "committedDate": "2020-09-17T17:30:32Z", "type": "commit"}, {"oid": "e0de1dba2dc6f1959c03580acdbffa465332f40a", "url": "https://github.com/IQSS/dataverse/commit/e0de1dba2dc6f1959c03580acdbffa465332f40a", "message": "fix toStrings", "committedDate": "2020-09-17T17:51:48Z", "type": "commit"}, {"oid": "928a88e1df05300b45d7d03e0bb0f5dda73cd642", "url": "https://github.com/IQSS/dataverse/commit/928a88e1df05300b45d7d03e0bb0f5dda73cd642", "message": "debug null pointer in DataverseFieldTypeInputLevel", "committedDate": "2020-09-17T20:13:12Z", "type": "commit"}, {"oid": "b78aed1886d4f9f52e418731e1119826f1b08c77", "url": "https://github.com/IQSS/dataverse/commit/b78aed1886d4f9f52e418731e1119826f1b08c77", "message": "add support for fields with their own formal URI", "committedDate": "2020-09-17T22:06:12Z", "type": "commit"}, {"oid": "3a47630f339d9eada23cbb12f65cd382b2c7f2d1", "url": "https://github.com/IQSS/dataverse/commit/3a47630f339d9eada23cbb12f65cd382b2c7f2d1", "message": "allow non-published to support debugging and future use", "committedDate": "2020-09-17T22:06:32Z", "type": "commit"}, {"oid": "3f8534bd690c28b1203a1979130183c573dfff2f", "url": "https://github.com/IQSS/dataverse/commit/3f8534bd690c28b1203a1979130183c573dfff2f", "message": "refactor, use expanded version directly", "committedDate": "2020-09-18T15:18:21Z", "type": "commit"}, {"oid": "64af0e8384ecb94dcf337bc8a2b66fe83c216c30", "url": "https://github.com/IQSS/dataverse/commit/64af0e8384ecb94dcf337bc8a2b66fe83c216c30", "message": "add modification time", "committedDate": "2020-09-18T15:28:17Z", "type": "commit"}, {"oid": "04ee08ae2a47edf72a760bfebbea8312d61be5e2", "url": "https://github.com/IQSS/dataverse/commit/04ee08ae2a47edf72a760bfebbea8312d61be5e2", "message": "expanded has array with 1 val - handle it", "committedDate": "2020-09-18T16:08:41Z", "type": "commit"}, {"oid": "c7c257382fefac53bd7374f258f9dd5a4792f5a9", "url": "https://github.com/IQSS/dataverse/commit/c7c257382fefac53bd7374f258f9dd5a4792f5a9", "message": "log compound values to start", "committedDate": "2020-09-18T16:13:10Z", "type": "commit"}, {"oid": "fc77f924b113936a4c438ca4f889f1164af16540", "url": "https://github.com/IQSS/dataverse/commit/fc77f924b113936a4c438ca4f889f1164af16540", "message": "compact with no context for decontextualize", "committedDate": "2020-09-18T17:54:30Z", "type": "commit"}, {"oid": "e2876449654628b4ef51907909eb0ceda77d0093", "url": "https://github.com/IQSS/dataverse/commit/e2876449654628b4ef51907909eb0ceda77d0093", "message": "handle appending and compound fields", "committedDate": "2020-09-18T21:49:16Z", "type": "commit"}, {"oid": "8596ac80ef206f9141cfc9815c0e98ccf718b327", "url": "https://github.com/IQSS/dataverse/commit/8596ac80ef206f9141cfc9815c0e98ccf718b327", "message": "sort compound field children by display order", "committedDate": "2020-09-20T14:57:53Z", "type": "commit"}, {"oid": "ffbc05ad7422cbf5080c0f576986dd494946d935", "url": "https://github.com/IQSS/dataverse/commit/ffbc05ad7422cbf5080c0f576986dd494946d935", "message": "parse date/time correctly", "committedDate": "2020-09-22T16:15:03Z", "type": "commit"}, {"oid": "0226b0d3c6cb15f3b7700eb1c259db90a9c75fa4", "url": "https://github.com/IQSS/dataverse/commit/0226b0d3c6cb15f3b7700eb1c259db90a9c75fa4", "message": "Revert \"sort compound field children by display order\"\n\nThis reverts commit 8596ac80ef206f9141cfc9815c0e98ccf718b327.", "committedDate": "2020-09-22T19:41:53Z", "type": "commit"}, {"oid": "fad62f44203210117b968ba84e4c6428aaa2fdd8", "url": "https://github.com/IQSS/dataverse/commit/fad62f44203210117b968ba84e4c6428aaa2fdd8", "message": "typo", "committedDate": "2020-09-22T19:47:29Z", "type": "commit"}, {"oid": "c6b19a9da2d4c54367021db830309cac445ad335", "url": "https://github.com/IQSS/dataverse/commit/c6b19a9da2d4c54367021db830309cac445ad335", "message": "now use Uri instead of label when matching terms", "committedDate": "2020-09-22T20:10:46Z", "type": "commit"}, {"oid": "a014fc43aa41a58c856eca3c185d55959f097585", "url": "https://github.com/IQSS/dataverse/commit/a014fc43aa41a58c856eca3c185d55959f097585", "message": "set dsfield of dsfvalue", "committedDate": "2020-09-22T21:22:22Z", "type": "commit"}, {"oid": "5bb5e68e3e4ceb90054d1bd085ac4c4909854813", "url": "https://github.com/IQSS/dataverse/commit/5bb5e68e3e4ceb90054d1bd085ac4c4909854813", "message": "additional debug, always set display order", "committedDate": "2020-09-23T13:21:01Z", "type": "commit"}, {"oid": "6a47fad40f9afcc3f98ef9acfe2bceb119ff4ffe", "url": "https://github.com/IQSS/dataverse/commit/6a47fad40f9afcc3f98ef9acfe2bceb119ff4ffe", "message": "generate URIs for child types to match current ore maps", "committedDate": "2020-09-23T14:10:13Z", "type": "commit"}, {"oid": "f34da09948bd726ea92c525d861ee6ec8b3d0fb4", "url": "https://github.com/IQSS/dataverse/commit/f34da09948bd726ea92c525d861ee6ec8b3d0fb4", "message": "allow oremap to work w/o modified date for debug", "committedDate": "2020-09-23T14:12:51Z", "type": "commit"}, {"oid": "6b8bbc77a75bfb37e97acd6b4d1b057bc2f0ae88", "url": "https://github.com/IQSS/dataverse/commit/6b8bbc77a75bfb37e97acd6b4d1b057bc2f0ae88", "message": "null check on date itself", "committedDate": "2020-09-23T14:49:57Z", "type": "commit"}, {"oid": "8af09380bd21fe112e95af6a213f7f39eaf21970", "url": "https://github.com/IQSS/dataverse/commit/8af09380bd21fe112e95af6a213f7f39eaf21970", "message": "fix compound value iteration\n\ndon't replace existing value - always add a new value, but, if not\nappending, clear the list of values to start", "committedDate": "2020-09-23T15:01:19Z", "type": "commit"}, {"oid": "79048442a4b3421769c3d6c4c913d212ec1c6133", "url": "https://github.com/IQSS/dataverse/commit/79048442a4b3421769c3d6c4c913d212ec1c6133", "message": "fix ttype map for terms with no uri - use title not name\n\nas is done currently in generating the ORE map", "committedDate": "2020-09-23T15:12:31Z", "type": "commit"}, {"oid": "e4ceee3d7dc91d2f913cfc713502656faa459c1d", "url": "https://github.com/IQSS/dataverse/commit/e4ceee3d7dc91d2f913cfc713502656faa459c1d", "message": "handle date format variations, including DV internal ones\n\nsee note in Dataverses - using Date() versus Timestamp() causes a\ndifference in precision and, perhaps surprisingly, a difference in the\nresponse from version.getLastUpdateTime().toString() in creating the\nOREmap.", "committedDate": "2020-09-23T20:27:00Z", "type": "commit"}, {"oid": "f176387c627a06dc89f67f4b266da56e4d7cb979", "url": "https://github.com/IQSS/dataverse/commit/f176387c627a06dc89f67f4b266da56e4d7cb979", "message": "and the format in current published bags", "committedDate": "2020-09-23T21:09:28Z", "type": "commit"}, {"oid": "2724d9ebb8c543ab26eb1991d8eeeae33d13f025", "url": "https://github.com/IQSS/dataverse/commit/2724d9ebb8c543ab26eb1991d8eeeae33d13f025", "message": "initial endpoint to release a migrated dataset", "committedDate": "2020-09-24T13:55:26Z", "type": "commit"}, {"oid": "7d5006d93941a6a5f89d08ed235b10d28dfc8c80", "url": "https://github.com/IQSS/dataverse/commit/7d5006d93941a6a5f89d08ed235b10d28dfc8c80", "message": "create metadataOnOrig field", "committedDate": "2020-09-24T16:40:08Z", "type": "commit"}, {"oid": "925070b4bbc856127dadc238d163d3fbe563ebba", "url": "https://github.com/IQSS/dataverse/commit/925070b4bbc856127dadc238d163d3fbe563ebba", "message": "add metadataOnOrig to solr", "committedDate": "2020-09-24T17:43:27Z", "type": "commit"}, {"oid": "005db9753c633562987a0fe5f863d1c03a99bb6d", "url": "https://github.com/IQSS/dataverse/commit/005db9753c633562987a0fe5f863d1c03a99bb6d", "message": "use Finalize Publication command\n\nCurate is for cases with an existing published version and migrated\ndatasets only have 1 version\n\nAlso - don't want to go through Publish command since it creates new\nversion numbers, etc.", "committedDate": "2020-09-24T20:04:12Z", "type": "commit"}, {"oid": "f336cfda5bcd6ad591b22b987508abaa7e370a34", "url": "https://github.com/IQSS/dataverse/commit/f336cfda5bcd6ad591b22b987508abaa7e370a34", "message": "add debug, allow more details in 400 responses", "committedDate": "2020-09-24T21:05:50Z", "type": "commit"}, {"oid": "0de70dd4f8a81fcaa74af63090436e6fbb46a85b", "url": "https://github.com/IQSS/dataverse/commit/0de70dd4f8a81fcaa74af63090436e6fbb46a85b", "message": "fix date-time issue", "committedDate": "2020-09-24T22:03:22Z", "type": "commit"}, {"oid": "395bb71ee512fc3e969ebd48a0e2b0f631617d80", "url": "https://github.com/IQSS/dataverse/commit/395bb71ee512fc3e969ebd48a0e2b0f631617d80", "message": "typos", "committedDate": "2020-09-25T13:26:39Z", "type": "commit"}, {"oid": "61c0349061e54548d877cd37403d0aeebf1d19f7", "url": "https://github.com/IQSS/dataverse/commit/61c0349061e54548d877cd37403d0aeebf1d19f7", "message": "create transfer bag type with orig files\n\nhandle no checksums on orig files", "committedDate": "2020-09-25T17:00:54Z", "type": "commit"}, {"oid": "1753257836e34ccb0017a0b8a3b58f39d4aaa18d", "url": "https://github.com/IQSS/dataverse/commit/1753257836e34ccb0017a0b8a3b58f39d4aaa18d", "message": "missing tab", "committedDate": "2020-09-30T20:39:04Z", "type": "commit"}, {"oid": "e642c65c3490c1bfd22058c9a3321a6f115426fc", "url": "https://github.com/IQSS/dataverse/commit/e642c65c3490c1bfd22058c9a3321a6f115426fc", "message": "add type param", "committedDate": "2020-09-30T21:20:20Z", "type": "commit"}, {"oid": "df66f224d0e9fe4446f946f3a8af9ee8e258cf92", "url": "https://github.com/IQSS/dataverse/commit/df66f224d0e9fe4446f946f3a8af9ee8e258cf92", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tsrc/main/java/edu/harvard/iq/dataverse/api/Datasets.java", "committedDate": "2020-10-06T15:25:02Z", "type": "commit"}, {"oid": "3445daac3136cfc5b9d87daafb8ac139f5a80ed6", "url": "https://github.com/IQSS/dataverse/commit/3445daac3136cfc5b9d87daafb8ac139f5a80ed6", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2020-11-16T16:43:15Z", "type": "commit"}, {"oid": "2e1d914cc7e344b31f3b4169e9d799f3a5340b84", "url": "https://github.com/IQSS/dataverse/commit/2e1d914cc7e344b31f3b4169e9d799f3a5340b84", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2020-11-16T19:19:27Z", "type": "commit"}, {"oid": "9ad779a2d0c7b74b5c4957d93bc1e2f3f7dab23f", "url": "https://github.com/IQSS/dataverse/commit/9ad779a2d0c7b74b5c4957d93bc1e2f3f7dab23f", "message": "add semantic metadata api call only", "committedDate": "2020-11-16T19:55:12Z", "type": "commit"}, {"oid": "8abd55e9e6a0031e60cf701790aaced3e2a4cbd0", "url": "https://github.com/IQSS/dataverse/commit/8abd55e9e6a0031e60cf701790aaced3e2a4cbd0", "message": "remove OREMap parameter", "committedDate": "2020-12-01T17:43:56Z", "type": "commit"}, {"oid": "1a35ed24a1c2721f66bec1c91ad17a38571abc43", "url": "https://github.com/IQSS/dataverse/commit/1a35ed24a1c2721f66bec1c91ad17a38571abc43", "message": "fix error handling\n\nFWIW: We have an error handler for the\nedu.harvard.iq.dataverse.util.json.JsonParseException class but not for\njavax.json.stream.JsonParsingException which was getting caught by the\nThrowable handler and returned as a 500 error with json message {}", "committedDate": "2020-12-01T20:34:07Z", "type": "commit"}, {"oid": "7b1512e71ecb7c0482f41e62a5b5b7a3eb459259", "url": "https://github.com/IQSS/dataverse/commit/7b1512e71ecb7c0482f41e62a5b5b7a3eb459259", "message": "append to current terms", "committedDate": "2020-12-01T21:29:36Z", "type": "commit"}, {"oid": "e5b54dfc6739c06bccb447103633d4dcd1f930f5", "url": "https://github.com/IQSS/dataverse/commit/e5b54dfc6739c06bccb447103633d4dcd1f930f5", "message": "add replace param", "committedDate": "2020-12-01T22:01:24Z", "type": "commit"}, {"oid": "578790f0b2558721f98defab8b384681246856f3", "url": "https://github.com/IQSS/dataverse/commit/578790f0b2558721f98defab8b384681246856f3", "message": "handle append on terms - fix cut/paste errors", "committedDate": "2020-12-02T15:34:22Z", "type": "commit"}, {"oid": "acee4df8ce31d9d910766560caa459b2c15374a2", "url": "https://github.com/IQSS/dataverse/commit/acee4df8ce31d9d910766560caa459b2c15374a2", "message": "fix logic", "committedDate": "2020-12-02T16:58:50Z", "type": "commit"}, {"oid": "9185126fb88970b1b3e3a448070745f232261a11", "url": "https://github.com/IQSS/dataverse/commit/9185126fb88970b1b3e3a448070745f232261a11", "message": "specify default", "committedDate": "2020-12-02T16:59:09Z", "type": "commit"}, {"oid": "e8698dc41095d03442ebb156d5b4de03c3cec1ca", "url": "https://github.com/IQSS/dataverse/commit/e8698dc41095d03442ebb156d5b4de03c3cec1ca", "message": "make replace still append for multiple val fields", "committedDate": "2020-12-02T17:21:56Z", "type": "commit"}, {"oid": "901efe863fb13d31dfdd8751373657f469090e2b", "url": "https://github.com/IQSS/dataverse/commit/901efe863fb13d31dfdd8751373657f469090e2b", "message": "add migrating switch", "committedDate": "2020-12-02T19:38:17Z", "type": "commit"}, {"oid": "34a28a37180c3c1a698ad359c88ff945a5ed0f53", "url": "https://github.com/IQSS/dataverse/commit/34a28a37180c3c1a698ad359c88ff945a5ed0f53", "message": "expose uri in datasetField api", "committedDate": "2020-12-03T18:13:28Z", "type": "commit"}, {"oid": "1b98b2c959b2f8ad92c020e2ffb05efc5a645551", "url": "https://github.com/IQSS/dataverse/commit/1b98b2c959b2f8ad92c020e2ffb05efc5a645551", "message": "track defined namespaces\n\nand avoid having contexts with specific entries for terms that are in a\nnamespace already", "committedDate": "2020-12-03T19:27:14Z", "type": "commit"}, {"oid": "55a8b303b124b1d9982c1aba620c443a499628c0", "url": "https://github.com/IQSS/dataverse/commit/55a8b303b124b1d9982c1aba620c443a499628c0", "message": "define equals, avoid duplicates in list", "committedDate": "2020-12-03T20:22:37Z", "type": "commit"}, {"oid": "966394ad33ded6939f9d606d0ca4682cb32f25a8", "url": "https://github.com/IQSS/dataverse/commit/966394ad33ded6939f9d606d0ca4682cb32f25a8", "message": "replace string with const", "committedDate": "2020-12-04T20:27:43Z", "type": "commit"}, {"oid": "b83f7b2f134ce87e5cf2b1d7af8182b756f1faf0", "url": "https://github.com/IQSS/dataverse/commit/b83f7b2f134ce87e5cf2b1d7af8182b756f1faf0", "message": "constant for CC0_URI", "committedDate": "2020-12-04T20:28:14Z", "type": "commit"}, {"oid": "1e08f102e617fcfcdeea7482d03e5aeae8270c11", "url": "https://github.com/IQSS/dataverse/commit/1e08f102e617fcfcdeea7482d03e5aeae8270c11", "message": "GET/DELETE endpoints", "committedDate": "2020-12-04T20:28:32Z", "type": "commit"}, {"oid": "780630f3a953c736a7a6278db98e64c04371c5f9", "url": "https://github.com/IQSS/dataverse/commit/780630f3a953c736a7a6278db98e64c04371c5f9", "message": "7130-handle missing contact name", "committedDate": "2020-12-08T17:58:16Z", "type": "commit"}, {"oid": "cc7e69cf143a62df201d8a1fe30ae0ab017b7328", "url": "https://github.com/IQSS/dataverse/commit/cc7e69cf143a62df201d8a1fe30ae0ab017b7328", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2020-12-08T18:01:11Z", "type": "commit"}, {"oid": "e0ea36ea18d121229ed10620f4030f27017d1775", "url": "https://github.com/IQSS/dataverse/commit/e0ea36ea18d121229ed10620f4030f27017d1775", "message": "Fix multiple description logic for info file", "committedDate": "2020-12-11T18:16:08Z", "type": "commit"}, {"oid": "6d0c6153f2215815b6d9be201e66fe191ed447e0", "url": "https://github.com/IQSS/dataverse/commit/6d0c6153f2215815b6d9be201e66fe191ed447e0", "message": "put is always for :draft version", "committedDate": "2020-12-11T18:44:51Z", "type": "commit"}, {"oid": "51f8f78cbf6c30a142c481587d1bb93ed1f797a1", "url": "https://github.com/IQSS/dataverse/commit/51f8f78cbf6c30a142c481587d1bb93ed1f797a1", "message": "don't cast to String[]", "committedDate": "2020-12-11T20:17:22Z", "type": "commit"}, {"oid": "353644a0e0bf560839841ba29bb3911ae0c03e70", "url": "https://github.com/IQSS/dataverse/commit/353644a0e0bf560839841ba29bb3911ae0c03e70", "message": "add more logging", "committedDate": "2020-12-11T20:17:52Z", "type": "commit"}, {"oid": "2382fef9211623ba35f56c0f59accfb06c4bafa0", "url": "https://github.com/IQSS/dataverse/commit/2382fef9211623ba35f56c0f59accfb06c4bafa0", "message": "handle unpublished versions", "committedDate": "2020-12-11T20:34:10Z", "type": "commit"}, {"oid": "243769aee31fe5c49ca93a1f168aa8ac083d493d", "url": "https://github.com/IQSS/dataverse/commit/243769aee31fe5c49ca93a1f168aa8ac083d493d", "message": "add method that can return JsonObjectBuilder\n\nwhich can be used with existing AbstractApiBean.ok()", "committedDate": "2020-12-11T22:27:05Z", "type": "commit"}, {"oid": "9bfa7c3d2f6c492b361fccd13f0bbc109d325353", "url": "https://github.com/IQSS/dataverse/commit/9bfa7c3d2f6c492b361fccd13f0bbc109d325353", "message": "log details on failure", "committedDate": "2020-12-11T22:27:24Z", "type": "commit"}, {"oid": "60f8a99676e1b9e2c35e7f624fc4f3da58d6675d", "url": "https://github.com/IQSS/dataverse/commit/60f8a99676e1b9e2c35e7f624fc4f3da58d6675d", "message": "multiple updates/fixes, added logging", "committedDate": "2020-12-11T22:27:55Z", "type": "commit"}, {"oid": "464832a4c47e9234f62e92d04a960333d68a7e1e", "url": "https://github.com/IQSS/dataverse/commit/464832a4c47e9234f62e92d04a960333d68a7e1e", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2020-12-22T19:17:51Z", "type": "commit"}, {"oid": "e93114940d5ed79cbfa138fcf5262b90d36b83ef", "url": "https://github.com/IQSS/dataverse/commit/e93114940d5ed79cbfa138fcf5262b90d36b83ef", "message": "fix terms retrieval", "committedDate": "2020-12-22T20:02:12Z", "type": "commit"}, {"oid": "2b8189afc433e5e4d0367d7391fe707fead036fa", "url": "https://github.com/IQSS/dataverse/commit/2b8189afc433e5e4d0367d7391fe707fead036fa", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2021-01-08T14:56:23Z", "type": "commit"}, {"oid": "e8f737c7ce334643b75139770248780611de54bf", "url": "https://github.com/IQSS/dataverse/commit/e8f737c7ce334643b75139770248780611de54bf", "message": "date test fixes for locale", "committedDate": "2021-01-13T22:29:12Z", "type": "commit"}, {"oid": "1c93260df74dee477162dc24318412974dad8329", "url": "https://github.com/IQSS/dataverse/commit/1c93260df74dee477162dc24318412974dad8329", "message": "Java 11 update and test fixes inc. for different exception mesg", "committedDate": "2021-01-13T22:29:49Z", "type": "commit"}, {"oid": "a85c1d68b3873ef00a96ecc5681d301d77190760", "url": "https://github.com/IQSS/dataverse/commit/a85c1d68b3873ef00a96ecc5681d301d77190760", "message": "update pom for v11 and running tests under 11", "committedDate": "2021-01-14T18:36:03Z", "type": "commit"}, {"oid": "1476a613cb2eb455e7045712d61cc4dcfd02e473", "url": "https://github.com/IQSS/dataverse/commit/1476a613cb2eb455e7045712d61cc4dcfd02e473", "message": "Merge branch 'iqssdevelop' into IQSS/6497-semantic_api\n\nConflicts:\n\tpom.xml", "committedDate": "2021-01-14T18:53:37Z", "type": "commit"}, {"oid": "a52353b8461d4d191f7e92561b3771411e895ff3", "url": "https://github.com/IQSS/dataverse/commit/a52353b8461d4d191f7e92561b3771411e895ff3", "message": "fix for edu.harvard.iq.dataverse.api.AdminIT test fail in Java 11\n\nThe DV code tested in testLoadMetadataBlock_ErrorHandling assumed it\ncould parse the message of an ArrayOutOfBounds exception as an it to\ndetermine the column that fails. This message is now a String. Rather\nthan parse it (and fail if it changes), I modified the code so that the\nlength of the values array is visible in the catch and can be sent\ndirectly (the first out of bounds index is if/when the index is\nvalues.length).", "committedDate": "2021-01-14T20:36:48Z", "type": "commit"}, {"oid": "6f405abadb1bfe54eda29225624b975ff298e4a8", "url": "https://github.com/IQSS/dataverse/commit/6f405abadb1bfe54eda29225624b975ff298e4a8", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tpom.xml\n\tsrc/main/java/edu/harvard/iq/dataverse/api/DatasetFieldServiceApi.java\n\tsrc/test/java/edu/harvard/iq/dataverse/dataaccess/StorageIOTest.java", "committedDate": "2021-01-29T16:07:44Z", "type": "commit"}, {"oid": "e866ae0f9bf89df5afca790d6c0893074abb73d9", "url": "https://github.com/IQSS/dataverse/commit/e866ae0f9bf89df5afca790d6c0893074abb73d9", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tsrc/test/java/edu/harvard/iq/dataverse/FileMetadataTest.java", "committedDate": "2021-02-08T19:55:38Z", "type": "commit"}, {"oid": "d5b8b45b5d37cfc292c8025b3ca8e09adf93a763", "url": "https://github.com/IQSS/dataverse/commit/d5b8b45b5d37cfc292c8025b3ca8e09adf93a763", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tsrc/main/java/edu/harvard/iq/dataverse/api/Datasets.java", "committedDate": "2021-02-23T18:09:57Z", "type": "commit"}, {"oid": "56acda8945bdb88ae3b21b9bac11ddef05101b4e", "url": "https://github.com/IQSS/dataverse/commit/56acda8945bdb88ae3b21b9bac11ddef05101b4e", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tconf/solr/7.7.2/schema_dv_mdb_copies.xml\n\tconf/solr/7.7.2/schema_dv_mdb_fields.xml\n\tsrc/main/java/edu/harvard/iq/dataverse/util/bagit/OREMap.java", "committedDate": "2021-04-07T21:28:27Z", "type": "commit"}, {"oid": "f19a1997e89ea1f6c4b66daf4070ac64619329a4", "url": "https://github.com/IQSS/dataverse/commit/f19a1997e89ea1f6c4b66daf4070ac64619329a4", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2021-04-13T18:35:32Z", "type": "commit"}, {"oid": "a7c6b3f427e647b2d8ae69fd666fdecbd94b4b59", "url": "https://github.com/IQSS/dataverse/commit/a7c6b3f427e647b2d8ae69fd666fdecbd94b4b59", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tsrc/main/java/edu/harvard/iq/dataverse/api/util/JsonResponseBuilder.java", "committedDate": "2021-04-26T18:32:08Z", "type": "commit"}, {"oid": "33fb8de59683747eb488fa8795241eddb0f49ae4", "url": "https://github.com/IQSS/dataverse/commit/33fb8de59683747eb488fa8795241eddb0f49ae4", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api\n\nConflicts:\n\tconf/solr/8.8.1/schema_dv_mdb_copies.xml", "committedDate": "2021-05-20T17:05:39Z", "type": "commit"}, {"oid": "87c581f0dfc89b5c457f9c45ea985a4d552034d2", "url": "https://github.com/IQSS/dataverse/commit/87c581f0dfc89b5c457f9c45ea985a4d552034d2", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2021-06-03T16:18:24Z", "type": "commit"}, {"oid": "f47b268fb83f81b09ef99514ec26c6806a70c47a", "url": "https://github.com/IQSS/dataverse/commit/f47b268fb83f81b09ef99514ec26c6806a70c47a", "message": "update StringUtils package", "committedDate": "2021-06-03T16:47:38Z", "type": "commit"}, {"oid": "6d73b61d45352deb79a1064ea159a0e1cbf59586", "url": "https://github.com/IQSS/dataverse/commit/6d73b61d45352deb79a1064ea159a0e1cbf59586", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2021-06-23T17:24:29Z", "type": "commit"}, {"oid": "4714ea628651cd0653f98ed31f7f07de75be9472", "url": "https://github.com/IQSS/dataverse/commit/4714ea628651cd0653f98ed31f7f07de75be9472", "message": "move metadataOnOrig out of citation block\n\nwhich makes it optional", "committedDate": "2021-06-23T17:36:43Z", "type": "commit"}, {"oid": "82a5b23842a46009c98f5da4ef671e30c9e05c37", "url": "https://github.com/IQSS/dataverse/commit/82a5b23842a46009c98f5da4ef671e30c9e05c37", "message": "sync with migration api branch (tests, docs, bug fixes)", "committedDate": "2021-06-30T15:58:49Z", "type": "commit"}, {"oid": "10ef9ff27eb38668bd06234f9bb79545782d36e7", "url": "https://github.com/IQSS/dataverse/commit/10ef9ff27eb38668bd06234f9bb79545782d36e7", "message": "Merge remote-tracking branch 'IQSS/develop' into IQSS/6497-semantic_api", "committedDate": "2021-06-30T15:59:22Z", "type": "commit"}]}