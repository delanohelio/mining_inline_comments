{"pr_number": 6564, "pr_title": "6262 show proper number of ds inlinking dv", "pr_createdAt": "2020-01-23T16:49:36Z", "pr_url": "https://github.com/IQSS/dataverse/pull/6564", "timeline": [{"oid": "0924387b4d68d79fe0a006d9216033d9cdc4a281", "url": "https://github.com/IQSS/dataverse/commit/0924387b4d68d79fe0a006d9216033d9cdc4a281", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-17T19:46:57Z", "type": "commit"}, {"oid": "db039d0599e9731e182c74a0c4dbb3946a877cfd", "url": "https://github.com/IQSS/dataverse/commit/db039d0599e9731e182c74a0c4dbb3946a877cfd", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-17T20:08:14Z", "type": "commit"}, {"oid": "4a458e5fb1378f46151222fed42005bb63c63624", "url": "https://github.com/IQSS/dataverse/commit/4a458e5fb1378f46151222fed42005bb63c63624", "message": "#6262 reindex datasets if their owner is linked", "committedDate": "2020-01-22T21:47:59Z", "type": "commit"}, {"oid": "83f1048ff7d656216954af2987d7d8748a00e027", "url": "https://github.com/IQSS/dataverse/commit/83f1048ff7d656216954af2987d7d8748a00e027", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-22T21:48:24Z", "type": "commit"}, {"oid": "dec3bd9d0572f371780f0c10d1fb55c5b88b64e4", "url": "https://github.com/IQSS/dataverse/commit/dec3bd9d0572f371780f0c10d1fb55c5b88b64e4", "message": "#6262 remove debug code", "committedDate": "2020-01-23T14:23:52Z", "type": "commit"}, {"oid": "74881ba53bb807e1d341b996fb587dafc6436136", "url": "https://github.com/IQSS/dataverse/commit/74881ba53bb807e1d341b996fb587dafc6436136", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-23T14:24:06Z", "type": "commit"}, {"oid": "49dbe301b1b3c9123813778371b9214444fe78ce", "url": "https://github.com/IQSS/dataverse/commit/49dbe301b1b3c9123813778371b9214444fe78ce", "message": "#6262 code cleanup", "committedDate": "2020-01-23T15:01:10Z", "type": "commit"}, {"oid": "29493285603b45c06a694237be13900538598a04", "url": "https://github.com/IQSS/dataverse/commit/29493285603b45c06a694237be13900538598a04", "message": "#6262 add release notes", "committedDate": "2020-01-23T16:44:00Z", "type": "commit"}, {"oid": "5cf41d5cc61b79974855965c292d2305ee4880bc", "url": "https://github.com/IQSS/dataverse/commit/5cf41d5cc61b79974855965c292d2305ee4880bc", "message": "#6262 get all child DVs DSs to be linked", "committedDate": "2020-01-27T21:12:55Z", "type": "commit"}, {"oid": "7996067f4bfb703d21a85b0a0bb69e37b32c8f3b", "url": "https://github.com/IQSS/dataverse/commit/7996067f4bfb703d21a85b0a0bb69e37b32c8f3b", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-27T21:13:17Z", "type": "commit"}, {"oid": "8cfb24e717ab6f7b7fa3eee01b4d15cacec305f7", "url": "https://github.com/IQSS/dataverse/commit/8cfb24e717ab6f7b7fa3eee01b4d15cacec305f7", "message": "#6262 clarify linking comments", "committedDate": "2020-01-28T14:37:01Z", "type": "commit"}, {"oid": "fe39d0284b7b55b1f1f2c122a23f77021c5e7146", "url": "https://github.com/IQSS/dataverse/commit/fe39d0284b7b55b1f1f2c122a23f77021c5e7146", "message": "#6262 add full path for linked DV DS", "committedDate": "2020-01-29T15:52:37Z", "type": "commit"}, {"oid": "e215c922b153ae37add448a149ef37f571dd1dc2", "url": "https://github.com/IQSS/dataverse/commit/e215c922b153ae37add448a149ef37f571dd1dc2", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-29T15:53:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjYzODk0MQ==", "url": "https://github.com/IQSS/dataverse/pull/6564#discussion_r372638941", "bodyText": "why is this an object and not a primitive boolean?", "author": "scolapasta", "createdAt": "2020-01-29T21:27:11Z", "path": "src/main/java/edu/harvard/iq/dataverse/search/IndexServiceBean.java", "diffHunk": "@@ -1280,8 +1320,53 @@ private String getTopicClassificationTermOrTermAndVocabulary(DatasetField topicC\n             return segments;\n         }\n     }\n+        \n+    private boolean hasAnyLinkingDataverses(Dataverse dataverse) {\n+        Dataverse rootDataverse = findRootDataverseCached();\n+        List<Dataverse> ancestorList = dataverse.getOwners();\n+        for (Dataverse prior : ancestorList) {\n+            if (!dataverse.equals(rootDataverse)) {\n+                List<Dataverse> linkingDVs = dvLinkingService.findLinkingDataverses(prior.getId());\n+                if (!linkingDVs.isEmpty()){\n+                    return true;\n+                }\n+            }\n+        }       \n+        return false;\n+    }\n+    \n+    private List<String> findLinkingDataversePaths(Dataverse dataverse, Boolean self) {", "originalCommit": "e215c922b153ae37add448a149ef37f571dd1dc2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "369edacd0e687a0c32467223ac9833d393d8c09a", "chunk": "diff --git a/src/main/java/edu/harvard/iq/dataverse/search/IndexServiceBean.java b/src/main/java/edu/harvard/iq/dataverse/search/IndexServiceBean.java\nindex 97be511da..381f186a2 100644\n--- a/src/main/java/edu/harvard/iq/dataverse/search/IndexServiceBean.java\n+++ b/src/main/java/edu/harvard/iq/dataverse/search/IndexServiceBean.java\n\n@@ -1335,15 +1328,13 @@ public class IndexServiceBean {\n         return false;\n     }\n     \n-    private List<String> findLinkingDataversePaths(Dataverse dataverse, Boolean self) {\n+    private List<String> findLinkingDataversePaths(Dataverse dataverse) {\n         Dataverse rootDataverse = findRootDataverseCached();\n         List<String> pathListAccumulator = new ArrayList<>();\n         List<Dataverse> ancestorList = dataverse.getOwners();\n-        if (self != null && self) {\n-            //For Datasets \"self == true\" we must check the owning dataverse \n-            //as well as all of its ancestors\n-            ancestorList.add(dataverse);\n-        }\n+\n+        ancestorList.add(dataverse);\n+\n         for (Dataverse prior : ancestorList) {\n             if (!dataverse.equals(rootDataverse)) {\n                 // important when creating root dataverse\n"}}, {"oid": "369edacd0e687a0c32467223ac9833d393d8c09a", "url": "https://github.com/IQSS/dataverse/commit/369edacd0e687a0c32467223ac9833d393d8c09a", "message": "#6262 consolidate code/logic", "committedDate": "2020-01-29T21:59:34Z", "type": "commit"}, {"oid": "eac42ea91911d3a3abc9fd2bf037fe7cb9ced7ee", "url": "https://github.com/IQSS/dataverse/commit/eac42ea91911d3a3abc9fd2bf037fe7cb9ced7ee", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-29T21:59:51Z", "type": "commit"}, {"oid": "9f13d41b28a408746658619956439e141f647bd2", "url": "https://github.com/IQSS/dataverse/commit/9f13d41b28a408746658619956439e141f647bd2", "message": "#6262 remove unused method", "committedDate": "2020-01-29T22:12:10Z", "type": "commit"}, {"oid": "52dddbce09314a25336661bb5b79cecd91c6812f", "url": "https://github.com/IQSS/dataverse/commit/52dddbce09314a25336661bb5b79cecd91c6812f", "message": "#6262 add clarifying comments", "committedDate": "2020-01-29T22:17:30Z", "type": "commit"}, {"oid": "1f41cfaeaef431c2ed2d0a444262585541f2ea49", "url": "https://github.com/IQSS/dataverse/commit/1f41cfaeaef431c2ed2d0a444262585541f2ea49", "message": "#6262 simplify \"am I linked?\" logic", "committedDate": "2020-01-30T18:35:10Z", "type": "commit"}, {"oid": "6872f98ec32abb40a471e86e6d80838fe84c3158", "url": "https://github.com/IQSS/dataverse/commit/6872f98ec32abb40a471e86e6d80838fe84c3158", "message": "Merge branch 'develop' into 6262-show-proper-number-of-DS-inlinking-DV", "committedDate": "2020-01-30T18:35:23Z", "type": "commit"}]}