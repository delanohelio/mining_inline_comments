{"pr_number": 65, "pr_title": "Implement Annotation Scanning (without merge conflict)", "pr_createdAt": "2020-05-17T08:26:38Z", "pr_url": "https://github.com/PatchworkMC/patchwork-api/pull/65", "timeline": [{"oid": "b10918fdf559b565c649f6a217a7a466b19239b9", "url": "https://github.com/PatchworkMC/patchwork-api/commit/b10918fdf559b565c649f6a217a7a466b19239b9", "message": "Revert \"Implement IShapedRecipe and add new module patchwork-recipes\"\n\nThis reverts commit b020b67e7391164a458976ae0ea00ff44b8c9f14.", "committedDate": "2020-04-29T12:12:59Z", "type": "commit"}, {"oid": "fa56dfbb2fd08bbda6f90e7c96b3345e71d6d2bb", "url": "https://github.com/PatchworkMC/patchwork-api/commit/fa56dfbb2fd08bbda6f90e7c96b3345e71d6d2bb", "message": "Revert \"Implement IShapedRecipe and add new module patchwork-recipes\"\n\nThis reverts commit c59ede6a0a743c8934341a28e35272fb14b37640.", "committedDate": "2020-04-29T12:13:10Z", "type": "commit"}, {"oid": "b8b09dfad5981f2839c33ec5305a472f128ae555", "url": "https://github.com/PatchworkMC/patchwork-api/commit/b8b09dfad5981f2839c33ec5305a472f128ae555", "message": "change the way of getting parent mod container", "committedDate": "2020-05-04T02:38:49Z", "type": "commit"}, {"oid": "6346ed14f8b03416577a6351d426abde020ce885", "url": "https://github.com/PatchworkMC/patchwork-api/commit/6346ed14f8b03416577a6351d426abde020ce885", "message": "add getAllScanData", "committedDate": "2020-05-04T02:51:31Z", "type": "commit"}, {"oid": "9d2aaf852e40a15692a22a55b3c78277c2825246", "url": "https://github.com/PatchworkMC/patchwork-api/commit/9d2aaf852e40a15692a22a55b3c78277c2825246", "message": "small refactor", "committedDate": "2020-05-04T12:09:42Z", "type": "commit"}, {"oid": "01d3c633f75c6991ad00b61e4a37bde872d4b0c2", "url": "https://github.com/PatchworkMC/patchwork-api/commit/01d3c633f75c6991ad00b61e4a37bde872d4b0c2", "message": "make sub mods share the same ModFileInfo", "committedDate": "2020-05-11T02:17:19Z", "type": "commit"}, {"oid": "1cbe0918115d699e86f268bad757f2d08778bc5a", "url": "https://github.com/PatchworkMC/patchwork-api/commit/1cbe0918115d699e86f268bad757f2d08778bc5a", "message": "change to patchwork:parent", "committedDate": "2020-05-13T00:54:23Z", "type": "commit"}, {"oid": "9313c4cdcd9e8101f641e7da73a2677995eaa002", "url": "https://github.com/PatchworkMC/patchwork-api/commit/9313c4cdcd9e8101f641e7da73a2677995eaa002", "message": "remove unused method", "committedDate": "2020-05-15T08:42:03Z", "type": "commit"}, {"oid": "43c772ec09a2bb2d5954cf093dd115663268ad52", "url": "https://github.com/PatchworkMC/patchwork-api/commit/43c772ec09a2bb2d5954cf093dd115663268ad52", "message": "fix annotation scanning detail", "committedDate": "2020-05-17T02:06:16Z", "type": "commit"}, {"oid": "8068fdcfd36ed32cc433bd059c20ebf7cd9ee579", "url": "https://github.com/PatchworkMC/patchwork-api/commit/8068fdcfd36ed32cc433bd059c20ebf7cd9ee579", "message": "fix annotation scanning detail", "committedDate": "2020-05-17T03:19:00Z", "type": "commit"}, {"oid": "ac35dc0752ac6ae10fb9609f77e225e0f1f5e172", "url": "https://github.com/PatchworkMC/patchwork-api/commit/ac35dc0752ac6ae10fb9609f77e225e0f1f5e172", "message": "minor fix", "committedDate": "2020-05-17T03:46:29Z", "type": "commit"}, {"oid": "63f28404031f0d3bd994dbc8e9915e7cd6830d4a", "url": "https://github.com/PatchworkMC/patchwork-api/commit/63f28404031f0d3bd994dbc8e9915e7cd6830d4a", "message": "Revert \"Revert \"Annotation Scanning\"\"\n\nThis reverts commit b36fc8bac5a127c8b67c44f5b343441556a67391.", "committedDate": "2020-05-17T08:02:12Z", "type": "commit"}, {"oid": "4745a8751b2920455ceed86f89b53c39dd906838", "url": "https://github.com/PatchworkMC/patchwork-api/commit/4745a8751b2920455ceed86f89b53c39dd906838", "message": "Merge branch 'annotation' of https://github.com/qouteall/patchwork-api\n\n\u0001 Conflicts:\n\u0001\tpatchwork-recipes/src/main/java/net/patchworkmc/mixin/recipes/MixinRecipeGridAligner.java\n\u0001\tsettings.gradle", "committedDate": "2020-05-17T08:04:00Z", "type": "commit"}, {"oid": "93f240496788565f1e76c47e4ea8a75bcdfe5598", "url": "https://github.com/PatchworkMC/patchwork-api/commit/93f240496788565f1e76c47e4ea8a75bcdfe5598", "message": "fix broken branch", "committedDate": "2020-05-17T08:24:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwODU0OA==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/65#discussion_r426908548", "bodyText": "Should be private unless it's accessed elsewhere\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \tModContainer modContainer;\n          \n          \n            \n            \tprivate ModContainer modContainer;", "author": "coderbot16", "createdAt": "2020-05-18T21:41:21Z", "path": "patchwork-fml/src/main/java/net/minecraftforge/forgespi/language/ModFileScanData.java", "diffHunk": "@@ -0,0 +1,250 @@\n+/*\n+ * Minecraft Forge, Patchwork Project\n+ * Copyright (c) 2016-2020, 2019-2020\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.forgespi.language;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.lang.annotation.Annotation;\n+import java.lang.annotation.ElementType;\n+import java.lang.reflect.Method;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import com.google.gson.Gson;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.objectweb.asm.Type;\n+\n+import net.fabricmc.loader.api.ModContainer;\n+import net.fabricmc.loader.api.metadata.CustomValue;\n+\n+public class ModFileScanData {\n+\tprivate static final Logger LOGGER = LogManager.getLogger();\n+\n+\tpublic static final ModFileScanData EMPTY = new ModFileScanData();\n+\n+\tModContainer modContainer;", "originalCommit": "93f240496788565f1e76c47e4ea8a75bcdfe5598", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkwODk0OA==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/65#discussion_r426908948", "bodyText": "This makes it more explicit whether it is the annotation data or the mod itself that is missing\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            \t\t\tLOGGER.error(\"ModFileScanData: Tried to access the scanned annotation data for \" + getModid() + \", but it is missing\");\n          \n          \n            \n            \t\t\tLOGGER.error(\"ModFileScanData: Tried to access the scanned annotation data for \" + getModid() + \", but the data is missing\");", "author": "coderbot16", "createdAt": "2020-05-18T21:42:22Z", "path": "patchwork-fml/src/main/java/net/minecraftforge/forgespi/language/ModFileScanData.java", "diffHunk": "@@ -0,0 +1,250 @@\n+/*\n+ * Minecraft Forge, Patchwork Project\n+ * Copyright (c) 2016-2020, 2019-2020\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.forgespi.language;\n+\n+import java.io.IOException;\n+import java.io.InputStream;\n+import java.io.InputStreamReader;\n+import java.lang.annotation.Annotation;\n+import java.lang.annotation.ElementType;\n+import java.lang.reflect.Method;\n+import java.nio.file.Files;\n+import java.nio.file.Path;\n+import java.util.Arrays;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Objects;\n+import java.util.Set;\n+import java.util.stream.Collectors;\n+\n+import com.google.gson.Gson;\n+import org.apache.logging.log4j.LogManager;\n+import org.apache.logging.log4j.Logger;\n+import org.objectweb.asm.Type;\n+\n+import net.fabricmc.loader.api.ModContainer;\n+import net.fabricmc.loader.api.metadata.CustomValue;\n+\n+public class ModFileScanData {\n+\tprivate static final Logger LOGGER = LogManager.getLogger();\n+\n+\tpublic static final ModFileScanData EMPTY = new ModFileScanData();\n+\n+\tModContainer modContainer;\n+\tprivate boolean initialized = false;\n+\tprivate AnnotationStorage annotationStorage;\n+\tprivate Set<AnnotationData> annotationData;\n+\n+\tpublic ModFileScanData(ModContainer modContainer) {\n+\t\tthis.modContainer = modContainer;\n+\t}\n+\n+\t//create empty mod file scan data for Fabric mods\n+\tprivate ModFileScanData() {\n+\t\tinitialized = true;\n+\t\tannotationData = Collections.emptySet();\n+\t}\n+\n+\tprivate void init() {\n+\t\tinitialized = true;\n+\n+\t\tCustomValue customValue = modContainer.getMetadata().getCustomValue(\"patchwork:annotations\");\n+\n+\t\tif (customValue == null) {\n+\t\t\tLOGGER.error(\"ModFileScanData: Tried to access the scanned annotation data for \" + getModid() + \", but it is missing\");", "originalCommit": "93f240496788565f1e76c47e4ea8a75bcdfe5598", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkxMDA0Nw==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/65#discussion_r426910047", "bodyText": "This should probably be a ModContainer argument as well to mirror ModFile.", "author": "coderbot16", "createdAt": "2020-05-18T21:45:11Z", "path": "patchwork-fml/src/main/java/net/minecraftforge/fml/loading/moddiscovery/ModFileInfo.java", "diffHunk": "@@ -0,0 +1,40 @@\n+/*\n+ * Minecraft Forge, Patchwork Project\n+ * Copyright (c) 2016-2020, 2019-2020\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.fml.loading.moddiscovery;\n+\n+import net.fabricmc.loader.FabricLoader;\n+\n+public class ModFileInfo {\n+\tprivate ModFile modFile;\n+\n+\tpublic ModFileInfo(String modid) {", "originalCommit": "93f240496788565f1e76c47e4ea8a75bcdfe5598", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}