{"pr_number": 89, "pr_title": "Add the PlayerXpEvent events (add XP points/level, pickup XP orb)", "pr_createdAt": "2020-06-17T11:58:58Z", "pr_url": "https://github.com/PatchworkMC/patchwork-api/pull/89", "timeline": [{"oid": "c5df81cb7d0c74682e83951407ad75292a3e7e0c", "url": "https://github.com/PatchworkMC/patchwork-api/commit/c5df81cb7d0c74682e83951407ad75292a3e7e0c", "message": "Add the PlayerXpEvent events (add XP points/level, pickup XP orb)", "committedDate": "2020-06-17T11:49:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNTc5NA==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r441905794", "bodyText": "This should be a javadoc.", "author": "TheGlitch76", "createdAt": "2020-06-18T00:37:04Z", "path": "patchwork-events-entity/src/main/java/net/minecraftforge/event/entity/player/PlayerXpEvent.java", "diffHunk": "@@ -0,0 +1,90 @@\n+/*\n+ * Minecraft Forge, Patchwork Project\n+ * Copyright (c) 2016-2020, 2019-2020\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.minecraftforge.event.entity.player;\n+\n+import net.minecraft.entity.ExperienceOrbEntity;\n+import net.minecraft.entity.player.PlayerEntity;\n+\n+public abstract class PlayerXpEvent extends PlayerEvent {\n+\tpublic PlayerXpEvent(PlayerEntity player) {\n+\t\tsuper(player);\n+\t}\n+\n+\t// For legacy reasons, the instances of this class should actually be of\n+\t// type PlayerPickupXpEvent", "originalCommit": "c5df81cb7d0c74682e83951407ad75292a3e7e0c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d5f0ff4b0601a6e3276212a44f36c7824f66e43c", "chunk": "diff --git a/patchwork-events-entity/src/main/java/net/minecraftforge/event/entity/player/PlayerXpEvent.java b/patchwork-events-entity/src/main/java/net/minecraftforge/event/entity/player/PlayerXpEvent.java\nindex a639049..d53f91f 100644\n--- a/patchwork-events-entity/src/main/java/net/minecraftforge/event/entity/player/PlayerXpEvent.java\n+++ b/patchwork-events-entity/src/main/java/net/minecraftforge/event/entity/player/PlayerXpEvent.java\n\n@@ -27,8 +27,13 @@ public abstract class PlayerXpEvent extends PlayerEvent {\n \t\tsuper(player);\n \t}\n \n-\t// For legacy reasons, the instances of this class should actually be of\n-\t// type PlayerPickupXpEvent\n+\t/**\n+\t * An event representing a player picking up an XP orb entity.\n+\t * <p>\n+\t * For legacy reasons, the instances of this class should actually be of\n+\t * type {@link PlayerPickupXpEvent}\n+\t * </p>\n+\t */\n \tpublic static class PickupXp extends CancelablePlayerXpEvent {\n \t\tprivate final ExperienceOrbEntity orb;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r441906733", "bodyText": "This Handle opcode looks suspicious. Have you tested this mixin and confirmed it works?", "author": "TheGlitch76", "createdAt": "2020-06-18T00:40:59Z", "path": "patchwork-events-entity/src/main/java/net/patchworkmc/mixin/event/entity/MixinExperienceOrbEntity.java", "diffHunk": "@@ -0,0 +1,47 @@\n+/*\n+ * Minecraft Forge, Patchwork Project\n+ * Copyright (c) 2016-2020, 2019-2020\n+ *\n+ * This library is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU Lesser General Public\n+ * License as published by the Free Software Foundation version 2.1\n+ * of the License.\n+ *\n+ * This library is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+ */\n+\n+package net.patchworkmc.mixin.event.entity;\n+\n+import net.minecraftforge.common.MinecraftForge;\n+import net.minecraftforge.event.entity.player.PlayerPickupXpEvent;\n+import org.objectweb.asm.Opcodes;\n+import org.spongepowered.asm.mixin.Mixin;\n+import org.spongepowered.asm.mixin.injection.At;\n+import org.spongepowered.asm.mixin.injection.Inject;\n+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;\n+\n+import net.minecraft.entity.player.PlayerEntity;\n+import net.minecraft.entity.ExperienceOrbEntity;\n+\n+@Mixin(ExperienceOrbEntity.class)\n+public class MixinExperienceOrbEntity {\n+\t// After checking we're on the server and the player is ready to pick up the orb, the first\n+\t// thing the target method does is set experiencePickUpDelay, hence hook just before that.\n+\t@Inject(method = \"onPlayerCollision\", cancellable = true, at = @At(value = \"FIELD\", opcode = Opcodes.H_PUTFIELD, ordinal = 0,", "originalCommit": "c5df81cb7d0c74682e83951407ad75292a3e7e0c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNzEyOA==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r441907128", "bodyText": "While you're at it please make sure this launches in a reobf environment (compiled and in MultiMC/vanilla launcher)", "author": "TheGlitch76", "createdAt": "2020-06-18T00:42:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjY0MDU2OA==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r442640568", "bodyText": "I've tested it in a dev environment, I'll test it in MultiMC now.", "author": "ZNixian", "createdAt": "2020-06-19T05:38:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjY0NTAxMg==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r442645012", "bodyText": "Looking at the patch this seems to be identical.", "author": "famous1622", "createdAt": "2020-06-19T05:55:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjY0NTY3Mw==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r442645673", "bodyText": "As in the commit I just pushed? That converted some comments to a JavaDoc comment", "author": "ZNixian", "createdAt": "2020-06-19T05:57:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjY1Mzk0Nw==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r442653947", "bodyText": "Clarified over discord that was referring to the bytecode matching.", "author": "ZNixian", "createdAt": "2020-06-19T06:25:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjY2NDUzNQ==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/89#discussion_r442664535", "bodyText": "Since I didn't set it up properly I thought it wasn't working in reobf, tested it now and it works fine as expected.", "author": "ZNixian", "createdAt": "2020-06-19T06:56:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTkwNjczMw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "d5f0ff4b0601a6e3276212a44f36c7824f66e43c", "url": "https://github.com/PatchworkMC/patchwork-api/commit/d5f0ff4b0601a6e3276212a44f36c7824f66e43c", "message": "Fix the Javadoc for PlayerXpEvent.PickupXp", "committedDate": "2020-06-19T05:54:20Z", "type": "commit"}, {"oid": "647854a59252512ff32930783ffd3476b30412ef", "url": "https://github.com/PatchworkMC/patchwork-api/commit/647854a59252512ff32930783ffd3476b30412ef", "message": "Merge remote-tracking branch 'origin/master' into player-xp-events", "committedDate": "2020-06-20T01:15:46Z", "type": "commit"}, {"oid": "ed8c8d4d9a41e7456c588d3b4be9a37417e0327f", "url": "https://github.com/PatchworkMC/patchwork-api/commit/ed8c8d4d9a41e7456c588d3b4be9a37417e0327f", "message": "Bump patchwork-events-entity from v0.3.0 to v0.4.0", "committedDate": "2020-06-20T01:17:40Z", "type": "commit"}]}