{"pr_number": 67, "pr_title": "Better initialization errors", "pr_createdAt": "2020-05-18T23:06:38Z", "pr_url": "https://github.com/PatchworkMC/patchwork-api/pull/67", "timeline": [{"oid": "23724dca22893502988859d0279dbbb5f5b8bdbb", "url": "https://github.com/PatchworkMC/patchwork-api/commit/23724dca22893502988859d0279dbbb5f5b8bdbb", "message": "Try to report errors more clearly during initialization", "committedDate": "2020-05-18T22:59:25Z", "type": "commit"}, {"oid": "851fdc1631f70f004202bd98e7189201c71a2154", "url": "https://github.com/PatchworkMC/patchwork-api/commit/851fdc1631f70f004202bd98e7189201c71a2154", "message": "More sensible addSuppressed usage", "committedDate": "2020-05-18T23:06:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0NDU5MQ==", "url": "https://github.com/PatchworkMC/patchwork-api/pull/67#discussion_r427544591", "bodyText": "While you're at it either make a dedicated exception or use an existing one.", "author": "TheGlitch76", "createdAt": "2020-05-19T19:23:19Z", "path": "patchwork-dispatcher/src/main/java/net/patchworkmc/impl/Patchwork.java", "diffHunk": "@@ -76,19 +77,41 @@ public void onInitialize() {\n \n \t\t// Construct forge mods\n \n-\t\tfor (ForgeInitializer initializer : FabricLoader.getInstance().getEntrypoints(\"patchwork\", ForgeInitializer.class)) {\n-\t\t\tLOGGER.info(\"Constructing Forge mod: \" + initializer.getModId());\n+\t\tList<ForgeInitializer> entrypoints;\n+\n+\t\ttry {\n+\t\t\tentrypoints = FabricLoader.getInstance().getEntrypoints(\"patchwork\", ForgeInitializer.class);\n+\t\t} catch (Throwable t) {\n+\t\t\tthrow new RuntimeException(\"Failed to get Patchwork entrypoints!\", t);", "originalCommit": "851fdc1631f70f004202bd98e7189201c71a2154", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "de30693c5b2588ca1d839ad63b10514cf11208b7", "chunk": "diff --git a/patchwork-dispatcher/src/main/java/net/patchworkmc/impl/Patchwork.java b/patchwork-dispatcher/src/main/java/net/patchworkmc/impl/Patchwork.java\nindex 990c422..f6444d6 100644\n--- a/patchwork-dispatcher/src/main/java/net/patchworkmc/impl/Patchwork.java\n+++ b/patchwork-dispatcher/src/main/java/net/patchworkmc/impl/Patchwork.java\n\n@@ -82,10 +82,10 @@ public class Patchwork implements ModInitializer {\n \t\ttry {\n \t\t\tentrypoints = FabricLoader.getInstance().getEntrypoints(\"patchwork\", ForgeInitializer.class);\n \t\t} catch (Throwable t) {\n-\t\t\tthrow new RuntimeException(\"Failed to get Patchwork entrypoints!\", t);\n+\t\t\tthrow new PatchworkInitializationException(\"Failed to get Patchwork entrypoints!\", t);\n \t\t}\n \n-\t\tRuntimeException error = null;\n+\t\tPatchworkInitializationException error = null;\n \n \t\tfor (ForgeInitializer initializer : entrypoints) {\n \t\t\tLOGGER.info(\"Constructing Patchwork mod: \" + initializer.getModId());\n"}}, {"oid": "de30693c5b2588ca1d839ad63b10514cf11208b7", "url": "https://github.com/PatchworkMC/patchwork-api/commit/de30693c5b2588ca1d839ad63b10514cf11208b7", "message": "Replace RuntimeException with PatchworkInitializationException", "committedDate": "2020-05-19T20:07:32Z", "type": "commit"}]}