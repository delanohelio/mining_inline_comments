{"pr_number": 530, "pr_title": "set default value for repeating group count", "pr_createdAt": "2020-12-04T08:50:16Z", "pr_url": "https://github.com/opensrp/opensrp-client-native-form/pull/530", "timeline": [{"oid": "f264b66c76b7d397b6cb4eafe7d865f3898c2cc1", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/f264b66c76b7d397b6cb4eafe7d865f3898c2cc1", "message": ":hammer: set default value for repeating group count", "committedDate": "2020-12-04T08:48:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0MjU5OQ==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/530#discussion_r536042599", "bodyText": "Could you add a test to verify that all fields of the repeatingGroupCountObj are correctly populated?", "author": "vincent-karuri", "createdAt": "2020-12-04T11:47:59Z", "path": "android-json-form-wizard/src/main/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactory.java", "diffHunk": "@@ -152,6 +152,7 @@ private JSONObject getRepeatingGroupCountObj(WidgetArgs widgetArgs) throws JSONE\n         repeatingGroupCountObj.put(OPENMRS_ENTITY_ID, \"\");\n         repeatingGroupCountObj.put(TYPE, \"\");\n         repeatingGroupCountObj.put(TEXT, widgetArgs.getJsonObject().get(REFERENCE_EDIT_TEXT_HINT));\n+        repeatingGroupCountObj.put(VALUE, \"0\");", "originalCommit": "f264b66c76b7d397b6cb4eafe7d865f3898c2cc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0MzAzNg==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/530#discussion_r536043036", "bodyText": "And in particular, to verify that the value is 0 by default and that it is always reset to zero when text is cleared.", "author": "vincent-karuri", "createdAt": "2020-12-04T11:48:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0MjU5OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjIwOTU5Mw==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/530#discussion_r536209593", "bodyText": "done", "author": "owais-vd", "createdAt": "2020-12-04T16:10:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjA0MjU5OQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "60efaf05a19aff40c74d1b6ed82288d1842c678d", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/60efaf05a19aff40c74d1b6ed82288d1842c678d", "message": ":heavy_check_mark: test case added to verify the default value of repeating group count.", "committedDate": "2020-12-04T16:11:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI1ODY1Mg==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/530#discussion_r537258652", "bodyText": "Could you add an intermediate step where you set the text to something else and verify that that value is updated on repeatingGroupCountObj,  then set it to blank and verify that it's reset to 0?", "author": "vincent-karuri", "createdAt": "2020-12-07T06:23:38Z", "path": "android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactoryTest.java", "diffHunk": "@@ -180,6 +180,17 @@ public void testUniqueChildElementKeyGenerationShouldContainChildKeyAsComponent(\n         Assert.assertEquals(childElementKey, uniqueIdComponents[0]);\n     }\n \n+    @Test\n+    public void testRepeatingGroupDefaultCount() throws Exception {\n+        View rootLayout = invokeGetViewsFromJson().get(0);\n+\n+        JSONObject repeatingGroupCountObj = step.getJSONArray(JsonFormConstants.FIELDS).getJSONObject(0);\n+        Assert.assertEquals(\"0\", repeatingGroupCountObj.getString(JsonFormConstants.VALUE));\n+\n+        ((MaterialEditText) rootLayout.findViewById(R.id.reference_edit_text)).setText(\"\");", "originalCommit": "60efaf05a19aff40c74d1b6ed82288d1842c678d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI2NDU2Mg==", "url": "https://github.com/opensrp/opensrp-client-native-form/pull/530#discussion_r537264562", "bodyText": "added.", "author": "owais-vd", "createdAt": "2020-12-07T06:40:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzI1ODY1Mg=="}], "type": "inlineReview", "revised_code": {"commit": "0c794fe50ad2c6fe3ed8fc13b68321eb84d4ee3b", "chunk": "diff --git a/android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactoryTest.java b/android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactoryTest.java\nindex 7b596f49..2e27ea0a 100644\n--- a/android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactoryTest.java\n+++ b/android-json-form-wizard/src/test/java/com/vijay/jsonwizard/widgets/RepeatingGroupFactoryTest.java\n\n@@ -187,6 +187,9 @@ public class RepeatingGroupFactoryTest extends FactoryTest {\n         JSONObject repeatingGroupCountObj = step.getJSONArray(JsonFormConstants.FIELDS).getJSONObject(0);\n         Assert.assertEquals(\"0\", repeatingGroupCountObj.getString(JsonFormConstants.VALUE));\n \n+        ((MaterialEditText) rootLayout.findViewById(R.id.reference_edit_text)).setText(\"3\");\n+        Assert.assertEquals(\"3\", repeatingGroupCountObj.getString(JsonFormConstants.VALUE));\n+\n         ((MaterialEditText) rootLayout.findViewById(R.id.reference_edit_text)).setText(\"\");\n         Assert.assertEquals(\"0\", repeatingGroupCountObj.getString(JsonFormConstants.VALUE));\n     }\n"}}, {"oid": "0c794fe50ad2c6fe3ed8fc13b68321eb84d4ee3b", "url": "https://github.com/opensrp/opensrp-client-native-form/commit/0c794fe50ad2c6fe3ed8fc13b68321eb84d4ee3b", "message": ":heavy_check_mark: added another step to verify repeating group count", "committedDate": "2020-12-07T06:39:49Z", "type": "commit"}]}