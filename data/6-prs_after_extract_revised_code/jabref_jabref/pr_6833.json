{"pr_number": 6833, "pr_title": "Fix/use format conversion for all imports", "pr_createdAt": "2020-09-01T18:17:28Z", "pr_url": "https://github.com/JabRef/jabref/pull/6833", "timeline": [{"oid": "c8ebc91d4799e59518ac887f69e584040cf29994", "url": "https://github.com/JabRef/jabref/commit/c8ebc91d4799e59518ac887f69e584040cf29994", "message": "Squashed 'src/main/resources/csl-styles/' changes from bf698acec7..827b986621\n\n827b986621 add DOI preprint to american-society-for-microbiology.csl (#4946)\n7cab2f7d8a Create depro-ufs.csl (#4947)\n2fcda1fe03 Create journal-of-sport-science-and-medicine.csl (#4949)\ncd457d4bce Update american-marketing-association.csl (#4945)\ncacc4eefbd Create nejm-catalyst.csl (#4943)\nbd769b91da Update and rename dependent/chinese-medical-journal.csl to chinese-me\u2026 (#4941)\n1f706cda6c Update health-services-research.csl (#4939)\n76bcd1d9d7 Update journal-of-the-royal-society-of-western-australia.csl (#4932)\ne79640e74d Create afro-asia.csl (#4934)\nc601aa4e0f Update lancaster-university-harvard.csl (#4938)\n184fd90210 Update collection-du-centre-jean-berard.csl (#4936)\n82f9aec90f fix et-al & add DOI thyroid.csl (#4937)\n4af169fc11 Create universidade-estadual-de-alagoas-uneal-abnt (#4885)\n47165b3d5a Update and rename medical-physics.csl to dependent/medical-physics.csl (AMA) (#4905)\n3cab27dc1a Update thieme-german.csl (#4931)\neb2c9776e0 Create zeitschrift-fur-zahnarztliche-implantologie.csl (#4925)\n4adb1ea0be Create karstenia.csl (#4929)\n530a136786 Fix author substitute in Universita Cattolica\n\ngit-subtree-dir: src/main/resources/csl-styles\ngit-subtree-split: 827b986621348627f8e894d1b7f11191f905a8e2", "committedDate": "2020-08-01T02:13:15Z", "type": "commit"}, {"oid": "f5f02cf3ced81d19b74844b770abc1dba0b61fa1", "url": "https://github.com/JabRef/jabref/commit/f5f02cf3ced81d19b74844b770abc1dba0b61fa1", "message": "Merge commit 'c8ebc91d4799e59518ac887f69e584040cf29994'", "committedDate": "2020-08-01T02:13:15Z", "type": "commit"}, {"oid": "37c2d64e449ef617bb98c0ad3b39a903d8f3d886", "url": "https://github.com/JabRef/jabref/commit/37c2d64e449ef617bb98c0ad3b39a903d8f3d886", "message": "Squashed 'src/main/resources/csl-styles/' changes from 827b986621..eb0d37e0ff\n\neb0d37e0ff Create natbib-plainnat-author-dat.csl (#4967)\nfb1592a1cd Update journal-of-fish-biology.csl (#4969)\nf6876cbe0f Update .travis.yml (#4970)\nd6d400b207 Create london-review-of-international-law.csl (#4966)\nd2a5ae1b16 Update harvard-stellenbosch-university.csl (#4965)\n9c62141a40 Create phytopathologia-mediterranea.csl (#4964)\n8ca2ea1a9c Update historical-materialism.csl (#4960)\n80456dc749 Update historical-materialism.csl\nbe2d91090c Update historical-materialism.csl\n1d1cf095a6 Create atlande.csl (#4930)\n89f41d404d Create juristische-zitierweise-oeffentliches-recht.csl (#4944)\n8c677a08c5 Create korean-journal-of-gastroenterology.csl (#4954)\neadb9508dd Create historical-materialism.csl (#4955)\n5553dcdc9c Create revista-materia.csl (#4957)\nd23a3abd79 Bug fix in APA 6 original publication macro (#4959)\n66f9974980 Always print publisher in APA 6th edition (#4899)\n868809c063 Create agora.csl (#4940)\n99c19c397e Update anthropologie-et-societes.csl (#4952)\nee17423a93 Create critical-reviews-in-solid-state-and-materials-science.csl (#4951)\n7a13a7d59e Create korean-journal-of-internal-medicine.csl (#4953)\n\ngit-subtree-dir: src/main/resources/csl-styles\ngit-subtree-split: eb0d37e0ff253e7c6d256b619e4831af306a28cf", "committedDate": "2020-08-15T02:17:10Z", "type": "commit"}, {"oid": "b85ebe3e3f9b956f1ab56ef24bf2a1cd0b03d632", "url": "https://github.com/JabRef/jabref/commit/b85ebe3e3f9b956f1ab56ef24bf2a1cd0b03d632", "message": "Merge commit '37c2d64e449ef617bb98c0ad3b39a903d8f3d886' into master", "committedDate": "2020-08-15T02:17:10Z", "type": "commit"}, {"oid": "f10ea5f1d86aed42a29b38d5b4683f60cb964c1c", "url": "https://github.com/JabRef/jabref/commit/f10ea5f1d86aed42a29b38d5b4683f60cb964c1c", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-25T19:10:13Z", "type": "commit"}, {"oid": "a96efde697023c5b5f6c2f2b7f17629f526e59ab", "url": "https://github.com/JabRef/jabref/commit/a96efde697023c5b5f6c2f2b7f17629f526e59ab", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-29T13:36:06Z", "type": "commit"}, {"oid": "f23aadedf198fea69d859dd3f1fab9eda8a991d2", "url": "https://github.com/JabRef/jabref/commit/f23aadedf198fea69d859dd3f1fab9eda8a991d2", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-31T11:35:11Z", "type": "commit"}, {"oid": "586b3cf9f9db8b6ec7bde5a902bb1930102d8a80", "url": "https://github.com/JabRef/jabref/commit/586b3cf9f9db8b6ec7bde5a902bb1930102d8a80", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-08-31T11:48:59Z", "type": "commit"}, {"oid": "5ae9b4bc81693ab60fe498f532bbec51ecf6f0f8", "url": "https://github.com/JabRef/jabref/commit/5ae9b4bc81693ab60fe498f532bbec51ecf6f0f8", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-09-01T16:19:26Z", "type": "commit"}, {"oid": "d10583ab1ccad7d4899b0a72e9d92559e5f85ceb", "url": "https://github.com/JabRef/jabref/commit/d10583ab1ccad7d4899b0a72e9d92559e5f85ceb", "message": "Add entry formatter between fetchers and imports\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>", "committedDate": "2020-09-01T18:14:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ2MTIwMg==", "url": "https://github.com/JabRef/jabref/pull/6833#discussion_r481461202", "bodyText": "Doesn't the BasePanel (panel) know the mode? Shouldn't that mode be used instead of guessing?", "author": "koppor", "createdAt": "2020-09-01T22:12:43Z", "path": "src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java", "diffHunk": "@@ -64,6 +67,8 @@ public void fetchAndMerge(BibEntry entry, List<Field> fields) {\n                 if (fetcher.isPresent()) {\n                     BackgroundTask.wrap(() -> fetcher.get().performSearchById(fieldContent.get()))\n                                   .onSuccess(fetchedEntry -> {\n+                                      ImportCleanup cleanup = new ImportCleanup(BibDatabaseModeDetection.inferMode(new BibDatabase(List.of(entry))));", "originalCommit": "d10583ab1ccad7d4899b0a72e9d92559e5f85ceb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2824eb5defccc62f6dbe8cec272f5f2043e31d4b", "chunk": "diff --git a/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java b/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java\nindex 15356e647..c5b9d0d41 100644\n--- a/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java\n+++ b/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java\n\n@@ -67,7 +65,7 @@ public class FetchAndMergeEntry {\n                 if (fetcher.isPresent()) {\n                     BackgroundTask.wrap(() -> fetcher.get().performSearchById(fieldContent.get()))\n                                   .onSuccess(fetchedEntry -> {\n-                                      ImportCleanup cleanup = new ImportCleanup(BibDatabaseModeDetection.inferMode(new BibDatabase(List.of(entry))));\n+                                      ImportCleanup cleanup = new ImportCleanup(panel.getBibDatabaseContext().getMode());\n                                       cleanup.doPostCleanup(entry);\n                                       String type = field.getDisplayName();\n                                       if (fetchedEntry.isPresent()) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTQ2MTM4MQ==", "url": "https://github.com/JabRef/jabref/pull/6833#discussion_r481461381", "bodyText": "See above", "author": "koppor", "createdAt": "2020-09-01T22:13:07Z", "path": "src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java", "diffHunk": "@@ -147,6 +152,8 @@ public void fetchAndMerge(BibEntry entry, EntryBasedFetcher fetcher) {\n         BackgroundTask.wrap(() -> fetcher.performSearch(entry).stream().findFirst())\n                       .onSuccess(fetchedEntry -> {\n                           if (fetchedEntry.isPresent()) {\n+                              ImportCleanup cleanup = new ImportCleanup(BibDatabaseModeDetection.inferMode(new BibDatabase(List.of(entry))));", "originalCommit": "d10583ab1ccad7d4899b0a72e9d92559e5f85ceb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2824eb5defccc62f6dbe8cec272f5f2043e31d4b", "chunk": "diff --git a/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java b/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java\nindex 15356e647..c5b9d0d41 100644\n--- a/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java\n+++ b/src/main/java/org/jabref/gui/mergeentries/FetchAndMergeEntry.java\n\n@@ -152,7 +150,7 @@ public class FetchAndMergeEntry {\n         BackgroundTask.wrap(() -> fetcher.performSearch(entry).stream().findFirst())\n                       .onSuccess(fetchedEntry -> {\n                           if (fetchedEntry.isPresent()) {\n-                              ImportCleanup cleanup = new ImportCleanup(BibDatabaseModeDetection.inferMode(new BibDatabase(List.of(entry))));\n+                              ImportCleanup cleanup = new ImportCleanup(panel.getBibDatabaseContext().getMode());\n                               cleanup.doPostCleanup(fetchedEntry.get());\n                               showMergeDialog(entry, fetchedEntry.get(), fetcher);\n                           } else {\n"}}, {"oid": "004f8befa029170ed549fecaf9efa43d80a6dd21", "url": "https://github.com/JabRef/jabref/commit/004f8befa029170ed549fecaf9efa43d80a6dd21", "message": "Merge remote-tracking branch 'upstream/master' into fix/use-format-conversion-for-all-imports", "committedDate": "2020-09-02T12:37:39Z", "type": "commit"}, {"oid": "2824eb5defccc62f6dbe8cec272f5f2043e31d4b", "url": "https://github.com/JabRef/jabref/commit/2824eb5defccc62f6dbe8cec272f5f2043e31d4b", "message": "Integrate change requests\n\nSigned-off-by: Dominik Voigt <dominik.ingo.voigt@gmail.com>", "committedDate": "2020-09-02T12:41:23Z", "type": "commit"}]}