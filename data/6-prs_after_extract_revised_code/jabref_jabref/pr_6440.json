{"pr_number": 6440, "pr_title": "Add support for jumping in ordered author list by typing letters", "pr_createdAt": "2020-05-07T10:47:43Z", "pr_url": "https://github.com/JabRef/jabref/pull/6440", "timeline": [{"oid": "aa3132b81008cb61baa3394791160dd779c6c5c3", "url": "https://github.com/JabRef/jabref/commit/aa3132b81008cb61baa3394791160dd779c6c5c3", "message": "Showing correct icon on main table linked files column", "committedDate": "2020-04-08T14:46:45Z", "type": "commit"}, {"oid": "9c9b7c1fcf5b7a90f71254df3c6a4ef59967c861", "url": "https://github.com/JabRef/jabref/commit/9c9b7c1fcf5b7a90f71254df3c6a4ef59967c861", "message": "Showing correct icon on both main table and linked files column", "committedDate": "2020-04-15T09:43:36Z", "type": "commit"}, {"oid": "2302b8ac5588fafa8f631e5be54a0807edbe4efd", "url": "https://github.com/JabRef/jabref/commit/2302b8ac5588fafa8f631e5be54a0807edbe4efd", "message": "Merge remote-tracking branch 'origin/pdf-icon-in-linked-files-column' into pdf-icon-in-linked-files-column", "committedDate": "2020-04-15T09:46:14Z", "type": "commit"}, {"oid": "8090ea51ced82fa2ea514ff4258ab23f59ff92a2", "url": "https://github.com/JabRef/jabref/commit/8090ea51ced82fa2ea514ff4258ab23f59ff92a2", "message": "Showing correct icon on both main table and linked file editor list", "committedDate": "2020-04-15T09:51:24Z", "type": "commit"}, {"oid": "72fc91c114dc57dd1e41f189cb0bc4b1b7341102", "url": "https://github.com/JabRef/jabref/commit/72fc91c114dc57dd1e41f189cb0bc4b1b7341102", "message": "delete the TODO comments", "committedDate": "2020-04-15T11:32:50Z", "type": "commit"}, {"oid": "e9796642b245badbd100cf83289cfa61ca0f4609", "url": "https://github.com/JabRef/jabref/commit/e9796642b245badbd100cf83289cfa61ca0f4609", "message": "add record in CHANGELOG.md", "committedDate": "2020-04-15T11:46:24Z", "type": "commit"}, {"oid": "95072cd56af45e1e7468f050039d970395b91196", "url": "https://github.com/JabRef/jabref/commit/95072cd56af45e1e7468f050039d970395b91196", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-05-03T09:16:40Z", "type": "commit"}, {"oid": "62264aea1665a7904a4abb04137355178df253f7", "url": "https://github.com/JabRef/jabref/commit/62264aea1665a7904a4abb04137355178df253f7", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-05-04T12:51:58Z", "type": "commit"}, {"oid": "87c8b411c77d3559477156fb974d9bcaf8dab698", "url": "https://github.com/JabRef/jabref/commit/87c8b411c77d3559477156fb974d9bcaf8dab698", "message": "Add jump in ordered author list by typing letter function", "committedDate": "2020-05-07T10:31:28Z", "type": "commit"}, {"oid": "0f2de68a8225932a2bb76c71ce3d9a4e72411cb2", "url": "https://github.com/JabRef/jabref/commit/0f2de68a8225932a2bb76c71ce3d9a4e72411cb2", "message": "Merge remote-tracking branch 'upstream/master' into jump-in-ordered-author-list-by-typing-letters", "committedDate": "2020-05-07T10:31:49Z", "type": "commit"}, {"oid": "2a364e6287ae1b45fd6586a7e48b88834d44cc1c", "url": "https://github.com/JabRef/jabref/commit/2a364e6287ae1b45fd6586a7e48b88834d44cc1c", "message": "modify changelog.md supporting for jumping to target entry", "committedDate": "2020-05-07T10:41:34Z", "type": "commit"}, {"oid": "047f0424b22c8d712c7b5717054d1b7d83dc9763", "url": "https://github.com/JabRef/jabref/commit/047f0424b22c8d712c7b5717054d1b7d83dc9763", "message": "Merge branch 'master' into jump-in-ordered-author-list-by-typing-letters", "committedDate": "2020-05-07T10:50:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTgxNDk5MA==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r421814990", "bodyText": "How does this scale on large libraries? Can you please test this to be sure?", "author": "calixtus", "createdAt": "2020-05-07T21:49:05Z", "path": "src/main/java/org/jabref/gui/maintable/MainTable.java", "diffHunk": "@@ -123,6 +137,19 @@ public MainTable(MainTableDataModel model, JabRefFrame frame,\n         database.getDatabase().registerListener(this);\n     }\n \n+    private int getEntryIndexByInput(TableColumn<BibEntryTableViewModel, ?> column, char target_char) {\n+        for (int i = 0; i < this.getItems().size(); ++i) {\n+            Object temp = column.getCellObservableValue(i).getValue();\n+            if (temp == null) {\n+                continue;\n+            }\n+            if (temp.toString().toLowerCase().charAt(0) == target_char) {\n+                return i;\n+            }\n+        }\n+        return -1;", "originalCommit": "047f0424b22c8d712c7b5717054d1b7d83dc9763", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "8368aff8caf9b1ec5a65c9244ee0c23a1c91034c", "chunk": "diff --git a/src/main/java/org/jabref/gui/maintable/MainTable.java b/src/main/java/org/jabref/gui/maintable/MainTable.java\nindex 72cb398dc3..1510118470 100644\n--- a/src/main/java/org/jabref/gui/maintable/MainTable.java\n+++ b/src/main/java/org/jabref/gui/maintable/MainTable.java\n\n@@ -137,17 +134,33 @@ public class MainTable extends TableView<BibEntryTableViewModel> {\n         database.getDatabase().registerListener(this);\n     }\n \n-    private int getEntryIndexByInput(TableColumn<BibEntryTableViewModel, ?> column, char target_char) {\n-        for (int i = 0; i < this.getItems().size(); ++i) {\n-            Object temp = column.getCellObservableValue(i).getValue();\n-            if (temp == null) {\n-                continue;\n-            }\n-            if (temp.toString().toLowerCase().charAt(0) == target_char) {\n-                return i;\n-            }\n+    /**\n+     * This is called, if a user starts typing some characters into the keyboard with focus on main table.\n+     * The tableview will scroll to the next cell with the name of the PreviewLayout fitting those characters.\n+     * @param sortedColumn The ListView currently focused\n+     * @param keyEvent The pressed character\n+     */\n+\n+    private void jumpToSearchKey(TableColumn<BibEntryTableViewModel, ?> sortedColumn, KeyEvent keyEvent) {\n+        if (keyEvent.getCharacter() == null || sortedColumn == null) {\n+            return;\n         }\n-        return -1;\n+\n+        if (System.currentTimeMillis() - lastKeyPressTime < 700) {\n+            columnSearchTerm += keyEvent.getCharacter().toLowerCase();\n+        } else {\n+            columnSearchTerm = keyEvent.getCharacter().toLowerCase();\n+        }\n+\n+        lastKeyPressTime = System.currentTimeMillis();\n+\n+        this.getItems().stream()\n+            .filter(item -> Optional.ofNullable(sortedColumn.getCellObservableValue(item).getValue())\n+                                    .map(Object::toString)\n+                                    .orElse(\"\")\n+                                    .toLowerCase().startsWith(columnSearchTerm))\n+            .findFirst()\n+            .ifPresent(item -> { this.scrollTo(item); this.clearAndSelect(item.getEntry()); });\n     }\n \n     @Subscribe\n"}}, {"oid": "8368aff8caf9b1ec5a65c9244ee0c23a1c91034c", "url": "https://github.com/JabRef/jabref/commit/8368aff8caf9b1ec5a65c9244ee0c23a1c91034c", "message": "Using java stream rewrite the method and enable multiple key input", "committedDate": "2020-05-08T04:33:05Z", "type": "commit"}, {"oid": "1b427a39a923b2880dacb21b47bb5e6123b8aa38", "url": "https://github.com/JabRef/jabref/commit/1b427a39a923b2880dacb21b47bb5e6123b8aa38", "message": "Update javadoc", "committedDate": "2020-05-08T13:51:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE3ODM0MA==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422178340", "bodyText": "You can put these statements inside the lambda expression in multiple lines.\nSorry, I think my previous comment was a bit misunderstandable.\nBesides that, it looks good to me. let's see what a second developer says.", "author": "calixtus", "createdAt": "2020-05-08T14:33:32Z", "path": "src/main/java/org/jabref/gui/maintable/MainTable.java", "diffHunk": "@@ -123,6 +134,35 @@ public MainTable(MainTableDataModel model, JabRefFrame frame,\n         database.getDatabase().registerListener(this);\n     }\n \n+    /**\n+     * This is called, if a user starts typing some characters into the keyboard with focus on main table.\n+     * The tableview will scroll to the cell with the same starting column value and typed string\n+     * @param sortedColumn The ListView currently focused\n+     * @param keyEvent The pressed character\n+     */\n+\n+    private void jumpToSearchKey(TableColumn<BibEntryTableViewModel, ?> sortedColumn, KeyEvent keyEvent) {\n+        if (keyEvent.getCharacter() == null || sortedColumn == null) {\n+            return;\n+        }\n+\n+        if (System.currentTimeMillis() - lastKeyPressTime < 700) {\n+            columnSearchTerm += keyEvent.getCharacter().toLowerCase();\n+        } else {\n+            columnSearchTerm = keyEvent.getCharacter().toLowerCase();\n+        }\n+\n+        lastKeyPressTime = System.currentTimeMillis();\n+\n+        this.getItems().stream()\n+            .filter(item -> Optional.ofNullable(sortedColumn.getCellObservableValue(item).getValue())\n+                                    .map(Object::toString)\n+                                    .orElse(\"\")\n+                                    .toLowerCase().startsWith(columnSearchTerm))\n+            .findFirst()\n+            .ifPresent(item -> { this.scrollTo(item); this.clearAndSelect(item.getEntry()); });", "originalCommit": "1b427a39a923b2880dacb21b47bb5e6123b8aa38", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIwMTU3NQ==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422201575", "bodyText": "Sorry, I don't quite understand what your mean. You mean I should shrink the code in the lambda expression into one or two lines instead of occupying multiple lines?", "author": "leitianjian", "createdAt": "2020-05-08T15:14:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE3ODM0MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjIxOTI4Ng==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422219286", "bodyText": "This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. Learn more about bidirectional Unicode characters\n\n\n  \n\n\n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        .ifPresent(item -> { this.scrollTo(item); this.clearAndSelect(item.getEntry()); });\n          \n          \n            \n                        .ifPresent(item -> {\n          \n          \n            \n                            this.scrollTo(item);\n          \n          \n            \n                            this.clearAndSelect(item.getEntry());\n          \n          \n            \n                        });", "author": "calixtus", "createdAt": "2020-05-08T15:47:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE3ODM0MA=="}], "type": "inlineReview", "revised_code": {"commit": "a37b8a3b5fef62f25b00c525344260209c2bef09", "chunk": "diff --git a/src/main/java/org/jabref/gui/maintable/MainTable.java b/src/main/java/org/jabref/gui/maintable/MainTable.java\nindex 73ef48e659..3edb3fb961 100644\n--- a/src/main/java/org/jabref/gui/maintable/MainTable.java\n+++ b/src/main/java/org/jabref/gui/maintable/MainTable.java\n\n@@ -160,7 +160,10 @@ public class MainTable extends TableView<BibEntryTableViewModel> {\n                                     .orElse(\"\")\n                                     .toLowerCase().startsWith(columnSearchTerm))\n             .findFirst()\n-            .ifPresent(item -> { this.scrollTo(item); this.clearAndSelect(item.getEntry()); });\n+            .ifPresent(item -> {\n+                this.scrollTo(item);\n+                this.clearAndSelect(item.getEntry());\n+            });\n     }\n \n     @Subscribe\n"}}, {"oid": "a37b8a3b5fef62f25b00c525344260209c2bef09", "url": "https://github.com/JabRef/jabref/commit/a37b8a3b5fef62f25b00c525344260209c2bef09", "message": "Adjust code format in @calixtus suggestions.\n\nCo-authored-by: Carl Christian Snethlage <50491877+calixtus@users.noreply.github.com>", "committedDate": "2020-05-08T16:01:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQxMDY3OQ==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422410679", "bodyText": "Please check for emptyness using .isEmpty().", "author": "koppor", "createdAt": "2020-05-08T22:53:48Z", "path": "src/main/java/org/jabref/gui/maintable/MainTable.java", "diffHunk": "@@ -57,11 +58,21 @@\n     private final ImportHandler importHandler;\n     private final CustomLocalDragboard localDragboard;\n \n+    private long lastKeyPressTime;\n+    private String columnSearchTerm;\n+\n     public MainTable(MainTableDataModel model, JabRefFrame frame,\n                      BasePanel panel, BibDatabaseContext database,\n                      MainTablePreferences preferences, ExternalFileTypes externalFileTypes, KeyBindingRepository keyBindingRepository) {\n         super();\n \n+        this.setOnKeyTyped(key -> {\n+            if (this.getSortOrder().size() == 0) {", "originalCommit": "a37b8a3b5fef62f25b00c525344260209c2bef09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQzODU5Ng==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422438596", "bodyText": "Yeah, It is much better than checking the size, I will modify it. Thanks for your suggestions", "author": "leitianjian", "createdAt": "2020-05-09T01:39:40Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQxMDY3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "c1073b5a14bc5fdd447a535faabcbada269711c1", "chunk": "diff --git a/src/main/java/org/jabref/gui/maintable/MainTable.java b/src/main/java/org/jabref/gui/maintable/MainTable.java\nindex 3edb3fb961..f9a2122041 100644\n--- a/src/main/java/org/jabref/gui/maintable/MainTable.java\n+++ b/src/main/java/org/jabref/gui/maintable/MainTable.java\n\n@@ -67,7 +67,7 @@ public class MainTable extends TableView<BibEntryTableViewModel> {\n         super();\n \n         this.setOnKeyTyped(key -> {\n-            if (this.getSortOrder().size() == 0) {\n+            if (this.getSortOrder().isEmpty()) {\n                 return;\n             }\n             this.jumpToSearchKey(getSortOrder().get(0), key);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQxMDc5Mg==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422410792", "bodyText": "@param and the text should be separated by one empty line.\nI think, this is done by the intelliJ auto formatter", "author": "koppor", "createdAt": "2020-05-08T22:54:15Z", "path": "src/main/java/org/jabref/gui/maintable/MainTable.java", "diffHunk": "@@ -123,6 +134,38 @@ public MainTable(MainTableDataModel model, JabRefFrame frame,\n         database.getDatabase().registerListener(this);\n     }\n \n+    /**\n+     * This is called, if a user starts typing some characters into the keyboard with focus on main table.\n+     * The tableview will scroll to the cell with the same starting column value and typed string\n+     * @param sortedColumn The ListView currently focused", "originalCommit": "a37b8a3b5fef62f25b00c525344260209c2bef09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQzOTkxMg==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422439912", "bodyText": "Yeah, The empty line is necessary. I did not notice that before", "author": "leitianjian", "createdAt": "2020-05-09T01:54:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQxMDc5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "c1073b5a14bc5fdd447a535faabcbada269711c1", "chunk": "diff --git a/src/main/java/org/jabref/gui/maintable/MainTable.java b/src/main/java/org/jabref/gui/maintable/MainTable.java\nindex 3edb3fb961..f9a2122041 100644\n--- a/src/main/java/org/jabref/gui/maintable/MainTable.java\n+++ b/src/main/java/org/jabref/gui/maintable/MainTable.java\n\n@@ -136,8 +136,9 @@ public class MainTable extends TableView<BibEntryTableViewModel> {\n \n     /**\n      * This is called, if a user starts typing some characters into the keyboard with focus on main table.\n-     * The tableview will scroll to the cell with the same starting column value and typed string\n-     * @param sortedColumn The ListView currently focused\n+     * The {@link MainTable} will scroll to the cell with the same starting column value and typed string\n+     *\n+     * @param sortedColumn The sorted column in {@link MainTable}\n      * @param keyEvent The pressed character\n      */\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQxMDk2NQ==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422410965", "bodyText": "Please put .startsWith in the next line to have all . calls in a separate line.", "author": "koppor", "createdAt": "2020-05-08T22:55:00Z", "path": "src/main/java/org/jabref/gui/maintable/MainTable.java", "diffHunk": "@@ -123,6 +134,38 @@ public MainTable(MainTableDataModel model, JabRefFrame frame,\n         database.getDatabase().registerListener(this);\n     }\n \n+    /**\n+     * This is called, if a user starts typing some characters into the keyboard with focus on main table.\n+     * The tableview will scroll to the cell with the same starting column value and typed string\n+     * @param sortedColumn The ListView currently focused\n+     * @param keyEvent The pressed character\n+     */\n+\n+    private void jumpToSearchKey(TableColumn<BibEntryTableViewModel, ?> sortedColumn, KeyEvent keyEvent) {\n+        if (keyEvent.getCharacter() == null || sortedColumn == null) {\n+            return;\n+        }\n+\n+        if (System.currentTimeMillis() - lastKeyPressTime < 700) {\n+            columnSearchTerm += keyEvent.getCharacter().toLowerCase();\n+        } else {\n+            columnSearchTerm = keyEvent.getCharacter().toLowerCase();\n+        }\n+\n+        lastKeyPressTime = System.currentTimeMillis();\n+\n+        this.getItems().stream()\n+            .filter(item -> Optional.ofNullable(sortedColumn.getCellObservableValue(item).getValue())\n+                                    .map(Object::toString)\n+                                    .orElse(\"\")\n+                                    .toLowerCase().startsWith(columnSearchTerm))", "originalCommit": "a37b8a3b5fef62f25b00c525344260209c2bef09", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQzOTc2NA==", "url": "https://github.com/JabRef/jabref/pull/6440#discussion_r422439764", "bodyText": "Ok, I wonder should we have all . calls in a separate line when we write stream like code in java?", "author": "leitianjian", "createdAt": "2020-05-09T01:52:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQxMDk2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "c1073b5a14bc5fdd447a535faabcbada269711c1", "chunk": "diff --git a/src/main/java/org/jabref/gui/maintable/MainTable.java b/src/main/java/org/jabref/gui/maintable/MainTable.java\nindex 3edb3fb961..f9a2122041 100644\n--- a/src/main/java/org/jabref/gui/maintable/MainTable.java\n+++ b/src/main/java/org/jabref/gui/maintable/MainTable.java\n\n@@ -136,8 +136,9 @@ public class MainTable extends TableView<BibEntryTableViewModel> {\n \n     /**\n      * This is called, if a user starts typing some characters into the keyboard with focus on main table.\n-     * The tableview will scroll to the cell with the same starting column value and typed string\n-     * @param sortedColumn The ListView currently focused\n+     * The {@link MainTable} will scroll to the cell with the same starting column value and typed string\n+     *\n+     * @param sortedColumn The sorted column in {@link MainTable}\n      * @param keyEvent The pressed character\n      */\n \n"}}, {"oid": "c1073b5a14bc5fdd447a535faabcbada269711c1", "url": "https://github.com/JabRef/jabref/commit/c1073b5a14bc5fdd447a535faabcbada269711c1", "message": "Update code format in @koppor suggestions and update javadoc", "committedDate": "2020-05-09T01:49:40Z", "type": "commit"}]}