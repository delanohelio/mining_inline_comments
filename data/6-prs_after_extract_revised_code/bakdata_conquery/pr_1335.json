{"pr_number": 1335, "pr_title": "Feature/fix exists aggregator logic", "pr_createdAt": "2020-09-04T09:19:17Z", "pr_url": "https://github.com/bakdata/conquery/pull/1335", "timeline": [{"oid": "db7e45d859959219085c4fcb87eb12e798e395c6", "url": "https://github.com/bakdata/conquery/commit/db7e45d859959219085c4fcb87eb12e798e395c6", "message": "fix references of ExistsAggregator to their respective levels (ConceptLevel = created OrNode, ConnectorLevel = created FiltersNode)", "committedDate": "2020-09-04T09:15:39Z", "type": "commit"}, {"oid": "c6886eab7c38f200fc3f6620344201ffaad7dc3c", "url": "https://github.com/bakdata/conquery/commit/c6886eab7c38f200fc3f6620344201ffaad7dc3c", "message": "automatic update to docs", "committedDate": "2020-09-04T09:21:20Z", "type": "commit"}, {"oid": "4a1250b34f990995ff7c460c03bcb22c95ebfbfc", "url": "https://github.com/bakdata/conquery/commit/4a1250b34f990995ff7c460c03bcb22c95ebfbfc", "message": "fix infinite loop in cloning of FiltersNode/ExistsAggregator by removing them from FiltersNode", "committedDate": "2020-09-04T13:40:18Z", "type": "commit"}, {"oid": "6518ddf4ac84ad6568b529e2d6b1ddfed9d7350b", "url": "https://github.com/bakdata/conquery/commit/6518ddf4ac84ad6568b529e2d6b1ddfed9d7350b", "message": "automatic update to docs", "committedDate": "2020-09-04T13:42:32Z", "type": "commit"}, {"oid": "fa2958be1478a81ce72577bc566e2fa47a52fac6", "url": "https://github.com/bakdata/conquery/commit/fa2958be1478a81ce72577bc566e2fa47a52fac6", "message": "add leaf node instead of filternode if no filters of aggregartors are set", "committedDate": "2020-09-07T11:27:49Z", "type": "commit"}, {"oid": "5076afbe43dac9fbe12915a54415fa1722b611dd", "url": "https://github.com/bakdata/conquery/commit/5076afbe43dac9fbe12915a54415fa1722b611dd", "message": "git namespace a to string method", "committedDate": "2020-09-07T11:28:09Z", "type": "commit"}, {"oid": "f2c3ec178fbc6d79efef633dff9daab9da42247b", "url": "https://github.com/bakdata/conquery/commit/f2c3ec178fbc6d79efef633dff9daab9da42247b", "message": "automatic update to docs", "committedDate": "2020-09-07T11:30:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDIzOTE1OA==", "url": "https://github.com/bakdata/conquery/pull/1335#discussion_r484239158", "bodyText": "Ich denke es ist falsch, Dass die Concept-Aggregatoren f\u00fcr jede Table hinzugef\u00fcgt werden. Das sollte nur einmal passieren.", "author": "thoniTUB", "createdAt": "2020-09-07T07:40:14Z", "path": "backend/src/main/java/com/bakdata/conquery/models/query/concept/specific/CQConcept.java", "diffHunk": "@@ -99,14 +102,27 @@ public QPNode createQueryPlan(QueryPlanContext context, ConceptQueryPlan plan) {\n \t\t\t//add aggregators\n \n \t\t\taggregators.addAll(conceptAggregators);", "originalCommit": "6518ddf4ac84ad6568b529e2d6b1ddfed9d7350b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0Mjk2OA==", "url": "https://github.com/bakdata/conquery/pull/1335#discussion_r484242968", "bodyText": "Bzw. ich verstehe nicht weshalb eine Filternode die Concept-Aggregatoren haben sollte.", "author": "thoniTUB", "createdAt": "2020-09-07T07:45:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDIzOTE1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI0NDU2OQ==", "url": "https://github.com/bakdata/conquery/pull/1335#discussion_r484244569", "bodyText": "Kann es dann nicht vorkommen, dass ein Concept-Aggregator ein Event mehrere Male bekommt, da es durch verschiedene FilterNodes zu dem Aggregator gelangt?", "author": "thoniTUB", "createdAt": "2020-09-07T07:46:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDIzOTE1OA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI1MDkxNg==", "url": "https://github.com/bakdata/conquery/pull/1335#discussion_r484250916", "bodyText": "Das sollte doch f\u00fcr alle Concept-Aggregatoren gelten, oder nicht?", "author": "thoniTUB", "createdAt": "2020-09-07T07:53:23Z", "path": "backend/src/main/java/com/bakdata/conquery/models/query/concept/specific/CQConcept.java", "diffHunk": "@@ -124,7 +140,17 @@ public QPNode createQueryPlan(QueryPlanContext context, ConceptQueryPlan plan) {\n \t\t\tthrow new IllegalStateException(String.format(\"Unable to resolve any connector for query `%s`\", label));\n \t\t}\n \n-\t\treturn OrNode.of(tableNodes);\n+\t\tfinal QPNode outNode = OrNode.of(tableNodes);\n+\n+\t\tfor (Iterator<Aggregator<?>> iterator = conceptAggregators.iterator(); iterator.hasNext(); ) {\n+\t\t\tAggregator<?> aggregator = iterator.next();\n+\t\t\tif (aggregator instanceof ExistsAggregator) {", "originalCommit": "6518ddf4ac84ad6568b529e2d6b1ddfed9d7350b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}