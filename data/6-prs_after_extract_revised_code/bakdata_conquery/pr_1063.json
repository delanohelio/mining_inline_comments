{"pr_number": 1063, "pr_title": "adds download button for auth overview", "pr_createdAt": "2020-03-02T20:24:48Z", "pr_url": "https://github.com/bakdata/conquery/pull/1063", "timeline": [{"oid": "0cf8a25f603b19bb0247624fef765b6c28555a9b", "url": "https://github.com/bakdata/conquery/commit/0cf8a25f603b19bb0247624fef765b6c28555a9b", "message": "adds download button for auth overview", "committedDate": "2020-03-02T20:24:17Z", "type": "commit"}, {"oid": "667dc3e1d3c8c6031ba7ab65d548b04b3c6fb8f2", "url": "https://github.com/bakdata/conquery/commit/667dc3e1d3c8c6031ba7ab65d548b04b3c6fb8f2", "message": "fixes admin endpoint test", "committedDate": "2020-03-04T13:38:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjk1MDA4Nw==", "url": "https://github.com/bakdata/conquery/pull/1063#discussion_r392950087", "bodyText": "Der Univocity parser kann ein WriteHeader o\u00e4", "author": "awildturtok", "createdAt": "2020-03-16T11:27:40Z", "path": "backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java", "diffHunk": "@@ -479,29 +479,64 @@ public FEAuthOverview getAuthOverview() {\n \t\treturn FEAuthOverview.builder().overview(overview).build();\n \t}\n \n+\t/**\n+\t * Renders the permission overview for all users in form of a CSV.\n+\t */\n \tpublic String getPermissionOverviewAsCSV() {\n+\t\treturn getPermissionOverviewAsCSV(storage.getAllUsers());\n+\t}\n+\n+\n+\t/**\n+\t * Renders the permission overview for all users in a certain {@link Group} in form of a CSV.\n+\t */\n+\tpublic String getPermissionOverviewAsCSV(GroupId groupId) {\n+\t\tGroup group = Objects.requireNonNull(storage.getGroup(groupId), \"The group was not found\");\n+\t\treturn getPermissionOverviewAsCSV(group.getMembers());\n+\t}\n+\t\n+\t/**\n+\t * Renders the permission overview for certian {@link User} in form of a CSV.\n+\t */\n+\tpublic String getPermissionOverviewAsCSV(Collection<User> users) {\n \t\tStringWriter sWriter = new StringWriter();\n \t\tCsvWriter writer = CsvIo.createWriter(sWriter);\n \t\tList<String> scope = ConqueryConfig.getInstance()\n \t\t\t.getAuthorization()\n \t\t\t.getOverviewScope();\n \t\t// Header\n+\t\twriteAuthOverviewHeader(writer, scope);\n+\t\t// Body\n+\t\tfor (User user : users) {\n+\t\t\twriteAuthOverviewUser(writer, scope, user, storage);\n+\t\t}\n+\t\treturn sWriter.toString();\n+\t}\n+\t\n+\t/**\n+\t * Writes the header of the CSV auth overview to the specified writer.\n+\t */\n+\tprivate static void writeAuthOverviewHeader(CsvWriter writer, List<String> scope) {", "originalCommit": "667dc3e1d3c8c6031ba7ab65d548b04b3c6fb8f2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "9ac0b986e9050cd486f3b7c2f9af63cc7f73f132", "chunk": "diff --git a/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java b/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java\nindex 041e3f660..e0ea06bf6 100644\n--- a/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java\n+++ b/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java\n\n@@ -517,9 +517,10 @@ public class AdminProcessor {\n \t * Writes the header of the CSV auth overview to the specified writer.\n \t */\n \tprivate static void writeAuthOverviewHeader(CsvWriter writer, List<String> scope) {\n-\t\twriter.addValue(\"User\");\n-\t\twriter.addValues(scope);\n-\t\twriter.writeValuesToRow();\n+\t\tList<String> headers = new ArrayList<>();\n+\t\theaders.add(\"User\");\n+\t\theaders.addAll(scope);\n+\t\twriter.writeHeaders(headers);\n \t}\n \t\n \t/**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjk1MDg4MQ==", "url": "https://github.com/bakdata/conquery/pull/1063#discussion_r392950881", "bodyText": "Ich w\u00fcrde das dann versuchen direkt als OutputStream zu l\u00f6sen, dass gar nicht gebuffert wird.", "author": "awildturtok", "createdAt": "2020-03-16T11:29:16Z", "path": "backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java", "diffHunk": "@@ -479,29 +479,64 @@ public FEAuthOverview getAuthOverview() {\n \t\treturn FEAuthOverview.builder().overview(overview).build();\n \t}\n \n+\t/**\n+\t * Renders the permission overview for all users in form of a CSV.\n+\t */\n \tpublic String getPermissionOverviewAsCSV() {\n+\t\treturn getPermissionOverviewAsCSV(storage.getAllUsers());\n+\t}\n+\n+\n+\t/**\n+\t * Renders the permission overview for all users in a certain {@link Group} in form of a CSV.\n+\t */\n+\tpublic String getPermissionOverviewAsCSV(GroupId groupId) {\n+\t\tGroup group = Objects.requireNonNull(storage.getGroup(groupId), \"The group was not found\");\n+\t\treturn getPermissionOverviewAsCSV(group.getMembers());\n+\t}\n+\t\n+\t/**\n+\t * Renders the permission overview for certian {@link User} in form of a CSV.\n+\t */\n+\tpublic String getPermissionOverviewAsCSV(Collection<User> users) {\n \t\tStringWriter sWriter = new StringWriter();", "originalCommit": "667dc3e1d3c8c6031ba7ab65d548b04b3c6fb8f2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjk1MTAwMw==", "url": "https://github.com/bakdata/conquery/pull/1063#discussion_r392951003", "bodyText": "Also dass du als parameter nen Stream bekommst", "author": "awildturtok", "createdAt": "2020-03-16T11:29:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5Mjk1MDg4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "9ac0b986e9050cd486f3b7c2f9af63cc7f73f132", "chunk": "diff --git a/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java b/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java\nindex 041e3f660..e0ea06bf6 100644\n--- a/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java\n+++ b/backend/src/main/java/com/bakdata/conquery/resources/admin/rest/AdminProcessor.java\n\n@@ -517,9 +517,10 @@ public class AdminProcessor {\n \t * Writes the header of the CSV auth overview to the specified writer.\n \t */\n \tprivate static void writeAuthOverviewHeader(CsvWriter writer, List<String> scope) {\n-\t\twriter.addValue(\"User\");\n-\t\twriter.addValues(scope);\n-\t\twriter.writeValuesToRow();\n+\t\tList<String> headers = new ArrayList<>();\n+\t\theaders.add(\"User\");\n+\t\theaders.addAll(scope);\n+\t\twriter.writeHeaders(headers);\n \t}\n \t\n \t/**\n"}}, {"oid": "e1da7a5abcfaa5644c362034ea6c3d519a6c5e1b", "url": "https://github.com/bakdata/conquery/commit/e1da7a5abcfaa5644c362034ea6c3d519a6c5e1b", "message": "simplifies download button", "committedDate": "2020-03-16T14:49:05Z", "type": "commit"}, {"oid": "9ac0b986e9050cd486f3b7c2f9af63cc7f73f132", "url": "https://github.com/bakdata/conquery/commit/9ac0b986e9050cd486f3b7c2f9af63cc7f73f132", "message": "writes header using lib methods", "committedDate": "2020-03-16T15:09:11Z", "type": "commit"}, {"oid": "af17025c3c5f132a4e24db9aded4630653e284b2", "url": "https://github.com/bakdata/conquery/commit/af17025c3c5f132a4e24db9aded4630653e284b2", "message": "Merge branch 'develop' into feature/auth-overview-donload-button", "committedDate": "2020-03-16T15:10:14Z", "type": "commit"}]}