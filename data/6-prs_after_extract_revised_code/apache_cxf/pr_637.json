{"pr_number": 637, "pr_title": "Cxf 8208 - Handle exceptions when looking up swagger ui resources", "pr_createdAt": "2020-02-06T18:32:02Z", "pr_url": "https://github.com/apache/cxf/pull/637", "timeline": [{"oid": "380dc973c7d70f745cab28aa2ede637cef4bb75d", "url": "https://github.com/apache/cxf/commit/380dc973c7d70f745cab28aa2ede637cef4bb75d", "message": "Fix condition where swaggerui resource would fail requests with special\ncharacters. add test CXF-8208", "committedDate": "2020-02-06T18:23:50Z", "type": "commit"}, {"oid": "75983aaf974456a87eeab6a40a17eaa0c4285891", "url": "https://github.com/apache/cxf/commit/75983aaf974456a87eeab6a40a17eaa0c4285891", "message": "CXF-8208 add junit, fix exception handler", "committedDate": "2020-02-06T18:25:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA2NjQ3Ng==", "url": "https://github.com/apache/cxf/pull/637#discussion_r376066476", "bodyText": "use @test(expected = MalformedURLException .class)  instead of inner try-catch", "author": "amarkevich", "createdAt": "2020-02-06T20:32:54Z", "path": "rt/rs/description-swagger-ui/src/test/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUIResourceLocatorTest.java", "diffHunk": "@@ -0,0 +1,46 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.cxf.jaxrs.swagger.ui;\n+\n+import java.net.MalformedURLException;\n+\n+import org.junit.Test;\n+\n+\n+\n+public class SwaggerUIResourceLocatorTest {\n+\n+    @Test", "originalCommit": "75983aaf974456a87eeab6a40a17eaa0c4285891", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIyOTU4NA==", "url": "https://github.com/apache/cxf/pull/637#discussion_r376229584", "bodyText": "got it", "author": "natechadwick", "createdAt": "2020-02-07T06:16:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjA2NjQ3Ng=="}], "type": "inlineReview", "revised_code": {"commit": "5eefcc651c7add234dbf6a137c232008265d0017", "chunk": "diff --git a/rt/rs/description-swagger-ui/src/test/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUIResourceLocatorTest.java b/rt/rs/description-swagger-ui/src/test/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUIResourceLocatorTest.java\nindex 3c4436513c..1a7e6ba08c 100644\n--- a/rt/rs/description-swagger-ui/src/test/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUIResourceLocatorTest.java\n+++ b/rt/rs/description-swagger-ui/src/test/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUIResourceLocatorTest.java\n\n@@ -27,7 +27,7 @@ import org.junit.Test;\n \n public class SwaggerUIResourceLocatorTest {\n \n-    @Test\n+    @Test(expected = MalformedURLException.class)\n     public void testLocateWithBadCharactersInUrl() {\n         String url =\n                 \"jar:file:/Volumes/bigdrive/test157/jetty/base/webapps/\"\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5Nzg2NQ==", "url": "https://github.com/apache/cxf/pull/637#discussion_r376197865", "bodyText": "The URI.create may thrown only IllegalArgumentException exception, could you please use it instead of generic Exception? Thank you.", "author": "reta", "createdAt": "2020-02-07T03:22:51Z", "path": "rt/rs/description-swagger-ui/src/main/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUiResourceLocator.java", "diffHunk": "@@ -50,8 +50,14 @@ public URL locate(String resourcePath) throws MalformedURLException {\n         if (resourcePath.startsWith(\"/\")) {\n             resourcePath = resourcePath.substring(1);\n         }\n+        URL ret;\n \n-        return URI.create(swaggerUiRoot + resourcePath).toURL();\n+        try {\n+            ret = URI.create(swaggerUiRoot + resourcePath).toURL();\n+        } catch (Exception ex) {", "originalCommit": "75983aaf974456a87eeab6a40a17eaa0c4285891", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjIyNzg0NQ==", "url": "https://github.com/apache/cxf/pull/637#discussion_r376227845", "bodyText": "I can do that, but the way that the code is currently implemented, the only caller is looking for a MalformedURLException if there is any problem in this method, and the request chain gets nuked if any other exception is thrown which is kinda catastrophic.  Was thinking that any exception from this method should raise the MalformedURLException so the caller just returns false. Future proofing.  If you still want the specific exception caught I can edit and resubmit.", "author": "natechadwick", "createdAt": "2020-02-07T06:07:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5Nzg2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjY1NjQwMA==", "url": "https://github.com/apache/cxf/pull/637#discussion_r376656400", "bodyText": "Thanks for the response, it is fine to raise MalformedURLException as you did, the URI.create does not do anything beside parsing and throwing IllegalArgumentException:\n        try {\n            return URI.create(swaggerUiRoot + resourcePath).toURL();\n        } catch (IllegalArgumentException ex) {\n            throw new MalformedURLException(ex.getMessage(), ex);\n        }\n\nThank you.", "author": "reta", "createdAt": "2020-02-07T23:36:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5Nzg2NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njg5NjQ4Mw==", "url": "https://github.com/apache/cxf/pull/637#discussion_r376896483", "bodyText": "To avoid additional knowledge about internal RuntimeException rising a regular constructor with checked URISyntaxException can be used:\n        try {\n            return new URI(swaggerUiRoot + resourcePath).toURL();\n        } catch (URISyntaxException ex) {\n            throw new MalformedURLException(ex.getMessage());\n        }", "author": "amarkevich", "createdAt": "2020-02-10T07:15:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5Nzg2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ad4d73664a31a9c29a78a691626ee6253534739c", "chunk": "diff --git a/rt/rs/description-swagger-ui/src/main/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUiResourceLocator.java b/rt/rs/description-swagger-ui/src/main/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUiResourceLocator.java\nindex 5bb2eccc13..a303024e61 100644\n--- a/rt/rs/description-swagger-ui/src/main/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUiResourceLocator.java\n+++ b/rt/rs/description-swagger-ui/src/main/java/org/apache/cxf/jaxrs/swagger/ui/SwaggerUiResourceLocator.java\n\n@@ -54,7 +55,7 @@ public class SwaggerUiResourceLocator {\n \n         try {\n             ret = URI.create(swaggerUiRoot + resourcePath).toURL();\n-        } catch (Exception ex) {\n+        } catch (IllegalArgumentException ex) {\n             throw new MalformedURLException(ex.getMessage());\n         }\n         return ret;\n"}}, {"oid": "ad4d73664a31a9c29a78a691626ee6253534739c", "url": "https://github.com/apache/cxf/commit/ad4d73664a31a9c29a78a691626ee6253534739c", "message": "Specify IllegalArgumentException", "committedDate": "2020-02-10T00:57:39Z", "type": "commit"}, {"oid": "5eefcc651c7add234dbf6a137c232008265d0017", "url": "https://github.com/apache/cxf/commit/5eefcc651c7add234dbf6a137c232008265d0017", "message": "Remove try catch - add expected.", "committedDate": "2020-02-10T00:59:26Z", "type": "commit"}, {"oid": "3b30ea3c4affb65376acf541a9689ded1ac8df66", "url": "https://github.com/apache/cxf/commit/3b30ea3c4affb65376acf541a9689ded1ac8df66", "message": "Update SwaggerUiResourceLocator.java\n\nRemoved unneeded import.", "committedDate": "2020-02-15T23:54:21Z", "type": "commit"}, {"oid": "5807b8f339aaa97ea68726921a60f0a9c28516d6", "url": "https://github.com/apache/cxf/commit/5807b8f339aaa97ea68726921a60f0a9c28516d6", "message": "Update SwaggerUIResourceLocatorTest.java", "committedDate": "2020-02-17T17:40:39Z", "type": "commit"}]}