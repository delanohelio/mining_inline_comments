{"pr_number": 11734, "pr_title": "Enable EE9 run in the JSP 2.3 FAT", "pr_createdAt": "2020-04-10T19:16:39Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/11734", "timeline": [{"oid": "f1319e38e9778a5ffa12e948e270f5e8454f81e1", "url": "https://github.com/OpenLiberty/open-liberty/commit/f1319e38e9778a5ffa12e948e270f5e8454f81e1", "message": "11612: Enable RepeatTests for EE9 in JSP 2.3 FAT", "committedDate": "2020-04-10T19:18:36Z", "type": "forcePushed"}, {"oid": "d1f2900fad25ab5d9f1f730dd0cad90a9d5635fa", "url": "https://github.com/OpenLiberty/open-liberty/commit/d1f2900fad25ab5d9f1f730dd0cad90a9d5635fa", "message": "Remove cdi-3.0 from EE9_FEATURES_ARRAY", "committedDate": "2020-04-10T19:35:07Z", "type": "forcePushed"}, {"oid": "d9512d0582acbb71f78559736dc953b6499dbc17", "url": "https://github.com/OpenLiberty/open-liberty/commit/d9512d0582acbb71f78559736dc953b6499dbc17", "message": "Remove cdi-3.0 from EE9_FEATURES_ARRAY", "committedDate": "2020-04-10T20:40:15Z", "type": "forcePushed"}, {"oid": "6b9bf856be12e29454f2b29f5ee89c453ecbe318", "url": "https://github.com/OpenLiberty/open-liberty/commit/6b9bf856be12e29454f2b29f5ee89c453ecbe318", "message": "Remove cdi-3.0 from EE9_FEATURES_ARRAY", "committedDate": "2020-04-10T21:28:26Z", "type": "forcePushed"}, {"oid": "a588bafb3a1e731046e1dc6b42f23b60adb31a23", "url": "https://github.com/OpenLiberty/open-liberty/commit/a588bafb3a1e731046e1dc6b42f23b60adb31a23", "message": "update jsp 2.3 fat", "committedDate": "2020-04-16T18:44:04Z", "type": "forcePushed"}, {"oid": "8eb97fe93b67be7dd965078c069dcacd538adc17", "url": "https://github.com/OpenLiberty/open-liberty/commit/8eb97fe93b67be7dd965078c069dcacd538adc17", "message": "Add 'or' to @ExpectedFFDC", "committedDate": "2020-04-16T20:13:38Z", "type": "forcePushed"}, {"oid": "945fe6ccc7352aedd65ca5d8324221e6fdd051f9", "url": "https://github.com/OpenLiberty/open-liberty/commit/945fe6ccc7352aedd65ca5d8324221e6fdd051f9", "message": "JSP merge fixes", "committedDate": "2020-04-22T16:24:57Z", "type": "forcePushed"}, {"oid": "94351461e7091106718654929345c9af26498f6b", "url": "https://github.com/OpenLiberty/open-liberty/commit/94351461e7091106718654929345c9af26498f6b", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-04-28T15:54:25Z", "type": "forcePushed"}, {"oid": "b1a977fc96cbf38dd0eaf51d2f7314fb874a103f", "url": "https://github.com/OpenLiberty/open-liberty/commit/b1a977fc96cbf38dd0eaf51d2f7314fb874a103f", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-04-29T04:27:10Z", "type": "forcePushed"}, {"oid": "7a75790c11e6df1abde4880be3f1e7537396b1d3", "url": "https://github.com/OpenLiberty/open-liberty/commit/7a75790c11e6df1abde4880be3f1e7537396b1d3", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-04-29T04:46:03Z", "type": "forcePushed"}, {"oid": "d84e03e23caa0ad9cbf2451c8e7f043cafdc8816", "url": "https://github.com/OpenLiberty/open-liberty/commit/d84e03e23caa0ad9cbf2451c8e7f043cafdc8816", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-04-29T04:55:10Z", "type": "forcePushed"}, {"oid": "2e1f57102fd7c030ecdd0ceef526a890e6e85882", "url": "https://github.com/OpenLiberty/open-liberty/commit/2e1f57102fd7c030ecdd0ceef526a890e6e85882", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-04-29T05:00:05Z", "type": "forcePushed"}, {"oid": "527a6dfce10b0be28686e471292cbaf7c3e5bde9", "url": "https://github.com/OpenLiberty/open-liberty/commit/527a6dfce10b0be28686e471292cbaf7c3e5bde9", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-04-29T15:07:08Z", "type": "forcePushed"}, {"oid": "5bdf1bf5fe7474a0c25d3e2276f772d2f82d840f", "url": "https://github.com/OpenLiberty/open-liberty/commit/5bdf1bf5fe7474a0c25d3e2276f772d2f82d840f", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-05-06T21:32:17Z", "type": "forcePushed"}, {"oid": "b2ee7e3b976bb0169601624eea16abc84341f126", "url": "https://github.com/OpenLiberty/open-liberty/commit/b2ee7e3b976bb0169601624eea16abc84341f126", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-05-07T13:39:39Z", "type": "forcePushed"}, {"oid": "d84a225d3181588285b3b0c06eba039828764590", "url": "https://github.com/OpenLiberty/open-liberty/commit/d84a225d3181588285b3b0c06eba039828764590", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-05-07T15:08:02Z", "type": "forcePushed"}, {"oid": "9fcf3befb983390dbe69d4e46b9482de1af806bd", "url": "https://github.com/OpenLiberty/open-liberty/commit/9fcf3befb983390dbe69d4e46b9482de1af806bd", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-05-07T15:52:44Z", "type": "forcePushed"}, {"oid": "6804bcb578a02a5e9f65b8cb6895748bf287be00", "url": "https://github.com/OpenLiberty/open-liberty/commit/6804bcb578a02a5e9f65b8cb6895748bf287be00", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-05-07T16:11:18Z", "type": "forcePushed"}, {"oid": "2b64401c8015ac1561ce5a0d14904811b2a75b8d", "url": "https://github.com/OpenLiberty/open-liberty/commit/2b64401c8015ac1561ce5a0d14904811b2a75b8d", "message": "11825:  Add  Java 2  Security Check to  Jakarta EL", "committedDate": "2020-05-07T16:20:36Z", "type": "forcePushed"}, {"oid": "acab46d53bb1ffc4f17b271916848ef5b9ae432e", "url": "https://github.com/OpenLiberty/open-liberty/commit/acab46d53bb1ffc4f17b271916848ef5b9ae432e", "message": "11825:  Add  Java 2  Security Check to EL-4.0 API (Jakarta)", "committedDate": "2020-05-07T16:22:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY5MTExNA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11734#discussion_r421691114", "bodyText": "Why were these SkipForRepeat annotations removed in this class?", "author": "pnicolucci", "createdAt": "2020-05-07T18:00:11Z", "path": "dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java", "diffHunk": "@@ -336,9 +330,8 @@ private void nonReservedWordsHelperMethod(WebConversation wc, String path, Strin\n      *                       if something goes horribly wrong\n      */\n     @Test\n-    @SkipForRepeat(\"CDI-2.0\") // No need to run against cdi-2.0 since these tests don't use CDI at all.\n     public void testServlet() throws Exception {", "originalCommit": "acab46d53bb1ffc4f17b271916848ef5b9ae432e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTcxMzk2MA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11734#discussion_r421713960", "bodyText": "All of the tests within this class do not use CDI, so I removed SkipForRepeat(\"CDI-2.0\") from each method and added it to the class itself.", "author": "volosied", "createdAt": "2020-05-07T18:39:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY5MTExNA=="}], "type": "inlineReview", "revised_code": {"commit": "78cd2186cb4adb33788874b2755d51865755d8e5", "chunk": "diff --git a/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java b/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java\nindex d57133fe06..ca0be9e3bc 100644\n--- a/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java\n+++ b/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java\n\n@@ -330,8 +336,9 @@ public class JSPTests {\n      *                       if something goes horribly wrong\n      */\n     @Test\n+    @SkipForRepeat(\"CDI-2.0\") // No need to run against cdi-2.0 since these tests don't use CDI at all.\n     public void testServlet() throws Exception {\n-        this.verifyStringInResponse(TestEL_APP_NAME, \"SimpleTestServlet\", \"Hello World\");\n+        this.verifyStringInResponse(JSP23_APP_NAME, \"SimpleTestServlet\", \"Hello World\");\n     }\n \n     /**\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY5NTI1OQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11734#discussion_r421695259", "bodyText": "I'd suggest updating the copyright date range for this file. Looks like pretty significant functional changes.", "author": "pnicolucci", "createdAt": "2020-05-07T18:07:09Z", "path": "dev/fattest.simplicity/src/componenttest/custom/junit/runner/FATRunner.java", "diffHunk": "@@ -56,6 +56,7 @@\n import componenttest.exception.TopologyException;\n import componenttest.logging.ffdc.IgnoredFFDCs;\n import componenttest.logging.ffdc.IgnoredFFDCs.IgnoredFFDC;\n+import componenttest.rules.repeater.EE9PackageReplacementHelper;", "originalCommit": "acab46d53bb1ffc4f17b271916848ef5b9ae432e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTY5NTU5NQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11734#discussion_r421695595", "bodyText": "We need a copyright header on this new class", "author": "pnicolucci", "createdAt": "2020-05-07T18:07:46Z", "path": "dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java", "diffHunk": "@@ -0,0 +1,184 @@\n+package componenttest.rules.repeater;", "originalCommit": "acab46d53bb1ffc4f17b271916848ef5b9ae432e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0a9d8bbce2f2cef342467e9833154b6348f4386c", "chunk": "diff --git a/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java b/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\nindex d43a89280b..fd1e22bff7 100644\n--- a/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\n+++ b/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\n\n@@ -1,3 +1,13 @@\n+/*******************************************************************************\n+ * Copyright (c) 2020 IBM Corporation and others.\n+ * All rights reserved. This program and the accompanying materials\n+ * are made available under the terms of the Eclipse Public License v1.0\n+ * which accompanies this distribution, and is available at\n+ * http://www.eclipse.org/legal/epl-v10.html\n+ *\n+ * Contributors:\n+ *     IBM Corporation - initial API and implementation\n+ *******************************************************************************/\n package componenttest.rules.repeater;\n \n \n"}}, {"oid": "0a9d8bbce2f2cef342467e9833154b6348f4386c", "url": "https://github.com/OpenLiberty/open-liberty/commit/0a9d8bbce2f2cef342467e9833154b6348f4386c", "message": "Small Corrections", "committedDate": "2020-05-07T18:45:19Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjE4MTMyNQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/11734#discussion_r422181325", "bodyText": "Can we do anything with the transformer here so we don't need to remove the javax? In addition we should clean up the assert messages if we're changing what we're actually looking for.", "author": "pnicolucci", "createdAt": "2020-05-08T14:39:02Z", "path": "dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java", "diffHunk": "@@ -170,7 +168,7 @@ public void testEL30MethodNotFoundException() throws Exception {\n         assertEquals(\"Expected \" + 500 + \" status code was not returned!\",\n                      500, response.getResponseCode());\n \n-        assertTrue(\"The response did not contain: javax.el.MethodNotFoundException\", response.getText().contains(\"javax.el.MethodNotFoundException\"));\n+        assertTrue(\"The response did not contain: javax.el.MethodNotFoundException\", response.getText().contains(\"el.MethodNotFoundException\"));", "originalCommit": "0a9d8bbce2f2cef342467e9833154b6348f4386c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "78cd2186cb4adb33788874b2755d51865755d8e5", "chunk": "diff --git a/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java b/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java\nindex d57133fe06..ca0be9e3bc 100644\n--- a/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java\n+++ b/dev/com.ibm.ws.jsp.2.3_fat/fat/src/com/ibm/ws/jsp23/fat/tests/JSPTests.java\n\n@@ -168,7 +170,7 @@ public class JSPTests {\n         assertEquals(\"Expected \" + 500 + \" status code was not returned!\",\n                      500, response.getResponseCode());\n \n-        assertTrue(\"The response did not contain: javax.el.MethodNotFoundException\", response.getText().contains(\"el.MethodNotFoundException\"));\n+        assertTrue(\"The response did not contain: javax.el.MethodNotFoundException\", response.getText().contains(\"javax.el.MethodNotFoundException\"));\n     }\n \n     /**\n"}}, {"oid": "78cd2186cb4adb33788874b2755d51865755d8e5", "url": "https://github.com/OpenLiberty/open-liberty/commit/78cd2186cb4adb33788874b2755d51865755d8e5", "message": "11732: Amend FatRunner to automatically transform ExpectedFFDCs and AllowedFFDCs during EE9 run", "committedDate": "2020-05-08T16:41:34Z", "type": "commit"}, {"oid": "3052a2a51795d77fee307fe63f29521b289a47bf", "url": "https://github.com/OpenLiberty/open-liberty/commit/3052a2a51795d77fee307fe63f29521b289a47bf", "message": "11371: Reorganize JSP 2.3 Tests & Applications; Enable EE9 Repeat Tests", "committedDate": "2020-05-08T16:41:35Z", "type": "commit"}, {"oid": "7963397a389a87e9d8f0c7b6d9a2550638c425d6", "url": "https://github.com/OpenLiberty/open-liberty/commit/7963397a389a87e9d8f0c7b6d9a2550638c425d6", "message": "11825: Inital Drop -- Tomcat EL 4.0.0-M1 (Jakarta)", "committedDate": "2020-05-08T16:41:36Z", "type": "commit"}, {"oid": "7c244e963628d92e20ded1a48d0525215cbde511", "url": "https://github.com/OpenLiberty/open-liberty/commit/7c244e963628d92e20ded1a48d0525215cbde511", "message": "11825:  Add  Java 2  Security Check to EL-4.0 API (Jakarta)", "committedDate": "2020-05-08T16:41:37Z", "type": "commit"}, {"oid": "0efaac7cf35e9421f71edc3815c580ba3b8e7d1c", "url": "https://github.com/OpenLiberty/open-liberty/commit/0efaac7cf35e9421f71edc3815c580ba3b8e7d1c", "message": "Small Corrections", "committedDate": "2020-05-08T16:43:02Z", "type": "commit"}, {"oid": "30d9deff3f7b1e5534a6c33b0a3d42c104799a99", "url": "https://github.com/OpenLiberty/open-liberty/commit/30d9deff3f7b1e5534a6c33b0a3d42c104799a99", "message": "Adjust assert messages to check for jakarta/javax", "committedDate": "2020-05-08T16:43:02Z", "type": "commit"}, {"oid": "30d9deff3f7b1e5534a6c33b0a3d42c104799a99", "url": "https://github.com/OpenLiberty/open-liberty/commit/30d9deff3f7b1e5534a6c33b0a3d42c104799a99", "message": "Adjust assert messages to check for jakarta/javax", "committedDate": "2020-05-08T16:43:02Z", "type": "forcePushed"}]}