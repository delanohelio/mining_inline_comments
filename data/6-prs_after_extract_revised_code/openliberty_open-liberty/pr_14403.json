{"pr_number": 14403, "pr_title": "Fix Java warnings for com.ibm.ws.junit.extensions", "pr_createdAt": "2020-10-09T11:06:03Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/14403", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjUxMTIwMg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14403#discussion_r502511202", "bodyText": "The previous code swallowed any IOException from the close(); the changed code allows it to propagate.\nDid you intend to make this behaviour change ?", "author": "ngmr", "createdAt": "2020-10-09T15:31:16Z", "path": "dev/com.ibm.ws.junit.extensions/src/test/common/junit/runner/OSGiComplianceTestRunner.java", "diffHunk": "@@ -61,11 +61,6 @@ public void run(RunNotifier notifier) {\n                         numTests++;\n                     }\n                 }\n-            } finally {\n-                try {\n-                    reader.close();\n-                } catch (IOException e) {\n-                }\n             }", "originalCommit": "6c1a7249f2d59b939bd0b0f2348e84581eb541af", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjcxODgxOQ==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14403#discussion_r502718819", "bodyText": "No. Good spot \u2014 I will fix this.", "author": "joe-chacko", "createdAt": "2020-10-10T00:11:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjUxMTIwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjcxOTkwMw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/14403#discussion_r502719903", "bodyText": "Fixed", "author": "joe-chacko", "createdAt": "2020-10-10T00:18:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjUxMTIwMg=="}], "type": "inlineReview", "revised_code": {"commit": "cc3ec0fe6b122ea006a7519d72e4e2f5292903fa", "chunk": "diff --git a/dev/com.ibm.ws.junit.extensions/src/test/common/junit/runner/OSGiComplianceTestRunner.java b/dev/com.ibm.ws.junit.extensions/src/test/common/junit/runner/OSGiComplianceTestRunner.java\nindex f213c5bfbb..556c96fa39 100755\n--- a/dev/com.ibm.ws.junit.extensions/src/test/common/junit/runner/OSGiComplianceTestRunner.java\n+++ b/dev/com.ibm.ws.junit.extensions/src/test/common/junit/runner/OSGiComplianceTestRunner.java\n\n@@ -37,31 +37,27 @@ public class OSGiComplianceTestRunner extends Runner {\n     @Override\n     public void run(RunNotifier notifier) {\n         int numTests = 0;\n-        try {\n-            File consoleLog = new File(System.getProperty(\"console.log\"));\n-\n-            try (\n-                    FileInputStream fis = new FileInputStream(consoleLog);\n-                    InputStreamReader reader = new InputStreamReader(fis);\n-                    BufferedReader br = new BufferedReader(reader)) {\n-                Pattern pattern = Pattern.compile(\" (\\\\w+\\\\(.*\\\\)), fails=([0-9])\");\n-                for (String line; (line = br.readLine()) != null;) {\n-                    Matcher matcher = pattern.matcher(line);\n-                    if (matcher.find()) {\n-                        String testName = matcher.group(1);\n-                        String fails = matcher.group(2);\n+        try (BufferedReader br = new BufferedReader(new FileReader(System.getProperty(\"console.log\")))) {\n+            Pattern pattern = Pattern.compile(\" (\\\\w+\\\\(.*\\\\)), fails=([0-9])\");\n+            for (String line; (line = br.readLine()) != null;) {\n+                Matcher matcher = pattern.matcher(line);\n+                if (matcher.find()) {\n+                    String testName = matcher.group(1);\n+                    String fails = matcher.group(2);\n \n-                        Description desc = Description.createTestDescription(suite.getTestClass(), testName);\n-                        suite.addChild(desc);\n-                        notifier.fireTestStarted(desc);\n-                        if (!fails.equals(\"0\")) {\n-                            notifier.fireTestFailure(new Failure(desc, new AssertionError(line)));\n-                        }\n-                        notifier.fireTestFinished(desc);\n-                        numTests++;\n+                    Description desc = Description.createTestDescription(suite.getTestClass(), testName);\n+                    suite.addChild(desc);\n+                    notifier.fireTestStarted(desc);\n+                    if (!fails.equals(\"0\")) {\n+                        notifier.fireTestFailure(new Failure(desc, new AssertionError(line)));\n                     }\n+                    notifier.fireTestFinished(desc);\n+                    numTests++;\n                 }\n             }\n+            throw new ClosingException();    // throw, catch, and ignore\n+        } catch (ClosingException ignored) { // so exceptions thrown from close()\n+                                             // will all be suppressed\n         } catch (Throwable t) {\n             Description desc = Description.createTestDescription(suite.getTestClass(), \"run\");\n             notifier.fireTestStarted(desc);\n"}}, {"oid": "cc3ec0fe6b122ea006a7519d72e4e2f5292903fa", "url": "https://github.com/OpenLiberty/open-liberty/commit/cc3ec0fe6b122ea006a7519d72e4e2f5292903fa", "message": "Fix Java warnings in com.ibm.ws.junit.extensions", "committedDate": "2020-10-10T00:01:06Z", "type": "forcePushed"}, {"oid": "ed24c59324e4e2826cbf7fe38b4071af75f249e4", "url": "https://github.com/OpenLiberty/open-liberty/commit/ed24c59324e4e2826cbf7fe38b4071af75f249e4", "message": "Fix Java warnings in com.ibm.ws.junit.extensions", "committedDate": "2020-10-10T00:41:47Z", "type": "commit"}, {"oid": "ed24c59324e4e2826cbf7fe38b4071af75f249e4", "url": "https://github.com/OpenLiberty/open-liberty/commit/ed24c59324e4e2826cbf7fe38b4071af75f249e4", "message": "Fix Java warnings in com.ibm.ws.junit.extensions", "committedDate": "2020-10-10T00:41:47Z", "type": "forcePushed"}]}