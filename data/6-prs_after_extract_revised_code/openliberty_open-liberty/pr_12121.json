{"pr_number": 12121, "pr_title": "Improve FATRunner &  EE9 Package Replacment Helper", "pr_createdAt": "2020-05-11T14:26:35Z", "pr_url": "https://github.com/OpenLiberty/open-liberty/pull/12121", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExMjU5Mg==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12121#discussion_r423112592", "bodyText": "you can still keep this old constructor as an option for people, I was just suggesting adding a new ctor with 0-args", "author": "aguibert", "createdAt": "2020-05-11T15:12:25Z", "path": "dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java", "diffHunk": "@@ -35,7 +35,8 @@\n \n     private static final Logger Log = Logger.getLogger(EE9PackageReplacementHelper.class.getName());\n \n-    public EE9PackageReplacementHelper(String rulesPath){", "originalCommit": "f0052e2d6d39524845e1d3ab8826ad85cb9c0596", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzEyOTUxNw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12121#discussion_r423129517", "bodyText": "Added it back in.", "author": "volosied", "createdAt": "2020-05-11T15:35:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExMjU5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "ec746d394aae114867b8db1238e35e04ef748479", "chunk": "diff --git a/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java b/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\nindex b23006cc03..48e1ade86f 100644\n--- a/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\n+++ b/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\n\n@@ -35,6 +35,17 @@ public class EE9PackageReplacementHelper {\n \n     private static final Logger Log = Logger.getLogger(EE9PackageReplacementHelper.class.getName());\n \n+    public EE9PackageReplacementHelper(rulesPath){\n+        Properties appProps = new Properties();\n+        try {\n+            appProps.load(new FileInputStream(rulesPath));\n+            packageRenameRules = (Map) appProps;\n+        } catch (Exception e) {\n+            Log.warning(\"Error occured when reading in \" + rulesPath);\n+            e.printStackTrace();\n+        }\n+    }\n+\n     public EE9PackageReplacementHelper(){\n             String rulesPath = System.getProperty(\"user.dir\") + \"/autoFVT-templates/\" + \"jakarta-renames.properties\";\n             Properties appProps = new Properties();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzExNDY4OA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12121#discussion_r423114688", "bodyText": "We can't init quite this early, it implies that in order to run any FAT (whether or not an EE9 repeat is used) this properties file will need to be present. Instead, lets just lazy-init the field, but do so using the no-args ctor", "author": "aguibert", "createdAt": "2020-05-11T15:15:14Z", "path": "dev/fattest.simplicity/src/componenttest/custom/junit/runner/FATRunner.java", "diffHunk": "@@ -83,7 +84,7 @@\n                                                                       new JavaLevelFilter()\n     };\n \n-    private static EE9PackageReplacementHelper ee9Helper;\n+    private static EE9PackageReplacementHelper ee9Helper = new EE9PackageReplacementHelper();", "originalCommit": "f0052e2d6d39524845e1d3ab8826ad85cb9c0596", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ec746d394aae114867b8db1238e35e04ef748479", "chunk": "diff --git a/dev/fattest.simplicity/src/componenttest/custom/junit/runner/FATRunner.java b/dev/fattest.simplicity/src/componenttest/custom/junit/runner/FATRunner.java\nindex c560e48a97..193cdc5ed9 100644\n--- a/dev/fattest.simplicity/src/componenttest/custom/junit/runner/FATRunner.java\n+++ b/dev/fattest.simplicity/src/componenttest/custom/junit/runner/FATRunner.java\n\n@@ -84,7 +84,7 @@ public class FATRunner extends BlockJUnit4ClassRunner {\n                                                                       new JavaLevelFilter()\n     };\n \n-    private static EE9PackageReplacementHelper ee9Helper = new EE9PackageReplacementHelper();\n+    private static EE9PackageReplacementHelper ee9Helper;\n \n     private static final Set<String> classesUsingFATRunner = new HashSet<String>();\n \n"}}, {"oid": "ec746d394aae114867b8db1238e35e04ef748479", "url": "https://github.com/OpenLiberty/open-liberty/commit/ec746d394aae114867b8db1238e35e04ef748479", "message": "Improve FATRunner &  EE9 Package Helper", "committedDate": "2020-05-11T15:27:04Z", "type": "forcePushed"}, {"oid": "7a3f2ed87a7774b8c620eaa2d7ca15c5c7bb9ba0", "url": "https://github.com/OpenLiberty/open-liberty/commit/7a3f2ed87a7774b8c620eaa2d7ca15c5c7bb9ba0", "message": "Improve FATRunner &  EE9 Package Helper", "committedDate": "2020-05-11T19:16:59Z", "type": "forcePushed"}, {"oid": "dde6ec7348bce7cd135f5e7e73359df089819ae3", "url": "https://github.com/OpenLiberty/open-liberty/commit/dde6ec7348bce7cd135f5e7e73359df089819ae3", "message": "Improve FATRunner &  EE9 Package Helper", "committedDate": "2020-05-12T13:32:03Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyMjE2Mw==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12121#discussion_r424822163", "bodyText": "since the code here is common with the other constructor, you can just do:\npublic EE9PackageReplacementHelper() {\n  this(System.getProperty(\"user.dir\") + \"/autoFVT-templates/\" + \"jakarta-renames.properties\");\n}", "author": "aguibert", "createdAt": "2020-05-14T01:34:29Z", "path": "dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java", "diffHunk": "@@ -35,7 +35,19 @@\n \n     private static final Logger Log = Logger.getLogger(EE9PackageReplacementHelper.class.getName());\n \n-    public EE9PackageReplacementHelper(String rulesPath){\n+    public EE9PackageReplacementHelper(String rulesPath) {\n+        Properties appProps = new Properties();\n+        try {\n+            appProps.load(new FileInputStream(rulesPath));\n+            packageRenameRules = (Map) appProps;\n+        } catch (Exception e) {\n+            Log.warning(\"Error occured when reading in \" + rulesPath);\n+            e.printStackTrace();\n+        }\n+    }\n+\n+    public EE9PackageReplacementHelper() {\n+            String rulesPath = System.getProperty(\"user.dir\") + \"/autoFVT-templates/\" + \"jakarta-renames.properties\";", "originalCommit": "dde6ec7348bce7cd135f5e7e73359df089819ae3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTE1MDM2NA==", "url": "https://github.com/OpenLiberty/open-liberty/pull/12121#discussion_r425150364", "bodyText": "Fixed, Thank you :)", "author": "volosied", "createdAt": "2020-05-14T13:47:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDgyMjE2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "9939b52a185bbee2ceb1fbfd34c70717b877fbd3", "chunk": "diff --git a/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java b/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\nindex 834fdbe14d..aa6c107a31 100644\n--- a/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\n+++ b/dev/fattest.simplicity/src/componenttest/rules/repeater/EE9PackageReplacementHelper.java\n\n@@ -47,15 +47,7 @@ public class EE9PackageReplacementHelper {\n     }\n \n     public EE9PackageReplacementHelper() {\n-            String rulesPath = System.getProperty(\"user.dir\") + \"/autoFVT-templates/\" + \"jakarta-renames.properties\";\n-            Properties appProps = new Properties();\n-            try {\n-                appProps.load(new FileInputStream(rulesPath));\n-                packageRenameRules = (Map) appProps;\n-            } catch (Exception e) {\n-                Log.warning(\"Error occured when reading in \" + rulesPath);\n-                e.printStackTrace();\n-            }\n+            this(System.getProperty(\"user.dir\") + \"/autoFVT-templates/\" + \"jakarta-renames.properties\");\n     }\n     \n     public String replacePackages(String text) {\n"}}, {"oid": "9939b52a185bbee2ceb1fbfd34c70717b877fbd3", "url": "https://github.com/OpenLiberty/open-liberty/commit/9939b52a185bbee2ceb1fbfd34c70717b877fbd3", "message": "Improve FATRunner &  EE9 Package Helper", "committedDate": "2020-05-14T13:46:08Z", "type": "commit"}, {"oid": "9939b52a185bbee2ceb1fbfd34c70717b877fbd3", "url": "https://github.com/OpenLiberty/open-liberty/commit/9939b52a185bbee2ceb1fbfd34c70717b877fbd3", "message": "Improve FATRunner &  EE9 Package Helper", "committedDate": "2020-05-14T13:46:08Z", "type": "forcePushed"}]}