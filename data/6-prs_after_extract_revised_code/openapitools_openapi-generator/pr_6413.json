{"pr_number": 6413, "pr_title": "[java-jersey2] Conditionally include http signature mustache template", "pr_createdAt": "2020-05-23T18:59:33Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/6413", "timeline": [{"oid": "41e97e6d2bd817c39e0ce6593acea8b9b290ddd6", "url": "https://github.com/OpenAPITools/openapi-generator/commit/41e97e6d2bd817c39e0ce6593acea8b9b290ddd6", "message": "Mustache template should use invokerPackage tag to generate import", "committedDate": "2020-05-13T01:57:25Z", "type": "commit"}, {"oid": "1760f6a2af3b67a1cd35d3c92fad53671c44caf2", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1760f6a2af3b67a1cd35d3c92fad53671c44caf2", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-13T13:28:59Z", "type": "commit"}, {"oid": "3ae466e772a3277d19b0d213719935155724aab8", "url": "https://github.com/OpenAPITools/openapi-generator/commit/3ae466e772a3277d19b0d213719935155724aab8", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-13T16:15:21Z", "type": "commit"}, {"oid": "b628667b1f63d7102e4cf929778053b718aa42d4", "url": "https://github.com/OpenAPITools/openapi-generator/commit/b628667b1f63d7102e4cf929778053b718aa42d4", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-13T16:44:21Z", "type": "commit"}, {"oid": "4dc915c5972e95473c4733503e8f7d790b0e3556", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4dc915c5972e95473c4733503e8f7d790b0e3556", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-14T14:37:49Z", "type": "commit"}, {"oid": "7a207f674a8cceebb74a47b8c8474781467b6572", "url": "https://github.com/OpenAPITools/openapi-generator/commit/7a207f674a8cceebb74a47b8c8474781467b6572", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-16T04:29:37Z", "type": "commit"}, {"oid": "776fba674a32e37709670a94a5a390f75c6d1e1a", "url": "https://github.com/OpenAPITools/openapi-generator/commit/776fba674a32e37709670a94a5a390f75c6d1e1a", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-18T16:11:47Z", "type": "commit"}, {"oid": "3fac4347d19f6e1d80083487a5ec69dd4358428e", "url": "https://github.com/OpenAPITools/openapi-generator/commit/3fac4347d19f6e1d80083487a5ec69dd4358428e", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-19T15:25:28Z", "type": "commit"}, {"oid": "a96c46b93f34b825763df703150c3611ddd5b625", "url": "https://github.com/OpenAPITools/openapi-generator/commit/a96c46b93f34b825763df703150c3611ddd5b625", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-20T13:30:30Z", "type": "commit"}, {"oid": "1351fd0e9234e995a34eb3fc624b245d025d248e", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1351fd0e9234e995a34eb3fc624b245d025d248e", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-21T15:20:54Z", "type": "commit"}, {"oid": "ba6573568266660188c8e176f1cdf4aaaf376b14", "url": "https://github.com/OpenAPITools/openapi-generator/commit/ba6573568266660188c8e176f1cdf4aaaf376b14", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-22T02:19:22Z", "type": "commit"}, {"oid": "9a0b89e18566266efb3b9d6373fc443008eb8514", "url": "https://github.com/OpenAPITools/openapi-generator/commit/9a0b89e18566266efb3b9d6373fc443008eb8514", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-22T16:01:59Z", "type": "commit"}, {"oid": "4c84190ef4387be4d823bd89890127b4870c453a", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4c84190ef4387be4d823bd89890127b4870c453a", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-22T17:17:14Z", "type": "commit"}, {"oid": "94ae68328b8b05a4d67f99520466f4a3ab08d091", "url": "https://github.com/OpenAPITools/openapi-generator/commit/94ae68328b8b05a4d67f99520466f4a3ab08d091", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-22T23:24:57Z", "type": "commit"}, {"oid": "aac9f5a45496cee2f092fcbbec1378a479451e9d", "url": "https://github.com/OpenAPITools/openapi-generator/commit/aac9f5a45496cee2f092fcbbec1378a479451e9d", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-23T01:16:38Z", "type": "commit"}, {"oid": "93baa3deb70eacd53335c94970b6f0ebcb3ad4ba", "url": "https://github.com/OpenAPITools/openapi-generator/commit/93baa3deb70eacd53335c94970b6f0ebcb3ad4ba", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-23T02:37:32Z", "type": "commit"}, {"oid": "5c313b4934037fb39067fe3f4cee27d6eb4ffae4", "url": "https://github.com/OpenAPITools/openapi-generator/commit/5c313b4934037fb39067fe3f4cee27d6eb4ffae4", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-23T14:49:07Z", "type": "commit"}, {"oid": "cda8898cc87009a86e6e3a6cc0ab6a22236142b5", "url": "https://github.com/OpenAPITools/openapi-generator/commit/cda8898cc87009a86e6e3a6cc0ab6a22236142b5", "message": "Merge branch 'master' of https://github.com/OpenAPITools/openapi-generator", "committedDate": "2020-05-23T16:14:20Z", "type": "commit"}, {"oid": "da6744ad3f3211ce1d65844db140a59187965373", "url": "https://github.com/OpenAPITools/openapi-generator/commit/da6744ad3f3211ce1d65844db140a59187965373", "message": "Conditionally include HttpSignatureAuth.mustache template", "committedDate": "2020-05-23T18:57:24Z", "type": "commit"}, {"oid": "c5e6f2d3d8a61c029a688592317921a187f8a7cc", "url": "https://github.com/OpenAPITools/openapi-generator/commit/c5e6f2d3d8a61c029a688592317921a187f8a7cc", "message": "Conditionally include HttpSignatureAuth.mustache template", "committedDate": "2020-05-23T19:11:48Z", "type": "commit"}, {"oid": "9c8f970ec6616f435d9dd86b329150935a534c03", "url": "https://github.com/OpenAPITools/openapi-generator/commit/9c8f970ec6616f435d9dd86b329150935a534c03", "message": "Conditionally include HttpSignatureAuth.mustache template", "committedDate": "2020-05-23T20:21:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3NTQ3OA==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6413#discussion_r429575478", "bodyText": "What about using ProcessUtils.hasHttpSignatureMethods(openAPI) instead and remove line 384 to 386?", "author": "wing328", "createdAt": "2020-05-23T20:22:02Z", "path": "modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/JavaClientCodegen.java", "diffHunk": "@@ -380,7 +381,12 @@ public void processOpts() {\n         } else if (JERSEY2.equals(getLibrary())) {\n             supportingFiles.add(new SupportingFile(\"JSON.mustache\", invokerFolder, \"JSON.java\"));\n             supportingFiles.add(new SupportingFile(\"ApiResponse.mustache\", invokerFolder, \"ApiResponse.java\"));\n-            supportingFiles.add(new SupportingFile(\"auth/HttpSignatureAuth.mustache\", authFolder, \"HttpSignatureAuth.java\"));\n+            Map<String, SecurityScheme> securitySchemeMap = openAPI != null ?\n+                    (openAPI.getComponents() != null ? openAPI.getComponents().getSecuritySchemes() : null) : null;\n+            List<CodegenSecurity> authMethods = fromSecurity(securitySchemeMap);\n+            if (ProcessUtils.hasHttpSignatureMethods(authMethods)) {", "originalCommit": "c5e6f2d3d8a61c029a688592317921a187f8a7cc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3NTgyMQ==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/6413#discussion_r429575821", "bodyText": "done.", "author": "sebastien-rosset", "createdAt": "2020-05-23T20:27:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3NTQ3OA=="}], "type": "inlineReview", "revised_code": {"commit": "80fcf07e2f1c99b90efc3019eeb750c990c99ed1", "chunk": "diff --git a/modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/JavaClientCodegen.java b/modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/JavaClientCodegen.java\nindex 858885958e9..b7d84d43466 100644\n--- a/modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/JavaClientCodegen.java\n+++ b/modules/openapi-generator/src/main/java/org/openapitools/codegen/languages/JavaClientCodegen.java\n\n@@ -381,10 +380,7 @@ public class JavaClientCodegen extends AbstractJavaCodegen\n         } else if (JERSEY2.equals(getLibrary())) {\n             supportingFiles.add(new SupportingFile(\"JSON.mustache\", invokerFolder, \"JSON.java\"));\n             supportingFiles.add(new SupportingFile(\"ApiResponse.mustache\", invokerFolder, \"ApiResponse.java\"));\n-            Map<String, SecurityScheme> securitySchemeMap = openAPI != null ?\n-                    (openAPI.getComponents() != null ? openAPI.getComponents().getSecuritySchemes() : null) : null;\n-            List<CodegenSecurity> authMethods = fromSecurity(securitySchemeMap);\n-            if (ProcessUtils.hasHttpSignatureMethods(authMethods)) {\n+            if (ProcessUtils.hasHttpSignatureMethods(openAPI)) {\n                 supportingFiles.add(new SupportingFile(\"auth/HttpSignatureAuth.mustache\", authFolder, \"HttpSignatureAuth.java\"));\n             }\n             supportingFiles.add(new SupportingFile(\"AbstractOpenApiSchema.mustache\", (sourceFolder + File.separator + modelPackage().replace('.', File.separatorChar)).replace('/', File.separatorChar), \"AbstractOpenApiSchema.java\"));\n"}}, {"oid": "80fcf07e2f1c99b90efc3019eeb750c990c99ed1", "url": "https://github.com/OpenAPITools/openapi-generator/commit/80fcf07e2f1c99b90efc3019eeb750c990c99ed1", "message": "Conditionally include HttpSignatureAuth.mustache template", "committedDate": "2020-05-23T20:27:16Z", "type": "commit"}]}