{"pr_number": 5788, "pr_title": "[Java] Generate valid code if no Authentication implementations present", "pr_createdAt": "2020-04-01T16:14:39Z", "pr_url": "https://github.com/OpenAPITools/openapi-generator/pull/5788", "timeline": [{"oid": "824fa0a01981a3d5eb9666d40ba0485f56e0699d", "url": "https://github.com/OpenAPITools/openapi-generator/commit/824fa0a01981a3d5eb9666d40ba0485f56e0699d", "message": "generate valid code if no Authentication implementations present\n\nresurrects https://github.com/OpenAPITools/openapi-generator/pull/2861", "committedDate": "2020-04-01T16:12:39Z", "type": "commit"}, {"oid": "31c81cb01295823e5ebf2380bd20491b85915de4", "url": "https://github.com/OpenAPITools/openapi-generator/commit/31c81cb01295823e5ebf2380bd20491b85915de4", "message": "remove what I assume are human generated test cases", "committedDate": "2020-04-02T08:31:59Z", "type": "commit"}, {"oid": "6e6247e0fe237a52d6acdbf55303795abf1189b6", "url": "https://github.com/OpenAPITools/openapi-generator/commit/6e6247e0fe237a52d6acdbf55303795abf1189b6", "message": "need to iterate over authMethods in order to pull out name", "committedDate": "2020-04-02T14:55:11Z", "type": "commit"}, {"oid": "1278ab788f8bdf3d6b6f4589911cc75c72a881a4", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1278ab788f8bdf3d6b6f4589911cc75c72a881a4", "message": "fix another test", "committedDate": "2020-04-02T19:48:31Z", "type": "commit"}, {"oid": "190612b0e3bdf1cd27292a5322ab7959a9c2c76f", "url": "https://github.com/OpenAPITools/openapi-generator/commit/190612b0e3bdf1cd27292a5322ab7959a9c2c76f", "message": "Merge remote-tracking branch 'upstream/master' into hasBasicAuthMethods-hasTokenAuthMethods", "committedDate": "2020-04-09T15:57:05Z", "type": "commit"}, {"oid": "bf4a320200fff7b400dfefe94fc25cce6f267117", "url": "https://github.com/OpenAPITools/openapi-generator/commit/bf4a320200fff7b400dfefe94fc25cce6f267117", "message": "update more tests", "committedDate": "2020-04-09T20:09:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM1NDM1Nw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5788#discussion_r412354357", "bodyText": "why does auths.get(\"api_key\") return null?\nI remember some endpoints in the petstore spec are defined to use \"api_key\" for authentication", "author": "wing328", "createdAt": "2020-04-21T17:33:57Z", "path": "CI/samples.ci/client/petstore/java/test-manual/jersey1/ApiClientTest.java", "diffHunk": "@@ -102,14 +102,9 @@ public void testSelectHeaderContentType() {\n     public void testGetAuthentications() {\n         Map<String, Authentication> auths = apiClient.getAuthentications();\n \n-        Authentication auth = auths.get(\"api_key\");\n-        assertNotNull(auth);\n-        assertTrue(auth instanceof ApiKeyAuth);\n-        ApiKeyAuth apiKeyAuth = (ApiKeyAuth) auth;\n-        assertEquals(\"header\", apiKeyAuth.getLocation());\n-        assertEquals(\"api_key\", apiKeyAuth.getParamName());\n-\n-        auth = auths.get(\"petstore_auth\");\n+        assertNull(auths.get(\"api_key\"));", "originalCommit": "bf4a320200fff7b400dfefe94fc25cce6f267117", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjg2MzY5Nw==", "url": "https://github.com/OpenAPITools/openapi-generator/pull/5788#discussion_r412863697", "bodyText": "As per #2861 (comment) we now have hasTokenAuthMethods in DefaultGenerator which controls whether an ApiKeyAuth is registered in the authentications map.  Sounds like you're saying that is not working - any idea why not?", "author": "jonfreedman", "createdAt": "2020-04-22T10:28:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjM1NDM1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "779058f1113880b7b537c3672052803340ebcaf3", "chunk": "diff --git a/CI/samples.ci/client/petstore/java/test-manual/jersey1/ApiClientTest.java b/CI/samples.ci/client/petstore/java/test-manual/jersey1/ApiClientTest.java\nindex 7d89489e347..d0b07c35b54 100644\n--- a/CI/samples.ci/client/petstore/java/test-manual/jersey1/ApiClientTest.java\n+++ b/CI/samples.ci/client/petstore/java/test-manual/jersey1/ApiClientTest.java\n\n@@ -102,9 +102,16 @@ public class ApiClientTest {\n     public void testGetAuthentications() {\n         Map<String, Authentication> auths = apiClient.getAuthentications();\n \n-        assertNull(auths.get(\"api_key\"));\n+        Authentication auth = auths.get(\"api_key\");\n+        assertNotNull(auth);\n+        assertTrue(auth instanceof ApiKeyAuth);\n+        ApiKeyAuth apiKeyAuth = (ApiKeyAuth) auth;\n+        assertEquals(\"header\", apiKeyAuth.getLocation());\n+        assertEquals(\"api_key\", apiKeyAuth.getParamName());\n \n-        Authentication auth = auths.get(\"petstore_auth\");\n+        auth = auths.get(\"petstore_auth\");\n+\n+        auth = auths.get(\"petstore_auth\");\n         assertTrue(auth instanceof OAuth);\n         assertSame(auth, apiClient.getAuthentication(\"petstore_auth\"));\n \n"}}, {"oid": "f40f596f4fd526bd2c5407dea026f704e2769e4c", "url": "https://github.com/OpenAPITools/openapi-generator/commit/f40f596f4fd526bd2c5407dea026f704e2769e4c", "message": "rename hasTokenAuthMethods to hasApiKeyAuthMethods", "committedDate": "2020-04-27T20:14:12Z", "type": "commit"}, {"oid": "1c68d7f3bd851b33fce8abd3a21731e7da0ee834", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1c68d7f3bd851b33fce8abd3a21731e7da0ee834", "message": "Merge remote-tracking branch 'upstream/master' into hasBasicAuthMethods-hasTokenAuthMethods\n\n# Conflicts:\n#\tmodules/openapi-generator/src/main/java/org/openapitools/codegen/DefaultGenerator.java\n#\tmodules/openapi-generator/src/main/java/org/openapitools/codegen/languages/JavaClientCodegen.java\n#\tmodules/openapi-generator/src/main/java/org/openapitools/codegen/utils/ProcessUtils.java\n#\tmodules/openapi-generator/src/test/java/org/openapitools/codegen/java/JavaClientCodegenTest.java\n#\tsamples/client/petstore/java/jersey2/src/test/java/org/openapitools/client/ApiClientTest.java", "committedDate": "2020-05-22T14:28:33Z", "type": "commit"}, {"oid": "d32cfc0f655053830416c6701e60ae6a6f502216", "url": "https://github.com/OpenAPITools/openapi-generator/commit/d32cfc0f655053830416c6701e60ae6a6f502216", "message": "remove duplicate methods, fix hasHttpBearerMethods check", "committedDate": "2020-05-22T14:43:24Z", "type": "commit"}, {"oid": "a53f0d31d7df0aebfe41cbb08b8cf17a89122d47", "url": "https://github.com/OpenAPITools/openapi-generator/commit/a53f0d31d7df0aebfe41cbb08b8cf17a89122d47", "message": "update templates", "committedDate": "2020-05-22T15:09:48Z", "type": "commit"}, {"oid": "4fcbfad404e2f24f31b93bb64769920b0775a7d4", "url": "https://github.com/OpenAPITools/openapi-generator/commit/4fcbfad404e2f24f31b93bb64769920b0775a7d4", "message": "update windows java-petstore files", "committedDate": "2020-05-22T15:16:03Z", "type": "commit"}, {"oid": "901eb73806b95ed411a16a60cdf6a7e20d88982e", "url": "https://github.com/OpenAPITools/openapi-generator/commit/901eb73806b95ed411a16a60cdf6a7e20d88982e", "message": "update windows java-petstore files", "committedDate": "2020-05-22T15:19:44Z", "type": "commit"}, {"oid": "1947138fa7c0a3a781cf69abfd4f337891a985d8", "url": "https://github.com/OpenAPITools/openapi-generator/commit/1947138fa7c0a3a781cf69abfd4f337891a985d8", "message": "re-generate", "committedDate": "2020-05-22T15:29:15Z", "type": "commit"}, {"oid": "e59deb21a7d589f18f74c8076d7093f4ed311ca0", "url": "https://github.com/OpenAPITools/openapi-generator/commit/e59deb21a7d589f18f74c8076d7093f4ed311ca0", "message": "re-generate", "committedDate": "2020-05-22T15:43:20Z", "type": "commit"}, {"oid": "779058f1113880b7b537c3672052803340ebcaf3", "url": "https://github.com/OpenAPITools/openapi-generator/commit/779058f1113880b7b537c3672052803340ebcaf3", "message": "restore samples.ci tests", "committedDate": "2020-05-22T15:46:37Z", "type": "commit"}, {"oid": "594335ed42f7505afa743414e3c46faef022c126", "url": "https://github.com/OpenAPITools/openapi-generator/commit/594335ed42f7505afa743414e3c46faef022c126", "message": "restore samples.ci tests", "committedDate": "2020-05-22T15:47:45Z", "type": "commit"}]}