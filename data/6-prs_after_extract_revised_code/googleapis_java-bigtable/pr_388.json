{"pr_number": 388, "pr_title": "chore(fix): directpath ipv4 connection should not fail for an ipv6-enabled test client", "pr_createdAt": "2020-08-16T21:53:29Z", "pr_url": "https://github.com/googleapis/java-bigtable/pull/388", "timeline": [{"oid": "6e62b48346119e527f18a038356d4b3f65adec33", "url": "https://github.com/googleapis/java-bigtable/commit/6e62b48346119e527f18a038356d4b3f65adec33", "message": "chore(fix): directpath ipv4 connection should not fail for an ipv6-enabled test client", "committedDate": "2020-08-17T20:50:29Z", "type": "commit"}, {"oid": "6e62b48346119e527f18a038356d4b3f65adec33", "url": "https://github.com/googleapis/java-bigtable/commit/6e62b48346119e527f18a038356d4b3f65adec33", "message": "chore(fix): directpath ipv4 connection should not fail for an ipv6-enabled test client", "committedDate": "2020-08-17T20:50:29Z", "type": "forcePushed"}, {"oid": "5525a1be2b532d884dd9b82895d079b487430e7d", "url": "https://github.com/googleapis/java-bigtable/commit/5525a1be2b532d884dd9b82895d079b487430e7d", "message": "rename bigtable-directpath-ipv4-it profile to bigtable-directpath-ipv4only-it", "committedDate": "2020-08-24T18:37:39Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTgyMTY5OQ==", "url": "https://github.com/googleapis/java-bigtable/pull/388#discussion_r475821699", "bodyText": "isDirectPathIpv4Only()", "author": "igorbernstein2", "createdAt": "2020-08-24T18:45:01Z", "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java", "diffHunk": "@@ -241,7 +241,8 @@ private boolean verifyRemoteAddress(SocketAddress remoteAddr) {\n       if (isDirectPathIpv4()) {", "originalCommit": "5525a1be2b532d884dd9b82895d079b487430e7d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a0d22f7edf9941f305cae90e31df3fac356054ab", "chunk": "diff --git a/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java b/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java\nindex ff49db01..faee8287 100644\n--- a/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java\n+++ b/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java\n\n@@ -238,7 +238,7 @@ class CloudEnv extends AbstractTestEnv {\n     if (remoteAddr instanceof InetSocketAddress) {\n       InetAddress inetAddress = ((InetSocketAddress) remoteAddr).getAddress();\n       String addr = inetAddress.getHostAddress();\n-      if (isDirectPathIpv4()) {\n+      if (isDirectPathIpv4Only()) {\n         return addr.startsWith(DP_IPV4_PREFIX);\n       } else {\n         // For an ipv6-enabled VM, client could connect to either ipv4 or ipv6 balancer addresses.\n"}}, {"oid": "a0d22f7edf9941f305cae90e31df3fac356054ab", "url": "https://github.com/googleapis/java-bigtable/commit/a0d22f7edf9941f305cae90e31df3fac356054ab", "message": "fix sys prop & method naming", "committedDate": "2020-08-24T18:51:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTgyNjQxOA==", "url": "https://github.com/googleapis/java-bigtable/pull/388#discussion_r475826418", "bodyText": "last nit: please fix the error message", "author": "igorbernstein2", "createdAt": "2020-08-24T18:53:48Z", "path": "google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java", "diffHunk": "@@ -222,7 +222,7 @@ public void onHeaders(Metadata headers) {\n                                   + \" to the test environment's requirement for DirectPath.\"\n                                   + \" Expected test to access DirectPath via %s,\"\n                                   + \" but RPC was destined for %s\",\n-                              isDirectPathIpv4() ? \"ipv4\" : \"ipv6\", remoteAddr.toString()));\n+                              isDirectPathIpv4Only() ? \"ipv4\" : \"ipv6\", remoteAddr.toString()));", "originalCommit": "a0d22f7edf9941f305cae90e31df3fac356054ab", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "af3b11a371996fcab094db1c87fe0830d6ed61b1", "chunk": "diff --git a/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java b/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java\nindex faee8287..cee19b29 100644\n--- a/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java\n+++ b/google-cloud-bigtable/src/test/java/com/google/cloud/bigtable/test_helpers/env/CloudEnv.java\n\n@@ -222,7 +222,8 @@ class CloudEnv extends AbstractTestEnv {\n                                   + \" to the test environment's requirement for DirectPath.\"\n                                   + \" Expected test to access DirectPath via %s,\"\n                                   + \" but RPC was destined for %s\",\n-                              isDirectPathIpv4Only() ? \"ipv4\" : \"ipv6\", remoteAddr.toString()));\n+                              isDirectPathIpv4Only() ? \"ipv4 only\" : \"ipv4 or ipv6\",\n+                              remoteAddr.toString()));\n                     }\n                     super.onHeaders(headers);\n                   }\n"}}, {"oid": "af3b11a371996fcab094db1c87fe0830d6ed61b1", "url": "https://github.com/googleapis/java-bigtable/commit/af3b11a371996fcab094db1c87fe0830d6ed61b1", "message": "fix err msg", "committedDate": "2020-08-24T18:57:46Z", "type": "commit"}]}