{"pr_number": 12051, "pr_title": "(CDAP-16369) Collections of provisioner improvement", "pr_createdAt": "2020-04-12T01:27:26Z", "pr_url": "https://github.com/cdapio/cdap/pull/12051", "timeline": [{"oid": "811685d0232dd9a239d2f943eb1126202f0a5122", "url": "https://github.com/cdapio/cdap/commit/811685d0232dd9a239d2f943eb1126202f0a5122", "message": "(CDAP-16369) Make provisioner executor size configurable\n\n- This is a small bug fix\n- ScheduledExecutor size shouldn't be 0", "committedDate": "2020-04-12T01:21:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEzMzg3NQ==", "url": "https://github.com/cdapio/cdap/pull/12051#discussion_r407133875", "bodyText": "For deprecated methods, we usually add the release number from which the method/class is deprecated.\n\n  \n    \n      cdap/cdap-app-templates/cdap-etl/cdap-etl-api/src/main/java/io/cdap/cdap/etl/api/validation/InvalidConfigPropertyException.java\n    \n    \n         Line 23\n      in\n      1d62163\n    \n    \n    \n    \n\n        \n          \n            * Deprecated since 6.1.0. Use {@link ValidationFailure} instead.", "author": "CuriousVini", "createdAt": "2020-04-12T02:03:37Z", "path": "cdap-runtime-spi/src/main/java/io/cdap/cdap/runtime/spi/provisioner/ProgramRun.java", "diffHunk": "@@ -16,11 +16,16 @@\n \n package io.cdap.cdap.runtime.spi.provisioner;\n \n+import io.cdap.cdap.runtime.spi.ProgramRunInfo;\n+\n import java.util.Objects;\n \n /**\n  * A program run.\n+ *\n+ * @deprecated Use {@link ProgramRunInfo} instead", "originalCommit": "052214bc6fea62d7c1374819a112ecd6f79f7ebf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzE0MjQ4Nw==", "url": "https://github.com/cdapio/cdap/pull/12051#discussion_r407142487", "bodyText": "fixed", "author": "chtyim", "createdAt": "2020-04-12T04:03:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzEzMzg3NQ=="}], "type": "inlineReview", "revised_code": {"commit": "ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "chunk": "diff --git a/cdap-runtime-spi/src/main/java/io/cdap/cdap/runtime/spi/provisioner/ProgramRun.java b/cdap-runtime-spi/src/main/java/io/cdap/cdap/runtime/spi/provisioner/ProgramRun.java\nindex de74397a35b..2857bc4c6e5 100644\n--- a/cdap-runtime-spi/src/main/java/io/cdap/cdap/runtime/spi/provisioner/ProgramRun.java\n+++ b/cdap-runtime-spi/src/main/java/io/cdap/cdap/runtime/spi/provisioner/ProgramRun.java\n\n@@ -23,7 +23,7 @@ import java.util.Objects;\n /**\n  * A program run.\n  *\n- * @deprecated Use {@link ProgramRunInfo} instead\n+ * @deprecated Since 6.2.0. Use {@link ProgramRunInfo} instead.\n  */\n @Deprecated\n public class ProgramRun {\n"}}, {"oid": "ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "url": "https://github.com/cdapio/cdap/commit/ea99985c4f4c775e83f029c3b67dc0f8575c6f94", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic", "committedDate": "2020-04-12T04:03:16Z", "type": "forcePushed"}, {"oid": "8825d406bd24d8b4256a9962d6d336178829e1f1", "url": "https://github.com/cdapio/cdap/commit/8825d406bd24d8b4256a9962d6d336178829e1f1", "message": "(CDAP-16369) Deprecate ProgramRun in favor of ProgramRunInfo\n\n- The ProgramRunInfo is a super set of ProgramRun", "committedDate": "2020-04-12T05:18:17Z", "type": "commit"}, {"oid": "6fb4da5b18fd482bc58fa30a15a26036f35ee155", "url": "https://github.com/cdapio/cdap/commit/6fb4da5b18fd482bc58fa30a15a26036f35ee155", "message": "(CDAP-16369) Expose LocationFactory to ProvisionerContext\n\n- This allows provisioner to have access to locations as used by CDAP", "committedDate": "2020-04-12T05:18:17Z", "type": "commit"}, {"oid": "e393765a2dffae9f4007f2f634ae32bc0a095ef2", "url": "https://github.com/cdapio/cdap/commit/e393765a2dffae9f4007f2f634ae32bc0a095ef2", "message": "(CDAP-16369) Improve and fix Dataproc job files upload\n\n- Enhance the file upload logic to use LocationFactory from CDAP\n-- This automatically enables the local caching in distributed mode\n- Fix the bucket name settings in Dataproc provisioner such that it works with or without gs:// prefix", "committedDate": "2020-04-12T05:18:18Z", "type": "commit"}, {"oid": "559ff7fcace02d31c8c501403ac4d057006eb695", "url": "https://github.com/cdapio/cdap/commit/559ff7fcace02d31c8c501403ac4d057006eb695", "message": "(CDAP-16369) Add isTerminated to RuntimJobStatus\n\n- This helps simplify logic on determining if a job is terminated or not", "committedDate": "2020-04-12T05:18:18Z", "type": "commit"}, {"oid": "348b579c316c4ff74dab6ea6d663be046ff85cad", "url": "https://github.com/cdapio/cdap/commit/348b579c316c4ff74dab6ea6d663be046ff85cad", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic", "committedDate": "2020-04-12T05:18:18Z", "type": "commit"}, {"oid": "348b579c316c4ff74dab6ea6d663be046ff85cad", "url": "https://github.com/cdapio/cdap/commit/348b579c316c4ff74dab6ea6d663be046ff85cad", "message": "(CDAP-16369) Enhance provisioner delete cluster to allow returning cluster status\n\n- The gives more control to the provision deletion implementation on the deletion state transition\n-- The deprovisioning can make sure jobs are completed before deleting the cluster\n-- It can relies on the state transition from the provisioning service to perform retry/polling logic", "committedDate": "2020-04-12T05:18:18Z", "type": "forcePushed"}]}