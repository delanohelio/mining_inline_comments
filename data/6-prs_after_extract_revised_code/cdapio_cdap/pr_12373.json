{"pr_number": 12373, "pr_title": "[CDAP 16835] Use Primitive type wrapper instead of primitive types in Configs", "pr_createdAt": "2020-06-18T04:24:24Z", "pr_url": "https://github.com/cdapio/cdap/pull/12373", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk3NDI1Ng==", "url": "https://github.com/cdapio/cdap/pull/12373#discussion_r441974256", "bodyText": "Are the values passing to the constructor allowed to be nullable? If not, you can keep using primitive type here and only change the field type to allow null values during deserialization.", "author": "chtyim", "createdAt": "2020-06-18T05:21:07Z", "path": "cdap-app-templates/cdap-etl/cdap-etl-proto/src/main/java/io/cdap/cdap/etl/proto/v2/ETLConfig.java", "diffHunk": "@@ -61,8 +61,8 @@\n \n   protected ETLConfig(Set<ETLStage> stages, Set<Connection> connections,\n                       Resources resources, Resources driverResources, Resources clientResources,\n-                      boolean stageLoggingEnabled, boolean processTimingEnabled,\n-                      int numOfRecordsPreview, Map<String, String> properties) {\n+                      Boolean stageLoggingEnabled, Boolean processTimingEnabled,", "originalCommit": "13feda8cde8543b6c6a6713a8a64a5db48858c4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk4OTU1Nw==", "url": "https://github.com/cdapio/cdap/pull/12373#discussion_r441989557", "bodyText": "when the constructor is called by the upgrade code, can pass in these values using the getters (which check for null and return the default if so) instead of passing in the variables directly.", "author": "albertshau", "createdAt": "2020-06-18T06:12:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk3NDI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk5MDkyMQ==", "url": "https://github.com/cdapio/cdap/pull/12373#discussion_r441990921", "bodyText": "I didn't use the getter before cause we didn't want the users to confuse why {service:false} is set after upgrade when pre-upgrade it was not the case. Same for other objects, hence I made them \"protected\" and just pass them directly from whatever I got from serialization.\nDoes that premise still hold? wdyt?", "author": "pandyajay10", "createdAt": "2020-06-18T06:16:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk3NDI1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MjAwMDI2MA==", "url": "https://github.com/cdapio/cdap/pull/12373#discussion_r442000260", "bodyText": "hm ok. can you annotate these all as @Nullable then", "author": "albertshau", "createdAt": "2020-06-18T06:40:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTk3NDI1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "022c64906d093079ce1b2141b1e78b9dc7d5441a", "chunk": "diff --git a/cdap-app-templates/cdap-etl/cdap-etl-proto/src/main/java/io/cdap/cdap/etl/proto/v2/ETLConfig.java b/cdap-app-templates/cdap-etl/cdap-etl-proto/src/main/java/io/cdap/cdap/etl/proto/v2/ETLConfig.java\nindex 83603269f8b..f748a2c6ff6 100644\n--- a/cdap-app-templates/cdap-etl/cdap-etl-proto/src/main/java/io/cdap/cdap/etl/proto/v2/ETLConfig.java\n+++ b/cdap-app-templates/cdap-etl/cdap-etl-proto/src/main/java/io/cdap/cdap/etl/proto/v2/ETLConfig.java\n\n@@ -61,8 +61,8 @@ public class ETLConfig extends Config implements UpgradeableConfig {\n \n   protected ETLConfig(Set<ETLStage> stages, Set<Connection> connections,\n                       Resources resources, Resources driverResources, Resources clientResources,\n-                      Boolean stageLoggingEnabled, Boolean processTimingEnabled,\n-                      Integer numOfRecordsPreview, Map<String, String> properties) {\n+                      @Nullable Boolean stageLoggingEnabled, @Nullable Boolean processTimingEnabled,\n+                      @Nullable Integer numOfRecordsPreview, Map<String, String> properties) {\n     this.description = null;\n     this.stages = Collections.unmodifiableSet(stages);\n     this.connections = Collections.unmodifiableSet(connections);\n"}}, {"oid": "022c64906d093079ce1b2141b1e78b9dc7d5441a", "url": "https://github.com/cdapio/cdap/commit/022c64906d093079ce1b2141b1e78b9dc7d5441a", "message": "Use Primtive class wrapper instead of primitive types in ETLBatchConfig & DataStreamConfig for graceful handling of upgrade", "committedDate": "2020-06-18T16:19:37Z", "type": "forcePushed"}, {"oid": "592353e19a607fa40faf19a9423a2210a4022bc0", "url": "https://github.com/cdapio/cdap/commit/592353e19a607fa40faf19a9423a2210a4022bc0", "message": "Use Primtive class wrapper instead of primitive types in ETLBatchConfig & DataStreamConfig for graceful handling of upgrade", "committedDate": "2020-06-18T16:54:28Z", "type": "forcePushed"}, {"oid": "d09a3f0337891ad68d4726f2228638633b4536d5", "url": "https://github.com/cdapio/cdap/commit/d09a3f0337891ad68d4726f2228638633b4536d5", "message": "Use Primtive class wrapper instead of primitive types in ETLBatchConfig & DataStreamConfig for graceful handling of upgrade", "committedDate": "2020-06-18T17:26:33Z", "type": "commit"}, {"oid": "d09a3f0337891ad68d4726f2228638633b4536d5", "url": "https://github.com/cdapio/cdap/commit/d09a3f0337891ad68d4726f2228638633b4536d5", "message": "Use Primtive class wrapper instead of primitive types in ETLBatchConfig & DataStreamConfig for graceful handling of upgrade", "committedDate": "2020-06-18T17:26:33Z", "type": "forcePushed"}]}