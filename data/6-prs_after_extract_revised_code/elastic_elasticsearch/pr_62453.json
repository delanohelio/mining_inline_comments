{"pr_number": 62453, "pr_title": "Fix failure in AppendProcessorTests.testAppendingUniqueValueToScalar", "pr_createdAt": "2020-09-16T13:08:05Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/62453", "timeline": [{"oid": "da62a4acf1fcf5a35ead792439f7e9cfd3890bfc", "url": "https://github.com/elastic/elasticsearch/commit/da62a4acf1fcf5a35ead792439f7e9cfd3890bfc", "message": "ensure that value differs from existing scalar", "committedDate": "2020-09-15T19:13:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM0ODA0MA==", "url": "https://github.com/elastic/elasticsearch/pull/62453#discussion_r490348040", "bodyText": "Maybe use randomValueOtherThan? It'll communicate intent better, I think", "author": "probakowski", "createdAt": "2020-09-17T15:34:39Z", "path": "modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/AppendProcessorTests.java", "diffHunk": "@@ -179,7 +179,7 @@ public void testAppendingUniqueValueToScalar() throws Exception {\n         String field = RandomDocumentPicks.addRandomField(random(), ingestDocument, originalValue);\n \n         List<Object> valuesToAppend = new ArrayList<>();\n-        String newValue = randomAlphaOfLengthBetween(1, 10);\n+        String newValue = originalValue + randomAlphaOfLengthBetween(1, 10);", "originalCommit": "da62a4acf1fcf5a35ead792439f7e9cfd3890bfc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM1OTYzMA==", "url": "https://github.com/elastic/elasticsearch/pull/62453#discussion_r490359630", "bodyText": "Thanks, @probakowski! I didn't know about the randomValueOtherThan method.", "author": "danhermann", "createdAt": "2020-09-17T15:51:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDM0ODA0MA=="}], "type": "inlineReview", "revised_code": {"commit": "7e0d89a37c78a0c29295faf14e89e4a0abbe201a", "chunk": "diff --git a/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/AppendProcessorTests.java b/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/AppendProcessorTests.java\nindex 8f3e037d26b..4a4d79d4fa3 100644\n--- a/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/AppendProcessorTests.java\n+++ b/modules/ingest-common/src/test/java/org/elasticsearch/ingest/common/AppendProcessorTests.java\n\n@@ -179,7 +179,7 @@ public class AppendProcessorTests extends ESTestCase {\n         String field = RandomDocumentPicks.addRandomField(random(), ingestDocument, originalValue);\n \n         List<Object> valuesToAppend = new ArrayList<>();\n-        String newValue = originalValue + randomAlphaOfLengthBetween(1, 10);\n+        String newValue = randomValueOtherThan(originalValue, () -> randomAlphaOfLengthBetween(1, 10));\n         valuesToAppend.add(newValue);\n         Processor appendProcessor = createAppendProcessor(field, valuesToAppend, false);\n         appendProcessor.execute(ingestDocument);\n"}}, {"oid": "7e0d89a37c78a0c29295faf14e89e4a0abbe201a", "url": "https://github.com/elastic/elasticsearch/commit/7e0d89a37c78a0c29295faf14e89e4a0abbe201a", "message": "review comments", "committedDate": "2020-09-17T15:47:17Z", "type": "commit"}]}