{"pr_number": 64753, "pr_title": "Fix the earliest last modified age of translog issue.", "pr_createdAt": "2020-11-08T13:22:17Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/64753", "timeline": [{"oid": "07c26346f59720bc3d96edfccecdc6ab1d0daa21", "url": "https://github.com/elastic/elasticsearch/commit/07c26346f59720bc3d96edfccecdc6ab1d0daa21", "message": "Fix the earliest last modified age of translog issue.", "committedDate": "2020-11-08T12:58:42Z", "type": "commit"}, {"oid": "53a728f4cf21b7eb26c91bf24e62e11a4a57eeb1", "url": "https://github.com/elastic/elasticsearch/commit/53a728f4cf21b7eb26c91bf24e62e11a4a57eeb1", "message": "init it in definition", "committedDate": "2020-11-08T13:21:45Z", "type": "commit"}, {"oid": "1dde60de4250148f1e9ce34c60afacc9fa0f85ec", "url": "https://github.com/elastic/elasticsearch/commit/1dde60de4250148f1e9ce34c60afacc9fa0f85ec", "message": "Merge branch 'master' into modify_time", "committedDate": "2020-11-26T01:36:51Z", "type": "commit"}, {"oid": "22c19d5eee66faca2eabfc6664e78aa3bbedd6e0", "url": "https://github.com/elastic/elasticsearch/commit/22c19d5eee66faca2eabfc6664e78aa3bbedd6e0", "message": "keep last modify time as 0L", "committedDate": "2020-11-26T01:41:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2NzgyNA==", "url": "https://github.com/elastic/elasticsearch/pull/64753#discussion_r531067824", "bodyText": "Let's use this.earliestLastModifiedAge == 0.", "author": "dnhatn", "createdAt": "2020-11-26T14:32:17Z", "path": "server/src/main/java/org/elasticsearch/index/translog/TranslogStats.java", "diffHunk": "@@ -80,8 +80,12 @@ public void add(TranslogStats translogStats) {\n         this.translogSizeInBytes += translogStats.translogSizeInBytes;\n         this.uncommittedOperations += translogStats.uncommittedOperations;\n         this.uncommittedSizeInBytes += translogStats.uncommittedSizeInBytes;\n-        this.earliestLastModifiedAge =\n-            Math.min(this.earliestLastModifiedAge, translogStats.earliestLastModifiedAge);\n+        if (this.earliestLastModifiedAge < 1) {", "originalCommit": "22c19d5eee66faca2eabfc6664e78aa3bbedd6e0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTEwMzA1Mg==", "url": "https://github.com/elastic/elasticsearch/pull/64753#discussion_r531103052", "bodyText": "Updated, thanks.", "author": "howardhuanghua", "createdAt": "2020-11-26T15:30:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTA2NzgyNA=="}], "type": "inlineReview", "revised_code": {"commit": "0e292b2594dbbb57287c4c088d303f763d2dae02", "chunk": "diff --git a/server/src/main/java/org/elasticsearch/index/translog/TranslogStats.java b/server/src/main/java/org/elasticsearch/index/translog/TranslogStats.java\nindex bd182fe7643..b2d04fc146d 100644\n--- a/server/src/main/java/org/elasticsearch/index/translog/TranslogStats.java\n+++ b/server/src/main/java/org/elasticsearch/index/translog/TranslogStats.java\n\n@@ -80,7 +80,7 @@ public class TranslogStats implements Writeable, ToXContentFragment {\n         this.translogSizeInBytes += translogStats.translogSizeInBytes;\n         this.uncommittedOperations += translogStats.uncommittedOperations;\n         this.uncommittedSizeInBytes += translogStats.uncommittedSizeInBytes;\n-        if (this.earliestLastModifiedAge < 1) {\n+        if (this.earliestLastModifiedAge == 0) {\n             this.earliestLastModifiedAge = translogStats.earliestLastModifiedAge;\n         } else {\n             this.earliestLastModifiedAge =\n"}}, {"oid": "0e292b2594dbbb57287c4c088d303f763d2dae02", "url": "https://github.com/elastic/elasticsearch/commit/0e292b2594dbbb57287c4c088d303f763d2dae02", "message": "update condition", "committedDate": "2020-11-26T15:28:07Z", "type": "commit"}, {"oid": "413ddb50bbfb798400dbb3d65defa3d4db19e265", "url": "https://github.com/elastic/elasticsearch/commit/413ddb50bbfb798400dbb3d65defa3d4db19e265", "message": "Merge branch 'master' into modify_time", "committedDate": "2020-11-26T15:28:53Z", "type": "commit"}]}