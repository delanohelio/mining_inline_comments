{"pr_number": 60328, "pr_title": "Allows nanosecond resolution in search_after", "pr_createdAt": "2020-07-28T18:07:53Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60328", "timeline": [{"oid": "69025d75003edb2b3ae77c1d928005bff56b5c13", "url": "https://github.com/elastic/elasticsearch/commit/69025d75003edb2b3ae77c1d928005bff56b5c13", "message": "Allows nanosecond resolution in search_after\n\nThis fixes `search_after` to properly parse string formatted dates that\nhave nanosecond resolution.\n\nCloses #52424", "committedDate": "2020-07-28T17:10:46Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTc5NTU1OA==", "url": "https://github.com/elastic/elasticsearch/pull/60328#discussion_r461795558", "bodyText": "nit: because lots of ...", "author": "jimczi", "createdAt": "2020-07-28T18:45:08Z", "path": "server/src/main/java/org/elasticsearch/index/mapper/DateFieldMapper.java", "diffHunk": "@@ -440,6 +440,7 @@ public DocValueFormat docValueFormat(@Nullable String format, ZoneId timeZone) {\n             }\n             // the resolution here is always set to milliseconds, as aggregations use this formatter mainly and those are always in\n             // milliseconds. The only special case here is docvalue fields, which are handled somewhere else\n+            // TODO maybe aggs should force millis because lot so of other places want nanos?", "originalCommit": "69025d75003edb2b3ae77c1d928005bff56b5c13", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "81beee7b367e4e9e85313f25cde9d5982a4e98c8", "chunk": "diff --git a/server/src/main/java/org/elasticsearch/index/mapper/DateFieldMapper.java b/server/src/main/java/org/elasticsearch/index/mapper/DateFieldMapper.java\nindex cf423af440c..c9d6869eabf 100644\n--- a/server/src/main/java/org/elasticsearch/index/mapper/DateFieldMapper.java\n+++ b/server/src/main/java/org/elasticsearch/index/mapper/DateFieldMapper.java\n\n@@ -440,7 +440,7 @@ public final class DateFieldMapper extends ParametrizedFieldMapper {\n             }\n             // the resolution here is always set to milliseconds, as aggregations use this formatter mainly and those are always in\n             // milliseconds. The only special case here is docvalue fields, which are handled somewhere else\n-            // TODO maybe aggs should force millis because lot so of other places want nanos?\n+            // TODO maybe aggs should force millis because lots so of other places want nanos?\n             return new DocValueFormat.DateTime(dateTimeFormatter, timeZone, Resolution.MILLISECONDS);\n         }\n     }\n"}}, {"oid": "a8fcba8a187c6ea27b24d852467b990101208a32", "url": "https://github.com/elastic/elasticsearch/commit/a8fcba8a187c6ea27b24d852467b990101208a32", "message": "Merge branch 'master' into allow_nano_resolution_in_search_after", "committedDate": "2020-07-28T20:14:40Z", "type": "commit"}, {"oid": "81beee7b367e4e9e85313f25cde9d5982a4e98c8", "url": "https://github.com/elastic/elasticsearch/commit/81beee7b367e4e9e85313f25cde9d5982a4e98c8", "message": "Iter", "committedDate": "2020-07-28T20:15:21Z", "type": "commit"}, {"oid": "b2988366e79e7e185981b237b30855d6f9859170", "url": "https://github.com/elastic/elasticsearch/commit/b2988366e79e7e185981b237b30855d6f9859170", "message": "Skip", "committedDate": "2020-07-28T21:43:41Z", "type": "commit"}]}