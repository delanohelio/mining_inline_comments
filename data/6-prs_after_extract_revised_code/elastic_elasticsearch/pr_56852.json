{"pr_number": 56852, "pr_title": "EQL: Adds get async EQL search result action", "pr_createdAt": "2020-05-15T22:14:04Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/56852", "timeline": [{"oid": "b101b8fd6410b324712a1e62ecef800edb64986f", "url": "https://github.com/elastic/elasticsearch/commit/b101b8fd6410b324712a1e62ecef800edb64986f", "message": "EQL: Adds get async EQL search result action\n\nAdds support for retrieving async EQL search result s to eql search API.\n\nRelates to #49638", "committedDate": "2020-05-15T20:18:19Z", "type": "commit"}, {"oid": "e1c0d8c9c0ae668836edb277465932f9f5d954e4", "url": "https://github.com/elastic/elasticsearch/commit/e1c0d8c9c0ae668836edb277465932f9f5d954e4", "message": "Merge branch 'feature/async-eql' into eql-get-async-result", "committedDate": "2020-05-18T15:30:32Z", "type": "commit"}, {"oid": "f818b2b7d81e3ef9848c932885547ba3af519236", "url": "https://github.com/elastic/elasticsearch/commit/f818b2b7d81e3ef9848c932885547ba3af519236", "message": "Add async eql security test", "committedDate": "2020-05-26T19:41:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDkxOTIxMQ==", "url": "https://github.com/elastic/elasticsearch/pull/56852#discussion_r430919211", "bodyText": "Maybe add a isAsyncAction to encapsulate the condition of both search and eql searches there? Any future updates would not touch authorizeIndexAction.", "author": "costin", "createdAt": "2020-05-27T07:44:02Z", "path": "x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/RBACEngine.java", "diffHunk": "@@ -266,7 +267,7 @@ public void authorizeIndexAction(RequestInfo requestInfo, AuthorizationInfo auth\n                     // information such as the index and the incoming address of the request\n                     listener.onResponse(new IndexAuthorizationResult(true, IndicesAccessControl.ALLOW_NO_INDICES));\n                 }\n-            } else if (isAsyncSearchRelatedAction(action)) {\n+            } else if (isAsyncSearchRelatedAction(action) || isAsyncEqlSearchRelatedAction(action)) {", "originalCommit": "f818b2b7d81e3ef9848c932885547ba3af519236", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "bb782f64dc373503df86e9d466aa6f6394643c8b", "chunk": "diff --git a/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/RBACEngine.java b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/RBACEngine.java\nindex d028365c803..745345aeee3 100644\n--- a/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/RBACEngine.java\n+++ b/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authz/RBACEngine.java\n\n@@ -267,7 +267,7 @@ public class RBACEngine implements AuthorizationEngine {\n                     // information such as the index and the incoming address of the request\n                     listener.onResponse(new IndexAuthorizationResult(true, IndicesAccessControl.ALLOW_NO_INDICES));\n                 }\n-            } else if (isAsyncSearchRelatedAction(action) || isAsyncEqlSearchRelatedAction(action)) {\n+            } else if (isAsyncRelatedAction(action)) {\n                 if (SubmitAsyncSearchAction.NAME.equals(action)) {\n                     // we check if the user has any indices permission when submitting an async-search request in order to be\n                     // able to fail the request early. Fine grained index-level permissions are handled by the search action\n"}}, {"oid": "bb782f64dc373503df86e9d466aa6f6394643c8b", "url": "https://github.com/elastic/elasticsearch/commit/bb782f64dc373503df86e9d466aa6f6394643c8b", "message": "Merge isAsyncSearchRelatedAction and isAsyncEqlSearchRelatedAction\n\ninto isAsyncRelatedAction", "committedDate": "2020-05-27T11:59:57Z", "type": "commit"}, {"oid": "42fa9928b977c4d850ad42826f1f7b89780929dd", "url": "https://github.com/elastic/elasticsearch/commit/42fa9928b977c4d850ad42826f1f7b89780929dd", "message": "Merge branch 'feature/async-eql' into eql-get-async-result", "committedDate": "2020-05-27T13:21:01Z", "type": "commit"}]}