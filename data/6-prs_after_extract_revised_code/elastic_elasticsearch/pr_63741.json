{"pr_number": 63741, "pr_title": "Remove direct dependency between ParserContext and MapperService", "pr_createdAt": "2020-10-15T13:12:19Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63741", "timeline": [{"oid": "ad857121d6512781d0bab7c5239f4dfa28f1547c", "url": "https://github.com/elastic/elasticsearch/commit/ad857121d6512781d0bab7c5239f4dfa28f1547c", "message": "Remove direct dependency between ParserContext and MapperService\n\nParserContext only needs some small portions of MapperService, and certainly does not need to expose MapperService through its current getter method.\n\nWith this change we address this by keeping references to the needed components rather than the whole MapperService", "committedDate": "2020-10-15T13:00:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTUzNTY0Nw==", "url": "https://github.com/elastic/elasticsearch/pull/63741#discussion_r505535647", "bodyText": "We can probably change this to use the Version directly as a follow-up", "author": "romseygeek", "createdAt": "2020-10-15T13:20:30Z", "path": "server/src/main/java/org/elasticsearch/index/mapper/NestedPathFieldMapper.java", "diffHunk": "@@ -68,7 +68,7 @@ public static Field field(Settings settings, String path) {\n     }\n \n     public static final TypeParser PARSER = new FixedTypeParser(c -> {\n-        final IndexSettings indexSettings = c.mapperService().getIndexSettings();\n+        final IndexSettings indexSettings = c.getIndexSettings();", "originalCommit": "ad857121d6512781d0bab7c5239f4dfa28f1547c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTUzNjAxNw==", "url": "https://github.com/elastic/elasticsearch/pull/63741#discussion_r505536017", "bodyText": "Hah, I'm getting whiplash now.", "author": "romseygeek", "createdAt": "2020-10-15T13:21:01Z", "path": "server/src/main/java/org/elasticsearch/index/mapper/DocumentMapper.java", "diffHunk": "@@ -99,7 +99,7 @@ public Builder put(MetadataFieldMapper.Builder mapper) {\n             return this;\n         }\n \n-        public DocumentMapper build(IndexSettings indexSettings, DocumentMapperParser documentMapperParser, IndexAnalyzers indexAnalyzers) {\n+        public DocumentMapper build() {", "originalCommit": "ad857121d6512781d0bab7c5239f4dfa28f1547c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTUzOTI5Ng==", "url": "https://github.com/elastic/elasticsearch/pull/63741#discussion_r505539296", "bodyText": "haha I had a deja vu making this change, and I did not mean for any of this to happen just two days ago. but I am lucky, I guess :)", "author": "javanna", "createdAt": "2020-10-15T13:25:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTUzNjAxNw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "ce5e00131bc2a1c8f67dcf334ed5ec923d450633", "url": "https://github.com/elastic/elasticsearch/commit/ce5e00131bc2a1c8f67dcf334ed5ec923d450633", "message": "checkstyle", "committedDate": "2020-10-15T13:29:51Z", "type": "commit"}]}