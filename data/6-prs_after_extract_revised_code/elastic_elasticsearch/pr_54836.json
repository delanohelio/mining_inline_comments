{"pr_number": 54836, "pr_title": "SQL: drop BASE TABLE type in favour for just TABLE", "pr_createdAt": "2020-04-06T18:47:46Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/54836", "timeline": [{"oid": "4948d1c061bd5e7f31820f472e9e2342c28818b2", "url": "https://github.com/elastic/elasticsearch/commit/4948d1c061bd5e7f31820f472e9e2342c28818b2", "message": "Drop BASE TABLE type in favour for just TABLE\n\nThis commit drops the table type 'BASE TABLE' and replaces all\noccurences with just 'TABLE', since his type is wider-used and\nfriendlier to the client applications that query for certain table types\nin their discovery mode.\n\nThe 'TABLE' type is also explicitely mentioned by the JDBC and ODBC\nstandards and although other data source-specific types are permitted,\nolder apps will not work well with them.", "committedDate": "2020-04-06T18:39:19Z", "type": "commit"}, {"oid": "5ca6a526dc4a62aa1ce4fcadef237639b493bd26", "url": "https://github.com/elastic/elasticsearch/commit/5ca6a526dc4a62aa1ce4fcadef237639b493bd26", "message": "Update tests, rename BASE TABLE to TABLE\n\nUpdate tests, rename 'BASE TABLE' to 'TABLE'.", "committedDate": "2020-04-07T11:54:14Z", "type": "commit"}, {"oid": "93444344b1749221ff7c244320421371090f7980", "url": "https://github.com/elastic/elasticsearch/commit/93444344b1749221ff7c244320421371090f7980", "message": "Merge branch 'master' into enh/drop_base_table", "committedDate": "2020-04-07T12:53:11Z", "type": "commit"}, {"oid": "e2e4481bb7788ce9034b46a431af4d6978ab4ea4", "url": "https://github.com/elastic/elasticsearch/commit/e2e4481bb7788ce9034b46a431af4d6978ab4ea4", "message": "Merge branch 'master' into enh/drop_base_table", "committedDate": "2020-04-07T13:15:15Z", "type": "commit"}, {"oid": "05af426ae6e597eab20203a6bd052b80f8781459", "url": "https://github.com/elastic/elasticsearch/commit/05af426ae6e597eab20203a6bd052b80f8781459", "message": "Merge branch 'master' into enh/drop_base_table", "committedDate": "2020-04-07T16:08:26Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA5MDgwMw==", "url": "https://github.com/elastic/elasticsearch/pull/54836#discussion_r405090803", "bodyText": "Since these constants are used somewhere else, it makes sense to move them outside IndexType and reuse them inside the enum declaration as well.", "author": "costin", "createdAt": "2020-04-07T20:26:45Z", "path": "x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/index/IndexResolver.java", "diffHunk": "@@ -76,13 +76,12 @@\n public class IndexResolver {\n \n     public enum IndexType {\n-        STANDARD_INDEX(\"BASE TABLE\", \"INDEX\"),\n+        STANDARD_INDEX(\"TABLE\", \"INDEX\"),\n         ALIAS(\"VIEW\", \"ALIAS\"),\n-        FROZEN_INDEX(\"BASE TABLE\", \"FROZEN INDEX\"),\n+        FROZEN_INDEX(\"TABLE\", \"FROZEN INDEX\"),\n         // value for user types unrecognized\n         UNKNOWN(\"UNKNOWN\", \"UNKNOWN\");\n \n-        public static final String SQL_BASE_TABLE = \"BASE TABLE\";\n         public static final String SQL_TABLE = \"TABLE\";", "originalCommit": "05af426ae6e597eab20203a6bd052b80f8781459", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "bc172136a2290e1c38c9bdd3eb3254ee1ddd2fa0", "chunk": "diff --git a/x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/index/IndexResolver.java b/x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/index/IndexResolver.java\nindex 32fcd60b393..954e23e4020 100644\n--- a/x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/index/IndexResolver.java\n+++ b/x-pack/plugin/ql/src/main/java/org/elasticsearch/xpack/ql/index/IndexResolver.java\n\n@@ -76,18 +76,14 @@ import static org.elasticsearch.xpack.ql.type.DataTypes.UNSUPPORTED;\n public class IndexResolver {\n \n     public enum IndexType {\n-        STANDARD_INDEX(\"TABLE\", \"INDEX\"),\n-        ALIAS(\"VIEW\", \"ALIAS\"),\n-        FROZEN_INDEX(\"TABLE\", \"FROZEN INDEX\"),\n+        STANDARD_INDEX(SQL_TABLE, \"INDEX\"),\n+        ALIAS(SQL_VIEW, \"ALIAS\"),\n+        FROZEN_INDEX(SQL_TABLE, \"FROZEN INDEX\"),\n         // value for user types unrecognized\n         UNKNOWN(\"UNKNOWN\", \"UNKNOWN\");\n \n-        public static final String SQL_TABLE = \"TABLE\";\n-        public static final String SQL_VIEW = \"VIEW\";\n-\n         public static final EnumSet<IndexType> VALID_INCLUDE_FROZEN = EnumSet.of(STANDARD_INDEX, ALIAS, FROZEN_INDEX);\n         public static final EnumSet<IndexType> VALID_REGULAR = EnumSet.of(STANDARD_INDEX, ALIAS);\n-        public static final EnumSet<IndexType> INDICES_ONLY = EnumSet.of(STANDARD_INDEX, FROZEN_INDEX);\n \n         private final String toSql;\n         private final String toNative;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTA5MTQ0OQ==", "url": "https://github.com/elastic/elasticsearch/pull/54836#discussion_r405091449", "bodyText": "\ud83d\udc4d", "author": "costin", "createdAt": "2020-04-07T20:27:49Z", "path": "x-pack/plugin/sql/src/test/java/org/elasticsearch/xpack/sql/plan/logical/command/sys/SysTablesTests.java", "diffHunk": "@@ -105,9 +107,9 @@ public void testSysTablesCatalogNoTypes() throws Exception {\n     public void testSysTablesTypesEnumerationWoString() throws Exception {\n         executeCommand(\"SYS TABLES CATALOG LIKE '' LIKE '' \", r -> {\n             assertEquals(2, r.size());\n-            assertEquals(\"BASE TABLE\", r.column(3));\n+            assertEquals(SQL_TABLE, r.column(3));", "originalCommit": "05af426ae6e597eab20203a6bd052b80f8781459", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "bc172136a2290e1c38c9bdd3eb3254ee1ddd2fa0", "url": "https://github.com/elastic/elasticsearch/commit/bc172136a2290e1c38c9bdd3eb3254ee1ddd2fa0", "message": "Refactor table type constants out of IndexType\n\nMove SQL_TABLE/_ALIAS out of IndexType, so that they can also be used in\nthat Enum definition.", "committedDate": "2020-04-08T08:04:15Z", "type": "commit"}]}