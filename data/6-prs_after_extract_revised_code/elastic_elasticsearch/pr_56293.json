{"pr_number": 56293, "pr_title": "Remove the lexer hack in Painless", "pr_createdAt": "2020-05-06T17:29:59Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/56293", "timeline": [{"oid": "eac1d61e41717df51b42edf65cbd1570a2a46663", "url": "https://github.com/elastic/elasticsearch/commit/eac1d61e41717df51b42edf65cbd1570a2a46663", "message": "remove statement, use read instead", "committedDate": "2020-03-27T23:55:26Z", "type": "commit"}, {"oid": "082e94b4a590591196625bad85750d2fcbc4f551", "url": "https://github.com/elastic/elasticsearch/commit/082e94b4a590591196625bad85750d2fcbc4f551", "message": "add tests for not a statement", "committedDate": "2020-03-30T16:27:34Z", "type": "commit"}, {"oid": "d6ca6a35cfeb2f5b8689b7258bb19eda858c03bf", "url": "https://github.com/elastic/elasticsearch/commit/d6ca6a35cfeb2f5b8689b7258bb19eda858c03bf", "message": "Merge branch 'master' into nodes0", "committedDate": "2020-03-30T16:51:01Z", "type": "commit"}, {"oid": "4459ee9a8029edd7c995865bd3202830def8097c", "url": "https://github.com/elastic/elasticsearch/commit/4459ee9a8029edd7c995865bd3202830def8097c", "message": "move isDefOptimized to output instead of as mutable state on the nodes", "committedDate": "2020-03-30T19:02:43Z", "type": "commit"}, {"oid": "1eb0a513f54a2abc3a4d90877d43297a246e7dac", "url": "https://github.com/elastic/elasticsearch/commit/1eb0a513f54a2abc3a4d90877d43297a246e7dac", "message": "Merge branch 'master' into nodes0", "committedDate": "2020-03-30T19:05:32Z", "type": "commit"}, {"oid": "372ec631791fceda73c22bb1dfbba176aeba7c1f", "url": "https://github.com/elastic/elasticsearch/commit/372ec631791fceda73c22bb1dfbba176aeba7c1f", "message": "Merge branch 'nodes0' into nodes1", "committedDate": "2020-03-30T19:05:58Z", "type": "commit"}, {"oid": "99c54f190497586547ab073b41a0c5d39d89b5fd", "url": "https://github.com/elastic/elasticsearch/commit/99c54f190497586547ab073b41a0c5d39d89b5fd", "message": "remove AStoreable and give individual nodes responsibility to check\nwrite", "committedDate": "2020-03-30T20:18:46Z", "type": "commit"}, {"oid": "2eceff4ba180840b185ae834b963c9b7ae1f58bc", "url": "https://github.com/elastic/elasticsearch/commit/2eceff4ba180840b185ae834b963c9b7ae1f58bc", "message": "clean up write messages and add tests", "committedDate": "2020-03-30T22:18:14Z", "type": "commit"}, {"oid": "78961f80bef311dfa557dd0288dec8a7a1564be6", "url": "https://github.com/elastic/elasticsearch/commit/78961f80bef311dfa557dd0288dec8a7a1564be6", "message": "elimate extraneous new array function reference ir node", "committedDate": "2020-03-30T22:57:27Z", "type": "commit"}, {"oid": "7a3a3870e6443c2cfa2cdf9a3e0920977daaaf82", "url": "https://github.com/elastic/elasticsearch/commit/7a3a3870e6443c2cfa2cdf9a3e0920977daaaf82", "message": "switch ir function ref nodes to different types", "committedDate": "2020-03-31T20:07:52Z", "type": "commit"}, {"oid": "791eca3b0d29f37c9d84fd196fb03618d33b8606", "url": "https://github.com/elastic/elasticsearch/commit/791eca3b0d29f37c9d84fd196fb03618d33b8606", "message": "remove ILambda in favor of ir tree calculating def method call recipe", "committedDate": "2020-03-31T20:45:25Z", "type": "commit"}, {"oid": "e77796275a7bf20572efb4dd1610e26ad0adefe1", "url": "https://github.com/elastic/elasticsearch/commit/e77796275a7bf20572efb4dd1610e26ad0adefe1", "message": "remove sub nodes from user tree", "committedDate": "2020-03-31T22:52:45Z", "type": "commit"}, {"oid": "0eba55c612cfbc1b967b0cd1e2e99fa01b53ec6e", "url": "https://github.com/elastic/elasticsearch/commit/0eba55c612cfbc1b967b0cd1e2e99fa01b53ec6e", "message": "remove PainlessCast from output as it's completely local", "committedDate": "2020-04-01T22:20:46Z", "type": "commit"}, {"oid": "8d0ac605207b4fd8fb38942de0e7831dd2dfce9e", "url": "https://github.com/elastic/elasticsearch/commit/8d0ac605207b4fd8fb38942de0e7831dd2dfce9e", "message": "partially removed type from lexer", "committedDate": "2020-04-02T23:59:28Z", "type": "commit"}, {"oid": "38c15bc41853f468504d1e6517aa78f8d528e4a6", "url": "https://github.com/elastic/elasticsearch/commit/38c15bc41853f468504d1e6517aa78f8d528e4a6", "message": "removed ambiguity in parsing related to casting versus binary", "committedDate": "2020-04-03T23:19:27Z", "type": "commit"}, {"oid": "3bfed8d6631a604e3da06aa734be4a50ee7c078b", "url": "https://github.com/elastic/elasticsearch/commit/3bfed8d6631a604e3da06aa734be4a50ee7c078b", "message": "handle negation in the user tree instead of relying on the walker", "committedDate": "2020-04-04T00:42:02Z", "type": "commit"}, {"oid": "f8235dfa22a5e02193bc45b12f35b18eb08df896", "url": "https://github.com/elastic/elasticsearch/commit/f8235dfa22a5e02193bc45b12f35b18eb08df896", "message": "lexer hack completely removed", "committedDate": "2020-04-06T20:57:57Z", "type": "commit"}, {"oid": "94b6c80f963c042dae95604d3c6b469fff10d9ac", "url": "https://github.com/elastic/elasticsearch/commit/94b6c80f963c042dae95604d3c6b469fff10d9ac", "message": "Merge branch 'master' into nodes0", "committedDate": "2020-04-08T17:03:44Z", "type": "commit"}, {"oid": "e7af841e35bcd8d4f845f54ffb082d3d201a51b4", "url": "https://github.com/elastic/elasticsearch/commit/e7af841e35bcd8d4f845f54ffb082d3d201a51b4", "message": "Merge branch 'nodes0' into nodes1", "committedDate": "2020-04-08T17:03:54Z", "type": "commit"}, {"oid": "97549c8d5b65a1c97a361a9fb8fa30bdab0ea6db", "url": "https://github.com/elastic/elasticsearch/commit/97549c8d5b65a1c97a361a9fb8fa30bdab0ea6db", "message": "Merge branch 'nodes1' into nodes2", "committedDate": "2020-04-08T17:24:14Z", "type": "commit"}, {"oid": "68cd9273b01b4d9a5b27546c3a61862dd7c424b4", "url": "https://github.com/elastic/elasticsearch/commit/68cd9273b01b4d9a5b27546c3a61862dd7c424b4", "message": "Merge branch 'nodes2' into nodes3", "committedDate": "2020-04-08T17:26:09Z", "type": "commit"}, {"oid": "112048c228d27db7920c45d54c504965bf273be5", "url": "https://github.com/elastic/elasticsearch/commit/112048c228d27db7920c45d54c504965bf273be5", "message": "Merge branch 'nodes3' into nodes4", "committedDate": "2020-04-08T17:29:05Z", "type": "commit"}, {"oid": "5669498608729c5633e15b53142b0126e9d2e2c7", "url": "https://github.com/elastic/elasticsearch/commit/5669498608729c5633e15b53142b0126e9d2e2c7", "message": "Merge branch 'nodes4' into nodes5", "committedDate": "2020-04-08T17:30:40Z", "type": "commit"}, {"oid": "56b43370baaac38d98593a92fe96fb063c5b0585", "url": "https://github.com/elastic/elasticsearch/commit/56b43370baaac38d98593a92fe96fb063c5b0585", "message": "add javadocs", "committedDate": "2020-04-08T19:23:30Z", "type": "commit"}, {"oid": "1f6bf2f30cb90de1e386f96326ea146435e73921", "url": "https://github.com/elastic/elasticsearch/commit/1f6bf2f30cb90de1e386f96326ea146435e73921", "message": "add guards for invalid static values", "committedDate": "2020-04-08T22:16:30Z", "type": "commit"}, {"oid": "50fc23b95ff6254430cbe5b1fe3382ebed451752", "url": "https://github.com/elastic/elasticsearch/commit/50fc23b95ff6254430cbe5b1fe3382ebed451752", "message": "add partial types tests and not a symbol tests", "committedDate": "2020-04-09T20:56:43Z", "type": "commit"}, {"oid": "1b61f58c3a9fbbd924eaa7647d96b9541d4e9919", "url": "https://github.com/elastic/elasticsearch/commit/1b61f58c3a9fbbd924eaa7647d96b9541d4e9919", "message": "add tests for valid static types", "committedDate": "2020-04-09T21:50:23Z", "type": "commit"}, {"oid": "07b1efe9f647668e41a4121ab987968d1ba7b425", "url": "https://github.com/elastic/elasticsearch/commit/07b1efe9f647668e41a4121ab987968d1ba7b425", "message": "add precedence node to handle final lexer hack removal path", "committedDate": "2020-04-09T23:33:29Z", "type": "commit"}, {"oid": "251ff50fcac2ded70f1026560cf7cb67d1e86c28", "url": "https://github.com/elastic/elasticsearch/commit/251ff50fcac2ded70f1026560cf7cb67d1e86c28", "message": "Merge branch 'master' into nodes1", "committedDate": "2020-04-10T15:30:43Z", "type": "commit"}, {"oid": "198fa475e180a169ca1911734d49096dbaf4a1f3", "url": "https://github.com/elastic/elasticsearch/commit/198fa475e180a169ca1911734d49096dbaf4a1f3", "message": "Merge branch 'nodes1' into nodes2", "committedDate": "2020-04-10T15:36:40Z", "type": "commit"}, {"oid": "dd82b5f86711cb8d99c686d9fa21ddb035e84880", "url": "https://github.com/elastic/elasticsearch/commit/dd82b5f86711cb8d99c686d9fa21ddb035e84880", "message": "Merge branch 'nodes2' into nodes3", "committedDate": "2020-04-10T15:40:21Z", "type": "commit"}, {"oid": "87cafb387bc0f8096d3b7929b1d5186c481fdb39", "url": "https://github.com/elastic/elasticsearch/commit/87cafb387bc0f8096d3b7929b1d5186c481fdb39", "message": "Merge branch 'nodes3' into nodes4", "committedDate": "2020-04-10T15:42:14Z", "type": "commit"}, {"oid": "c466828680319beea3cc0087cfbf0ba73e5010eb", "url": "https://github.com/elastic/elasticsearch/commit/c466828680319beea3cc0087cfbf0ba73e5010eb", "message": "Merge branch 'nodes4' into nodes5", "committedDate": "2020-04-10T15:44:06Z", "type": "commit"}, {"oid": "e60482addcf51170606e74a6c0870481b705f14e", "url": "https://github.com/elastic/elasticsearch/commit/e60482addcf51170606e74a6c0870481b705f14e", "message": "move prefix into nodes its actually used in", "committedDate": "2020-04-10T18:35:21Z", "type": "commit"}, {"oid": "8c902dad68b1317b13097a4818d45f9fc1bed7a5", "url": "https://github.com/elastic/elasticsearch/commit/8c902dad68b1317b13097a4818d45f9fc1bed7a5", "message": "Use block instead of list of statements for Lambda", "committedDate": "2020-04-14T20:28:16Z", "type": "commit"}, {"oid": "a79f9b33ca1b8333d0e0b471c8c337674ca6f3f4", "url": "https://github.com/elastic/elasticsearch/commit/a79f9b33ca1b8333d0e0b471c8c337674ca6f3f4", "message": "Merge branch 'master' into nodes1", "committedDate": "2020-04-14T23:12:20Z", "type": "commit"}, {"oid": "4c93293c2ada3933550f1b64fa303a8785b7b328", "url": "https://github.com/elastic/elasticsearch/commit/4c93293c2ada3933550f1b64fa303a8785b7b328", "message": "Merge branch 'nodes1' into nodes2", "committedDate": "2020-04-14T23:12:46Z", "type": "commit"}, {"oid": "14079081e7c0e4fb365a4a48abef0aa16f0a9692", "url": "https://github.com/elastic/elasticsearch/commit/14079081e7c0e4fb365a4a48abef0aa16f0a9692", "message": "add primitive types to remove binary recognition of cast", "committedDate": "2020-04-15T20:18:06Z", "type": "commit"}, {"oid": "7a349b32470df4fa11b472acae915c8a5a63b5a2", "url": "https://github.com/elastic/elasticsearch/commit/7a349b32470df4fa11b472acae915c8a5a63b5a2", "message": "remove unnecessary nodes from EDot", "committedDate": "2020-04-15T20:39:54Z", "type": "commit"}, {"oid": "68679c8c4249bc8af9b28b449b5695fa8816b0cf", "url": "https://github.com/elastic/elasticsearch/commit/68679c8c4249bc8af9b28b449b5695fa8816b0cf", "message": "remove precedence", "committedDate": "2020-04-15T20:58:15Z", "type": "commit"}, {"oid": "bb55509d9540c641e5f50e184bd4790153fbedea", "url": "https://github.com/elastic/elasticsearch/commit/bb55509d9540c641e5f50e184bd4790153fbedea", "message": "remove node creation in EUnary", "committedDate": "2020-04-16T22:03:44Z", "type": "commit"}, {"oid": "1de2751d9913ab8ebca868c727b759cbbb1c7b2a", "url": "https://github.com/elastic/elasticsearch/commit/1de2751d9913ab8ebca868c727b759cbbb1c7b2a", "message": "remove remaining node instantiations within the semantic pass", "committedDate": "2020-04-16T22:31:34Z", "type": "commit"}, {"oid": "c8076bfa4366e371aaba802a038db3c56ce43074", "url": "https://github.com/elastic/elasticsearch/commit/c8076bfa4366e371aaba802a038db3c56ce43074", "message": "Merge branch 'master' into nodes2", "committedDate": "2020-04-21T14:51:10Z", "type": "commit"}, {"oid": "a4d34169a4724a4111cb30c9671e79798b64f3ef", "url": "https://github.com/elastic/elasticsearch/commit/a4d34169a4724a4111cb30c9671e79798b64f3ef", "message": "response to pr comments", "committedDate": "2020-04-21T16:38:42Z", "type": "commit"}, {"oid": "dafeaeb13af618684c04f0f5d38d509d4af92533", "url": "https://github.com/elastic/elasticsearch/commit/dafeaeb13af618684c04f0f5d38d509d4af92533", "message": "Merge branch 'master' into nodes2", "committedDate": "2020-04-21T17:31:42Z", "type": "commit"}, {"oid": "ee2e19f11c6d3781eb420fc9c94d8bb1342d76a4", "url": "https://github.com/elastic/elasticsearch/commit/ee2e19f11c6d3781eb420fc9c94d8bb1342d76a4", "message": "Merge branch 'nodes2' into nodes3", "committedDate": "2020-04-21T17:32:33Z", "type": "commit"}, {"oid": "9f2cdd1d6db22e474db4a1664b28942f32b6e8d6", "url": "https://github.com/elastic/elasticsearch/commit/9f2cdd1d6db22e474db4a1664b28942f32b6e8d6", "message": "Merge branch 'nodes3' into nodes4", "committedDate": "2020-04-21T17:38:07Z", "type": "commit"}, {"oid": "3250d9eeb0a9c1532353d79fb3daceb74f941686", "url": "https://github.com/elastic/elasticsearch/commit/3250d9eeb0a9c1532353d79fb3daceb74f941686", "message": "Merge branch 'nodes4' into nodes5", "committedDate": "2020-04-21T17:44:40Z", "type": "commit"}, {"oid": "d965f14ba797d115a5e499178807bbc288e7136b", "url": "https://github.com/elastic/elasticsearch/commit/d965f14ba797d115a5e499178807bbc288e7136b", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-04-21T17:47:09Z", "type": "commit"}, {"oid": "229f99c28164fe814514b26a412c191eae39de4c", "url": "https://github.com/elastic/elasticsearch/commit/229f99c28164fe814514b26a412c191eae39de4c", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-04-21T17:51:01Z", "type": "commit"}, {"oid": "a1ff4a0a9d2141722bffeb4d8b6fef3fc5e7addb", "url": "https://github.com/elastic/elasticsearch/commit/a1ff4a0a9d2141722bffeb4d8b6fef3fc5e7addb", "message": "Merge branch 'master' into nodes3", "committedDate": "2020-04-24T14:26:04Z", "type": "commit"}, {"oid": "1531a1e5ae9574fe54a26a63651c26c64391d733", "url": "https://github.com/elastic/elasticsearch/commit/1531a1e5ae9574fe54a26a63651c26c64391d733", "message": "Merge branch 'nodes3' into nodes4", "committedDate": "2020-04-24T14:34:07Z", "type": "commit"}, {"oid": "b16f828448b6416194d7bbbe4bb7f77808b9b62f", "url": "https://github.com/elastic/elasticsearch/commit/b16f828448b6416194d7bbbe4bb7f77808b9b62f", "message": "Merge branch 'nodes4' into nodes5", "committedDate": "2020-04-24T14:34:42Z", "type": "commit"}, {"oid": "cd139e2bf3de1f018a0659466066d7f2744a3f33", "url": "https://github.com/elastic/elasticsearch/commit/cd139e2bf3de1f018a0659466066d7f2744a3f33", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-04-24T14:34:59Z", "type": "commit"}, {"oid": "ca1febb58a3fb9b59d904a85ba27cef7b4ffb58a", "url": "https://github.com/elastic/elasticsearch/commit/ca1febb58a3fb9b59d904a85ba27cef7b4ffb58a", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-04-24T14:35:15Z", "type": "commit"}, {"oid": "64796ba9432bd5240d7bd1a9190503622d0af0ba", "url": "https://github.com/elastic/elasticsearch/commit/64796ba9432bd5240d7bd1a9190503622d0af0ba", "message": "Merge branch 'master' into nodes3", "committedDate": "2020-04-29T20:36:52Z", "type": "commit"}, {"oid": "35a029e05a0b237f0de461efc33cb94992739614", "url": "https://github.com/elastic/elasticsearch/commit/35a029e05a0b237f0de461efc33cb94992739614", "message": "response to pr comments", "committedDate": "2020-04-29T20:57:49Z", "type": "commit"}, {"oid": "948d6ecef2a5b02f15c90a96b35cbbaec9971720", "url": "https://github.com/elastic/elasticsearch/commit/948d6ecef2a5b02f15c90a96b35cbbaec9971720", "message": "Merge branch 'master' into nodes3", "committedDate": "2020-04-29T21:49:47Z", "type": "commit"}, {"oid": "5542b0f9fd649660bc36198b7d45161a8954794e", "url": "https://github.com/elastic/elasticsearch/commit/5542b0f9fd649660bc36198b7d45161a8954794e", "message": "Merge branch 'nodes3' into nodes4", "committedDate": "2020-04-29T21:49:54Z", "type": "commit"}, {"oid": "4c80224cbb7c20e50837862eafc0f8bc41f84cff", "url": "https://github.com/elastic/elasticsearch/commit/4c80224cbb7c20e50837862eafc0f8bc41f84cff", "message": "Merge branch 'master' into nodes4", "committedDate": "2020-05-04T15:56:39Z", "type": "commit"}, {"oid": "5cdb321bc0432297d5579d1029f165b5ef35d6d0", "url": "https://github.com/elastic/elasticsearch/commit/5cdb321bc0432297d5579d1029f165b5ef35d6d0", "message": "Merge branch 'master' into nodes4", "committedDate": "2020-05-04T21:52:47Z", "type": "commit"}, {"oid": "f3298b3c94c730f91247bb0f9a58a7123423f24b", "url": "https://github.com/elastic/elasticsearch/commit/f3298b3c94c730f91247bb0f9a58a7123423f24b", "message": "Merge branch 'nodes4' into nodes5", "committedDate": "2020-05-04T22:12:50Z", "type": "commit"}, {"oid": "c5153953dc331280025c2bfc5b8c145c140b5d0a", "url": "https://github.com/elastic/elasticsearch/commit/c5153953dc331280025c2bfc5b8c145c140b5d0a", "message": "remove unnecessary read/write checks", "committedDate": "2020-05-04T22:14:50Z", "type": "commit"}, {"oid": "c74a5c91176b02104639b491960ea9436c9fef0f", "url": "https://github.com/elastic/elasticsearch/commit/c74a5c91176b02104639b491960ea9436c9fef0f", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-05-04T23:42:15Z", "type": "commit"}, {"oid": "26f1d5cc262b982ea697077af5c13c40702c0c37", "url": "https://github.com/elastic/elasticsearch/commit/26f1d5cc262b982ea697077af5c13c40702c0c37", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-05-04T23:50:38Z", "type": "commit"}, {"oid": "cf023817db9f7b1e8d313a65dfb940f9fbd0e541", "url": "https://github.com/elastic/elasticsearch/commit/cf023817db9f7b1e8d313a65dfb940f9fbd0e541", "message": "Merge branch 'master' into nodes5", "committedDate": "2020-05-05T16:35:17Z", "type": "commit"}, {"oid": "4a70d3fb81f22666dbb013aa8ed07604f999d2fe", "url": "https://github.com/elastic/elasticsearch/commit/4a70d3fb81f22666dbb013aa8ed07604f999d2fe", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-05-05T16:35:23Z", "type": "commit"}, {"oid": "3201a274cba9ecb9a3752162ad5e2b5a72b360e6", "url": "https://github.com/elastic/elasticsearch/commit/3201a274cba9ecb9a3752162ad5e2b5a72b360e6", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-05-05T16:35:31Z", "type": "commit"}, {"oid": "729c1dbe82bd49f9058761d57a548f6a622bd14e", "url": "https://github.com/elastic/elasticsearch/commit/729c1dbe82bd49f9058761d57a548f6a622bd14e", "message": "Merge branch 'master' into nodes5", "committedDate": "2020-05-06T16:53:29Z", "type": "commit"}, {"oid": "c50c2ce955a2742df50d7522510f51e8855f42ed", "url": "https://github.com/elastic/elasticsearch/commit/c50c2ce955a2742df50d7522510f51e8855f42ed", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-05-06T16:53:47Z", "type": "commit"}, {"oid": "4c25b66fba923701651e21ceaeac08834e90b5d5", "url": "https://github.com/elastic/elasticsearch/commit/4c25b66fba923701651e21ceaeac08834e90b5d5", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-05-06T16:54:07Z", "type": "commit"}, {"oid": "680a8b32d49ee9d9e8c349b6b98bf440ca0c0d07", "url": "https://github.com/elastic/elasticsearch/commit/680a8b32d49ee9d9e8c349b6b98bf440ca0c0d07", "message": "remove unnecessary test code from Walker", "committedDate": "2020-05-06T17:31:55Z", "type": "commit"}, {"oid": "394cf2fa4386f5443a9c1a2e75434dd03063117a", "url": "https://github.com/elastic/elasticsearch/commit/394cf2fa4386f5443a9c1a2e75434dd03063117a", "message": "fix imports", "committedDate": "2020-05-06T17:59:43Z", "type": "commit"}, {"oid": "6b429c66512befbd1fadb82285679b19378a8e84", "url": "https://github.com/elastic/elasticsearch/commit/6b429c66512befbd1fadb82285679b19378a8e84", "message": "remove more dead code", "committedDate": "2020-05-06T22:12:46Z", "type": "commit"}, {"oid": "a9753af0cbc6f6b52295afc4e5ba5e17e4c9799a", "url": "https://github.com/elastic/elasticsearch/commit/a9753af0cbc6f6b52295afc4e5ba5e17e4c9799a", "message": "Merge branch 'master' into nodes5", "committedDate": "2020-05-07T15:37:21Z", "type": "commit"}, {"oid": "77bb1df417baf81f2673d54fd28e89581152d4c8", "url": "https://github.com/elastic/elasticsearch/commit/77bb1df417baf81f2673d54fd28e89581152d4c8", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-05-07T15:37:27Z", "type": "commit"}, {"oid": "9106ae5756e688351f69a96ba2b53f0c71d88b09", "url": "https://github.com/elastic/elasticsearch/commit/9106ae5756e688351f69a96ba2b53f0c71d88b09", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-05-07T15:37:37Z", "type": "commit"}, {"oid": "9791782411ec75c7236a92a642cee803847f8bb5", "url": "https://github.com/elastic/elasticsearch/commit/9791782411ec75c7236a92a642cee803847f8bb5", "message": "Merge branch 'master' into nodes5", "committedDate": "2020-05-11T17:33:14Z", "type": "commit"}, {"oid": "a2bbf6bec4530d4bd680a45c602647ab3514ca55", "url": "https://github.com/elastic/elasticsearch/commit/a2bbf6bec4530d4bd680a45c602647ab3514ca55", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-05-11T17:33:31Z", "type": "commit"}, {"oid": "86fe756fc1f4760b336e42ffa922e9de1d9c61fe", "url": "https://github.com/elastic/elasticsearch/commit/86fe756fc1f4760b336e42ffa922e9de1d9c61fe", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-05-11T17:33:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk4ODQ1Mg==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r423988452", "bodyText": "Why is INCR and DECR removed here?", "author": "stu-elastic", "createdAt": "2020-05-12T19:42:26Z", "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/Operation.java", "diffHunk": "@@ -51,9 +51,7 @@\n     EQ      ( \"==\"  , \"equals\"                 ),\n     EQR     ( \"===\" , \"reference equals\"       ),\n     NE      ( \"!=\"  , \"not equals\"             ),\n-    NER     ( \"!==\" , \"reference not equals\"   ),\n-    INCR    ( \"++\"  , \"increment\"              ),\n-    DECR    ( \"--\"  , \"decrement\"              );\n+    NER     ( \"!==\" , \"reference not equals\"   );", "originalCommit": "86fe756fc1f4760b336e42ffa922e9de1d9c61fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY0OTk1NQ==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r424649955", "bodyText": "These are replaced with ADD/SUB and the Walker adds a constant of 1 in the appropriate places. The Painless user tree does not need to know about these natively since they are a shortcut. It only needs to know if a value from a variable being assigned to must be read from before or after the assignment.", "author": "jdconrad", "createdAt": "2020-05-13T18:35:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk4ODQ1Mg=="}], "type": "inlineReview", "revised_code": {"commit": "941d762d2da55dce4add0a69cb58791c11c54650", "chunk": "diff --git a/modules/lang-painless/src/main/java/org/elasticsearch/painless/Operation.java b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Operation.java\nindex 6171a671606..f6d0442c011 100644\n--- a/modules/lang-painless/src/main/java/org/elasticsearch/painless/Operation.java\n+++ b/modules/lang-painless/src/main/java/org/elasticsearch/painless/Operation.java\n\n@@ -51,7 +51,9 @@ public enum Operation {\n     EQ      ( \"==\"  , \"equals\"                 ),\n     EQR     ( \"===\" , \"reference equals\"       ),\n     NE      ( \"!=\"  , \"not equals\"             ),\n-    NER     ( \"!==\" , \"reference not equals\"   );\n+    NER     ( \"!==\" , \"reference not equals\"   ),\n+    INCR    ( \"++\"  , \"increment\"              ),\n+    DECR    ( \"--\"  , \"decrement\"              );\n \n     public final String symbol;\n     public final String name;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5MDAxMw==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r423990013", "bodyText": "Why was this moved?", "author": "stu-elastic", "createdAt": "2020-05-12T19:45:36Z", "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/antlr/Walker.java", "diffHunk": "@@ -627,12 +629,25 @@ public ANode visitBool(BoolContext ctx) {\n         } else if (ctx.BOOLOR() != null) {\n             operation = Operation.OR;\n         } else {\n-            throw location(ctx).createError(new IllegalStateException(\"Illegal tree structure.\"));\n+            throw location(ctx).createError(new IllegalStateException(\"illegal tree structure\"));\n         }\n \n         return new EBool(location(ctx), operation, left, right);\n     }\n \n+    @Override\n+    public ANode visitElvis(ElvisContext ctx) {", "originalCommit": "86fe756fc1f4760b336e42ffa922e9de1d9c61fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1MDEwMA==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r424650100", "bodyText": "Rules got moved around here to stay in line with the ordering in the grammar.", "author": "jdconrad", "createdAt": "2020-05-13T18:36:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5MDAxMw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5NzI1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r423997259", "bodyText": "Say you have a variable with same as package name, eg java, what happens?", "author": "stu-elastic", "createdAt": "2020-05-12T19:58:54Z", "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/node/EVariable.java", "diffHunk": "@@ -43,27 +45,52 @@ public EVariable(Location location, String name) {\n \n     @Override\n     Output analyze(ClassNode classNode, ScriptRoot scriptRoot, Scope scope, Input input) {\n-        if (input.read == false && input.write == false) {\n-            throw createError(new IllegalArgumentException(\"not a statement: variable [\" + name + \"] not used\"));\n-        }\n-\n         Output output = new Output();\n+        Class<?> type = scriptRoot.getPainlessLookup().canonicalTypeNameToType(name);\n \n-        Variable variable = scope.getVariable(location, name);\n+        if (type != null)  {\n+            if (input.write) {\n+                throw createError(new IllegalArgumentException(\"invalid assignment: \" +\n+                        \"cannot write a value to a static type [\" + PainlessLookupUtility.typeToCanonicalTypeName(type) + \"]\"));\n+            }\n \n-        if (input.write && variable.isFinal()) {\n-            throw createError(new IllegalArgumentException(\"Variable [\" + variable.getName() + \"] is read-only.\"));\n-        }\n+            if (input.read == false) {\n+                throw createError(new IllegalArgumentException(\"not a statement: \" +\n+                        \"static type [\" + PainlessLookupUtility.typeToCanonicalTypeName(type) + \"] not used\"));\n+            }\n+\n+            output.actual = type;\n+            output.isStaticType = true;\n+\n+            StaticNode staticNode = new StaticNode();\n \n-        output.actual = variable.getType();\n+            staticNode.setLocation(location);\n+            staticNode.setExpressionType(output.actual);\n \n-        VariableNode variableNode = new VariableNode();\n+            output.expressionNode = staticNode;\n+        } else if (scope.isVariableDefined(name)) {", "originalCommit": "86fe756fc1f4760b336e42ffa922e9de1d9c61fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5Nzc2Nw==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r423997767", "bodyText": "eg def java = 1; java.lang.Integer", "author": "stu-elastic", "createdAt": "2020-05-12T19:59:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5NzI1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1NDcwMQ==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r424654701", "bodyText": "This int java; java.util.Integer.parseInt('1') results in an error since the java package name is overridden by a variable name.\nThis int java; java.util.ArrayList x = new java.util.ArrayList() is successful as our parser can recognize that declarations must be a type, so it uses a different parsing path based on the rules.\nThis int java; List x = new java.util.ArrayList(); ArrayList y; y = (java.util.ArrayList)x; is successful for the same reasons as the previous example, but for casting a reference type.\nThese all follow similar behavior to Java with error messages differing based on our use cases.", "author": "jdconrad", "createdAt": "2020-05-13T18:44:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5NzI1OQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5ODY0NA==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r423998644", "bodyText": "Is there any possibility of a partial name triggering type != null? eg. java.util.HashMap.abc123.", "author": "stu-elastic", "createdAt": "2020-05-12T20:01:17Z", "path": "modules/lang-painless/src/main/java/org/elasticsearch/painless/node/EVariable.java", "diffHunk": "@@ -43,27 +45,52 @@ public EVariable(Location location, String name) {\n \n     @Override\n     Output analyze(ClassNode classNode, ScriptRoot scriptRoot, Scope scope, Input input) {\n-        if (input.read == false && input.write == false) {\n-            throw createError(new IllegalArgumentException(\"not a statement: variable [\" + name + \"] not used\"));\n-        }\n-\n         Output output = new Output();\n+        Class<?> type = scriptRoot.getPainlessLookup().canonicalTypeNameToType(name);", "originalCommit": "86fe756fc1f4760b336e42ffa922e9de1d9c61fe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY1MDkwNA==", "url": "https://github.com/elastic/elasticsearch/pull/56293#discussion_r424650904", "bodyText": "Tests should cover all use cases of this particular corner case. This should always result in a compiler error - \"not a symbol\"", "author": "jdconrad", "createdAt": "2020-05-13T18:37:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzk5ODY0NA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "9c67ee16ac9d5d8cb20be5ff5680e4c4472f4311", "url": "https://github.com/elastic/elasticsearch/commit/9c67ee16ac9d5d8cb20be5ff5680e4c4472f4311", "message": "fixed lexer spacing", "committedDate": "2020-05-13T18:48:20Z", "type": "commit"}, {"oid": "941d762d2da55dce4add0a69cb58791c11c54650", "url": "https://github.com/elastic/elasticsearch/commit/941d762d2da55dce4add0a69cb58791c11c54650", "message": "Merge branch 'master' into nodes5", "committedDate": "2020-05-13T20:09:01Z", "type": "commit"}, {"oid": "a378ad56d918b1d1bd40354d08423193008f7313", "url": "https://github.com/elastic/elasticsearch/commit/a378ad56d918b1d1bd40354d08423193008f7313", "message": "Merge branch 'nodes5' into nodes6", "committedDate": "2020-05-13T20:09:06Z", "type": "commit"}, {"oid": "1c2c1851fdd5d48b3a06b304f703364041c01e9a", "url": "https://github.com/elastic/elasticsearch/commit/1c2c1851fdd5d48b3a06b304f703364041c01e9a", "message": "Merge branch 'nodes6' into semantic0", "committedDate": "2020-05-13T20:09:13Z", "type": "commit"}]}