{"pr_number": 58056, "pr_title": "Fix Running TranslogOps on CS Thread", "pr_createdAt": "2020-06-12T15:05:37Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/58056", "timeline": [{"oid": "1daee47e8541425645e8eddc74bb5a732b14cdff", "url": "https://github.com/elastic/elasticsearch/commit/1daee47e8541425645e8eddc74bb5a732b14cdff", "message": "Fix Running TranslogOps on CS Thread\n\nWe should fork off from the CS thread to run this even if it's a rare\ncondition.", "committedDate": "2020-06-12T15:03:52Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ3NjM3MA==", "url": "https://github.com/elastic/elasticsearch/pull/58056#discussion_r439476370", "bodyText": "Could also go for the write pool here (as suggested in #58018) but I figured I wouldn't change that in this PR.", "author": "original-brownbear", "createdAt": "2020-06-12T15:06:35Z", "path": "server/src/main/java/org/elasticsearch/indices/recovery/PeerRecoveryTargetService.java", "diffHunk": "@@ -366,13 +367,11 @@ private void performTranslogOps(final RecoveryTranslogOperationsRequest request,\n                 observer.waitForNextChange(new ClusterStateObserver.Listener() {\n                     @Override\n                     public void onNewClusterState(ClusterState state) {\n-                        try {\n+                        threadPool.generic().execute(ActionRunnable.wrap(listener, l -> {", "originalCommit": "1daee47e8541425645e8eddc74bb5a732b14cdff", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ4MDMyNw==", "url": "https://github.com/elastic/elasticsearch/pull/58056#discussion_r439480327", "bodyText": "+1", "author": "dnhatn", "createdAt": "2020-06-12T15:13:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTQ3NjM3MA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "557f3c1180142205008cf36324391752dd7f9c67", "url": "https://github.com/elastic/elasticsearch/commit/557f3c1180142205008cf36324391752dd7f9c67", "message": "Merge remote-tracking branch 'elastic/master' into fix-writes-on-cs-applier", "committedDate": "2020-06-12T18:35:59Z", "type": "commit"}]}