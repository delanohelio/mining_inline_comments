{"pr_number": 63587, "pr_title": "[ML] Allow setting num_top_classes to a special value -1", "pr_createdAt": "2020-10-13T06:27:57Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63587", "timeline": [{"oid": "0ccd769032f0a706418f08da3dbcfb8eff545aab", "url": "https://github.com/elastic/elasticsearch/commit/0ccd769032f0a706418f08da3dbcfb8eff545aab", "message": "Allow setting num_top_classes to a special value -1", "committedDate": "2020-10-13T06:20:43Z", "type": "commit"}, {"oid": "110a19ce028052325dc5da958ad7a662f5a89bcf", "url": "https://github.com/elastic/elasticsearch/commit/110a19ce028052325dc5da958ad7a662f5a89bcf", "message": "Fix yml tests", "committedDate": "2020-10-13T07:36:10Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc0MzQ1OQ==", "url": "https://github.com/elastic/elasticsearch/pull/63587#discussion_r503743459", "bodyText": "Why was this changed?", "author": "dimitris-athanasiou", "createdAt": "2020-10-13T07:57:39Z", "path": "client/rest-high-level/src/test/java/org/elasticsearch/client/ml/dataframe/ClassificationTests.java", "diffHunk": "@@ -42,7 +42,7 @@ public static Classification randomClassification() {\n             .setEta(randomBoolean() ? null : randomDoubleBetween(0.001, 1.0, true))\n             .setMaxTrees(randomBoolean() ? null : randomIntBetween(1, 2000))\n             .setFeatureBagFraction(randomBoolean() ? null : randomDoubleBetween(0.0, 1.0, false))\n-            .setNumTopFeatureImportanceValues(randomBoolean() ? null : randomIntBetween(0, Integer.MAX_VALUE))\n+            .setNumTopFeatureImportanceValues(randomBoolean() ? null : randomInt())", "originalCommit": "110a19ce028052325dc5da958ad7a662f5a89bcf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc0NTkxMg==", "url": "https://github.com/elastic/elasticsearch/pull/63587#discussion_r503745912", "bodyText": "I wanted the client code to be able to pass -1 value through.", "author": "przemekwitek", "createdAt": "2020-10-13T08:01:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc0MzQ1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3MDk1MA==", "url": "https://github.com/elastic/elasticsearch/pull/63587#discussion_r503770950", "bodyText": "But this is for numTopFeatureImportanceValues.", "author": "dimitris-athanasiou", "createdAt": "2020-10-13T08:39:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc0MzQ1OQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc3NTMxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/63587#discussion_r503775319", "bodyText": "Ooops, shame on me :(\nFixed.", "author": "przemekwitek", "createdAt": "2020-10-13T08:45:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMzc0MzQ1OQ=="}], "type": "inlineReview", "revised_code": {"commit": "c8a8ac254883442a33297e7f76e62db972d73941", "chunk": "diff --git a/client/rest-high-level/src/test/java/org/elasticsearch/client/ml/dataframe/ClassificationTests.java b/client/rest-high-level/src/test/java/org/elasticsearch/client/ml/dataframe/ClassificationTests.java\nindex e667fc9e44d..7f98827446d 100644\n--- a/client/rest-high-level/src/test/java/org/elasticsearch/client/ml/dataframe/ClassificationTests.java\n+++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/ml/dataframe/ClassificationTests.java\n\n@@ -42,12 +42,12 @@ public class ClassificationTests extends AbstractXContentTestCase<Classification\n             .setEta(randomBoolean() ? null : randomDoubleBetween(0.001, 1.0, true))\n             .setMaxTrees(randomBoolean() ? null : randomIntBetween(1, 2000))\n             .setFeatureBagFraction(randomBoolean() ? null : randomDoubleBetween(0.0, 1.0, false))\n-            .setNumTopFeatureImportanceValues(randomBoolean() ? null : randomInt())\n+            .setNumTopFeatureImportanceValues(randomBoolean() ? null : randomIntBetween(0, Integer.MAX_VALUE))\n             .setPredictionFieldName(randomBoolean() ? null : randomAlphaOfLength(10))\n             .setTrainingPercent(randomBoolean() ? null : randomDoubleBetween(1.0, 100.0, true))\n             .setRandomizeSeed(randomBoolean() ? null : randomLong())\n             .setClassAssignmentObjective(randomBoolean() ? null : randomFrom(Classification.ClassAssignmentObjective.values()))\n-            .setNumTopClasses(randomBoolean() ? null : randomIntBetween(0, 10))\n+            .setNumTopClasses(randomBoolean() ? null : randomInt())\n             .setFeatureProcessors(randomBoolean() ? null :\n                 Stream.generate(() -> randomFrom(FrequencyEncodingTests.createRandom(),\n                     OneHotEncodingTests.createRandom(),\n"}}, {"oid": "3eae4c1c830a5273c2c53ddb9b6aa025c31c64cf", "url": "https://github.com/elastic/elasticsearch/commit/3eae4c1c830a5273c2c53ddb9b6aa025c31c64cf", "message": "Fix yml test name in build.gradle", "committedDate": "2020-10-13T08:21:37Z", "type": "commit"}, {"oid": "c8a8ac254883442a33297e7f76e62db972d73941", "url": "https://github.com/elastic/elasticsearch/commit/c8a8ac254883442a33297e7f76e62db972d73941", "message": "Apply review comment", "committedDate": "2020-10-13T08:44:31Z", "type": "commit"}, {"oid": "1602d132794035831a1be2c9af55bab00e8d2be7", "url": "https://github.com/elastic/elasticsearch/commit/1602d132794035831a1be2c9af55bab00e8d2be7", "message": "Make unit tests for server and client consistent", "committedDate": "2020-10-13T09:27:40Z", "type": "commit"}, {"oid": "f140764d01840e4eff224129f5aa5aead24b2b3e", "url": "https://github.com/elastic/elasticsearch/commit/f140764d01840e4eff224129f5aa5aead24b2b3e", "message": "Explain the special value of -1 in the docs", "committedDate": "2020-10-13T10:08:05Z", "type": "commit"}]}