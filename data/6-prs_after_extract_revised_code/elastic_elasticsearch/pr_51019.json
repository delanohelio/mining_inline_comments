{"pr_number": 51019, "pr_title": "Encrypt generated key with AES", "pr_createdAt": "2020-01-15T04:19:44Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/51019", "timeline": [{"oid": "8214f91b9edb47a848ee42f1d4d293c1e08d4fa2", "url": "https://github.com/elastic/elasticsearch/commit/8214f91b9edb47a848ee42f1d4d293c1e08d4fa2", "message": "Encrypt generated cert with AES\n\nReplace DES with AES to align with modern encryption standards\n\nResolves: #50843", "committedDate": "2020-01-15T04:14:09Z", "type": "commit"}, {"oid": "f5226686f389236fd41782e5c8dbb5c91cfe344f", "url": "https://github.com/elastic/elasticsearch/commit/f5226686f389236fd41782e5c8dbb5c91cfe344f", "message": "Add test to ensure AES is in use", "committedDate": "2020-01-15T05:47:00Z", "type": "commit"}, {"oid": "e743710a8aa7c32925e5340f02171e72d27d871a", "url": "https://github.com/elastic/elasticsearch/commit/e743710a8aa7c32925e5340f02171e72d27d871a", "message": "Fix key content check failure due to randomness", "committedDate": "2020-01-15T06:08:17Z", "type": "commit"}, {"oid": "340b623fab6aeea0728de570168a0817c886e67e", "url": "https://github.com/elastic/elasticsearch/commit/340b623fab6aeea0728de570168a0817c886e67e", "message": "Document the empty catch block", "committedDate": "2020-01-15T07:16:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjcyNjA4NQ==", "url": "https://github.com/elastic/elasticsearch/pull/51019#discussion_r366726085", "bodyText": "For completeness, can we also\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        }\n          \n          \n            \n                        } else {\n          \n          \n            \n                           assertFalse(Files.readString(keyFile).contains(\"DEK-Info:\"));\n          \n          \n            \n                        }", "author": "tvernum", "createdAt": "2020-01-15T07:27:00Z", "path": "x-pack/plugin/security/cli/src/test/java/org/elasticsearch/xpack/security/cli/CertificateToolTests.java", "diffHunk": "@@ -368,7 +380,11 @@ public void testGeneratingSignedPemCertificates() throws Exception {\n             assertTrue(Files.exists(zipRoot.resolve(filename)));\n             final Path cert = zipRoot.resolve(filename + \"/\" + filename + \".crt\");\n             assertTrue(Files.exists(cert));\n-            assertTrue(Files.exists(zipRoot.resolve(filename + \"/\" + filename + \".key\")));\n+            Path keyFile = zipRoot.resolve(filename + \"/\" + filename + \".key\");\n+            assertTrue(Files.exists(keyFile));\n+            if (keyPassword != null) {\n+                assertTrue(Files.readString(keyFile).contains(\"DEK-Info: AES-128-CBC\"));\n+            }", "originalCommit": "340b623fab6aeea0728de570168a0817c886e67e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "34a605a40b21818e5a623ef03a4b0525844f3451", "chunk": "diff --git a/x-pack/plugin/security/cli/src/test/java/org/elasticsearch/xpack/security/cli/CertificateToolTests.java b/x-pack/plugin/security/cli/src/test/java/org/elasticsearch/xpack/security/cli/CertificateToolTests.java\nindex cf67fc62aa7..21a8440a700 100644\n--- a/x-pack/plugin/security/cli/src/test/java/org/elasticsearch/xpack/security/cli/CertificateToolTests.java\n+++ b/x-pack/plugin/security/cli/src/test/java/org/elasticsearch/xpack/security/cli/CertificateToolTests.java\n\n@@ -384,6 +384,8 @@ public class CertificateToolTests extends ESTestCase {\n             assertTrue(Files.exists(keyFile));\n             if (keyPassword != null) {\n                 assertTrue(Files.readString(keyFile).contains(\"DEK-Info: AES-128-CBC\"));\n+            } else {\n+                assertFalse(Files.readString(keyFile).contains(\"DEK-Info:\"));\n             }\n             final Path p12 = zipRoot.resolve(filename + \"/\" + filename + \".p12\");\n             try (InputStream input = Files.newInputStream(cert)) {\n"}}, {"oid": "34a605a40b21818e5a623ef03a4b0525844f3451", "url": "https://github.com/elastic/elasticsearch/commit/34a605a40b21818e5a623ef03a4b0525844f3451", "message": "Add else block to complete text content test", "committedDate": "2020-01-15T08:06:48Z", "type": "commit"}]}