{"pr_number": 61062, "pr_title": "Introduce point in time APIs in x-pack basic", "pr_createdAt": "2020-08-12T18:59:26Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/61062", "timeline": [{"oid": "314a5963ee298738e4ecbc1a379f59c694b5f8be", "url": "https://github.com/elastic/elasticsearch/commit/314a5963ee298738e4ecbc1a379f59c694b5f8be", "message": "Introduce search context\n\nCo-authored-by: Jim Ferenczi <jimczi@apache.org>", "committedDate": "2020-08-12T18:03:32Z", "type": "commit"}, {"oid": "d92aa92c02b30a9771298ba025e818e1137293ba", "url": "https://github.com/elastic/elasticsearch/commit/d92aa92c02b30a9771298ba025e818e1137293ba", "message": "changes", "committedDate": "2020-08-12T19:36:04Z", "type": "commit"}, {"oid": "b44dc0adc7496e2c81377f6b6aa76cc2a8347e27", "url": "https://github.com/elastic/elasticsearch/commit/b44dc0adc7496e2c81377f6b6aa76cc2a8347e27", "message": "fix doc", "committedDate": "2020-08-12T20:59:55Z", "type": "commit"}, {"oid": "6ed217afb2d01d8e4bf285056e8c6df13ce9b8cb", "url": "https://github.com/elastic/elasticsearch/commit/6ed217afb2d01d8e4bf285056e8c6df13ce9b8cb", "message": "Merge branch 'master' into search-context", "committedDate": "2020-08-17T17:03:59Z", "type": "commit"}, {"oid": "136bf341c587303071df1d6ce47dd78efb09d513", "url": "https://github.com/elastic/elasticsearch/commit/136bf341c587303071df1d6ce47dd78efb09d513", "message": "search context -> point in time", "committedDate": "2020-08-17T19:39:43Z", "type": "commit"}, {"oid": "43b9dadc740e25cccac3928acb2709c7ab554f37", "url": "https://github.com/elastic/elasticsearch/commit/43b9dadc740e25cccac3928acb2709c7ab554f37", "message": "fix rest test", "committedDate": "2020-08-17T21:10:35Z", "type": "commit"}, {"oid": "dcbe3e33160e18591998a57073fb346858c6d34b", "url": "https://github.com/elastic/elasticsearch/commit/dcbe3e33160e18591998a57073fb346858c6d34b", "message": "validate only scroll and multi session point in time", "committedDate": "2020-08-19T21:16:06Z", "type": "commit"}, {"oid": "64537547f358c099fd23137c8ea421a6620480fe", "url": "https://github.com/elastic/elasticsearch/commit/64537547f358c099fd23137c8ea421a6620480fe", "message": "handle point-in-time related request in RBACEngine", "committedDate": "2020-08-20T14:05:47Z", "type": "commit"}, {"oid": "ff38a8a287c26c6355f8174fc0cdc23dc85203b4", "url": "https://github.com/elastic/elasticsearch/commit/ff38a8a287c26c6355f8174fc0cdc23dc85203b4", "message": "Merge branch 'master' into search-context", "committedDate": "2020-08-20T14:06:26Z", "type": "commit"}, {"oid": "af02abf36c62f8843f5bdd6b5ca34743cf70abd0", "url": "https://github.com/elastic/elasticsearch/commit/af02abf36c62f8843f5bdd6b5ca34743cf70abd0", "message": "combine scroll and point-in-time", "committedDate": "2020-08-20T14:28:08Z", "type": "commit"}, {"oid": "d4d902b68fc5e3d64a35b071a3e80732637a83e8", "url": "https://github.com/elastic/elasticsearch/commit/d4d902b68fc5e3d64a35b071a3e80732637a83e8", "message": "Revert \"combine scroll and point-in-time\"", "committedDate": "2020-08-20T19:54:21Z", "type": "commit"}, {"oid": "2ba21139b6bd4edaee1fd66bac47e4832e9a7ac4", "url": "https://github.com/elastic/elasticsearch/commit/2ba21139b6bd4edaee1fd66bac47e4832e9a7ac4", "message": "pass NamedWriteableRegistry to NodeClient", "committedDate": "2020-08-20T21:18:23Z", "type": "commit"}, {"oid": "8a7eb6af57f993ccebbc8fd89ac16bb2050270ef", "url": "https://github.com/elastic/elasticsearch/commit/8a7eb6af57f993ccebbc8fd89ac16bb2050270ef", "message": "override indices of search request if point-in-time specified", "committedDate": "2020-08-20T21:20:52Z", "type": "commit"}, {"oid": "fa4b4c6ef07161b6be163c44c7d21e59efa9fab5", "url": "https://github.com/elastic/elasticsearch/commit/fa4b4c6ef07161b6be163c44c7d21e59efa9fab5", "message": "validate scroll request only", "committedDate": "2020-08-20T21:33:03Z", "type": "commit"}, {"oid": "12429acda00c623f4ac95c21dce717ff128d587b", "url": "https://github.com/elastic/elasticsearch/commit/12429acda00c623f4ac95c21dce717ff128d587b", "message": "Merge branch 'master' into search-context", "committedDate": "2020-08-20T21:40:08Z", "type": "commit"}, {"oid": "289766068c391b27e3f71407cad5d58b5b3f596e", "url": "https://github.com/elastic/elasticsearch/commit/289766068c391b27e3f71407cad5d58b5b3f596e", "message": "fix test", "committedDate": "2020-08-20T22:11:18Z", "type": "commit"}, {"oid": "0a454de0c5b6e084626d0b47cdc80e55c53f13d2", "url": "https://github.com/elastic/elasticsearch/commit/0a454de0c5b6e084626d0b47cdc80e55c53f13d2", "message": "fix test", "committedDate": "2020-08-20T23:39:31Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU5NDg4MA==", "url": "https://github.com/elastic/elasticsearch/pull/61062#discussion_r475594880", "bodyText": "Is this condition still required, given RestSearchAction#preparePointInTime?", "author": "albertzaharovits", "createdAt": "2020-08-24T13:21:43Z", "path": "server/src/main/java/org/elasticsearch/action/search/TransportSearchAction.java", "diffHunk": "@@ -212,18 +283,27 @@ protected void doExecute(Task task, SearchRequest searchRequest, ActionListener<\n                 // situations when source is rewritten to null due to a bug\n                 searchRequest.source(source);\n             }\n-            final ClusterState clusterState = clusterService.state();\n-            final Map<String, OriginalIndices> remoteClusterIndices = remoteClusterService.groupIndices(searchRequest.indicesOptions(),\n-                searchRequest.indices());\n+            final SearchContextId searchContext;\n+            final Map<String, OriginalIndices> remoteClusterIndices;\n+            if (searchRequest.pointInTimeBuilder() != null) {", "originalCommit": "0a454de0c5b6e084626d0b47cdc80e55c53f13d2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTY0Njc4OA==", "url": "https://github.com/elastic/elasticsearch/pull/61062#discussion_r475646788", "bodyText": "We still need this condition. We can execute a search with or without the \"pit\" parameter.", "author": "dnhatn", "createdAt": "2020-08-24T14:18:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTU5NDg4MA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "aa15e5dd65ed550eb761387f40b0ee1d9e7f0483", "url": "https://github.com/elastic/elasticsearch/commit/aa15e5dd65ed550eb761387f40b0ee1d9e7f0483", "message": "Merge branch 'master' into search-context", "committedDate": "2020-08-24T13:39:20Z", "type": "commit"}, {"oid": "14c828891736b3298302c7d0ce8465c5479e8263", "url": "https://github.com/elastic/elasticsearch/commit/14c828891736b3298302c7d0ce8465c5479e8263", "message": "Fix rescore docIds", "committedDate": "2020-08-24T17:39:31Z", "type": "commit"}]}