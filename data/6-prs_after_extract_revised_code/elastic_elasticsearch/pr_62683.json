{"pr_number": 62683, "pr_title": "Override needsScore() on ValueCountAggregator", "pr_createdAt": "2020-09-21T07:42:30Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/62683", "timeline": [{"oid": "0adfa7ab5b80eff10cca20c7e9842cc8bad2e564", "url": "https://github.com/elastic/elasticsearch/commit/0adfa7ab5b80eff10cca20c7e9842cc8bad2e564", "message": "override needsScore() on ValueCountAggregator", "committedDate": "2020-09-21T07:34:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg2MTU0OA==", "url": "https://github.com/elastic/elasticsearch/pull/62683#discussion_r491861548", "bodyText": "Note that this construct seems to be used by all NumericMetricsAggregator, I winder if we can move it to the parent class?", "author": "iverase", "createdAt": "2020-09-21T08:14:28Z", "path": "server/src/main/java/org/elasticsearch/search/aggregations/metrics/ValueCountAggregator.java", "diffHunk": "@@ -125,6 +126,11 @@ public InternalAggregation buildAggregation(long bucket) {\n         return new InternalValueCount(name, counts.get(bucket), metadata());\n     }\n \n+    @Override\n+    public ScoreMode scoreMode() {\n+        return valuesSource != null && valuesSource.needsScores() ? ScoreMode.COMPLETE : ScoreMode.COMPLETE_NO_SCORES;\n+    }\n+", "originalCommit": "0adfa7ab5b80eff10cca20c7e9842cc8bad2e564", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjA2OTI5Mg==", "url": "https://github.com/elastic/elasticsearch/pull/62683#discussion_r492069292", "bodyText": "Probably!", "author": "nik9000", "createdAt": "2020-09-21T14:02:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTg2MTU0OA=="}], "type": "inlineReview", "revised_code": null}]}