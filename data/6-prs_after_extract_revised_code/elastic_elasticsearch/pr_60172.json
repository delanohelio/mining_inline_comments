{"pr_number": 60172, "pr_title": "Let `isInetAddress` utility understand the scope ID on ipv6", "pr_createdAt": "2020-07-24T15:15:03Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/60172", "timeline": [{"oid": "daf398b7bc20ef5e1509404d4911e4f0ecbf7b8b", "url": "https://github.com/elastic/elasticsearch/commit/daf398b7bc20ef5e1509404d4911e4f0ecbf7b8b", "message": "let isInetAddress utility understand the scope ID on ipv6", "committedDate": "2020-07-24T15:06:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDU2ODc0NQ==", "url": "https://github.com/elastic/elasticsearch/pull/60172#discussion_r460568745", "bodyText": "should we make sure that we have something after the % in the string and maybe return null if percentIndex == ipString.length() - 1 because that wouldn't be a valid address would it?\nUnless you disagree with filtering this case out, could you also add a test for it when adding this check?", "author": "original-brownbear", "createdAt": "2020-07-26T20:16:28Z", "path": "server/src/main/java/org/elasticsearch/common/network/InetAddresses.java", "diffHunk": "@@ -60,6 +64,9 @@ public static boolean isInetAddress(String ipString) {\n                     return null;\n                 }\n             }\n+            if (percentIndex != -1) {", "originalCommit": "daf398b7bc20ef5e1509404d4911e4f0ecbf7b8b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "de696bc5db88840fad80d271e4222724afa3f64c", "chunk": "diff --git a/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java b/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java\nindex de0f140cc4f..32f2858bd4b 100644\n--- a/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java\n+++ b/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java\n\n@@ -64,6 +64,9 @@ public class InetAddresses {\n                     return null;\n                 }\n             }\n+            if (percentIndex == ipString.length() - 1) {\n+                return null;\n+            }\n             if (percentIndex != -1) {\n                ipString = ipString.substring(0, percentIndex);\n             }\n"}}, {"oid": "4a006dc4c7701b2b8bf41a8d79be21cb06209800", "url": "https://github.com/elastic/elasticsearch/commit/4a006dc4c7701b2b8bf41a8d79be21cb06209800", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-07-27T14:00:11Z", "type": "commit"}, {"oid": "de696bc5db88840fad80d271e4222724afa3f64c", "url": "https://github.com/elastic/elasticsearch/commit/de696bc5db88840fad80d271e4222724afa3f64c", "message": "Let  utility understand the scope ID on ipv6", "committedDate": "2020-07-27T14:36:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MTA2NjMzNg==", "url": "https://github.com/elastic/elasticsearch/pull/60172#discussion_r461066336", "bodyText": "Let's add a comment here that explains that we are doing this check to filter out strings that end in % and have an empty scope ID.", "author": "original-brownbear", "createdAt": "2020-07-27T17:53:20Z", "path": "server/src/main/java/org/elasticsearch/common/network/InetAddresses.java", "diffHunk": "@@ -60,6 +64,12 @@ public static boolean isInetAddress(String ipString) {\n                     return null;\n                 }\n             }\n+            if (percentIndex == ipString.length() - 1) {\n+                return null;", "originalCommit": "de696bc5db88840fad80d271e4222724afa3f64c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3d6446e361be6cdc7760053e5e0d38893c4b8f97", "chunk": "diff --git a/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java b/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java\nindex 32f2858bd4b..8e85b326177 100644\n--- a/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java\n+++ b/server/src/main/java/org/elasticsearch/common/network/InetAddresses.java\n\n@@ -65,7 +65,7 @@ public class InetAddresses {\n                 }\n             }\n             if (percentIndex == ipString.length() - 1) {\n-                return null;\n+                return null;  // Filter out strings that end in % and have an empty scope ID.\n             }\n             if (percentIndex != -1) {\n                ipString = ipString.substring(0, percentIndex);\n"}}, {"oid": "32b8ceca34c4bd8e3517b13bdb403fb9e4a01c09", "url": "https://github.com/elastic/elasticsearch/commit/32b8ceca34c4bd8e3517b13bdb403fb9e4a01c09", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-07-28T00:22:03Z", "type": "commit"}, {"oid": "3d6446e361be6cdc7760053e5e0d38893c4b8f97", "url": "https://github.com/elastic/elasticsearch/commit/3d6446e361be6cdc7760053e5e0d38893c4b8f97", "message": "let isInetAddress utility understand the scope ID on ipv6", "committedDate": "2020-07-28T00:29:53Z", "type": "commit"}]}