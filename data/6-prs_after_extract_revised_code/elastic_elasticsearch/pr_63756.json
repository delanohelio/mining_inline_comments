{"pr_number": 63756, "pr_title": "Add APM configuration index to Kibana system indices", "pr_createdAt": "2020-10-15T15:36:47Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/63756", "timeline": [{"oid": "9c4ba614c60791f3fb176b616e98dd542f69c77e", "url": "https://github.com/elastic/elasticsearch/commit/9c4ba614c60791f3fb176b616e98dd542f69c77e", "message": "Add apm index to kibana system indices", "committedDate": "2020-10-14T21:07:24Z", "type": "commit"}, {"oid": "5c9970e8b062f7d68d7897f7f0459c9eb3270113", "url": "https://github.com/elastic/elasticsearch/commit/5c9970e8b062f7d68d7897f7f0459c9eb3270113", "message": "Parameterize kibana system index tests by index name", "committedDate": "2020-10-15T15:33:01Z", "type": "commit"}, {"oid": "c09a48a6f4d7495eb5656d80963bab06690cf770", "url": "https://github.com/elastic/elasticsearch/commit/c09a48a6f4d7495eb5656d80963bab06690cf770", "message": "Apply spotless", "committedDate": "2020-10-15T15:56:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc5NzU1Ng==", "url": "https://github.com/elastic/elasticsearch/pull/63756#discussion_r505797556", "bodyText": "Allow me to demonstrate my ignorance of our test infrastructure: Am I understanding correctly that this causes this suite to be run with each of these index names? Or does it run one, randomly out of the options?", "author": "gwbrown", "createdAt": "2020-10-15T19:46:31Z", "path": "modules/kibana/src/javaRestTest/java/org/elasticsearch/kibana/KibanaSystemIndexIT.java", "diffHunk": "@@ -27,25 +29,43 @@\n import org.elasticsearch.test.rest.ESRestTestCase;\n \n import java.io.IOException;\n+import java.util.Arrays;\n import java.util.Map;\n \n import static org.hamcrest.Matchers.containsString;\n import static org.hamcrest.Matchers.is;\n \n public class KibanaSystemIndexIT extends ESRestTestCase {\n \n+    private final String indexName;\n+\n+    public KibanaSystemIndexIT(@Name(\"indexName\") String indexName) {\n+        this.indexName = indexName;\n+    }\n+\n+    @ParametersFactory", "originalCommit": "c09a48a6f4d7495eb5656d80963bab06690cf770", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjQ2NjQ4MQ==", "url": "https://github.com/elastic/elasticsearch/pull/63756#discussion_r506466481", "bodyText": "It will run the test suite four times, once with each parameter. I believe we could adjust this method to return a random subset of the options if we wanted to cut the test time for this suite.\nWe could also, for example, add a boolean flag isKibanaSystemIndex as a second parameter and have the simpler tests verify that invalid patterns don't work with this API, while using assumeTrue to skip the more complex tests for those parameters.", "author": "williamrandolph", "createdAt": "2020-10-16T14:08:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc5NzU1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjYyMTYzOA==", "url": "https://github.com/elastic/elasticsearch/pull/63756#discussion_r506621638", "bodyText": "Cool, that's what I expected - I don't think we want to run it on a random subset, I'd rather have the coverage every run.\nI think for this case it's fine, but we probably want to be careful doing this for integration tests depending on whether our infra spins up 4 clusters to run the suite 4 times or something like that which might cause it to take extra time vs. just handling the parameters manually. I don't know enough to answer that off the top of my head, but something to look into. (Don't block this PR on that though)", "author": "gwbrown", "createdAt": "2020-10-16T17:31:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNTc5NzU1Ng=="}], "type": "inlineReview", "revised_code": null}, {"oid": "2a25c23943952a7374febe9fdf1567f2628d7699", "url": "https://github.com/elastic/elasticsearch/commit/2a25c23943952a7374febe9fdf1567f2628d7699", "message": "Merge branch 'master' into add-apm-to-kibana-system-indices", "committedDate": "2020-10-19T18:15:53Z", "type": "commit"}]}