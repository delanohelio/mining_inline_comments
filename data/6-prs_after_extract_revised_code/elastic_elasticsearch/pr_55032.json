{"pr_number": 55032, "pr_title": "EQL: Deprecate lenient sequence declaration", "pr_createdAt": "2020-04-09T21:17:49Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/55032", "timeline": [{"oid": "480320dbec2d96c04fd652cc79fb23e3d426798a", "url": "https://github.com/elastic/elasticsearch/commit/480320dbec2d96c04fd652cc79fb23e3d426798a", "message": "EQL: Deprecate lenient sequence declaration\n\nDeprecate alternative sequence parameter declaration (with then by)\nDisallow lack of time units inside maxspan\n\nFix #55023\nRelate #54680", "committedDate": "2020-04-09T21:12:22Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjUyOTg1Nw==", "url": "https://github.com/elastic/elasticsearch/pull/55032#discussion_r406529857", "bodyText": "I think for #54760, we'll need to add micros and nanos.", "author": "rw-access", "createdAt": "2020-04-09T23:25:46Z", "path": "x-pack/plugin/eql/src/main/java/org/elasticsearch/xpack/eql/parser/LogicalPlanBuilder.java", "diffHunk": "@@ -173,45 +178,40 @@ public TimeValue visitSequenceParams(SequenceParamsContext ctx) {\n             }\n             \n             String timeString = text(ctx.timeUnit().IDENTIFIER());\n-            TimeUnit timeUnit = TimeUnit.SECONDS;\n-            if (timeString != null) {\n-                switch (timeString) {\n-                    case \"\":\n-                    case \"s\":\n-                    case \"sec\":\n-                    case \"secs\":\n-                    case \"second\":\n-                    case \"seconds\":\n-                        timeUnit = TimeUnit.SECONDS;\n-                        break;\n-                    case \"m\":\n-                    case \"min\":\n-                    case \"mins\":\n-                    case \"minute\":\n-                    case \"minutes\":\n-                        timeUnit = TimeUnit.MINUTES;\n-                        break;\n-                    case \"h\":\n-                    case \"hs\":\n-                    case \"hour\":\n-                    case \"hours\":\n-                        timeUnit = TimeUnit.HOURS;\n-                        break;\n-                    case \"d\":\n-                    case \"ds\":\n-                    case \"day\":\n-                    case \"days\":\n-                        timeUnit = TimeUnit.DAYS;\n-                        break;\n-                    default:\n-                        throw new ParsingException(source(ctx.timeUnit().IDENTIFIER()), \"Unrecognized time unit [{}]\", timeString);\n-                }\n+            \n+            if (timeString == null) {\n+                throw new ParsingException(source(ctx.timeUnit()), \"No time unit specified, did you mean [s] as in [{}s]?\", text(ctx\n+                        .timeUnit()));\n+            }\n+            \n+            TimeUnit timeUnit = null;\n+            switch (timeString) {\n+                case \"ms\":\n+                    timeUnit = TimeUnit.MILLISECONDS;\n+                    break;\n+                case \"s\":\n+                    timeUnit = TimeUnit.SECONDS;\n+                    break;\n+                case \"m\":\n+                    timeUnit = TimeUnit.MINUTES;\n+                    break;\n+                case \"h\":\n+                    timeUnit = TimeUnit.HOURS;\n+                    break;\n+                case \"d\":\n+                    timeUnit = TimeUnit.DAYS;\n+                    break;\n+                default:\n+                    throw new ParsingException(source(ctx.timeUnit().IDENTIFIER()),", "originalCommit": "480320dbec2d96c04fd652cc79fb23e3d426798a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}