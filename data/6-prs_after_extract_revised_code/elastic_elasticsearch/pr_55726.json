{"pr_number": 55726, "pr_title": "Allow a number of broadcast transport actions to resolve data streams", "pr_createdAt": "2020-04-24T14:54:17Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/55726", "timeline": [{"oid": "8fd045a05032f7035a05cefc5f917e7383031d4d", "url": "https://github.com/elastic/elasticsearch/commit/8fd045a05032f7035a05cefc5f917e7383031d4d", "message": "Change the BroadcastRequest default indices options to resolve data stream\n\nBy changing to the default indices options of BroadcastRequest\nthe following apis can resolve data streams: flush,\nrefresh (already supported data streams), force merge, clear indices cache,\nindices stats, segments, upgrade stats, upgrade, validate query,\nsearchable snapshots stats, clear searchable snapshots cache and\nreload analyzers APIs.\n\nThe following APIs extend BroadcastRequest but overwrite default\nindices options and therefor don't yet support data streams:\nrecovery api\n\nThis change also adds `strictIncludeDataStreamsExpand()` to `IndicesOptions`\nclass. (an alternative to `strictExpand()`) This is because\n`InternalClusterInfoService` overwrites the default indices options\nfor the indices stats call.\n\nRelates to #53100", "committedDate": "2020-04-24T14:53:10Z", "type": "commit"}, {"oid": "bbe6a32c66f1805c922529399900af2022b72a3e", "url": "https://github.com/elastic/elasticsearch/commit/bbe6a32c66f1805c922529399900af2022b72a3e", "message": "renamed test", "committedDate": "2020-04-24T14:55:13Z", "type": "commit"}, {"oid": "9a7406c4ad09326083e596de860256040d6f7c53", "url": "https://github.com/elastic/elasticsearch/commit/9a7406c4ad09326083e596de860256040d6f7c53", "message": "fixed assertion", "committedDate": "2020-04-24T15:05:31Z", "type": "commit"}, {"oid": "6eee5add437a030642298ba787a619a6bbaa09b7", "url": "https://github.com/elastic/elasticsearch/commit/6eee5add437a030642298ba787a619a6bbaa09b7", "message": "adjusted tests", "committedDate": "2020-04-24T16:10:39Z", "type": "commit"}, {"oid": "61b81cafc8aa3ed8c5b5d44b513119a255ed8ddb", "url": "https://github.com/elastic/elasticsearch/commit/61b81cafc8aa3ed8c5b5d44b513119a255ed8ddb", "message": "fixed typo", "committedDate": "2020-04-24T17:41:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDg3NDMwMg==", "url": "https://github.com/elastic/elasticsearch/pull/55726#discussion_r414874302", "bodyText": "Maybe add that data streams are included to distinguish it from ::strictExpand()", "author": "danhermann", "createdAt": "2020-04-24T21:29:38Z", "path": "server/src/main/java/org/elasticsearch/action/support/IndicesOptions.java", "diffHunk": "@@ -446,6 +449,14 @@ public static IndicesOptions strictExpand() {\n         return STRICT_EXPAND_OPEN_CLOSED;\n     }\n \n+    /**\n+     * @return indices option that requires every specified index to exist, expands wildcards to both open and closed\n+     * indices and allows that no indices are resolved from wildcard expressions (not returning an error).", "originalCommit": "6eee5add437a030642298ba787a619a6bbaa09b7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "911f9280fb53bd875475ea47a925ba40bf070afd", "chunk": "diff --git a/server/src/main/java/org/elasticsearch/action/support/IndicesOptions.java b/server/src/main/java/org/elasticsearch/action/support/IndicesOptions.java\nindex 7bcd5dec853..a62b65da1d2 100644\n--- a/server/src/main/java/org/elasticsearch/action/support/IndicesOptions.java\n+++ b/server/src/main/java/org/elasticsearch/action/support/IndicesOptions.java\n\n@@ -451,7 +451,7 @@ public class IndicesOptions implements ToXContentFragment {\n \n     /**\n      * @return indices option that requires every specified index to exist, expands wildcards to both open and closed\n-     * indices and allows that no indices are resolved from wildcard expressions (not returning an error).\n+     * indices, supports data streams and allows that no indices are resolved from wildcard expressions (not returning an error).\n      */\n     public static IndicesOptions strictIncludeDataStreamsExpand() {\n         return STRICT_INCLUDE_DATA_STREAMS_EXPAND_OPEN_CLOSED;\n"}}, {"oid": "911f9280fb53bd875475ea47a925ba40bf070afd", "url": "https://github.com/elastic/elasticsearch/commit/911f9280fb53bd875475ea47a925ba40bf070afd", "message": "tweaked jdoc", "committedDate": "2020-04-25T10:11:47Z", "type": "commit"}, {"oid": "b1e176eb587eba10a5b72d90ac29f0892e612453", "url": "https://github.com/elastic/elasticsearch/commit/b1e176eb587eba10a5b72d90ac29f0892e612453", "message": "Merge remote-tracking branch 'es/master' into data_stream_resolvability_BroadcastRequest", "committedDate": "2020-04-25T10:11:56Z", "type": "commit"}, {"oid": "2253302137cac177dd048c1d11982cc5dcfc7206", "url": "https://github.com/elastic/elasticsearch/commit/2253302137cac177dd048c1d11982cc5dcfc7206", "message": "Merge remote-tracking branch 'es/master' into data_stream_resolvability_BroadcastRequest", "committedDate": "2020-05-08T11:07:43Z", "type": "commit"}, {"oid": "3413acb25761b0dfe9bb419891ed8e2bf78821d2", "url": "https://github.com/elastic/elasticsearch/commit/3413acb25761b0dfe9bb419891ed8e2bf78821d2", "message": "changes after merge", "committedDate": "2020-05-08T11:31:23Z", "type": "commit"}, {"oid": "55ef7b7480ec4304ae4b4266cdd0794722255b87", "url": "https://github.com/elastic/elasticsearch/commit/55ef7b7480ec4304ae4b4266cdd0794722255b87", "message": "Merge remote-tracking branch 'es/master' into data_stream_resolvability_BroadcastRequest", "committedDate": "2020-05-08T14:31:44Z", "type": "commit"}, {"oid": "0c4121474a83213eb79cde4cbf559da11d3d62e8", "url": "https://github.com/elastic/elasticsearch/commit/0c4121474a83213eb79cde4cbf559da11d3d62e8", "message": "forget follower action should not resolve data streams", "committedDate": "2020-05-08T15:12:41Z", "type": "commit"}]}