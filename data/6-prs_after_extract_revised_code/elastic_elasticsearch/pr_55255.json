{"pr_number": 55255, "pr_title": "Remove deprecated third-party methods from tests", "pr_createdAt": "2020-04-15T18:32:44Z", "pr_url": "https://github.com/elastic/elasticsearch/pull/55255", "timeline": [{"oid": "dd560221c6fd2c546f17aba5c8755e0843a780dd", "url": "https://github.com/elastic/elasticsearch/commit/dd560221c6fd2c546f17aba5c8755e0843a780dd", "message": "Remove deprecated methods from tests\n\nI've noticed that a lot of our tests are using deprecated static methods\nfrom the Hamcrest matchers. While this is not a big deal in any\nobjective sense, it seems like a small good thing to reduce compilation\nwarnings and be ready for a new release of the matcher library if we\nneed to upgrade. I've also switched a few other methods in tests that\nhave drop-in replacements.", "committedDate": "2020-04-15T18:28:57Z", "type": "commit"}, {"oid": "697556bb1b64de0114db82986d5968a483194754", "url": "https://github.com/elastic/elasticsearch/commit/697556bb1b64de0114db82986d5968a483194754", "message": "Merge branch 'master' into remove-deprecated-hamcrest-matchers", "committedDate": "2020-04-15T18:39:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTA2NzYxOQ==", "url": "https://github.com/elastic/elasticsearch/pull/55255#discussion_r409067619", "bodyText": "Since we are changing this, I think using hamcrest will produce a nicer error message if this ever fails:\nassertThat(response.getIndices(), Matchers.arrayContaining(\"index1\", \"index2\"));", "author": "rjernst", "createdAt": "2020-04-15T19:02:05Z", "path": "client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java", "diffHunk": "@@ -1227,7 +1227,7 @@ public void testFieldCaps() throws IOException {\n         FieldCapabilitiesResponse response = execute(request,\n             highLevelClient()::fieldCaps, highLevelClient()::fieldCapsAsync);\n \n-        assertEquals(new String[] {\"index1\", \"index2\"}, response.getIndices());\n+        assertArrayEquals(new String[] {\"index1\", \"index2\"}, response.getIndices());", "originalCommit": "697556bb1b64de0114db82986d5968a483194754", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTA3MTQ4NQ==", "url": "https://github.com/elastic/elasticsearch/pull/55255#discussion_r409071485", "bodyText": "Good point \u2014\u00a0I'll switch it.", "author": "williamrandolph", "createdAt": "2020-04-15T19:08:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTA2NzYxOQ=="}], "type": "inlineReview", "revised_code": {"commit": "0c28ebbf201fccc3acf76decc8258f7607aa4f17", "chunk": "diff --git a/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java\nindex 483ee32671d..53f4f5e2986 100644\n--- a/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java\n+++ b/client/rest-high-level/src/test/java/org/elasticsearch/client/SearchIT.java\n\n@@ -1227,7 +1228,7 @@ public class SearchIT extends ESRestHighLevelClientTestCase {\n         FieldCapabilitiesResponse response = execute(request,\n             highLevelClient()::fieldCaps, highLevelClient()::fieldCapsAsync);\n \n-        assertArrayEquals(new String[] {\"index1\", \"index2\"}, response.getIndices());\n+        assertThat(response.getIndices(), arrayContaining(\"index1\", \"index2\"));\n \n         // Check the capabilities for the 'rating' field.\n         assertTrue(response.get().containsKey(\"rating\"));\n"}}, {"oid": "0c28ebbf201fccc3acf76decc8258f7607aa4f17", "url": "https://github.com/elastic/elasticsearch/commit/0c28ebbf201fccc3acf76decc8258f7607aa4f17", "message": "Use hamcrest matcher instead of assertArrayEquals", "committedDate": "2020-04-15T19:23:15Z", "type": "commit"}]}