{"pr_number": 130, "pr_title": "#119 - Support for content-length-max repo config param", "pr_createdAt": "2020-05-12T10:22:35Z", "pr_url": "https://github.com/artipie/artipie/pull/130", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDEzMDA3Mg==", "url": "https://github.com/artipie/artipie/pull/130#discussion_r424130072", "bodyText": "@olegmoz let's compare the value directly by getting Optional.value() instead of creating Optional.of() in the assertion.", "author": "carlosmiranda", "createdAt": "2020-05-13T01:57:22Z", "path": "src/test/java/com/artipie/RepoConfigTest.java", "diffHunk": "@@ -59,13 +60,32 @@ public void readsCustom()\n     @Test\n     public void failsToReadCustom()\n         throws URISyntaxException, ExecutionException, InterruptedException {\n-        final RepoConfig config = this.readFromResource(\"repo-min-config.yml\");\n+        final RepoConfig config = this.readMin();\n         MatcherAssert.assertThat(\n             \"Unexpected custom config\",\n             config.settings().toCompletableFuture().get().isEmpty()\n         );\n     }\n \n+    @Test\n+    public void readContentLengthMax() throws Exception {\n+        final RepoConfig config = this.readFull();\n+        final long value = 123L;\n+        MatcherAssert.assertThat(\n+            config.contentLengthMax().toCompletableFuture().join(),\n+            new IsEqual<>(Optional.of(value))", "originalCommit": "35900ff09c6072e9f89cfc9590dd127b29258959", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDIzNTk2Nw==", "url": "https://github.com/artipie/artipie/pull/130#discussion_r424235967", "bodyText": "@carlosmiranda it is better to compare Optional, not it's value here. If the Optional is absent, then we will receive assertion exception which is expected in test, not IllegalStateException on attempt to read it's value", "author": "olegmoz", "createdAt": "2020-05-13T07:43:42Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDEzMDA3Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUwMjk2OA==", "url": "https://github.com/artipie/artipie/pull/130#discussion_r424502968", "bodyText": "@olegmoz ok, that makes sense, let's keep it as is.", "author": "carlosmiranda", "createdAt": "2020-05-13T14:54:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDEzMDA3Mg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDEzMDYwNw==", "url": "https://github.com/artipie/artipie/pull/130#discussion_r424130607", "bodyText": "@olegmoz what does this change have to do with the current task?", "author": "carlosmiranda", "createdAt": "2020-05-13T01:59:30Z", "path": "src/main/java/com/artipie/RepoConfig.java", "diffHunk": "@@ -140,14 +149,23 @@ public Vertx vertx() {\n      * @return String value.\n      */\n     private CompletionStage<String> string(final String key) {\n-        return this.repo().thenApply(\n-            map -> Objects.requireNonNull(\n-                map.string(key),\n-                String.format(\"yaml repo.%s is null\", key)\n+        return this.stringOpt(key).thenApply(", "originalCommit": "35900ff09c6072e9f89cfc9590dd127b29258959", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDIzNjYwNQ==", "url": "https://github.com/artipie/artipie/pull/130#discussion_r424236605", "bodyText": "@carlosmiranda I needed stringOpt method, so extracted it from existing string method. That's why this change is here", "author": "olegmoz", "createdAt": "2020-05-13T07:44:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDEzMDYwNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDUwMjc2OQ==", "url": "https://github.com/artipie/artipie/pull/130#discussion_r424502769", "bodyText": "@olegmoz all right, thanks for the explanation.", "author": "carlosmiranda", "createdAt": "2020-05-13T14:54:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDEzMDYwNw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "b39764623ccf48c73d13b45b8c06d22baf3b931b", "url": "https://github.com/artipie/artipie/commit/b39764623ccf48c73d13b45b8c06d22baf3b931b", "message": "#119 - Support for content-length-max repo config param", "committedDate": "2020-05-13T07:46:49Z", "type": "forcePushed"}, {"oid": "b39764623ccf48c73d13b45b8c06d22baf3b931b", "url": "https://github.com/artipie/artipie/commit/b39764623ccf48c73d13b45b8c06d22baf3b931b", "message": "#119 - Support for content-length-max repo config param", "committedDate": "2020-05-13T07:46:49Z", "type": "commit"}, {"oid": "0cad3a4326870b699daa097162d0e6359564c047", "url": "https://github.com/artipie/artipie/commit/0cad3a4326870b699daa097162d0e6359564c047", "message": "Merge branch 'master' into 119-limit-config", "committedDate": "2020-05-13T12:47:09Z", "type": "commit"}]}