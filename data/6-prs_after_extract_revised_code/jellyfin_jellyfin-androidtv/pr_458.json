{"pr_number": 458, "pr_title": "Remove unnecessary layout xml files", "pr_createdAt": "2020-04-25T15:23:06Z", "pr_url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2MQ==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083961", "bodyText": "Refactor this method to reduce its Cognitive Complexity from 27 to the 15 allowed.", "author": "codeclimate", "createdAt": "2020-04-25T15:24:05Z", "path": "app/src/main/java/org/jellyfin/androidtv/details/PhotoPlayerActivity.java", "diffHunk": "@@ -113,72 +112,70 @@ public void onCreate(Bundle savedInstanceState) {\n         mPopupRowsFragment.setOnItemViewClickedListener(itemViewClickedListener);\n         mPopupRowsFragment.setOnItemViewSelectedListener(itemViewSelectedListener);\n         setupPopupAnimations();\n+    }\n \n-        registerKeyListener(new IKeyListener() {\n-            @Override\n-            public boolean onKeyUp(int key, KeyEvent event) {\n-                switch (key) {\n-\n-                    case KeyEvent.KEYCODE_BACK:\n-                    case KeyEvent.KEYCODE_B:\n-                        if (mPopupPanelVisible) {\n-                            hideThumbPanel();\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_RIGHT:\n-                        if (!mPopupPanelVisible && MediaManager.hasNextMediaItem()) {\n-                            if (isLoadingNext || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) {\n-                                stop();\n-                                play();\n-                            } else {\n-                                next(750);\n-                            }\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_LEFT:\n-                        if (!mPopupPanelVisible && MediaManager.hasPrevMediaItem()) {\n-                            if (isLoadingPrev || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) stop();\n-                            currentPhoto = MediaManager.prevMedia().getBaseItem();\n-                            nextImage.setImageDrawable(currentImageView().getDrawable());\n-                            nextImageView().setImageDrawable(prevImage.getDrawable());\n-                            transition(750);\n-                            loadPrev();\n-                            return true;\n-                        }\n-                        break;\n+    @Override\n+    public boolean onKeyUp(int keyCode, KeyEvent event) {", "originalCommit": "0d23a89917965ceeb6347bfaf5aefaa693d480ed", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2Mw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083963", "bodyText": "Add a default case to this switch.", "author": "codeclimate", "createdAt": "2020-04-25T15:24:06Z", "path": "app/src/main/java/org/jellyfin/androidtv/details/ItemListActivity.java", "diffHunk": "@@ -197,6 +161,41 @@ public boolean onKeyUp(int key, KeyEvent event) {\n \n     }\n \n+\n+\n+    @Override\n+    public boolean onKeyUp(int keyCode, KeyEvent event) {\n+        if (MediaManager.isPlayingAudio()) {\n+            switch (keyCode) {\n+                case KeyEvent.KEYCODE_MEDIA_PAUSE:\n+                case KeyEvent.KEYCODE_MEDIA_PLAY_PAUSE:\n+                    if (MediaManager.isPlayingAudio()) MediaManager.pauseAudio();\n+                    else MediaManager.resumeAudio();\n+                    return true;\n+                case KeyEvent.KEYCODE_MEDIA_NEXT:\n+                case KeyEvent.KEYCODE_MEDIA_FAST_FORWARD:\n+                    MediaManager.nextAudioItem();\n+                    return true;\n+                case KeyEvent.KEYCODE_MEDIA_PREVIOUS:\n+                case KeyEvent.KEYCODE_MEDIA_REWIND:\n+                    MediaManager.prevAudioItem();\n+                    return true;\n+                case KeyEvent.KEYCODE_MENU:\n+                    showMenu(mCurrentRow, false);\n+                    return true;\n+            }\n+        } else if (mCurrentRow != null) {\n+            switch (keyCode) {", "originalCommit": "0d23a89917965ceeb6347bfaf5aefaa693d480ed", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTA4Mzk2NA==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415083964", "bodyText": "Add a default case to this switch.", "author": "codeclimate", "createdAt": "2020-04-25T15:24:06Z", "path": "app/src/main/java/org/jellyfin/androidtv/details/ItemListActivity.java", "diffHunk": "@@ -197,6 +161,41 @@ public boolean onKeyUp(int key, KeyEvent event) {\n \n     }\n \n+\n+\n+    @Override\n+    public boolean onKeyUp(int keyCode, KeyEvent event) {\n+        if (MediaManager.isPlayingAudio()) {\n+            switch (keyCode) {", "originalCommit": "0d23a89917965ceeb6347bfaf5aefaa693d480ed", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTI1NDAwMw==", "url": "https://github.com/jellyfin/jellyfin-androidtv/pull/458#discussion_r415254003", "bodyText": "Method onKeyUp has 51 lines of code (exceeds 25 allowed). Consider refactoring.", "author": "codeclimate", "createdAt": "2020-04-26T08:33:43Z", "path": "app/src/main/java/org/jellyfin/androidtv/details/PhotoPlayerActivity.java", "diffHunk": "@@ -113,72 +112,70 @@ public void onCreate(Bundle savedInstanceState) {\n         mPopupRowsFragment.setOnItemViewClickedListener(itemViewClickedListener);\n         mPopupRowsFragment.setOnItemViewSelectedListener(itemViewSelectedListener);\n         setupPopupAnimations();\n+    }\n \n-        registerKeyListener(new IKeyListener() {\n-            @Override\n-            public boolean onKeyUp(int key, KeyEvent event) {\n-                switch (key) {\n-\n-                    case KeyEvent.KEYCODE_BACK:\n-                    case KeyEvent.KEYCODE_B:\n-                        if (mPopupPanelVisible) {\n-                            hideThumbPanel();\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_RIGHT:\n-                        if (!mPopupPanelVisible && MediaManager.hasNextMediaItem()) {\n-                            if (isLoadingNext || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) {\n-                                stop();\n-                                play();\n-                            } else {\n-                                next(750);\n-                            }\n-                            return true;\n-                        }\n-                        break;\n-\n-                    case KeyEvent.KEYCODE_DPAD_LEFT:\n-                        if (!mPopupPanelVisible && MediaManager.hasPrevMediaItem()) {\n-                            if (isLoadingPrev || isTransitioning)\n-                                return true; //swallow too fast requests\n-                            if (isPlaying) stop();\n-                            currentPhoto = MediaManager.prevMedia().getBaseItem();\n-                            nextImage.setImageDrawable(currentImageView().getDrawable());\n-                            nextImageView().setImageDrawable(prevImage.getDrawable());\n-                            transition(750);\n-                            loadPrev();\n-                            return true;\n-                        }\n-                        break;\n+    @Override", "originalCommit": "57e73765ae78ed4c19f6e3ec7d36012310030cf0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "33a94393c2e8769ccbd099ddf45629699e0f10d0", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/33a94393c2e8769ccbd099ddf45629699e0f10d0", "message": "Add own key handling in ItemList and PhotoPlayer activities", "committedDate": "2020-04-28T15:52:43Z", "type": "commit"}, {"oid": "41098f93a4df2b6d396ff7b93bb02d7e0d6c848e", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/41098f93a4df2b6d396ff7b93bb02d7e0d6c848e", "message": "Replace all layouts with a single fragment to use the fragmentmanager", "committedDate": "2020-04-28T15:52:43Z", "type": "commit"}, {"oid": "f5dbd02e584766140daba04081d66ef0285171a9", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/f5dbd02e584766140daba04081d66ef0285171a9", "message": "Convert the modified activities to Kotlin", "committedDate": "2020-04-28T15:52:44Z", "type": "commit"}, {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ba461b0165936fed8fd1179bfb49b405f6490c10", "message": "Redo ExpandableTextView", "committedDate": "2020-04-28T15:52:45Z", "type": "commit"}, {"oid": "ba461b0165936fed8fd1179bfb49b405f6490c10", "url": "https://github.com/jellyfin/jellyfin-androidtv/commit/ba461b0165936fed8fd1179bfb49b405f6490c10", "message": "Redo ExpandableTextView", "committedDate": "2020-04-28T15:52:45Z", "type": "forcePushed"}]}