{"pr_number": 4046, "pr_title": "Add holder name for new Faster Payments accounts", "pr_createdAt": "2020-03-11T11:42:15Z", "pr_url": "https://github.com/bisq-network/bisq/pull/4046", "timeline": [{"oid": "cbb59c155b688cf51433b5f4070f70aa3d3fb24f", "url": "https://github.com/bisq-network/bisq/commit/cbb59c155b688cf51433b5f4070f70aa3d3fb24f", "message": "Remove redundant @Nullable from account payload excludeFromJsonDataMap\n\nSince this map is final and every PaymentAccountPayload constructor\ninitialises it to something nonnull, the @Nullable field annotation is\nredundant, so remove it.\n\nFurther simplify the code by passing an empty map into the constructor\ndirectly from each subclass constructor, rather than mapping empties to\nnulls from each 'proto.getExcludeFromJsonDataMap()' result, then mapping\nnulls back to empties in the base constructor. This is safe, since\ngetExcludeFromJsonDataMap() always returns a nonnull map.\n\nFinally, tidy the code slightly by replacing 'Charset.forName(\"UTF-8\")'\nwith StandardCharsets.UTF_8 in each PaymentAccountPayload subclass.", "committedDate": "2020-03-07T12:08:50Z", "type": "commit"}, {"oid": "a829969089d7d4acb9968856c31a2e91d37ab5fe", "url": "https://github.com/bisq-network/bisq/commit/a829969089d7d4acb9968856c31a2e91d37ab5fe", "message": "Add holder name for new Faster Payments accounts\n\nUse excludeFromJsonDataMap to add an optional owner full name property\nto Faster Payments (GBP) accounts, without affecting the trade JSON\ncontract (for backwards compatibility). This is to fix #3976, that some\nbanks have started checking the recipient name.\n\nMake the name a non-optional field for _new_ accounts, but display the\ndetails for old Faster Payments accounts in exactly the same way as\nbefore, only showing the extra field in the info popup, account and\ntrade step views when it is present.\n\nAlso update the now misleading payment instructions in the buyer popup.\nTODO: Update translations (which probably aren't needed anyway).", "committedDate": "2020-03-11T11:15:12Z", "type": "commit"}, {"oid": "a957fb167a15f43204b0f2ee212d471ba7a0caab", "url": "https://github.com/bisq-network/bisq/commit/a957fb167a15f43204b0f2ee212d471ba7a0caab", "message": "Add popup to advise user to recreate Faster Payments account\n\nOpen an info popup in the take/create offer view, upon choosing to take\nor make a new offer, to instruct the user to recreate their old Faster\nPayments account with an owner full name (and preserved salt). Also show\nthe popup upon manual selection of any old (i.e. missing full name)\nFaster Payments account from the trading account combo box, analogously\nto the ClearXchange (Zelle) warning popup logic.\n\n(Also eliminate slight differences between the private\n'maybeShow[ClearXchange|FasterPayments]Warning' methods in TakeOfferView\nand MutableOfferView, to make the code easier to deduplicate in future.)", "committedDate": "2020-03-25T09:48:06Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1OTgxNA==", "url": "https://github.com/bisq-network/bisq/pull/4046#discussion_r398659814", "bodyText": "If this field is shown during the trade process it creates unnecessary scrolling.\n\nI'd just change line 54-55 to\naddCompactTopLabelTextField(gridPane, gridRow, 1, Res.get(\"payment.accountNr\"),\n                ((FasterPaymentsAccountPayload) paymentAccountPayload).getAccountNr());\n\nwhich puts sort code and account nr next to each other.\n\nThat would work for both cases.", "author": "ripcurlx", "createdAt": "2020-03-26T15:23:26Z", "path": "desktop/src/main/java/bisq/desktop/components/paymentmethods/FasterPaymentsForm.java", "diffHunk": "@@ -44,6 +44,10 @@\n \n     public static int addFormForBuyer(GridPane gridPane, int gridRow,\n                                       PaymentAccountPayload paymentAccountPayload) {\n+        if (!((FasterPaymentsAccountPayload) paymentAccountPayload).getHolderName().isEmpty()) {\n+            addCompactTopLabelTextField(gridPane, ++gridRow, Res.get(\"payment.account.owner\"),\n+                    ((FasterPaymentsAccountPayload) paymentAccountPayload).getHolderName());\n+        }", "originalCommit": "0ec168bc0d6ad45e3ba475679ba8610dbd53a512", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTA1NTUwNQ==", "url": "https://github.com/bisq-network/bisq/pull/4046#discussion_r399055505", "bodyText": "OK, I'll apply the suggested change.", "author": "stejbac", "createdAt": "2020-03-27T06:18:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODY1OTgxNA=="}], "type": "inlineReview", "revised_code": {"commit": "e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "chunk": "diff --git a/desktop/src/main/java/bisq/desktop/components/paymentmethods/FasterPaymentsForm.java b/desktop/src/main/java/bisq/desktop/components/paymentmethods/FasterPaymentsForm.java\nindex 1e9028f71b..e431b1ce7e 100644\n--- a/desktop/src/main/java/bisq/desktop/components/paymentmethods/FasterPaymentsForm.java\n+++ b/desktop/src/main/java/bisq/desktop/components/paymentmethods/FasterPaymentsForm.java\n\n@@ -51,7 +51,7 @@ public class FasterPaymentsForm extends PaymentMethodForm {\n         // do not translate as it is used in English only\n         addCompactTopLabelTextField(gridPane, ++gridRow, UK_SORT_CODE,\n                 ((FasterPaymentsAccountPayload) paymentAccountPayload).getSortCode());\n-        addCompactTopLabelTextField(gridPane, ++gridRow, Res.get(\"payment.accountNr\"),\n+        addCompactTopLabelTextField(gridPane, gridRow, 1, Res.get(\"payment.accountNr\"),\n                 ((FasterPaymentsAccountPayload) paymentAccountPayload).getAccountNr());\n         return gridRow;\n     }\n"}}, {"oid": "e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "url": "https://github.com/bisq-network/bisq/commit/e2f5d7f70b3fc82719b3ba6bdb4f21531d74d2e8", "message": "Improve layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)", "committedDate": "2020-03-27T06:12:38Z", "type": "forcePushed"}, {"oid": "d84130ff5b82b4a236ad4b540e975db566f23f80", "url": "https://github.com/bisq-network/bisq/commit/d84130ff5b82b4a236ad4b540e975db566f23f80", "message": "Improve popup text + layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)\n\nAlso apply the suggested popup text simplifications.", "committedDate": "2020-03-27T08:08:21Z", "type": "commit"}, {"oid": "d84130ff5b82b4a236ad4b540e975db566f23f80", "url": "https://github.com/bisq-network/bisq/commit/d84130ff5b82b4a236ad4b540e975db566f23f80", "message": "Improve popup text + layout of Faster Payments buyer form fields\n\nDisplay the account number on the same row as the sort code in the trade\nstep view, to prevent scrolling with the extra name field (as suggested\nin the code review).\n\n(This also affects the layout of old accounts without the extra field.)\n\nAlso apply the suggested popup text simplifications.", "committedDate": "2020-03-27T08:08:21Z", "type": "forcePushed"}]}