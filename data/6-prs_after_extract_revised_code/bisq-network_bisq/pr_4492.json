{"pr_number": 4492, "pr_title": "Use https:// for XMR explorer API endpoints, except if localhost or Tor", "pr_createdAt": "2020-09-07T03:04:40Z", "pr_url": "https://github.com/bisq-network/bisq/pull/4492", "timeline": [{"oid": "95186c90c1ff2593e3fc37cc8beeec8213c11ce8", "url": "https://github.com/bisq-network/bisq/commit/95186c90c1ff2593e3fc37cc8beeec8213c11ce8", "message": "Use fancy regex to use http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* Otherwise use HTTPS over clearnet without Tor proxy", "committedDate": "2020-09-07T09:52:33Z", "type": "forcePushed"}, {"oid": "82c6aaa5759dc8b5c61e52f121a3250e503f69e4", "url": "https://github.com/bisq-network/bisq/commit/82c6aaa5759dc8b5c61e52f121a3250e503f69e4", "message": "Use fancy regex to use http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* If any other FQDN hostname, use HTTPS with Tor proxy", "committedDate": "2020-09-07T09:56:03Z", "type": "forcePushed"}, {"oid": "03451d3ed256d96d970b3d48a101b5ad6fc3a45b", "url": "https://github.com/bisq-network/bisq/commit/03451d3ed256d96d970b3d48a101b5ad6fc3a45b", "message": "Use fancy regex to use http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* If any other FQDN hostname, use HTTPS with Tor proxy", "committedDate": "2020-09-07T10:12:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ4NTcwMg==", "url": "https://github.com/bisq-network/bisq/pull/4492#discussion_r484485702", "bodyText": "should be else if", "author": "jmacxx", "createdAt": "2020-09-07T15:10:26Z", "path": "core/src/main/java/bisq/core/trade/txproof/xmr/XmrTxProofRequest.java", "diffHunk": "@@ -163,10 +163,19 @@ public String toString() {\n         this.model = model;\n \n         httpClient = new XmrTxProofHttpClient(socks5ProxyProvider);\n-        httpClient.setBaseUrl(\"http://\" + model.getServiceAddress());\n-        if (model.getServiceAddress().matches(\"^192.*|^localhost.*\")) {\n-            log.info(\"Ignoring Socks5 proxy for local net address: {}\", model.getServiceAddress());\n+\n+        // localhost, LAN address, or *.local FQDN starts with http://, don't use Tor\n+        if (model.getServiceAddress().regionMatches(0, \"http:\", 0, 5)) {\n+            httpClient.setBaseUrl(model.getServiceAddress());\n             httpClient.setIgnoreSocks5Proxy(true);\n+        // any non-onion FQDN starts with https://, use Tor\n+        } if (model.getServiceAddress().regionMatches(0, \"https:\", 0, 6)) {", "originalCommit": "378efcfa92f9ec5b226335312c8e4f3ce21b6bc1", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ4NzAwMA==", "url": "https://github.com/bisq-network/bisq/pull/4492#discussion_r484487000", "bodyText": "should be else if", "author": "jmacxx", "createdAt": "2020-09-07T15:13:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDQ4NTcwMg=="}], "type": "inlineReview", "revised_code": {"commit": "7e916e6bbd0e05a8f0b6caf63d467d20a303bd9e", "chunk": "diff --git a/core/src/main/java/bisq/core/trade/txproof/xmr/XmrTxProofRequest.java b/core/src/main/java/bisq/core/trade/txproof/xmr/XmrTxProofRequest.java\nindex f25fb9ff23..eb62b09468 100644\n--- a/core/src/main/java/bisq/core/trade/txproof/xmr/XmrTxProofRequest.java\n+++ b/core/src/main/java/bisq/core/trade/txproof/xmr/XmrTxProofRequest.java\n\n@@ -169,7 +169,7 @@ class XmrTxProofRequest implements AssetTxProofRequest<XmrTxProofRequest.Result>\n             httpClient.setBaseUrl(model.getServiceAddress());\n             httpClient.setIgnoreSocks5Proxy(true);\n         // any non-onion FQDN starts with https://, use Tor\n-        } if (model.getServiceAddress().regionMatches(0, \"https:\", 0, 6)) {\n+        } else if (model.getServiceAddress().regionMatches(0, \"https:\", 0, 6)) {\n             httpClient.setBaseUrl(model.getServiceAddress());\n             httpClient.setIgnoreSocks5Proxy(false);\n         // it's a raw onion so add http:// and use Tor proxy\n"}}, {"oid": "7e916e6bbd0e05a8f0b6caf63d467d20a303bd9e", "url": "https://github.com/bisq-network/bisq/commit/7e916e6bbd0e05a8f0b6caf63d467d20a303bd9e", "message": "Use lots of regex to add http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* If any other FQDN hostname, use HTTPS with Tor proxy", "committedDate": "2020-09-07T15:14:29Z", "type": "forcePushed"}, {"oid": "1c45a9c9c65610dd6f8e011090c383520a58512d", "url": "https://github.com/bisq-network/bisq/commit/1c45a9c9c65610dd6f8e011090c383520a58512d", "message": "Use lots of regex to add http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* If any other FQDN hostname, use HTTPS with Tor proxy", "committedDate": "2020-09-07T15:26:18Z", "type": "forcePushed"}, {"oid": "0869f9a016d890511e14392deb99c791167208e9", "url": "https://github.com/bisq-network/bisq/commit/0869f9a016d890511e14392deb99c791167208e9", "message": "Use lots of regex to add http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* If any other FQDN hostname, use HTTPS with Tor proxy", "committedDate": "2020-09-07T15:26:56Z", "type": "commit"}, {"oid": "0869f9a016d890511e14392deb99c791167208e9", "url": "https://github.com/bisq-network/bisq/commit/0869f9a016d890511e14392deb99c791167208e9", "message": "Use lots of regex to add http or https for XMR explorer API endpoint\n\n* If Tor *.onion hostname, use HTTP with Tor proxy\n* If 127.0.0.1 or localhost, use HTTP without Tor proxy\n* If LAN address or *.local FQDN, use HTTP without Tor proxy\n* If any other FQDN hostname, use HTTPS with Tor proxy", "committedDate": "2020-09-07T15:26:56Z", "type": "forcePushed"}, {"oid": "1461d95b0b622b2d20dacb0523b68345d595ffa8", "url": "https://github.com/bisq-network/bisq/commit/1461d95b0b622b2d20dacb0523b68345d595ffa8", "message": "Tweak string for \"Service Addresses\" to \"Monero Explorer URLs\"", "committedDate": "2020-09-08T03:08:44Z", "type": "commit"}, {"oid": "5d83ca5c233826cd0811abceaedcc15a83d5573f", "url": "https://github.com/bisq-network/bisq/commit/5d83ca5c233826cd0811abceaedcc15a83d5573f", "message": "Add friendly name for node77.monero.wiz.biz -> explorer.monero.wiz.biz", "committedDate": "2020-09-08T03:09:31Z", "type": "commit"}, {"oid": "a2c6f279a66248bfcd21a6574321ed2497963d69", "url": "https://github.com/bisq-network/bisq/commit/a2c6f279a66248bfcd21a6574321ed2497963d69", "message": "Merge remote-tracking branch 'bisq/master' into use-https-for-xmr-explorer-api", "committedDate": "2020-09-08T11:19:20Z", "type": "commit"}, {"oid": "245027bff4153830e1cac15064163b7445a8ff74", "url": "https://github.com/bisq-network/bisq/commit/245027bff4153830e1cac15064163b7445a8ff74", "message": "Fix codacy complaining about missing space character", "committedDate": "2020-09-08T11:20:30Z", "type": "commit"}, {"oid": "906805ec2e7a5f380fa351fa912124b9ee171e01", "url": "https://github.com/bisq-network/bisq/commit/906805ec2e7a5f380fa351fa912124b9ee171e01", "message": "Rename Monero Explorer to friendlier hostname explorer.monero.wiz.biz", "committedDate": "2020-09-08T11:26:23Z", "type": "commit"}]}