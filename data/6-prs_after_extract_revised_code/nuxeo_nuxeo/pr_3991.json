{"pr_number": 3991, "pr_title": "NXP-29057: don't save toplevel properties that aren't dirty", "pr_createdAt": "2020-05-01T15:01:07Z", "pr_url": "https://github.com/nuxeo/nuxeo/pull/3991", "timeline": [{"oid": "303eb944d61c5cb6eb317756282ec3cfdf91c1f5", "url": "https://github.com/nuxeo/nuxeo/commit/303eb944d61c5cb6eb317756282ec3cfdf91c1f5", "message": "NXP-29057: don't save toplevel properties that aren't dirty", "committedDate": "2020-05-01T15:02:38Z", "type": "forcePushed"}, {"oid": "190d483350aee5a3308f0aca73882e49a85b1dd5", "url": "https://github.com/nuxeo/nuxeo/commit/190d483350aee5a3308f0aca73882e49a85b1dd5", "message": "NXP-29057: don't save toplevel properties that aren't dirty (except on creation)", "committedDate": "2020-05-02T16:59:58Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI2NzE5MQ==", "url": "https://github.com/nuxeo/nuxeo/pull/3991#discussion_r419267191", "bodyText": "Worth adding @since 11.1", "author": "troger", "createdAt": "2020-05-04T07:57:38Z", "path": "modules/core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/model/Document.java", "diffHunk": "@@ -443,9 +443,25 @@\n      * <p>\n      * Writing data is done by {@link DocumentPart} because of per-proxy schemas.\n      *\n+     * @param dp the document part\n+     * @param writeContext the write context\n+     * @param create whether this is for a document creation", "originalCommit": "190d483350aee5a3308f0aca73882e49a85b1dd5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2d49b66686bd3e198544a86912f471ce947b9f4e", "chunk": "diff --git a/modules/core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/model/Document.java b/modules/core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/model/Document.java\nindex 73eb5a84ae5..f2f68c5afd9 100644\n--- a/modules/core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/model/Document.java\n+++ b/modules/core/nuxeo-core-api/src/main/java/org/nuxeo/ecm/core/model/Document.java\n\n@@ -447,6 +447,7 @@ public interface Document {\n      * @param writeContext the write context\n      * @param create whether this is for a document creation\n      * @return {@code true} if something changed\n+     * @since 11.1\n      */\n     boolean writeDocumentPart(DocumentPart dp, WriteContext writeContext, boolean create) throws PropertyException;\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxOTI4NTcyNA==", "url": "https://github.com/nuxeo/nuxeo/pull/3991#discussion_r419285724", "bodyText": "Since 11.1.", "author": "troger", "createdAt": "2020-05-04T08:35:41Z", "path": "modules/core/nuxeo-core/src/main/java/org/nuxeo/ecm/core/api/DocumentModelFactory.java", "diffHunk": "@@ -192,6 +192,14 @@ public static DataModel createDataModel(Document doc, Schema schema) {\n      */\n     @SuppressWarnings(\"deprecation\")\n     public static DocumentModel writeDocumentModel(DocumentModel docModel, Document doc) {\n+        return writeDocumentModel(docModel, doc, false);\n+    }\n+\n+    /**\n+     * Writes a document model to a document. Returns the re-read document model.\n+     */", "originalCommit": "190d483350aee5a3308f0aca73882e49a85b1dd5", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2d49b66686bd3e198544a86912f471ce947b9f4e", "chunk": "diff --git a/modules/core/nuxeo-core/src/main/java/org/nuxeo/ecm/core/api/DocumentModelFactory.java b/modules/core/nuxeo-core/src/main/java/org/nuxeo/ecm/core/api/DocumentModelFactory.java\nindex 86428c0c650..a62f34ac02e 100644\n--- a/modules/core/nuxeo-core/src/main/java/org/nuxeo/ecm/core/api/DocumentModelFactory.java\n+++ b/modules/core/nuxeo-core/src/main/java/org/nuxeo/ecm/core/api/DocumentModelFactory.java\n\n@@ -197,6 +197,8 @@ public class DocumentModelFactory {\n \n     /**\n      * Writes a document model to a document. Returns the re-read document model.\n+     *\n+     * @since 11.1\n      */\n     @SuppressWarnings(\"deprecation\")\n     public static DocumentModel writeDocumentModel(DocumentModel docModel, Document doc, boolean create) {\n"}}, {"oid": "2d49b66686bd3e198544a86912f471ce947b9f4e", "url": "https://github.com/nuxeo/nuxeo/commit/2d49b66686bd3e198544a86912f471ce947b9f4e", "message": "NXP-29057: don't save toplevel properties that aren't dirty (except on creation)", "committedDate": "2020-05-04T10:38:37Z", "type": "commit"}, {"oid": "2d49b66686bd3e198544a86912f471ce947b9f4e", "url": "https://github.com/nuxeo/nuxeo/commit/2d49b66686bd3e198544a86912f471ce947b9f4e", "message": "NXP-29057: don't save toplevel properties that aren't dirty (except on creation)", "committedDate": "2020-05-04T10:38:37Z", "type": "forcePushed"}]}