{"pr_number": 16889, "pr_title": "Renamed IOService to ServerContext", "pr_createdAt": "2020-04-15T06:33:50Z", "pr_url": "https://github.com/hazelcast/hazelcast/pull/16889", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY0OTQ2NA==", "url": "https://github.com/hazelcast/hazelcast/pull/16889#discussion_r408649464", "bodyText": "minor: there is a leftover reference to NodeIOService in MockServer:134", "author": "vbekiaris", "createdAt": "2020-04-15T07:53:50Z", "path": "hazelcast/src/test/java/com/hazelcast/test/mocknetwork/MockServer.java", "diffHunk": "@@ -65,24 +65,24 @@\n     private final Node node;\n \n     private final ScheduledExecutorService scheduler;\n-    private final IOService ioService;\n+    private final ServerContext serverContext;\n     private final ILogger logger;\n \n     private volatile boolean live;\n \n     private final ServerConnectionManager mockConnectionMgr;\n     private final AggregateServerConnectionManager mockAggrEndpointManager;\n \n-    MockServer(IOService ioService, Node node, TestNodeRegistry testNodeRegistry) {\n-        this.ioService = ioService;\n+    MockServer(ServerContext serverContext, Node node, TestNodeRegistry testNodeRegistry) {", "originalCommit": "21b8a129049a717d92f747f5be004fdac82504c0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY1MTM3MQ==", "url": "https://github.com/hazelcast/hazelcast/pull/16889#discussion_r408651371", "bodyText": "Fixed", "author": "pveentjer", "createdAt": "2020-04-15T07:57:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY0OTQ2NA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "cf9f06ffaf8e2015e5418d59218def013d1fea0e", "url": "https://github.com/hazelcast/hazelcast/commit/cf9f06ffaf8e2015e5418d59218def013d1fea0e", "message": "Renamed IOService to ServerContext\n\nThis is in line with e.g NioNetworking.Context. The context contains\nthe dependencies for some service.", "committedDate": "2020-04-15T07:56:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY4NzI2NA==", "url": "https://github.com/hazelcast/hazelcast/pull/16889#discussion_r408687264", "bodyText": "doesn't read right, active/inactive context?", "author": "tkountis", "createdAt": "2020-04-15T08:57:50Z", "path": "hazelcast/src/main/java/com/hazelcast/internal/server/tcp/TcpServerConnection.java", "diffHunk": "@@ -262,7 +262,7 @@ private void logClose() {\n     }\n \n     private Level resolveLogLevelOnClose() {\n-        if (!ioService.isActive()) {\n+        if (!serverContext.isActive()) {", "originalCommit": "cf9f06ffaf8e2015e5418d59218def013d1fea0e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY4ODcyNw==", "url": "https://github.com/hazelcast/hazelcast/pull/16889#discussion_r408688727", "bodyText": "That can be fixed.", "author": "pveentjer", "createdAt": "2020-04-15T09:00:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY4NzI2NA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY5MDU0OQ==", "url": "https://github.com/hazelcast/hazelcast/pull/16889#discussion_r408690549", "bodyText": "@Override\n    public boolean isNodeActive() {\n        return node.getState() != NodeState.SHUT_DOWN;\n    }", "author": "pveentjer", "createdAt": "2020-04-15T09:03:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY4NzI2NA=="}], "type": "inlineReview", "revised_code": {"commit": "24bfd7523a6c831cb6c895ebc47dec6675a9d364", "chunk": "diff --git a/hazelcast/src/main/java/com/hazelcast/internal/server/tcp/TcpServerConnection.java b/hazelcast/src/main/java/com/hazelcast/internal/server/tcp/TcpServerConnection.java\nindex 9b4391b747..ef2b68118c 100644\n--- a/hazelcast/src/main/java/com/hazelcast/internal/server/tcp/TcpServerConnection.java\n+++ b/hazelcast/src/main/java/com/hazelcast/internal/server/tcp/TcpServerConnection.java\n\n@@ -262,7 +262,7 @@ public class TcpServerConnection implements ServerConnection {\n     }\n \n     private Level resolveLogLevelOnClose() {\n-        if (!serverContext.isActive()) {\n+        if (!serverContext.isNodeActive()) {\n             return Level.FINEST;\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODY4ODgwMA==", "url": "https://github.com/hazelcast/hazelcast/pull/16889#discussion_r408688800", "bodyText": "np: getters make no sense here i guess.", "author": "tkountis", "createdAt": "2020-04-15T09:00:18Z", "path": "hazelcast/src/main/java/com/hazelcast/internal/server/tcp/TcpServerConnectionErrorHandler.java", "diffHunk": "@@ -34,10 +34,10 @@\n \n     TcpServerConnectionErrorHandler(TcpServerConnectionManager connectionManager, Address endPoint) {\n         this.endPoint = endPoint;\n-        this.ioService = connectionManager.getServer().getIoService();\n-        this.minInterval = ioService.getConnectionMonitorInterval();\n-        this.maxFaults = ioService.getConnectionMonitorMaxFaults();\n-        this.logger = ioService.getLoggingService().getLogger(getClass());\n+        this.serverContext = connectionManager.getServer().getContext();\n+        this.minInterval = serverContext.getConnectionMonitorInterval();", "originalCommit": "cf9f06ffaf8e2015e5418d59218def013d1fea0e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "24bfd7523a6c831cb6c895ebc47dec6675a9d364", "url": "https://github.com/hazelcast/hazelcast/commit/24bfd7523a6c831cb6c895ebc47dec6675a9d364", "message": "Renamed IOService to ServerContext\n\nThis is in line with e.g NioNetworking.Context. The context contains\nthe dependencies for some service.", "committedDate": "2020-04-15T09:05:28Z", "type": "forcePushed"}, {"oid": "0d12122f9d0313bf2dc7d6d51f72b2fa464bb1cf", "url": "https://github.com/hazelcast/hazelcast/commit/0d12122f9d0313bf2dc7d6d51f72b2fa464bb1cf", "message": "Renamed IOService to ServerContext\n\nThis is in line with e.g NioNetworking.Context. The context contains\nthe dependencies for some service.", "committedDate": "2020-04-15T09:34:35Z", "type": "commit"}, {"oid": "0d12122f9d0313bf2dc7d6d51f72b2fa464bb1cf", "url": "https://github.com/hazelcast/hazelcast/commit/0d12122f9d0313bf2dc7d6d51f72b2fa464bb1cf", "message": "Renamed IOService to ServerContext\n\nThis is in line with e.g NioNetworking.Context. The context contains\nthe dependencies for some service.", "committedDate": "2020-04-15T09:34:35Z", "type": "forcePushed"}]}