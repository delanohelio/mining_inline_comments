{"pr_number": 1139, "pr_title": "Report more descriptive message from the SlackSelfHealingNotifier (#1136)", "pr_createdAt": "2020-03-10T22:20:53Z", "pr_url": "https://github.com/linkedin/cruise-control/pull/1139", "timeline": [{"oid": "4c179415cf9d0d834fe7bab151efbc8ed4ab5313", "url": "https://github.com/linkedin/cruise-control/commit/4c179415cf9d0d834fe7bab151efbc8ed4ab5313", "message": "Report more descriptive message from the SlackSelfHealingNotifier (#1136)", "committedDate": "2020-03-10T22:01:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY5MzY1Nw==", "url": "https://github.com/linkedin/cruise-control/pull/1139#discussion_r390693657", "bodyText": "Nit: Extra space after = and before String.", "author": "efeg", "createdAt": "2020-03-11T01:01:16Z", "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java", "diffHunk": "@@ -66,13 +66,13 @@ public void alert(Object anomaly, boolean autoFixTriggered, long selfHealingStar\n             return;\n         }\n \n-        String text;\n+        String text =  String.format(\"%s detected %s. Self healing %s.\", anomalyType, anomaly,", "originalCommit": "4c179415cf9d0d834fe7bab151efbc8ed4ab5313", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTExNTk5OQ==", "url": "https://github.com/linkedin/cruise-control/pull/1139#discussion_r391115999", "bodyText": "Good call, fixed.", "author": "matthinograb", "createdAt": "2020-03-11T16:51:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY5MzY1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "7d6d1f269154726f542ea3ed7a982e344996e411", "chunk": "diff --git a/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java b/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java\nindex 187c40c0..77274676 100644\n--- a/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java\n+++ b/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java\n\n@@ -66,12 +66,10 @@ public class SlackSelfHealingNotifier extends SelfHealingNotifier {\n             return;\n         }\n \n-        String text =  String.format(\"%s detected %s. Self healing %s.\", anomalyType, anomaly,\n-                _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime)) : \"is disabled\");\n-\n-        if (autoFixTriggered) {\n-            text = text + \"\\n Self-healing has been triggered.\";\n-        }\n+        String text = String.format(\"%s detected %s. Self healing %s.%s\", anomalyType, anomaly,\n+                _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime))\n+                        : \"is disabled\",\n+                autoFixTriggered ? \"%nSelf-healing has been triggered.\" : \"\");\n \n         try {\n             sendSlackMessage(new SlackMessage(_slackUser, text, _slackIcon, _slackChannel), _slackWebhook);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY5Njc2Mw==", "url": "https://github.com/linkedin/cruise-control/pull/1139#discussion_r390696763", "bodyText": "Is it possible to\n\nAvoid having an extra space after new line, and\nPrefer %n rather than \\n. -- please see https://stackoverflow.com/questions/1883345/whats-up-with-javas-n-in-printf\n\nMaybe something like the following?\n        String text = String.format(\"%s detected %s. Self healing %s.%s\", anomalyType, anomaly,\n                                    _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime))\n                                                                         : \"is disabled\",\n                                    autoFixTriggered ? \"%nSelf-healing has been triggered.\" : \"\");", "author": "efeg", "createdAt": "2020-03-11T01:14:45Z", "path": "cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java", "diffHunk": "@@ -66,13 +66,13 @@ public void alert(Object anomaly, boolean autoFixTriggered, long selfHealingStar\n             return;\n         }\n \n-        String text;\n+        String text =  String.format(\"%s detected %s. Self healing %s.\", anomalyType, anomaly,\n+                _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime)) : \"is disabled\");\n+\n         if (autoFixTriggered) {\n-            text = \"Self-healing has been triggered.\";\n-        } else {\n-            text = String.format(\"%s detected %s. Self healing %s.\", anomalyType, anomaly,\n-                    _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime)) : \"is disabled\");\n+            text = text + \"\\n Self-healing has been triggered.\";", "originalCommit": "4c179415cf9d0d834fe7bab151efbc8ed4ab5313", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTExNTgxOQ==", "url": "https://github.com/linkedin/cruise-control/pull/1139#discussion_r391115819", "bodyText": "Great suggestion, thanks!\nAddressed in most recent commit.", "author": "matthinograb", "createdAt": "2020-03-11T16:51:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDY5Njc2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "7d6d1f269154726f542ea3ed7a982e344996e411", "chunk": "diff --git a/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java b/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java\nindex 187c40c0..77274676 100644\n--- a/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java\n+++ b/cruise-control/src/main/java/com/linkedin/kafka/cruisecontrol/detector/notifier/SlackSelfHealingNotifier.java\n\n@@ -66,12 +66,10 @@ public class SlackSelfHealingNotifier extends SelfHealingNotifier {\n             return;\n         }\n \n-        String text =  String.format(\"%s detected %s. Self healing %s.\", anomalyType, anomaly,\n-                _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime)) : \"is disabled\");\n-\n-        if (autoFixTriggered) {\n-            text = text + \"\\n Self-healing has been triggered.\";\n-        }\n+        String text = String.format(\"%s detected %s. Self healing %s.%s\", anomalyType, anomaly,\n+                _selfHealingEnabled.get(anomalyType) ? String.format(\"start time %s\", toDateString(selfHealingStartTime))\n+                        : \"is disabled\",\n+                autoFixTriggered ? \"%nSelf-healing has been triggered.\" : \"\");\n \n         try {\n             sendSlackMessage(new SlackMessage(_slackUser, text, _slackIcon, _slackChannel), _slackWebhook);\n"}}, {"oid": "7d6d1f269154726f542ea3ed7a982e344996e411", "url": "https://github.com/linkedin/cruise-control/commit/7d6d1f269154726f542ea3ed7a982e344996e411", "message": "Fix whitespace, use platform-agnostic new-line, and use ternary operator", "committedDate": "2020-03-11T16:50:03Z", "type": "commit"}]}