{"pr_number": 1117, "pr_title": "Fix #1116 - Reduce integration test running time", "pr_createdAt": "2020-03-09T09:42:52Z", "pr_url": "https://github.com/wso2/product-microgateway/pull/1117", "timeline": [{"oid": "3f303e6f1c4c7f7d849751350d491a5fa25a5b98", "url": "https://github.com/wso2/product-microgateway/commit/3f303e6f1c4c7f7d849751350d491a5fa25a5b98", "message": "Fix #1116 - Reduce integration test running time", "committedDate": "2020-03-09T09:38:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA5NDcwMw==", "url": "https://github.com/wso2/product-microgateway/pull/1117#discussion_r390094703", "bodyText": "Do we need commented code? Can we remove?", "author": "praminda", "createdAt": "2020-03-10T04:53:27Z", "path": "tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP1BackEndTestCase.java", "diffHunk": "@@ -21,61 +21,51 @@\n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n import org.testng.annotations.AfterClass;\n-import org.testng.annotations.BeforeClass;\n import org.testng.annotations.Test;\n-import org.wso2.micro.gateway.tests.common.BaseTestCase;\n-import org.wso2.micro.gateway.tests.common.KeyValidationInfo;\n-import org.wso2.micro.gateway.tests.common.MockAPIPublisher;\n-import org.wso2.micro.gateway.tests.common.model.API;\n-import org.wso2.micro.gateway.tests.common.model.ApplicationDTO;\n import org.wso2.micro.gateway.tests.util.HTTP2Client.Http2ClientRequest;\n-import org.wso2.micro.gateway.tests.util.TestConstant;\n-\n-import java.io.File;\n-\n import static org.wso2.micro.gateway.tests.util.TestConstant.GATEWAY_LISTENER_HTTPS_PORT;\n import static org.wso2.micro.gateway.tests.util.TestConstant.GATEWAY_LISTENER_HTTP_PORT;\n \n-public class HTTP2RequestsWithHTTP1BackEndTestCase extends BaseTestCase {\n+public class HTTP2RequestsWithHTTP1BackEndTestCase extends HTTP2RequestsWithHTTP2BackEndTestCase {\n \n     private static final Log log = LogFactory.getLog(HTTP2RequestsWithHTTP2BackEndTestCase.class);\n     protected Http2ClientRequest http2ClientRequest;\n-    private String jwtTokenProd;\n-\n-    @BeforeClass\n-    private void setup() throws Exception {\n-        String label = \"apimTestLabel\";\n-        String project = \"apimTestProject\";\n-        //get mock APIM Instance\n-        MockAPIPublisher pub = MockAPIPublisher.getInstance();\n-        API api = new API();\n-        api.setName(\"PizzaShackAPI\");\n-        api.setContext(\"/pizzashack\");\n-        api.setEndpoint(getMockServiceURLHttp(\"/echo\"));\n-        api.setVersion(\"1.0.0\");\n-        api.setProvider(\"admin\");\n-        //Register API with label\n-        pub.addApi(label, api);\n-\n-        //Define application info\n-        ApplicationDTO application = new ApplicationDTO();\n-        application.setName(\"jwtApp\");\n-        application.setTier(\"Unlimited\");\n-        application.setId((int) (Math.random() * 1000));\n+    //private String jwtTokenProd;\n \n-        //Register a production token with key validation info\n-        KeyValidationInfo info = new KeyValidationInfo();\n-        info.setApi(api);\n-        info.setApplication(application);\n-        info.setAuthorized(true);\n-        info.setKeyType(TestConstant.KEY_TYPE_PRODUCTION);\n-        info.setSubscriptionTier(\"Unlimited\");\n-\n-        String configPath = \"confs/http2-test.conf\";\n-        super.init(label, project, configPath);\n-\n-        jwtTokenProd = getJWT(api, application, \"Unlimited\", TestConstant.KEY_TYPE_PRODUCTION, 3600);\n-    }\n+//    @BeforeClass", "originalCommit": "3f303e6f1c4c7f7d849751350d491a5fa25a5b98", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cc834a6eb6243dd49b67a0104b75d7884ba6be65", "chunk": "diff --git a/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP1BackEndTestCase.java b/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP1BackEndTestCase.java\nindex 617c0e754..e0afa9c6b 100644\n--- a/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP1BackEndTestCase.java\n+++ b/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP1BackEndTestCase.java\n\n@@ -30,42 +30,6 @@ public class HTTP2RequestsWithHTTP1BackEndTestCase extends HTTP2RequestsWithHTTP\n \n     private static final Log log = LogFactory.getLog(HTTP2RequestsWithHTTP2BackEndTestCase.class);\n     protected Http2ClientRequest http2ClientRequest;\n-    //private String jwtTokenProd;\n-\n-//    @BeforeClass\n-//    private void setup() throws Exception {\n-//        String label = \"apimTestLabel\";\n-//        String project = \"apimTestProject\";\n-//        //get mock APIM Instance\n-//        MockAPIPublisher pub = MockAPIPublisher.getInstance();\n-//        API api = new API();\n-//        api.setName(\"PizzaShackAPI\");\n-//        api.setContext(\"/pizzashack\");\n-//        api.setEndpoint(getMockServiceURLHttp(\"/echo\"));\n-//        api.setVersion(\"1.0.0\");\n-//        api.setProvider(\"admin\");\n-//        //Register API with label\n-//        pub.addApi(label, api);\n-//\n-//        //Define application info\n-//        ApplicationDTO application = new ApplicationDTO();\n-//        application.setName(\"jwtApp\");\n-//        application.setTier(\"Unlimited\");\n-//        application.setId((int) (Math.random() * 1000));\n-//\n-//        //Register a production token with key validation info\n-//        KeyValidationInfo info = new KeyValidationInfo();\n-//        info.setApi(api);\n-//        info.setApplication(application);\n-//        info.setAuthorized(true);\n-//        info.setKeyType(TestConstant.KEY_TYPE_PRODUCTION);\n-//        info.setSubscriptionTier(\"Unlimited\");\n-//\n-//        String configPath = \"confs/http2-test.conf\";\n-//        super.init(label, project, configPath);\n-//\n-//        jwtTokenProd = getJWT(api, application, \"Unlimited\", TestConstant.KEY_TYPE_PRODUCTION, 3600);\n-//    }\n \n     @Test(description = \"Test API invocation with an HTTP/2.0 request via insecure connection sending to HTTP/1.1 BE\")\n     public void testHTTP2RequestsViaInsecureConnectionWithHTTP1BE() throws Exception {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MDA5NDgxNA==", "url": "https://github.com/wso2/product-microgateway/pull/1117#discussion_r390094814", "bodyText": "Can we remove commented block?", "author": "praminda", "createdAt": "2020-03-10T04:54:01Z", "path": "tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP2BackEndTestCase.java", "diffHunk": "@@ -132,9 +138,9 @@ public void testHTTP1RequestsViaSecureConnectionWithHTTP2BE() throws Exception {\n         log.info(\"Response: \" + response.getResponseMessage() + \" , \" + response.getResponseCode());\n     }\n \n-    @AfterClass\n-    public void stop() throws Exception {\n-        //Stop all the mock servers\n-        super.finalize();\n-    }\n+//    @AfterClass", "originalCommit": "3f303e6f1c4c7f7d849751350d491a5fa25a5b98", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "cc834a6eb6243dd49b67a0104b75d7884ba6be65", "chunk": "diff --git a/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP2BackEndTestCase.java b/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP2BackEndTestCase.java\nindex 08d57293f..be21c5134 100644\n--- a/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP2BackEndTestCase.java\n+++ b/tests/src/test/java/org/wso2/micro/gateway/tests/http2/HTTP2RequestsWithHTTP2BackEndTestCase.java\n\n@@ -137,10 +137,4 @@ public class HTTP2RequestsWithHTTP2BackEndTestCase extends BaseTestCase {\n                 .doGet(getServiceURLHttp(\"/pizzashack/1.0.0/menu\"), headers);\n         log.info(\"Response: \" + response.getResponseMessage() + \" , \" + response.getResponseCode());\n     }\n-\n-//    @AfterClass\n-//    public void stop() throws Exception {\n-//        //Stop all the mock servers\n-//        super.finalize();\n-//    }\n }\n"}}, {"oid": "cc834a6eb6243dd49b67a0104b75d7884ba6be65", "url": "https://github.com/wso2/product-microgateway/commit/cc834a6eb6243dd49b67a0104b75d7884ba6be65", "message": "Remove the commented code", "committedDate": "2020-03-10T06:21:32Z", "type": "commit"}]}