{"pr_number": 3640, "pr_title": "Add copy on long press to device details in Form Metdata", "pr_createdAt": "2020-02-14T15:35:18Z", "pr_url": "https://github.com/getodk/collect/pull/3640", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUxODIxMw==", "url": "https://github.com/getodk/collect/pull/3640#discussion_r381518213", "bodyText": "I think that this is good but I'm concerned that it will get lost and forgotten. How about marking KEYS_WE_SHOULD_NOT_RESET as deprecated and describing this strategy? Maybe meta should be a constant somewhere?", "author": "lognaturel", "createdAt": "2020-02-19T20:13:03Z", "path": "collect_app/src/main/java/org/odk/collect/android/injection/config/AppDependencyModule.java", "diffHunk": "@@ -166,7 +165,7 @@ public ActivityAvailability providesActivityAvailability(Context context) {\n \n     @Provides\n     InstallIDProvider providesInstallIDProvider(Context context) {\n-        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(context);\n+        SharedPreferences preferences = context.getSharedPreferences(\"meta\", Context.MODE_PRIVATE);", "originalCommit": "772ef68b1f14911e1e9e25504ec8223db5a0ce3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg3ODY5Nw==", "url": "https://github.com/getodk/collect/pull/3640#discussion_r381878697", "bodyText": "Yeah I was in two minds about this as I'm not a fan of the existing shared prefs abstractions and the keys classes. I do agree that it would be nice to have something that makes the meta prefs more discoverable though so they get used for other things. I'll have a think.", "author": "seadowg", "createdAt": "2020-02-20T09:29:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUxODIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg4MjIxMA==", "url": "https://github.com/getodk/collect/pull/3640#discussion_r381882210", "bodyText": "As a note I'd like to keep the test with a hardcoded/inline as this prevents someone changing the constant (in the code) and the test still passing. It's checking configuration as well as behaviour.", "author": "seadowg", "createdAt": "2020-02-20T09:35:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUxODIxMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTg5MTAwMw==", "url": "https://github.com/getodk/collect/pull/3640#discussion_r381891003", "bodyText": "I'm going to go with a provider for the meta prefs for now. I didn't want to start building a whole MetaSharedPrefences to mimic the other ones. I like that we have abstraction for prefs storage though so I might follow up with a refactor that pulls out the shared logic around shared prefs and maybe improves the interfaces a little.", "author": "seadowg", "createdAt": "2020-02-20T09:50:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MTUxODIxMw=="}], "type": "inlineReview", "revised_code": {"commit": "c3d682095e3a8e71b72ec07ef0df4d8def1273ba", "chunk": "diff --git a/collect_app/src/main/java/org/odk/collect/android/injection/config/AppDependencyModule.java b/collect_app/src/main/java/org/odk/collect/android/injection/config/AppDependencyModule.java\nindex a8c160439..36c41baed 100644\n--- a/collect_app/src/main/java/org/odk/collect/android/injection/config/AppDependencyModule.java\n+++ b/collect_app/src/main/java/org/odk/collect/android/injection/config/AppDependencyModule.java\n\n@@ -165,7 +166,7 @@ public class AppDependencyModule {\n \n     @Provides\n     InstallIDProvider providesInstallIDProvider(Context context) {\n-        SharedPreferences preferences = context.getSharedPreferences(\"meta\", Context.MODE_PRIVATE);\n+        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(context);\n         return new SharedPreferencesInstallIDProvider(preferences, KEY_INSTALL_ID);\n     }\n \n"}}, {"oid": "c3d682095e3a8e71b72ec07ef0df4d8def1273ba", "url": "https://github.com/getodk/collect/commit/c3d682095e3a8e71b72ec07ef0df4d8def1273ba", "message": "Use androidx preferences for Form Metadata", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "470c83a68d6f0193bd220ee044bcba20ceee5a8d", "url": "https://github.com/getodk/collect/commit/470c83a68d6f0193bd220ee044bcba20ceee5a8d", "message": "Enable copying on Form Metadata device details", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "90703206a0f5175359e5bf0c0feb9b6e00b35458", "url": "https://github.com/getodk/collect/commit/90703206a0f5175359e5bf0c0feb9b6e00b35458", "message": "Make Form Metadata titles more human", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "b4ad57f32a2e734394a2a1e1b7a10241e500930c", "url": "https://github.com/getodk/collect/commit/b4ad57f32a2e734394a2a1e1b7a10241e500930c", "message": "Make install ID pref non persistable", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "e61ed1d846cd4cbea10833812cd9c8b06111dd5d", "url": "https://github.com/getodk/collect/commit/e61ed1d846cd4cbea10833812cd9c8b06111dd5d", "message": "Rename new prefs activity layout", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "a0f6837c033519170225c68c5dfb86898d722d81", "url": "https://github.com/getodk/collect/commit/a0f6837c033519170225c68c5dfb86898d722d81", "message": "Use summary provider to load preferences managed by PropertyManager", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "44f5dd73d3a900d68f13cb27dec6ec1a5e1e6a95", "url": "https://github.com/getodk/collect/commit/44f5dd73d3a900d68f13cb27dec6ec1a5e1e6a95", "message": "Stop rotation creating problems for FormMetadataFragment", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "75b3576f970d64a29da36b1216a1b3c2eeeb054f", "url": "https://github.com/getodk/collect/commit/75b3576f970d64a29da36b1216a1b3c2eeeb054f", "message": "Stop using deprecated method for Dagger injection", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "4fe252727afeeb2fd57cdcc43d8dd6d7571dc5b5", "url": "https://github.com/getodk/collect/commit/4fe252727afeeb2fd57cdcc43d8dd6d7571dc5b5", "message": "Remove margin from preferences", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "b1c0bc3fb7e2155e2cf4ce719fae313d97422135", "url": "https://github.com/getodk/collect/commit/b1c0bc3fb7e2155e2cf4ce719fae313d97422135", "message": "Make sure installID lives outside of general prefs so it's not reset", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "fd60d5fa307b29cf2ed40b89c27b9bf5ecee4bf3", "url": "https://github.com/getodk/collect/commit/fd60d5fa307b29cf2ed40b89c27b9bf5ecee4bf3", "message": "Clear shared prefs before running tests", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "57d07c5d4e6820ae87497f46e9b8dbc0a89701c8", "url": "https://github.com/getodk/collect/commit/57d07c5d4e6820ae87497f46e9b8dbc0a89701c8", "message": "Use Dagger to manage singleton of GeneralSharedPreferences", "committedDate": "2020-02-24T10:48:27Z", "type": "commit"}, {"oid": "13dc7d6eea063ba8f1f7a5befe095678052a121b", "url": "https://github.com/getodk/collect/commit/13dc7d6eea063ba8f1f7a5befe095678052a121b", "message": "Use Dagger to manage singleton of AdminSharedPreferences", "committedDate": "2020-02-24T10:48:28Z", "type": "commit"}, {"oid": "a42e44491f3e14870cd962c727b7b0bda0a0c6c9", "url": "https://github.com/getodk/collect/commit/a42e44491f3e14870cd962c727b7b0bda0a0c6c9", "message": "Move FormMetadataPreferencesActivity declaration", "committedDate": "2020-02-24T10:48:28Z", "type": "commit"}, {"oid": "d8e14af7bb6aa8d50913f7cbb28fd6e4845b2adb", "url": "https://github.com/getodk/collect/commit/d8e14af7bb6aa8d50913f7cbb28fd6e4845b2adb", "message": "Revert \"Make Form Metadata titles more human\"\n\nThis reverts commit 0b0e99b9ae21bbd4bcb03833bd0dacc9fec03e9b.", "committedDate": "2020-02-24T10:48:28Z", "type": "commit"}, {"oid": "e5f97e8f2cb99d1537ad7adbbc84871c1be33256", "url": "https://github.com/getodk/collect/commit/e5f97e8f2cb99d1537ad7adbbc84871c1be33256", "message": "Add MetaSharedPreferencesProvider", "committedDate": "2020-02-24T10:48:28Z", "type": "commit"}, {"oid": "ddd2c079828702da8454055fad2684f2ec80baff", "url": "https://github.com/getodk/collect/commit/ddd2c079828702da8454055fad2684f2ec80baff", "message": "Don't use broken appcompat version", "committedDate": "2020-02-24T11:11:39Z", "type": "commit"}, {"oid": "ddd2c079828702da8454055fad2684f2ec80baff", "url": "https://github.com/getodk/collect/commit/ddd2c079828702da8454055fad2684f2ec80baff", "message": "Don't use broken appcompat version", "committedDate": "2020-02-24T11:11:39Z", "type": "forcePushed"}, {"oid": "caae73090ce47adab4286b3565fb20964734178f", "url": "https://github.com/getodk/collect/commit/caae73090ce47adab4286b3565fb20964734178f", "message": "Show not set message when device details aren't available", "committedDate": "2020-02-24T18:50:08Z", "type": "commit"}, {"oid": "f81851d5bea642a06e46e872f4ba978f5dce3c3f", "url": "https://github.com/getodk/collect/commit/f81851d5bea642a06e46e872f4ba978f5dce3c3f", "message": "Make sure only installID is copyable", "committedDate": "2020-02-24T18:53:34Z", "type": "commit"}, {"oid": "b43a45b38f6ba98526fe98b6447e299cd2c414d6", "url": "https://github.com/getodk/collect/commit/b43a45b38f6ba98526fe98b6447e299cd2c414d6", "message": "Improve preference not available string", "committedDate": "2020-02-24T19:29:48Z", "type": "commit"}, {"oid": "7f435d78e5670ea3f3f7c4f9f8ec2cf7ad1958a6", "url": "https://github.com/getodk/collect/commit/7f435d78e5670ea3f3f7c4f9f8ec2cf7ad1958a6", "message": "Use numeric keyboard for phone preference", "committedDate": "2020-02-25T12:30:49Z", "type": "commit"}]}