{"pr_number": 3749, "pr_title": "Keep logging analytics in one class", "pr_createdAt": "2020-03-30T11:22:46Z", "pr_url": "https://github.com/getodk/collect/pull/3749", "timeline": [{"oid": "14d5b4c13da30bef8c717b21a296684e323a1351", "url": "https://github.com/getodk/collect/commit/14d5b4c13da30bef8c717b21a296684e323a1351", "message": "Inject analytics to AutoSendWorker", "committedDate": "2020-03-30T09:59:26Z", "type": "commit"}, {"oid": "968dc3363d67c74ec078b47623e5a9ba95a0e86a", "url": "https://github.com/getodk/collect/commit/968dc3363d67c74ec078b47623e5a9ba95a0e86a", "message": "Use injected analytics in FormEntryActivity", "committedDate": "2020-03-30T09:59:26Z", "type": "commit"}, {"oid": "6bdcfe3d48ca0c1b207c64ef71cc406ffb28c82d", "url": "https://github.com/getodk/collect/commit/6bdcfe3d48ca0c1b207c64ef71cc406ffb28c82d", "message": "Inject analytics to SplashScreenActivity", "committedDate": "2020-03-30T09:59:26Z", "type": "commit"}, {"oid": "f3e7fa60503349665ba9a846d007830136772959", "url": "https://github.com/getodk/collect/commit/f3e7fa60503349665ba9a846d007830136772959", "message": "Use injected analytics in InstanceServerUploaderTask", "committedDate": "2020-03-30T09:59:26Z", "type": "commit"}, {"oid": "8134e17548bfcfd33ae39dd22b564a62e755e879", "url": "https://github.com/getodk/collect/commit/8134e17548bfcfd33ae39dd22b564a62e755e879", "message": "Inject analytics to FormHierarchyActivity", "committedDate": "2020-03-30T09:59:26Z", "type": "commit"}, {"oid": "55cbaf6f8675c34b9c0895b3e3cf57228973e36d", "url": "https://github.com/getodk/collect/commit/55cbaf6f8675c34b9c0895b3e3cf57228973e36d", "message": "Inject analytics to FormManagementPreferences", "committedDate": "2020-03-30T09:59:26Z", "type": "commit"}, {"oid": "a3a575262d16f8e34593e9f951551d0a965ecf72", "url": "https://github.com/getodk/collect/commit/a3a575262d16f8e34593e9f951551d0a965ecf72", "message": "Commented out analytics in SmsService since it's unused", "committedDate": "2020-03-30T10:16:08Z", "type": "commit"}, {"oid": "4a9f3b0f23e6200c5b56a2d8cf9c485e0c2ff8a4", "url": "https://github.com/getodk/collect/commit/4a9f3b0f23e6200c5b56a2d8cf9c485e0c2ff8a4", "message": "Inject analytics to GoogleSheetsUploaderActivity", "committedDate": "2020-03-30T10:16:17Z", "type": "commit"}, {"oid": "f538260c43ca261382027a334a4d40924b31c007", "url": "https://github.com/getodk/collect/commit/f538260c43ca261382027a334a4d40924b31c007", "message": "Pass analytics to SaveFormToDisk class", "committedDate": "2020-03-30T10:16:17Z", "type": "commit"}, {"oid": "43c6ad4fcd0eab5e2875de04b907d53c004c5939", "url": "https://github.com/getodk/collect/commit/43c6ad4fcd0eab5e2875de04b907d53c004c5939", "message": "Moved rest of the code related to analytics from Collect to FirebaseAnalytics", "committedDate": "2020-03-30T10:32:00Z", "type": "commit"}, {"oid": "a38bd6f6fd5f73c8e36e6fa3fd5ebca3812db236", "url": "https://github.com/getodk/collect/commit/a38bd6f6fd5f73c8e36e6fa3fd5ebca3812db236", "message": "Fixed FormSaveViewModelTest", "committedDate": "2020-03-30T10:46:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDIzNDc1OA==", "url": "https://github.com/getodk/collect/pull/3749#discussion_r400234758", "bodyText": "This could be constructor dependency right? Then there doesn't need to be any nullability risk in the object.", "author": "seadowg", "createdAt": "2020-03-30T14:26:41Z", "path": "collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java", "diffHunk": "@@ -430,6 +430,7 @@ private void setupViewModels() {\n                 .of(this, changesReasonViewModelFactory)\n                 .get(FormSaveViewModel.class);\n \n+        formSaveViewModel.setAnalytics(analytics);", "originalCommit": "a38bd6f6fd5f73c8e36e6fa3fd5ebca3812db236", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDc4NzQ4OQ==", "url": "https://github.com/getodk/collect/pull/3749#discussion_r400787489", "bodyText": "Right, done.", "author": "grzesiek2010", "createdAt": "2020-03-31T09:57:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDIzNDc1OA=="}], "type": "inlineReview", "revised_code": {"commit": "359799ccb5401182e53c869dbf5dad721d9428fc", "chunk": "diff --git a/collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java b/collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java\nindex 949e4f465..57aa75890 100644\n--- a/collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java\n+++ b/collect_app/src/main/java/org/odk/collect/android/activities/FormEntryActivity.java\n\n@@ -425,12 +423,11 @@ public class FormEntryActivity extends CollectAbstractActivity implements Animat\n             }\n         });\n \n-        FormSaveViewModel.Factory changesReasonViewModelFactory = new FormSaveViewModel.Factory();\n+        FormSaveViewModel.Factory changesReasonViewModelFactory = new FormSaveViewModel.Factory(analytics);\n         formSaveViewModel = ViewModelProviders\n                 .of(this, changesReasonViewModelFactory)\n                 .get(FormSaveViewModel.class);\n \n-        formSaveViewModel.setAnalytics(analytics);\n         formSaveViewModel.getSavedResult().observe(this, this::handleSaveResult);\n     }\n \n"}}, {"oid": "f90d9a72a6b6b50d3c671aac62b81b93812a562f", "url": "https://github.com/getodk/collect/commit/f90d9a72a6b6b50d3c671aac62b81b93812a562f", "message": "Fixed bug in FormEntryActivity - inject should be called first", "committedDate": "2020-03-31T09:25:19Z", "type": "commit"}, {"oid": "359799ccb5401182e53c869dbf5dad721d9428fc", "url": "https://github.com/getodk/collect/commit/359799ccb5401182e53c869dbf5dad721d9428fc", "message": "Pass analytics to FormSaveViewModel via constructor", "committedDate": "2020-03-31T09:46:41Z", "type": "forcePushed"}, {"oid": "7798fddbb19ca54c51ffc1471a56d39972a807a2", "url": "https://github.com/getodk/collect/commit/7798fddbb19ca54c51ffc1471a56d39972a807a2", "message": "Pass analytics to FormSaveViewModel via constructor", "committedDate": "2020-03-31T09:56:05Z", "type": "commit"}, {"oid": "7798fddbb19ca54c51ffc1471a56d39972a807a2", "url": "https://github.com/getodk/collect/commit/7798fddbb19ca54c51ffc1471a56d39972a807a2", "message": "Pass analytics to FormSaveViewModel via constructor", "committedDate": "2020-03-31T09:56:05Z", "type": "forcePushed"}]}