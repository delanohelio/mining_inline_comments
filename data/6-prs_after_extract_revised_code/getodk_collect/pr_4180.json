{"pr_number": 4180, "pr_title": "Use Foreground Service to manage audio recording", "pr_createdAt": "2020-10-22T16:17:06Z", "pr_url": "https://github.com/getodk/collect/pull/4180", "timeline": [{"oid": "b413d873dd40c8f8009370a73846a337283cf6bb", "url": "https://github.com/getodk/collect/commit/b413d873dd40c8f8009370a73846a337283cf6bb", "message": "Move to observer to trigger recorder activity finishing", "committedDate": "2020-10-22T15:44:25Z", "type": "commit"}, {"oid": "8b79acf65b8918514c54a3ca4595b4f045fb02d6", "url": "https://github.com/getodk/collect/commit/8b79acf65b8918514c54a3ca4595b4f045fb02d6", "message": "Use repository to store recording", "committedDate": "2020-10-22T15:44:25Z", "type": "commit"}, {"oid": "ed1ee2b4f1e2b374dc15996f806a8d1d8f6694b6", "url": "https://github.com/getodk/collect/commit/ed1ee2b4f1e2b374dc15996f806a8d1d8f6694b6", "message": "Move recording logic to service", "committedDate": "2020-10-22T15:44:25Z", "type": "commit"}, {"oid": "aeb113d01daa2d24d24785a03748a60a85091651", "url": "https://github.com/getodk/collect/commit/aeb113d01daa2d24d24785a03748a60a85091651", "message": "Make sure service cleans itself up", "committedDate": "2020-10-22T15:44:25Z", "type": "commit"}, {"oid": "d5abdbeb85609f4f151fa2d987731fa84ed2dbd7", "url": "https://github.com/getodk/collect/commit/d5abdbeb85609f4f151fa2d987731fa84ed2dbd7", "message": "Fix dodgy test", "committedDate": "2020-10-22T15:44:25Z", "type": "commit"}, {"oid": "daae056405871a3ad23236b358ab6738c3d058c9", "url": "https://github.com/getodk/collect/commit/daae056405871a3ad23236b358ab6738c3d058c9", "message": "Refactor clearing repo", "committedDate": "2020-10-22T15:44:25Z", "type": "commit"}, {"oid": "03da8c238c5fb402f375f4cae5899108d2d9dc4f", "url": "https://github.com/getodk/collect/commit/03da8c238c5fb402f375f4cae5899108d2d9dc4f", "message": "Handle don't keep activities case", "committedDate": "2020-10-22T15:44:26Z", "type": "commit"}, {"oid": "cd4e36f285a2a8a6a02046f497a6840c07d9c652", "url": "https://github.com/getodk/collect/commit/cd4e36f285a2a8a6a02046f497a6840c07d9c652", "message": "Show notification while recording", "committedDate": "2020-10-22T15:44:26Z", "type": "commit"}, {"oid": "8909b2ea88510be2075de323b83d74c22ef0b068", "url": "https://github.com/getodk/collect/commit/8909b2ea88510be2075de323b83d74c22ef0b068", "message": "Handle killing app from task manager case", "committedDate": "2020-10-22T15:44:26Z", "type": "commit"}, {"oid": "b13272ce075098b0b5747a9139e93324c65ee661", "url": "https://github.com/getodk/collect/commit/b13272ce075098b0b5747a9139e93324c65ee661", "message": "Style notification", "committedDate": "2020-10-22T15:44:26Z", "type": "commit"}, {"oid": "aea7a87d3fb9a9b123524c813b51fb47ca1066ee", "url": "https://github.com/getodk/collect/commit/aea7a87d3fb9a9b123524c813b51fb47ca1066ee", "message": "Make activity tests use real flow", "committedDate": "2020-10-22T15:44:26Z", "type": "commit"}, {"oid": "3f962b92dca09c82d45540b7f4f01ba0ceeea4ae", "url": "https://github.com/getodk/collect/commit/3f962b92dca09c82d45540b7f4f01ba0ceeea4ae", "message": "Move localization logic to strings package", "committedDate": "2020-10-22T15:44:26Z", "type": "commit"}, {"oid": "cef8ad37508948d1307c8203004f6df939c47c05", "url": "https://github.com/getodk/collect/commit/cef8ad37508948d1307c8203004f6df939c47c05", "message": "Use Robolectric test application to smooth out potential test problems", "committedDate": "2020-10-22T17:28:50Z", "type": "commit"}, {"oid": "c9bfcc4824428dcd5a8908d04015f59f66496978", "url": "https://github.com/getodk/collect/commit/c9bfcc4824428dcd5a8908d04015f59f66496978", "message": "Fix varargs passing", "committedDate": "2020-10-23T09:47:47Z", "type": "commit"}, {"oid": "5f5ae7f9420d54923b5c4169ae8862b938d1c87c", "url": "https://github.com/getodk/collect/commit/5f5ae7f9420d54923b5c4169ae8862b938d1c87c", "message": "Move string", "committedDate": "2020-10-23T10:15:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDc4NDk3MQ==", "url": "https://github.com/getodk/collect/pull/4180#discussion_r510784971", "bodyText": "I looked at moving the TranslationHandler to the strings module but it would have meant moving all our code that deals with the custom locale. I ended up favouring this solution where we keep the locale stuff in collect_app and just have the strings code expect to be given a locale.", "author": "seadowg", "createdAt": "2020-10-23T10:19:50Z", "path": "collect_app/src/main/java/org/odk/collect/android/application/Collect.java", "diffHunk": "@@ -33,15 +34,18 @@\n import org.odk.collect.android.preferences.PreferencesProvider;\n import org.odk.collect.android.storage.StoragePathProvider;\n import org.odk.collect.android.utilities.FileUtils;\n+import org.odk.collect.android.utilities.LocaleHelper;\n+import org.odk.collect.strings.LocalizedApplication;\n \n import java.io.ByteArrayInputStream;\n import java.io.File;\n+import java.util.Locale;\n \n import javax.inject.Inject;\n \n import static org.odk.collect.android.preferences.MetaKeys.KEY_GOOGLE_BUG_154855417_FIXED;\n \n-public class Collect extends Application {\n+public class Collect extends Application implements LocalizedApplication {", "originalCommit": "5f5ae7f9420d54923b5c4169ae8862b938d1c87c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}