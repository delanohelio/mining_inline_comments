{"pr_number": 1823, "pr_title": "add resource locking", "pr_createdAt": "2020-12-02T18:16:57Z", "pr_url": "https://github.com/fcrepo/fcrepo/pull/1823", "timeline": [{"oid": "9a8a08918a827178e71454f64b08c937735a6235", "url": "https://github.com/fcrepo/fcrepo/commit/9a8a08918a827178e71454f64b08c937735a6235", "message": "added archiveGroupId header", "committedDate": "2020-12-01T20:34:01Z", "type": "commit"}, {"oid": "e080448503cc3c075c743233a69959e303d97d5d", "url": "https://github.com/fcrepo/fcrepo/commit/e080448503cc3c075c743233a69959e303d97d5d", "message": "add resource locking", "committedDate": "2020-12-02T18:10:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDMwOQ==", "url": "https://github.com/fcrepo/fcrepo/pull/1823#discussion_r534480309", "bodyText": "Is this just going to be a log message? Seems like it could be a bigger problem or am I over estimating its severity?", "author": "whikloj", "createdAt": "2020-12-02T21:04:37Z", "path": "fcrepo-kernel-impl/src/main/java/org/fcrepo/kernel/impl/TransactionImpl.java", "diffHunk": "@@ -238,6 +255,12 @@ private void failIfRolledback() {\n         }\n     }\n \n+    private void releaseLocks() {\n+        execQuietly(\"Failed to release resource locks cleanly. You may need to restart Fedora.\", () -> {", "originalCommit": "e080448503cc3c075c743233a69959e303d97d5d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MTg5Nw==", "url": "https://github.com/fcrepo/fcrepo/pull/1823#discussion_r534481897", "bodyText": "It is highly unlikely to happen. I'm not even sure how to engineer it to happen. But, yes, if locks were not released, then the resources that were not unlocked would remain locked until Fedora was restarted.", "author": "pwinckles", "createdAt": "2020-12-02T21:07:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDQ4MDMwOQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "c7e9ade170bb80fea2d11dafbe0a7e3df6baef2e", "url": "https://github.com/fcrepo/fcrepo/commit/c7e9ade170bb80fea2d11dafbe0a7e3df6baef2e", "message": "reduce the number of concurrent requests to make the test flap less", "committedDate": "2020-12-03T17:03:55Z", "type": "commit"}, {"oid": "f0fcb95ed28c49c5b786251bf3e759bbfdb12a06", "url": "https://github.com/fcrepo/fcrepo/commit/f0fcb95ed28c49c5b786251bf3e759bbfdb12a06", "message": "further reduce concurrency...", "committedDate": "2020-12-03T17:15:53Z", "type": "commit"}, {"oid": "e783018324515ec5a10538293168a99923081ca7", "url": "https://github.com/fcrepo/fcrepo/commit/e783018324515ec5a10538293168a99923081ca7", "message": "changed to use the thread method to see if it works any better", "committedDate": "2020-12-03T17:46:31Z", "type": "commit"}, {"oid": "0f2cc0221767d1daf801456bfa3492ae64afd487", "url": "https://github.com/fcrepo/fcrepo/commit/0f2cc0221767d1daf801456bfa3492ae64afd487", "message": "and reduce concurrency again... :(", "committedDate": "2020-12-03T17:58:04Z", "type": "commit"}, {"oid": "2c6bbb060c6c2d4bf0e06e1d4fc5cfc04e4a0d5a", "url": "https://github.com/fcrepo/fcrepo/commit/2c6bbb060c6c2d4bf0e06e1d4fc5cfc04e4a0d5a", "message": "replaced flapping test with a transaction based test", "committedDate": "2020-12-03T18:29:53Z", "type": "commit"}]}