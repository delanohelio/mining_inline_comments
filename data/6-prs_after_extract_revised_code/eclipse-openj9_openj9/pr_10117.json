{"pr_number": 10117, "pr_title": "Fix searching with a method signature", "pr_createdAt": "2020-07-08T16:37:22Z", "pr_url": "https://github.com/eclipse-openj9/openj9/pull/10117", "timeline": [{"oid": "575a9573d5fbf77075bd299c890328d3267b321a", "url": "https://github.com/eclipse-openj9/openj9/commit/575a9573d5fbf77075bd299c890328d3267b321a", "message": "Fix searching with a method signature\n\nSigned-off-by: Keith W. Campbell <keithc@ca.ibm.com>", "committedDate": "2020-07-08T16:35:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY5ODk1NA==", "url": "https://github.com/eclipse-openj9/openj9/pull/10117#discussion_r451698954", "bodyText": "Just curious why you split the declaration and the initialization.", "author": "pshipton", "createdAt": "2020-07-08T17:09:26Z", "path": "debugtools/DDR_VM/src/com/ibm/j9ddr/vm29/tools/ddrinteractive/commands/MethodForNameCommand.java", "diffHunk": "@@ -68,85 +68,74 @@ public void run(String command, String[] args, Context context, PrintStream out)\n \t}\n \n \tint dbgGetMethodsForName(PrintStream out, String pattern) throws CorruptDataException {\n-\t\tint matchCount = 0;\n-\t\t// J9ClassWalkState walkState;\n-\t\tString classNeedle, methodNeedle, sigNeedle;\n-\t\tlong classMatchFlags, methodMatchFlags, sigMatchFlags;\n-\t\tString classStart, nameStart, sigStart;\n-\n-\t\tif (pattern.indexOf('.') != -1) {\n-\t\t\tnameStart = pattern.substring(pattern.indexOf('.') + 1); // skip the .\n-\t\t\tclassStart = pattern.substring(0, pattern.indexOf('.'));\n-\t\t} else {\n-\t\t\tclassStart = \"*\";\n-\t\t\tnameStart = pattern;\n-\t\t}\n+\t\tint dot = pattern.indexOf('.');\n+\t\tString classStart = (dot == -1) ? \"*\" : pattern.substring(0, dot);\n+\t\tint paren = pattern.indexOf('(', dot + 1);\n+\t\tString nameStart = (paren == -1) ? pattern.substring(dot + 1) : pattern.substring(dot + 1, paren);\n+\t\tString sigStart = (paren == -1) ? \"*\" : pattern.substring(paren);\n+\t\tStringBuffer needleBuffer;\n \n-\t\tif (pattern.indexOf('(') != -1) {\n-\t\t\tsigStart = pattern.substring(pattern.indexOf('('));\n-\t\t} else {\n-\t\t\tsigStart = \"*\";\n-\t\t}\n-\n-\t\tStringBuffer needleBuffer = new StringBuffer();\n-\t\tclassMatchFlags = WildCard.parseWildcard(classStart, needleBuffer);\n-\t\tclassNeedle = needleBuffer.toString();\n+\t\tneedleBuffer = new StringBuffer();", "originalCommit": "575a9573d5fbf77075bd299c890328d3267b321a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTc1OTAzMQ==", "url": "https://github.com/eclipse-openj9/openj9/pull/10117#discussion_r451759031", "bodyText": "needleBuffer is reused several times: in my opinion, it's misleading to put the first assignment into the declaration.", "author": "keithc-ca", "createdAt": "2020-07-08T18:54:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTY5ODk1NA=="}], "type": "inlineReview", "revised_code": null}]}