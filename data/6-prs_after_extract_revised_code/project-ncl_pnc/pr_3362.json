{"pr_number": 3362, "pr_title": "[NCL-5812] Change mappers to map DTORefs to Entity lazy reference", "pr_createdAt": "2020-10-22T15:59:02Z", "pr_url": "https://github.com/project-ncl/pnc/pull/3362", "timeline": [{"oid": "efdfc6effb70a9d8796d7e23a326cf01ec324f11", "url": "https://github.com/project-ncl/pnc/commit/efdfc6effb70a9d8796d7e23a326cf01ec324f11", "message": "[NCL-5812] Change mappers to map DTORefs to Entity lazy reference", "committedDate": "2020-10-26T11:24:13Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTk4MjcxMA==", "url": "https://github.com/project-ncl/pnc/pull/3362#discussion_r511982710", "bodyText": "You forgot to add RefToReferenceMapper in the mapper class imports.\nThere should additionally be @Mapping(target = \"targetRepository\", qualifiedBy = IdEntity.class)\nThis particular line made the AbstractArtifactMapperImpl use toEntity() method when mapping Build but it should use toEntityReference() method.\n(not a result of this PR) In AbstractArtifactMapperImpl::toDTO method, buildRecord is mapped with toDTO instead of toRef.", "author": "michalovjan", "createdAt": "2020-10-26T14:02:19Z", "path": "mapper/src/main/java/org/jboss/pnc/mapper/AbstractArtifactMapper.java", "diffHunk": "@@ -83,7 +83,7 @@\n     @Override\n     @Mapping(target = \"creationUser\", qualifiedBy = IdEntity.class)\n     @Mapping(target = \"modificationUser\", qualifiedBy = IdEntity.class)\n-    @Mapping(target = \"buildRecord\", source = \"build\", qualifiedBy = IdEntity.class)\n+    @Mapping(target = \"buildRecord\", source = \"build\")", "originalCommit": "efdfc6effb70a9d8796d7e23a326cf01ec324f11", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7e53593c4a2c68a28492d8b7cc96d39e3959f207", "chunk": "diff --git a/mapper/src/main/java/org/jboss/pnc/mapper/AbstractArtifactMapper.java b/mapper/src/main/java/org/jboss/pnc/mapper/AbstractArtifactMapper.java\nindex c2820c393..534aca770 100644\n--- a/mapper/src/main/java/org/jboss/pnc/mapper/AbstractArtifactMapper.java\n+++ b/mapper/src/main/java/org/jboss/pnc/mapper/AbstractArtifactMapper.java\n\n@@ -83,7 +82,7 @@ public abstract class AbstractArtifactMapper implements ArtifactMapper {\n     @Override\n     @Mapping(target = \"creationUser\", qualifiedBy = IdEntity.class)\n     @Mapping(target = \"modificationUser\", qualifiedBy = IdEntity.class)\n-    @Mapping(target = \"buildRecord\", source = \"build\")\n+    @Mapping(target = \"buildRecord\", source = \"build\", qualifiedBy = IdEntity.class)\n     @Mapping(target = \"dependantBuildRecords\", ignore = true)\n     /*\n      * Builder that MapStruct uses when generating mapper has method dependantBuildRecord() which confuses MapStruct as\n"}}, {"oid": "7e53593c4a2c68a28492d8b7cc96d39e3959f207", "url": "https://github.com/project-ncl/pnc/commit/7e53593c4a2c68a28492d8b7cc96d39e3959f207", "message": "[NCL-5812] Change mappers to map DTORefs to Entity lazy reference", "committedDate": "2020-10-27T15:45:37Z", "type": "forcePushed"}, {"oid": "afad8315421e3a530d3001185562c3041d770e18", "url": "https://github.com/project-ncl/pnc/commit/afad8315421e3a530d3001185562c3041d770e18", "message": "[NCL-5812] Change mappers to map DTORefs to Entity lazy reference", "committedDate": "2020-10-27T17:00:43Z", "type": "forcePushed"}, {"oid": "26622826b40d61e2fcaf6065ec77436cab0cbf1a", "url": "https://github.com/project-ncl/pnc/commit/26622826b40d61e2fcaf6065ec77436cab0cbf1a", "message": "[NCL-5812] Change mappers to map DTORefs to Entity lazy reference", "committedDate": "2020-10-29T12:38:32Z", "type": "commit"}, {"oid": "26622826b40d61e2fcaf6065ec77436cab0cbf1a", "url": "https://github.com/project-ncl/pnc/commit/26622826b40d61e2fcaf6065ec77436cab0cbf1a", "message": "[NCL-5812] Change mappers to map DTORefs to Entity lazy reference", "committedDate": "2020-10-29T12:38:32Z", "type": "forcePushed"}]}