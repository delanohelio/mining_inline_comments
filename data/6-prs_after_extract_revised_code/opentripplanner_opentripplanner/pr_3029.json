{"pr_number": 3029, "pr_title": "Bugfix: logging of unused parameters", "pr_createdAt": "2020-04-03T09:51:40Z", "pr_url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3029", "timeline": [{"oid": "1b804eef18e903b182d836163d36fc4e3d4a1ebd", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/1b804eef18e903b182d836163d36fc4e3d4a1ebd", "message": "Bugfix of unused parameters logging. The unused parameters node adapter stored\nchildren in a set, but the equals and hashCode was not correct implemented. So,\nfor nested config, only the first child would be listed. When printing unused\nparameters only the first child would be reported from.\n - Rename `logUnusedParameters` to `logAllUnusedParameters` and a JavaDoc to\n   clarify that this traverse the hole node three by recursion.", "committedDate": "2020-04-03T09:47:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk3ODI4Mw==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3029#discussion_r407978283", "bodyText": "This adds a logger to the class, but apparently no uses of that logger.", "author": "abyrd", "createdAt": "2020-04-14T09:01:38Z", "path": "src/main/java/org/opentripplanner/standalone/config/TransitRoutingConfig.java", "diffHunk": "@@ -2,12 +2,16 @@\n \n import org.opentripplanner.transit.raptor.api.request.DynamicSearchWindowCoefficients;\n import org.opentripplanner.transit.raptor.api.request.RaptorTuningParameters;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n \n /**\n  * @see RaptorTuningParameters for documentaion of tuning parameters.\n  */\n public final class TransitRoutingConfig implements RaptorTuningParameters {\n \n+    private static final Logger LOG = LoggerFactory.getLogger(TransitRoutingConfig.class);", "originalCommit": "1b804eef18e903b182d836163d36fc4e3d4a1ebd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2cd982113ef7c315870092815e0a6029e03949a2", "chunk": "diff --git a/src/main/java/org/opentripplanner/standalone/config/TransitRoutingConfig.java b/src/main/java/org/opentripplanner/standalone/config/TransitRoutingConfig.java\nindex aeb5c4449..326cabc6c 100644\n--- a/src/main/java/org/opentripplanner/standalone/config/TransitRoutingConfig.java\n+++ b/src/main/java/org/opentripplanner/standalone/config/TransitRoutingConfig.java\n\n@@ -10,8 +10,6 @@ import org.slf4j.LoggerFactory;\n  */\n public final class TransitRoutingConfig implements RaptorTuningParameters {\n \n-    private static final Logger LOG = LoggerFactory.getLogger(TransitRoutingConfig.class);\n-\n     private final int maxNumberOfTransfers;\n     private final int scheduledTripBinarySearchThreshold;\n     private final int iterationDepartureStepInSeconds;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk3ODY0NQ==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3029#discussion_r407978645", "bodyText": "This adds a logger to the class, but apparently no uses of that logger.", "author": "abyrd", "createdAt": "2020-04-14T09:02:13Z", "path": "src/main/java/org/opentripplanner/standalone/config/StorageConfig.java", "diffHunk": "@@ -39,6 +42,8 @@\n  */\n public class StorageConfig {\n \n+    private static final Logger LOG = LoggerFactory.getLogger(StorageConfig.class);", "originalCommit": "1b804eef18e903b182d836163d36fc4e3d4a1ebd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2cd982113ef7c315870092815e0a6029e03949a2", "chunk": "diff --git a/src/main/java/org/opentripplanner/standalone/config/StorageConfig.java b/src/main/java/org/opentripplanner/standalone/config/StorageConfig.java\nindex 0f64a11ea..7996284aa 100644\n--- a/src/main/java/org/opentripplanner/standalone/config/StorageConfig.java\n+++ b/src/main/java/org/opentripplanner/standalone/config/StorageConfig.java\n\n@@ -42,8 +42,6 @@ import java.util.List;\n  */\n public class StorageConfig {\n \n-    private static final Logger LOG = LoggerFactory.getLogger(StorageConfig.class);\n-\n     /**\n      * Local file system path to Google Cloud Platform service accounts credentials file. The\n      * credentials is used to access GCS urls. When using GCS from outside of the bucket cluster you\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk3OTQ3Mg==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/3029#discussion_r407979472", "bodyText": "This does correct the behavior of equals and hashcode, but since we're putting them in a list we probably don't even need semantic equality. Less stuff to maintain if we can determine they are not even needed...", "author": "abyrd", "createdAt": "2020-04-14T09:03:37Z", "path": "src/main/java/org/opentripplanner/standalone/config/NodeAdapter.java", "diffHunk": "@@ -335,13 +342,14 @@ public void logUnusedParameters(Logger log) {\n     public boolean equals(Object o) {\n         if (this == o) { return true; }\n         if (o == null || getClass() != o.getClass()) { return false; }\n-        NodeAdapter adapter = (NodeAdapter) o;\n-        return source.equals(adapter.source);\n+        NodeAdapter other = (NodeAdapter) o;\n+        return Objects.equals(source, other.source)\n+                && Objects.equals(contextPath, other.contextPath);\n     }\n \n     @Override\n     public int hashCode() {\n-        return Objects.hash(source);\n+        return Objects.hash(source, contextPath);", "originalCommit": "1b804eef18e903b182d836163d36fc4e3d4a1ebd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "2cd982113ef7c315870092815e0a6029e03949a2", "chunk": "diff --git a/src/main/java/org/opentripplanner/standalone/config/NodeAdapter.java b/src/main/java/org/opentripplanner/standalone/config/NodeAdapter.java\nindex e9f089c48..ef932e948 100644\n--- a/src/main/java/org/opentripplanner/standalone/config/NodeAdapter.java\n+++ b/src/main/java/org/opentripplanner/standalone/config/NodeAdapter.java\n\n@@ -338,20 +337,6 @@ public class NodeAdapter {\n         return unusedParams;\n     }\n \n-    @Override\n-    public boolean equals(Object o) {\n-        if (this == o) { return true; }\n-        if (o == null || getClass() != o.getClass()) { return false; }\n-        NodeAdapter other = (NodeAdapter) o;\n-        return Objects.equals(source, other.source)\n-                && Objects.equals(contextPath, other.contextPath);\n-    }\n-\n-    @Override\n-    public int hashCode() {\n-        return Objects.hash(source, contextPath);\n-    }\n-\n \n     /* private methods */\n \n"}}, {"oid": "2cd982113ef7c315870092815e0a6029e03949a2", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/2cd982113ef7c315870092815e0a6029e03949a2", "message": "Code review - Remove unused LOGs and remove hashCode and equals in NodeAdapter.", "committedDate": "2020-04-14T09:20:26Z", "type": "commit"}, {"oid": "a0c05de89d5e6bf0f5ee3a8d8669f30e596ff289", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/a0c05de89d5e6bf0f5ee3a8d8669f30e596ff289", "message": "Merge branch 'dev-2.x' into otp2_improve_config_loading_by_logging_unused_parameters", "committedDate": "2020-04-14T09:36:10Z", "type": "commit"}]}