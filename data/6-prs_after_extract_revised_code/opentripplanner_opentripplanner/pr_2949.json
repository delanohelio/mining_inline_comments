{"pr_number": 2949, "pr_title": "Remove stopIndex being incremented in GraphPathToTripPlanConverter. T\u2026", "pr_createdAt": "2020-01-31T13:00:01Z", "pr_url": "https://github.com/opentripplanner/OpenTripPlanner/pull/2949", "timeline": [{"oid": "ded6aadea9795c9654f7e97183cbc2444664e3fc", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/ded6aadea9795c9654f7e97183cbc2444664e3fc", "message": "Remove stopIndex being incremented in GraphPathToTripPlanConverter. This is now being done in ItineraryMapper", "committedDate": "2020-01-31T12:42:19Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NTM4Njc1Ng==", "url": "https://github.com/opentripplanner/OpenTripPlanner/pull/2949#discussion_r375386756", "bodyText": "The endOfLeg variable and edge parameter is no longer in use and should be removed.", "author": "t2gran", "createdAt": "2020-02-05T17:04:55Z", "path": "src/main/java/org/opentripplanner/api/resource/GraphPathToTripPlanConverter.java", "diffHunk": "@@ -863,10 +863,6 @@ private static Place makePlace(State state, Vertex vertex, Edge edge, Stop stop,\n             place.stopCode = stop.getCode();\n             place.platformCode = stop.getCode();\n             place.zoneId = stop.getZone();\n-            if (endOfLeg) place.stopIndex++;\n-            if (tripTimes != null) {\n-                place.stopSequence = tripTimes.getStopSequence(place.stopIndex);\n-            }", "originalCommit": "ded6aadea9795c9654f7e97183cbc2444664e3fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "095405dc528891f6cd023f19d2bac16cedbaad6f", "chunk": "diff --git a/src/main/java/org/opentripplanner/api/resource/GraphPathToTripPlanConverter.java b/src/main/java/org/opentripplanner/api/resource/GraphPathToTripPlanConverter.java\nindex eec3685be..b25fc142d 100644\n--- a/src/main/java/org/opentripplanner/api/resource/GraphPathToTripPlanConverter.java\n+++ b/src/main/java/org/opentripplanner/api/resource/GraphPathToTripPlanConverter.java\n\n@@ -855,8 +851,13 @@ public abstract class GraphPathToTripPlanConverter {\n         if (vertex instanceof StreetVertex && !(vertex instanceof TemporaryStreetLocation)) {\n             name = ((StreetVertex) vertex).getIntersectionName(requestedLocale).toString(requestedLocale);\n         }\n-        Place place = new Place(vertex.getX(), vertex.getY(), name,\n-                makeCalendar(state), makeCalendar(state));\n+        Place place = new Place(\n+                vertex.getX(),\n+                vertex.getY(),\n+                name,\n+                makeCalendar(state),\n+                makeCalendar(state)\n+        );\n \n         if (vertex instanceof TransitStopVertex) {\n             place.stopId = stop.getId();\n"}}, {"oid": "095405dc528891f6cd023f19d2bac16cedbaad6f", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/095405dc528891f6cd023f19d2bac16cedbaad6f", "message": "Code review - Unused 'endOfLeg' variable and 'edge' parameter is removed.", "committedDate": "2020-02-05T17:07:03Z", "type": "commit"}, {"oid": "60d3cf5e233e4d63870059c2e3dbc8aaa32c97e7", "url": "https://github.com/opentripplanner/OpenTripPlanner/commit/60d3cf5e233e4d63870059c2e3dbc8aaa32c97e7", "message": "Merge remote-tracking branch 'otp/dev-2.x' into otp2_stopindex_bugfix", "committedDate": "2020-02-05T17:13:06Z", "type": "commit"}]}