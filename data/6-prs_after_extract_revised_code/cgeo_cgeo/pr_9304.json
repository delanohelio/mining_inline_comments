{"pr_number": 9304, "pr_title": "lint changes/fixes", "pr_createdAt": "2020-10-27T23:15:16Z", "pr_url": "https://github.com/cgeo/cgeo/pull/9304", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMDU3Nw==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513720577", "bodyText": "I don't think we need a Locale for SimpleDateFormat as we give an explicit format string, but it should not harm either. (Valid for the other occurrences of SimpleDateFormat as well.)", "author": "moving-bits", "createdAt": "2020-10-28T19:54:16Z", "path": "main/src/cgeo/geocaching/export/TrailHistoryExport.java", "diffHunk": "@@ -113,7 +113,7 @@ protected File doInBackgroundInternal(final TrailHistoryElement[] trail) {\n                 gpx.attribute(\"\", \"creator\", \"c:geo - http://www.cgeo.org/\");\n                 gpx.attribute(NS_XSI, \"schemaLocation\", NS_GPX + \" \" + GPX_SCHEMA);\n \n-                    final SimpleDateFormat formatter = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ss'Z'\");\n+                    final SimpleDateFormat formatter = new SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ss'Z'\", Locale.US);", "originalCommit": "dae411359f368c513a3b0ee9473f9c98659aca67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc1Njk3Nw==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513756977", "bodyText": "See the lint message:\nhttps://ci.cgeo.org/job/cgeo%20continuous%20integration/3057/androidLintResult/type.-11914057/file.-1822116914/", "author": "bekuno", "createdAt": "2020-10-28T21:00:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMDU3Nw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMTY3MA==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513721670", "bodyText": "Shouldn't we use the user's locale here (maybe default locale)?\nUsing Locale.US would format decimal numbers with a decimal point instead.", "author": "moving-bits", "createdAt": "2020-10-28T19:56:04Z", "path": "main/src/cgeo/geocaching/CompassActivity.java", "diffHunk": "@@ -408,7 +409,7 @@ private void updateDeviceHeadingAndOrientation(final DirectionData dir) {\n         while (direction >= 360f) {\n             direction -= 360f;\n         }\n-        deviceHeading.setText(String.format(\"%3.1f\u00b0\", direction));\n+        deviceHeading.setText(String.format(Locale.US, \"%3.1f\u00b0\", direction));", "originalCommit": "dae411359f368c513a3b0ee9473f9c98659aca67", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzczNTkwMg==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513735902", "bodyText": "That would have been my original intention. But if language specific separators are preferred that's fine for me too.", "author": "eddiemuc", "createdAt": "2020-10-28T20:22:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMTY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc1NTgxMw==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513755813", "bodyText": "1:1\nAnd I would leave the decition to you ...\nOk, I will change it.", "author": "bekuno", "createdAt": "2020-10-28T20:58:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMTY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzc2MTU0OQ==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513761549", "bodyText": "Thanks. If I was looking at the right part of the dialog, it's localized in current release (probably due to implicit use of default locale).", "author": "moving-bits", "createdAt": "2020-10-28T21:08:29Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMTY3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzgwNTAyOA==", "url": "https://github.com/cgeo/cgeo/pull/9304#discussion_r513805028", "bodyText": "done", "author": "bekuno", "createdAt": "2020-10-28T22:42:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcyMTY3MA=="}], "type": "inlineReview", "revised_code": {"commit": "541171d91e32f8aaab86ea709a2f3a467e61ab37", "chunk": "diff --git a/main/src/cgeo/geocaching/CompassActivity.java b/main/src/cgeo/geocaching/CompassActivity.java\nindex 5d39c8d81..9b47108b0 100644\n--- a/main/src/cgeo/geocaching/CompassActivity.java\n+++ b/main/src/cgeo/geocaching/CompassActivity.java\n\n@@ -409,7 +409,7 @@ public class CompassActivity extends AbstractActionBarActivity {\n         while (direction >= 360f) {\n             direction -= 360f;\n         }\n-        deviceHeading.setText(String.format(Locale.US, \"%3.1f\u00b0\", direction));\n+        deviceHeading.setText(String.format(Locale.getDefault(), \"%3.1f\u00b0\", direction));\n \n         if (deviceOrientationMode.get() == DirectionData.DeviceOrientation.AUTO) {\n             deviceOrientationMode.setTextDisplayMapper(d -> getString(R.string.device_orientation) + \": \" + getString(dir.getDeviceOrientation().resId) + \" (\" + getString(DirectionData.DeviceOrientation.AUTO.resId) + \")\");\n"}}, {"oid": "541171d91e32f8aaab86ea709a2f3a467e61ab37", "url": "https://github.com/cgeo/cgeo/commit/541171d91e32f8aaab86ea709a2f3a467e61ab37", "message": "lint changes/fixes\n\n- categorie Correctness\n  - type DefaultLocale:\n    Implicitly using the default locale is a common source of bugs: Use `String.format(Locale, ...)` instead\n    - CalculatorVariable.java\n\t- CompassActivity.java\n\t- Log.java\n  - type SimpleDateFormat:\n    To get local formatting use `getDateInstance()`, `getDateTimeInstance()`, or `getTimeInstance()`, or use `new SimpleDateFormat(String template, Locale locale)` with for example `Locale.US` for ASCII dates.\n    - ContextLogger.java\n\t- Formatter.java\n\t- TrailHistoryExport.java", "committedDate": "2020-10-28T22:41:23Z", "type": "commit"}, {"oid": "541171d91e32f8aaab86ea709a2f3a467e61ab37", "url": "https://github.com/cgeo/cgeo/commit/541171d91e32f8aaab86ea709a2f3a467e61ab37", "message": "lint changes/fixes\n\n- categorie Correctness\n  - type DefaultLocale:\n    Implicitly using the default locale is a common source of bugs: Use `String.format(Locale, ...)` instead\n    - CalculatorVariable.java\n\t- CompassActivity.java\n\t- Log.java\n  - type SimpleDateFormat:\n    To get local formatting use `getDateInstance()`, `getDateTimeInstance()`, or `getTimeInstance()`, or use `new SimpleDateFormat(String template, Locale locale)` with for example `Locale.US` for ASCII dates.\n    - ContextLogger.java\n\t- Formatter.java\n\t- TrailHistoryExport.java", "committedDate": "2020-10-28T22:41:23Z", "type": "forcePushed"}]}