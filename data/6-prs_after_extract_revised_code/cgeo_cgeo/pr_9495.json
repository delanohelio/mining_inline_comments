{"pr_number": 9495, "pr_title": "rel to #9488: report db problem to user", "pr_createdAt": "2020-12-05T10:27:24Z", "pr_url": "https://github.com/cgeo/cgeo/pull/9495", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkwNTc3Nw==", "url": "https://github.com/cgeo/cgeo/pull/9495#discussion_r536905777", "bodyText": "We should make this translatable, shouldn't we?", "author": "Lineflyer", "createdAt": "2020-12-05T22:35:13Z", "path": "main/src/cgeo/geocaching/MainActivity.java", "diffHunk": "@@ -278,6 +278,16 @@ public void onCreate(final Bundle savedInstanceState) {\n         // don't call the super implementation with the layout argument, as that would set the wrong theme\n         super.onCreate(savedInstanceState);\n \n+        //check database\n+        final String errorMsg = DataStore.initAndCheck(false);\n+        if (errorMsg != null) {\n+           Dialogs.message(this, \"Fatal DB error - please report\",\n+               \"Fatal error while trying to open/create cache database. \" +\n+                   \"c:geo cannot be used in this state.\\n\\n\" +\n+                   \"Please support us in analyzing and fixing this problem by report it via Settings -> System -> Generate logfile. \" +\n+                   \"\\n\\n[\" + errorMsg + \"]\");\n+        }", "originalCommit": "4c5d00d85f6beddfc1bd2800ef03bc02ec64f8de", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkxMjc1OA==", "url": "https://github.com/cgeo/cgeo/pull/9495#discussion_r536912758", "bodyText": "IMHO we shouldn't as this is only a hopefully temporary debug feature...", "author": "fm-sys", "createdAt": "2020-12-05T23:24:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkwNTc3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkxNDU3NA==", "url": "https://github.com/cgeo/cgeo/pull/9495#discussion_r536914574", "bodyText": "OK then.", "author": "Lineflyer", "createdAt": "2020-12-05T23:38:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkwNTc3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNzAxMzc3OA==", "url": "https://github.com/cgeo/cgeo/pull/9495#discussion_r537013778", "bodyText": "Actually, I made strings translateable now because it is now part of a bigger \"user can report problem\" solution", "author": "eddiemuc", "createdAt": "2020-12-06T10:59:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjkwNTc3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "113c563ea7b99ae7e3b10db539df1f906c8aea81", "chunk": "diff --git a/main/src/cgeo/geocaching/MainActivity.java b/main/src/cgeo/geocaching/MainActivity.java\nindex 174a98177..d05f8c184 100644\n--- a/main/src/cgeo/geocaching/MainActivity.java\n+++ b/main/src/cgeo/geocaching/MainActivity.java\n\n@@ -281,11 +282,7 @@ public class MainActivity extends AbstractActionBarActivity {\n         //check database\n         final String errorMsg = DataStore.initAndCheck(false);\n         if (errorMsg != null) {\n-           Dialogs.message(this, \"Fatal DB error - please report\",\n-               \"Fatal error while trying to open/create cache database. \" +\n-                   \"c:geo cannot be used in this state.\\n\\n\" +\n-                   \"Please support us in analyzing and fixing this problem by report it via Settings -> System -> Generate logfile. \" +\n-                   \"\\n\\n[\" + errorMsg + \"]\");\n+            DebugUtils.askUserToReportProblem(this, \"Fatal DB error: \" + errorMsg);\n         }\n \n         // Disable the up navigation for this activity\n"}}, {"oid": "113c563ea7b99ae7e3b10db539df1f906c8aea81", "url": "https://github.com/cgeo/cgeo/commit/113c563ea7b99ae7e3b10db539df1f906c8aea81", "message": "rel to #9488: report db problem to user, allow for direct problem reporting", "committedDate": "2020-12-06T10:54:13Z", "type": "forcePushed"}, {"oid": "7ebd555d2236c4b93969c1119c7b68a5fd6636f0", "url": "https://github.com/cgeo/cgeo/commit/7ebd555d2236c4b93969c1119c7b68a5fd6636f0", "message": "rel to #9488: report db problem to user, allow for direct problem reporting", "committedDate": "2020-12-06T13:27:19Z", "type": "commit"}, {"oid": "7ebd555d2236c4b93969c1119c7b68a5fd6636f0", "url": "https://github.com/cgeo/cgeo/commit/7ebd555d2236c4b93969c1119c7b68a5fd6636f0", "message": "rel to #9488: report db problem to user, allow for direct problem reporting", "committedDate": "2020-12-06T13:27:19Z", "type": "forcePushed"}]}