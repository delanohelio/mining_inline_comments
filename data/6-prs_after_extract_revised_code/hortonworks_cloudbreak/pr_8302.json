{"pr_number": 8302, "pr_title": "CB-7479: Update the service name for DEX", "pr_createdAt": "2020-06-16T20:18:53Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8302", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU1MzIzMw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8302#discussion_r441553233", "bodyText": "I have concerns about backwards compatibility. This will mean that you will need to synchronize the change for our internal accounts (I know DEX is not yet used on prod). I think it might be simpler to coordinate to add DE now and then remove DEX after everything has been moved to DE. I will let the DEX team decide what they want to do, since they know better than me if they are currently using DEX anywhere or if this change is to fix something which was already updated on the DEX side.", "author": "jamisonbennett", "createdAt": "2020-06-17T13:40:40Z", "path": "common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java", "diffHunk": "@@ -159,7 +159,7 @@ public static Partition safeFromString(String input) {\n         FREEIPA(\"freeipa\", NON_ADMIN_SERVICE),\n         DATAHUB(\"datahub\", NON_ADMIN_SERVICE),\n         DATALAKE(\"datalake\", NON_ADMIN_SERVICE),\n-        DEX(\"dex\", NON_ADMIN_SERVICE),\n+        DE(\"de\", NON_ADMIN_SERVICE),", "originalCommit": "6690c0ff0b1ae95e812eee8fe74ca3bb1ddd6c42", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY5NTU5MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8302#discussion_r441695591", "bodyText": "@jamisonbennett good point. Yes this would mean we need to recreate any existing environments people may be using esp the ones used by QE team for testing. I can add DE as a new option here so that existing flows would continue to work. Once everyone migrates over raise another patch to remove DEX.", "author": "arunmahadevan", "createdAt": "2020-06-17T17:04:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTU1MzIzMw=="}], "type": "inlineReview", "revised_code": {"commit": "8d44e46bdbd4804d633507cdf470ca0e2d215649", "chunk": "diff --git a/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java b/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java\nindex 05ca1566c6..371dbb5817 100644\n--- a/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java\n+++ b/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java\n\n@@ -159,6 +159,7 @@ public class Crn {\n         FREEIPA(\"freeipa\", NON_ADMIN_SERVICE),\n         DATAHUB(\"datahub\", NON_ADMIN_SERVICE),\n         DATALAKE(\"datalake\", NON_ADMIN_SERVICE),\n+        DEX(\"dex\", NON_ADMIN_SERVICE), // TODO: remove this once all DEX enviroments migrate over to DE\n         DE(\"de\", NON_ADMIN_SERVICE),\n         ACCOUNTTAG(\"accounttag\", NON_ADMIN_SERVICE),\n         ACCOUNTTELEMETRY(\"accounttelemetry\", NON_ADMIN_SERVICE),\n"}}, {"oid": "8d44e46bdbd4804d633507cdf470ca0e2d215649", "url": "https://github.com/hortonworks/cloudbreak/commit/8d44e46bdbd4804d633507cdf470ca0e2d215649", "message": "CB-7479: Update the service name for DEX\n\nUpdate the CRN service name for DEX to match with the thunderhead\nservice name (defined in Crn.java in the thunderhead repo).\n\nRefer: https://github.infra.cloudera.com/thunderhead/thunderhead/blob/master/services/libs/protocols/src/main/java/com/cloudera/thunderhead/service/common/crn/Crn.java", "committedDate": "2020-06-17T17:06:38Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTcxMTI0MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8302#discussion_r441711240", "bodyText": "@arunmahadevan Checkstyle is failing with \"Don't use trailing comments.\" You should follow the style we use for deprecating these. Refer to \"SDX\" above.\n/**\n  * @deprecated {@link #DEX} was replaced by {@link #DE} and is kept here for backwards compatibility.\n  */\n@Deprecated\nDEX(\"dex\", NON_ADMIN_SERVICE)", "author": "kmanamcheri", "createdAt": "2020-06-17T17:30:47Z", "path": "common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java", "diffHunk": "@@ -159,7 +159,8 @@ public static Partition safeFromString(String input) {\n         FREEIPA(\"freeipa\", NON_ADMIN_SERVICE),\n         DATAHUB(\"datahub\", NON_ADMIN_SERVICE),\n         DATALAKE(\"datalake\", NON_ADMIN_SERVICE),\n-        DEX(\"dex\", NON_ADMIN_SERVICE),\n+        DEX(\"dex\", NON_ADMIN_SERVICE), // TODO: remove this once all DEX enviroments migrate over to DE", "originalCommit": "8d44e46bdbd4804d633507cdf470ca0e2d215649", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTcyNjY1NQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8302#discussion_r441726655", "bodyText": "Updated.", "author": "arunmahadevan", "createdAt": "2020-06-17T17:56:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTcxMTI0MA=="}], "type": "inlineReview", "revised_code": {"commit": "89d60442445f9fbf5e0449310a299722112dbf06", "chunk": "diff --git a/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java b/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java\nindex 371dbb5817..e089373585 100644\n--- a/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java\n+++ b/common/src/main/java/com/sequenceiq/cloudbreak/auth/altus/Crn.java\n\n@@ -159,7 +159,11 @@ public class Crn {\n         FREEIPA(\"freeipa\", NON_ADMIN_SERVICE),\n         DATAHUB(\"datahub\", NON_ADMIN_SERVICE),\n         DATALAKE(\"datalake\", NON_ADMIN_SERVICE),\n-        DEX(\"dex\", NON_ADMIN_SERVICE), // TODO: remove this once all DEX enviroments migrate over to DE\n+        /**\n+         * @deprecated {@link #DEX} was replaced by {@link #DE} and is kept here for backward compatibility.\n+         */\n+        @Deprecated\n+        DEX(\"dex\", NON_ADMIN_SERVICE),\n         DE(\"de\", NON_ADMIN_SERVICE),\n         ACCOUNTTAG(\"accounttag\", NON_ADMIN_SERVICE),\n         ACCOUNTTELEMETRY(\"accounttelemetry\", NON_ADMIN_SERVICE),\n"}}, {"oid": "89d60442445f9fbf5e0449310a299722112dbf06", "url": "https://github.com/hortonworks/cloudbreak/commit/89d60442445f9fbf5e0449310a299722112dbf06", "message": "CB-7479: Update the service name for DEX\n\nUpdate the CRN service name for DEX to match with the thunderhead\nservice name (defined in Crn.java in the thunderhead repo).\n\nRefer: https://github.infra.cloudera.com/thunderhead/thunderhead/blob/master/services/libs/protocols/src/main/java/com/cloudera/thunderhead/service/common/crn/Crn.java", "committedDate": "2020-06-17T17:53:01Z", "type": "commit"}, {"oid": "89d60442445f9fbf5e0449310a299722112dbf06", "url": "https://github.com/hortonworks/cloudbreak/commit/89d60442445f9fbf5e0449310a299722112dbf06", "message": "CB-7479: Update the service name for DEX\n\nUpdate the CRN service name for DEX to match with the thunderhead\nservice name (defined in Crn.java in the thunderhead repo).\n\nRefer: https://github.infra.cloudera.com/thunderhead/thunderhead/blob/master/services/libs/protocols/src/main/java/com/cloudera/thunderhead/service/common/crn/Crn.java", "committedDate": "2020-06-17T17:53:01Z", "type": "forcePushed"}]}