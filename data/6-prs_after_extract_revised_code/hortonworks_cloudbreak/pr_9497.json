{"pr_number": 9497, "pr_title": "CB-9925 HDFS service health warnings", "pr_createdAt": "2020-11-23T20:26:29Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9497", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTIyNzkzMA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9497#discussion_r529227930", "bodyText": "Are you sure it accepts multiple volumes?  I tried to look up at multiple docs and I found it's a single volume only, but I'm not 100% sure.", "author": "keyki", "createdAt": "2020-11-24T06:20:56Z", "path": "template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/hdfs/HdfsVolumeConfigProvider.java", "diffHunk": "@@ -40,7 +39,7 @@\n             case HdfsRoles.JOURNALNODE:\n                 return List.of(\n                         config(\"dfs_journalnode_edits_dir\",\n-                                buildSingleVolumePath(volumeCount, \"journalnode\"))\n+                                buildVolumePathStringZeroVolumeHandled(volumeCount, \"journalnode\"))", "originalCommit": "d0cebc02a38e63c4ddeac00522b40d10538c861f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTI2OTQ0Mw==", "url": "https://github.com/hortonworks/cloudbreak/pull/9497#discussion_r529269443", "bodyText": "I think this is the HDFS code where the property is used, seems to confirm your findings:\nhttps://github.com/apache/hadoop/blob/c4ba0ab7dfcfe76f928d06fcb29ca0cc4d778737/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/qjournal/server/JournalNode.java#L178-L182\nhttps://github.com/apache/hadoop/blob/c4ba0ab7dfcfe76f928d06fcb29ca0cc4d778737/hadoop-hdfs-project/hadoop-hdfs/src/main/java/org/apache/hadoop/hdfs/qjournal/server/JournalNode.java#L335-L340", "author": "adoroszlai", "createdAt": "2020-11-24T07:57:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTIyNzkzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTY2NTI2Ng==", "url": "https://github.com/hortonworks/cloudbreak/pull/9497#discussion_r529665266", "bodyText": "Yea based on the code @adoroszlai shared and also the docs in hdfs-default.xml:\n<property>\n  <name>dfs.journalnode.edits.dir</name>\n  <value>/tmp/hadoop/dfs/journalnode/</value>\n  <description>\n    The directory where the journal edit files are stored.\n  </description>\n</property>\n\nThe journal edits dir can only have a single value. This makes it different from the NN data directory where the namenode can have a comma separated list of directories.", "author": "sodonnel", "createdAt": "2020-11-24T15:49:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTIyNzkzMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTY3NzM4MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/9497#discussion_r529677381", "bodyText": "And fixed.", "author": "frozenwizard", "createdAt": "2020-11-24T15:57:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyOTIyNzkzMA=="}], "type": "inlineReview", "revised_code": {"commit": "fd1b2042bd73ff6e1592fbbe9c1b166a4df06496", "chunk": "diff --git a/template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/hdfs/HdfsVolumeConfigProvider.java b/template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/hdfs/HdfsVolumeConfigProvider.java\nindex 02ae66bece..da2ca7f5e2 100644\n--- a/template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/hdfs/HdfsVolumeConfigProvider.java\n+++ b/template-manager-cmtemplate/src/main/java/com/sequenceiq/cloudbreak/cmtemplate/configproviders/hdfs/HdfsVolumeConfigProvider.java\n\n@@ -39,7 +40,7 @@ public class HdfsVolumeConfigProvider implements CmHostGroupRoleConfigProvider {\n             case HdfsRoles.JOURNALNODE:\n                 return List.of(\n                         config(\"dfs_journalnode_edits_dir\",\n-                                buildVolumePathStringZeroVolumeHandled(volumeCount, \"journalnode\"))\n+                                buildSingleVolumePath(volumeCount, \"journalnode\"))\n                 );\n             default:\n                 return List.of();\n"}}, {"oid": "fd1b2042bd73ff6e1592fbbe9c1b166a4df06496", "url": "https://github.com/hortonworks/cloudbreak/commit/fd1b2042bd73ff6e1592fbbe9c1b166a4df06496", "message": "CB-9925 HDFS service health warnings\n\nThis removes the setting of dfs_journalnode_edits_dir from the medium\nduty blueprints.", "committedDate": "2020-11-24T15:56:42Z", "type": "forcePushed"}, {"oid": "e156c4c46fbc6442a41cb3ffc594a58d64b775d2", "url": "https://github.com/hortonworks/cloudbreak/commit/e156c4c46fbc6442a41cb3ffc594a58d64b775d2", "message": "CB-9925 HDFS service health warnings\n\nThis removes the setting of dfs_journalnode_edits_dir from the medium\nduty blueprints.", "committedDate": "2020-11-24T16:42:32Z", "type": "commit"}, {"oid": "e156c4c46fbc6442a41cb3ffc594a58d64b775d2", "url": "https://github.com/hortonworks/cloudbreak/commit/e156c4c46fbc6442a41cb3ffc594a58d64b775d2", "message": "CB-9925 HDFS service health warnings\n\nThis removes the setting of dfs_journalnode_edits_dir from the medium\nduty blueprints.", "committedDate": "2020-11-24T16:42:32Z", "type": "forcePushed"}]}