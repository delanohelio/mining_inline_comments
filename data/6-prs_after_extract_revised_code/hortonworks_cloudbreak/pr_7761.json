{"pr_number": 7761, "pr_title": "CB-6380. Do not persist telemetry component for stack with template type", "pr_createdAt": "2020-04-08T13:28:20Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/7761", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjE1MDU5Nw==", "url": "https://github.com/hortonworks/cloudbreak/pull/7761#discussion_r406150597", "bodyText": "can you move into the else branch? or inside to convertAsStack(source, stack)", "author": "topolyai5", "createdAt": "2020-04-09T11:53:29Z", "path": "core/src/main/java/com/sequenceiq/cloudbreak/converter/v4/stacks/StackV4RequestToStackConverter.java", "diffHunk": "@@ -139,8 +139,9 @@ public Stack convert(StackV4Request source) {\n         stack.setInstanceGroups(convertInstanceGroups(source, stack));\n         measure(() -> updateCluster(source, stack, workspace),\n                 LOGGER, \"Converted cluster and updated the stack in {} ms for stack {}\", source.getName());\n-        stack.getComponents().add(getTelemetryComponent(stack, source));\n-\n+        if (!isTemplate(source)) {", "originalCommit": "21f2e53a3469742dc902b9d13032fac60a2df864", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d8cddd881245b0b8298d626c7f9e61c742f094e1", "chunk": "diff --git a/core/src/main/java/com/sequenceiq/cloudbreak/converter/v4/stacks/StackV4RequestToStackConverter.java b/core/src/main/java/com/sequenceiq/cloudbreak/converter/v4/stacks/StackV4RequestToStackConverter.java\nindex 54f86f28b0..3a599ce6e7 100644\n--- a/core/src/main/java/com/sequenceiq/cloudbreak/converter/v4/stacks/StackV4RequestToStackConverter.java\n+++ b/core/src/main/java/com/sequenceiq/cloudbreak/converter/v4/stacks/StackV4RequestToStackConverter.java\n\n@@ -139,9 +140,6 @@ public class StackV4RequestToStackConverter extends AbstractConversionServiceAwa\n         stack.setInstanceGroups(convertInstanceGroups(source, stack));\n         measure(() -> updateCluster(source, stack, workspace),\n                 LOGGER, \"Converted cluster and updated the stack in {} ms for stack {}\", source.getName());\n-        if (!isTemplate(source)) {\n-            stack.getComponents().add(getTelemetryComponent(stack, source));\n-        }\n         stack.setGatewayPort(source.getGatewayPort());\n         stack.setUuid(UUID.randomUUID().toString());\n         stack.setType(source.getType());\n"}}, {"oid": "d8cddd881245b0b8298d626c7f9e61c742f094e1", "url": "https://github.com/hortonworks/cloudbreak/commit/d8cddd881245b0b8298d626c7f9e61c742f094e1", "message": "CB-6380. Do not persist telemetry component for stack with template type.", "committedDate": "2020-04-09T12:13:30Z", "type": "commit"}, {"oid": "d8cddd881245b0b8298d626c7f9e61c742f094e1", "url": "https://github.com/hortonworks/cloudbreak/commit/d8cddd881245b0b8298d626c7f9e61c742f094e1", "message": "CB-6380. Do not persist telemetry component for stack with template type.", "committedDate": "2020-04-09T12:13:30Z", "type": "forcePushed"}]}