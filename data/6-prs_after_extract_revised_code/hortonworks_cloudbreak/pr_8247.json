{"pr_number": 8247, "pr_title": "CB-6619-Optimize-CB-ClusterSync", "pr_createdAt": "2020-06-09T15:48:15Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8247", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4NDg2Mw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438084863", "bodyText": "is it unnecessary?", "author": "topolyai5", "createdAt": "2020-06-10T12:32:20Z", "path": "autoscale/src/main/java/com/sequenceiq/periscope/service/security/TlsHttpClientConfigurationService.java", "diffHunk": "@@ -35,7 +35,7 @@ public HttpClientConfig buildTLSClientConfig(String stackCrn, String host, Tunne\n         Optional<String> clusterProxyUrl = clusterProxyConfigurationService.getClusterProxyUrl();\n         HttpClientConfig httpClientConfig =\n                 new HttpClientConfig(host, tlsConfiguration.getServerCert(), tlsConfiguration.getClientCert(), tlsConfiguration.getClientKey());\n-        if (clusterProxyUrl.isPresent() && tunnel.useClusterProxy()) {\n+        if (clusterProxyUrl.isPresent()) {", "originalCommit": "03a89725d3a7c9d03daa8828be27e31509040cb8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODEwNjUyNg==", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438106526", "bodyText": "Yes clusterProxy registration always happens even if tunnel is direct and even Cluster Yarn Metrics are always queried through clusterProxy since Cluster via IP is not always reachable.", "author": "smaniraju", "createdAt": "2020-06-10T13:06:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA4NDg2Mw=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ1OTg0OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438459848", "bodyText": "Nit: Remove the reference and import since the stackCollectorService isn't used here.", "author": "sidseth", "createdAt": "2020-06-10T23:23:16Z", "path": "autoscale/src/main/java/com/sequenceiq/periscope/service/ha/LeaderElectionService.java", "diffHunk": "@@ -126,7 +114,6 @@ public void leaderElection() {\n                     @Override\n                     public void run() {\n                         try {\n-                            stackCollectorService.collectStackDetails();", "originalCommit": "03a89725d3a7c9d03daa8828be27e31509040cb8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ2Mjc2MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438462761", "bodyText": "Maybe also remove the entire StackCollectorService class if it is not used elsewhere.", "author": "sidseth", "createdAt": "2020-06-10T23:33:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ1OTg0OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODYyNTk1Mw==", "url": "https://github.com/hortonworks/cloudbreak/pull/8247#discussion_r438625953", "bodyText": "Removed the unused inject.\nStackCollectorService and few other unused classes I will remove in a different PR.", "author": "smaniraju", "createdAt": "2020-06-11T08:29:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQ1OTg0OA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "5373712dde8a1134c43677b948411526aae3a46f", "url": "https://github.com/hortonworks/cloudbreak/commit/5373712dde8a1134c43677b948411526aae3a46f", "message": "CB-6619-Optimize-CB-ClusterSync\n\n1. Introduced Cluster Sync on-demand instead of polling all CB Clusters every 30 seconds which avoids CB DB Load and  processing already created clusters in periscope.\n2. Persicope CM Communication is defaulted to use cluster-proxy which is the recommended mechanism for all Cluster Communication since CM IP would not be reachable in all scenarios.", "committedDate": "2020-06-11T08:09:36Z", "type": "commit"}, {"oid": "5373712dde8a1134c43677b948411526aae3a46f", "url": "https://github.com/hortonworks/cloudbreak/commit/5373712dde8a1134c43677b948411526aae3a46f", "message": "CB-6619-Optimize-CB-ClusterSync\n\n1. Introduced Cluster Sync on-demand instead of polling all CB Clusters every 30 seconds which avoids CB DB Load and  processing already created clusters in periscope.\n2. Persicope CM Communication is defaulted to use cluster-proxy which is the recommended mechanism for all Cluster Communication since CM IP would not be reachable in all scenarios.", "committedDate": "2020-06-11T08:09:36Z", "type": "forcePushed"}]}