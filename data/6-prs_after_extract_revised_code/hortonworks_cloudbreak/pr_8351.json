{"pr_number": 8351, "pr_title": "DISTX-478-Enable Autoscaling History", "pr_createdAt": "2020-06-22T07:02:42Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8351", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ0MDU4MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8351#discussion_r443440581", "bodyText": "What is the reason for the inner class?", "author": "topolyai5", "createdAt": "2020-06-22T09:45:03Z", "path": "autoscale-api/src/main/java/com/sequenceiq/periscope/api/model/AutoscaleClusterHistoryResponse.java", "diffHunk": "@@ -119,27 +62,81 @@ public void setTimestamp(long timestamp) {\n         this.timestamp = timestamp;\n     }\n \n-    public String getHostGroup() {\n-        return hostGroup;\n+    public ScalingActivity getScalingActivity() {\n+        return scalingActivity;\n     }\n \n-    public void setHostGroup(String hostGroup) {\n-        this.hostGroup = hostGroup;\n+    public void setScalingActivity(ScalingActivity scalingActivity) {\n+        this.scalingActivity = scalingActivity;\n     }\n \n-    public AlertType getAlertType() {\n-        return alertType;\n-    }\n+    public static class ScalingActivity {", "originalCommit": "7c24854c5ddd2f337b990cb37800437537020997", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ0NjIyNg==", "url": "https://github.com/hortonworks/cloudbreak/pull/8351#discussion_r443446226", "bodyText": "Autoscaling History has two types of activities, one is related to enable\\disable. The other is related to upscaling\\downscaling nodes and the autoscaling mode which triggered. Hence moved the second set of properties associated to optional field.\nSample structure of events.\n   { \"stackCrn\": \"crn:cdp:datahub:us-west-1:smaniraju:cluster:cefd7608-3fe2-455e-8db6-b5d51be610ec\", \"scalingStatus\": \"SUCCESS\", \"statusReason\": \"Upscale successfully triggered\", \"timestamp\": 1592582401507, \"scalingActivity\": { \"adjustmentType\": \"EXACT\", \"adjustment\": 2, \"hostGroup\": \"compute\", \"originalNodeCount\": 0, \"properties\": { \"cron\": \"0 30 21 * * *\", \"timeZone\": \"Asia/Calcutta\" }, \"autoscalingType\": \"SCHEDULE-BASED\" } }\n{ \"stackCrn\": \"crn:cdp:datahub:us-west-1:smaniraju:cluster:cefd7608-3fe2-455e-8db6-b5d51be610ec\", \"scalingStatus\": \"ENABLED\", \"statusReason\": \"Autoscaling has been enabled for the cluster.\", \"timestamp\": 1592582344471 }\n{ \"stackCrn\": \"crn:cdp:datahub:us-west-1:smaniraju:cluster:cefd7608-3fe2-455e-8db6-b5d51be610ec\", \"scalingStatus\": \"DISABLED\", \"statusReason\": \"Autoscaling has been disabled for the cluster.\", \"timestamp\": 1592580904046 }", "author": "smaniraju", "createdAt": "2020-06-22T09:54:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ0MDU4MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ1MTY4MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8351#discussion_r443451681", "bodyText": "Mainly, we don't use inner classes, we separate into a different file. Could you please move to a file, if this class is not very important as inner class?", "author": "topolyai5", "createdAt": "2020-06-22T10:04:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzQ0MDU4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "d7064aa43f676ed89b0e9a17006a0252d54556cc", "chunk": "diff --git a/autoscale-api/src/main/java/com/sequenceiq/periscope/api/model/AutoscaleClusterHistoryResponse.java b/autoscale-api/src/main/java/com/sequenceiq/periscope/api/model/AutoscaleClusterHistoryResponse.java\nindex f8c3f92e0c..ddaa12cd72 100644\n--- a/autoscale-api/src/main/java/com/sequenceiq/periscope/api/model/AutoscaleClusterHistoryResponse.java\n+++ b/autoscale-api/src/main/java/com/sequenceiq/periscope/api/model/AutoscaleClusterHistoryResponse.java\n\n@@ -62,81 +57,11 @@ public class AutoscaleClusterHistoryResponse implements Json {\n         this.timestamp = timestamp;\n     }\n \n-    public ScalingActivity getScalingActivity() {\n-        return scalingActivity;\n-    }\n-\n-    public void setScalingActivity(ScalingActivity scalingActivity) {\n-        this.scalingActivity = scalingActivity;\n+    public AutoscaleClusterHistoryActivity getAutoscaleClusterHistoryActivity() {\n+        return autoscaleClusterHistoryActivity;\n     }\n \n-    public static class ScalingActivity {\n-\n-        @ApiModelProperty(HistoryJsonProperties.ALERTTYPE)\n-        @JsonProperty(\"autoscalingType\")\n-        private AlertType alertType;\n-\n-        @ApiModelProperty(HistoryJsonProperties.ADJUSTMENTTYPE)\n-        private AdjustmentType adjustmentType;\n-\n-        @ApiModelProperty(HistoryJsonProperties.ADJUSTMENT)\n-        private int adjustment;\n-\n-        @ApiModelProperty(HistoryJsonProperties.HOSTGROUP)\n-        private String hostGroup;\n-\n-        @ApiModelProperty(HistoryJsonProperties.ORIGINALNODECOUNT)\n-        private int originalNodeCount;\n-\n-        @ApiModelProperty(HistoryJsonProperties.PROPERTIES)\n-        private Map<String, String> properties = new HashMap<>();\n-\n-        public String getAlertType() {\n-            return Optional.ofNullable(alertType).map(AlertType::toString).orElse(\"\");\n-        }\n-\n-        public void setAlertType(AlertType alertType) {\n-            this.alertType = alertType;\n-        }\n-\n-        public AdjustmentType getAdjustmentType() {\n-            return adjustmentType;\n-        }\n-\n-        public void setAdjustmentType(AdjustmentType adjustmentType) {\n-            this.adjustmentType = adjustmentType;\n-        }\n-\n-        public int getAdjustment() {\n-            return adjustment;\n-        }\n-\n-        public void setAdjustment(int adjustment) {\n-            this.adjustment = adjustment;\n-        }\n-\n-        public String getHostGroup() {\n-            return hostGroup;\n-        }\n-\n-        public void setHostGroup(String hostGroup) {\n-            this.hostGroup = hostGroup;\n-        }\n-\n-        public int getOriginalNodeCount() {\n-            return originalNodeCount;\n-        }\n-\n-        public void setOriginalNodeCount(int originalNodeCount) {\n-            this.originalNodeCount = originalNodeCount;\n-        }\n-\n-        public Map<String, String> getProperties() {\n-            return properties;\n-        }\n-\n-        public void setProperties(Map<String, String> properties) {\n-            this.properties = properties;\n-        }\n+    public void setAutoscaleClusterHistoryActivity(AutoscaleClusterHistoryActivity autoscaleClusterHistoryActivity) {\n+        this.autoscaleClusterHistoryActivity = autoscaleClusterHistoryActivity;\n     }\n }\n"}}, {"oid": "d7064aa43f676ed89b0e9a17006a0252d54556cc", "url": "https://github.com/hortonworks/cloudbreak/commit/d7064aa43f676ed89b0e9a17006a0252d54556cc", "message": "DISTX-478-Enable Autoscaling History\n\nEnable Autoscaling History Endpoint\nStore history events for autoscaling.", "committedDate": "2020-06-22T10:55:02Z", "type": "commit"}, {"oid": "d7064aa43f676ed89b0e9a17006a0252d54556cc", "url": "https://github.com/hortonworks/cloudbreak/commit/d7064aa43f676ed89b0e9a17006a0252d54556cc", "message": "DISTX-478-Enable Autoscaling History\n\nEnable Autoscaling History Endpoint\nStore history events for autoscaling.", "committedDate": "2020-06-22T10:55:02Z", "type": "forcePushed"}]}