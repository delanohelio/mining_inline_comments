{"pr_number": 8271, "pr_title": "CB-7277 PR test fails intermittently with 404 when waiting for archived", "pr_createdAt": "2020-06-12T19:05:06Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8271", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTk5NTQ0MQ==", "url": "https://github.com/hortonworks/cloudbreak/pull/8271#discussion_r439995441", "bodyText": "Using a dedicated catch block for NotFoundException would be cleaner", "author": "Bajzathd", "createdAt": "2020-06-15T07:59:46Z", "path": "integration-test/src/main/java/com/sequenceiq/it/cloudbreak/util/wait/service/environment/EnvironmentTerminationChecker.java", "diffHunk": "@@ -35,13 +36,12 @@ public boolean checkStatus(T waitObject) {\n                 return false;\n             }\n         } catch (Exception e) {\n-            StringBuilder builder = new StringBuilder(\"Environment termination failed: \")\n-                    .append(System.lineSeparator())\n-                    .append(e.getMessage())\n-                    .append(System.lineSeparator())\n-                    .append(e);\n-            LOGGER.error(builder.toString());\n-            throw new TestFailException(builder.toString());\n+            if (e instanceof NotFoundException) {", "originalCommit": "788b2dd2cc0b1ed2105045387f2e3b8c8d2d931a", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b345af6b73c865571924cda814b1fbf41d021392", "chunk": "diff --git a/integration-test/src/main/java/com/sequenceiq/it/cloudbreak/util/wait/service/environment/EnvironmentTerminationChecker.java b/integration-test/src/main/java/com/sequenceiq/it/cloudbreak/util/wait/service/environment/EnvironmentTerminationChecker.java\nindex 033af6568c..3452e87bc9 100644\n--- a/integration-test/src/main/java/com/sequenceiq/it/cloudbreak/util/wait/service/environment/EnvironmentTerminationChecker.java\n+++ b/integration-test/src/main/java/com/sequenceiq/it/cloudbreak/util/wait/service/environment/EnvironmentTerminationChecker.java\n\n@@ -35,13 +35,11 @@ public class EnvironmentTerminationChecker<T extends EnvironmentWaitObject> exte\n             if (!status.equals(ARCHIVED)) {\n                 return false;\n             }\n+        } catch (NotFoundException e) {\n+            LOGGER.warn(\"No environment found with crn '{}'\", crn, e);\n         } catch (Exception e) {\n-            if (e instanceof NotFoundException) {\n-                LOGGER.warn(\"No environment found with crn '{}'\", crn, e);\n-            } else {\n-                LOGGER.error(\"Environment termination failed: {}\", e.getMessage(), e);\n-                throw new TestFailException(String.format(\"Environment termination failed: %s\", e.getMessage()));\n-            }\n+            LOGGER.error(\"Environment termination failed: {}\", e.getMessage(), e);\n+            throw new TestFailException(String.format(\"Environment termination failed: %s\", e.getMessage()));\n         }\n         return true;\n     }\n"}}, {"oid": "b345af6b73c865571924cda814b1fbf41d021392", "url": "https://github.com/hortonworks/cloudbreak/commit/b345af6b73c865571924cda814b1fbf41d021392", "message": "CB-7277 PR test fails intermittently with 404 when waiting for archived status", "committedDate": "2020-06-15T08:01:28Z", "type": "commit"}, {"oid": "b345af6b73c865571924cda814b1fbf41d021392", "url": "https://github.com/hortonworks/cloudbreak/commit/b345af6b73c865571924cda814b1fbf41d021392", "message": "CB-7277 PR test fails intermittently with 404 when waiting for archived status", "committedDate": "2020-06-15T08:01:28Z", "type": "forcePushed"}]}