{"pr_number": 8116, "pr_title": "CB-7149 Clusterproxy should not be applied on Mock provider", "pr_createdAt": "2020-05-20T13:42:13Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/8116", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAyNzg3MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8116#discussion_r428027870", "bodyText": "instead of a hard coded value, could you use a configurable one and instead of a single item it could be a set/list so we can disable it on multiple platforms if necessary", "author": "lacikaaa", "createdAt": "2020-05-20T13:51:06Z", "path": "cluster-proxy/src/main/java/com/sequenceiq/cloudbreak/clusterproxy/ClusterProxyEnablementService.java", "diffHunk": "@@ -0,0 +1,18 @@\n+package com.sequenceiq.cloudbreak.clusterproxy;\n+\n+import javax.inject.Inject;\n+\n+import org.springframework.stereotype.Component;\n+\n+import com.sequenceiq.cloudbreak.common.mappable.CloudPlatform;\n+\n+@Component\n+public class ClusterProxyEnablementService {\n+\n+    @Inject\n+    private ClusterProxyConfiguration clusterProxyConfiguration;\n+\n+    public boolean isClusterProxyApplicable(String cloudPlatform) {\n+        return clusterProxyConfiguration.isClusterProxyIntegrationEnabled() && !CloudPlatform.MOCK.name().equals(cloudPlatform);", "originalCommit": "0571b6df6e97d7edea071cd6a95ae76be2788eb9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAzNjE3MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/8116#discussion_r428036170", "bodyText": "fair point. let me do that", "author": "doktoric", "createdAt": "2020-05-20T14:00:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODAyNzg3MA=="}], "type": "inlineReview", "revised_code": {"commit": "47312898450ed0403ad377318e8e202a0f723b54", "chunk": "diff --git a/cluster-proxy/src/main/java/com/sequenceiq/cloudbreak/clusterproxy/ClusterProxyEnablementService.java b/cluster-proxy/src/main/java/com/sequenceiq/cloudbreak/clusterproxy/ClusterProxyEnablementService.java\nindex 36206a1e0d..03c831d4fd 100644\n--- a/cluster-proxy/src/main/java/com/sequenceiq/cloudbreak/clusterproxy/ClusterProxyEnablementService.java\n+++ b/cluster-proxy/src/main/java/com/sequenceiq/cloudbreak/clusterproxy/ClusterProxyEnablementService.java\n\n@@ -1,18 +1,24 @@\n package com.sequenceiq.cloudbreak.clusterproxy;\n \n+import java.util.Set;\n+\n import javax.inject.Inject;\n \n+import org.springframework.beans.factory.annotation.Value;\n import org.springframework.stereotype.Component;\n \n-import com.sequenceiq.cloudbreak.common.mappable.CloudPlatform;\n-\n @Component\n public class ClusterProxyEnablementService {\n \n+    @Value(\"${clusterProxy.disabledPlatforms}\")\n+    private Set<String> clusterProxyDisabledPlatforms;\n+\n     @Inject\n     private ClusterProxyConfiguration clusterProxyConfiguration;\n \n     public boolean isClusterProxyApplicable(String cloudPlatform) {\n-        return clusterProxyConfiguration.isClusterProxyIntegrationEnabled() && !CloudPlatform.MOCK.name().equals(cloudPlatform);\n+        return clusterProxyConfiguration.isClusterProxyIntegrationEnabled() && !clusterProxyDisabledPlatforms.contains(cloudPlatform);\n     }\n+\n+\n }\n"}}, {"oid": "47312898450ed0403ad377318e8e202a0f723b54", "url": "https://github.com/hortonworks/cloudbreak/commit/47312898450ed0403ad377318e8e202a0f723b54", "message": "CB-7149 Clusterproxy should not be applied on Mock provider", "committedDate": "2020-05-20T14:11:49Z", "type": "forcePushed"}, {"oid": "a64a99db0ae1ee802c6871d8fca00d053d379953", "url": "https://github.com/hortonworks/cloudbreak/commit/a64a99db0ae1ee802c6871d8fca00d053d379953", "message": "CB-7149 Clusterproxy should not be applied on Mock provider", "committedDate": "2020-05-20T14:42:21Z", "type": "forcePushed"}, {"oid": "18fa9abbe438c10b081476638a1cc764bfc39c78", "url": "https://github.com/hortonworks/cloudbreak/commit/18fa9abbe438c10b081476638a1cc764bfc39c78", "message": "CB-7149 Clusterproxy should not be applied on Mock provider", "committedDate": "2020-05-20T15:59:41Z", "type": "forcePushed"}, {"oid": "81cad8b8b0b7c1ddc0b5bf6fd2b8b3c89604fccb", "url": "https://github.com/hortonworks/cloudbreak/commit/81cad8b8b0b7c1ddc0b5bf6fd2b8b3c89604fccb", "message": "CB-7149 Clusterproxy should not be applied on Mock provider", "committedDate": "2020-05-21T08:15:56Z", "type": "forcePushed"}, {"oid": "41d4eef4aa9961a309fcbcc65c8076eea45e1afa", "url": "https://github.com/hortonworks/cloudbreak/commit/41d4eef4aa9961a309fcbcc65c8076eea45e1afa", "message": "CB-7149 Clusterproxy should not be applied on Mock provider", "committedDate": "2020-05-21T08:16:36Z", "type": "commit"}, {"oid": "41d4eef4aa9961a309fcbcc65c8076eea45e1afa", "url": "https://github.com/hortonworks/cloudbreak/commit/41d4eef4aa9961a309fcbcc65c8076eea45e1afa", "message": "CB-7149 Clusterproxy should not be applied on Mock provider", "committedDate": "2020-05-21T08:16:36Z", "type": "forcePushed"}]}