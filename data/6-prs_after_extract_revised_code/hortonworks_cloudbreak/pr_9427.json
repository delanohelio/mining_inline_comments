{"pr_number": 9427, "pr_title": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.", "pr_createdAt": "2020-11-13T09:11:36Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9427", "timeline": [{"oid": "6113078c09af011d449d2e10521b862fafeaf2b0", "url": "https://github.com/hortonworks/cloudbreak/commit/6113078c09af011d449d2e10521b862fafeaf2b0", "message": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.\n\nIt was hard to find log messages cross-service when looking up by env-crn. This commit adds env-crn to MDC context in controller when it is present in the request body but not in request parameters.\nAlso, redbeams create parameters received toStrings to be logged properly.\nUnrelated change: one-line log message to track azure image copy.", "committedDate": "2020-11-13T09:30:05Z", "type": "forcePushed"}, {"oid": "8b19ba6464ac0f7fe45d076f4cfeca80b11756e0", "url": "https://github.com/hortonworks/cloudbreak/commit/8b19ba6464ac0f7fe45d076f4cfeca80b11756e0", "message": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.\n\nIt was hard to find log messages cross-service when looking up by env-crn. This commit adds env-crn to MDC context in controller when it is present in the request body but not in request parameters.\nAlso, redbeams create parameters received toStrings to be logged properly.\nUnrelated change: one-line log message to track azure image copy.", "committedDate": "2020-11-13T09:42:06Z", "type": "forcePushed"}, {"oid": "d5d92458e5b459e93b60d634e89d04df1c5783e9", "url": "https://github.com/hortonworks/cloudbreak/commit/d5d92458e5b459e93b60d634e89d04df1c5783e9", "message": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.\n\nIt was hard to find log messages cross-service when looking up by env-crn. This commit adds env-crn to MDC context in controller when it is present in the request body but not in request parameters.\nAlso, redbeams create parameters received toStrings to be logged properly.\nUnrelated change: one-line log message to track azure image copy.", "committedDate": "2020-11-13T11:39:25Z", "type": "forcePushed"}, {"oid": "30612f93f8eb73a4c92322958e53017e679af30d", "url": "https://github.com/hortonworks/cloudbreak/commit/30612f93f8eb73a4c92322958e53017e679af30d", "message": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.\n\nIt was hard to find log messages cross-service when looking up by env-crn. This commit adds env-crn to MDC context in controller when it is present in the request body but not in request parameters.\nAlso, redbeams create parameters received toStrings to be logged properly.\nUnrelated change: one-line log message to track azure image copy.", "committedDate": "2020-11-13T12:37:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA0NjIzMA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9427#discussion_r524046230", "bodyText": "The above line is exactly the same calculation.", "author": "keyki", "createdAt": "2020-11-16T09:50:42Z", "path": "core/src/main/java/com/sequenceiq/cloudbreak/service/metrics/CloudbreakMetricService.java", "diffHunk": "@@ -77,6 +81,7 @@ public void recordImageCopyTime(Stack stack, long startMillis) {\n                 MetricTag.REGION.name(), Optional.ofNullable(stack.getRegion()).orElse(\"NA\")};\n \n         long millispassed = System.currentTimeMillis() - startMillis;\n+        LOGGER.debug(\"Image copy duration report: {} ms\", System.currentTimeMillis() - startMillis);", "originalCommit": "30612f93f8eb73a4c92322958e53017e679af30d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDEwNTg2MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9427#discussion_r524105860", "bodyText": "Thank you (move error ...).", "author": "gergopapi2", "createdAt": "2020-11-16T10:44:14Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNDA0NjIzMA=="}], "type": "inlineReview", "revised_code": {"commit": "7d039b71557cbf50fb27ccd21a8718c6ded69230", "chunk": "diff --git a/core/src/main/java/com/sequenceiq/cloudbreak/service/metrics/CloudbreakMetricService.java b/core/src/main/java/com/sequenceiq/cloudbreak/service/metrics/CloudbreakMetricService.java\nindex 15004a20da..6c102b8d23 100644\n--- a/core/src/main/java/com/sequenceiq/cloudbreak/service/metrics/CloudbreakMetricService.java\n+++ b/core/src/main/java/com/sequenceiq/cloudbreak/service/metrics/CloudbreakMetricService.java\n\n@@ -81,7 +81,7 @@ public class CloudbreakMetricService extends AbstractMetricService {\n                 MetricTag.REGION.name(), Optional.ofNullable(stack.getRegion()).orElse(\"NA\")};\n \n         long millispassed = System.currentTimeMillis() - startMillis;\n-        LOGGER.debug(\"Image copy duration report: {} ms\", System.currentTimeMillis() - startMillis);\n+        LOGGER.debug(\"Image copy duration report: {} ms\", millispassed);\n         recordTimer(millispassed, MetricType.STACK_IMAGE_COPY, tags);\n     }\n }\n"}}, {"oid": "7d039b71557cbf50fb27ccd21a8718c6ded69230", "url": "https://github.com/hortonworks/cloudbreak/commit/7d039b71557cbf50fb27ccd21a8718c6ded69230", "message": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.\n\nIt was hard to find log messages cross-service when looking up by env-crn. This commit adds env-crn to MDC context in controller when it is present in the request body but not in request parameters.\nAlso, redbeams create parameters received toStrings to be logged properly.\nUnrelated change: one-line log message to track azure image copy.", "committedDate": "2020-11-16T10:42:21Z", "type": "commit"}, {"oid": "7d039b71557cbf50fb27ccd21a8718c6ded69230", "url": "https://github.com/hortonworks/cloudbreak/commit/7d039b71557cbf50fb27ccd21a8718c6ded69230", "message": "CB-9501 Redbeams logging: env crn was not filled in on mow-dev.\n\nIt was hard to find log messages cross-service when looking up by env-crn. This commit adds env-crn to MDC context in controller when it is present in the request body but not in request parameters.\nAlso, redbeams create parameters received toStrings to be logged properly.\nUnrelated change: one-line log message to track azure image copy.", "committedDate": "2020-11-16T10:42:21Z", "type": "forcePushed"}]}