{"pr_number": 9226, "pr_title": "CB-9053. Cleanup and update diagnostics bundle format + start using CDP doctor (CB-8865)", "pr_createdAt": "2020-10-14T17:53:17Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9226", "timeline": [{"oid": "e261ed6626c0707da8098cc4af1c239760e01c44", "url": "https://github.com/hortonworks/cloudbreak/commit/e261ed6626c0707da8098cc4af1c239760e01c44", "message": "CB-9053. Cleanup and update diagnostics bundle format\ndetails:\n- refactor cloud storage related parameters a bit (also fixes some issue)\n- start using newer cdp-telemetry cli tool (include multiple workers feature, but use only 1 for those at the moment)\n- update bundle to include bundle-info.json that contains required data that can be used by EDH\n- include filecollector-metadata.json that includes the processing results\n- rename bundle_info.json to diagnostics_request.json as that contains the diagnostics request data\n- license id is not filled that\n- include some new fields on the API (altohgh many of that are generated but as we passes those requests to internal endpoints, include those fields in the request)", "committedDate": "2020-10-14T18:23:24Z", "type": "forcePushed"}, {"oid": "d550cc8b8b0e32817faa1274ddb1cdbf21bc67b7", "url": "https://github.com/hortonworks/cloudbreak/commit/d550cc8b8b0e32817faa1274ddb1cdbf21bc67b7", "message": "CB-9053. Cleanup and update diagnostics bundle format + start using CDP doctor (CB-8865)\ndetails:\n- refactor cloud storage related parameters a bit (also fixes some issue)\n- start using newer cdp-telemetry cli tool (include multiple workers feature, but use only 1 for those at the moment)\n- update bundle to include bundle-info.json that contains required data that can be used by EDH\n- include filecollector-metadata.json that includes the processing results\n- rename bundle_info.json to diagnostics_request.json as that contains the diagnostics request data\n- license id is not filled that\n- include some new fields on the API (altohgh many of that are generated but as we passes those requests to internal endpoints, include those fields in the request)\n- start using cdp-doctor -> use \"cdp-doctor commands\" to exercute multiple cdp-doctor calls and save its outputs under /tmp folder", "committedDate": "2020-10-16T18:22:05Z", "type": "forcePushed"}, {"oid": "f88870ed060539d761920fee77a37d23f15962b8", "url": "https://github.com/hortonworks/cloudbreak/commit/f88870ed060539d761920fee77a37d23f15962b8", "message": "CB-9053. Cleanup and update diagnostics bundle format + start using CDP doctor (CB-8865)\ndetails:\n- refactor cloud storage related parameters a bit (also fixes some issue)\n- start using newer cdp-telemetry cli tool (include multiple workers feature, but use only 1 for those at the moment)\n- update bundle to include bundle-info.json that contains required data that can be used by EDH\n- include filecollector-metadata.json that includes the processing results\n- rename bundle_info.json to diagnostics_request.json as that contains the diagnostics request data\n- license id is not filled yet\n- start using cdp-doctor -> use \"cdp-doctor commands\" to exercute multiple cdp-doctor calls and save its outputs under /tmp folder\n- use different cdp-doctor commands for FreeIPA and CM based clusters (include recipe and scm agent related commands there)", "committedDate": "2020-10-19T09:49:09Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwMTYyNA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9226#discussion_r507901624", "bodyText": "typo here \"ans\"", "author": "attilapalfi92", "createdAt": "2020-10-19T16:47:59Z", "path": "common-model/src/main/java/com/sequenceiq/common/model/diagnostics/CloudStorageDiagnosticsParameters.java", "diffHunk": "@@ -0,0 +1,11 @@\n+package com.sequenceiq.common.model.diagnostics;\n+\n+import java.util.Map;\n+\n+public interface CloudStorageDiagnosticsParameters {\n+\n+    /**\n+     * Get cloud specific parameters ans a key value map for diagnostics", "originalCommit": "f88870ed060539d761920fee77a37d23f15962b8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ce387c2039ed9a69b450f37478ed28881d67fe32", "chunk": "diff --git a/common-model/src/main/java/com/sequenceiq/common/model/diagnostics/CloudStorageDiagnosticsParameters.java b/common-model/src/main/java/com/sequenceiq/common/model/diagnostics/CloudStorageDiagnosticsParameters.java\nindex f5605811e2..262b02534b 100644\n--- a/common-model/src/main/java/com/sequenceiq/common/model/diagnostics/CloudStorageDiagnosticsParameters.java\n+++ b/common-model/src/main/java/com/sequenceiq/common/model/diagnostics/CloudStorageDiagnosticsParameters.java\n\n@@ -5,7 +5,7 @@ import java.util.Map;\n public interface CloudStorageDiagnosticsParameters {\n \n     /**\n-     * Get cloud specific parameters ans a key value map for diagnostics\n+     * Get cloud specific parameters and a key value map for diagnostics\n      */\n     Map<String, Object> toMap();\n }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwMjgxNg==", "url": "https://github.com/hortonworks/cloudbreak/pull/9226#discussion_r507902816", "bodyText": "where is it used?", "author": "attilapalfi92", "createdAt": "2020-10-19T16:49:52Z", "path": "datalake/src/main/java/com/sequenceiq/datalake/service/sdx/diagnostics/DiagnosticsService.java", "diffHunk": "@@ -30,6 +31,9 @@\n \n     private static final Logger LOGGER = LoggerFactory.getLogger(DiagnosticsService.class);\n \n+    @Value(\"${info.app.version:}\")\n+    private String version;", "originalCommit": "f88870ed060539d761920fee77a37d23f15962b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwNDA2Mw==", "url": "https://github.com/hortonworks/cloudbreak/pull/9226#discussion_r507904063", "bodyText": "it.is only used as a default if for some reason the blueprint/stack version for the cluster does not exist", "author": "oleewere", "createdAt": "2020-10-19T16:51:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwMjgxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkzNzI5MA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9226#discussion_r507937290", "bodyText": "but I cannot see it referenced anywhere", "author": "attilapalfi92", "createdAt": "2020-10-19T17:41:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNzkwMjgxNg=="}], "type": "inlineReview", "revised_code": {"commit": "ffcf36fb04404624d390076fae37d61bdba9f3b0", "chunk": "diff --git a/datalake/src/main/java/com/sequenceiq/datalake/service/sdx/diagnostics/DiagnosticsService.java b/datalake/src/main/java/com/sequenceiq/datalake/service/sdx/diagnostics/DiagnosticsService.java\nindex cd2a5d34ec..93d35610f3 100644\n--- a/datalake/src/main/java/com/sequenceiq/datalake/service/sdx/diagnostics/DiagnosticsService.java\n+++ b/datalake/src/main/java/com/sequenceiq/datalake/service/sdx/diagnostics/DiagnosticsService.java\n\n@@ -31,9 +30,6 @@ public class DiagnosticsService {\n \n     private static final Logger LOGGER = LoggerFactory.getLogger(DiagnosticsService.class);\n \n-    @Value(\"${info.app.version:}\")\n-    private String version;\n-\n     @Inject\n     private DiagnosticsV4Endpoint diagnosticsV4Endpoint;\n \n"}}, {"oid": "ce387c2039ed9a69b450f37478ed28881d67fe32", "url": "https://github.com/hortonworks/cloudbreak/commit/ce387c2039ed9a69b450f37478ed28881d67fe32", "message": "CB-9053. Cleanup and update diagnostics bundle format + start using CDP doctor (CB-8865)\ndetails:\n- refactor cloud storage related parameters a bit (also fixes some issue)\n- start using newer cdp-telemetry cli tool (include multiple workers feature, but use only 1 for those at the moment)\n- update bundle to include bundle-info.json that contains required data that can be used by EDH\n- include filecollector-metadata.json that includes the processing results\n- rename bundle_info.json to diagnostics_request.json as that contains the diagnostics request data\n- license id is not filled yet\n- start using cdp-doctor -> use \"cdp-doctor commands\" to exercute multiple cdp-doctor calls and save its outputs under /tmp folder\n- use different cdp-doctor commands for FreeIPA and CM based clusters (include recipe and scm agent related commands there)", "committedDate": "2020-10-19T16:54:04Z", "type": "forcePushed"}, {"oid": "ffcf36fb04404624d390076fae37d61bdba9f3b0", "url": "https://github.com/hortonworks/cloudbreak/commit/ffcf36fb04404624d390076fae37d61bdba9f3b0", "message": "CB-9053. Cleanup and update diagnostics bundle format + start using CDP doctor (CB-8865)\ndetails:\n- refactor cloud storage related parameters a bit (also fixes some issue)\n- start using newer cdp-telemetry cli tool (include multiple workers feature, but use only 1 for those at the moment)\n- update bundle to include bundle-info.json that contains required data that can be used by EDH\n- include filecollector-metadata.json that includes the processing results\n- rename bundle_info.json to diagnostics_request.json as that contains the diagnostics request data\n- license id is not filled yet\n- start using cdp-doctor -> use \"cdp-doctor commands\" to exercute multiple cdp-doctor calls and save its outputs under /tmp folder\n- use different cdp-doctor commands for FreeIPA and CM based clusters (include recipe and scm agent related commands there)", "committedDate": "2020-10-19T17:44:44Z", "type": "commit"}, {"oid": "ffcf36fb04404624d390076fae37d61bdba9f3b0", "url": "https://github.com/hortonworks/cloudbreak/commit/ffcf36fb04404624d390076fae37d61bdba9f3b0", "message": "CB-9053. Cleanup and update diagnostics bundle format + start using CDP doctor (CB-8865)\ndetails:\n- refactor cloud storage related parameters a bit (also fixes some issue)\n- start using newer cdp-telemetry cli tool (include multiple workers feature, but use only 1 for those at the moment)\n- update bundle to include bundle-info.json that contains required data that can be used by EDH\n- include filecollector-metadata.json that includes the processing results\n- rename bundle_info.json to diagnostics_request.json as that contains the diagnostics request data\n- license id is not filled yet\n- start using cdp-doctor -> use \"cdp-doctor commands\" to exercute multiple cdp-doctor calls and save its outputs under /tmp folder\n- use different cdp-doctor commands for FreeIPA and CM based clusters (include recipe and scm agent related commands there)", "committedDate": "2020-10-19T17:44:44Z", "type": "forcePushed"}]}