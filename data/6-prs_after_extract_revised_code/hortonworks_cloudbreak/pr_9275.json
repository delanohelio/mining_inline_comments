{"pr_number": 9275, "pr_title": "CB-9433 Cannot download the event json in zip format on event histroy\u2026", "pr_createdAt": "2020-10-22T17:20:28Z", "pr_url": "https://github.com/hortonworks/cloudbreak/pull/9275", "timeline": [{"oid": "a2cef27e1e534d6dc906cd0b83a5fe23607d2d3c", "url": "https://github.com/hortonworks/cloudbreak/commit/a2cef27e1e534d6dc906cd0b83a5fe23607d2d3c", "message": "CB-9433 Cannot download the event json in zip format on event histroy page. When I try to download the event history in json format the response is only an empty list. We already filter by resource crn so we don't need to filter by resource type as well.", "committedDate": "2020-10-24T15:24:52Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTU2MzE0OA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9275#discussion_r511563148", "bodyText": "Unfortunately, this is not going to be unique. It can return multiple resources if the if matches. Maybe it would be better to deprecate this kind of access.", "author": "akanto", "createdAt": "2020-10-25T08:12:11Z", "path": "core/src/main/java/com/sequenceiq/cloudbreak/structuredevent/db/LegacyStructuredEventRepository.java", "diffHunk": "@@ -26,9 +26,9 @@\n     @Query(\"SELECT se from StructuredEventEntity se WHERE se.workspace.id = :workspaceId AND se.id = :id\")\n     StructuredEventEntity findByWorkspaceIdAndId(@Param(\"workspaceId\") Long workspaceId, @Param(\"id\") Long id);\n \n-    List<StructuredEventEntity> findByWorkspaceAndResourceTypeAndResourceId(Workspace workspace, String resourceType, Long resourceId);\n+    List<StructuredEventEntity> findByWorkspaceAndResourceId(Workspace workspace, Long resourceId);", "originalCommit": "a2cef27e1e534d6dc906cd0b83a5fe23607d2d3c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTU3MjI1NA==", "url": "https://github.com/hortonworks/cloudbreak/pull/9275#discussion_r511572254", "bodyText": "done", "author": "topolyai5", "createdAt": "2020-10-25T09:39:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTU2MzE0OA=="}], "type": "inlineReview", "revised_code": {"commit": "8314d05bf2c703d149a9b04885432263dd614184", "chunk": "diff --git a/core/src/main/java/com/sequenceiq/cloudbreak/structuredevent/db/LegacyStructuredEventRepository.java b/core/src/main/java/com/sequenceiq/cloudbreak/structuredevent/db/LegacyStructuredEventRepository.java\nindex f7614c5bae..9f52250c27 100644\n--- a/core/src/main/java/com/sequenceiq/cloudbreak/structuredevent/db/LegacyStructuredEventRepository.java\n+++ b/core/src/main/java/com/sequenceiq/cloudbreak/structuredevent/db/LegacyStructuredEventRepository.java\n\n@@ -26,7 +26,7 @@ public interface LegacyStructuredEventRepository extends WorkspaceResourceReposi\n     @Query(\"SELECT se from StructuredEventEntity se WHERE se.workspace.id = :workspaceId AND se.id = :id\")\n     StructuredEventEntity findByWorkspaceIdAndId(@Param(\"workspaceId\") Long workspaceId, @Param(\"id\") Long id);\n \n-    List<StructuredEventEntity> findByWorkspaceAndResourceId(Workspace workspace, Long resourceId);\n+    List<StructuredEventEntity> findByWorkspaceAndResourceTypeAndResourceId(Workspace workspace, String resourceType, Long resourceId);\n \n     List<StructuredEventEntity> findByWorkspaceAndResourceCrn(Workspace workspace, String resourceCrn);\n \n"}}, {"oid": "8314d05bf2c703d149a9b04885432263dd614184", "url": "https://github.com/hortonworks/cloudbreak/commit/8314d05bf2c703d149a9b04885432263dd614184", "message": "CB-9433 Cannot download the event json in zip format on event histroy page. When I try to download the event history in json format the response is only an empty list. We already filter by resource crn so we don't need to filter by resource type as well.", "committedDate": "2020-10-25T09:05:31Z", "type": "commit"}, {"oid": "8314d05bf2c703d149a9b04885432263dd614184", "url": "https://github.com/hortonworks/cloudbreak/commit/8314d05bf2c703d149a9b04885432263dd614184", "message": "CB-9433 Cannot download the event json in zip format on event histroy page. When I try to download the event history in json format the response is only an empty list. We already filter by resource crn so we don't need to filter by resource type as well.", "committedDate": "2020-10-25T09:05:31Z", "type": "forcePushed"}]}