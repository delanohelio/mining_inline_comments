{"pr_number": 5167, "pr_title": "Issue 4162: add missing systemproperty parameter in build script", "pr_createdAt": "2020-09-10T15:48:25Z", "pr_url": "https://github.com/pravega/pravega/pull/5167", "timeline": [{"oid": "7bf0fe9a7a1dc5a651f40cc129d82a3af499f983", "url": "https://github.com/pravega/pravega/commit/7bf0fe9a7a1dc5a651f40cc129d82a3af499f983", "message": "add missing parameter\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-10T15:43:58Z", "type": "commit"}, {"oid": "41f3120da1060b68ae172148e035c937ce336b46", "url": "https://github.com/pravega/pravega/commit/41f3120da1060b68ae172148e035c937ce336b46", "message": "add logging\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-10T18:08:27Z", "type": "commit"}, {"oid": "fadcb47dc1bb1a2cb55f20662e251cbc24085447", "url": "https://github.com/pravega/pravega/commit/fadcb47dc1bb1a2cb55f20662e251cbc24085447", "message": "pass parameters between gradle tasks to fix a very old bug\ncheck the new parameter tlsEnabled in the log snippet below:\n```\n[2020-09-10T22:56:24.163Z] Starting process 'Gradle Test Executor 1'. Working directory: /var/jenkins_home/workspace/test-pravega-continuous-1/pravega/test/system Command: /usr/lib64/jvm/java-1.8.0-oracle-1.8.0.231/bin/java -DbookkeeperImageName=bookkeeper -DdockerRegistryUrl=devops-repo.isus.emc.com:8116/ -DexecType=KUBERNETES -DimagePrefix=nautilus -DimageVersion=0.9.0-2646.7449afc63-issue-4162-propagate-parameters-2 -Djava.security.manager=worker.org.gradle.process.internal.worker.child.BootstrapSecurityManager -DlogLevel=INFO -Dlogback.configurationFile=/var/jenkins_home/workspace/test-pravega-continuous-1/pravega/test/system/build/resources/test/logback.xml -Dorg.gradle.native=false -DpravegaBookkeeperVersion=0.9.0-2646.7449afc63-issue-4162-propagate-parameters-2 -DpravegaImageName=pravega -DpravegaOperatorImage=pravega/pravega-operator:0.4.5 -DsecurityEnabled=true -DtestPodImage=openjdk:8u181-jre-alpine -Dtier2Config -Dtier2Type=nfs -DtlsEnabled=true -DzookeeperImageName=zookeeper -DzookeeperImageVersion=0.2.5-rc0 -DzookeeperOperatorImage=devops-repo.isus.emc.com:8116/nautilus/zookeeper-operator:0.2.5-rc0 -XX:MaxDirectMemorySize=4g -javaagent:build/tmp/expandedArchives/org.jacoco.agent-0.8.5.jar_68440dd6a8b4bc83189a456fbd91b241/jacocoagent.jar=destfile=build/jacoco/startK8SystemTests.exec,append=true,inclnolocationclasses=false,dumponexit=true,output=file,jmx=false -Xms128m -Xmx512m -Dfile.encoding=US-ASCII -Duser.country=US -Duser.language=en -Duser.variant -ea -cp /root/.gradle/caches/4.10.2/workerMain/gradle-worker.jar worker.org.gradle.process.internal.worker.GradleWorkerMain 'Gradle Test Executor 1'\n[2020-09-10T22:56:24.163Z] Successfully started process 'Gradle Test Executor 1'\n[2020-09-10T22:56:25.531Z]\n[2020-09-10T22:56:25.531Z] Gradle Test Executor 1 started executing tests.\n[2020-09-10T22:56:26.095Z]\n[2020-09-10T22:56:26.095Z] > Task :test:system:startK8SystemTests\n[2020-09-10T22:56:26.095Z]\n[2020-09-10T22:56:26.095Z] io.pravega.test.system.MultiControllerTest STANDARD_OUT\n[2020-09-10T22:56:26.095Z]     2020-09-10 22:56:25,745 325  [Test worker] DEBUG i.p.test.system.framework.Utils - execType=false\n[2020-09-10T22:56:26.095Z]     2020-09-10 22:56:25,774 354  [Test worker] DEBUG i.p.test.system.framework.Utils - securityEnabled=true\n[2020-09-10T22:56:26.095Z]     2020-09-10 22:56:25,777 357  [Test worker] DEBUG i.p.test.system.framework.Utils - tlsEnabled=false\n```\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-11T01:22:30Z", "type": "commit"}, {"oid": "dae9c6dff97c22703c9beabde0f50c3bb4f811f1", "url": "https://github.com/pravega/pravega/commit/dae9c6dff97c22703c9beabde0f50c3bb4f811f1", "message": "set properties\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-11T16:01:45Z", "type": "commit"}, {"oid": "5d8d620f9c33f7fafd5f786ec97d6faf62a6b412", "url": "https://github.com/pravega/pravega/commit/5d8d620f9c33f7fafd5f786ec97d6faf62a6b412", "message": "Merge branch 'master' into issue-4162-propagate-parameters", "committedDate": "2020-09-11T16:04:07Z", "type": "commit"}, {"oid": "2d0f7717de0129175092acf283c62bcbf7d99430", "url": "https://github.com/pravega/pravega/commit/2d0f7717de0129175092acf283c62bcbf7d99430", "message": "pass option between tests\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-11T22:20:45Z", "type": "commit"}, {"oid": "aa0cb7a1b52a6e21aafd51dcb29d61d71032d310", "url": "https://github.com/pravega/pravega/commit/aa0cb7a1b52a6e21aafd51dcb29d61d71032d310", "message": "add test\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-13T11:02:23Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY4OTg3MQ==", "url": "https://github.com/pravega/pravega/pull/5167#discussion_r487689871", "bodyText": "In the case of tls enabled, http is used. It looks incorrect.", "author": "anishakj", "createdAt": "2020-09-14T06:57:44Z", "path": "test/system/src/test/java/io/pravega/test/system/ControllerRestApiTest.java", "diffHunk": "@@ -121,8 +121,8 @@ public void restApiTests() {\n         URI controllerRESTUri = ctlURIs.get(1);\n         Invocation.Builder builder;\n         Response response;\n-\n-        restServerURI = \"http://\" + controllerRESTUri.getHost() + \":\" + controllerRESTUri.getPort();\n+        String protocol = Utils.TLS_AND_AUTH_ENABLED ? \"http://\" : \"https://\";", "originalCommit": "aa0cb7a1b52a6e21aafd51dcb29d61d71032d310", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "04f3952629d4247352b22811a9995c8796242910", "chunk": "diff --git a/test/system/src/test/java/io/pravega/test/system/ControllerRestApiTest.java b/test/system/src/test/java/io/pravega/test/system/ControllerRestApiTest.java\nindex 736d1b3bf7..5516e2158a 100644\n--- a/test/system/src/test/java/io/pravega/test/system/ControllerRestApiTest.java\n+++ b/test/system/src/test/java/io/pravega/test/system/ControllerRestApiTest.java\n\n@@ -121,7 +121,7 @@ public class ControllerRestApiTest extends AbstractSystemTest {\n         URI controllerRESTUri = ctlURIs.get(1);\n         Invocation.Builder builder;\n         Response response;\n-        String protocol = Utils.TLS_AND_AUTH_ENABLED ? \"http://\" : \"https://\";\n+        String protocol = Utils.TLS_AND_AUTH_ENABLED ? \"https://\" : \"http://\";\n         restServerURI = protocol + controllerRESTUri.getHost() + \":\" + controllerRESTUri.getPort();\n         log.info(\"REST Server URI: {}\", restServerURI);\n \n"}}, {"oid": "04f3952629d4247352b22811a9995c8796242910", "url": "https://github.com/pravega/pravega/commit/04f3952629d4247352b22811a9995c8796242910", "message": "fix test\n\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>", "committedDate": "2020-09-14T14:12:59Z", "type": "commit"}, {"oid": "3b2d1b43e5b9529a2c1684cede09d5b85e785578", "url": "https://github.com/pravega/pravega/commit/3b2d1b43e5b9529a2c1684cede09d5b85e785578", "message": "Merge branch 'master' into issue-4162-propagate-parameters", "committedDate": "2020-09-14T14:17:45Z", "type": "commit"}, {"oid": "45f685b87874a1f35049e3e15b9485e536ccf663", "url": "https://github.com/pravega/pravega/commit/45f685b87874a1f35049e3e15b9485e536ccf663", "message": "Merge branch 'master' into issue-4162-propagate-parameters", "committedDate": "2020-09-15T00:22:05Z", "type": "commit"}]}