{"pr_number": 5121, "pr_title": "Issue 5082: Initial Java 11 Migration", "pr_createdAt": "2020-08-29T08:27:02Z", "pr_url": "https://github.com/pravega/pravega/pull/5121", "timeline": [{"oid": "08601afd11463bf700a6d0af3f33dcb53f935e09", "url": "https://github.com/pravega/pravega/commit/08601afd11463bf700a6d0af3f33dcb53f935e09", "message": "Update K8 client APIs to use their 5.0.0 counterparts.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-02-21T00:13:24Z", "type": "commit"}, {"oid": "25a165d0293c34ee8703fff764e55cf8fda413dd", "url": "https://github.com/pravega/pravega/commit/25a165d0293c34ee8703fff764e55cf8fda413dd", "message": "Merge pull request #1 from co-jo/issue-4464-update-kubernetes-client-version\n\nIssue 4464 update kubernetes client version", "committedDate": "2020-02-21T18:42:03Z", "type": "commit"}, {"oid": "8cc2dd2be26feed2953258ff055c1657aeb57019", "url": "https://github.com/pravega/pravega/commit/8cc2dd2be26feed2953258ff055c1657aeb57019", "message": "Run system tests using alternative flag value.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-02-23T04:43:09Z", "type": "commit"}, {"oid": "c3fcbd2e627f9fc0a0f6bad7e42667db4439e092", "url": "https://github.com/pravega/pravega/commit/c3fcbd2e627f9fc0a0f6bad7e42667db4439e092", "message": "Merge remote-tracking branch 'upstream/master'", "committedDate": "2020-03-10T22:21:32Z", "type": "commit"}, {"oid": "f5f808cc42831892aeb8e7824c22d499a1f9fa03", "url": "https://github.com/pravega/pravega/commit/f5f808cc42831892aeb8e7824c22d499a1f9fa03", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-03-18T18:44:10Z", "type": "commit"}, {"oid": "7901435dc1127bed1c46845bbaf8024477e2078f", "url": "https://github.com/pravega/pravega/commit/7901435dc1127bed1c46845bbaf8024477e2078f", "message": "Merge branch 'master' of https://github.com/pravega/pravega\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-04-02T18:49:59Z", "type": "commit"}, {"oid": "d59b3e33f6d5bd90264753caadcea7ed7bbfe06c", "url": "https://github.com/pravega/pravega/commit/d59b3e33f6d5bd90264753caadcea7ed7bbfe06c", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-04-16T20:22:05Z", "type": "commit"}, {"oid": "aa090cad1d88812f2a88e9debacdb04df585adbf", "url": "https://github.com/pravega/pravega/commit/aa090cad1d88812f2a88e9debacdb04df585adbf", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-04-18T20:15:50Z", "type": "commit"}, {"oid": "e328bcb38239fdc32f866980ee1103c93dff522d", "url": "https://github.com/pravega/pravega/commit/e328bcb38239fdc32f866980ee1103c93dff522d", "message": "Merge branch 'master' of https://github.com/co-jo/pravega", "committedDate": "2020-05-11T22:25:21Z", "type": "commit"}, {"oid": "cd02180986f49a42002c7fd2ef28885d1f701af9", "url": "https://github.com/pravega/pravega/commit/cd02180986f49a42002c7fd2ef28885d1f701af9", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-05-11T22:25:27Z", "type": "commit"}, {"oid": "1408d7527ec73f1645418df04aea4aa1120b39e7", "url": "https://github.com/pravega/pravega/commit/1408d7527ec73f1645418df04aea4aa1120b39e7", "message": "Merge branch 'master' of https://github.com/co-jo/pravega", "committedDate": "2020-05-18T20:48:16Z", "type": "commit"}, {"oid": "e2719517850f39bce3e5f2c92f04c8c24122a520", "url": "https://github.com/pravega/pravega/commit/e2719517850f39bce3e5f2c92f04c8c24122a520", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-05-20T18:59:36Z", "type": "commit"}, {"oid": "b1d3648dd2c28a161dab520a48bf4bf657f9d14d", "url": "https://github.com/pravega/pravega/commit/b1d3648dd2c28a161dab520a48bf4bf657f9d14d", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-06-15T18:43:02Z", "type": "commit"}, {"oid": "b3a8b73b2904f91d0d59e27eaace82bcc1870b5c", "url": "https://github.com/pravega/pravega/commit/b3a8b73b2904f91d0d59e27eaace82bcc1870b5c", "message": "Merge branch 'master' of https://github.com/pravega/pravega", "committedDate": "2020-08-04T21:19:13Z", "type": "commit"}, {"oid": "b02240ab9a8e6d7d645ffdd020f9b43854c89920", "url": "https://github.com/pravega/pravega/commit/b02240ab9a8e6d7d645ffdd020f9b43854c89920", "message": "Merge branch 'master' of https://github.com/pravega/pravega into segmentstore-java-11-migration", "committedDate": "2020-08-17T18:24:07Z", "type": "commit"}, {"oid": "544e4900580d40e7832fff1e6ba2457c736c885d", "url": "https://github.com/pravega/pravega/commit/544e4900580d40e7832fff1e6ba2457c736c885d", "message": "* Initial version configuration.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-17T19:23:27Z", "type": "commit"}, {"oid": "58fa2ad355423360c85be49c39c88a8c6e1548bf", "url": "https://github.com/pravega/pravega/commit/58fa2ad355423360c85be49c39c88a8c6e1548bf", "message": "* Update gradle and add compiler options to dependencies of 'common'.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-18T22:34:38Z", "type": "commit"}, {"oid": "7ca394be056e05b75b9ecc075c717ef0b8afb67f", "url": "https://github.com/pravega/pravega/commit/7ca394be056e05b75b9ecc075c717ef0b8afb67f", "message": "* Update Spotbugs (picked from Tom's repo).\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-19T17:49:58Z", "type": "commit"}, {"oid": "b71b7ac1678c7cff6485a6a8c57b4d11d72e7e11", "url": "https://github.com/pravega/pravega/commit/b71b7ac1678c7cff6485a6a8c57b4d11d72e7e11", "message": "* Update Lombok version.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-26T23:19:48Z", "type": "commit"}, {"oid": "e8aa9bffce20c8ff1f7d3996e8be42dfd1d295f6", "url": "https://github.com/pravega/pravega/commit/e8aa9bffce20c8ff1f7d3996e8be42dfd1d295f6", "message": "* Update TravisCI JDK.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-27T18:56:44Z", "type": "commit"}, {"oid": "fb62760263a14823fba220a91034bc89c74cf091", "url": "https://github.com/pravega/pravega/commit/fb62760263a14823fba220a91034bc89c74cf091", "message": "* Suppress SpotBugs warning.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-27T21:03:01Z", "type": "commit"}, {"oid": "b32ce63f62a3a96f0a09cc5d4d75db0475a89a8e", "url": "https://github.com/pravega/pravega/commit/b32ce63f62a3a96f0a09cc5d4d75db0475a89a8e", "message": "* Add package to suppress SpotBug warning to allowed packages file.\n\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>", "committedDate": "2020-08-27T22:52:29Z", "type": "commit"}, {"oid": "b699030bcb62252f95bcc3e46570c34d2d33d780", "url": "https://github.com/pravega/pravega/commit/b699030bcb62252f95bcc3e46570c34d2d33d780", "message": "Replace default Dockerfile with Java11 variant.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-02T18:03:00Z", "type": "commit"}, {"oid": "b699030bcb62252f95bcc3e46570c34d2d33d780", "url": "https://github.com/pravega/pravega/commit/b699030bcb62252f95bcc3e46570c34d2d33d780", "message": "Replace default Dockerfile with Java11 variant.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-02T18:03:00Z", "type": "forcePushed"}, {"oid": "dc46eaf190aeae33f621ddfa4eea3eda4853a00d", "url": "https://github.com/pravega/pravega/commit/dc46eaf190aeae33f621ddfa4eea3eda4853a00d", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-02T18:12:29Z", "type": "commit"}, {"oid": "ac167ff6af108e0ccdb7ee8ad7236916d997da4b", "url": "https://github.com/pravega/pravega/commit/ac167ff6af108e0ccdb7ee8ad7236916d997da4b", "message": "* Add single flag to control whether or not to build the client using JDK11.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-02T18:46:35Z", "type": "commit"}, {"oid": "9261b5e2ff83f783bf0b5115123eb6d21a4cb09d", "url": "https://github.com/pravega/pravega/commit/9261b5e2ff83f783bf0b5115123eb6d21a4cb09d", "message": "Use one source of truth for the default Java version.\nAdd a gradle property to set the client's Java version.\nUpdate README.md.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-03T16:44:41Z", "type": "commit"}, {"oid": "720eb800eff962b098530dff247854387c3b0648", "url": "https://github.com/pravega/pravega/commit/720eb800eff962b098530dff247854387c3b0648", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-03T17:51:23Z", "type": "commit"}, {"oid": "6dae234c4c13ce63676ecb0ab255f4da98172b39", "url": "https://github.com/pravega/pravega/commit/6dae234c4c13ce63676ecb0ab255f4da98172b39", "message": "Remove '(source/target)Compatibility' references and replace them with a release flag.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-03T22:50:47Z", "type": "commit"}, {"oid": "fbe7ef9cadd88b3258d247dcf98df140ba73bcc1", "url": "https://github.com/pravega/pravega/commit/fbe7ef9cadd88b3258d247dcf98df140ba73bcc1", "message": "Remove default 'imageVersion'.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-03T22:53:10Z", "type": "commit"}, {"oid": "45975ccb6bb59009c6d214431393e5238761615f", "url": "https://github.com/pravega/pravega/commit/45975ccb6bb59009c6d214431393e5238761615f", "message": "Merge remote-tracking branch 'origin/issue-5082-java-11-migration' into issue-5082-java-11-migration", "committedDate": "2020-09-03T22:53:33Z", "type": "commit"}, {"oid": "edf8c7f2a100099263e408d9378f76e02c4416ee", "url": "https://github.com/pravega/pravega/commit/edf8c7f2a100099263e408d9378f76e02c4416ee", "message": "Remove unnecessary/verbose components.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-04T06:47:52Z", "type": "commit"}, {"oid": "674bd779f68f35b8f63dd665c653c404c2e08be7", "url": "https://github.com/pravega/pravega/commit/674bd779f68f35b8f63dd665c653c404c2e08be7", "message": "Clarify documentation.\nConsolidate Java compilerArgs.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-04T20:27:12Z", "type": "commit"}, {"oid": "7daca88b895a490b90c62db027c5f4a9815487d4", "url": "https://github.com/pravega/pravega/commit/7daca88b895a490b90c62db027c5f4a9815487d4", "message": "Build longevity tests using the targeted client version as well (JDK 8).\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-04T23:31:00Z", "type": "commit"}, {"oid": "38b306ba5816c9b62d33866d00f94d1dccba8148", "url": "https://github.com/pravega/pravega/commit/38b306ba5816c9b62d33866d00f94d1dccba8148", "message": "Revert using afterEvaluate. The last instance of the flag takes precedence.\nAlso add release flag to test classes.\nReplace the --release version, instead of relying on the construction ordering to ensure the proper version is given.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-05T19:52:41Z", "type": "commit"}, {"oid": "c9ce48fb1fe1f67f36ed9da857c17c325c3d6c18", "url": "https://github.com/pravega/pravega/commit/c9ce48fb1fe1f67f36ed9da857c17c325c3d6c18", "message": "Remove duplicate function declaration.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-08T16:56:35Z", "type": "commit"}, {"oid": "75b5be33d44a1fbf53105215620c1c9ff56a90c5", "url": "https://github.com/pravega/pravega/commit/75b5be33d44a1fbf53105215620c1c9ff56a90c5", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-08T17:02:27Z", "type": "commit"}, {"oid": "01beb6f678d56092ed1f057bf39b7b20adbc3f0d", "url": "https://github.com/pravega/pravega/commit/01beb6f678d56092ed1f057bf39b7b20adbc3f0d", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-10T19:06:29Z", "type": "commit"}, {"oid": "6e58a03e8bd12466afd4dd26ce24370b0c80ee81", "url": "https://github.com/pravega/pravega/commit/6e58a03e8bd12466afd4dd26ce24370b0c80ee81", "message": "Add options to ensure Java 11 compatibility.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T04:20:26Z", "type": "commit"}, {"oid": "45edd7f26b6e56bce0a4ef33b52f1b7ee0f3c44d", "url": "https://github.com/pravega/pravega/commit/45edd7f26b6e56bce0a4ef33b52f1b7ee0f3c44d", "message": "Merge remote-tracking branch 'origin/issue-5082-java-11-migration' into issue-5082-java-11-migration", "committedDate": "2020-09-15T04:22:20Z", "type": "commit"}, {"oid": "b3175104e6314cfe5e17b33350ec5a6a736854a7", "url": "https://github.com/pravega/pravega/commit/b3175104e6314cfe5e17b33350ec5a6a736854a7", "message": "Increase pod ready timeout.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T05:46:38Z", "type": "commit"}, {"oid": "44cf28160c9a389be1e93430e2ad72b8bcf85cc4", "url": "https://github.com/pravega/pravega/commit/44cf28160c9a389be1e93430e2ad72b8bcf85cc4", "message": "Remove flag.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T20:42:35Z", "type": "commit"}, {"oid": "ac46515646508c46017ab86bff44083f9303d7b9", "url": "https://github.com/pravega/pravega/commit/ac46515646508c46017ab86bff44083f9303d7b9", "message": "Add new flag to ignore unrecognized flags.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T20:57:15Z", "type": "commit"}, {"oid": "8dbb799ef6802f31506024d1e40bf8b4ad7cb982", "url": "https://github.com/pravega/pravega/commit/8dbb799ef6802f31506024d1e40bf8b4ad7cb982", "message": "Typo in JVM option.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T21:32:53Z", "type": "commit"}, {"oid": "734d51acc2a3415b10ec4771145c2d958f60337e", "url": "https://github.com/pravega/pravega/commit/734d51acc2a3415b10ec4771145c2d958f60337e", "message": "Fix typo in comment.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T21:52:43Z", "type": "commit"}, {"oid": "ba9edb658e418893f0f21636285847b6d62026c9", "url": "https://github.com/pravega/pravega/commit/ba9edb658e418893f0f21636285847b6d62026c9", "message": "Use proper key for `spec.pravega` property.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-15T22:02:17Z", "type": "commit"}, {"oid": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "url": "https://github.com/pravega/pravega/commit/e717e45f56bcdf7566102059520a0eb60b2a5a21", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-16T20:34:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQxNzIwMg==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492417202", "bodyText": "@co-jo can you please file an issue for Pravega Operator to remove usage of UseCGroupMemoryLimitForHeap for Pravega 0.9+", "author": "medvedevigorek", "createdAt": "2020-09-22T00:25:51Z", "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -288,6 +290,16 @@ private static boolean isOperatorVersionAbove040() {\n         }));\n     }\n \n+    // Removal of the JVM option 'UseCGroupMemoryLimitForHeap' is required with JVM environments >= 10. This option\n+    // is supplied by default by the operators. We cannot 'deactive' it using the XX:- counterpart as it is unrecognized.", "originalCommit": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQyMjg5NQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492422895", "bodyText": "@co-jo can you please file an issue for Pravega Operator to remove usage of UseCGroupMemoryLimitForHeap for Pravega 0.9+\n\nSure.", "author": "co-jo", "createdAt": "2020-09-22T00:50:03Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQxNzIwMg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2MTQ3OA==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492461478", "bodyText": "Why do we need IgnoreUnrecognizedVMOptions?", "author": "tkaitchuck", "createdAt": "2020-09-22T03:56:27Z", "path": "test/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "diffHunk": "@@ -288,6 +290,16 @@ private static boolean isOperatorVersionAbove040() {\n         }));\n     }\n \n+    // Removal of the JVM option 'UseCGroupMemoryLimitForHeap' is required with JVM environments >= 10. This option\n+    // is supplied by default by the operators. We cannot 'deactive' it using the XX:- counterpart as it is unrecognized.\n+    private String[] getSegmentStoreJVMOptions() {\n+        return new String[]{\"-XX:+UseContainerSupport\", \"-XX:+IgnoreUnrecognizedVMOptions\"};\n+    }\n+\n+    private String[] getControllerJVMOptions() {\n+        return new String[]{\"-XX:+UseContainerSupport\", \"-XX:+IgnoreUnrecognizedVMOptions\"};", "originalCommit": "e717e45f56bcdf7566102059520a0eb60b2a5a21", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ3NzU3MQ==", "url": "https://github.com/pravega/pravega/pull/5121#discussion_r492477571", "bodyText": "The Pravega Operator supplies certain default JVM options (+UseCGroupMemoryLimitForHeap), which are not recognized by later JVMs. Any kubernetes deployment wouldn't work until the Pravega Operator is adjusted accordingly.", "author": "co-jo", "createdAt": "2020-09-22T05:13:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MjQ2MTQ3OA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "749e12f986c8bcbf7b31c72fb094cd05b915ce35", "url": "https://github.com/pravega/pravega/commit/749e12f986c8bcbf7b31c72fb094cd05b915ce35", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-22T11:24:13Z", "type": "commit"}, {"oid": "d382a164f2ea0258f61184003ff068c06a9a7348", "url": "https://github.com/pravega/pravega/commit/d382a164f2ea0258f61184003ff068c06a9a7348", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-22T16:28:41Z", "type": "commit"}, {"oid": "69293fb0a48c9f2313a7ece31a4f6f700cd9385d", "url": "https://github.com/pravega/pravega/commit/69293fb0a48c9f2313a7ece31a4f6f700cd9385d", "message": "Merge branch 'master' into issue-5082-java-11-migration", "committedDate": "2020-09-24T19:50:00Z", "type": "commit"}, {"oid": "4ae1179d01f05185e24a71f35cf9ebb2c49cfc9d", "url": "https://github.com/pravega/pravega/commit/4ae1179d01f05185e24a71f35cf9ebb2c49cfc9d", "message": "Merge remote-tracking branch 'upstream/master' into issue-5082-java-11-migration\n\n# Conflicts:\n#\tbuild.gradle\n#\ttest/system/src/main/java/io/pravega/test/system/framework/services/kubernetes/AbstractService.java", "committedDate": "2020-09-25T17:27:44Z", "type": "commit"}, {"oid": "a6841cd2815de96168f2be2e67c5d89091287e3b", "url": "https://github.com/pravega/pravega/commit/a6841cd2815de96168f2be2e67c5d89091287e3b", "message": "Remove package.\n\nSigned-off-by: co-jo <colin.hryniowski@dell.com>", "committedDate": "2020-09-28T16:25:34Z", "type": "commit"}]}