{"pr_number": 4965, "pr_title": "Issue 4964: Prevent a busy loop while waiting for the segments to be updated", "pr_createdAt": "2020-07-22T23:33:42Z", "pr_url": "https://github.com/pravega/pravega/pull/4965", "timeline": [{"oid": "d4ba24fb1dddc6b5fc551d164c8994efc7e668b7", "url": "https://github.com/pravega/pravega/commit/d4ba24fb1dddc6b5fc551d164c8994efc7e668b7", "message": "Issue 5260: (SegmentStore) Adjustable Operation Priority Levels (#5268)\n\nAdded the ability to differentiate between segments based on their Segment Type.\r\nAdded the ability to prioritize Operations based on the owning Segment Segment Type and Operation Type\r\nIdentifying all Table Segments (Sorted and not sorted) as their own Segment Type.\r\nDesignating Segment Container Metadata Segments as \"System Segment\".\r\nDesignating Storage Metadata Segments as \"System Critical\" segments.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "fd693ea81acb04c547569a35a14d43d84cb495a8", "url": "https://github.com/pravega/pravega/commit/fd693ea81acb04c547569a35a14d43d84cb495a8", "message": "Issue 5067: (SLTS) - Convert synchronous ChunkStorage and ChunkMetadataStore API into async (#5200)\n\nConvert synchronous ChunkStorage and ChunkMetadataStore API into async. There are also improvements in how transactions are serialized allowing for greater parallelism.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "9dea67b126e67615c17f3a9e1e740ed4decde269", "url": "https://github.com/pravega/pravega/commit/9dea67b126e67615c17f3a9e1e740ed4decde269", "message": "Issue 5115: Allow reads using read-only permissions (#5231)\n\n* Distinguishes between required and target permissions\r\n  when generating delegation tokens in the Controller.\r\n* Requires\u00a0read  permissions by default for internal/state\r\n   synchronizer streams.\r\n* Adds a new configuration:\r\n\r\n  \u00a0controller.security.auth.internalStreams.writesWithReadPermissions.enable\r\n\u00a0\r\n that determines whether read/write permissions are\r\n required for internal streams (default is\u00a0true).\r\n* Uses the new resource format specified developed in\r\n PR\u00a0#5051\u00a0to authorize writes to reader groups and\r\n watermark streams.\r\n* Creates a new shared class to represent access\r\n operations.\r\n* Modifies the DelegationTokenProvider and its main\r\n implementation\u00a0JwtTokenProviderImpl\u00a0to take in Access\r\n operation as well, and pass it on during calls to obtain\r\n delegation token.\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "de09009124145fb0cf70683c1e6907cc7f0302d4", "url": "https://github.com/pravega/pravega/commit/de09009124145fb0cf70683c1e6907cc7f0302d4", "message": "Issue 5341: Fix thread leak in controller (#5343)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "af7b8fc317745badfc4823480f3764f48797bbb8", "url": "https://github.com/pravega/pravega/commit/af7b8fc317745badfc4823480f3764f48797bbb8", "message": "Issue 5320: Metrics and Stats Reporting Optimizations (#5337)\n\n- Changed DynamicLoggerImpl to use a simplified Cache (instead of Guava Cache).\r\n- Optimized SegmentStatsRecorderImpl to use fewer resources.\r\n- Replaced usages of Dynamic Logger throughout the Segment Store codebase with the equivalent Counter, Metric and OpStatsLogger implementations.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b056c2f4362c1e63a1424999b54b9242b23f369f", "url": "https://github.com/pravega/pravega/commit/b056c2f4362c1e63a1424999b54b9242b23f369f", "message": "Issue 4874: Upgrade HDFS Client from 2.x to 3.x in order to address security vulnerabilities (#5340)\n\nUpgrade HDFS client version to the latest version, which is currently 3.3.0 as per Maven Repo.\r\n\r\n\r\nSigned-off-by: rsharda <ravi.sharda@emc.com>\r\n\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "c3b84aec232a709e71c6688022e6f2c3571006f4", "url": "https://github.com/pravega/pravega/commit/c3b84aec232a709e71c6688022e6f2c3571006f4", "message": "Issue 5139: Ensure writer does not retry indefinitely to establish a connection with Pravega. (#5307)\n\nEnsure EventStreamWriter.writeEvent(..)does not indefinitely try to establish a connection with Pravega. The future returned by this API will be completed exceptionally incases the client writer is not able to establish a conection with Pravega even after retrying based on the the EventWriterConfig configuration.\r\n\r\nEnsure EventStreamWriter.flush() throws a RetriesExhaustedException incase the client fails to establish connectivity with Pravega.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "e4e521865b64307b893af35133bf137e043ce1cc", "url": "https://github.com/pravega/pravega/commit/e4e521865b64307b893af35133bf137e043ce1cc", "message": "Issue 5257 and 5118: Improve organization of security code for reuse in related projects like Schema Registry (#5339)\n\n* Moves out the password-based auth handler into its own Gradle module shared:basic-authplugin. \r\n* Moves reusable classes from controller and client into shared:security. \r\n* Modifies the Auth Handler plugin interface to inject configurations to plugins via properties, thereby removing their dependency to Controller / GRPCServerConfig class. \r\n\r\nSigned-off-by: rsharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "97d1491ff2a84f36667860b59dc3de812d896475", "url": "https://github.com/pravega/pravega/commit/97d1491ff2a84f36667860b59dc3de812d896475", "message": "Issue 5114: Update the StreamCut for lastCheckpoint to Controller, once reader has moved past it (#5304)\n\n* Publishes truncation Stream-Cut to Controller which can be used for Consumption Based Retention of data in the Stream. \r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "a9d89a14cb32f1dbb9b3e8da67386b8938078565", "url": "https://github.com/pravega/pravega/commit/a9d89a14cb32f1dbb9b3e8da67386b8938078565", "message": "Issue 5375: (SegmentStore) Logging the exception in StreamSegmentReadIndex.queueStorageRead (#5376)\n\nFixed the error logging in StreamSegmentReadIndex.queueStorageRead to log the exception, not just the message.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "d60656aa0263c343aece379e0a4dc1619a1bb111", "url": "https://github.com/pravega/pravega/commit/d60656aa0263c343aece379e0a4dc1619a1bb111", "message": "Issue 5392: Adapt Gradle script to accommodate specific Bookkeeper images in system tests (#5394)\n\nAdded one more param in build.gradle to accept Bookkeeper version, so that it can be added in operator configmap.\r\n\r\nSigned-off-by: anishakj <anisha.kj@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "cfdc33e89ffda6b1a3c7de06705c0a9fa58f5c21", "url": "https://github.com/pravega/pravega/commit/cfdc33e89ffda6b1a3c7de06705c0a9fa58f5c21", "message": "Issue 5382: Adding Java cacerts to openjdk:11.0.8-jre-slim Base Image (#5398)\n\nInstalls Java cacerts/system truststore to OpenJdk 11 installation\r\n\r\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b167f1ea5bfe1ef2c624d450795b07b73be6a834", "url": "https://github.com/pravega/pravega/commit/b167f1ea5bfe1ef2c624d450795b07b73be6a834", "message": "Issue 5360: Require permissions on the scope for creating Key-Value Tables (#5366)\n\nSigned-off-by: rsharda <ravi.sharda@emc.com>\r\n\r\n## Change log description\r\nModify resource string used for authorizing Key-Value table creation operation from the resource to its parent resource (e.g., prn::/scope:scope1/key-value-table:table1) to its parent resource - the Scope (prn::/scope:scope1).\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "d59d8b800b789e99e2a4ae5c85ea8d837ccfd24a", "url": "https://github.com/pravega/pravega/commit/d59d8b800b789e99e2a4ae5c85ea8d837ccfd24a", "message": "Issue 5385: Upgrade Bookkeeper to last stable version (4.11.1) (#5386)\n\nUpgrades the version of Bookkeeper in Pravega to 4.11.1 (client, documentation, dockerfile).\r\n\r\nSigned-off-by: Ra\u00fal <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "a6b334e71a5ce0d50dc2a8a14a2e8b3674933c7d", "url": "https://github.com/pravega/pravega/commit/a6b334e71a5ce0d50dc2a8a14a2e8b3674933c7d", "message": "Issue 5395: SLTS - Allow parallel/non-sequential read operations. (#5397)\n\n\r\nAllow parallel/non-sequential read operations with SLTS.\r\n\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\r\n\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b39a924e048af8b8d2e8e8c5e72f459e3cefc3fd", "url": "https://github.com/pravega/pravega/commit/b39a924e048af8b8d2e8e8c5e72f459e3cefc3fd", "message": "Issue 5414: Ensure getClientConnection throws an exception incase the connection pool is closed. (#5415)\n\nEnsure getClientConnection throws an exception incase the connection pool is closed.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "e2dbe1336bc4b826761fd71cf83e43046ac527de", "url": "https://github.com/pravega/pravega/commit/e2dbe1336bc4b826761fd71cf83e43046ac527de", "message": "Issue 5421: Avoid closing pre-existing metrics. (#5422)\n\nIn the case a duplicate meter on a StatsLogger is ever created, it avoids inadvertently closing the very same metric we are trying to use.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b2984ecb30d6fa63fcd1ab952d211b5bc55a8d43", "url": "https://github.com/pravega/pravega/commit/b2984ecb30d6fa63fcd1ab952d211b5bc55a8d43", "message": "Issue 5433: Remove redundant read request sent by the BatchClient reader. (#5432)\n\nRemove redundant read request sent by the BatchClient reader.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "c8e984da74851ae1217d36c6a1855e4b13d2c4e6", "url": "https://github.com/pravega/pravega/commit/c8e984da74851ae1217d36c6a1855e4b13d2c4e6", "message": "Issue 5384: Add Controller APIs to Create, Update and Delete Reader Groups (#5400)\n\n* Adds apis to manage readergroup's lifecycle on controller with CRUD apis on readergroup and generation management of readergroup config. \r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "9cb35a5d75b1052af612b28199ef6db74abc4245", "url": "https://github.com/pravega/pravega/commit/9cb35a5d75b1052af612b28199ef6db74abc4245", "message": "Issue 5448: Deprecate existing DefaultCredentials in favor of a new one placed in a more appropriate location (#5449)\n\n* Deprecate existing DefaultCredentials and introduce a new one\r\n\r\nSigned-off-by: rsharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "f63ea224774a7c89b4a4aa7ea413144527197597", "url": "https://github.com/pravega/pravega/commit/f63ea224774a7c89b4a4aa7ea413144527197597", "message": "Issue 4998: Fix flaky testCheckpointAndRestore test. (#5463)\n\nFix flaky testCheckpointAndRestore test.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "a96a8a43facdc56106579fc91a6a96412591300b", "url": "https://github.com/pravega/pravega/commit/a96a8a43facdc56106579fc91a6a96412591300b", "message": "Issue 5465: Re-creating Reader Group with same name fails (#5466)\n\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "a40c5586a5f5a641e8ab9156f0c40fbbc5e34d17", "url": "https://github.com/pravega/pravega/commit/a40c5586a5f5a641e8ab9156f0c40fbbc5e34d17", "message": "Issue 5476: ReaderGroupConfiguration to ReaderGroupConfig conversion support for UNBOUNDED StreamCuts (#5477)\n\nSigned-off-by: anirudhkovuru <anirudhkovuru@gmail.com>\r\n\r\n## Change log description\r\nCurrently when a ReaderGroupConfig is converted into a controller side ReaderGroupConfiguration, the StreamCut.UNBOUNDED cases are stored as empty lists.\r\nIn both the ModelHelper and CreateReaderGroupTask, when an empty stream-cut list is found, we store it as an UNBOUNDED instead.\r\nAdded a check to identify StreamCut.UNBOUNDED cases and deal with them separately.\r\n\r\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "c1065deb0058d4fc9ff3f46ea92d05983070f222", "url": "https://github.com/pravega/pravega/commit/c1065deb0058d4fc9ff3f46ea92d05983070f222", "message": "Issue: 5467 updateReaderGroup hangs when changing configuration from subscriber to non-subscriber (#5473)\n\nupdateReaderGroup() API requires handling stream subscriptions when a ReaderGroup Configuration has stream changes and/or when the Config changes Retention.Type from a non-subscriber or a subscriber or vice-versa.\r\nThese multiple combinations were not handled correctly leading to the 'updating' flag in ReaderGroupConfigRecord staying \"true\" and never changing to \"false\" when a ReaderGroup config is changed from subscriber to non-subscriber.\r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "d793265ce17d4837560af6c001175406fff4d632", "url": "https://github.com/pravega/pravega/commit/d793265ce17d4837560af6c001175406fff4d632", "message": "Issue 5454: Fixing Segment Store flaky tests and other bugs (#5472)\n\n- Fixing various unit tests in the Segment Store package(s) that caused builds to randomly fail.\r\n- Fixed a bug in BlockingDrainingQueue that would have resulted in data loss if a TimeoutException preempted the completion of a timeout-eligible take future (#5516).\r\n- Fixed a bug in OperationProcessor error handler to initiate the service shutdown in an async manner (to avoid deadlocks)\r\n- Fixed a bug in OperationProcessor to \"unaccount\" for the cache effects of operations that are in flight but have failed to be committed due to the service shutting down (byte accounting leak).\r\n- Fixed a bug in StreamSegmentReadIndex that would have caused a ReadResult to hang if certain concurrency conditions occur (merging a source segment into a parent one at the same time as either issuing the ReadResultEntry or completing it).\r\n- Fixed a bug in RedirectedReadIndexEntry that would throw an UnsupportedOperationException when attempting to close. This is invoked when a ReadResult is cancelled/cleaned up (so if it's sitting on one of those entries, the operation would fail).\r\n- Fixed a bug in StreamSegmentContainer that would incorrectly report as \"Failed\" if it is immediately shut down after startup (i.e., if the secondary services haven't yet been started).\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "ad3b1f717c41804610a227943c5358a312afdcc1", "url": "https://github.com/pravega/pravega/commit/ad3b1f717c41804610a227943c5358a312afdcc1", "message": "Issue 5451: Refine distributed mode cluster security documentation (#5452)\n\n* Moves TLS material generation into its own separate document: generating-tls-material.md\r\n* Significantly revises the description of TLS material generation to explain the considerations and steps better. Also, fixes some minor bugs.\r\n* Improves descriptions in the main document: securing-distributed-mode-cluster.md\r\n\r\nSigned-off-by: rsharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "f96e4b39c0834f6c7859a2b18ef0473980c59263", "url": "https://github.com/pravega/pravega/commit/f96e4b39c0834f6c7859a2b18ef0473980c59263", "message": "Issue 5506: Read/Read-Update permissions for the ReaderGroup operations on controller (#5508)\n\nSigned-off-by: anirudhkovuru anirudhkovuru@gmail.com\r\n\r\n## Change log description\r\n1. Added changes to the ControllerServiceImpl to ensure the correct permissions are provided when performing ReaderGroup operations on the controller.\r\n2. Using the isRGStreamWritesWithReadPermEnabled flag to ensure the required permissions are correctly imparted.\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b4e190517105d12458c1ce0ae23607a8bcce3447", "url": "https://github.com/pravega/pravega/commit/b4e190517105d12458c1ce0ae23607a8bcce3447", "message": "Issue 5546: Fix NPE in DynamicRestApiTest (#5548)\n\nFix NPE in DynamicRestApiTest system test.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "a9d5c21137728d24e9ba171b2657e54bab41f29e", "url": "https://github.com/pravega/pravega/commit/a9d5c21137728d24e9ba171b2657e54bab41f29e", "message": "Issue 5112: Client API to Create Subscriber reader groups (#5439)\n\n*  The ReaderGroup operations createReaderGroup, deleteReaderGroup and resetReaderGroup have been modified such that, in the case of the ReaderGroup being a subscriber the controller calls are made to ensure consistent subscription/unsubscription to all the necessary streams.\r\n\r\nSigned-off-by: anirudhkovuru <anirudhkovuru@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "9f9807ee60235be02560963a05221e2e1c0de815", "url": "https://github.com/pravega/pravega/commit/9f9807ee60235be02560963a05221e2e1c0de815", "message": "Issue 5523: Enabling GithubActions and Disabling Travis CI (#5563)\n\n* Disabled .travis.yml as we will no longer be using Travis CI. This file will be deleted in a subsequent PR.\r\n* Set up GitHub Actions workflow as follows:\r\n   - Triggers on master branch and release branch pushes, on every pull request (regardless of branch) and release publish.\r\n    - Has a compile and static analysis job, followed by a few parallel test jobs, then a check and a snapshot (only for master branch and release branches).\r\n    - Check job is called CI Complete.\r\n* Bonus features:\r\n    - Build output is cached after the Build step and reused for subsequent jobs. This speeds up the overall workflow run.\r\n    - Test execution output, history and reports is cached on a per workflow-job basis. If a workflow is re-run for whatever reason (such as one job failing), the successful jobs will execute much faster (by skipping all tests that passed).\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "be71f8a35f5817325a0edd160af6b76eb5df8ac4", "url": "https://github.com/pravega/pravega/commit/be71f8a35f5817325a0edd160af6b76eb5df8ac4", "message": "Issue 5546, 5547: Fix flaky tests (#5564)\n\nFixes for flaky tests: \r\n- Ensure system test DynamicRestApi works with auth enabled.\r\n- Remove incorrect fix with SO_REUSEADDR when looking for free ports in tests.\r\n- Fixed bug in EndToEndTruncationTest.testDeleteStreamWhileReading().\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "ee0992d14c4613319680e9cd080d090fe6093dae", "url": "https://github.com/pravega/pravega/commit/ee0992d14c4613319680e9cd080d090fe6093dae", "message": "Issue 5518: (SLTS) Fix Integer overflow. (#5520)\n\nFix integer overflow errors in ReadOperation and DefragmentOperation.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "9a99223b1ab2e0ca4334df36be42945ce4562016", "url": "https://github.com/pravega/pravega/commit/9a99223b1ab2e0ca4334df36be42945ce4562016", "message": "Issue 5442: Ensure the test case that is running is logged. (#5441)\n\nEnsure the test case that is running is logged. And log the last 300 lines of the test that failed.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "cbf5fe12044d502bf9870cef7c7f9acdff67c03b", "url": "https://github.com/pravega/pravega/commit/cbf5fe12044d502bf9870cef7c7f9acdff67c03b", "message": "Issue 5519: (SegmentStore) SegmentAttributeIndex bug fixes. (#5521)\n\n- Updated SegmentAttributeBTreeIndex to recover a BTreeIndex using solely the information encoded in the index file if the LTS adapter used supports atomic writes.\r\n- Fixed a bug in SegmentAttributeBTreeIndex where it would corrupt in-memory state (and require a process restart) if unable to store entries in the cache after an update.\r\n- Improved SegmentAttributeBTreeIndex to handle cache insertion exceptions (do not bubble up and log accordingly).\r\n- Fixed a bug in StreamSegmentContainer where it would not be closing the Attribute Indices upon shutdown.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\nCo-authored-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b095856030d3598a903d449dd0e621df3f3b21ff", "url": "https://github.com/pravega/pravega/commit/b095856030d3598a903d449dd0e621df3f3b21ff", "message": "Issue 5587: BookKeeper Docker Image build failure (#5588)\n\nRemove unnecessary zk-shell install from Pravega Bookkeeper dockerfile, as it is already included in Bookkeeper base image.\r\n\r\nSigned-off-by: Andrey Koltsov <a99920641@gmail.com>\r\nCo-authored-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "ef62191b4b6743fe14c5d72198ebdefaca15777d", "url": "https://github.com/pravega/pravega/commit/ef62191b4b6743fe14c5d72198ebdefaca15777d", "message": "Issue 5584: Avoid Prematurely closing SegmentStore Write Metrics (#5591)\n\nAvoids prematurely closing SEGMENT_WRITE_BYTE metrics on segments due to eviction of transaction segment SimpleCache entries (multiple entries reference the same MetricProxy).\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "fd1df47e267e13c2b37d158d7f21c4f97ba7a54a", "url": "https://github.com/pravega/pravega/commit/fd1df47e267e13c2b37d158d7f21c4f97ba7a54a", "message": "Issue 5535: (SegmentStore) Refactoring ExtendedS3 Test Mocks (#5537)\n\nCreated S3Mock which is an in-memory mock for S3 Storage. This is to be used in conjunction with S3ClientMock (which subclasses S3JerseyClient and overrides any methods that go over the network).\r\nRetired S3ProxyImpl.java (and org.gaul.s3proxy).\r\nRetired S3FileSystemImpl.java and replaced its usages with S3Mock.\r\nSimplified ExtendedS3Storage.listSegments iterator by invoking actual iterator only once.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\nCo-authored-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "f494ba9fd12a2bfc548becf7d9eb7f562cb98d7a", "url": "https://github.com/pravega/pravega/commit/f494ba9fd12a2bfc548becf7d9eb7f562cb98d7a", "message": "Issue 5456: (SLTS) - Handle possible failure during deletion of metadata keys can cause version mismatch in next attempt (#5457)\n\nHandle possible failure during deletion of metadata keys that can cause version mismatch in next attempt.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "d5b4fb3e15b1f041a7e9d3fb69467386a8e15b45", "url": "https://github.com/pravega/pravega/commit/d5b4fb3e15b1f041a7e9d3fb69467386a8e15b45", "message": "Issue 5393: Logging improvements for Controller (#5613)\n\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "f24c76095a07a6d4d658ff0059158fcab594f64e", "url": "https://github.com/pravega/pravega/commit/f24c76095a07a6d4d658ff0059158fcab594f64e", "message": "Issue 5650: Fix for Controller CreateReaderGroup API race condition (#5651)\n\n*  createReaderGroup API in Controller is not idempotent when trying to recreate a partially created ReaderGroup\r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "b5e6af9e97b5eabb176f22d06a1718eba62e8500", "url": "https://github.com/pravega/pravega/commit/b5e6af9e97b5eabb176f22d06a1718eba62e8500", "message": "Issue 5664: SLTS - fix possible thread visibility issues.. (#5665)\n\nUse Collections.synchronized /synchronized to force memory barrier.\r\nUse volatile for mutable variables.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "c67d19eb36e4d906ba9ccaba5092cb1b61c447ed", "url": "https://github.com/pravega/pravega/commit/c67d19eb36e4d906ba9ccaba5092cb1b61c447ed", "message": "Issue 5475: Eliminate unnecessary pessimistic checks. (#5662)\n\nEliminate pessimistic check and instead optimistically proceed to read/write directly and handle failures only when we encounter them.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "dbc4c29e8cbca87f30e0db64519651174f7a94d8", "url": "https://github.com/pravega/pravega/commit/dbc4c29e8cbca87f30e0db64519651174f7a94d8", "message": "Fix the default configuration for StateSyncrhonizer. (#5668)\n\nEnsure the segment writer spawned by the StateSyncrhonizer attempt to establish a connection with the SegmentStore in the background until the StateSyncrhonizer is closed.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "d55f2931cf1083468369d8b48dfe1c53ddff4d73", "url": "https://github.com/pravega/pravega/commit/d55f2931cf1083468369d8b48dfe1c53ddff4d73", "message": "Issue 5679: (SegmentStore) (BugFix) Appends may be erroneously rejected with BadOffsetException\n\nFixed a bug in SegmentMetadataUpdateTransaction where the StreamSegmentAppendOperation's offset would be inadvertently updated if that operation was rejected for other reasons.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "ab5ba24e5bebf90366542471768f83c51c2f9540", "url": "https://github.com/pravega/pravega/commit/ab5ba24e5bebf90366542471768f83c51c2f9540", "message": "Issue 5666: Watermarking system test failure (#5671)\n\n*  Fixes WatermarkingTest to make sure that the time window converges before executing assertions.\r\n\r\nSigned-off-by: Ra\u00fal <raul.gracia@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "54e2444b194c1be3ac70b0719459a88b0e5d293f", "url": "https://github.com/pravega/pravega/commit/54e2444b194c1be3ac70b0719459a88b0e5d293f", "message": "Issue 5647: (SegmentStore) (BugFix) Table Segment Conditional Updates may fail if Compaction occurs simultaneously\n\nFixed a bug in ContainerKeyIndex where conditional update validation would fail if the update key has recently been relocated to a new position and the old key has been truncated away.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\n\r\nCo-authored-by: Sachin Jayant Joshi <44757683+sachin-j-joshi@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "c281ae9ce639b1140f538b740a9f6d68a2046488", "url": "https://github.com/pravega/pravega/commit/c281ae9ce639b1140f538b740a9f6d68a2046488", "message": "Issue 5672: MultiControllerTest system test failure (#5694)\n\nSigned-off-by: Ra\u00fal <raul.gracia@emc.com>\r\n\r\nCo-authored-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "7d58781554f1adac12786ce72b0c775dce85ec86", "url": "https://github.com/pravega/pravega/commit/7d58781554f1adac12786ce72b0c775dce85ec86", "message": "Issue 5683: Update the year and inlcude Pravega Authours in NOTICE file (#5684)\n\n*    Updates NOTICE file the new year range 2017-2021\r\n*   Adds Pravega Authors at the top to comply with CNCF guidelines\r\n\r\nSigned-off-by: Igor Medvedev <medvedevigorek@gmail.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "15eb4c19c5eda4ccf6b5d981b17c8b2acd95cb9c", "url": "https://github.com/pravega/pravega/commit/15eb4c19c5eda4ccf6b5d981b17c8b2acd95cb9c", "message": "Issue 4967: (SLTS) No need to check last chunk length for claimOwnership for no append mode. (#5663)\n\nNo need to check last chunk length for claimOwnership for no append mode.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\r\n\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "725402044b29115603a214c5e4a2788bc9d6179c", "url": "https://github.com/pravega/pravega/commit/725402044b29115603a214c5e4a2788bc9d6179c", "message": "Issue 5677: Ensure append is conditional before treating it as one. (#5678)\n\nEnsure append is conditional before treating it as one.\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "30bc9bf772af5a6847c90d2b12fb22f9b4e049e0", "url": "https://github.com/pravega/pravega/commit/30bc9bf772af5a6847c90d2b12fb22f9b4e049e0", "message": "Issue 5709: (SegmentStore) Swap validation order for BadAttributeUpdateException and BadOffsetException for conditional appends #5710\n\nChanged validation order within SegmentMetadataUpdateTransaction.preProcessOperation(StreamSegmentAppendOperation).\r\nBadAttributeUpdateException now takes precedence over BadOffsetException if both would be a cause for rejection.\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "7ee486962b3679812cb993a83029494789816722", "url": "https://github.com/pravega/pravega/commit/7ee486962b3679812cb993a83029494789816722", "message": "Issue 5667: (Bug) Ensure ByteStreamWriter attempts connecting to SSS until it is closed. (#5691)\n\nEnsure ByteStreamWriter attempts connecting to SSS until the writer is closed.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "7c7c9fb1529689b89f020988c7cb466f5f30b966", "url": "https://github.com/pravega/pravega/commit/7c7c9fb1529689b89f020988c7cb466f5f30b966", "message": "Issue 5673: (SLTS) Fix wrong GC config (#5674)\n\nChanged SLTS GC time unit from seconds to milliseconds. Also changed the level of some log messages to reduce noise.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "fa31e79ce60bd83fc23937a07efd96b234ad5029", "url": "https://github.com/pravega/pravega/commit/fa31e79ce60bd83fc23937a07efd96b234ad5029", "message": "Issue 3699: Fix for flaky test StoreClientFactoryTest.testZkSessionExpiryRetry (#5602)\n\nThis PR fixes the following things about this test:\r\n* The assertion for expirationRetryCounter has been changed to check that retry counter is > 0, which means connection was retried at-least once post expiration. The actual number of retries is not of consequence to us here as it is not controlled by Pravega code.\r\n* The busy wait for Zookeeper State to be non-Alive is not necessary and can cause test timeouts, hence removed.\r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "80483ed4495268cfef8b63af270bd1e29f113e67", "url": "https://github.com/pravega/pravega/commit/80483ed4495268cfef8b63af270bd1e29f113e67", "message": "Issue 5659: Sporadic test failure in ReadWriteTest.readWriteTest (#5722)\n\nReduced the number of events written and read in the test, as well as do not log per-event messages.\r\n\r\nSigned-off-by: Ra\u00fal <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "ffe544dec9f535b8ce99281adac2c5d0abfd1ecc", "url": "https://github.com/pravega/pravega/commit/ffe544dec9f535b8ce99281adac2c5d0abfd1ecc", "message": "Issue 5729: Add LICENSE and NOTICE files into javadoc distribution #5731\n\nModifies javadoc tasks by adding license files into a set of files to be packaged as a distribution bundle\r\n\r\nSigned-off-by: Igor Medvedev <medvedevigorek@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "200672f4ed802d7200e90032bee16692c68cb706", "url": "https://github.com/pravega/pravega/commit/200672f4ed802d7200e90032bee16692c68cb706", "message": "Issue 5712: Internally idempotent conditional append  (#5713)\n\nAllows ConditionalOutputStream to internally retry InvalidEventNumber exceptions\r\nChanges reader group updates to double check the assumptions they make before updating the reader group.\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "13267940280e069634f130a680215a31076de4d4", "url": "https://github.com/pravega/pravega/commit/13267940280e069634f130a680215a31076de4d4", "message": "Issue 5690: Adding new stream or rg or kvt to scope should lazily create the metadata table if it doesnt exist (#5692)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\n\r\n## Change log description\r\nPost create scope, lazily create streamsinscopeTable, rgsInScopeTable and kvtsInScopeTable if they dont exist\r\ndelete scope should not be allowed if rg table and kvt table are non empty\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "55027daa744d0b2b4faf0ddcc08aee8ee2c03f5b", "url": "https://github.com/pravega/pravega/commit/55027daa744d0b2b4faf0ddcc08aee8ee2c03f5b", "message": "Issue 5656: Sporadic failure in test SecureBookKeeperLogTests.testAppendTransientBookieFailure (#5724)\n\nPause and resume processing in Bookies instead of restarting the whole process to simulate transient failures in testAppendTransientBookieFailure.\r\n\r\nSigned-off-by: Ra\u00fal <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "eefa9044d3e807ec282168a8d86845462c0afd59", "url": "https://github.com/pravega/pravega/commit/eefa9044d3e807ec282168a8d86845462c0afd59", "message": "Issue 5736: Ensure segment writers handles a race between SegmentIsSealed and reconnection to Segmentstore (#5735)\n\nFix the reconnection logic with a sealed segment on the Segment writer.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\n\r\nCo-authored-by: Tom Kaitchuck <tkaitchuck@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "commit"}, {"oid": "eefa9044d3e807ec282168a8d86845462c0afd59", "url": "https://github.com/pravega/pravega/commit/eefa9044d3e807ec282168a8d86845462c0afd59", "message": "Issue 5736: Ensure segment writers handles a race between SegmentIsSealed and reconnection to Segmentstore (#5735)\n\nFix the reconnection logic with a sealed segment on the Segment writer.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\n\r\nCo-authored-by: Tom Kaitchuck <tkaitchuck@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:26Z", "type": "forcePushed"}, {"oid": "6ef8204210deb8a0a8677a534f069fd637ba8649", "url": "https://github.com/pravega/pravega/commit/6ef8204210deb8a0a8677a534f069fd637ba8649", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-02-15T20:18:02Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjU0NjM5Ng==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r576546396", "bodyText": "The same issue can happen during the invocation of io.pravega.client.stream.impl.EventStreamWriterImpl#close", "author": "shrids", "createdAt": "2021-02-16T04:46:17Z", "path": "client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java", "diffHunk": "@@ -250,12 +250,32 @@ public void flush() {\n                         // available writers.\n                         success = false;\n                         log.warn(\"Flush on segment {} failed due to {}, it will be retried.\", writer.getSegmentName(), e.getMessage());\n+                        tryWaitForSuccessors();", "originalCommit": "6ef8204210deb8a0a8677a534f069fd637ba8649", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3ODgzMzQxMg==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r578833412", "bodyText": "Added", "author": "tkaitchuck", "createdAt": "2021-02-19T00:05:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjU0NjM5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "d20d1f0c3048da3cace5cb2a0df7a66e1a11d121", "chunk": "diff --git a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\nindex 24083d5d7..ff11a937d 100644\n--- a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n+++ b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n\n@@ -270,6 +270,8 @@ public class EventStreamWriterImpl<Type> implements EventStreamWriter<Type> {\n             // A background thread should be waking up to process things. Give it a moment.\n             Exceptions.handleInterrupted(() -> Thread.sleep(10));\n         }\n+        //This lock is only acquired to block this thread if there is a seal going on already.\n+        //This code does not actually need the lock for anything.\n         synchronized (writeSealLock) {\n             // Nothing needs to be done here.\n             // When the lock is released the sealing should be complete.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjU0ODMzMg==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r576548332", "bodyText": "No new writes are allowed once writeFlushLock is held by flush(),this implies that writer need not try to acquire the writeSealLock  to verify that retransmit to sealed segments are complete, right ?\nAlso, sealedSegmentQueue.isEmpty() check would suffice in the scenario where retransmit of inflight events face a sealed segment exception..", "author": "shrids", "createdAt": "2021-02-16T04:53:32Z", "path": "client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java", "diffHunk": "@@ -250,12 +250,32 @@ public void flush() {\n                         // available writers.\n                         success = false;\n                         log.warn(\"Flush on segment {} failed due to {}, it will be retried.\", writer.getSegmentName(), e.getMessage());\n+                        tryWaitForSuccessors();\n                         break;\n                     }\n                 }\n             }\n         }\n     }\n+    \n+    /**\n+     * This is used by flush to optimistically wait for the `handleLogSealed` work to be completed\n+     * to prevent a busy loop while waiting for the segments to be updated following a sealed\n+     * segment. Please note there are no guarantees about when this method returns. It can be\n+     * thought of as a sleep.\n+     */\n+    @GuardedBy(\"writeFlushLock\")\n+    private void tryWaitForSuccessors() {\n+        while (!sealedSegmentQueue.isEmpty()) {\n+            // A background thread should be waking up to process things. Give it a moment.\n+            Exceptions.handleInterrupted(() -> Thread.sleep(10));\n+        }\n+        synchronized (writeSealLock) {", "originalCommit": "6ef8204210deb8a0a8677a534f069fd637ba8649", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NzI2MzQxMQ==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r577263411", "bodyText": "We want to make sure that when flush is called it does not return until all the segments have been flushed. It aquires the writeFlushLock to prevent future writes. However there may be a concurrent seal. We just need to keep retrying calling flush on the writers until all have flushed. The previous logic was \"correct\" however in the event there was an ongoing seal it was wasteful because it would keep trying to flush a sealed segment over and over. The solution here it to attempt to block on the seal being completed. sealedSegmentQueue.isEmpty() Would tell us that no seal operation is pending. This is a necessary but not a sufficient criteria, because there could be still one in progress. The writeSealLock is not needed to do anything here, (Notice nothing is done inside of the lock) it's just done to queue the flush thread on an ongoing seal if one is indeed in progress.\nIf this is too confusing and you would like me to add a reusable latch, I am happy to make that change.", "author": "tkaitchuck", "createdAt": "2021-02-17T01:33:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjU0ODMzMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NzQ0NTQ4MQ==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r577445481", "bodyText": "ok \ud83d\udc4d", "author": "shrids", "createdAt": "2021-02-17T09:17:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjU0ODMzMg=="}], "type": "inlineReview", "revised_code": {"commit": "d20d1f0c3048da3cace5cb2a0df7a66e1a11d121", "chunk": "diff --git a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\nindex 24083d5d7..ff11a937d 100644\n--- a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n+++ b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n\n@@ -270,6 +270,8 @@ public class EventStreamWriterImpl<Type> implements EventStreamWriter<Type> {\n             // A background thread should be waking up to process things. Give it a moment.\n             Exceptions.handleInterrupted(() -> Thread.sleep(10));\n         }\n+        //This lock is only acquired to block this thread if there is a seal going on already.\n+        //This code does not actually need the lock for anything.\n         synchronized (writeSealLock) {\n             // Nothing needs to be done here.\n             // When the lock is released the sealing should be complete.\n"}}, {"oid": "f69a3d8289b236d651e204a21790333ded3400d2", "url": "https://github.com/pravega/pravega/commit/f69a3d8289b236d651e204a21790333ded3400d2", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-02-17T08:49:10Z", "type": "commit"}, {"oid": "c8133d3dc3678e175fbe9c66b1fbc76dec1a6c3a", "url": "https://github.com/pravega/pravega/commit/c8133d3dc3678e175fbe9c66b1fbc76dec1a6c3a", "message": "Add test\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-19T00:04:30Z", "type": "commit"}, {"oid": "d20d1f0c3048da3cace5cb2a0df7a66e1a11d121", "url": "https://github.com/pravega/pravega/commit/d20d1f0c3048da3cace5cb2a0df7a66e1a11d121", "message": "PR feedback\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-19T00:04:38Z", "type": "commit"}, {"oid": "1ab2345d0e9fc353654788accfbba133600986c8", "url": "https://github.com/pravega/pravega/commit/1ab2345d0e9fc353654788accfbba133600986c8", "message": "Merge branch 'slower_loop' of github.com:tkaitchuck/pravega-1 into slower_loop", "committedDate": "2021-02-19T00:05:00Z", "type": "commit"}, {"oid": "e99b590632c44c85c33413395dc1466bb08094e5", "url": "https://github.com/pravega/pravega/commit/e99b590632c44c85c33413395dc1466bb08094e5", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-02-19T00:05:18Z", "type": "commit"}, {"oid": "8f8311789a30ff506d3071e2f71db8d41a15047d", "url": "https://github.com/pravega/pravega/commit/8f8311789a30ff506d3071e2f71db8d41a15047d", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-02-23T06:54:13Z", "type": "commit"}, {"oid": "a3b95922173544491f4a2ae616f5b94071c142ab", "url": "https://github.com/pravega/pravega/commit/a3b95922173544491f4a2ae616f5b94071c142ab", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-02-24T07:05:22Z", "type": "commit"}, {"oid": "1e55a68bbf9785aefae91a5c2cb62bfe6d1230ee", "url": "https://github.com/pravega/pravega/commit/1e55a68bbf9785aefae91a5c2cb62bfe6d1230ee", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-02-26T04:04:54Z", "type": "commit"}, {"oid": "afc68d586a3e03e3c685287bff80554da34014ce", "url": "https://github.com/pravega/pravega/commit/afc68d586a3e03e3c685287bff80554da34014ce", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-03-02T00:27:58Z", "type": "commit"}, {"oid": "7d22b1607d1622df7356799042ba1f84d8da71a0", "url": "https://github.com/pravega/pravega/commit/7d22b1607d1622df7356799042ba1f84d8da71a0", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-03-03T17:24:22Z", "type": "commit"}, {"oid": "c53402322978a34a08ac82dcec2b9853f07d5600", "url": "https://github.com/pravega/pravega/commit/c53402322978a34a08ac82dcec2b9853f07d5600", "message": "Switch to using a latch\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-03-03T17:51:22Z", "type": "commit"}, {"oid": "e80f44667dffa0b745e2053cae6d9a8c25cc636b", "url": "https://github.com/pravega/pravega/commit/e80f44667dffa0b745e2053cae6d9a8c25cc636b", "message": "Merge branch 'slower_loop' of github.com:tkaitchuck/pravega-1 into slower_loop", "committedDate": "2021-03-03T17:51:55Z", "type": "commit"}, {"oid": "ff4069bb1c50290dc25af6d318cbcc33ef7669e5", "url": "https://github.com/pravega/pravega/commit/ff4069bb1c50290dc25af6d318cbcc33ef7669e5", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-03-03T19:31:15Z", "type": "commit"}, {"oid": "852fed234a4f120fc3ed1ac9cbf1fd23361bdb26", "url": "https://github.com/pravega/pravega/commit/852fed234a4f120fc3ed1ac9cbf1fd23361bdb26", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-03-18T19:13:49Z", "type": "commit"}, {"oid": "7c5633a397bcc004ce4c7cfdd89768403da396ad", "url": "https://github.com/pravega/pravega/commit/7c5633a397bcc004ce4c7cfdd89768403da396ad", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-03-23T10:52:52Z", "type": "commit"}, {"oid": "c851c960b1bbb2db43ae393ad0658ee223edf3ec", "url": "https://github.com/pravega/pravega/commit/c851c960b1bbb2db43ae393ad0658ee223edf3ec", "message": "Merge branch 'master' into slower_loop", "committedDate": "2021-03-24T08:37:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNTM5Mg==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459215392", "bodyText": "Are  you sure that the JVM (or even javac) won't drop this block? AFAIK the JVM is quite aggressive in skipping useless stuff and monitor related code", "author": "eolivelli", "createdAt": "2020-07-23T05:01:46Z", "path": "client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java", "diffHunk": "@@ -224,12 +224,32 @@ public void flush() {\n                         // available writers.\n                         success = false;\n                         log.warn(\"Flush on segment {} failed due to {}, it will be retried.\", writer.getSegmentName(), e.getMessage());\n+                        tryWaitForSuccessors();\n                         break;\n                     }\n                 }\n             }\n         }\n     }\n+    \n+    /**\n+     * This is used by flush to optimistically wait for the `handleLogSealed` work to be completed\n+     * to prevent a busy loop while waiting for the segments to be updated following a sealed\n+     * segment. Please note there are no guarantees about when this method returns. It can be\n+     * thought of as a sleep.\n+     */\n+    @GuardedBy(\"writeFlushLock\")\n+    private void tryWaitForSuccessors() {\n+        if (sealedSegmentQueue.isEmpty()) {\n+            synchronized (writeSealLock) {\n+                // Nothing needs to be done here.", "originalCommit": "1d14dfa610d3117229684e149ee671d2f0dbc8ad", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTUxNzg2OA==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459517868", "bodyText": "Yeah this could be a possibility.\nCould we try to use a ReusableLatch here or some Semaphore (or any other synchronization primitive)?", "author": "andreipaduroiu", "createdAt": "2020-07-23T15:02:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTUxOTk4OA==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459519988", "bodyText": "probably if you add a metric here (just a counter that counts how many times we fall into this case) the JVM will be happy as it thinks that we are doing something useful", "author": "eolivelli", "createdAt": "2020-07-23T15:05:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTU3MTgzMg==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459571832", "bodyText": "I think SpotBugs doesn't like this either. The build failed due to that.", "author": "andreipaduroiu", "createdAt": "2020-07-23T16:21:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTIxNTM5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "d4ba24fb1dddc6b5fc551d164c8994efc7e668b7", "chunk": "diff --git a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\nindex 6e78ae23f..4416eeb3a 100644\n--- a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n+++ b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n\n@@ -240,14 +261,14 @@ public class EventStreamWriterImpl<Type> implements EventStreamWriter<Type> {\n      */\n     @GuardedBy(\"writeFlushLock\")\n     private void tryWaitForSuccessors() {\n-        if (sealedSegmentQueue.isEmpty()) {\n-            synchronized (writeSealLock) {\n-                // Nothing needs to be done here.\n-                // When the lock is released the sealing should be complete.\n-            }\n-        } else {\n+        while (!sealedSegmentQueue.isEmpty()) {\n             // A background thread should be waking up to process things. Give it a moment.\n-            Exceptions.handleInterrupted(() -> Thread.sleep(100));\n+            Exceptions.handleInterrupted(() -> Thread.sleep(10));\n+        }\n+        synchronized (writeSealLock) {\n+            // Nothing needs to be done here.\n+            // When the lock is released the sealing should be complete.\n+            log.debug(\"Segment sealing completed, retrying flush.\");\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg0NTg2Mw==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459845863", "bodyText": "Is 100ms too high? This change implies that no new writes can happen via the EventStreamWriter for a max of  100ms since it holds the writeFlushLock.", "author": "shrids", "createdAt": "2020-07-24T04:24:42Z", "path": "client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java", "diffHunk": "@@ -224,12 +224,33 @@ public void flush() {\n                         // available writers.\n                         success = false;\n                         log.warn(\"Flush on segment {} failed due to {}, it will be retried.\", writer.getSegmentName(), e.getMessage());\n+                        tryWaitForSuccessors();\n                         break;\n                     }\n                 }\n             }\n         }\n     }\n+    \n+    /**\n+     * This is used by flush to optimistically wait for the `handleLogSealed` work to be completed\n+     * to prevent a busy loop while waiting for the segments to be updated following a sealed\n+     * segment. Please note there are no guarantees about when this method returns. It can be\n+     * thought of as a sleep.\n+     */\n+    @GuardedBy(\"writeFlushLock\")\n+    private void tryWaitForSuccessors() {\n+        if (sealedSegmentQueue.isEmpty()) {\n+            synchronized (writeSealLock) {\n+                // Nothing needs to be done here.\n+                // When the lock is released the sealing should be complete.\n+                log.debug(\"Segment sealing completed, retrying flush.\");\n+            }\n+        } else {\n+            // A background thread should be waking up to process things. Give it a moment.\n+            Exceptions.handleInterrupted(() -> Thread.sleep(100));", "originalCommit": "c30331d509fe593b7b349779b38000a0672a3bb4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk2MzM4MA==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459963380", "bodyText": "@shrids you mean no writes to \"any\" segment can happen while the sleep is executed? If so, this would be quite disruptive for write performance when scales are frequent. And the fact of making the sleep lower I don't know if is going to improve much the situation, right? Could the \"sleep\" be out of the synchronized block so writes to other segments can make progress?", "author": "RaulGracia", "createdAt": "2020-07-24T10:03:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg0NTg2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTk2Nzc5Nw==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r459967797", "bodyText": "Yes, if at time t0 the sleep is invoked then writes can happen only at timet0 + 100ms when the writeFlushLock is released. This is the case even if the sealed segment handling is completed at t0 + 1ms.", "author": "shrids", "createdAt": "2020-07-24T10:14:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTg0NTg2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "d4ba24fb1dddc6b5fc551d164c8994efc7e668b7", "chunk": "diff --git a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\nindex 188be9b77..4416eeb3a 100644\n--- a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n+++ b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n\n@@ -240,15 +261,14 @@ public class EventStreamWriterImpl<Type> implements EventStreamWriter<Type> {\n      */\n     @GuardedBy(\"writeFlushLock\")\n     private void tryWaitForSuccessors() {\n-        if (sealedSegmentQueue.isEmpty()) {\n-            synchronized (writeSealLock) {\n-                // Nothing needs to be done here.\n-                // When the lock is released the sealing should be complete.\n-                log.debug(\"Segment sealing completed, retrying flush.\");\n-            }\n-        } else {\n+        while (!sealedSegmentQueue.isEmpty()) {\n             // A background thread should be waking up to process things. Give it a moment.\n-            Exceptions.handleInterrupted(() -> Thread.sleep(100));\n+            Exceptions.handleInterrupted(() -> Thread.sleep(10));\n+        }\n+        synchronized (writeSealLock) {\n+            // Nothing needs to be done here.\n+            // When the lock is released the sealing should be complete.\n+            log.debug(\"Segment sealing completed, retrying flush.\");\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI3OTc2Mw==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r518279763", "bodyText": "A clarification question: what would we need to do to wait on the processing of the sealed segment rather than set a fixed amount of time to wait in each loop iteration?", "author": "fpj", "createdAt": "2020-11-05T18:42:44Z", "path": "client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java", "diffHunk": "@@ -224,12 +224,32 @@ public void flush() {\n                         // available writers.\n                         success = false;\n                         log.warn(\"Flush on segment {} failed due to {}, it will be retried.\", writer.getSegmentName(), e.getMessage());\n+                        tryWaitForSuccessors();\n                         break;\n                     }\n                 }\n             }\n         }\n     }\n+    \n+    /**\n+     * This is used by flush to optimistically wait for the `handleLogSealed` work to be completed\n+     * to prevent a busy loop while waiting for the segments to be updated following a sealed\n+     * segment. Please note there are no guarantees about when this method returns. It can be\n+     * thought of as a sleep.\n+     */\n+    @GuardedBy(\"writeFlushLock\")\n+    private void tryWaitForSuccessors() {\n+        while (!sealedSegmentQueue.isEmpty()) {\n+            // A background thread should be waking up to process things. Give it a moment.\n+            Exceptions.handleInterrupted(() -> Thread.sleep(10));", "originalCommit": "bf78317130d7689fa16b2c7a1a7b779e736e51f3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjQwNDY2Mw==", "url": "https://github.com/pravega/pravega/pull/4965#discussion_r576404663", "bodyText": "This loop is blocking on the sealedSegmentQueue becoming empty. Once the queue is empty and the writeSealLock is released we should return. However there is no built in way to block on a queue becoming empty. Hence it is polling. We could make a custom data structure to provide this capability if we want.", "author": "tkaitchuck", "createdAt": "2021-02-15T20:15:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxODI3OTc2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "d20d1f0c3048da3cace5cb2a0df7a66e1a11d121", "chunk": "diff --git a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\nindex 2213ee131..ff11a937d 100644\n--- a/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n+++ b/client/src/main/java/io/pravega/client/stream/impl/EventStreamWriterImpl.java\n\n@@ -244,6 +270,8 @@ public class EventStreamWriterImpl<Type> implements EventStreamWriter<Type> {\n             // A background thread should be waking up to process things. Give it a moment.\n             Exceptions.handleInterrupted(() -> Thread.sleep(10));\n         }\n+        //This lock is only acquired to block this thread if there is a seal going on already.\n+        //This code does not actually need the lock for anything.\n         synchronized (writeSealLock) {\n             // Nothing needs to be done here.\n             // When the lock is released the sealing should be complete.\n"}}, {"oid": "8c1111f22097649be59543ccd1ef9baef8b3112b", "url": "https://github.com/pravega/pravega/commit/8c1111f22097649be59543ccd1ef9baef8b3112b", "message": "Issue 5736: Ensure segment writers handles a race between SegmentIsSealed and reconnection to Segmentstore (#5735)\n\nFix the reconnection logic with a sealed segment on the Segment writer.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\n\r\nCo-authored-by: Tom Kaitchuck <tkaitchuck@users.noreply.github.com>", "committedDate": "2021-02-13T00:47:11Z", "type": "forcePushed"}, {"oid": "3795665fca0bf3ff5f5afa24a8af605c40440478", "url": "https://github.com/pravega/pravega/commit/3795665fca0bf3ff5f5afa24a8af605c40440478", "message": "Issue 4677: Offset/Version Table Entry Iteration (#4867)\n\n- Implement the iteration based APIs for position based TableSegment reads.\r\n- This adds a new iterator which starts at a given offset/position in a TableSegment, and deserializes these reads into TableEntries (as apposed to the TableBucket approach that currently exists).\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "cb4c5f7d2df1e9441e74a2f38c5908b68b6fcdc9", "url": "https://github.com/pravega/pravega/commit/cb4c5f7d2df1e9441e74a2f38c5908b68b6fcdc9", "message": "Issue 4915: Add timeout to add requests from Controller to Segment Store (#4916)\n\nAdds a timeout to requests being made to Segment Store using Segment Helper.\r\n\r\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "62e8f9ef476cb728e3fe4c3cca235ee77fab704c", "url": "https://github.com/pravega/pravega/commit/62e8f9ef476cb728e3fe4c3cca235ee77fab704c", "message": "Issue 4751: ListScopes, CheckStreamExists and CheckScopeExists (#4950)\n\nImplementation\r\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\r\n\r\nChange log description\r\nImplementation for listScopes, CheckScopeExists and CheckStreamExists\r\n\r\nPurpose of the change\r\nFixes #4751\r\n\r\nWhat the code does\r\nAdds grpc implementation for listScopes which is a paginated call.\r\nAlso provides implementation for CheckScopeExists and CheckStreamExists.\r\nThere is not implementation for Zookeeper based store for listScopes\r\n\r\nHow to verify it\r\nUnit test updated\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "291c3115451a16ef6737d95c9dc10f001e062e61", "url": "https://github.com/pravega/pravega/commit/291c3115451a16ef6737d95c9dc10f001e062e61", "message": "Prevent a busy loop while waiting for the segments to be updated\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "1ac1aeb55156679e3315ce9a84a78d35a6446353", "url": "https://github.com/pravega/pravega/commit/1ac1aeb55156679e3315ce9a84a78d35a6446353", "message": "Add log line\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "63275756eba0f5453685b1dac7fb92258ca82d45", "url": "https://github.com/pravega/pravega/commit/63275756eba0f5453685b1dac7fb92258ca82d45", "message": "Issue 4956: Fix bugs in list streams and list scope api when resources are filtered (#4957)\n\nImplementation\r\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\n\r\nChange log description\r\nIf resources are filtered due to authorization, keep calling list resource api on store until we have collected desired number of results to fill the page or entries are exhausted.\r\n\r\nPurpose of the change\r\nFixes #4956\r\n\r\nWhat the code does\r\nMake recursive call if the resources are filtered out due to authorization until we either collect \"limit\" number of records or exhaust all entries in the store.\r\nThis is performed for both streams and KVT.\r\nKVT already had the implementation but there were bugs in it which are also fixed here.\r\n\r\nAlso, segment store returns an empty continuation token if we request from the last element and there are no more elements to read. This is handled in PravegaTableStoreHelper to return the caller's token if response from segment store is empty.\r\n\r\nHow to verify it\r\nunit tests added\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "ed87c493bd7f4d5c538856fd3fe203e75ff5735c", "url": "https://github.com/pravega/pravega/commit/ed87c493bd7f4d5c538856fd3fe203e75ff5735c", "message": "Issue 4972: Set addLombokGeneratedAnnotation in lombok.config (#4971)\n\nAdds lombok.addLombokGeneratedAnnotation = true to lombok.config\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "ce1ddaf75a71b53cd6541f5e66ff3ee09052920f", "url": "https://github.com/pravega/pravega/commit/ce1ddaf75a71b53cd6541f5e66ff3ee09052920f", "message": "Issue #4924: Remove Netty from the client (#4873)\n\nRemoved Netty connections from the Client. Replaced with Tcp Sockets.\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>\r\nCo-authored-by: Ra\u00fal Gracia <raul.gracia@emc.com>\r\nCo-authored-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "81205892e38300dc1aee1a2c6aa423263e035997", "url": "https://github.com/pravega/pravega/commit/81205892e38300dc1aee1a2c6aa423263e035997", "message": "Issue 4985: Additional Logs for tracking controller periodic retention  (#4991)\n\n\r\n* Info level logs to indicate status of stream's periodic retention job\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "83fc8de664929f57baf6ce69633eaaf2778d9f5a", "url": "https://github.com/pravega/pravega/commit/83fc8de664929f57baf6ce69633eaaf2778d9f5a", "message": "Issue 4989: Add integration and system test for size based retention policy (#4990)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\n\r\nChange log description\r\nAdds system and integration tests for size based retention policy\r\n\r\nPurpose of the change\r\nFixes #4989\r\n\r\nWhat the code does\r\nMakes retention frequency part of ControllerServiceConfig instead of the static value in Config.java. This allows integration tests to set much smaller value than the default of 30 minutes.\r\n\r\nAdds new integration and system test which test size and time based retentions.\r\n\r\nHow to verify it\r\nAll tests should pass\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "a548ac31680ce4cce566abdc11d921583d992b9e", "url": "https://github.com/pravega/pravega/commit/a548ac31680ce4cce566abdc11d921583d992b9e", "message": "Issue 5005: Ensure ConnectionFailedException is thrown if the connection is closed. (#5006)\n\nEnsure ConnectionFailedException is thrown if the connection is already closed.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "bf8e5e8cab76f872696669a43f212882669c8483", "url": "https://github.com/pravega/pravega/commit/bf8e5e8cab76f872696669a43f212882669c8483", "message": "Issue 4676: Simplified Long Term Storage (LTS) - PDP-34 (#4969)\n\nSimplified Long Term Storage (LTS) - PDP 34.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\r\n\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "379e2c5c42234d1237bf2bfbda01ffd60d752083", "url": "https://github.com/pravega/pravega/commit/379e2c5c42234d1237bf2bfbda01ffd60d752083", "message": "Issue 5009: (SegmentStore) Fixed Segment Attribute Index Truncated Root Pointer #5018\n\nFixed a bug in SegmentAttributeBTreeIndex where it would attempt to initialize the BTreeIndex from a truncated offset.\r\n\r\nAdded logback-test.xml for Segment Store Integration tests. This helps debugging.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "2404a22ac989d5ba448dcf0463413919db7f3b39", "url": "https://github.com/pravega/pravega/commit/2404a22ac989d5ba448dcf0463413919db7f3b39", "message": "Issue 5008: Fix free TCP port generation logic (#5007)\n\nFix free TCP port generation logic\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "44df58765c603af0123152307b44ae20c8bb1730", "url": "https://github.com/pravega/pravega/commit/44df58765c603af0123152307b44ae20c8bb1730", "message": "Issue 4790: Pravega Standalone Enhancements (#5000)\n\nSeparates logging into two destinations to provide more visibility to essential information (stdout and now standalone.log).\r\nHighlights services details/config and increases visibility of start message.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "0d06f4ae8c0574a338bf8c0236faccada7e14fc0", "url": "https://github.com/pravega/pravega/commit/0d06f4ae8c0574a338bf8c0236faccada7e14fc0", "message": "Update the support section (#4780)\n\nChange the slack link under the support section to point at the sign-up page instead of the login page which has no information on how to join the slack.\r\n\r\nSigned-off-by: rofr <robert@devrex.se>\r\n\r\nCo-authored-by: Ra\u00fal Gracia <raul.gracia@emc.com>\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f9d3a9dc928d56bf7b0cd978fd7e4004f11a76d0", "url": "https://github.com/pravega/pravega/commit/f9d3a9dc928d56bf7b0cd978fd7e4004f11a76d0", "message": "Issue-4937: Update ZooKeeper and BookKeeper pre-requisites in the documentation (#4959)\n\nThis updates the documentation to include the proper versions and references as detailed in #4937\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\r\n\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "0722929135cd367fd07c1ecfee9b2704b51d0974", "url": "https://github.com/pravega/pravega/commit/0722929135cd367fd07c1ecfee9b2704b51d0974", "message": "Issue 5013: upgrade grpc-netty to 1.31.0 (#5016)\n\nUpgrading the Netty version used by gRPC in Client-Controller communications.\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "823501a50767e6c9c9206b91914f22e50d1b80a5", "url": "https://github.com/pravega/pravega/commit/823501a50767e6c9c9206b91914f22e50d1b80a5", "message": "Issue 5026: (SLTS) Fix Java 11 build break. (#5027)\n\nFix Java 11 build break.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "65a3a52d6ae25972dbca1d33bab5f73f9ca4818b", "url": "https://github.com/pravega/pravega/commit/65a3a52d6ae25972dbca1d33bab5f73f9ca4818b", "message": "Issue 4982: Fix batch calculation in client (#4983)\n\n* Reverts calculation of appendsInBatch as it was\r\n  before to fix the latency problem with multiple\r\n  segments and low throughput rates.\r\n\r\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "e54b1cd2b290e0d69d9d1ee44369c7931ac8c6fd", "url": "https://github.com/pravega/pravega/commit/e54b1cd2b290e0d69d9d1ee44369c7931ac8c6fd", "message": "Issue 4975: Replace Loading Cache with Regular Cache (#4992)\n\nSigned-off-by: Shivesh Ranjan shivesh.ranjan@gmail.com\r\n\r\nChange log description\r\nReplace the cache implementation to not load the completablefuture into the cache as that can cause consistency issues.\r\n\r\nPurpose of the change\r\nFixes #4975\r\n\r\nWhat the code does\r\nChanges the cache to load the value. The store first retrieves the value for mutable records from the cache. and if not found, it calls the store and loads the value from the future.\r\nWe dont try to optimize on multiple concurrent invocations to the loading function because that will result in the original problem of consistency check failure.\r\n\r\nHow to verify it\r\nAll existing tests should continue to pass.\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "699bb6cf853d3c57f61236cc5d5fbf6b496c6c26", "url": "https://github.com/pravega/pravega/commit/699bb6cf853d3c57f61236cc5d5fbf6b496c6c26", "message": "Issue 4927 deleteKeyValueTableTest fails for InMemoryKVTableStore when using KVTOperationContext (#4958)\n\n* Fixes issues in InMemoryKVTMetadataStore implementation.\r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "8b9f9884e15d59ad9ac6ded0a3109f3bbb98496f", "url": "https://github.com/pravega/pravega/commit/8b9f9884e15d59ad9ac6ded0a3109f3bbb98496f", "message": "Issue 4186: CacheManager Metric. (#5004)\n\nAdds a new metric (Timer) that tracks the time taken complete one CacheManager iteration.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "60073af556d16c5c15c8226951da0b08eb755068", "url": "https://github.com/pravega/pravega/commit/60073af556d16c5c15c8226951da0b08eb755068", "message": "Issue 5038: (SegmentStore) Fixing a race condition in SegmentKeyCache. #5040\n\nHandling a situation where a Cache Eviction evicts a Cache Entry that was going to be a target of a Tail Index Migration.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "7553d94e402b55a484abdd0109eec321bec66666", "url": "https://github.com/pravega/pravega/commit/7553d94e402b55a484abdd0109eec321bec66666", "message": "Issues 3373, 4003, 2985: Remove javadoc and compile warnings (#5032)\n\nFixes several compile and javadoc related warnings throughout the project.\r\n\r\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "4762e4c16ed805a20ff422f75c4664acd605432b", "url": "https://github.com/pravega/pravega/commit/4762e4c16ed805a20ff422f75c4664acd605432b", "message": "Issue 5033: Read ChunkedSegmentStorageConfig from properties. (#5034)\n\nAbility to initialize ChunkedSegmentStorageConfig values from config file or properties.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "bc1d1410851126fe1003885e1f4a938d79d4ef92", "url": "https://github.com/pravega/pravega/commit/bc1d1410851126fe1003885e1f4a938d79d4ef92", "message": "Issue 5063: Modify Pravega Website URL references to point to `https` scheme (#5064)\n\nUpdate Website URL references to https://pravega.io (from http to https).\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "82c7ea7997d9bd5cacdbc861e88f2ebdb1f5f66b", "url": "https://github.com/pravega/pravega/commit/82c7ea7997d9bd5cacdbc861e88f2ebdb1f5f66b", "message": "Issue 4476: Truncate internal streams to reclaim storage space (#5044)\n\nTruncate internal streams used by controller periodically using the event position from the event that has been successfully processed.\r\n\r\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "9d72e89e005ad7de582a87f9d8af0904db3d0794", "url": "https://github.com/pravega/pravega/commit/9d72e89e005ad7de582a87f9d8af0904db3d0794", "message": "Issue 5060: Downgrade to gRPC 1.24.2 (#5066)\n\nUpgrading gRPC to the latest release was breaking something with the K8sClient in the system tests. This lowers gRPC version to 1.24.2, which is the latest release that allows K8sClient to function properly.\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f1530f8ab7217f05c1f99f02d9cc85bd449ea892", "url": "https://github.com/pravega/pravega/commit/f1530f8ab7217f05c1f99f02d9cc85bd449ea892", "message": "Issues 4973, 4997: Make .codecov.yml valid, set 80% patch target (#4974)\n\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "61e6824174589a93c0959104d98adee8d3690dc0", "url": "https://github.com/pravega/pravega/commit/61e6824174589a93c0959104d98adee8d3690dc0", "message": "Issue 5068: Sanitize gRPC call metadata before logging (#5069)\n\n* Santize gRPC call Metadata before logging\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "824864a9bb60b417c8c2edadb1a6c72467796b00", "url": "https://github.com/pravega/pravega/commit/824864a9bb60b417c8c2edadb1a6c72467796b00", "message": "Issue 5039: (SegmentStore) RollingStorage can trim Header Chunk on FileSystemStorage (#5053)\n\n*  Added generic API to \"atomically replace\" a Storage segment contents with provided data.\r\n*  Making use of this API in RollingStorage to trim Header Chunk after a Segment Truncation that removes one or more chunks.\r\n*  This has only been implemented for FileSystemStorage and only if filesystem.replace.enable is set to true.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\n\r\nCo-authored-by: Flavio Junqueira <fpj@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "16824450e344c7b0bfd2733f609910220cf48e4f", "url": "https://github.com/pravega/pravega/commit/16824450e344c7b0bfd2733f609910220cf48e4f", "message": "Issue 5062: Handle SegmentSealedException during Append Setup (#5061)\n\nHandling AppendSetup on Sealed Segment.\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "419fd8d280076fff8099db8b5c81e3120abdacab", "url": "https://github.com/pravega/pravega/commit/419fd8d280076fff8099db8b5c81e3120abdacab", "message": "Issue 5080: Adding character length checks for scope and stream name. (#5079)\n\nCharacter length limit check is added for scope and stream name.\r\n\r\nSigned-off-by: Atharva Joshi <Atharva.Joshi@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "01d5cf9dbadaf85401a7971b3cd670717f119c76", "url": "https://github.com/pravega/pravega/commit/01d5cf9dbadaf85401a7971b3cd670717f119c76", "message": "Issue 5087: Modify version to 0.9.x (#5088)\n\nModify version to 0.9.x.\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "46facb945bc34ee16bef67628342fb7780b8873f", "url": "https://github.com/pravega/pravega/commit/46facb945bc34ee16bef67628342fb7780b8873f", "message": "Issue 5093: Validate internal and external stream names (#5094)\n\nSeparating the length restrictions for internal and external names.\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "0794588bd72c2134b4b2734c33fb99bdd460cf12", "url": "https://github.com/pravega/pravega/commit/0794588bd72c2134b4b2734c33fb99bdd460cf12", "message": "Issue 5096: Do not enable StatsD reporter by default (#5097)\n\nSet the default value of StatsD reporter to false to prevent accidental switching on.\r\n\r\nSigned-off-by: Kevin Han <kevinhan88@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "9755df46cc2e3500ab3a4944be684465eab0d5b4", "url": "https://github.com/pravega/pravega/commit/9755df46cc2e3500ab3a4944be684465eab0d5b4", "message": "Issue 5102: (SegmentStore) TableSegment Rollover Size not properly set. (#5103)\n\nFixed a bug where the Attributes.ROLLOVER_SIZE is not properly set for Table Segments.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "89bbea8f4d14ecac324b5b9bd39965114927786a", "url": "https://github.com/pravega/pravega/commit/89bbea8f4d14ecac324b5b9bd39965114927786a", "message": "Issue 4775: Add snapshot stage for all release branches (#4776)\n\n Add snapshot stage for all release branches.\r\n\r\nSigned-off-by: Brian Zhou <brian.zhou@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "526b729ed36b202bc21884114390868f7d0b1413", "url": "https://github.com/pravega/pravega/commit/526b729ed36b202bc21884114390868f7d0b1413", "message": "Issue 5058: Cache Manager Metrics Fix (#5092)\n\nMake the metric an instance field instead of a static field.\r\nClean up meters alongside registries during startWithoutExporting\r\n\r\nSigned-off-by: Colin Hryniowski <co-jo@users.noreply.github.com>\r\n\r\nCo-authored-by: Andrei Paduroiu <andreipaduroiu@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "0f1d743b0ef341335077e90c2d3f01937d871dbd", "url": "https://github.com/pravega/pravega/commit/0f1d743b0ef341335077e90c2d3f01937d871dbd", "message": "Issue 5100: In Integration Tests, KVTable Creation should fail when partition count is 0 (#5101)\n\n* Adds a precondition check to ControllerService to check for partitionCount > 0.\r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "09d4645e7165731b64eab260ed3e12ace7f8ac82", "url": "https://github.com/pravega/pravega/commit/09d4645e7165731b64eab260ed3e12ace7f8ac82", "message": "Issue 5126: disabled metrics by default to prevent misconfigs (#5127)\n\nThis change is to disable metrics by default inside source code MetricsConfig.java instead of config file. This resolves issue where disabling metrics inside config.properties works only for Segmentstore but not for controller, due to a bug in Controller's config propagation mechanism.\r\n\r\nLong term solution is to be addressed separately.\r\n\r\nSigned-off-by: Kevin Han <kevinhan88@gmail.com>\r\n\r\nCo-authored-by: Sachin Jayant Joshi <44757683+sachin-j-joshi@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "2e3e99664c0fcd876301ae1f9c56ef3f8ddcb5de", "url": "https://github.com/pravega/pravega/commit/2e3e99664c0fcd876301ae1f9c56ef3f8ddcb5de", "message": "Issue 5119: (SegmentStore) Copy-on-Read for Table Segment Compaction (#5120)\n\nUpdated the ReadResult interface with the ability to specify \"copy-on-read\" behavior for any data that is returned from the cache. If set, any data that is returned from the cache is copied into a heap buffer and served from there. Default is not set.\r\n\r\nUpdated TableCompactor to make use of this functionality.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\n\r\nCo-authored-by: Sachin Jayant Joshi <44757683+sachin-j-joshi@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f2a0af6d6a0bb8b16dbce9d81a911fe5f51c6861", "url": "https://github.com/pravega/pravega/commit/f2a0af6d6a0bb8b16dbce9d81a911fe5f51c6861", "message": "Issue 5128: refactor a test source so that the bindings can be tested uniformly (#5129)\n\nMove the IdempotentStorageTestBase from bindings project to segmentstore:storage project.\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "07927f1688a1c06e49f031d574597c96c9eacbdf", "url": "https://github.com/pravega/pravega/commit/07927f1688a1c06e49f031d574597c96c9eacbdf", "message": "Issue 5137:  Remove dependency on netty-transport-native-epoll (#5138)\n\nRemove dependency on netty-transport-native-epoll.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "525fba8a55ee5f5ef0f613a9e561cb7b89e28184", "url": "https://github.com/pravega/pravega/commit/525fba8a55ee5f5ef0f613a9e561cb7b89e28184", "message": "Issue 5147: Added check for service in init_kubernetes.sh script (#5148)\n\nSigned-off-by: prabhaker24 <prabhaker.saxena@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "055befe2b4ab75eb7665185dadb7f14e1c8aa859", "url": "https://github.com/pravega/pravega/commit/055befe2b4ab75eb7665185dadb7f14e1c8aa859", "message": "Issue 5002: Delete scope api with delete streams flag  (#5149)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\n\r\nCo-authored-by: Sandeep <sandeep.shridhar@emc.com>\r\nCo-authored-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "95766af75e2ecda4fb48d0307648c20a4ee7dee1", "url": "https://github.com/pravega/pravega/commit/95766af75e2ecda4fb48d0307648c20a4ee7dee1", "message": "Issue 5144: Force token refresh when segment store indicates token expiry (#5145)\n\n*  Force token refresh when the Segment Store indicates token expiry.\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "bcea558298b55826116e1567bc5b17056bf30b20", "url": "https://github.com/pravega/pravega/commit/bcea558298b55826116e1567bc5b17056bf30b20", "message": "Issue 4162: Add the ability to run system tests with TLS (and auth) enabled (#5059)\n\nAdd the ability to run system tests with TLS (and auth) enabled.\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "aabe9858347ec386a156d6eb2943e15b41fd1fac", "url": "https://github.com/pravega/pravega/commit/aabe9858347ec386a156d6eb2943e15b41fd1fac", "message": "Issue 5155: (SegmentStore) Enabling copy-on-read for all Segment Reads. (#5156)\n\nEnabling copy-on-read for all Segment Reads from the client and for all Segment Reads as a result of Table Segment Entry reads (TableBucketReader calls).\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "7c290818bd1dac7d48788d0c70403ee49f3a72d2", "url": "https://github.com/pravega/pravega/commit/7c290818bd1dac7d48788d0c70403ee49f3a72d2", "message": "Issue 5124: publish :segmentstore:storage:testJar artifact (#5125)\n\nPublish :segmentstore:storage:testJar artifact\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "c5ad70a903d5b2c0499fb5aacc16f84116624ac0", "url": "https://github.com/pravega/pravega/commit/c5ad70a903d5b2c0499fb5aacc16f84116624ac0", "message": "Issue 5128: Make Segment Store Integration Tests publicly visible (#5160)\n\nMake Segment Store Integration Tests publicly visible\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f9819de9217fad954622e2162de26ced0202bbe9", "url": "https://github.com/pravega/pravega/commit/f9819de9217fad954622e2162de26ced0202bbe9", "message": "Issue 5140: Ensure ControllerResolverFactory ensure the scheduled task is interrupted during shutdown. (#5146)\n\n* Ensure ControllerNameResolver#shutdown cancels the future the scheduled future with mayInterruptIfRunning flag as true.\r\n* Wait for upto 20 seconds for channel termination to complete.\r\n* Ensure watermarking thread pool is shutdown with clientFactory.close().\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "123c54de883c7273351ff4de263147c0a6152a74", "url": "https://github.com/pravega/pravega/commit/123c54de883c7273351ff4de263147c0a6152a74", "message": "Issue 5172: Revert release branch snapshot stage fix\n\nRevert PR #4776.\r\n\r\nSigned-off-by: Brian Zhou <b.zhou@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "230a2fb0dccae8abfa70667bb23eb21ee7ddbc0e", "url": "https://github.com/pravega/pravega/commit/230a2fb0dccae8abfa70667bb23eb21ee7ddbc0e", "message": "Issue 5166: In deleteScope(deleteStreams) method, handle seal stream failures (#5175)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f488e672a1ca8db5e644ae99e18e0e6055c4a579", "url": "https://github.com/pravega/pravega/commit/f488e672a1ca8db5e644ae99e18e0e6055c4a579", "message": "Issue 5154: (SegmentStore) Fixed a stats concurrency bug in the Read Index (#5170)\n\nFixed a concurrency bug in StreamSegmentReadIndex which could allow index summaries to get out of sync, thus causing the Cache Manager to evict more than needed.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\n\r\nCo-authored-by: Tom Kaitchuck <tkaitchuck@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "6989db8e7fc9d2658c45b7f71330f0835dfccb46", "url": "https://github.com/pravega/pravega/commit/6989db8e7fc9d2658c45b7f71330f0835dfccb46", "message": "Issue 4162: Add missing TLS System Property parameter in build script (#5167)\n\nAdd missing TLS System Property parameter in build script\r\n\r\nSigned-off-by: Ravi Rajamani <ravi.rajamani@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "1c9372135ddef94de53e99be982793f5ff891e28", "url": "https://github.com/pravega/pravega/commit/1c9372135ddef94de53e99be982793f5ff891e28", "message": "Issue 5181: Fix Null Pointer Exception in the log message (#5182)\n\nSigned-off-by: Shivesh Ranjan shivesh.ranjan@gmail.com\r\n\r\nChange log description\r\nFixes NPE in StreamMetadataTasks.retention method where we may truncate at an older streamcut despite not producing a \"new stream cut\".\r\n\r\nPurpose of the change\r\nFixes #5181\r\n\r\nWhat the code does\r\nNPE is caused by a new log message that was introduced recently which logs newRecord instead of truncationRecord. The new record represents the new streamcut which is generated periodically. It is possible that we do not generate a new streamcut in each cycle if the previous cycle was cut short for some reason and a streamcut was generated. The truncation record represents an older streamcut at which we want to truncate.\r\nThe intent of the log message is to log the identified truncation streamcut. Instead it ends up logging new streamcut which can be null in some cases.\r\n\r\nHow to verify it\r\nAll tests should pass and there should be no NPE.\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "0c148434719d58989470b004856c3d6972beae95", "url": "https://github.com/pravega/pravega/commit/0c148434719d58989470b004856c3d6972beae95", "message": "Issue 5188: Improve RawClient exception handling. (#5185)\n\nImprove exception handling on the RawClient to handle scenarios where a connection drop can happen just before a new Flow is created as part of the obtaining/creating a new connection.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "ac510117938f617c07b4e5ed4c0e9888e5314555", "url": "https://github.com/pravega/pravega/commit/ac510117938f617c07b4e5ed4c0e9888e5314555", "message": "Issue 5035: New Resource String Format for Authorization (#5051)\n\n* Replaces the old resource string format with the new resource string format defined by PDP-42.\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "3b8d5affffcd42934f41d059b4cb6b2302d5e967", "url": "https://github.com/pravega/pravega/commit/3b8d5affffcd42934f41d059b4cb6b2302d5e967", "message": "Attempt to be more aggressive about wake up.\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "96a311fcabf14610c5ca2a1a80f8f39104974521", "url": "https://github.com/pravega/pravega/commit/96a311fcabf14610c5ca2a1a80f8f39104974521", "message": "Issue 5171: (Bugfix) Ensure ByteStreamReader can read from deleted and recreated streams (#5176)\n\nEnsure ByteStreamReader can read from deleted and recreated streams\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "44c49b60590c74c760973b835f980ec6c54c7a9f", "url": "https://github.com/pravega/pravega/commit/44c49b60590c74c760973b835f980ec6c54c7a9f", "message": "Issue 5197: Limit number of transactions in a commit batch (#5198)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "1e28b1cdd0315d12abb66710356a24dc6fc77874", "url": "https://github.com/pravega/pravega/commit/1e28b1cdd0315d12abb66710356a24dc6fc77874", "message": "Issue 5122: Improving Windows Compatibility (#5179)\n\nAdded some documentation recognizing potentially slow unit tests (those involved in touching a large amount of files) and a possible fix.\r\n\r\nTarget the proper platform specific temp directory within S3ProxyImpl.\r\n\r\nSurround a file clean procedure with a try/catch block to absorb the exception.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "311bd30501836bb89a7def0a65eca607deb0933f", "url": "https://github.com/pravega/pravega/commit/311bd30501836bb89a7def0a65eca607deb0933f", "message": "Issue 5207: (SegmentStore) Read Index Bug Fixes (#5208)\n\nSetting ReadResult.isCopyOnRead to true by default. This will cause any upstream code reading from the cache to get a a copy of that data instead of a view.\r\n\r\nFixed a bug in StreamSegmentReadIndex.insertEntriesToCacheAndIndex where it would incorrectly insert an entry if an existing entry that is a subset of the new one already exists.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "9854c40cba0a49e9b95d79de97cbacbc83f84f8a", "url": "https://github.com/pravega/pravega/commit/9854c40cba0a49e9b95d79de97cbacbc83f84f8a", "message": "Issue 5025: Modifying System Test Framework to implement deployment based on 0.5.x pravega operator (#5050)\n\nModified existing System Test Framework to deploy Pravega with 0.5.x Pravega operator\r\n\r\nSigned-off-by: root <richa.srivastava@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "352ddcf00b605494adfb2c930d95e2924d9cf667", "url": "https://github.com/pravega/pravega/commit/352ddcf00b605494adfb2c930d95e2924d9cf667", "message": "Issue 5082: Initial Java 11 Migration (#5121)\n\nMakes the following minimal set of changes to accomplish a passing compilation phase and unit testing phase. It keeps the client and all its dependencies building JDK8 jars.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "d941d04b4413ae7e321841044fbb69f3c0925378", "url": "https://github.com/pravega/pravega/commit/d941d04b4413ae7e321841044fbb69f3c0925378", "message": "Issue 5219: Reducing build log output (#5220)\n\nReducing the amount of output during each build.\r\nController: not outputting GC details.\r\nStandalone: not outputting the entire log.\r\nFixed a bug in SelfTester that prevented it from working properly with tail reads.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "fdd0aab23dae166bb9dd01bd7f648759cf80eab5", "url": "https://github.com/pravega/pravega/commit/fdd0aab23dae166bb9dd01bd7f648759cf80eab5", "message": "Issue 5229: Ensure references to SegmentTransaction are cleared post a transaction commit/abort. (#5230)\n\nClear SegmentTransaction references from TransactionImpl\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "1fc01d31fcdbb095e6c931c2db37f5a13f5df1b4", "url": "https://github.com/pravega/pravega/commit/1fc01d31fcdbb095e6c931c2db37f5a13f5df1b4", "message": "Issue 5218: Ensure client closes a connection in case of a read timeout. (#5209)\n\nEnsure the client terminates a connection in the case of a socket read timeout.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "5f160cbf4bee9b17547222295b49ffe8ea927082", "url": "https://github.com/pravega/pravega/commit/5f160cbf4bee9b17547222295b49ffe8ea927082", "message": "Issue 3426: Bump protobuf version to 3.13.0. (#5228)\n\nBump protobuf version to 3.13.0.\r\nFixes illegal reflective warnings as a result of the upgrade to Java 11.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "5447ad8a1b41aede10b0055ff6ed56698e01d031", "url": "https://github.com/pravega/pravega/commit/5447ad8a1b41aede10b0055ff6ed56698e01d031", "message": "Issue 4803: Move Pravega CLI back into Pravega Core repository (#5065)\n\nBring back Pravega CLI tools into the core repository. Separate user (based on former Interactive Demo Tool) and admin CLI (based on Pravega Tools repo) functionality into different tools.\r\n\r\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "9ac255b6c9aa97b4ebabe715d1d132a1e040386c", "url": "https://github.com/pravega/pravega/commit/9ac255b6c9aa97b4ebabe715d1d132a1e040386c", "message": "Issue 4978: DeltaIterator NullPointerException. (#4979)\n\nAdded logic to prevent a NullPointerException when a TableSegment has no entries to iterate over (relative to the provided fromPosition). \r\n\r\nAdded the ability to reply with an exception (error code) over the Wire Protocol, which will cause the same exception to be thrown on the client (as opposed from just closing the connection without telling the client why).\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f661e9c6c7c376f159b291938119e1379e73ecf7", "url": "https://github.com/pravega/pravega/commit/f661e9c6c7c376f159b291938119e1379e73ecf7", "message": "Issue 5072: Single routing key batch writes (#5084)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "bf4d99dcb20b8f9303363f6acf5752f4ae167422", "url": "https://github.com/pravega/pravega/commit/bf4d99dcb20b8f9303363f6acf5752f4ae167422", "message": "Issue 5240: (SegmentStore) Fixed a possible infinite loop in SegmentAggregator (#5241)\n\nFixed a bug in SegmentAggregator.deleteUnmergedSourceSegments where it may enter an infinite loop if the outstanding operation list contains at least one non-MergeSegmentOperation in it.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "a6e4c719bc74a077c8b4b1ab035e54cbe6158c7c", "url": "https://github.com/pravega/pravega/commit/a6e4c719bc74a077c8b4b1ab035e54cbe6158c7c", "message": "Issue 5233: (SegmentStore) Flush-to-Storage API (#5239)\n\nAdded an API on the SegmentContainer to fully flush all Tier 1 and in-memory data to LTS/Storage.\r\nThis API is experimental and should only be used to aid testing. It is not yet supported for production use.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "89ec6739d66e2d7311d4bcf2f48bc43a7c895a64", "url": "https://github.com/pravega/pravega/commit/89ec6739d66e2d7311d4bcf2f48bc43a7c895a64", "message": "Issue 5258: Spotbugs HTML Reports. (#5259)\n\nEnable HTML report generation and disable XML report generation.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "1bfa92c9212c57a20ee1147d19c7db3e5fee13ef", "url": "https://github.com/pravega/pravega/commit/1bfa92c9212c57a20ee1147d19c7db3e5fee13ef", "message": "Issue 5203: Stream-Cuts get saved as \"Checkpoints\" in Reader Group State (#5244)\n\nStream-cuts/silent checkpoints are handled differently after all the readers have persisted their positions.\r\n\r\nSigned-off-by: anirudhkovuru <anirudhkovuru@gmail.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "715935553ed973106ba6844cc17392b1ea46cbb4", "url": "https://github.com/pravega/pravega/commit/715935553ed973106ba6844cc17392b1ea46cbb4", "message": "Issue 5254: Update credentials and ACL handling tools to work with the new resource format (#5255)\n\nModifies the credentials and ACL handling code to look for only three splits based on character \":\".\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "80ace9f35d97f3b5a0993deb8d0ee16aa27f36b9", "url": "https://github.com/pravega/pravega/commit/80ace9f35d97f3b5a0993deb8d0ee16aa27f36b9", "message": "Issue 5271: Fix credentials and ACL parsing in Pravega CLI (#5274)\n\nModify Credentials and ACL handling code in CLI to parse ACLs in new format.\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "c099d18d1c720056f5de97ac9ecd13b0e99563e8", "url": "https://github.com/pravega/pravega/commit/c099d18d1c720056f5de97ac9ecd13b0e99563e8", "message": "Issue 5269: (SegmentStore) Fixed a deadlock in StreamSegmentReadIndex (#5270)\n\nFixed a deadlock situation in StreamSegmentReadIndex that can affect a recently merged Segment (into a parent one).\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "b4c34b6fd23f8c3a1686d710149a40472f5926ee", "url": "https://github.com/pravega/pravega/commit/b4c34b6fd23f8c3a1686d710149a40472f5926ee", "message": "Issue 5234: Java 11 Migration Fixes (#5235)\n\nDocument clientJavaVersion flag.\r\nFixed docker image tag.\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f53b9bb7bdd067bd9b16588ed71ef873eb7baa54", "url": "https://github.com/pravega/pravega/commit/f53b9bb7bdd067bd9b16588ed71ef873eb7baa54", "message": "Issue 5281: Bookkeeper CLI tests failing to start up in some environments (#5282)\n\nBookkeeperCommandsTest class now iterates over the available network interfaces to start the Bookkeeper test process if the default start up method fails.\r\n\r\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "34af588b3331ddd2affb3af182b80b45b62d9af7", "url": "https://github.com/pravega/pravega/commit/34af588b3331ddd2affb3af182b80b45b62d9af7", "message": "Issue 5168: Remove Controller Dependencies (#5224)\n\nRemoving all references of the controller project from the test:system project.\r\nThis should enable us to properly deploy the system tests using JDK 8, instead of JDK 11 (as this is the JDK version the Controller uses).\r\n\r\nSigned-off-by: co-jo <colin.hryniowski@dell.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "f0108a7952425e01abfc37b8da47ec22e86f9bd1", "url": "https://github.com/pravega/pravega/commit/f0108a7952425e01abfc37b8da47ec22e86f9bd1", "message": "[issue-4775] Add snapshot stage for all release branches (#5273)\n\nInclude release branches into the Travis snapshot stage.\r\n\r\nSigned-off-by: Brian Zhou <b.zhou@dell.com>\r\n\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "8dabdbe0e89029e77b2c9d96676bfe3fa655c205", "url": "https://github.com/pravega/pravega/commit/8dabdbe0e89029e77b2c9d96676bfe3fa655c205", "message": "Issue 4884: BufferView equals() and compare() optimizations for JDK11 (#5283)\n\n- Created project common_server - everything that is common but needs to be compiled with JDK11.\r\n- Moved io.pravega.common.util.btree from common to common_server. Package name stays the same.\r\n- Deleted ByteArrayComparator.java. Replaced with BufferViewComparator.java, which now sits in common_server.\r\n- Updated all callsites to use new classes.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:24Z", "type": "commit"}, {"oid": "399ccff5fcb04cbee834a11bb3d59ebb9bc50b9e", "url": "https://github.com/pravega/pravega/commit/399ccff5fcb04cbee834a11bb3d59ebb9bc50b9e", "message": "Issue:5109 Add and Remove Subscriber API on Controller (#5204)\n\n* Add/Remove/Update a subscriber to a Stream\r\n\r\nSigned-off-by: pbelgundi <prajakta.belgundi@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "d4ba24fb1dddc6b5fc551d164c8994efc7e668b7", "url": "https://github.com/pravega/pravega/commit/d4ba24fb1dddc6b5fc551d164c8994efc7e668b7", "message": "Issue 5260: (SegmentStore) Adjustable Operation Priority Levels (#5268)\n\nAdded the ability to differentiate between segments based on their Segment Type.\r\nAdded the ability to prioritize Operations based on the owning Segment Segment Type and Operation Type\r\nIdentifying all Table Segments (Sorted and not sorted) as their own Segment Type.\r\nDesignating Segment Container Metadata Segments as \"System Segment\".\r\nDesignating Storage Metadata Segments as \"System Critical\" segments.\r\n\r\nSigned-off-by: Andrei Paduroiu <andrei.paduroiu@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "74b7dd23c92ede7b9233ea5b7d20fcdbb3b75f11", "url": "https://github.com/pravega/pravega/commit/74b7dd23c92ede7b9233ea5b7d20fcdbb3b75f11", "message": "Issue 4858: Update roadmap.md (#5291)\n\n* Update roadmap.md\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\n* add release plan from internal roadmap\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\n* fix nested bullets in \"Future Items\" section\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\n* add Consumption-based\u00a0retention Issues & PDP\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\n* add PDP links & Idempotent writer Issue\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\r\n\r\n* add Rust Client to Python bindings as Native client phase 1\r\n\r\nSigned-off-by: Derek Moore <derek.moore@dell.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "fd693ea81acb04c547569a35a14d43d84cb495a8", "url": "https://github.com/pravega/pravega/commit/fd693ea81acb04c547569a35a14d43d84cb495a8", "message": "Issue 5067: (SLTS) - Convert synchronous ChunkStorage and ChunkMetadataStore API into async (#5200)\n\nConvert synchronous ChunkStorage and ChunkMetadataStore API into async. There are also improvements in how transactions are serialized allowing for greater parallelism.\r\n\r\nSigned-off-by: Sachin Joshi <sachin.joshi@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "2c0fc63f6455bbd6a4f302d635a9f292313c05ef", "url": "https://github.com/pravega/pravega/commit/2c0fc63f6455bbd6a4f302d635a9f292313c05ef", "message": "Improve logging. (#5302)\n\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\r\n\r\nCo-authored-by: Tom Kaitchuck <tkaitchuck@users.noreply.github.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "768118ddfbe865d1156c656d7865790109497a5a", "url": "https://github.com/pravega/pravega/commit/768118ddfbe865d1156c656d7865790109497a5a", "message": "Issue 5328: Fix flaky ControllerEventProcessorsTest.testTruncate and testParallelSegmentOffsetTruncation  junits (#5322)\n\nFix flaky JUnit tests ControllerEventProcessorsTest.testTruncate and testParallelSegmentOffsetTruncation.\r\n\r\nSigned-off-by: Sandeep <sandeep.shridhar@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "367fa39805b1aebab4e116bb44343ee6558913f3", "url": "https://github.com/pravega/pravega/commit/367fa39805b1aebab4e116bb44343ee6558913f3", "message": "Issue 5294: Bookkeeper Client may cache old DNS entries for too long (#5317)\n\nAdded a defensive mechanism in which the Segment Store can re-create the Bookkeeper client to force the resolution of Bookie IPs in the case of persistent container recoveries.\r\n\r\nSigned-off-by: Ra\u00fal Gracia <raul.gracia@emc.com>\r\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "9dea67b126e67615c17f3a9e1e740ed4decde269", "url": "https://github.com/pravega/pravega/commit/9dea67b126e67615c17f3a9e1e740ed4decde269", "message": "Issue 5115: Allow reads using read-only permissions (#5231)\n\n* Distinguishes between required and target permissions\r\n  when generating delegation tokens in the Controller.\r\n* Requires\u00a0read  permissions by default for internal/state\r\n   synchronizer streams.\r\n* Adds a new configuration:\r\n\r\n  \u00a0controller.security.auth.internalStreams.writesWithReadPermissions.enable\r\n\u00a0\r\n that determines whether read/write permissions are\r\n required for internal streams (default is\u00a0true).\r\n* Uses the new resource format specified developed in\r\n PR\u00a0#5051\u00a0to authorize writes to reader groups and\r\n watermark streams.\r\n* Creates a new shared class to represent access\r\n operations.\r\n* Modifies the DelegationTokenProvider and its main\r\n implementation\u00a0JwtTokenProviderImpl\u00a0to take in Access\r\n operation as well, and pass it on during calls to obtain\r\n delegation token.\r\n\r\nSigned-off-by: Ravi Sharda <ravi.sharda@emc.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "2d002980d52445be69022a6dad139a1c2bd20bde", "url": "https://github.com/pravega/pravega/commit/2d002980d52445be69022a6dad139a1c2bd20bde", "message": "Issue 5132: segmentstore should use host name when TLS is enabled in standalone (#5133)\n\nSupport TLS hostname verification for client-to-segment-store communication.\r\n\r\nWhen TLS is enabled in standalone, endpoints fetched from client controller API should be in hostname:port form.\r\n\r\nSigned-off-by: Wenqi M <452787782@qq.com>\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}, {"oid": "950c26458c7384007dfbedb91a93e935ed8a90de", "url": "https://github.com/pravega/pravega/commit/950c26458c7384007dfbedb91a93e935ed8a90de", "message": "Issue 5111: Consumption based retention policy implementation (#5289)\n\nSigned-off-by: Shivesh Ranjan <shivesh.ranjan@gmail.com>\r\n\r\n## Change log description\r\nImplements consumption based retention policy.\r\n\r\nThis does two things primarily -\r\nIn Stream Metadata Tasks it consolidates and computes lower bound on subscriber streamcuts and truncates at the said stream cut. This also applies time/size bounds\r\nIn stream cut validation in stream metadata store, we assumed stream cuts to be made of non overlapping segments, but a stream cut could have future segments which may not have been read from. These are represented using \"-1\" as the offset. So we update the logic in stream metadata store for validation as well as size computations for streamcuts.\n\nSigned-off-by: Tom Kaitchuck <tom.kaitchuck@emc.com>", "committedDate": "2021-02-15T20:17:25Z", "type": "commit"}]}