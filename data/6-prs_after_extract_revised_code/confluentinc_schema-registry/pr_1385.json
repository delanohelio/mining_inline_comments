{"pr_number": 1385, "pr_title": "DG-295 Fix trailing zeroes being stripped", "pr_createdAt": "2020-03-12T00:54:54Z", "pr_url": "https://github.com/confluentinc/schema-registry/pull/1385", "timeline": [{"oid": "f118ea07e341d531050df35cac69177514de9514", "url": "https://github.com/confluentinc/schema-registry/commit/f118ea07e341d531050df35cac69177514de9514", "message": "DG-295 Fix trailing zeroes being stripped\n\nThis is the same fix as KAFKA-9667.\nSee https://github.com/apache/kafka/pull/8230", "committedDate": "2020-03-12T00:46:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQyNzQzMQ==", "url": "https://github.com/confluentinc/schema-registry/pull/1385#discussion_r391427431", "bodyText": "Question: why does the previous test (testFromConnectNumericDecimal) instantiate a new JsonSchemaData towards the end ?", "author": "dragosvictor", "createdAt": "2020-03-12T06:45:33Z", "path": "json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java", "diffHunk": "@@ -261,6 +261,29 @@ public void testFromConnectNumericDecimal() {\n     jsonSchemaData = new JsonSchemaData();\n   }\n \n+  @Test\n+  public void testFromConnectNumericDecimalWithTrailingZeros() {\n+    jsonSchemaData =\n+        new JsonSchemaData(new JsonSchemaDataConfig(\n+            Collections.singletonMap(JsonSchemaDataConfig.DECIMAL_FORMAT_CONFIG,\n+                DecimalFormat.NUMERIC.name())));\n+    NumberSchema schema = NumberSchema.builder()\n+        .title(\"org.apache.kafka.connect.data.Decimal\")\n+        .unprocessedProperties(ImmutableMap.of(\"connect.type\",\n+            \"bytes\",\n+            \"connect.version\",\n+            1,\n+            \"connect.parameters\",\n+            ImmutableMap.of(\"scale\", \"4\")\n+        ))\n+        .build();\n+    checkNonObjectConversion(schema,\n+        DecimalNode.valueOf(new BigDecimal(\"1.5600\")),\n+        Decimal.schema(4),\n+        new BigDecimal(new BigInteger(\"15600\"), 4)\n+    );", "originalCommit": "f118ea07e341d531050df35cac69177514de9514", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTc0MzYwMA==", "url": "https://github.com/confluentinc/schema-registry/pull/1385#discussion_r391743600", "bodyText": "Good question.  That's just to clear out the JsonSchema for tests that rely on a default instance.  I'll do the same in the new test.", "author": "rayokota", "createdAt": "2020-03-12T16:32:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQyNzQzMQ=="}], "type": "inlineReview", "revised_code": {"commit": "157796f6e82fbedaf7a253326bef5370ab97511d", "chunk": "diff --git a/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java b/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java\nindex 5666fd793..a1cc860d2 100644\n--- a/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java\n+++ b/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java\n\n@@ -282,6 +282,7 @@ public class JsonSchemaDataTest {\n         Decimal.schema(4),\n         new BigDecimal(new BigInteger(\"15600\"), 4)\n     );\n+    jsonSchemaData = new JsonSchemaData();\n   }\n \n   @Test\n"}}, {"oid": "157796f6e82fbedaf7a253326bef5370ab97511d", "url": "https://github.com/confluentinc/schema-registry/commit/157796f6e82fbedaf7a253326bef5370ab97511d", "message": "Minor cleanup", "committedDate": "2020-03-12T16:24:53Z", "type": "commit"}, {"oid": "880408e341e1f053db9b78186c3c8bfdc99bcbb4", "url": "https://github.com/confluentinc/schema-registry/commit/880408e341e1f053db9b78186c3c8bfdc99bcbb4", "message": "Fix decimal handling in tests", "committedDate": "2020-03-12T17:25:10Z", "type": "commit"}, {"oid": "880408e341e1f053db9b78186c3c8bfdc99bcbb4", "url": "https://github.com/confluentinc/schema-registry/commit/880408e341e1f053db9b78186c3c8bfdc99bcbb4", "message": "Fix decimal handling in tests", "committedDate": "2020-03-12T17:25:10Z", "type": "forcePushed"}]}