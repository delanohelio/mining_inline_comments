{"pr_number": 1675, "pr_title": "DG-962 Handle const schemas in JSON Schema converter", "pr_createdAt": "2020-10-28T19:11:09Z", "pr_url": "https://github.com/confluentinc/schema-registry/pull/1675", "timeline": [{"oid": "51ba9e43824d9c063cf67277485a4459c8c33054", "url": "https://github.com/confluentinc/schema-registry/commit/51ba9e43824d9c063cf67277485a4459c8c33054", "message": "DG-962 Handle const schemas in JSON Schema converter", "committedDate": "2020-10-28T19:10:20Z", "type": "commit"}, {"oid": "68dc49ea060d2b347e2c3c6a78cfd99d386f77b8", "url": "https://github.com/confluentinc/schema-registry/commit/68dc49ea060d2b347e2c3c6a78cfd99d386f77b8", "message": "Minor cleanup", "committedDate": "2020-10-28T19:14:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxNzU2NQ==", "url": "https://github.com/confluentinc/schema-registry/pull/1675#discussion_r513717565", "bodyText": "Do we need to test with a float i.e 1.5?", "author": "maverick64", "createdAt": "2020-10-28T19:49:00Z", "path": "json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java", "diffHunk": "@@ -885,6 +887,22 @@ public void testToConnectIntEnumInAllOfIsInvalid() {\n     checkNonObjectConversion(expectedSchema, 1, schema, IntNode.valueOf(1));\n   }\n \n+  @Test\n+  public void testToConnectStringConstInAllOf() {\n+    JsonSchema jsonSchema = new JsonSchema(\"{\\\"const\\\":\\\"money\\\",\\\"type\\\":\\\"string\\\"}\");\n+    CombinedSchema schema = (CombinedSchema) jsonSchema.rawSchema();\n+    Schema expectedSchema = new SchemaBuilder(Schema.Type.STRING).build();\n+    checkNonObjectConversion(expectedSchema, \"money\", schema, TextNode.valueOf(\"money\"));\n+  }\n+\n+  @Test\n+  public void testToConnectIntegerConstInAllOf() {", "originalCommit": "68dc49ea060d2b347e2c3c6a78cfd99d386f77b8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxOTU3OQ==", "url": "https://github.com/confluentinc/schema-registry/pull/1675#discussion_r513719579", "bodyText": "Thanks I added another test", "author": "rayokota", "createdAt": "2020-10-28T19:52:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzcxNzU2NQ=="}], "type": "inlineReview", "revised_code": {"commit": "a56020a95a3aaf5a5a72e80138bfe474ffd6f208", "chunk": "diff --git a/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java b/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java\nindex 63a3b65a8..81578eefc 100644\n--- a/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java\n+++ b/json-schema-converter/src/test/java/io/confluent/connect/json/JsonSchemaDataTest.java\n\n@@ -903,6 +903,14 @@ public class JsonSchemaDataTest {\n     checkNonObjectConversion(expectedSchema, 123L, schema, LongNode.valueOf(123));\n   }\n \n+  @Test\n+  public void testToConnectNumberConstInAllOf() {\n+    JsonSchema jsonSchema = new JsonSchema(\"{\\\"const\\\":123.45,\\\"type\\\":\\\"number\\\"}\");\n+    CombinedSchema schema = (CombinedSchema) jsonSchema.rawSchema();\n+    Schema expectedSchema = new SchemaBuilder(Type.FLOAT64).build();\n+    checkNonObjectConversion(expectedSchema, 123.45, schema, DoubleNode.valueOf(123.45));\n+  }\n+\n   @Test\n   public void testToConnectUnion() {\n     NumberSchema firstSchema = NumberSchema.builder()\n"}}, {"oid": "a56020a95a3aaf5a5a72e80138bfe474ffd6f208", "url": "https://github.com/confluentinc/schema-registry/commit/a56020a95a3aaf5a5a72e80138bfe474ffd6f208", "message": "Add number test", "committedDate": "2020-10-28T19:52:13Z", "type": "commit"}]}