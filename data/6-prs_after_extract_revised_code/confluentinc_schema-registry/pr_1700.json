{"pr_number": 1700, "pr_title": "DG-293: Improve exception messages in JsonSchemaConverter and ProtobufConverter", "pr_createdAt": "2020-12-08T17:30:06Z", "pr_url": "https://github.com/confluentinc/schema-registry/pull/1700", "timeline": [{"oid": "3cb8d4be4067390d2b8d0a557117a351c36a4b5b", "url": "https://github.com/confluentinc/schema-registry/commit/3cb8d4be4067390d2b8d0a557117a351c36a4b5b", "message": "DG-293 improves exception message in JsonSchemaConverter and ProtobufConverter", "committedDate": "2020-12-08T18:14:01Z", "type": "commit"}, {"oid": "0e8e5a437eb580aac909c32fd14f9f706ff0ea45", "url": "https://github.com/confluentinc/schema-registry/commit/0e8e5a437eb580aac909c32fd14f9f706ff0ea45", "message": "also improve fromConnectData()", "committedDate": "2020-12-08T18:14:01Z", "type": "commit"}, {"oid": "0e8e5a437eb580aac909c32fd14f9f706ff0ea45", "url": "https://github.com/confluentinc/schema-registry/commit/0e8e5a437eb580aac909c32fd14f9f706ff0ea45", "message": "also improve fromConnectData()", "committedDate": "2020-12-08T18:14:01Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODczNzU1MA==", "url": "https://github.com/confluentinc/schema-registry/pull/1700#discussion_r538737550", "bodyText": "We don't need to track whether this was key or value, typically the topic name will already have that info.", "author": "rayokota", "createdAt": "2020-12-08T19:15:16Z", "path": "json-schema-converter/src/main/java/io/confluent/connect/json/JsonSchemaConverter.java", "diffHunk": "@@ -47,6 +47,7 @@\n   private Deserializer deserializer;\n \n   private boolean isKey;\n+  private String keyOrValueSuffix;", "originalCommit": "0e8e5a437eb580aac909c32fd14f9f706ff0ea45", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f611513309719b8fc376eab137bb1749c923ccfa", "chunk": "diff --git a/json-schema-converter/src/main/java/io/confluent/connect/json/JsonSchemaConverter.java b/json-schema-converter/src/main/java/io/confluent/connect/json/JsonSchemaConverter.java\nindex da63d20c1..b28af6e75 100644\n--- a/json-schema-converter/src/main/java/io/confluent/connect/json/JsonSchemaConverter.java\n+++ b/json-schema-converter/src/main/java/io/confluent/connect/json/JsonSchemaConverter.java\n\n@@ -47,7 +47,6 @@ public class JsonSchemaConverter extends AbstractKafkaSchemaSerDe implements Con\n   private Deserializer deserializer;\n \n   private boolean isKey;\n-  private String keyOrValueSuffix;\n   private JsonSchemaData jsonSchemaData;\n \n   public JsonSchemaConverter() {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzODczNzg4OA==", "url": "https://github.com/confluentinc/schema-registry/pull/1700#discussion_r538737888", "bodyText": "object.getClass() -> object.getClass().getName()", "author": "rayokota", "createdAt": "2020-12-08T19:15:46Z", "path": "protobuf-converter/src/main/java/io/confluent/connect/protobuf/ProtobufConverter.java", "diffHunk": "@@ -114,15 +117,18 @@ public SchemaAndValue toConnectData(String topic, byte[] value) {\n           Message message = (Message) object;\n           return protobufData.toConnectData(deserialized.getSchema(), message);\n         }\n+        throw new DataException(String.format(\n+            \"Unsupported type %s returned during deserialization of topic %s-%s \",\n+            object.getClass(),", "originalCommit": "0e8e5a437eb580aac909c32fd14f9f706ff0ea45", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f611513309719b8fc376eab137bb1749c923ccfa", "chunk": "diff --git a/protobuf-converter/src/main/java/io/confluent/connect/protobuf/ProtobufConverter.java b/protobuf-converter/src/main/java/io/confluent/connect/protobuf/ProtobufConverter.java\nindex b7104b5de..fe9ec0300 100644\n--- a/protobuf-converter/src/main/java/io/confluent/connect/protobuf/ProtobufConverter.java\n+++ b/protobuf-converter/src/main/java/io/confluent/connect/protobuf/ProtobufConverter.java\n\n@@ -118,17 +115,15 @@ public class ProtobufConverter implements Converter {\n           return protobufData.toConnectData(deserialized.getSchema(), message);\n         }\n         throw new DataException(String.format(\n-            \"Unsupported type %s returned during deserialization of topic %s-%s \",\n-            object.getClass(),\n-            topic,\n-            this.keyOrValueSuffix\n+            \"Unsupported type %s returned during deserialization of topic %s \",\n+            object.getClass().getName(),\n+            topic\n         ));\n       }\n     } catch (SerializationException e) {\n       throw new DataException(String.format(\n-          \"Failed to deserialize data for topic %s-%s to Protobuf: \",\n-          topic,\n-          this.keyOrValueSuffix\n+          \"Failed to deserialize data for topic %s to Protobuf: \",\n+          topic\n       ), e);\n     }\n   }\n"}}, {"oid": "f611513309719b8fc376eab137bb1749c923ccfa", "url": "https://github.com/confluentinc/schema-registry/commit/f611513309719b8fc376eab137bb1749c923ccfa", "message": "remove keyOrValueSuffix", "committedDate": "2020-12-08T19:27:37Z", "type": "commit"}]}