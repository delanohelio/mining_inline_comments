{"pr_number": 3494, "pr_title": "[okex] Order Book and Order details implementation", "pr_createdAt": "2020-04-18T07:56:27Z", "pr_url": "https://github.com/knowm/XChange/pull/3494", "timeline": [{"oid": "64e35ed186dbc2db1d61d3a1504183c59c244b35", "url": "https://github.com/knowm/XChange/commit/64e35ed186dbc2db1d61d3a1504183c59c244b35", "message": "Get market data order book in V3\n\nGet market data order book in V3", "committedDate": "2020-04-18T07:41:39Z", "type": "commit"}, {"oid": "3244a3c5d4b7be77dfdc2ae6cebc51b0e7f33d8f", "url": "https://github.com/knowm/XChange/commit/3244a3c5d4b7be77dfdc2ae6cebc51b0e7f33d8f", "message": "Order book and Order Details implementation\n\nOrder book and Order Details implementation", "committedDate": "2020-04-18T07:43:20Z", "type": "commit"}, {"oid": "67e94dda3e0eadf1c030be0c0719b727e1b3363b", "url": "https://github.com/knowm/XChange/commit/67e94dda3e0eadf1c030be0c0719b727e1b3363b", "message": "Order Book and Order Details implementation\n\nOrder Book and Order Details implementation", "committedDate": "2020-04-18T07:45:16Z", "type": "commit"}, {"oid": "7c9987fb57f659fab4d5e7827ce552f01007ced4", "url": "https://github.com/knowm/XChange/commit/7c9987fb57f659fab4d5e7827ce552f01007ced4", "message": "Order details implementation\n\nOrder details implementation", "committedDate": "2020-04-18T07:47:04Z", "type": "commit"}, {"oid": "ff831203fa3f468c795210a63458fefb8fc36e49", "url": "https://github.com/knowm/XChange/commit/ff831203fa3f468c795210a63458fefb8fc36e49", "message": "Order Book implementation\n\nOrder Book implementation", "committedDate": "2020-04-18T07:48:18Z", "type": "commit"}, {"oid": "b458531ed3ea601c8f04f262be5c498fa60d7bac", "url": "https://github.com/knowm/XChange/commit/b458531ed3ea601c8f04f262be5c498fa60d7bac", "message": "Order Book implementation\n\nOrder Book implementation", "committedDate": "2020-04-18T07:52:14Z", "type": "commit"}, {"oid": "bbc2a5589ce8689a00d82db2baf6b2afc2b8cd1d", "url": "https://github.com/knowm/XChange/commit/bbc2a5589ce8689a00d82db2baf6b2afc2b8cd1d", "message": "Order Book implementation\n\nOrder Book implementation", "committedDate": "2020-04-18T07:53:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg4MDAzMw==", "url": "https://github.com/knowm/XChange/pull/3494#discussion_r410880033", "bodyText": "if you use Jacskon property then you will not have to do this by hand\ntake a look how @JsonFormat(shape = JsonFormat.Shape.ARRAY) works", "author": "walec51", "createdAt": "2020-04-19T11:13:07Z", "path": "xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/dto/marketdata/OkexOrderBook.java", "diffHunk": "@@ -0,0 +1,75 @@\n+package org.knowm.xchange.okcoin.v3.dto.marketdata;\n+\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+import java.math.BigDecimal;\n+import java.util.Arrays;\n+\n+public class OkexOrderBook {\n+\n+  private final String timestamp;\n+  private final OkexOrderBookEntry[] bids;\n+  private final OkexOrderBookEntry[] asks;\n+\n+  public OkexOrderBook(\n+      @JsonProperty(\"timestamp\") String timestamp,\n+      @JsonProperty(\"bids\") Object[][] bids,\n+      @JsonProperty(\"asks\") Object[][] asks) {\n+\n+    this.timestamp = timestamp;\n+\n+    if (bids != null && bids.length > 0) {\n+      this.bids = new OkexOrderBookEntry[bids.length];\n+      for (int i = 0; i < bids.length; i++) {\n+        this.bids[i] = convertToBookEntry(bids[i]);", "originalCommit": "bbc2a5589ce8689a00d82db2baf6b2afc2b8cd1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg1NDYyNg==", "url": "https://github.com/knowm/XChange/pull/3494#discussion_r429854626", "bodyText": "Done.", "author": "KeshavSirohi", "createdAt": "2020-05-25T10:12:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg4MDAzMw=="}], "type": "inlineReview", "revised_code": {"commit": "20cc7099d5ccd7b1d31c85837a868c72a6785e77", "chunk": "diff --git a/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/dto/marketdata/OkexOrderBook.java b/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/dto/marketdata/OkexOrderBook.java\nindex 4db9422d86..d77da178c0 100644\n--- a/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/dto/marketdata/OkexOrderBook.java\n+++ b/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/dto/marketdata/OkexOrderBook.java\n\n@@ -1,51 +1,20 @@\n package org.knowm.xchange.okcoin.v3.dto.marketdata;\n \n import com.fasterxml.jackson.annotation.JsonProperty;\n-import java.math.BigDecimal;\n import java.util.Arrays;\n+import lombok.Data;\n \n+@Data\n public class OkexOrderBook {\n \n-  private final String timestamp;\n-  private final OkexOrderBookEntry[] bids;\n-  private final OkexOrderBookEntry[] asks;\n+  @JsonProperty(\"timestamp\")\n+  private String timestamp;\n \n-  public OkexOrderBook(\n-      @JsonProperty(\"timestamp\") String timestamp,\n-      @JsonProperty(\"bids\") Object[][] bids,\n-      @JsonProperty(\"asks\") Object[][] asks) {\n+  @JsonProperty(\"bids\")\n+  private OkexOrderBookEntry[] bids;\n \n-    this.timestamp = timestamp;\n-\n-    if (bids != null && bids.length > 0) {\n-      this.bids = new OkexOrderBookEntry[bids.length];\n-      for (int i = 0; i < bids.length; i++) {\n-        this.bids[i] = convertToBookEntry(bids[i]);\n-      }\n-    } else {\n-      this.bids = null;\n-    }\n-\n-    if (asks != null && asks.length > 0) {\n-      this.asks = new OkexOrderBookEntry[asks.length];\n-      for (int i = 0; i < asks.length; i++) {\n-        this.asks[i] = convertToBookEntry(asks[i]);\n-      }\n-    } else {\n-      this.asks = null;\n-    }\n-  }\n-\n-  private static OkexOrderBookEntry convertToBookEntry(Object[] dataObject) {\n-\n-    if (dataObject != null && dataObject.length == 3) {\n-      BigDecimal price = new BigDecimal((String) dataObject[0]);\n-      BigDecimal volume = new BigDecimal((String) dataObject[1]);\n-      String numberOfOrders = (String) dataObject[2];\n-      return new OkexOrderBookEntry(price, volume, numberOfOrders);\n-    }\n-    return null;\n-  }\n+  @JsonProperty(\"asks\")\n+  private OkexOrderBookEntry[] asks;\n \n   public String getTimestamp() {\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg4MDYxMg==", "url": "https://github.com/knowm/XChange/pull/3494#discussion_r410880612", "bodyText": "this should be in the *Raw class because its not part o the generic API", "author": "walec51", "createdAt": "2020-04-19T11:16:43Z", "path": "xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/service/OkexTradeService.java", "diffHunk": "@@ -151,6 +151,11 @@ public OpenOrders getOpenOrders(OpenOrdersParams params) throws IOException {\n     return new OpenOrders(all.stream().map(OkexAdaptersV3::convert).collect(Collectors.toList()));\n   }\n \n+  public OkexOpenOrder getOrdersDetails(String orderId, CurrencyPair pair) throws IOException {\n+    final String instrument = OkexAdaptersV3.toSpotInstrument(pair);\n+    return getSpotOrderDetails(orderId, instrument);\n+  }", "originalCommit": "bbc2a5589ce8689a00d82db2baf6b2afc2b8cd1d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTg1NDcwNw==", "url": "https://github.com/knowm/XChange/pull/3494#discussion_r429854707", "bodyText": "Done", "author": "KeshavSirohi", "createdAt": "2020-05-25T10:12:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDg4MDYxMg=="}], "type": "inlineReview", "revised_code": {"commit": "d19421780dc975ce36fb9bcbe6f93a1796991330", "chunk": "diff --git a/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/service/OkexTradeService.java b/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/service/OkexTradeService.java\nindex 093b725f30..f95e010c9a 100644\n--- a/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/service/OkexTradeService.java\n+++ b/xchange-okcoin/src/main/java/org/knowm/xchange/okcoin/v3/service/OkexTradeService.java\n\n@@ -150,12 +150,7 @@ public class OkexTradeService extends OkexTradeServiceRaw implements TradeServic\n     } while (!stop);\n     return new OpenOrders(all.stream().map(OkexAdaptersV3::convert).collect(Collectors.toList()));\n   }\n-\n-  public OkexOpenOrder getOrdersDetails(String orderId, CurrencyPair pair) throws IOException {\n-    final String instrument = OkexAdaptersV3.toSpotInstrument(pair);\n-    return getSpotOrderDetails(orderId, instrument);\n-  }\n-\n+  \n   @Override\n   public TradeHistoryParams createTradeHistoryParams() {\n     return new OkexTradeHistoryParams();\n"}}, {"oid": "0f2346a795d4ef34f4ed850751d0312ca86bbabe", "url": "https://github.com/knowm/XChange/commit/0f2346a795d4ef34f4ed850751d0312ca86bbabe", "message": "Order details implementation\n\nOrder details implementation", "committedDate": "2020-05-25T07:35:34Z", "type": "commit"}, {"oid": "d19421780dc975ce36fb9bcbe6f93a1796991330", "url": "https://github.com/knowm/XChange/commit/d19421780dc975ce36fb9bcbe6f93a1796991330", "message": "Order details implementation\n\nOrder details implementation changes per review.", "committedDate": "2020-05-25T07:36:45Z", "type": "commit"}, {"oid": "5cac8573866f9fc7af472c4014e47840e756a447", "url": "https://github.com/knowm/XChange/commit/5cac8573866f9fc7af472c4014e47840e756a447", "message": "Order Book implementation\n\nOrder Book implementation changes as per reveiw.", "committedDate": "2020-05-25T07:39:02Z", "type": "commit"}, {"oid": "20cc7099d5ccd7b1d31c85837a868c72a6785e77", "url": "https://github.com/knowm/XChange/commit/20cc7099d5ccd7b1d31c85837a868c72a6785e77", "message": "Order Book implementation\n\nOrder Book implementation changes as per review.", "committedDate": "2020-05-25T07:40:26Z", "type": "commit"}, {"oid": "52e07b0e77b96dc61a385a2a6948b9e4526f0b49", "url": "https://github.com/knowm/XChange/commit/52e07b0e77b96dc61a385a2a6948b9e4526f0b49", "message": "Corrected the wrong code updated earlier\n\nCorrected the wrong code updated earlier", "committedDate": "2020-05-25T09:35:57Z", "type": "commit"}]}