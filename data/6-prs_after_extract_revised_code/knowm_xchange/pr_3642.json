{"pr_number": 3642, "pr_title": "[CoinbasePro-Stream] increasing streaming to full channel and cleanup", "pr_createdAt": "2020-08-05T02:44:33Z", "pr_url": "https://github.com/knowm/XChange/pull/3642", "timeline": [{"oid": "7310ae512b4310612260da9c230359ccd937e6f6", "url": "https://github.com/knowm/XChange/commit/7310ae512b4310612260da9c230359ccd937e6f6", "message": "Merge pull request #6 from knowm/develop\n\nUpdating to head", "committedDate": "2020-07-02T18:48:36Z", "type": "commit"}, {"oid": "d0d32f746885397987124afb21141ca974b71d3e", "url": "https://github.com/knowm/XChange/commit/d0d32f746885397987124afb21141ca974b71d3e", "message": "Merge pull request #7 from knowm/develop\n\nUpdating code", "committedDate": "2020-08-04T18:25:11Z", "type": "commit"}, {"oid": "c2e8518766d77255fc15e59d6b13672ed80f26f4", "url": "https://github.com/knowm/XChange/commit/c2e8518766d77255fc15e59d6b13672ed80f26f4", "message": "CoinbasePro streaming improvements", "committedDate": "2020-08-05T02:39:47Z", "type": "commit"}, {"oid": "ae5bfcbb993d145e6a699fbcbe2be568034cbdf8", "url": "https://github.com/knowm/XChange/commit/ae5bfcbb993d145e6a699fbcbe2be568034cbdf8", "message": "Merge pull request #8 from knowm/develop\n\nupdating", "committedDate": "2020-08-16T14:50:59Z", "type": "commit"}, {"oid": "576bc2bc027cce02f0f23a7faf69529ea6ca80a6", "url": "https://github.com/knowm/XChange/commit/576bc2bc027cce02f0f23a7faf69529ea6ca80a6", "message": "updating review based on comments", "committedDate": "2020-08-16T15:51:01Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTEwNDE0MA==", "url": "https://github.com/knowm/XChange/pull/3642#discussion_r475104140", "bodyText": "I don't see how this can work given that streamingService is replaced only a few lines later. \ud83e\udd14", "author": "badgerwithagun", "createdAt": "2020-08-22T15:59:49Z", "path": "xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java", "diffHunk": "@@ -48,6 +48,13 @@ public Completable connect(ProductSubscription... args) {\n       apiUri = usePrime ? PRIME_API_URI : API_URI;\n     }\n \n+    boolean subscribeToL3Orderbook =\n+            Boolean.TRUE.equals(\n+                    exchangeSpecification.getExchangeSpecificParametersItem(StreamingExchange.L3_ORDERBOOK));\n+    if (subscribeToL3Orderbook) {\n+      this.streamingService.subscribeToL3Orderbook();", "originalCommit": "576bc2bc027cce02f0f23a7faf69529ea6ca80a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTExMTg2NQ==", "url": "https://github.com/knowm/XChange/pull/3642#discussion_r475111865", "bodyText": "@badgerwithagun sorry not sure how I did not update the review with this, I had made some local changes. Good catch.", "author": "earce", "createdAt": "2020-08-22T17:24:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTEwNDE0MA=="}], "type": "inlineReview", "revised_code": {"commit": "f348960e71dd03de630e9d9369823df7dd21551c", "chunk": "diff --git a/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java b/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java\nindex 241ec1236f..14b2fd1981 100644\n--- a/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java\n+++ b/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java\n\n@@ -49,13 +49,13 @@ public class CoinbaseProStreamingExchange extends CoinbaseProExchange implements\n     }\n \n     boolean subscribeToL3Orderbook =\n-            Boolean.TRUE.equals(\n-                    exchangeSpecification.getExchangeSpecificParametersItem(StreamingExchange.L3_ORDERBOOK));\n-    if (subscribeToL3Orderbook) {\n-      this.streamingService.subscribeToL3Orderbook();\n-    }\n+        Boolean.TRUE.equals(\n+            exchangeSpecification.getExchangeSpecificParametersItem(\n+                StreamingExchange.L3_ORDERBOOK));\n \n-    this.streamingService = new CoinbaseProStreamingService(apiUri, () -> authData(exchangeSpec));\n+    this.streamingService =\n+        new CoinbaseProStreamingService(\n+            apiUri, () -> authData(exchangeSpec), subscribeToL3Orderbook);\n     applyStreamingSpecification(exchangeSpecification, this.streamingService);\n \n     this.streamingMarketDataService = new CoinbaseProStreamingMarketDataService(streamingService);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTEwNDI0OQ==", "url": "https://github.com/knowm/XChange/pull/3642#discussion_r475104249", "bodyText": "Why not pass subscribeToL3Orderbook in the constructor?", "author": "badgerwithagun", "createdAt": "2020-08-22T16:00:40Z", "path": "xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java", "diffHunk": "@@ -48,6 +48,13 @@ public Completable connect(ProductSubscription... args) {\n       apiUri = usePrime ? PRIME_API_URI : API_URI;\n     }\n \n+    boolean subscribeToL3Orderbook =\n+            Boolean.TRUE.equals(\n+                    exchangeSpecification.getExchangeSpecificParametersItem(StreamingExchange.L3_ORDERBOOK));\n+    if (subscribeToL3Orderbook) {\n+      this.streamingService.subscribeToL3Orderbook();\n+    }\n+\n     this.streamingService = new CoinbaseProStreamingService(apiUri, () -> authData(exchangeSpec));", "originalCommit": "576bc2bc027cce02f0f23a7faf69529ea6ca80a6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTExMTg4MQ==", "url": "https://github.com/knowm/XChange/pull/3642#discussion_r475111881", "bodyText": "done", "author": "earce", "createdAt": "2020-08-22T17:24:41Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTEwNDI0OQ=="}], "type": "inlineReview", "revised_code": {"commit": "f348960e71dd03de630e9d9369823df7dd21551c", "chunk": "diff --git a/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java b/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java\nindex 241ec1236f..14b2fd1981 100644\n--- a/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java\n+++ b/xchange-stream-coinbasepro/src/main/java/info/bitrich/xchangestream/coinbasepro/CoinbaseProStreamingExchange.java\n\n@@ -49,13 +49,13 @@ public class CoinbaseProStreamingExchange extends CoinbaseProExchange implements\n     }\n \n     boolean subscribeToL3Orderbook =\n-            Boolean.TRUE.equals(\n-                    exchangeSpecification.getExchangeSpecificParametersItem(StreamingExchange.L3_ORDERBOOK));\n-    if (subscribeToL3Orderbook) {\n-      this.streamingService.subscribeToL3Orderbook();\n-    }\n+        Boolean.TRUE.equals(\n+            exchangeSpecification.getExchangeSpecificParametersItem(\n+                StreamingExchange.L3_ORDERBOOK));\n \n-    this.streamingService = new CoinbaseProStreamingService(apiUri, () -> authData(exchangeSpec));\n+    this.streamingService =\n+        new CoinbaseProStreamingService(\n+            apiUri, () -> authData(exchangeSpec), subscribeToL3Orderbook);\n     applyStreamingSpecification(exchangeSpecification, this.streamingService);\n \n     this.streamingMarketDataService = new CoinbaseProStreamingMarketDataService(streamingService);\n"}}, {"oid": "f348960e71dd03de630e9d9369823df7dd21551c", "url": "https://github.com/knowm/XChange/commit/f348960e71dd03de630e9d9369823df7dd21551c", "message": "updating review based on comments", "committedDate": "2020-08-22T17:20:02Z", "type": "commit"}]}