{"pr_number": 4157, "pr_title": "PLFM-6394", "pr_createdAt": "2020-08-10T23:02:03Z", "pr_url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4157", "timeline": [{"oid": "5a56dadf3f2401d76b1c99e795ae05245d596590", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/5a56dadf3f2401d76b1c99e795ae05245d596590", "message": "PLFM-6394", "committedDate": "2020-08-10T23:00:46Z", "type": "commit"}, {"oid": "abc0e3b758c46b9fa1a6cee520eb4d449b4f2125", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/commit/abc0e3b758c46b9fa1a6cee520eb4d449b4f2125", "message": "PLFM-6394", "committedDate": "2020-08-10T23:23:41Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg3ODU0MQ==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4157#discussion_r468878541", "bodyText": "Might be worth adding this details in the API docs above.", "author": "marcomarasca", "createdAt": "2020-08-11T21:35:36Z", "path": "services/repository/src/main/java/org/sagebionetworks/auth/controller/AuthenticationController.java", "diffHunk": "@@ -369,10 +371,12 @@ public void unbindExternalAliasFromAccount(\n \t@RequestMapping(value = UrlHelpers.AUTH_PERSONAL_ACCESS_TOKEN, method = RequestMethod.POST)\r\n \tpublic @ResponseBody AccessTokenGenerationResponse createPersonalAccessToken(\r\n \t\t\t@RequestParam(value = AuthorizationConstants.USER_ID_PARAM) Long userId,\r\n+\t\t\t@RequestHeader(value = AuthorizationConstants.SYNAPSE_AUTHORIZATION_HEADER_NAME, required=false) String authorizationHeader,\r", "originalCommit": "abc0e3b758c46b9fa1a6cee520eb4d449b4f2125", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODg4MTIzOQ==", "url": "https://github.com/Sage-Bionetworks/Synapse-Repository-Services/pull/4157#discussion_r468881239", "bodyText": "You might want to add the test to check on the removeAll for double authorize in the list edge case", "author": "marcomarasca", "createdAt": "2020-08-11T21:42:00Z", "path": "services/repository-managers/src/test/java/org/sagebionetworks/repo/manager/authentication/PersonalAccessTokenManagerImplUnitTest.java", "diffHunk": "@@ -131,13 +146,47 @@ void testIssueToken() {\n \t\tverify(mockPersonalAccessTokenDao).deleteLeastRecentlyUsedTokensOverLimit(userInfo.getId().toString(), EXPECTED_TOKEN_LIMIT);\n \t}\n \n+\t@Test\n+\tvoid testIssueTokenLimitedAccessTokenScope() {", "originalCommit": "abc0e3b758c46b9fa1a6cee520eb4d449b4f2125", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}