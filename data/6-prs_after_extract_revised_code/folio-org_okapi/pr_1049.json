{"pr_number": 1049, "pr_title": "Update to Vert.x 4.0.0.CR2 OKAPI-955", "pr_createdAt": "2020-11-26T16:45:02Z", "pr_url": "https://github.com/folio-org/okapi/pull/1049", "timeline": [{"oid": "ef696a6be02d997c396e6bbfe92a2da667217753", "url": "https://github.com/folio-org/okapi/commit/ef696a6be02d997c396e6bbfe92a2da667217753", "message": "Update to 4.0.0.CR2 OKAPI-955", "committedDate": "2020-11-26T16:43:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU2NDc4Ng==", "url": "https://github.com/folio-org/okapi/pull/1049#discussion_r531564786", "bodyText": "This is ok.\nReplacing HttpClient by WebClient allows for more concise code and would have avoided this code change.\nYou don't need to replace HttpClient by WebClient before merging this pull request.\n    WebClient\n        .create(vertx)\n        .post(PORT, \"localhost\", \"/test1\")\n        .send()\n        .onSuccess(res -> {\n          if (ctx.request().isEnded()) {\n            ctx.response().end(\"OK2\"); // Vert.x 3.6 series\n          } else {\n            ctx.request().endHandler(y -> {\n              ctx.response().end(\"OK2\");\n            });\n            ctx.request().resume();\n          }\n        }).onFailure(cause -> {\n          ctx.response().setStatusCode(500);\n          ctx.response().end(cause.getMessage());\n        });", "author": "julianladisch", "createdAt": "2020-11-27T12:08:21Z", "path": "okapi-common/src/test/java/org/folio/okapi/common/PauseResumeTest.java", "diffHunk": "@@ -37,7 +37,7 @@ private void myStreamHandle2(RoutingContext ctx) {\n         return;\n       }\n       req.result().end();\n-      req.result().onComplete(res -> {\n+      req.result().response(res -> {", "originalCommit": "ef696a6be02d997c396e6bbfe92a2da667217753", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTU2NjMxNA==", "url": "https://github.com/folio-org/okapi/pull/1049#discussion_r531566314", "bodyText": "This is ok.\nReplacing HttpClient by WebClient allows for more concise code and would have avoided this code change.\nYou don't need to replace HttpClient by WebClient before merging this pull request.\n    context.assertNotNull(server);\n    WebClient.create(vertx)\n        .post(PORT, LOCALHOST, URL + \"/test1\")\n        .expect(ResponsePredicate.SC_OK)\n        .send()\n        .onComplete(context.asyncAssertSuccess());", "author": "julianladisch", "createdAt": "2020-11-27T12:11:36Z", "path": "okapi-common/src/test/java/org/folio/okapi/common/OkapiClientTest.java", "diffHunk": "@@ -360,7 +360,7 @@ public void testLegacyPostOk(TestContext context) {\n     client.request(HttpMethod.POST, PORT, LOCALHOST, URL + \"/test1\")\n         .onComplete(context.asyncAssertSuccess(request -> {\n           request.end();\n-          request.onComplete(context.asyncAssertSuccess(response -> {\n+          request.response(context.asyncAssertSuccess(response -> {\n             context.assertEquals(200, response.statusCode());\n           }));\n         }));", "originalCommit": "ef696a6be02d997c396e6bbfe92a2da667217753", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}