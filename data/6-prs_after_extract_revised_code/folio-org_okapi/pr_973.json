{"pr_number": 973, "pr_title": "Event Bus check OKAPI-891", "pr_createdAt": "2020-09-16T08:00:59Z", "pr_url": "https://github.com/folio-org/okapi/pull/973", "timeline": [{"oid": "f9699efb739854ad1ac76304b7e267a66c0b9378", "url": "https://github.com/folio-org/okapi/commit/f9699efb739854ad1ac76304b7e267a66c0b9378", "message": "Event Bus check OKAPI-891", "committedDate": "2020-09-16T07:57:48Z", "type": "commit"}, {"oid": "8c570d4f1236fdf04b67de63aa7b59283ccb6389", "url": "https://github.com/folio-org/okapi/commit/8c570d4f1236fdf04b67de63aa7b59283ccb6389", "message": "Return with failure; slightly more coverage", "committedDate": "2020-09-16T08:15:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MDQ0NzE1NA==", "url": "https://github.com/folio-org/okapi/pull/973#discussion_r490447154", "bodyText": "To handle the race condition when the node list changes you may have a check3 method that runs check(Vertx, ClusterManager) up to three times if it fails.", "author": "julianladisch", "createdAt": "2020-09-17T17:49:19Z", "path": "okapi-core/src/main/java/org/folio/okapi/util/EventBusChecker.java", "diffHunk": "@@ -0,0 +1,51 @@\n+package org.folio.okapi.util;\n+\n+import io.vertx.core.CompositeFuture;\n+import io.vertx.core.Future;\n+import io.vertx.core.Vertx;\n+import io.vertx.core.eventbus.DeliveryOptions;\n+import io.vertx.core.spi.cluster.ClusterManager;\n+import java.util.LinkedList;\n+import java.util.List;\n+\n+public class EventBusChecker {\n+  private static final String EVENT_NODE_CHECK = \"org.folio.okapi.node.check.\";\n+\n+  /**\n+   * Check that event bus is operational by sending a message to each party.\n+   * @param vertx Vert.x handle\n+   * @param clusterManager manager ; null if not in clustered mode\n+   * @return async result\n+   */\n+  public static Future<Void> check(Vertx vertx, ClusterManager clusterManager) {", "originalCommit": "8c570d4f1236fdf04b67de63aa7b59283ccb6389", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "dbffd841b4756b6ba9f0b6296245b96eb95a25b8", "url": "https://github.com/folio-org/okapi/commit/dbffd841b4756b6ba9f0b6296245b96eb95a25b8", "message": "Merge branch 'master' into OKAPI-891-event-bus-check", "committedDate": "2020-09-19T16:02:28Z", "type": "commit"}, {"oid": "e458f714b317e36ce022b1fe80c3a4fe3158b39f", "url": "https://github.com/folio-org/okapi/commit/e458f714b317e36ce022b1fe80c3a4fe3158b39f", "message": "Merge branch 'master' into OKAPI-891-event-bus-check", "committedDate": "2020-09-21T21:35:06Z", "type": "commit"}, {"oid": "c1aa3436cd1f6b08bc5cc53c78463f5ad5b7b01e", "url": "https://github.com/folio-org/okapi/commit/c1aa3436cd1f6b08bc5cc53c78463f5ad5b7b01e", "message": "Merge branch 'master' into OKAPI-891-event-bus-check", "committedDate": "2020-09-22T20:11:24Z", "type": "commit"}, {"oid": "5eb750c80d72a5b6a1b7a870284987f687b40797", "url": "https://github.com/folio-org/okapi/commit/5eb750c80d72a5b6a1b7a870284987f687b40797", "message": "Merge branch 'master' into OKAPI-891-event-bus-check", "committedDate": "2020-09-23T20:46:52Z", "type": "commit"}, {"oid": "03b927fc5dad453d53dcccd0fb1ecf49055ec1ef", "url": "https://github.com/folio-org/okapi/commit/03b927fc5dad453d53dcccd0fb1ecf49055ec1ef", "message": "Merge branch 'master' into OKAPI-891-event-bus-check", "committedDate": "2020-09-30T17:32:07Z", "type": "commit"}, {"oid": "c47ecf35296155b8a2079295668a6334dcb3ffc5", "url": "https://github.com/folio-org/okapi/commit/c47ecf35296155b8a2079295668a6334dcb3ffc5", "message": "Warn rather than fail if EventBusCheck fails", "committedDate": "2020-09-30T17:40:56Z", "type": "commit"}, {"oid": "5cee665e193767e9d4167c0c1f12e08fa654db37", "url": "https://github.com/folio-org/okapi/commit/5cee665e193767e9d4167c0c1f12e08fa654db37", "message": "Merge branch 'OKAPI-891-event-bus-check' of github.com:folio-org/okapi into OKAPI-891-event-bus-check", "committedDate": "2020-09-30T17:41:37Z", "type": "commit"}]}