{"pr_number": 1041, "pr_title": "Support both \"http.port\" and \"port\" property variables", "pr_createdAt": "2020-11-10T21:00:52Z", "pr_url": "https://github.com/folio-org/okapi/pull/1041", "timeline": [{"oid": "266fc609f7aebcc19f77608bedcb6a6779f4b667", "url": "https://github.com/folio-org/okapi/commit/266fc609f7aebcc19f77608bedcb6a6779f4b667", "message": "Support both \"http.port\" and \"port\" property variables\n\n\"http.port\" is the command-line option name that all RMB based\nmodules support:\nhttps://github.com/folio-org/raml-module-builder#command-line-options\n\nFor consistency Okapi should also support this.\n\nThe guide.md should show \"http.port\" because most modules\nare RMB based and support only this form.", "committedDate": "2020-11-10T20:54:56Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4ODMxNA==", "url": "https://github.com/folio-org/okapi/pull/1041#discussion_r521488314", "bodyText": "So http.port is only supported as property. Not as Json configuration. Is that intended?", "author": "adamdickmeiss", "createdAt": "2020-11-11T16:39:15Z", "path": "okapi-core/src/main/java/org/folio/okapi/MainVerticle.java", "diffHunk": "@@ -83,7 +83,8 @@ public void init(Vertx vertx, Context context) {\n     super.init(vertx, context);\n \n     JsonObject config = context.config();\n-    port = Integer.parseInt(Config.getSysConf(\"port\", \"9130\", config));\n+    String portString = System.getProperty(\"http.port\", \"9130\");\n+    port = Integer.parseInt(Config.getSysConf(\"port\", portString, config));\n     String okapiVersion2 = Config.getSysConf(\"okapiVersion\", null, config);", "originalCommit": "266fc609f7aebcc19f77608bedcb6a6779f4b667", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTYzNzI0Mw==", "url": "https://github.com/folio-org/okapi/pull/1041#discussion_r521637243", "bodyText": "No, good catch!\nFixed.", "author": "julianladisch", "createdAt": "2020-11-11T21:03:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTQ4ODMxNA=="}], "type": "inlineReview", "revised_code": {"commit": "97238ed75b784ad27b1478d0de12ace617123a9b", "chunk": "diff --git a/okapi-core/src/main/java/org/folio/okapi/MainVerticle.java b/okapi-core/src/main/java/org/folio/okapi/MainVerticle.java\nindex 129273eea..f2cc54f21 100644\n--- a/okapi-core/src/main/java/org/folio/okapi/MainVerticle.java\n+++ b/okapi-core/src/main/java/org/folio/okapi/MainVerticle.java\n\n@@ -83,8 +83,7 @@ public class MainVerticle extends AbstractVerticle {\n     super.init(vertx, context);\n \n     JsonObject config = context.config();\n-    String portString = System.getProperty(\"http.port\", \"9130\");\n-    port = Integer.parseInt(Config.getSysConf(\"port\", portString, config));\n+    port = Integer.parseInt(Config.getSysConf(\"http.port\", \"port\", \"9130\", config));\n     String okapiVersion2 = Config.getSysConf(\"okapiVersion\", null, config);\n     if (okapiVersion2 != null) {\n       okapiVersion = okapiVersion2;\n"}}, {"oid": "97238ed75b784ad27b1478d0de12ace617123a9b", "url": "https://github.com/folio-org/okapi/commit/97238ed75b784ad27b1478d0de12ace617123a9b", "message": "Config.getSysConf with 2 keys, http.port in okapi.sh", "committedDate": "2020-11-11T21:03:26Z", "type": "commit"}, {"oid": "ec804157cfd2f5012dc18f7518536ab3e886c041", "url": "https://github.com/folio-org/okapi/commit/ec804157cfd2f5012dc18f7518536ab3e886c041", "message": "Merge branch 'master' into http.port", "committedDate": "2020-12-14T09:17:49Z", "type": "commit"}]}