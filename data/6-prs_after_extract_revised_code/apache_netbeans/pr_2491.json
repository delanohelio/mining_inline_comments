{"pr_number": 2491, "pr_title": "[NETBEANS-4946] - Improve JAVA/JAKARTA EE with Ant based projects", "pr_createdAt": "2020-10-26T01:09:21Z", "pr_url": "https://github.com/apache/netbeans/pull/2491", "timeline": [{"oid": "f2bb4dc12e84aa6901729e0c3461ef8ff60b4efa", "url": "https://github.com/apache/netbeans/commit/f2bb4dc12e84aa6901729e0c3461ef8ff60b4efa", "message": "Cleanup\n\n- Change mdd files to implement and extend local classes\n- Add missing javadoc tag\n- Add TODO\n-Remove added logging", "committedDate": "2020-12-25T22:52:41Z", "type": "forcePushed"}, {"oid": "4a77ddd8042df1fe14210866002b9140a67cc3aa", "url": "https://github.com/apache/netbeans/commit/4a77ddd8042df1fe14210866002b9140a67cc3aa", "message": "Add logging for test purposes.", "committedDate": "2021-01-08T23:34:56Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQyODU0Mg==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r546428542", "bodyText": "This looks strange - EE6 -> source level 1.6 and EE5 -> source level 1.7?", "author": "matthiasblaesing", "createdAt": "2020-12-20T19:55:56Z", "path": "enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/ui/customizer/EjbJarProjectProperties.java", "diffHunk": "@@ -323,11 +323,16 @@ private void init() {\n         PLATFORM_LIST_RENDERER = PlatformUiSupport.createPlatformListCellRenderer();\n         SpecificationVersion minimalSourceLevel = null;\n         Profile profile = Profile.fromPropertiesString(evaluator.getProperty(J2EE_PLATFORM));\n-        if (Profile.JAVA_EE_6_FULL.equals(profile)) {\n+        LOGGER.log(Level.INFO, \"init(326) profile: {0}\", profile);\n+        if (Profile.JAKARTA_EE_8_FULL.equals(profile)) {\n+            minimalSourceLevel = new SpecificationVersion(\"1.8\");\n+        } else if (Profile.JAVA_EE_8_FULL.equals(profile)) {\n+            minimalSourceLevel = new SpecificationVersion(\"1.8\");\n+        } else if (Profile.JAVA_EE_7_FULL.equals(profile)) {\n+            minimalSourceLevel = new SpecificationVersion(\"1.7\");\n+        } else if (Profile.JAVA_EE_6_FULL.equals(profile)) {\n             minimalSourceLevel = new SpecificationVersion(\"1.6\");\n         } else if (Profile.JAVA_EE_5.equals(profile)) {\n-            minimalSourceLevel = new SpecificationVersion(\"1.5\");\n-        } else if (Profile.JAVA_EE_7_FULL.equals(profile)) {\n             minimalSourceLevel = new SpecificationVersion(\"1.7\");", "originalCommit": "a83fced288f153e3f52ccfdfacf47a1186bbbe66", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjI2NDcwOQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562264709", "bodyText": "Fixed, thank you.", "author": "pepness", "createdAt": "2021-01-21T23:28:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjQyODU0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "f2bb4dc12e84aa6901729e0c3461ef8ff60b4efa", "chunk": "diff --git a/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/ui/customizer/EjbJarProjectProperties.java b/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/ui/customizer/EjbJarProjectProperties.java\nindex c18d128d39..5547d99be5 100644\n--- a/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/ui/customizer/EjbJarProjectProperties.java\n+++ b/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/ui/customizer/EjbJarProjectProperties.java\n\n@@ -323,10 +323,8 @@ final public class EjbJarProjectProperties {\n         PLATFORM_LIST_RENDERER = PlatformUiSupport.createPlatformListCellRenderer();\n         SpecificationVersion minimalSourceLevel = null;\n         Profile profile = Profile.fromPropertiesString(evaluator.getProperty(J2EE_PLATFORM));\n-        LOGGER.log(Level.INFO, \"init(326) profile: {0}\", profile);\n-        if (Profile.JAKARTA_EE_8_FULL.equals(profile)) {\n-            minimalSourceLevel = new SpecificationVersion(\"1.8\");\n-        } else if (Profile.JAVA_EE_8_FULL.equals(profile)) {\n+\n+        if (Profile.JAKARTA_EE_8_FULL.equals(profile) || Profile.JAVA_EE_8_FULL.equals(profile)) {\n             minimalSourceLevel = new SpecificationVersion(\"1.8\");\n         } else if (Profile.JAVA_EE_7_FULL.equals(profile)) {\n             minimalSourceLevel = new SpecificationVersion(\"1.7\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNTg1MQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554305851", "bodyText": "I read this as the target source level. If NetBeans runs on 8, it gets even worse. The description implies, that a build project should be compatible with Java 1.6, when generated for a JavaEE 6 client profile, this is ensures by the original code, you move all projects to 8.\nIn the area where JavaEE is at home (large companies) I can imaginge setups where indeed Java 1.6 ist the latest installed version.", "author": "matthiasblaesing", "createdAt": "2021-01-09T07:42:22Z", "path": "enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java", "diffHunk": "@@ -544,9 +563,7 @@ private static AntProjectHelper setupProject(FileObject dirFO, String name,\n         String sourceLevel = v.toString();\n         // #89131: these levels are not actually distinct from 1.5.\n         // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n-        if (sourceLevel.equals(\"1.7\")) {\n-            sourceLevel = \"1.6\";\n-        }\n+        // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjMwMDExNA==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562300114", "bodyText": "After a more detailed testing to these validations, the methods were these validations reside are called every time independently of the selected profile. The sourceLevel variable is equal to the Java version that NetBeans is running.\n\nJavaPlatform defaultPlatform = JavaPlatformManager.getDefault().getDefaultPlatform();\nSpecificationVersion v = defaultPlatform.getSpecification().getVersion();\nString sourceLevel = v.toString();\n\nIn a new commit I added some missing validation that sets the correct target source level.", "author": "pepness", "createdAt": "2021-01-22T00:59:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNTg1MQ=="}], "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java b/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java\nindex b7fef6542f..153211e091 100644\n--- a/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java\n+++ b/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java\n\n@@ -564,6 +563,11 @@ public class AppClientProjectGenerator {\n         // #89131: these levels are not actually distinct from 1.5.\n         // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n         // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8\n+        Logger.getLogger(AppClientProjectGenerator.class.getName()).log(Level.INFO, \"setupProject(568) j2eeProfile: {0}\", j2eeProfile);\n+        Logger.getLogger(AppClientProjectGenerator.class.getName()).log(Level.INFO, \"setupProject(569) defaultPlatform: {0}\", defaultPlatform);\n+        Logger.getLogger(AppClientProjectGenerator.class.getName()).log(Level.INFO, \"setupProject(570) SpecificationVersion: {0}\", v);\n+        Logger.getLogger(AppClientProjectGenerator.class.getName()).log(Level.INFO, \"setupProject(571) sourceLevel: {0}\", sourceLevel);\n+        \n         ep.setProperty(AppClientProjectProperties.JAVAC_SOURCE, sourceLevel); // NOI18N\n         ep.setProperty(AppClientProjectProperties.JAVAC_TARGET, sourceLevel); // NOI18N\n         \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNTk5NA==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554305994", "bodyText": "See comment above - probably same situation.", "author": "matthiasblaesing", "createdAt": "2021-01-09T07:43:54Z", "path": "enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java", "diffHunk": "@@ -747,13 +770,10 @@ public void run() {\n                                 if (finalPlatformName == null) {\n                                     finalPlatformName = PreferredProjectPlatform.getPreferredPlatform(JavaPlatform.getDefault().getSpecification().getName()).getDisplayName();\n                                 }\n-\n                                 // #89131: these levels are not actually distinct from 1.5.\n                                 // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n+                                // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8\n                                 String srcLevel = sourceLevel;\n-                                if (sourceLevel.equals(\"1.7\")) {\n-                                    srcLevel = \"1.6\";\n-                                }", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNjEyOA==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554306128", "bodyText": "I would move the PrintWriter also into the resource block of the try-with-resource construct. I don't see a reason to special case it here.", "author": "matthiasblaesing", "createdAt": "2021-01-09T07:45:34Z", "path": "enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java", "diffHunk": "@@ -780,15 +800,15 @@ private static void createManifest(FileObject dir, String path) throws IOExcepti\n             FileObject manifest = FileUtil.createData(dir, path);\n             FileLock lock = manifest.lock();\n             try {\n-                OutputStream os = manifest.getOutputStream(lock);\n-                try {\n-                    PrintWriter pw = new PrintWriter(os);\n+                PrintWriter pw = null;\n+                try (OutputStream os = manifest.getOutputStream(lock)) {", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjI2NDg0Mg==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562264842", "bodyText": "Fixed, thank you.", "author": "pepness", "createdAt": "2021-01-21T23:29:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNjEyOA=="}], "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java b/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java\nindex b7fef6542f..153211e091 100644\n--- a/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java\n+++ b/enterprise/j2ee.clientproject/src/org/netbeans/modules/j2ee/clientproject/api/AppClientProjectGenerator.java\n\n@@ -800,15 +804,10 @@ public class AppClientProjectGenerator {\n             FileObject manifest = FileUtil.createData(dir, path);\n             FileLock lock = manifest.lock();\n             try {\n-                PrintWriter pw = null;\n-                try (OutputStream os = manifest.getOutputStream(lock)) {\n-                    pw = new PrintWriter(os, true);\n+                try (OutputStream os = manifest.getOutputStream(lock); PrintWriter pw = new PrintWriter(os, true)) {\n                     pw.println(\"Manifest-Version: 1.0\"); // NOI18N\n                     pw.println(\"X-COMMENT: Main-Class will be added automatically by build\"); // NOI18N\n                     pw.println(); // safest to end in \\n\\n due to JRE parsing bug\n-                } finally {\n-                    if (pw != null)\n-                        pw.close();\n                 }\n             } finally {\n                 lock.releaseLock();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNjU4Mw==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554306583", "bodyText": "Should this really be logged on INFO level?", "author": "matthiasblaesing", "createdAt": "2021-01-09T07:50:23Z", "path": "enterprise/j2ee.common/src/org/netbeans/modules/j2ee/common/dd/DDHelper.java", "diffHunk": "@@ -81,10 +83,9 @@ public static FileObject createWebXml(Profile j2eeProfile, boolean webXmlRequire\n         } else if (Profile.J2EE_13 == j2eeProfile) {\n             template = \"web-2.3.xml\"; //NOI18N\n         }\n-\n         if (template == null)\n             return null;\n-\n+        Logger.getLogger(DDHelper.class.getName()).log(Level.INFO, \"template: {0}\", template);", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjI2NTQzOQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562265439", "bodyText": "I will remove all added logging, this is just for testing purposes.", "author": "pepness", "createdAt": "2021-01-21T23:30:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNjU4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.common/src/org/netbeans/modules/j2ee/common/dd/DDHelper.java b/enterprise/j2ee.common/src/org/netbeans/modules/j2ee/common/dd/DDHelper.java\nindex 496d7bf640..ac92c6e44c 100644\n--- a/enterprise/j2ee.common/src/org/netbeans/modules/j2ee/common/dd/DDHelper.java\n+++ b/enterprise/j2ee.common/src/org/netbeans/modules/j2ee/common/dd/DDHelper.java\n\n@@ -85,7 +85,7 @@ public class DDHelper {\n         }\n         if (template == null)\n             return null;\n-        Logger.getLogger(DDHelper.class.getName()).log(Level.INFO, \"template: {0}\", template);\n+        Logger.getLogger(DDHelper.class.getName()).log(Level.INFO, \"createWebXml(88) template: {0}\", template);\n         MakeFileCopy action = new MakeFileCopy(RESOURCE_FOLDER + template, dir, \"web.xml\");\n         FileUtil.runAtomicAction(action);\n         if (action.getException() != null)\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzE0NQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307145", "bodyText": "See comments about this above.", "author": "matthiasblaesing", "createdAt": "2021-01-09T07:56:47Z", "path": "enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java", "diffHunk": "@@ -489,9 +503,7 @@ private static AntProjectHelper setupProject(FileObject dirFO, String name,\n         SpecificationVersion v = defaultPlatform.getSpecification().getVersion();\n         String sourceLevel = v.toString();\n         // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n-        if (sourceLevel.equals(\"1.7\")) {\n-            sourceLevel = \"1.6\";\n-        }\n+        // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java b/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java\nindex 9348550e1b..3fbb742ce1 100644\n--- a/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java\n+++ b/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java\n\n@@ -504,6 +506,11 @@ public class EjbJarProjectGenerator {\n         String sourceLevel = v.toString();\n         // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n         // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8\n+        \n+        Logger.getLogger(EjbJarProjectGenerator.class.getName()).log(Level.INFO, \"defaultPlatform: {0}\", defaultPlatform);\n+        Logger.getLogger(EjbJarProjectGenerator.class.getName()).log(Level.INFO, \"SpecificationVersion: {0}\", v);\n+        Logger.getLogger(EjbJarProjectGenerator.class.getName()).log(Level.INFO, \"sourceLevel: {0}\", sourceLevel);\n+        \n         ep.setProperty(EjbJarProjectProperties.JAVAC_SOURCE, sourceLevel); //NOI18N\n         ep.setProperty(EjbJarProjectProperties.JAVAC_TARGET, sourceLevel); //NOI18N\n         \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzIzNw==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307237", "bodyText": "Please add curly braces. In this case it costs one additional line and makes it IMHO clearer what goes on.", "author": "matthiasblaesing", "createdAt": "2021-01-09T07:58:06Z", "path": "enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java", "diffHunk": "@@ -174,16 +176,26 @@ public Void run() throws Exception {\n             Exceptions.printStackTrace(ex.getException());\n         }\n         \n-        // create ejb-jar.xml\n+        // Create ejb-jar.xml just for J2EE (1.3 and 1.4)\n         Profile profile = createData.getJavaEEProfile();\n-        if (!Profile.JAVA_EE_5.equals(profile) && !Profile.JAVA_EE_6_FULL.equals(profile) && !Profile.JAVA_EE_6_WEB.equals(profile) &&\n-                !Profile.JAVA_EE_7_FULL.equals(profile) && !Profile.JAVA_EE_7_WEB.equals(profile)) {\n-            String resource = \"org-netbeans-modules-j2ee-ejbjarproject/ejb-jar-2.1.xml\";\n+        boolean isJ2EE = false;\n+\n+        if(profile.equals(Profile.J2EE_14) || profile.equals(Profile.J2EE_13)) {\n+            isJ2EE = true;\n+        }\n+        if(isJ2EE) {\n+            String resource;\n+            if(profile.equals(Profile.J2EE_14))\n+                resource = \"org-netbeans-modules-j2ee-ejbjarproject/ejb-jar-2.1.xml\";\n+            else\n+                resource = \"org-netbeans-modules-j2ee-ejbjarproject/ejb-jar-2.0.xml\";", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjI3MDE3MQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562270171", "bodyText": "Done", "author": "pepness", "createdAt": "2021-01-21T23:43:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzIzNw=="}], "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java b/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java\nindex 9348550e1b..3fbb742ce1 100644\n--- a/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java\n+++ b/enterprise/j2ee.ejbjarproject/src/org/netbeans/modules/j2ee/ejbjarproject/api/EjbJarProjectGenerator.java\n\n@@ -185,11 +187,11 @@ public class EjbJarProjectGenerator {\n         }\n         if(isJ2EE) {\n             String resource;\n-            if(profile.equals(Profile.J2EE_14))\n+            if(profile.equals(Profile.J2EE_14)) {\n                 resource = \"org-netbeans-modules-j2ee-ejbjarproject/ejb-jar-2.1.xml\";\n-            else\n+            } else {\n                 resource = \"org-netbeans-modules-j2ee-ejbjarproject/ejb-jar-2.0.xml\";\n-\n+            }\n             FileObject ddFile = FileUtil.copyFile(FileUtil.getConfigFile(resource), confRoot, \"ejb-jar\"); //NOI18N\n             EjbJar ejbJar = DDProvider.getDefault().getDDRoot(ddFile);\n             ejbJar.setDisplayName(name);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzQxMQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307411", "bodyText": "The parameter is not necessary. If an exception is present, it will be logged with message, no need to for the placeholder.", "author": "matthiasblaesing", "createdAt": "2021-01-09T08:00:12Z", "path": "enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/ProjectEar.java", "diffHunk": "@@ -885,7 +924,7 @@ public void artifactsUpdated(Iterable<Artifact> artifacts) {\n                     try {\n                         FileUtil.createData(destFile);\n                     } catch (IOException ex) {\n-                        LOGGER.log(Level.INFO, \"Could not prepare data file\", ex);\n+                        LOGGER.log(Level.INFO, \"Could not prepare data file {0}\", ex);", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2Mjc3MjA2Ng==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562772066", "bodyText": "Fixed it. Thanks.", "author": "pepness", "createdAt": "2021-01-22T17:02:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzQxMQ=="}], "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/ProjectEar.java b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/ProjectEar.java\nindex 96fd204e6a..3541dfa99e 100644\n--- a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/ProjectEar.java\n+++ b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/ProjectEar.java\n\n@@ -924,7 +924,7 @@ public final class ProjectEar extends J2eeApplicationProvider\n                     try {\n                         FileUtil.createData(destFile);\n                     } catch (IOException ex) {\n-                        LOGGER.log(Level.INFO, \"Could not prepare data file {0}\", ex);\n+                        LOGGER.log(Level.INFO, \"Could not prepare data file\", ex);\n                         continue;\n                     }\n                     recomputed.add(artifact.distributionPath(destFile));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzUwMA==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307500", "bodyText": "See my other comments about this.", "author": "matthiasblaesing", "createdAt": "2021-01-09T08:01:21Z", "path": "enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java", "diffHunk": "@@ -600,16 +599,17 @@ public static void setPlatformSourceLevel(final AntProjectHelper helper, final S\n         }\n         try {\n             projectDir.getFileSystem().runAtomicAction(new AtomicAction() {\n+                @Override\n                 public void run() throws IOException {\n                     ProjectManager.mutex().writeAccess(new Runnable() {\n+                        @Override\n                         public void run() {\n                             try {\n                                 EditableProperties ep = helper.getProperties(AntProjectHelper.PROJECT_PROPERTIES_PATH);\n                                 // #89131: these levels are not actually distinct from 1.5.\n                                 String srcLevel = sourceLevel;\n                                 // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n-                                if (sourceLevel.equals(\"1.7\"))\n-                                    srcLevel = \"1.6\";\n+                                // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\nindex 95fbe05671..4c4b5c94ae 100644\n--- a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\n+++ b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\n\n@@ -605,6 +628,7 @@ public final class EarProjectGenerator {\n                         @Override\n                         public void run() {\n                             try {\n+                                Logger.getLogger(EarProjectGenerator.class.getName()).log(Level.INFO, \"setPlatformSourceLevel(631) sourceLevel: {0}\", sourceLevel);\n                                 EditableProperties ep = helper.getProperties(AntProjectHelper.PROJECT_PROPERTIES_PATH);\n                                 // #89131: these levels are not actually distinct from 1.5.\n                                 String srcLevel = sourceLevel;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzU4MQ==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307581", "bodyText": "This is several places - I saw a source level defined in one of the classes touched by this PR, why is that not used?", "author": "matthiasblaesing", "createdAt": "2021-01-09T08:02:22Z", "path": "enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java", "diffHunk": "@@ -543,8 +543,7 @@ private AntProjectHelper setupProject() throws IOException {\n             srcLevel = v.toString();\n             // #89131: these levels are not actually distinct from 1.5.\n             // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n-            if (srcLevel.equals(\"1.7\"))\n-                srcLevel = \"1.6\";", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\nindex 95fbe05671..4c4b5c94ae 100644\n--- a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\n+++ b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\n\n@@ -537,6 +556,7 @@ public final class EarProjectGenerator {\n         ep.setProperty(EarProjectProperties.J2EE_DEPLOY_ON_SAVE, DeployOnSaveUtils.isDeployOnSaveSupported(serverInstanceID));\n \n         String srcLevel = sourceLevel;\n+        Logger.getLogger(EarProjectGenerator.class.getName()).log(Level.INFO, \"setupProject(559) srcLevel: {0}\", srcLevel);\n         if (srcLevel == null) {\n             JavaPlatform defaultPlatform = JavaPlatformManager.getDefault().getDefaultPlatform();\n             SpecificationVersion v = defaultPlatform.getSpecification().getVersion();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzYwMg==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307602", "bodyText": "And source level again.", "author": "matthiasblaesing", "createdAt": "2021-01-09T08:02:37Z", "path": "enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java", "diffHunk": "@@ -111,8 +109,7 @@ private EarProjectGenerator(File prjDir, FileObject prjDirFO, String name, Profi\n         this.j2eeProfile = j2eeProfile;\n         this.serverInstanceID = serverInstanceID;\n         // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n-        if (sourceLevel != null && (sourceLevel.equals(\"1.7\")))\n-            sourceLevel = \"1.6\";", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\nindex 95fbe05671..4c4b5c94ae 100644\n--- a/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\n+++ b/enterprise/j2ee.earproject/src/org/netbeans/modules/j2ee/earproject/EarProjectGenerator.java\n\n@@ -110,6 +109,8 @@ public final class EarProjectGenerator {\n         this.serverInstanceID = serverInstanceID;\n         // #181215: JDK 6 should be the default source/binary format for Java EE 6 projects\n         // #181215: Not neccessary anymore because NetBeans should run on minimum JDK 8\n+        Logger.getLogger(EarProjectGenerator.class.getName()).log(Level.INFO, \"EarProjectGenerator(112) j2eeProfile: {0}\", j2eeProfile);\n+        Logger.getLogger(EarProjectGenerator.class.getName()).log(Level.INFO, \"EarProjectGenerator(113) sourceLevel: {0}\", sourceLevel);\n         this.sourceLevel = sourceLevel;\n         this.librariesDefinition = librariesDefinition;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzg4Nw==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r554307887", "bodyText": "I think this should have been a delete - the word \"bean\" and the word \"root\" in the first position of the documentation are superfluous.", "author": "matthiasblaesing", "createdAt": "2021-01-09T08:05:50Z", "path": "enterprise/j2ee.dd/src/org/netbeans/modules/j2ee/dd/api/common/RootInterface.java", "diffHunk": "@@ -69,7 +70,7 @@\n      *\t\tMERGE_UNION is \tG1 U G2 <=> G1 + E2\n      *\t\tMERGE_INTERSECT is\tG1 n G2 <=> (G1 U G2) - E1 - E2\n      *</pre>\n-     * @param bean root of the bean graph that is merged with actual bean graph\n+     * @param root root of the bean graph that is merged with actual bean graph", "originalCommit": "a2c1ccf237e8a9ffc71e07b63e32913a330ce224", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MjI3MDI5Mw==", "url": "https://github.com/apache/netbeans/pull/2491#discussion_r562270293", "bodyText": "Done.", "author": "pepness", "createdAt": "2021-01-21T23:43:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDMwNzg4Nw=="}], "type": "inlineReview", "revised_code": {"commit": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "chunk": "diff --git a/enterprise/j2ee.dd/src/org/netbeans/modules/j2ee/dd/api/common/RootInterface.java b/enterprise/j2ee.dd/src/org/netbeans/modules/j2ee/dd/api/common/RootInterface.java\nindex fd831f454e..a943b7d24f 100644\n--- a/enterprise/j2ee.dd/src/org/netbeans/modules/j2ee/dd/api/common/RootInterface.java\n+++ b/enterprise/j2ee.dd/src/org/netbeans/modules/j2ee/dd/api/common/RootInterface.java\n\n@@ -70,7 +70,7 @@ public interface RootInterface extends ComponentInterface {\n      *\t\tMERGE_UNION is \tG1 U G2 <=> G1 + E2\n      *\t\tMERGE_INTERSECT is\tG1 n G2 <=> (G1 U G2) - E1 - E2\n      *</pre>\n-     * @param root root of the bean graph that is merged with actual bean graph\n+     * @param root of the bean graph that is merged with actual bean graph\n      * @param mode type of merging (INTERSECT, UNION, UPDATE)\n      */\n     public void merge(RootInterface root, int mode);\n"}}, {"oid": "fdb2a143e90bea83aee7b8d15520415c399da5e1", "url": "https://github.com/apache/netbeans/commit/fdb2a143e90bea83aee7b8d15520415c399da5e1", "message": "Add logging for testing purposes", "committedDate": "2021-01-21T20:22:14Z", "type": "forcePushed"}, {"oid": "0666f3130316e0ad0473748ef632f05639916c60", "url": "https://github.com/apache/netbeans/commit/0666f3130316e0ad0473748ef632f05639916c60", "message": "Remove logging", "committedDate": "2021-03-18T04:28:30Z", "type": "forcePushed"}, {"oid": "89d0a03dcd37a7c5f2019b402c33684dcecd3104", "url": "https://github.com/apache/netbeans/commit/89d0a03dcd37a7c5f2019b402c33684dcecd3104", "message": "Improve JakartaEE8/JAVAEE8 support with Ant\n\n-Add support for app-client version 8 when using ant\n-Add methods that detect support for CDI 1.0 and CDI 2.0\n-Add missing resource and license file\n-Add missing deployment descriptor for JEE 8\n-Add missing validations for JDK 11, 8, and 7\n-Remove use of deprecated method \"getServerID\" in one class\n-Remove unnecessary validation that checks if running JDK 7\n-Remove use of deprecated method \".getDefault().getJ2eePlatform\"\n-Use try-with-resources\n-Fix memory leak by closing the PrintWriter\n-Add missing validations for JEE7 and higher\n-Remove unnecessary use of Integer constructor\n-Fix wrong way of comparing Integers\n-Remove unnecessary assignment inside an if condition\n-Add missing validations for EAR applications\n-Wrong profile for JAKARTA_EE_8_FULL\n-Add missing version for JEE 8\n-Add missing validation for JEE8 Application\n-Add missing validation for EJB 3.2\n-Add validation for WebFragment 3.1\n-Add missing MIME_PREFIX for JEE 8\n-Add missing validations for JakartaEE8\n-Change logic to define isEE6Plus variable\n-New logic to evaluate when J2EE is used\n-New logic to evaluate the profile to use\n-Change mdd files to implement and extend local classes\n-Add 1 TODO\n-Update javac.source and compilerargs properties in some Java EE modules\n-Cleanup:\n-Add @Override tags and other small fixes\n-Remove unnecessary parameter in a logging sentence\n-Remove redundant word in javadoc\n-Add curly braces and align code for better readability", "committedDate": "2021-03-19T18:35:00Z", "type": "commit"}, {"oid": "89d0a03dcd37a7c5f2019b402c33684dcecd3104", "url": "https://github.com/apache/netbeans/commit/89d0a03dcd37a7c5f2019b402c33684dcecd3104", "message": "Improve JakartaEE8/JAVAEE8 support with Ant\n\n-Add support for app-client version 8 when using ant\n-Add methods that detect support for CDI 1.0 and CDI 2.0\n-Add missing resource and license file\n-Add missing deployment descriptor for JEE 8\n-Add missing validations for JDK 11, 8, and 7\n-Remove use of deprecated method \"getServerID\" in one class\n-Remove unnecessary validation that checks if running JDK 7\n-Remove use of deprecated method \".getDefault().getJ2eePlatform\"\n-Use try-with-resources\n-Fix memory leak by closing the PrintWriter\n-Add missing validations for JEE7 and higher\n-Remove unnecessary use of Integer constructor\n-Fix wrong way of comparing Integers\n-Remove unnecessary assignment inside an if condition\n-Add missing validations for EAR applications\n-Wrong profile for JAKARTA_EE_8_FULL\n-Add missing version for JEE 8\n-Add missing validation for JEE8 Application\n-Add missing validation for EJB 3.2\n-Add validation for WebFragment 3.1\n-Add missing MIME_PREFIX for JEE 8\n-Add missing validations for JakartaEE8\n-Change logic to define isEE6Plus variable\n-New logic to evaluate when J2EE is used\n-New logic to evaluate the profile to use\n-Change mdd files to implement and extend local classes\n-Add 1 TODO\n-Update javac.source and compilerargs properties in some Java EE modules\n-Cleanup:\n-Add @Override tags and other small fixes\n-Remove unnecessary parameter in a logging sentence\n-Remove redundant word in javadoc\n-Add curly braces and align code for better readability", "committedDate": "2021-03-19T18:35:00Z", "type": "forcePushed"}]}