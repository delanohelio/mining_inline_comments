{"pr_number": 2579, "pr_title": "Avoid to call add/addAll on a potentially unmodified collection", "pr_createdAt": "2020-12-04T17:28:51Z", "pr_url": "https://github.com/apache/netbeans/pull/2579", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3NzE3Nw==", "url": "https://github.com/apache/netbeans/pull/2579#discussion_r536377177", "bodyText": "Minimal nitpick: The other branches of the conditional add their result to the list, that is initialized in line 66. Would it be an option to use the same approach here? If not, this is ok, just indicate so.", "author": "matthiasblaesing", "createdAt": "2020-12-04T21:01:22Z", "path": "platform/core.network/src/org/netbeans/core/network/proxy/NbProxySelector.java", "diffHunk": "@@ -145,7 +145,7 @@ public NbProxySelector() {\n             case ProxySettings.AUTO_DETECT_PAC:\n                 if (useSystemProxies ()) {\n                     if (original != null) {\n-                        res = original.select(uri);                   \n+                        res = new ArrayList<>(original.select(uri));", "originalCommit": "aee4f0bb789ef6526230f28af18795dce5b2bbd0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjg0MDYyMA==", "url": "https://github.com/apache/netbeans/pull/2579#discussion_r536840620", "bodyText": "Yes, it makes sense: now all uses of res variable just add items to it.", "author": "digiovinazzo", "createdAt": "2020-12-05T18:20:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjM3NzE3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "3914fb5c870453bfa8a93b41e70c5c07523ba0b7", "chunk": "diff --git a/platform/core.network/src/org/netbeans/core/network/proxy/NbProxySelector.java b/platform/core.network/src/org/netbeans/core/network/proxy/NbProxySelector.java\nindex 69b412e0b4..81439840d3 100644\n--- a/platform/core.network/src/org/netbeans/core/network/proxy/NbProxySelector.java\n+++ b/platform/core.network/src/org/netbeans/core/network/proxy/NbProxySelector.java\n\n@@ -145,7 +145,7 @@ public final class NbProxySelector extends ProxySelector {\n             case ProxySettings.AUTO_DETECT_PAC:\n                 if (useSystemProxies ()) {\n                     if (original != null) {\n-                        res = new ArrayList<>(original.select(uri));\n+                        res.addAll(original.select(uri));\n                     }\n                 } else {\n                     ProxyAutoConfig pac = ProxyAutoConfig.get(getPacFile());\n"}}, {"oid": "3914fb5c870453bfa8a93b41e70c5c07523ba0b7", "url": "https://github.com/apache/netbeans/commit/3914fb5c870453bfa8a93b41e70c5c07523ba0b7", "message": "Fix bug when adding to the potentially unmodifiable collection returned by original.select(URI).\n\nAlso always add to the res variable created at the beginning of the method.", "committedDate": "2020-12-05T18:16:48Z", "type": "commit"}, {"oid": "3914fb5c870453bfa8a93b41e70c5c07523ba0b7", "url": "https://github.com/apache/netbeans/commit/3914fb5c870453bfa8a93b41e70c5c07523ba0b7", "message": "Fix bug when adding to the potentially unmodifiable collection returned by original.select(URI).\n\nAlso always add to the res variable created at the beginning of the method.", "committedDate": "2020-12-05T18:16:48Z", "type": "forcePushed"}]}