{"pr_number": 2080, "pr_title": "NETBEANS-4176-Unescape javadoc title after parsing", "pr_createdAt": "2020-04-15T15:56:44Z", "pr_url": "https://github.com/apache/netbeans/pull/2080", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjg1Ng==", "url": "https://github.com/apache/netbeans/pull/2080#discussion_r410722856", "bodyText": "Please use try-with-resource.", "author": "matthiasblaesing", "createdAt": "2020-04-18T16:59:55Z", "path": "java/javadoc/test/unit/src/org/netbeans/modules/javadoc/search/IndexBuilderTest.java", "diffHunk": "@@ -137,6 +137,19 @@ public void testMissingTitle() throws Exception {\n             is.close();\n         }\n     }\n+    \n+    public void testEscapedHtmlTitle() throws Exception {\n+        String content = \"<HTML><HEAD><TITLE>Overview (Java SE 11 &amp; JDK 11 )</TITLE></HEAD></HTML>\";\n+        InputStream is = new ByteArrayInputStream(content.getBytes());\n+        SimpleTitleParser tp = new SimpleTitleParser(is);\n+        try {", "originalCommit": "5c54547685d2bbc902fdee576871f2f8850062d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDgyMDM3Mg==", "url": "https://github.com/apache/netbeans/pull/2080#discussion_r410820372", "bodyText": "@matthiasblaesing  I am implementing AutoClosable on SimpleTitleParser as suggested.", "author": "Rahul-khandelwal", "createdAt": "2020-04-19T05:23:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjg1Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDgzMjY0Ng==", "url": "https://github.com/apache/netbeans/pull/2080#discussion_r410832646", "bodyText": "Implemented AutoClosable on SimpleTitleParser", "author": "Rahul-khandelwal", "createdAt": "2020-04-19T06:42:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjg1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "0f249316e9b2bdab24b312d4b817f7a541ac68c0", "chunk": "diff --git a/java/javadoc/test/unit/src/org/netbeans/modules/javadoc/search/IndexBuilderTest.java b/java/javadoc/test/unit/src/org/netbeans/modules/javadoc/search/IndexBuilderTest.java\nindex eb44b0f1dd..951c05a6d3 100644\n--- a/java/javadoc/test/unit/src/org/netbeans/modules/javadoc/search/IndexBuilderTest.java\n+++ b/java/javadoc/test/unit/src/org/netbeans/modules/javadoc/search/IndexBuilderTest.java\n\n@@ -59,95 +59,77 @@ public class IndexBuilderTest extends NbTestCase {\n     public void testTitleInJDK14() throws Exception {\n         FileObject html = fs.findResource(JDK14_INDEX_PATH + \"/index-4.html\");\n \n-        InputStream is = new BufferedInputStream(html.getInputStream(), 1024);\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        try (InputStream is = new BufferedInputStream(html.getInputStream(), 1024)) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertEquals(\"wrong title\", \"D-Index (Java 2 Platform SE v1.4.2)\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n \n     public void testTitleInJDK15() throws Exception {\n         FileObject html = fs.findResource(JDK15_INDEX_PATH + \"/index-4.html\");\n \n-        InputStream is = new BufferedInputStream(html.getInputStream(), 1024);\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        try (InputStream is = new BufferedInputStream(html.getInputStream(), 1024)) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertEquals(\"wrong title\", \"D-Index (Java 2 Platform SE 5.0)\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n     \n     public void testTitleInJDK7() throws Exception {\n         FileObject html = fs.findResource(JDK7_INDEX_PATH + \"/index-4.html\");\n \n-        InputStream is = new BufferedInputStream(html.getInputStream(), 1024);\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        try (InputStream is = new BufferedInputStream(html.getInputStream(), 1024)) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertEquals(\"wrong title\", \"D-Index (Java Platform SE 7 )\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n     \n     public void testTitleInJDK8() throws Exception {\n         FileObject html = fs.findResource(JDK8_INDEX_PATH + \"/index-4.html\");\n \n-        InputStream is = new BufferedInputStream(html.getInputStream(), 1024);\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        try (InputStream is = new BufferedInputStream(html.getInputStream(), 1024)) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertEquals(\"wrong title\", \"D-Index (Java Platform SE 8 )\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n \n     public void testEmptyTitle() throws Exception {\n         String content = \"<HTML><HEAD><TITLE></TITLE></HEAD></HTML>\";\n-        InputStream is = new ByteArrayInputStream(content.getBytes());\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        \n+        try (InputStream is = new ByteArrayInputStream(content.getBytes())) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertEquals(\"wrong title\", \"\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n \n     public void testMissingTitle() throws Exception {\n         String content = \"<HTML><HEAD></HEAD></HTML>\";\n-        InputStream is = new ByteArrayInputStream(content.getBytes());\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        \n+        try (InputStream is = new ByteArrayInputStream(content.getBytes())) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertNull(\"wrong title\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n     \n     public void testEscapedHtmlTitle() throws Exception {\n         String content = \"<HTML><HEAD><TITLE>Overview (Java SE 11 &amp; JDK 11 )</TITLE></HEAD></HTML>\";\n-        InputStream is = new ByteArrayInputStream(content.getBytes());\n-        SimpleTitleParser tp = new SimpleTitleParser(is);\n-        try {\n+        \n+        try (InputStream is = new ByteArrayInputStream(content.getBytes())) {\n+            SimpleTitleParser tp = new SimpleTitleParser(is);\n             tp.parse();\n             String titlestr = tp.getTitle();\n             assertEquals(\"wrong title\", \"Java SE 11 & JDK 11\", titlestr);\n-        } finally {\n-            is.close();\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjk0Nw==", "url": "https://github.com/apache/netbeans/pull/2080#discussion_r410722947", "bodyText": "The NOI18N comment does not belong here, the comment is IMHO unnecessary, as \"unescapeHTML\" is pretty self-explaining.", "author": "matthiasblaesing", "createdAt": "2020-04-18T17:01:02Z", "path": "java/javadoc/src/org/netbeans/modules/javadoc/search/IndexBuilder.java", "diffHunk": "@@ -417,6 +418,12 @@ private void handleTitleTag() throws IOException {\n                             } else {\n                                 title = new String(buf, 0, offset - 7, charset).trim();\n                             }\n+                            \n+                            // Unescape the title, done for JDK 11.\n+                            // JDK 11 title contains &amp;\n+                            // NOI18N", "originalCommit": "5c54547685d2bbc902fdee576871f2f8850062d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDgxNDA4Nw==", "url": "https://github.com/apache/netbeans/pull/2080#discussion_r410814087", "bodyText": "I am fixing it.", "author": "Rahul-khandelwal", "createdAt": "2020-04-19T04:43:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjk0Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDgzMjc0Mw==", "url": "https://github.com/apache/netbeans/pull/2080#discussion_r410832743", "bodyText": "Removed NOI18N comment.", "author": "Rahul-khandelwal", "createdAt": "2020-04-19T06:43:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDcyMjk0Nw=="}], "type": "inlineReview", "revised_code": {"commit": "0f249316e9b2bdab24b312d4b817f7a541ac68c0", "chunk": "diff --git a/java/javadoc/src/org/netbeans/modules/javadoc/search/IndexBuilder.java b/java/javadoc/src/org/netbeans/modules/javadoc/search/IndexBuilder.java\nindex 71ba30babf..7633d603c9 100644\n--- a/java/javadoc/src/org/netbeans/modules/javadoc/search/IndexBuilder.java\n+++ b/java/javadoc/src/org/netbeans/modules/javadoc/search/IndexBuilder.java\n\n@@ -420,8 +415,7 @@ public class IndexBuilder implements Runnable, ChangeListener {\n                             }\n                             \n                             // Unescape the title, done for JDK 11.\n-                            // JDK 11 title contains &amp;\n-                            // NOI18N\n+                            // JDK 11 title contains &amp; (NETBEANS-4176)\n                             title = StringEscapeUtils.unescapeHtml(title);\n                             \n                             return;\n"}}, {"oid": "b2c9015debaad178d78b51bbf5eba888a41af06b", "url": "https://github.com/apache/netbeans/commit/b2c9015debaad178d78b51bbf5eba888a41af06b", "message": "[NETBEANS-4176] Unescape javadoc title after parsing\n\nJavadoc title for JDK 11 contains &amp;.\nWe are fixing that in this commit.", "committedDate": "2020-04-19T04:31:00Z", "type": "forcePushed"}, {"oid": "0f249316e9b2bdab24b312d4b817f7a541ac68c0", "url": "https://github.com/apache/netbeans/commit/0f249316e9b2bdab24b312d4b817f7a541ac68c0", "message": "[NETBEANS-4176] Unescape javadoc title after parsing\n\nFix javadoc title for JDK 11 which contains &amp;.\nUse try with resources on InputStream passed to SimpleTitleParser.", "committedDate": "2020-04-20T02:43:48Z", "type": "commit"}, {"oid": "0f249316e9b2bdab24b312d4b817f7a541ac68c0", "url": "https://github.com/apache/netbeans/commit/0f249316e9b2bdab24b312d4b817f7a541ac68c0", "message": "[NETBEANS-4176] Unescape javadoc title after parsing\n\nFix javadoc title for JDK 11 which contains &amp;.\nUse try with resources on InputStream passed to SimpleTitleParser.", "committedDate": "2020-04-20T02:43:48Z", "type": "forcePushed"}]}