{"pr_number": 2550, "pr_title": "[NETBEANS-5048] PHP - cancel Find Usages action", "pr_createdAt": "2020-11-21T05:57:52Z", "pr_url": "https://github.com/apache/netbeans/pull/2550", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI2OTI3MA==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528269270", "bodyText": "Maybe, need not this. cancelled is used only here at the moment, but I think we should keep the cancelled state.", "author": "junichi11", "createdAt": "2020-11-22T02:05:50Z", "path": "php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java", "diffHunk": "@@ -63,6 +64,10 @@ public Problem prepare(final RefactoringElementsBag elementsBag) {\n                 if (fileObject == null) {\n                     continue;\n                 }\n+                if (cancelled) {\n+                    cancelled = false;", "originalCommit": "1620299a662aa621e719b142b3be755efdac718b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI4ODI2OQ==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528288269", "bodyText": "If state is left, then it is impossible to repeat action by clicking green arrows in Usages window.", "author": "KacerCZ", "createdAt": "2020-11-22T06:09:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI2OTI3MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI4OTUyOQ==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528289529", "bodyText": "Ah, I see. You are right. Thanks.", "author": "junichi11", "createdAt": "2020-11-22T06:23:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI2OTI3MA=="}], "type": "inlineReview", "revised_code": {"commit": "41c0624385e59a4eee957db6e941e12a67fdbc3f", "chunk": "diff --git a/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java b/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java\nindex ff7e18bf09..6ec637cde6 100644\n--- a/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java\n+++ b/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java\n\n@@ -65,6 +65,7 @@ public class PhpWhereUsedQueryPlugin extends ProgressProviderAdapter implements\n                     continue;\n                 }\n                 if (cancelled) {\n+                    // Reset cancelled state for repeated search to work.\n                     cancelled = false;\n                     break;\n                 }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI5MDk0Mg==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528290942", "bodyText": "@tmysik Instead, should use AtomicBoolean.compareAndSet()?", "author": "junichi11", "createdAt": "2020-11-22T06:40:35Z", "path": "php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java", "diffHunk": "@@ -63,6 +64,10 @@ public Problem prepare(final RefactoringElementsBag elementsBag) {\n                 if (fileObject == null) {\n                     continue;\n                 }\n+                if (cancelled) {", "originalCommit": "1620299a662aa621e719b142b3be755efdac718b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI5MjQ1Mg==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528292452", "bodyText": "We should leave a comment about why we change it to false.", "author": "junichi11", "createdAt": "2020-11-22T06:58:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI5MDk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODMxNzAyOA==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528317028", "bodyText": "Added comment why cancelled is reset.\nFor cancelled I used same type as in OccurencesFinderImpl in PHP Editor:\n\n  \n    \n      netbeans/php/php.editor/src/org/netbeans/modules/php/editor/csl/OccurrencesFinderImpl.java\n    \n    \n         Line 62\n      in\n      514e170\n    \n    \n    \n    \n\n        \n          \n           private volatile boolean cancelled;", "author": "KacerCZ", "createdAt": "2020-11-22T10:51:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI5MDk0Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODM5NTQ4OA==", "url": "https://github.com/apache/netbeans/pull/2550#discussion_r528395488", "bodyText": "Volatile is OK here, IMHO.", "author": "tmysik", "createdAt": "2020-11-22T19:52:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyODI5MDk0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "41c0624385e59a4eee957db6e941e12a67fdbc3f", "chunk": "diff --git a/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java b/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java\nindex ff7e18bf09..6ec637cde6 100644\n--- a/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java\n+++ b/php/php.refactoring/src/org/netbeans/modules/refactoring/php/findusages/PhpWhereUsedQueryPlugin.java\n\n@@ -65,6 +65,7 @@ public class PhpWhereUsedQueryPlugin extends ProgressProviderAdapter implements\n                     continue;\n                 }\n                 if (cancelled) {\n+                    // Reset cancelled state for repeated search to work.\n                     cancelled = false;\n                     break;\n                 }\n"}}, {"oid": "41c0624385e59a4eee957db6e941e12a67fdbc3f", "url": "https://github.com/apache/netbeans/commit/41c0624385e59a4eee957db6e941e12a67fdbc3f", "message": "[NETBEANS-5048] PHP - cancel Find Usages action\n\nhttps://issues.apache.org/jira/browse/NETBEANS-5048\n\nAllows to cancel Find Usages action in PHP editor.", "committedDate": "2020-11-22T10:46:42Z", "type": "commit"}, {"oid": "41c0624385e59a4eee957db6e941e12a67fdbc3f", "url": "https://github.com/apache/netbeans/commit/41c0624385e59a4eee957db6e941e12a67fdbc3f", "message": "[NETBEANS-5048] PHP - cancel Find Usages action\n\nhttps://issues.apache.org/jira/browse/NETBEANS-5048\n\nAllows to cancel Find Usages action in PHP editor.", "committedDate": "2020-11-22T10:46:42Z", "type": "forcePushed"}]}