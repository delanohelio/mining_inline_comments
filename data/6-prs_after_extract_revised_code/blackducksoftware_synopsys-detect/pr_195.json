{"pr_number": 195, "pr_title": "Go mod replace implementations", "pr_createdAt": "2020-06-19T14:20:24Z", "pr_url": "https://github.com/blackducksoftware/synopsys-detect/pull/195", "timeline": [{"oid": "d7e66a9697a908269e0b1f64a51b49eb04142ba2", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/d7e66a9697a908269e0b1f64a51b49eb04142ba2", "message": "feat: Introduced second implementation for gomod replace", "committedDate": "2020-06-18T20:12:34Z", "type": "commit"}, {"oid": "229e4a7239e9f7338e41760ec6ec83aac07c20d5", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/229e4a7239e9f7338e41760ec6ec83aac07c20d5", "message": "style: Added comment", "committedDate": "2020-06-18T20:17:29Z", "type": "commit"}, {"oid": "0896970031bc8cac0e79d0ae2eac46624be921ce", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/0896970031bc8cac0e79d0ae2eac46624be921ce", "message": "fix: Accounted for unusual component versions", "committedDate": "2020-06-18T20:45:02Z", "type": "commit"}, {"oid": "0b9ae0a2430d3a3b8d06bd6d662901b0194dc822", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/0b9ae0a2430d3a3b8d06bd6d662901b0194dc822", "message": "feat: Added third implementation for replacement data extractor", "committedDate": "2020-06-18T21:26:17Z", "type": "commit"}, {"oid": "9561126e26ae067c7e9bb5099e1e62abd9d8d065", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/9561126e26ae067c7e9bb5099e1e62abd9d8d065", "message": "feat: Added catches for JsonSyntaxExceptions from gson", "committedDate": "2020-06-18T21:34:57Z", "type": "commit"}, {"oid": "e2e04abd81ea3b501d7480d716d03f7e3a3b09e9", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/e2e04abd81ea3b501d7480d716d03f7e3a3b09e9", "message": "fix: Adjusted test to account for change to extractor B", "committedDate": "2020-06-19T14:29:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDQwODc0NQ==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/195#discussion_r450408745", "bodyText": "I prefer replacementDataExtractorC but he should return the replacement map (and not be passed a shared map).\nMap<String, String> replacementData = replacementDataExtractorC.extractReplacementData(listUJsonOutput);", "author": "taikuukaits", "createdAt": "2020-07-06T18:35:32Z", "path": "detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/gomod/GoModCliExtractor.java", "diffHunk": "@@ -78,20 +80,8 @@ public Extraction extract(final File directory, final File goExe) {\n \n     private List<String> modGraphOutputWithReplacements(File directory, File goExe, List<String> listUJsonOutput) throws ExecutableRunnerException, DetectableException {\n         final List<String> modGraphOutput = execute(directory, goExe, \"Querying for the go mod graph failed:\", \"mod\", \"graph\");\n-        String jsonString = convertOutputToJsonString(listUJsonOutput);\n-\n-        Type goListUJsonEntryType = new TypeToken<List<GoListUJsonData>>() {}.getType();\n-        List<GoListUJsonData> data = gson.fromJson(jsonString, goListUJsonEntryType);\n \n-        for (final GoListUJsonData entry : data) {\n-            ReplaceData replace = entry.getReplace();\n-            if (replace != null) {\n-                String path = entry.getPath();\n-                String originalVersion = entry.getVersion();\n-                String replaceVersion = replace.getVersion();\n-                replacementData.put(String.format(\"%s@%s\", path, originalVersion), String.format(\"%s@%s\", path, replaceVersion));\n-            }\n-        }\n+        replacementDataExtractorC.extractReplacementData(listUJsonOutput);", "originalCommit": "e2e04abd81ea3b501d7480d716d03f7e3a3b09e9", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "ce69409964f8cc6af2be9eae7c93e261f7149112", "chunk": "diff --git a/detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/gomod/GoModCliExtractor.java b/detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/gomod/GoModCliExtractor.java\nindex b21f21d96..ccc3bc96e 100644\n--- a/detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/gomod/GoModCliExtractor.java\n+++ b/detectable/src/main/java/com/synopsys/integration/detectable/detectables/go/gomod/GoModCliExtractor.java\n\n@@ -81,7 +78,7 @@ public class GoModCliExtractor {\n     private List<String> modGraphOutputWithReplacements(File directory, File goExe, List<String> listUJsonOutput) throws ExecutableRunnerException, DetectableException {\n         final List<String> modGraphOutput = execute(directory, goExe, \"Querying for the go mod graph failed:\", \"mod\", \"graph\");\n \n-        replacementDataExtractorC.extractReplacementData(listUJsonOutput);\n+        Map<String,String> replacementData = replacementDataExtractorC.extractReplacementData(listUJsonOutput);\n \n         for (String line : modGraphOutput) {\n             for (String original : replacementData.keySet()) {\n"}}, {"oid": "ce69409964f8cc6af2be9eae7c93e261f7149112", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/ce69409964f8cc6af2be9eae7c93e261f7149112", "message": "feat: ReplacementDataExtractors now return maps instead of modifying a shared map", "committedDate": "2020-07-09T17:46:03Z", "type": "commit"}]}