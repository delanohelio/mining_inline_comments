{"pr_number": 125, "pr_title": "Cpan detectable test", "pr_createdAt": "2020-03-09T19:22:09Z", "pr_url": "https://github.com/blackducksoftware/synopsys-detect/pull/125", "timeline": [{"oid": "347a3b2697b063cc6a4733b356aeed3259fcdc65", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/347a3b2697b063cc6a4733b356aeed3259fcdc65", "message": "feat(test): Edited CpanCliDetectableTest to extend DetectableFunctionalTest", "committedDate": "2020-03-09T18:15:08Z", "type": "commit"}, {"oid": "5f82722e7730abddc93bfb41d7c93ac192e4254d", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/5f82722e7730abddc93bfb41d7c93ac192e4254d", "message": "feat(test): Added addExecutableOutputToOutputDirectory to DetectableFunctionalTest since some detectables, including cpan, extract to their output directory instead of their source directory", "committedDate": "2020-03-09T18:32:51Z", "type": "commit"}, {"oid": "146b5d1d2a7f89624e0e22b014a7f9278389c219", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/146b5d1d2a7f89624e0e22b014a7f9278389c219", "message": "feat(test): Added graphAssertions to CpanCliDetectableTest", "committedDate": "2020-03-09T19:01:43Z", "type": "commit"}, {"oid": "566bf4c49bd5a218c2aaa8320b13d530cbc97e03", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/566bf4c49bd5a218c2aaa8320b13d530cbc97e03", "message": "fix(test): Moved CpanCliDetectableTest to functional test folder, deleted tests that are redundant", "committedDate": "2020-03-09T19:14:44Z", "type": "commit"}, {"oid": "3c4bc4d5468a51e136a461b6b73dc093a446b1d6", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/3c4bc4d5468a51e136a461b6b73dc093a446b1d6", "message": "fix(test): Deleted unused cpan resources", "committedDate": "2020-03-09T19:19:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk0MjUxMg==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/125#discussion_r389942512", "bodyText": "I would change DetectableFunctionalTest::addExecutableOutput to take in the working directory for the executable instead of creating two more methods that do essentially the same thing.\npublic void addExecutableOutput(@NotNull final ExecutableOutput executableOutput, @NotNull final Map<String, String> environment, @NotNull final String... command) {\n    addExecutableOutput(sourceDirectory, executableOutput, environment, command);\n}\n\npublic void addExecutableOutput(@NotNull final Path workingDirectory, @NotNull final ExecutableOutput executableOutput, @NotNull final Map<String, String> environment, @NotNull final String... command) {\n    final List<String> commandList = Arrays.asList(command);\n    final Executable executable = new Executable(workingDirectory.toFile(), environment, commandList);\n    executableRunner.addExecutableOutput(executable, executableOutput);\n}", "author": "JakeMathews", "createdAt": "2020-03-09T20:28:22Z", "path": "detectable/src/test/java/com/synopsys/integration/detectable/functional/DetectableFunctionalTest.java", "diffHunk": "@@ -167,6 +167,14 @@ public void addExecutableOutput(@NotNull final ExecutableOutput executableOutput\n         executableRunner.addExecutableOutput(executable, executableOutput);", "originalCommit": "3c4bc4d5468a51e136a461b6b73dc093a446b1d6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk0OTQ4Mw==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/125#discussion_r389949483", "bodyText": "Love it", "author": "crowleySynopsys", "createdAt": "2020-03-09T20:42:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk0MjUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk1MTQ3NA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/125#discussion_r389951474", "bodyText": "to preserve the current api, how do you feel about having an addExecutableOutput that defaults the workingDirectory to sourceDirectory", "author": "crowleySynopsys", "createdAt": "2020-03-09T20:46:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk0MjUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk1Mzc4NA==", "url": "https://github.com/blackducksoftware/synopsys-detect/pull/125#discussion_r389953784", "bodyText": "looks in order to do this we'd either have to change the access modifiers on DetectableFunctionalTest so you can reference the directories, or just pass a boolean or enum to indicate which directory you want to add to", "author": "crowleySynopsys", "createdAt": "2020-03-09T20:50:28Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTk0MjUxMg=="}], "type": "inlineReview", "revised_code": {"commit": "3ee79bdc51b9ad85e6458dcfc7179e1462e2c776", "chunk": "diff --git a/detectable/src/test/java/com/synopsys/integration/detectable/functional/DetectableFunctionalTest.java b/detectable/src/test/java/com/synopsys/integration/detectable/functional/DetectableFunctionalTest.java\nindex 62a359501..c07aff4b7 100644\n--- a/detectable/src/test/java/com/synopsys/integration/detectable/functional/DetectableFunctionalTest.java\n+++ b/detectable/src/test/java/com/synopsys/integration/detectable/functional/DetectableFunctionalTest.java\n\n@@ -158,20 +158,20 @@ public abstract class DetectableFunctionalTest {\n     }\n \n     public void addExecutableOutput(@NotNull final ExecutableOutput executableOutput, @NotNull final String... command) {\n-        addExecutableOutput(executableOutput, new HashMap<>(), command);\n+        addExecutableOutput(getSourceDirectory(), executableOutput, command);\n     }\n \n-    public void addExecutableOutput(@NotNull final ExecutableOutput executableOutput, @NotNull final Map<String, String> environment, @NotNull final String... command) {\n-        final List<String> commandList = Arrays.asList(command);\n-        final Executable executable = new Executable(sourceDirectory.toFile(), environment, commandList);\n-        executableRunner.addExecutableOutput(executable, executableOutput);\n+    public void addExecutableOutput(@NotNull Path workingDirectory, @NotNull final ExecutableOutput executableOutput, @NotNull final String... command) {\n+        addExecutableOutput(workingDirectory, executableOutput, new HashMap<>(), command);\n     }\n \n-    public void addExecutableOutputToOutputDirectory(@NotNull final ExecutableOutput executableOutput, @NotNull final String... command) { addExecutableOutputToOutputDirectory(executableOutput, new HashMap<>(), command); }\n+    public void addExecutableOutput(@NotNull final ExecutableOutput executableOutput, @NotNull final Map<String, String> environment, @NotNull final String... command) {\n+        addExecutableOutput(getSourceDirectory(), executableOutput, environment, command);\n+    }\n \n-    public void addExecutableOutputToOutputDirectory(@NotNull final ExecutableOutput executableOutput, @NotNull final Map<String, String> environment, @NotNull final String... command) {\n+    public void addExecutableOutput(@NotNull Path workingDirectory, @NotNull final ExecutableOutput executableOutput, @NotNull final Map<String, String> environment, @NotNull final String... command) {\n         final List<String> commandList = Arrays.asList(command);\n-        final Executable executable = new Executable(outputDirectory.toFile(), environment, commandList);\n+        final Executable executable = new Executable(workingDirectory.toFile(), environment, commandList);\n         executableRunner.addExecutableOutput(executable, executableOutput);\n     }\n \n"}}, {"oid": "3ee79bdc51b9ad85e6458dcfc7179e1462e2c776", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/3ee79bdc51b9ad85e6458dcfc7179e1462e2c776", "message": "fix(test): Edited API of DetectableFunctionalTest::addExecutableOutput so users can specify directory to extract to", "committedDate": "2020-03-10T17:33:30Z", "type": "commit"}, {"oid": "8b562c6e8f01026916ea13c45b7cd9bd1ffa3a63", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/8b562c6e8f01026916ea13c45b7cd9bd1ffa3a63", "message": "fix(test): Updated assertions in detectable tests to check for exact expected number of code locations", "committedDate": "2020-03-24T21:10:29Z", "type": "commit"}, {"oid": "ce7d5aaeb6184e8b65246be879583fe1bf075eaa", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/ce7d5aaeb6184e8b65246be879583fe1bf075eaa", "message": "Merge branch 'master' into cpanDetectableTest", "committedDate": "2020-04-09T15:26:32Z", "type": "commit"}, {"oid": "238654e810ea9cf34d8bec2cac683d9cc5d3ebad", "url": "https://github.com/blackducksoftware/synopsys-detect/commit/238654e810ea9cf34d8bec2cac683d9cc5d3ebad", "message": "test-refactor(cpan-cli): Replaced full class implementations of resolvers with lambda function.", "committedDate": "2020-04-09T15:34:54Z", "type": "commit"}]}