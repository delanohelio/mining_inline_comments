{"pr_number": 3213, "pr_title": "use getPath() for all this.path references", "pr_createdAt": "2020-09-04T18:08:42Z", "pr_url": "https://github.com/oracle/opengrok/pull/3213", "timeline": [{"oid": "4847d05759f9cc203ac3e39ef93d498743ec021d", "url": "https://github.com/oracle/opengrok/commit/4847d05759f9cc203ac3e39ef93d498743ec021d", "message": "use getPath() for all this.path references", "committedDate": "2020-09-04T18:07:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgxMDgyMQ==", "url": "https://github.com/oracle/opengrok/pull/3213#discussion_r483810821", "bodyText": "How about revising line 768 rather than adding a local variable path hiding the field of same name", "author": "idodeclare", "createdAt": "2020-09-04T19:31:45Z", "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java", "diffHunk": "@@ -763,13 +763,14 @@ public Annotation getAnnotation() {\n      * current path is the \"/\" directory, otherwise set to an empty string.\n      */\n     public String[] getSearchOnlyIn() {\n+        String path = getPath();", "originalCommit": "4847d05759f9cc203ac3e39ef93d498743ec021d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg0NjUxMQ==", "url": "https://github.com/oracle/opengrok/pull/3213#discussion_r483846511", "bodyText": "oh, that's an omission. fixed.", "author": "vladak", "createdAt": "2020-09-04T21:14:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzgxMDgyMQ=="}], "type": "inlineReview", "revised_code": {"commit": "41ae678d13d40ee620126cde62c32beb9da6114b", "chunk": "diff --git a/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java b/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\nindex 9537669ad8..1cd363e7df 100644\n--- a/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\n+++ b/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\n\n@@ -763,7 +763,6 @@ public final class PageConfig {\n      * current path is the \"/\" directory, otherwise set to an empty string.\n      */\n     public String[] getSearchOnlyIn() {\n-        String path = getPath();\n         if (isDir()) {\n             return path.length() == 0\n                     ? new String[]{\"/\", \"this directory\", \"disabled=\\\"\\\"\"}\n"}}, {"oid": "41ae678d13d40ee620126cde62c32beb9da6114b", "url": "https://github.com/oracle/opengrok/commit/41ae678d13d40ee620126cde62c32beb9da6114b", "message": "fix review comment", "committedDate": "2020-09-04T21:14:09Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg3MzIxMA==", "url": "https://github.com/oracle/opengrok/pull/3213#discussion_r483873210", "bodyText": "I do know isDir() arranges to call getPath() so it seems OK leaving this as path but maybe 769 as well.", "author": "idodeclare", "createdAt": "2020-09-04T22:53:28Z", "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java", "diffHunk": "@@ -766,10 +766,10 @@ public Annotation getAnnotation() {\n         if (isDir()) {\n             return path.length() == 0", "originalCommit": "41ae678d13d40ee620126cde62c32beb9da6114b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk2NjE3NA==", "url": "https://github.com/oracle/opengrok/pull/3213#discussion_r483966174", "bodyText": "It does, however replacing all path occurrences makes this easy to check and fosters good future behavior in case any copies the existing code.", "author": "vladak", "createdAt": "2020-09-05T16:32:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzg3MzIxMA=="}], "type": "inlineReview", "revised_code": {"commit": "b084185973e5272604c3882fd27524d0ef41f507", "chunk": "diff --git a/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java b/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\nindex 1cd363e7df..f939e6523b 100644\n--- a/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\n+++ b/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\n\n@@ -764,12 +764,12 @@ public final class PageConfig {\n      */\n     public String[] getSearchOnlyIn() {\n         if (isDir()) {\n-            return path.length() == 0\n+            return getPath().length() == 0\n                     ? new String[]{\"/\", \"this directory\", \"disabled=\\\"\\\"\"}\n                     : new String[]{getPath(), \"this directory\", \"\"};\n         }\n         String[] res = new String[3];\n-        res[0] = getPath().substring(0, path.lastIndexOf(PATH_SEPARATOR) + 1);\n+        res[0] = getPath().substring(0, getPath().lastIndexOf(PATH_SEPARATOR) + 1);\n         res[1] = res[0];\n         res[2] = \"\";\n         return res;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk3Mjk1Nw==", "url": "https://github.com/oracle/opengrok/pull/3213#discussion_r483972957", "bodyText": "So ... are you going to revise this line to avoid referencing the field?", "author": "idodeclare", "createdAt": "2020-09-05T17:53:51Z", "path": "opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java", "diffHunk": "@@ -766,10 +766,10 @@ public Annotation getAnnotation() {\n         if (isDir()) {\n             return path.length() == 0", "originalCommit": "41ae678d13d40ee620126cde62c32beb9da6114b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDI2MTk0NQ==", "url": "https://github.com/oracle/opengrok/pull/3213#discussion_r484261945", "bodyText": "um, yes. Thanks.", "author": "vladak", "createdAt": "2020-09-07T08:07:15Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Mzk3Mjk1Nw=="}], "type": "inlineReview", "revised_code": {"commit": "b084185973e5272604c3882fd27524d0ef41f507", "chunk": "diff --git a/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java b/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\nindex 1cd363e7df..f939e6523b 100644\n--- a/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\n+++ b/opengrok-indexer/src/main/java/org/opengrok/indexer/web/PageConfig.java\n\n@@ -764,12 +764,12 @@ public final class PageConfig {\n      */\n     public String[] getSearchOnlyIn() {\n         if (isDir()) {\n-            return path.length() == 0\n+            return getPath().length() == 0\n                     ? new String[]{\"/\", \"this directory\", \"disabled=\\\"\\\"\"}\n                     : new String[]{getPath(), \"this directory\", \"\"};\n         }\n         String[] res = new String[3];\n-        res[0] = getPath().substring(0, path.lastIndexOf(PATH_SEPARATOR) + 1);\n+        res[0] = getPath().substring(0, getPath().lastIndexOf(PATH_SEPARATOR) + 1);\n         res[1] = res[0];\n         res[2] = \"\";\n         return res;\n"}}, {"oid": "b084185973e5272604c3882fd27524d0ef41f507", "url": "https://github.com/oracle/opengrok/commit/b084185973e5272604c3882fd27524d0ef41f507", "message": "address review comment", "committedDate": "2020-09-07T08:06:54Z", "type": "commit"}]}