{"pr_number": 3696, "pr_title": "fix: fix incorrect parent for type reference of a CtParameter", "pr_createdAt": "2020-11-15T13:42:22Z", "pr_url": "https://github.com/INRIA/spoon/pull/3696", "timeline": [{"oid": "170730d96d65062271daeaf92374cb0b60cf5152", "url": "https://github.com/INRIA/spoon/commit/170730d96d65062271daeaf92374cb0b60cf5152", "message": "fix bug and add test", "committedDate": "2020-11-15T07:27:37Z", "type": "commit"}, {"oid": "e7cec6e858e8937e177ee829350acdeae1c2368d", "url": "https://github.com/INRIA/spoon/commit/e7cec6e858e8937e177ee829350acdeae1c2368d", "message": "Merge branch 'master' into fix_ctparameter-getreference", "committedDate": "2020-11-15T07:28:26Z", "type": "commit"}, {"oid": "e0fa2a690b7a5d4866a579917a5fd0c96b469926", "url": "https://github.com/INRIA/spoon/commit/e0fa2a690b7a5d4866a579917a5fd0c96b469926", "message": "Merge branch 'master' into fix_ctparameter-getreference", "committedDate": "2020-11-15T13:13:37Z", "type": "commit"}, {"oid": "bec1e2d8971bec85a899f352e0a06c04b526b82c", "url": "https://github.com/INRIA/spoon/commit/bec1e2d8971bec85a899f352e0a06c04b526b82c", "message": "fix test failures", "committedDate": "2020-11-19T09:25:13Z", "type": "commit"}, {"oid": "524d69307540e13593f9a51c49fe345b4d176171", "url": "https://github.com/INRIA/spoon/commit/524d69307540e13593f9a51c49fe345b4d176171", "message": "Merge branch 'master' into fix_ctparameter-getreference", "committedDate": "2020-11-20T08:39:50Z", "type": "commit"}, {"oid": "221e1b6854c5852165ed1207d5fa0cdd177eb791", "url": "https://github.com/INRIA/spoon/commit/221e1b6854c5852165ed1207d5fa0cdd177eb791", "message": "fix checkstyle", "committedDate": "2020-11-20T09:20:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzU3MTEwNA==", "url": "https://github.com/INRIA/spoon/pull/3696#discussion_r527571104", "bodyText": "This solution works but it hides an implicit difference between ordinary parameters and parameters in lambda expressions. Is it better to create a CtLambdaParameter class?", "author": "andrewbwogi", "createdAt": "2020-11-20T09:45:31Z", "path": "src/main/java/spoon/reflect/factory/ExecutableFactory.java", "diffHunk": "@@ -79,7 +79,11 @@ public CtAnonymousExecutable createAnonymous(CtClass<?> target, CtBlock<Void> bo\n \tpublic <T> CtParameterReference<T> createParameterReference(CtParameter<T> parameter) {\n \t\tCtParameterReference<T> ref = factory.Core().createParameterReference();\n \t\tref.setSimpleName(parameter.getSimpleName());\n-\t\tref.setType(parameter.getType());\n+\t\tif (parameter.getType() == null) {\n+\t\t\tref.setType(parameter.getType());\n+\t\t} else {\n+\t\t\tref.setType(parameter.getType().clone());\n+\t\t}", "originalCommit": "221e1b6854c5852165ed1207d5fa0cdd177eb791", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0df5f08e944a8fa85a8c05dce4bc0def2bc284e8", "chunk": "diff --git a/src/main/java/spoon/reflect/factory/ExecutableFactory.java b/src/main/java/spoon/reflect/factory/ExecutableFactory.java\nindex 2cd760e5..522c7205 100644\n--- a/src/main/java/spoon/reflect/factory/ExecutableFactory.java\n+++ b/src/main/java/spoon/reflect/factory/ExecutableFactory.java\n\n@@ -79,6 +79,8 @@ public class ExecutableFactory extends SubFactory {\n \tpublic <T> CtParameterReference<T> createParameterReference(CtParameter<T> parameter) {\n \t\tCtParameterReference<T> ref = factory.Core().createParameterReference();\n \t\tref.setSimpleName(parameter.getSimpleName());\n+\n+\t\t// true when parameter comes from a lambda expression\n \t\tif (parameter.getType() == null) {\n \t\t\tref.setType(parameter.getType());\n \t\t} else {\n"}}, {"oid": "0df5f08e944a8fa85a8c05dce4bc0def2bc284e8", "url": "https://github.com/INRIA/spoon/commit/0df5f08e944a8fa85a8c05dce4bc0def2bc284e8", "message": "add comment", "committedDate": "2020-11-23T16:27:41Z", "type": "commit"}, {"oid": "ee463aed3c5deef9d537df64c45b3e50def11a25", "url": "https://github.com/INRIA/spoon/commit/ee463aed3c5deef9d537df64c45b3e50def11a25", "message": "Merge branch 'master' into fix_ctparameter-getreference", "committedDate": "2020-11-23T16:28:29Z", "type": "commit"}, {"oid": "c5e7782363d22211661f2506f6619d9832869795", "url": "https://github.com/INRIA/spoon/commit/c5e7782363d22211661f2506f6619d9832869795", "message": "add contract comment to test", "committedDate": "2020-11-24T08:35:44Z", "type": "commit"}]}