{"pr_number": 3513, "pr_title": "fix: Use real name of the tag if it is unknwon", "pr_createdAt": "2020-07-30T02:24:06Z", "pr_url": "https://github.com/INRIA/spoon/pull/3513", "timeline": [{"oid": "d0650c831237f56dd563c59f4a02ebe1f9874872", "url": "https://github.com/INRIA/spoon/commit/d0650c831237f56dd563c59f4a02ebe1f9874872", "message": "feat(Java doc tag): add real name to Java doc tag\n\nGiven the scenario that we need to show javadoc comment on LSIF hover, we need realname of the tag\ninstead of UNKNOWN tag", "committedDate": "2020-07-30T01:59:21Z", "type": "commit"}, {"oid": "d99120ada9c525b84b493a01d35e7b90332b7d8f", "url": "https://github.com/INRIA/spoon/commit/d99120ada9c525b84b493a01d35e7b90332b7d8f", "message": "feat(Comment creator): Use real name to print comment tag\n\nRetain real name when parsing javadoc comment, and pretty print the realname tag instead of using\nUNKNOWN", "committedDate": "2020-07-30T02:01:06Z", "type": "commit"}, {"oid": "34bd0965c92699deb93735da358f78f16aad7000", "url": "https://github.com/INRIA/spoon/commit/34bd0965c92699deb93735da358f78f16aad7000", "message": "feat(comment helper): fix test case", "committedDate": "2020-07-30T10:09:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk0MDQ1MA==", "url": "https://github.com/INRIA/spoon/pull/3513#discussion_r463940450", "bodyText": "please avoid breaking changes, add a constructor instead", "author": "monperrus", "createdAt": "2020-08-01T08:44:15Z", "path": "src/main/java/spoon/javadoc/internal/JavadocBlockTag.java", "diffHunk": "@@ -32,20 +32,22 @@\n \tprivate JavadocDescription content;\n \tprivate String name = \"\";\n \tprivate String tagName;\n+\tprivate String tagRealName;\n \n-\tpublic JavadocBlockTag(CtJavaDocTag.TagType type, String content) {\n+\tpublic JavadocBlockTag(CtJavaDocTag.TagType type, String tagRealName, String content) {", "originalCommit": "34bd0965c92699deb93735da358f78f16aad7000", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3fa5121fd5d57d2a24e1a40b22729afcaa03d782", "chunk": "diff --git a/src/main/java/spoon/javadoc/internal/JavadocBlockTag.java b/src/main/java/spoon/javadoc/internal/JavadocBlockTag.java\nindex 83bb705b..1334b755 100644\n--- a/src/main/java/spoon/javadoc/internal/JavadocBlockTag.java\n+++ b/src/main/java/spoon/javadoc/internal/JavadocBlockTag.java\n\n@@ -34,6 +34,12 @@ public class JavadocBlockTag implements Serializable {\n \tprivate String tagName;\n \tprivate String tagRealName;\n \n+\tpublic JavadocBlockTag(CtJavaDocTag.TagType type, String content) {\n+\t\tthis.type = type;\n+\t\tthis.tagName = type.getName();\n+\t\tthis.content = Javadoc.parseText(content);\n+\t}\n+\n \tpublic JavadocBlockTag(CtJavaDocTag.TagType type, String tagRealName, String content) {\n \t\tthis.type = type;\n \t\tthis.tagName = type.getName();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk0MDUwNw==", "url": "https://github.com/INRIA/spoon/pull/3513#discussion_r463940507", "bodyText": "no breaking change in the factory", "author": "monperrus", "createdAt": "2020-08-01T08:44:55Z", "path": "src/main/java/spoon/reflect/factory/CodeFactory.java", "diffHunk": "@@ -710,7 +710,7 @@ public CtComment createInlineComment(String content) {\n \t * @param type The tag type\n \t * @return a new CtJavaDocTag\n \t */\n-\tpublic CtJavaDocTag createJavaDocTag(String content, CtJavaDocTag.TagType type) {\n+\tpublic CtJavaDocTag createJavaDocTag(String content, CtJavaDocTag.TagType type, String realName) {", "originalCommit": "34bd0965c92699deb93735da358f78f16aad7000", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3fa5121fd5d57d2a24e1a40b22729afcaa03d782", "chunk": "diff --git a/src/main/java/spoon/reflect/factory/CodeFactory.java b/src/main/java/spoon/reflect/factory/CodeFactory.java\nindex 655725df..a7420f3f 100644\n--- a/src/main/java/spoon/reflect/factory/CodeFactory.java\n+++ b/src/main/java/spoon/reflect/factory/CodeFactory.java\n\n@@ -710,6 +710,35 @@ public class CodeFactory extends SubFactory {\n \t * @param type The tag type\n \t * @return a new CtJavaDocTag\n \t */\n+\tpublic CtJavaDocTag createJavaDocTag(String content, CtJavaDocTag.TagType type) {\n+\t\tif (content == null) {\n+\t\t\tcontent = \"\";\n+\t\t}\n+\t\tCtJavaDocTag docTag = factory.Core().createJavaDocTag();\n+\t\tif (type != null && type.hasParam()) {\n+\t\t\tint firstWord = content.indexOf(' ');\n+\t\t\tint firstLine = content.indexOf('\\n');\n+\t\t\tif (firstLine < firstWord && firstLine >= 0) {\n+\t\t\t\tfirstWord = firstLine;\n+\t\t\t}\n+\t\t\tif (firstWord == -1) {\n+\t\t\t\tfirstWord = content.length();\n+\t\t\t}\n+\t\t\tString param = content.substring(0, firstWord);\n+\t\t\tcontent = content.substring(firstWord);\n+\t\t\tdocTag.setParam(param);\n+\t\t}\n+\t\treturn docTag.setContent(content.trim()).setType(type);\n+\t}\n+\n+\t/**\n+\t * Creates a javadoc tag\n+\t *\n+\t * @param content The content of the javadoc tag with a possible paramater\n+\t * @param type The tag type\n+\t * @param realName The real name of the tag\n+\t * @return a new CtJavaDocTag\n+\t */\n \tpublic CtJavaDocTag createJavaDocTag(String content, CtJavaDocTag.TagType type, String realName) {\n \t\tif (content == null) {\n \t\t\tcontent = \"\";\n"}}, {"oid": "3fa5121fd5d57d2a24e1a40b22729afcaa03d782", "url": "https://github.com/INRIA/spoon/commit/3fa5121fd5d57d2a24e1a40b22729afcaa03d782", "message": "fix(test): fix ci test case problem", "committedDate": "2020-08-11T09:33:21Z", "type": "commit"}, {"oid": "d09922ab05124b7e818a243e88dbe2b8730b9fb5", "url": "https://github.com/INRIA/spoon/commit/d09922ab05124b7e818a243e88dbe2b8730b9fb5", "message": "test(modify test):", "committedDate": "2020-08-12T01:43:25Z", "type": "commit"}, {"oid": "7e97cd3f9ca1ec54ca1d1c71f18a2e1d3ea54e84", "url": "https://github.com/INRIA/spoon/commit/7e97cd3f9ca1ec54ca1d1c71f18a2e1d3ea54e84", "message": "style(add new line to meet travis requirement):", "committedDate": "2020-08-12T02:21:32Z", "type": "commit"}, {"oid": "ab8cffc6c61672a4785603279ac6e80c2df00604", "url": "https://github.com/INRIA/spoon/commit/ab8cffc6c61672a4785603279ac6e80c2df00604", "message": "style(ModelRoleHandlers): add new line", "committedDate": "2020-08-12T03:16:12Z", "type": "commit"}, {"oid": "ccf3fb54a719117e0d818682fe59f30805bdd6bd", "url": "https://github.com/INRIA/spoon/commit/ccf3fb54a719117e0d818682fe59f30805bdd6bd", "message": "Update Factory.java", "committedDate": "2020-08-17T07:33:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTI5NDMwMQ==", "url": "https://github.com/INRIA/spoon/pull/3513#discussion_r471294301", "bodyText": "undo", "author": "monperrus", "createdAt": "2020-08-17T07:33:38Z", "path": "src/test/java/spoon/processing/CtGenerationTest.java", "diffHunk": "@@ -151,7 +151,7 @@ public void testGenerateCloneVisitor() {\n \t\tCtClass<Object> expected = build(new File(\"./src/main/java/spoon/support/visitor/clone/CloneBuilder.java\")).Class().get(\"spoon.support.visitor.clone.CloneBuilder\");\n \t\tassertThat(actual).isEqualTo(expected);\n \n-\t\t// cp ./target/generated/spoon/support/visitor/clone/CloneVisitor.java  ./src/main/java/spoon/support/visitor/clone/CloneVisitor.java", "originalCommit": "ccf3fb54a719117e0d818682fe59f30805bdd6bd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "51f5f91b2c5ccfbc545bf85957cef060385964f0", "chunk": "diff --git a/src/test/java/spoon/processing/CtGenerationTest.java b/src/test/java/spoon/processing/CtGenerationTest.java\nindex cf4e5eef..64281947 100644\n--- a/src/test/java/spoon/processing/CtGenerationTest.java\n+++ b/src/test/java/spoon/processing/CtGenerationTest.java\n\n@@ -151,7 +151,7 @@ public class CtGenerationTest {\n \t\tCtClass<Object> expected = build(new File(\"./src/main/java/spoon/support/visitor/clone/CloneBuilder.java\")).Class().get(\"spoon.support.visitor.clone.CloneBuilder\");\n \t\tassertThat(actual).isEqualTo(expected);\n \n-\t\t//\n+\t\t// cp ./target/generated/spoon/support/visitor/clone/CloneVisitor.java  ./src/main/java/spoon/support/visitor/clone/CloneVisitor.java\n \t\tactual = build(new File(launcher.getModelBuilder().getSourceOutputDirectory() + \"/spoon/support/visitor/clone/CloneVisitor.java\")).Class().get(\"spoon.support.visitor.clone.CloneVisitor\");\n \t\texpected = build(new File(\"./src/main/java/spoon/support/visitor/clone/CloneVisitor.java\")).Class().get(\"spoon.support.visitor.clone.CloneVisitor\");\n \t\tassertThat(actual).isEqualTo(expected);\n"}}, {"oid": "32bf8ad8313667ba4b52ed35108c177baa1ebcff", "url": "https://github.com/INRIA/spoon/commit/32bf8ad8313667ba4b52ed35108c177baa1ebcff", "message": "fix(src/main/java/spoon/reflect/visitor/CommentHelper.java): fix unknown type match problem\n\ntag name is UNKNOWN, but TagType.UNKNOWN.getName() is unknwon, should compare ignore case", "committedDate": "2020-08-27T06:09:38Z", "type": "commit"}, {"oid": "053a588d63398b5077b7d69747ad38551766368c", "url": "https://github.com/INRIA/spoon/commit/053a588d63398b5077b7d69747ad38551766368c", "message": "Merge branch 'feature/real_name_tag' of github.com:zxdxjtu/spoon into feature/real_name_tag", "committedDate": "2020-08-27T06:09:52Z", "type": "commit"}, {"oid": "51f5f91b2c5ccfbc545bf85957cef060385964f0", "url": "https://github.com/INRIA/spoon/commit/51f5f91b2c5ccfbc545bf85957cef060385964f0", "message": "Merge branch 'master' of github.com:zxdxjtu/spoon", "committedDate": "2020-08-27T07:09:21Z", "type": "commit"}, {"oid": "814106a28474d2fc48fd5d8e83aadeb78d6eab84", "url": "https://github.com/INRIA/spoon/commit/814106a28474d2fc48fd5d8e83aadeb78d6eab84", "message": "Merge branch 'master' into feature/real_name_tag", "committedDate": "2020-08-27T07:09:37Z", "type": "commit"}, {"oid": "b920b4f7f6c569fa91904eb8d025bd76c43e53d9", "url": "https://github.com/INRIA/spoon/commit/b920b4f7f6c569fa91904eb8d025bd76c43e53d9", "message": "Merge branch 'master' into feature/real_name_tag", "committedDate": "2020-08-28T09:02:43Z", "type": "commit"}, {"oid": "9b4a410260d77581a810a6dad454580b3c7db3f0", "url": "https://github.com/INRIA/spoon/commit/9b4a410260d77581a810a6dad454580b3c7db3f0", "message": "up", "committedDate": "2020-09-11T09:46:24Z", "type": "commit"}, {"oid": "a3948470d9524be104225756edd087ab10b81cfd", "url": "https://github.com/INRIA/spoon/commit/a3948470d9524be104225756edd087ab10b81cfd", "message": "up", "committedDate": "2020-09-11T09:48:54Z", "type": "commit"}, {"oid": "188d89b80b5f13373f5638ec2f87a16b66b6b825", "url": "https://github.com/INRIA/spoon/commit/188d89b80b5f13373f5638ec2f87a16b66b6b825", "message": "up", "committedDate": "2020-09-11T09:49:34Z", "type": "commit"}]}