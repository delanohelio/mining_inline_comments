{"pr_number": 1487, "pr_title": "Fix baseline-exact-dependencies with new GCV", "pr_createdAt": "2020-09-02T13:50:02Z", "pr_url": "https://github.com/palantir/gradle-baseline/pull/1487", "timeline": [{"oid": "8691befda25a012121845d280db84fb8467fa6fe", "url": "https://github.com/palantir/gradle-baseline/commit/8691befda25a012121845d280db84fb8467fa6fe", "message": "Fix baseline-exact-dependencies with new GCV", "committedDate": "2020-09-02T13:40:43Z", "type": "commit"}, {"oid": "9f9b59fa6f2f96154cf40c6b1e3844e9fb50ba8b", "url": "https://github.com/palantir/gradle-baseline/commit/9f9b59fa6f2f96154cf40c6b1e3844e9fb50ba8b", "message": "qualify picking up gcv locks on whether gcv is applied", "committedDate": "2020-09-02T13:52:07Z", "type": "commit"}, {"oid": "c9142595781bd5428fa491761f78849f0757f630", "url": "https://github.com/palantir/gradle-baseline/commit/c9142595781bd5428fa491761f78849f0757f630", "message": "Add generated changelog entries", "committedDate": "2020-09-02T13:52:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjIwODc3MA==", "url": "https://github.com/palantir/gradle-baseline/pull/1487#discussion_r482208770", "bodyText": "Feels quite weird to have this direct knowledge of GCV here? Will this still work with old GCV?", "author": "CRogers", "createdAt": "2020-09-02T16:36:42Z", "path": "gradle-baseline-java/src/main/groovy/com/palantir/baseline/plugins/BaselineExactDependencies.java", "diffHunk": "@@ -153,9 +153,13 @@ private static void configureSourceSet(\n         });\n \n         explicitCompile.withDependencies(deps -> {\n-            // Mirror the transitive constraints form compileClasspath in order to pick up GCV locks.\n-            // We should really do this with an addAllLater but that would require Gradle 6, or a hacky workaround.\n-            explicitCompile.getDependencyConstraints().addAll(compileClasspath.getAllDependencyConstraints());\n+            // Pick up GCV locks. We're making an internal assumption that this configuration exists,\n+            // but we can rely on this since we control GCV.\n+            // Alternatively, we could tell GCV to lock this configuration, at the cost of a slightly more\n+            // expensive 'unifiedClasspath' resolution during lock computation.\n+            if (project.getRootProject().getPluginManager().hasPlugin(\"com.palantir.versions-lock\")) {\n+                explicitCompile.extendsFrom(project.getConfigurations().getByName(\"lockConstraints\"));", "originalCommit": "c9142595781bd5428fa491761f78849f0757f630", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}