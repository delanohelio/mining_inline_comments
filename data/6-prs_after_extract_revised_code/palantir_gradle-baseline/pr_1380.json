{"pr_number": 1380, "pr_title": "Don't include SUGGESTION checks in default checks", "pr_createdAt": "2020-06-02T21:26:01Z", "pr_url": "https://github.com/palantir/gradle-baseline/pull/1380", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODE0Ng==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434198146", "bodyText": "seems like this should be an error", "author": "ferozco", "createdAt": "2020-06-02T21:57:22Z", "path": "baseline-error-prone/src/main/java/com/palantir/baseline/errorprone/RedundantModifier.java", "diffHunk": "@@ -41,7 +42,7 @@\n         link = \"https://github.com/palantir/gradle-baseline#baseline-error-prone-checks\",\n         linkType = BugPattern.LinkType.CUSTOM,\n         providesFix = BugPattern.ProvidesFix.REQUIRES_HUMAN_ATTENTION,\n-        severity = BugPattern.SeverityLevel.SUGGESTION,\n+        severity = SeverityLevel.WARNING,", "originalCommit": "513430bdda9efcb78b08acaa53b5fe9c83a8cdb0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNTI3NA==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434205274", "bodyText": "I think we want WARN here, iirc we use a flag to ignore error-prone warnings in generated code but it doesn't apply to errors.", "author": "carterkozak", "createdAt": "2020-06-02T22:15:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODE0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNzM5Mg==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434207392", "bodyText": "I believe we explicitly opt out of errorprone on generated source sets: \n  \n    \n      gradle-baseline/gradle-baseline-java/src/main/groovy/com/palantir/baseline/plugins/BaselineErrorProne.java\n    \n    \n         Line 210\n      in\n      a63a0ad\n    \n    \n    \n    \n\n        \n          \n           .set(String.format(", "author": "ferozco", "createdAt": "2020-06-02T22:21:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODE0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwODI1Ng==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434208256", "bodyText": "Can we change this in a FLUP? I'd prefer not to accidentally break things in this PR.", "author": "pkoenig10", "createdAt": "2020-06-02T22:24:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODE0Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwOTM0MA==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434209340", "bodyText": "+1 for handling warn->error separately. I don't think our regex catches 100% of generated code and I'm not sure it's worth the risk breaking some folks in order to fail builds in repos that don't fail on errors", "author": "carterkozak", "createdAt": "2020-06-02T22:27:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODE0Ng=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODUzNg==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434198536", "bodyText": "same here, definitely a bug", "author": "ferozco", "createdAt": "2020-06-02T21:58:23Z", "path": "baseline-error-prone/src/main/java/com/palantir/baseline/errorprone/StreamOfEmpty.java", "diffHunk": "@@ -33,7 +34,7 @@\n         name = \"StreamOfEmpty\",\n         link = \"https://github.com/palantir/gradle-baseline#baseline-error-prone-checks\",\n         linkType = BugPattern.LinkType.CUSTOM,\n-        severity = BugPattern.SeverityLevel.SUGGESTION,\n+        severity = SeverityLevel.WARNING,", "originalCommit": "513430bdda9efcb78b08acaa53b5fe9c83a8cdb0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNjUxOQ==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434206519", "bodyText": "I think the risk with making some of these errors is that repos which have a bunch of existing violation will be blocked. WARNING seems a bit safer because it's won't fail compilation unless you have -Werror.\nHappy to change it if you would still prefer ERROR, just wanted to point this out.", "author": "pkoenig10", "createdAt": "2020-06-02T22:19:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODUzNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNzQyMA==", "url": "https://github.com/palantir/gradle-baseline/pull/1380#discussion_r434207420", "bodyText": "in practice these rules will be auto applied on upgrade so I'm not particularly worried about blocking upgrades.", "author": "ferozco", "createdAt": "2020-06-02T22:21:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDE5ODUzNg=="}], "type": "inlineReview", "revised_code": {"commit": "72d40e2e64f2307028361862b3ff64b33d43048f", "chunk": "diff --git a/baseline-error-prone/src/main/java/com/palantir/baseline/errorprone/StreamOfEmpty.java b/baseline-error-prone/src/main/java/com/palantir/baseline/errorprone/StreamOfEmpty.java\nindex 50500c7a..8aaebfc5 100644\n--- a/baseline-error-prone/src/main/java/com/palantir/baseline/errorprone/StreamOfEmpty.java\n+++ b/baseline-error-prone/src/main/java/com/palantir/baseline/errorprone/StreamOfEmpty.java\n\n@@ -34,7 +34,7 @@ import java.util.stream.Stream;\n         name = \"StreamOfEmpty\",\n         link = \"https://github.com/palantir/gradle-baseline#baseline-error-prone-checks\",\n         linkType = BugPattern.LinkType.CUSTOM,\n-        severity = SeverityLevel.WARNING,\n+        severity = SeverityLevel.ERROR,\n         summary = \"Stream.of() should be replaced with Stream.empty() to avoid unnecessary varargs allocation.\")\n public final class StreamOfEmpty extends BugChecker implements BugChecker.MethodInvocationTreeMatcher {\n \n"}}, {"oid": "1ca404d6749f92d0f51ae49a1ce5647aa44b3e4b", "url": "https://github.com/palantir/gradle-baseline/commit/1ca404d6749f92d0f51ae49a1ce5647aa44b3e4b", "message": "Don't include SUGGESTION checks in default checks", "committedDate": "2020-06-02T22:20:43Z", "type": "commit"}, {"oid": "1ca404d6749f92d0f51ae49a1ce5647aa44b3e4b", "url": "https://github.com/palantir/gradle-baseline/commit/1ca404d6749f92d0f51ae49a1ce5647aa44b3e4b", "message": "Don't include SUGGESTION checks in default checks", "committedDate": "2020-06-02T22:20:43Z", "type": "forcePushed"}, {"oid": "72d40e2e64f2307028361862b3ff64b33d43048f", "url": "https://github.com/palantir/gradle-baseline/commit/72d40e2e64f2307028361862b3ff64b33d43048f", "message": "Comments", "committedDate": "2020-06-02T22:24:22Z", "type": "commit"}, {"oid": "60f9efc2f4509e1c4f9b17dc27e49bf58b002a33", "url": "https://github.com/palantir/gradle-baseline/commit/60f9efc2f4509e1c4f9b17dc27e49bf58b002a33", "message": "Add generated changelog entries", "committedDate": "2020-06-02T22:24:22Z", "type": "commit"}]}