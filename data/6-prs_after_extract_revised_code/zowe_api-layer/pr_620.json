{"pr_number": 620, "pr_title": "us654068/leverage ha modes for downstream services", "pr_createdAt": "2020-04-24T06:35:56Z", "pr_url": "https://github.com/zowe/api-layer/pull/620", "timeline": [{"oid": "addefec126391609087f90922f9deccbf42a3483", "url": "https://github.com/zowe/api-layer/commit/addefec126391609087f90922f9deccbf42a3483", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-26T12:43:45Z", "type": "forcePushed"}, {"oid": "a35e46d55d9a8660ccaf0e63ba3f9836cbed9fc2", "url": "https://github.com/zowe/api-layer/commit/a35e46d55d9a8660ccaf0e63ba3f9836cbed9fc2", "message": "switch to retryable client\nfailing gzip integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:22Z", "type": "commit"}, {"oid": "7f2d0a30188db850fc02f0c6a9e835772c459eda", "url": "https://github.com/zowe/api-layer/commit/7f2d0a30188db850fc02f0c6a9e835772c459eda", "message": "gzip encoding fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:22Z", "type": "commit"}, {"oid": "26ff34e5e684459c9298315ea03493a1e2d2353f", "url": "https://github.com/zowe/api-layer/commit/26ff34e5e684459c9298315ea03493a1e2d2353f", "message": "refactor http client proxy and aop\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:22Z", "type": "commit"}, {"oid": "873885748af677657fd0a9db065b67082f6604ca", "url": "https://github.com/zowe/api-layer/commit/873885748af677657fd0a9db065b67082f6604ca", "message": "cleanup refactored classes\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:22Z", "type": "commit"}, {"oid": "8ef0411cc8e246e72863ef9b9a1e4fd21b3374a3", "url": "https://github.com/zowe/api-layer/commit/8ef0411cc8e246e72863ef9b9a1e4fd21b3374a3", "message": "RequestUtils\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:22Z", "type": "commit"}, {"oid": "d516272eed14697f9c69cb35ada5e8b54846fa5d", "url": "https://github.com/zowe/api-layer/commit/d516272eed14697f9c69cb35ada5e8b54846fa5d", "message": "Request decorator\nAuthenticationCommand changes\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "42d7f73e987e6ec19b50bdd52f00830dc79e0064", "url": "https://github.com/zowe/api-layer/commit/42d7f73e987e6ec19b50bdd52f00830dc79e0064", "message": "fix proxy tests\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "b46dd23393ef995d5e223b92a8e866ce4b5caac5", "url": "https://github.com/zowe/api-layer/commit/b46dd23393ef995d5e223b92a8e866ce4b5caac5", "message": "Refactor ZosmfSchemeTest\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "cfb0cfff5dc10c236a0de17538eec7336d9a4446", "url": "https://github.com/zowe/api-layer/commit/cfb0cfff5dc10c236a0de17538eec7336d9a4446", "message": "Implementation of applyToReques method for the ZoweScheme class and added test (wip)\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "19f9e30d751786e1c3f547d4070e6f3bcf9ae2f4", "url": "https://github.com/zowe/api-layer/commit/19f9e30d751786e1c3f547d4070e6f3bcf9ae2f4", "message": "Use cookie version 0\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "0b4bcde41c5d2f9a39eed5c02e479eedab9d2f20", "url": "https://github.com/zowe/api-layer/commit/0b4bcde41c5d2f9a39eed5c02e479eedab9d2f20", "message": "implement applyToRequest for AuthenticationCommand and PassTicketCommand\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "4cbe7b3a5ab219888524f9316dd7713f79e7c696", "url": "https://github.com/zowe/api-layer/commit/4cbe7b3a5ab219888524f9316dd7713f79e7c696", "message": "Add more tests for zosmfscheme class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "6936963d2c00d0451effd139ce4d8ddc4f69a7ec", "url": "https://github.com/zowe/api-layer/commit/6936963d2c00d0451effd139ce4d8ddc4f69a7ec", "message": "make test independent of test execution order\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "9d4edd4e4e51ab74f4918227286a6aa187d540e6", "url": "https://github.com/zowe/api-layer/commit/9d4edd4e4e51ab74f4918227286a6aa187d540e6", "message": "Exceptions and test for ServiceAuthenticationDecorator\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "12ef360edab7e415c4d14cbfd99ad1d4cfc3e8ca", "url": "https://github.com/zowe/api-layer/commit/12ef360edab7e415c4d14cbfd99ad1d4cfc3e8ca", "message": "Exception handling and messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "c56052a4a5b8b2115d70ab54af7c0381b12a3a4a", "url": "https://github.com/zowe/api-layer/commit/c56052a4a5b8b2115d70ab54af7c0381b12a3a4a", "message": "Add implementation of process method and add unit tests for Decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "8653d96812e8d5c14c5b213266a014e7bca5b32f", "url": "https://github.com/zowe/api-layer/commit/8653d96812e8d5c14c5b213266a014e7bca5b32f", "message": "SecurityDecorator exceptionhandling\nByPassScheme fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "6e450677d892ec1a80a49d04b6ba58915b604068", "url": "https://github.com/zowe/api-layer/commit/6e450677d892ec1a80a49d04b6ba58915b604068", "message": "Javadoc, checkstyle and small fixes\ncleanup\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "9fdb195a9f6b9482f0dd71999e98d7622f49c6f9", "url": "https://github.com/zowe/api-layer/commit/9fdb195a9f6b9482f0dd71999e98d7622f49c6f9", "message": "refactor ServiceAuthenticationDecoratorTest\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "dcaaee5a6bc4e05e9a5812fc0ca493cc12b8eb52", "url": "https://github.com/zowe/api-layer/commit/dcaaee5a6bc4e05e9a5812fc0ca493cc12b8eb52", "message": "Suppress log messages\nSendErrorFilter\nNo handler for GET /error\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "b3c2eea7d5cb8110efba4773310e83bce2d26196", "url": "https://github.com/zowe/api-layer/commit/b3c2eea7d5cb8110efba4773310e83bce2d26196", "message": "Fix sonar problems and add unit test for decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:23Z", "type": "commit"}, {"oid": "fbc1a08ba35d8d7141fc7cd3c6de16ef4500c4b7", "url": "https://github.com/zowe/api-layer/commit/fbc1a08ba35d8d7141fc7cd3c6de16ef4500c4b7", "message": "Fix sonar problems with Cookie security\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "commit"}, {"oid": "ff9dd9fc6a529c839277e96d667d283f0e2e57ef", "url": "https://github.com/zowe/api-layer/commit/ff9dd9fc6a529c839277e96d667d283f0e2e57ef", "message": "Fix more sonar problems and add unit test for RibbonRetryError class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "commit"}, {"oid": "e0c44a81870226037b520fdf5e608a4430b04900", "url": "https://github.com/zowe/api-layer/commit/e0c44a81870226037b520fdf5e608a4430b04900", "message": "Http/Https resolution for service instances\nRefactor exceptions\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "commit"}, {"oid": "38381259304d781c8c2ecee6788b0bb269204112", "url": "https://github.com/zowe/api-layer/commit/38381259304d781c8c2ecee6788b0bb269204112", "message": "Initialize client with LoadBalancerContext\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "commit"}, {"oid": "0503148c1ec8cf016f909facb01295d1558275e1", "url": "https://github.com/zowe/api-layer/commit/0503148c1ec8cf016f909facb01295d1558275e1", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "commit"}, {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f", "url": "https://github.com/zowe/api-layer/commit/9cc2807d5c8c7b05072ff438d2c30648643de91f", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "commit"}, {"oid": "9cc2807d5c8c7b05072ff438d2c30648643de91f", "url": "https://github.com/zowe/api-layer/commit/9cc2807d5c8c7b05072ff438d2c30648643de91f", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T06:13:24Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU1NjEwMg==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415556102", "bodyText": "Deduplicate by extracting in private method?", "author": "balhar-jakub", "createdAt": "2020-04-27T06:53:52Z", "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/error/check/RibbonRetryErrorCheck.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+\n+package org.zowe.apiml.gateway.error.check;\n+\n+import lombok.RequiredArgsConstructor;\n+import org.apache.commons.lang3.exception.ExceptionUtils;\n+import org.springframework.http.HttpStatus;\n+import org.springframework.http.MediaType;\n+import org.springframework.http.ResponseEntity;\n+import org.zowe.apiml.gateway.error.ErrorUtils;\n+import org.zowe.apiml.gateway.ribbon.http.RequestAbortException;\n+import org.zowe.apiml.gateway.ribbon.http.RequestContextNotPreparedException;\n+import org.zowe.apiml.message.api.ApiMessageView;\n+import org.zowe.apiml.message.core.MessageService;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import java.net.ConnectException;\n+\n+/**\n+ * Handler for exceptions that arise during the Ribbon retries\n+ */\n+@RequiredArgsConstructor\n+public class RibbonRetryErrorCheck implements ErrorCheck {\n+    private final MessageService messageService;\n+    @Override\n+    public ResponseEntity<ApiMessageView> checkError(HttpServletRequest request, Throwable exc) {\n+\n+        int exceptionIndex = -1;\n+\n+        if ( (exceptionIndex = ExceptionUtils.indexOfType(exc, RequestAbortException.class)) != -1) {\n+            Throwable t = ExceptionUtils.getThrowables(exc)[exceptionIndex];\n+            if (t instanceof RequestContextNotPreparedException) {\n+                ApiMessageView messageView = messageService.createMessage(\"org.zowe.apiml.gateway.contextNotPrepared\").mapToView();\n+                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)", "originalCommit": "9cc2807d5c8c7b05072ff438d2c30648643de91f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "chunk": "diff --git a/gateway-service/src/main/java/org/zowe/apiml/gateway/error/check/RibbonRetryErrorCheck.java b/gateway-service/src/main/java/org/zowe/apiml/gateway/error/check/RibbonRetryErrorCheck.java\nindex d843b45d..7460a715 100644\n--- a/gateway-service/src/main/java/org/zowe/apiml/gateway/error/check/RibbonRetryErrorCheck.java\n+++ b/gateway-service/src/main/java/org/zowe/apiml/gateway/error/check/RibbonRetryErrorCheck.java\n\n@@ -39,18 +39,14 @@ public class RibbonRetryErrorCheck implements ErrorCheck {\n             Throwable t = ExceptionUtils.getThrowables(exc)[exceptionIndex];\n             if (t instanceof RequestContextNotPreparedException) {\n                 ApiMessageView messageView = messageService.createMessage(\"org.zowe.apiml.gateway.contextNotPrepared\").mapToView();\n-                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)\n-                    .contentType(MediaType.APPLICATION_JSON_UTF8)\n-                    .body(messageView);\n+                return getApiMessageViewResponseEntity(messageView);\n             }\n \n             if (t instanceof RequestAbortException) {\n                 ApiMessageView messageView = messageService.createMessage(\"org.zowe.apiml.gateway.requestAborted\",\n                     ErrorUtils.getGatewayUri(request),\n                     t.getCause()).mapToView();\n-                return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)\n-                    .contentType(MediaType.APPLICATION_JSON_UTF8)\n-                    .body(messageView);\n+                return getApiMessageViewResponseEntity(messageView);\n             }\n \n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTU2NDU5Nw==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415564597", "bodyText": "Possibly deduplicate via extraction to private?", "author": "balhar-jakub", "createdAt": "2020-04-27T07:10:11Z", "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java", "diffHunk": "@@ -108,6 +112,40 @@ public void apply(InstanceInfo instanceInfo) {\n             });\n         }\n \n+        @Override\n+        public void applyToRequest(HttpRequest request) {\n+            RequestUtils wrapper = RequestUtils.of(request);\n+            final RequestContext context = RequestContext.getCurrentContext();\n+\n+            Optional<String> jwtToken = authenticationService.getJwtTokenFromRequest(context.getRequest());\n+            jwtToken.ifPresent(token -> {\n+                // parse JWT token to detect the source (z/OSMF / Zowe)\n+                QueryResponse queryResponse = authenticationService.parseJwtToken(token);\n+                switch (queryResponse.getSource()) {\n+                    case ZOSMF:\n+                        wrapper.removeCookie(authConfigurationProperties.getCookieProperties().getCookieName());\n+                        HttpCookie jwtCookie = new HttpCookie(ZosmfService.TokenType.JWT.getCookieName(), token);\n+                        jwtCookie.setSecure(true);", "originalCommit": "9cc2807d5c8c7b05072ff438d2c30648643de91f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "chunk": "diff --git a/gateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java b/gateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java\nindex 00fc012c..50142a8a 100644\n--- a/gateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java\n+++ b/gateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java\n\n@@ -124,19 +124,11 @@ public class ZosmfScheme implements AbstractAuthenticationScheme {\n                 switch (queryResponse.getSource()) {\n                     case ZOSMF:\n                         wrapper.removeCookie(authConfigurationProperties.getCookieProperties().getCookieName());\n-                        HttpCookie jwtCookie = new HttpCookie(ZosmfService.TokenType.JWT.getCookieName(), token);\n-                        jwtCookie.setSecure(true);\n-                        jwtCookie.setHttpOnly(true);\n-                        jwtCookie.setVersion(0);\n-                        wrapper.setCookie(jwtCookie);\n+                        createCookie(wrapper, ZosmfService.TokenType.JWT.getCookieName(), token);\n                         break;\n                     case ZOWE:\n                         final String ltpaToken = authenticationService.getLtpaTokenWithValidation(token);\n-                        HttpCookie ltpaCookie = new HttpCookie(ZosmfService.TokenType.LTPA.getCookieName(), ltpaToken);\n-                        ltpaCookie.setSecure(true);\n-                        ltpaCookie.setHttpOnly(true);\n-                        ltpaCookie.setVersion(0);\n-                        wrapper.setCookie(ltpaCookie);\n+                        createCookie(wrapper, ZosmfService.TokenType.LTPA.getCookieName(), ltpaToken);\n                         break;\n                     default:\n                         return;\n"}}, {"oid": "f56148692caf9392df77d4dfd97b0afd5b83278e", "url": "https://github.com/zowe/api-layer/commit/f56148692caf9392df77d4dfd97b0afd5b83278e", "message": "Fixed messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-27T07:40:54Z", "type": "commit"}, {"oid": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "url": "https://github.com/zowe/api-layer/commit/73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "message": "Refactor of the code\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-27T09:41:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4MTQ0Mw==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415681443", "bodyText": "We are loosing the information from the original exception. Maybe at least log the information?", "author": "balhar-jakub", "createdAt": "2020-04-27T10:05:30Z", "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/http/ServiceAuthenticationDecorator.java", "diffHunk": "@@ -0,0 +1,71 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+\n+package org.zowe.apiml.gateway.ribbon.http;\n+\n+import com.netflix.appinfo.InstanceInfo;\n+import com.netflix.zuul.context.RequestContext;\n+import lombok.RequiredArgsConstructor;\n+import org.apache.http.HttpRequest;\n+import org.springframework.security.authentication.BadCredentialsException;\n+import org.springframework.security.core.AuthenticationException;\n+import org.zowe.apiml.gateway.ribbon.RequestContextUtils;\n+import org.zowe.apiml.gateway.security.service.AuthenticationService;\n+import org.zowe.apiml.gateway.security.service.ServiceAuthenticationServiceImpl;\n+import org.zowe.apiml.gateway.security.service.schema.AuthenticationCommand;\n+import org.zowe.apiml.gateway.security.service.schema.ServiceAuthenticationService;\n+import org.zowe.apiml.security.common.auth.Authentication;\n+\n+import static org.zowe.apiml.gateway.security.service.ServiceAuthenticationServiceImpl.AUTHENTICATION_COMMAND_KEY;\n+\n+@RequiredArgsConstructor\n+public class ServiceAuthenticationDecorator {\n+\n+    private final ServiceAuthenticationService serviceAuthenticationService;\n+    private final AuthenticationService authenticationService;\n+\n+    private static final String INVALID_JWT_MESSAGE = \"Invalid JWT token\";\n+\n+    public void process(HttpRequest request) {\n+        final RequestContext context = RequestContext.getCurrentContext();\n+\n+        if (context.get(AUTHENTICATION_COMMAND_KEY) instanceof ServiceAuthenticationServiceImpl.UniversalAuthenticationCommand) {\n+            InstanceInfo info = RequestContextUtils.getInstanceInfo().orElseThrow(\n+                () -> new RequestContextNotPreparedException(\"InstanceInfo of loadbalanced instance is not present in RequestContext\")\n+            );\n+            final Authentication authentication = serviceAuthenticationService.getAuthentication(info);\n+            boolean rejected = false;\n+            AuthenticationCommand cmd = null;\n+\n+            try {\n+                final String jwtToken = authenticationService.getJwtTokenFromRequest(context.getRequest()).orElse(null);\n+\n+                cmd = serviceAuthenticationService.getAuthenticationCommand(authentication, jwtToken);\n+\n+                if (cmd == null) {\n+                    return;\n+                }\n+\n+                if (cmd.isRequiredValidJwt()) {\n+                    rejected = (jwtToken == null) || !authenticationService.validateJwtToken(jwtToken).isAuthenticated();\n+                }\n+            }\n+            catch (AuthenticationException ae) {\n+                rejected = true;", "originalCommit": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4OTg0Nw==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415689847", "bodyText": "Yes I think we may log some message. We just reused part of code from some other class which is doing similar thing (ServiceAuthenticationFilter) , we should add a log there as well. What do you think @jandadav  ?", "author": "taban03", "createdAt": "2020-04-27T10:18:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4MTQ0Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcxMzkwMw==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415713903", "bodyText": "good point, @taban03 we can do it here and build abortexception with cause. The exception handling is already in place for that", "author": "jandadav", "createdAt": "2020-04-27T10:56:53Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4MTQ0Mw=="}], "type": "inlineReview", "revised_code": {"commit": "96385946694689de337fffab4ef073498ca9f270", "chunk": "diff --git a/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/http/ServiceAuthenticationDecorator.java b/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/http/ServiceAuthenticationDecorator.java\nindex 7c380b76..115fbf12 100644\n--- a/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/http/ServiceAuthenticationDecorator.java\n+++ b/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/http/ServiceAuthenticationDecorator.java\n\n@@ -33,6 +33,17 @@ public class ServiceAuthenticationDecorator {\n \n     private static final String INVALID_JWT_MESSAGE = \"Invalid JWT token\";\n \n+    /**\n+     * If a service requires authentication,\n+     *   verify that the specific instance was selected upfront\n+     *   decide whether it requires valid JWT token and if it does\n+     *     verify that the request contains valid one\n+     *\n+     * Prevent ribbon from retrying if Authentication Exception was thrown or if valid JWT token is required and wasn't\n+     * provided.\n+     *\n+     * @param request Current http request.\n+     */\n     public void process(HttpRequest request) {\n         final RequestContext context = RequestContext.getCurrentContext();\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4NDU3Nw==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415684577", "bodyText": "Have you considered implementing as a Bean instead of as a collection of static methods?", "author": "balhar-jakub", "createdAt": "2020-04-27T10:10:25Z", "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/RequestContextUtils.java", "diffHunk": "@@ -0,0 +1,51 @@\n+/*\n+ * This program and the accompanying materials are made available under the terms of the\n+ * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n+ * https://www.eclipse.org/legal/epl-v20.html\n+ *\n+ * SPDX-License-Identifier: EPL-2.0\n+ *\n+ * Copyright Contributors to the Zowe Project.\n+ */\n+\n+package org.zowe.apiml.gateway.ribbon;\n+\n+import com.netflix.appinfo.InstanceInfo;\n+import com.netflix.zuul.context.RequestContext;\n+\n+import java.util.Optional;\n+\n+/**\n+ * Class for storing and retrieving instance information from RequestContext\n+ */\n+public class RequestContextUtils {", "originalCommit": "73fe9c05caf3ee76a60a9b282f9ce873a741cc4d", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4ODE4OQ==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415688189", "bodyText": "It's an utility class which by definitions contain static methods. What would be the advantage of creating instead a bean? Just asking, I don't know, we can definitely do it if it's worthy! :)", "author": "taban03", "createdAt": "2020-04-27T10:16:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4NDU3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTcxMjg3NA==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415712874", "bodyText": "I have considered it but decided to go with static class instead. Given the RequestContext is also static and threadlocal based and ease of testing it, i chose this simple way.", "author": "jandadav", "createdAt": "2020-04-27T10:55:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4NDU3Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTc0Mzg3MQ==", "url": "https://github.com/zowe/api-layer/pull/620#discussion_r415743871", "bodyText": "Beans that we are using and most of the beans in general are Singletons and as such they are more or less equal to the Class with static methods.\nThe difference is mainly in the usage, where the static classes are a bit simpler to use but more difficult to work with in tests.\nAnd in this case I am ok with both choices, I am happy with the answer from David.", "author": "balhar-jakub", "createdAt": "2020-04-27T11:47:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNTY4NDU3Nw=="}], "type": "inlineReview", "revised_code": {"commit": "cd26be286b1c9be062c3e7150566eea1fe2aa2e5", "chunk": "diff --git a/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/RequestContextUtils.java b/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/RequestContextUtils.java\ndeleted file mode 100644\nindex 2a91411d..00000000\n--- a/gateway-service/src/main/java/org/zowe/apiml/gateway/ribbon/RequestContextUtils.java\n+++ /dev/null\n\n@@ -1,51 +0,0 @@\n-/*\n- * This program and the accompanying materials are made available under the terms of the\n- * Eclipse Public License v2.0 which accompanies this distribution, and is available at\n- * https://www.eclipse.org/legal/epl-v20.html\n- *\n- * SPDX-License-Identifier: EPL-2.0\n- *\n- * Copyright Contributors to the Zowe Project.\n- */\n-\n-package org.zowe.apiml.gateway.ribbon;\n-\n-import com.netflix.appinfo.InstanceInfo;\n-import com.netflix.zuul.context.RequestContext;\n-\n-import java.util.Optional;\n-\n-/**\n- * Class for storing and retrieving instance information from RequestContext\n- */\n-public class RequestContextUtils {\n-\n-    private RequestContextUtils() {}\n-\n-    public static final String INSTANCE_INFO_KEY = \"apimlLoadBalancedInstanceInfo\";\n-    public static final String DEBUG_INFO_KEY = \"apimlRibbonRetryDebug\";\n-\n-    public static Optional<InstanceInfo> getInstanceInfo() {\n-        Object o = RequestContext.getCurrentContext().get(INSTANCE_INFO_KEY);\n-        if (!(o instanceof InstanceInfo)) {\n-            return Optional.empty();\n-        } else {\n-            return Optional.of((InstanceInfo) o);\n-        }\n-    }\n-\n-    public static void setInstanceInfo(InstanceInfo info) {\n-        RequestContext.getCurrentContext().set(INSTANCE_INFO_KEY, info);\n-    }\n-\n-    public static void addDebugInfo(String debug) {\n-        String existingDebugInfo = getDebugInfo();\n-        RequestContext.getCurrentContext().set(DEBUG_INFO_KEY,\n-            existingDebugInfo.isEmpty() ? debug : existingDebugInfo + \"|\" + debug);\n-    }\n-\n-    public static String getDebugInfo() {\n-        Object o = RequestContext.getCurrentContext().get(DEBUG_INFO_KEY);\n-        return o != null ? (String) o : \"\";\n-    }\n-}\n"}}, {"oid": "96385946694689de337fffab4ef073498ca9f270", "url": "https://github.com/zowe/api-layer/commit/96385946694689de337fffab4ef073498ca9f270", "message": "Improve documentation, remove duplication in tests (#622)\n\nImprove documentation, remove duplication in tests\r\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>", "committedDate": "2020-04-27T14:30:45Z", "type": "commit"}, {"oid": "516d7da034c8c6ba3d518613828e74e787f77ff3", "url": "https://github.com/zowe/api-layer/commit/516d7da034c8c6ba3d518613828e74e787f77ff3", "message": "Remove Request related part from the Utils\nRename to coherent Cookies class\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>", "committedDate": "2020-04-28T08:45:27Z", "type": "commit"}, {"oid": "d8b10e1735036b7f6e13a1fb3bfd00de8954ec94", "url": "https://github.com/zowe/api-layer/commit/d8b10e1735036b7f6e13a1fb3bfd00de8954ec94", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:28:33Z", "type": "forcePushed"}, {"oid": "cd26be286b1c9be062c3e7150566eea1fe2aa2e5", "url": "https://github.com/zowe/api-layer/commit/cd26be286b1c9be062c3e7150566eea1fe2aa2e5", "message": "switch to retryable client\nfailing gzip integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "573495dc804d223200ad366f95f1363e18751c59", "url": "https://github.com/zowe/api-layer/commit/573495dc804d223200ad366f95f1363e18751c59", "message": "gzip encoding fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "b5c077d0cf716dfedea79d7eccb2d0202596757d", "url": "https://github.com/zowe/api-layer/commit/b5c077d0cf716dfedea79d7eccb2d0202596757d", "message": "refactor http client proxy and aop\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "d4e7a9c79497dafbebd03696003adad786d70ff7", "url": "https://github.com/zowe/api-layer/commit/d4e7a9c79497dafbebd03696003adad786d70ff7", "message": "cleanup refactored classes\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "8f440a2bee636f40810bfe51cda2fa784fc7adc8", "url": "https://github.com/zowe/api-layer/commit/8f440a2bee636f40810bfe51cda2fa784fc7adc8", "message": "RequestUtils\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "5b243af0c24e23278b4a49f209c5f8b6039e44df", "url": "https://github.com/zowe/api-layer/commit/5b243af0c24e23278b4a49f209c5f8b6039e44df", "message": "Request decorator\nAuthenticationCommand changes\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "60359fde6fb270cd64135c1fb0059b9a9d5ecf00", "url": "https://github.com/zowe/api-layer/commit/60359fde6fb270cd64135c1fb0059b9a9d5ecf00", "message": "fix proxy tests\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "78ac24af515f3a3fb8eb8c578c25a052904303fb", "url": "https://github.com/zowe/api-layer/commit/78ac24af515f3a3fb8eb8c578c25a052904303fb", "message": "Refactor ZosmfSchemeTest\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "b45d99161b88f869a466fbdc55ecbfbf41192298", "url": "https://github.com/zowe/api-layer/commit/b45d99161b88f869a466fbdc55ecbfbf41192298", "message": "Implementation of applyToReques method for the ZoweScheme class and added test (wip)\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "53e5415c4cb94c9a2972bdf76b5abecd287f924f", "url": "https://github.com/zowe/api-layer/commit/53e5415c4cb94c9a2972bdf76b5abecd287f924f", "message": "Use cookie version 0\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "8fae948c6c163a7420ba9d39226e94604665caa6", "url": "https://github.com/zowe/api-layer/commit/8fae948c6c163a7420ba9d39226e94604665caa6", "message": "implement applyToRequest for AuthenticationCommand and PassTicketCommand\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "195603260b73eb8001f8fb728d2b29171fdaf6c4", "url": "https://github.com/zowe/api-layer/commit/195603260b73eb8001f8fb728d2b29171fdaf6c4", "message": "Add more tests for zosmfscheme class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "010219fe141bf36b3d6b6c6bbbb98bc85c0342d3", "url": "https://github.com/zowe/api-layer/commit/010219fe141bf36b3d6b6c6bbbb98bc85c0342d3", "message": "make test independent of test execution order\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "8e51f10889ef84c1a9d2175f87c78663433b54e6", "url": "https://github.com/zowe/api-layer/commit/8e51f10889ef84c1a9d2175f87c78663433b54e6", "message": "Exceptions and test for ServiceAuthenticationDecorator\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "efac37358c2eb89c86dea542dcea5d1aba8c49b5", "url": "https://github.com/zowe/api-layer/commit/efac37358c2eb89c86dea542dcea5d1aba8c49b5", "message": "Exception handling and messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:41Z", "type": "commit"}, {"oid": "0f97653b0569dc91f2d7f746b808ed68df04685b", "url": "https://github.com/zowe/api-layer/commit/0f97653b0569dc91f2d7f746b808ed68df04685b", "message": "Add implementation of process method and add unit tests for Decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "37cc322ba60ac2578d1623fcfa8e03fac0aaabef", "url": "https://github.com/zowe/api-layer/commit/37cc322ba60ac2578d1623fcfa8e03fac0aaabef", "message": "SecurityDecorator exceptionhandling\nByPassScheme fix\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "9c236a55d32f7248234b33cd74530982d5f103ea", "url": "https://github.com/zowe/api-layer/commit/9c236a55d32f7248234b33cd74530982d5f103ea", "message": "Javadoc, checkstyle and small fixes\ncleanup\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "6ab840c4f391b4c041fb9eb1ad11f0220185e74b", "url": "https://github.com/zowe/api-layer/commit/6ab840c4f391b4c041fb9eb1ad11f0220185e74b", "message": "refactor ServiceAuthenticationDecoratorTest\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "39cefc2a00982c23e84fd3375a5cd3c29441805a", "url": "https://github.com/zowe/api-layer/commit/39cefc2a00982c23e84fd3375a5cd3c29441805a", "message": "Suppress log messages\nSendErrorFilter\nNo handler for GET /error\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "9bc933b31d1e3ac4a62e0a35d39c40397e56467e", "url": "https://github.com/zowe/api-layer/commit/9bc933b31d1e3ac4a62e0a35d39c40397e56467e", "message": "Fix sonar problems and add unit test for decorator class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "2984803375318a274a4f7a6263b207660b6665c3", "url": "https://github.com/zowe/api-layer/commit/2984803375318a274a4f7a6263b207660b6665c3", "message": "Fix sonar problems with Cookie security\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "3df5d617543f82c0fe86ba0dd3ff610225c2adca", "url": "https://github.com/zowe/api-layer/commit/3df5d617543f82c0fe86ba0dd3ff610225c2adca", "message": "Fix more sonar problems and add unit test for RibbonRetryError class\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "e492efa70dad217fa6111c71540a1207fa9e75a4", "url": "https://github.com/zowe/api-layer/commit/e492efa70dad217fa6111c71540a1207fa9e75a4", "message": "Http/Https resolution for service instances\nRefactor exceptions\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "8d668dcf62e478818fbfcc5a547cf4a3a9b7a451", "url": "https://github.com/zowe/api-layer/commit/8d668dcf62e478818fbfcc5a547cf4a3a9b7a451", "message": "Initialize client with LoadBalancerContext\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "ee891ac02b493db2b368c835e511e7a031d2a46e", "url": "https://github.com/zowe/api-layer/commit/ee891ac02b493db2b368c835e511e7a031d2a46e", "message": "Local integration test for retry\nDebug headers for diag profile, used by integration test\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "f715319afd54e29323125264ebae3f98721402a2", "url": "https://github.com/zowe/api-layer/commit/f715319afd54e29323125264ebae3f98721402a2", "message": "additional error catch\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "189b01d4a09c3eb376ac009c03e7013f59d68665", "url": "https://github.com/zowe/api-layer/commit/189b01d4a09c3eb376ac009c03e7013f59d68665", "message": "Fixed messages\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "da19fd7b840d5e62b8d0b08facabc76cc764f24b", "url": "https://github.com/zowe/api-layer/commit/da19fd7b840d5e62b8d0b08facabc76cc764f24b", "message": "Refactor of the code\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "21842a19d312d3054d31254b05cd0a61798de83c", "url": "https://github.com/zowe/api-layer/commit/21842a19d312d3054d31254b05cd0a61798de83c", "message": "Improve documentation, remove duplication in tests (#622)\n\nImprove documentation, remove duplication in tests\r\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>\r\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "dfbd67f9c9f134dfabdc30378c8d048726a23ca4", "url": "https://github.com/zowe/api-layer/commit/dfbd67f9c9f134dfabdc30378c8d048726a23ca4", "message": "try tests in jenkins\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "ea1be4be4da0d710e16d79902718937604efa1e7", "url": "https://github.com/zowe/api-layer/commit/ea1be4be4da0d710e16d79902718937604efa1e7", "message": "styles\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "fb845d280f997e6152c79fa825cccfb6c50cd9c4", "url": "https://github.com/zowe/api-layer/commit/fb845d280f997e6152c79fa825cccfb6c50cd9c4", "message": "split auth tests\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "65ac91571238dd9bfe8b039974e765774eb54fb7", "url": "https://github.com/zowe/api-layer/commit/65ac91571238dd9bfe8b039974e765774eb54fb7", "message": "change applid\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "6b5b8cadeed0589c3024373350b3bc43802259e3", "url": "https://github.com/zowe/api-layer/commit/6b5b8cadeed0589c3024373350b3bc43802259e3", "message": "change applid and assertion\n\nSigned-off-by: achmelo <a.chmelo@gmail.com>\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "url": "https://github.com/zowe/api-layer/commit/97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "commit"}, {"oid": "97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "url": "https://github.com/zowe/api-layer/commit/97cc0ea80c1fdebc7fb714d766dfcc7f6212a91f", "message": "fixed checkstyle\n\nSigned-off-by: jandadav <janda.david@gmail.com>", "committedDate": "2020-04-28T09:31:42Z", "type": "forcePushed"}, {"oid": "4e50c54d30cac72e5fad2dc69a6314b9d6c7bf1b", "url": "https://github.com/zowe/api-layer/commit/4e50c54d30cac72e5fad2dc69a6314b9d6c7bf1b", "message": "Reflect removal of Header related functionality in tests\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>", "committedDate": "2020-04-28T09:36:14Z", "type": "commit"}, {"oid": "39a8512d5a50a0f2d671d07a8c6f50e07e930863", "url": "https://github.com/zowe/api-layer/commit/39a8512d5a50a0f2d671d07a8c6f50e07e930863", "message": "Clean unused imports\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>", "committedDate": "2020-04-28T09:36:56Z", "type": "commit"}, {"oid": "2246337bfc98648f8fdf827850473472e78a868f", "url": "https://github.com/zowe/api-layer/commit/2246337bfc98648f8fdf827850473472e78a868f", "message": "Remove Authorization instead of setting to null\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>", "committedDate": "2020-04-28T09:37:13Z", "type": "commit"}, {"oid": "c33e475db7760a6d729b2578fc1e93e4c9f35b45", "url": "https://github.com/zowe/api-layer/commit/c33e475db7760a6d729b2578fc1e93e4c9f35b45", "message": "Merge remote-tracking branch 'origin/rip/US654068/leverage-ha-modes-for-downstream-services' into rip/US654068/leverage-ha-modes-for-downstream-services\n\n# Conflicts:\n#\tgateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/HttpBasicPassTicketScheme.java\n#\tgateway-service/src/main/java/org/zowe/apiml/gateway/security/service/schema/ZosmfScheme.java\n#\tgateway-service/src/test/java/org/zowe/apiml/gateway/security/service/schema/HttpBasicPassTicketSchemeTest.java\n#\tgateway-service/src/test/java/org/zowe/apiml/gateway/security/service/schema/ZosmfSchemeTest.java\n#\tintegration-tests/src/test/java/org/zowe/apiml/gatewayservice/ServiceHaMode.java", "committedDate": "2020-04-28T09:41:04Z", "type": "commit"}, {"oid": "31ceea538667eaa32441010c152d9b9046d648c5", "url": "https://github.com/zowe/api-layer/commit/31ceea538667eaa32441010c152d9b9046d648c5", "message": "Remove Authorization instead of setting to null\n\nSigned-off-by: Jakub Balhar <jakub.balhar@broadcom.com>", "committedDate": "2020-04-28T09:44:02Z", "type": "commit"}, {"oid": "fa13d9660b6cac8aa590b0373893293f15899d64", "url": "https://github.com/zowe/api-layer/commit/fa13d9660b6cac8aa590b0373893293f15899d64", "message": "Improve errorCheck for requestAbort exception to handle nested exceptions cause and refactor of process method\n\nSigned-off-by: at670475 <andrea.tabone@broadcom.com>", "committedDate": "2020-04-28T11:50:08Z", "type": "commit"}]}