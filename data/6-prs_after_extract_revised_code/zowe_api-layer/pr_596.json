{"pr_number": 596, "pr_title": "Fix throughput via ZUUL with bypass authentication scheme", "pr_createdAt": "2020-04-07T20:25:21Z", "pr_url": "https://github.com/zowe/api-layer/pull/596", "timeline": [{"oid": "f993bc257c2fadccef6c756024f405d3cbdc1e9b", "url": "https://github.com/zowe/api-layer/commit/f993bc257c2fadccef6c756024f405d3cbdc1e9b", "message": "draft of implementation\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-02T11:43:02Z", "type": "commit"}, {"oid": "73206d05c061131a536086661b43fd2893e3b672", "url": "https://github.com/zowe/api-layer/commit/73206d05c061131a536086661b43fd2893e3b672", "message": "fix discoverable client and integration test, filter sign by certificates to use only APIML certificate\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-07T20:20:57Z", "type": "commit"}, {"oid": "5f8c8bb86adff3d36ed7b9192284f5c1e066aa91", "url": "https://github.com/zowe/api-layer/commit/5f8c8bb86adff3d36ed7b9192284f5c1e066aa91", "message": "Merge remote-tracking branch 'remotes/origin/master' into protectors/zuulThroughput\n\n# Conflicts:\n#\tgateway-service/src/main/java/org/zowe/apiml/gateway/filters/pre/JwtValidatorFilter.java\n#\tgateway-service/src/main/java/org/zowe/apiml/gateway/routing/ApimlRoutingConfig.java\n#\tgateway-service/src/test/java/org/zowe/apiml/gateway/filters/pre/JwtValidatorFilterTest.java\n#\tgateway-service/src/test/java/org/zowe/apiml/gateway/security/service/schema/HttpBasicPassTicketSchemeTest.java", "committedDate": "2020-04-07T20:33:19Z", "type": "commit"}, {"oid": "3901dcfc34a62c4ea22986691142876bca49f7f9", "url": "https://github.com/zowe/api-layer/commit/3901dcfc34a62c4ea22986691142876bca49f7f9", "message": "fix test after merge\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-07T20:42:01Z", "type": "commit"}, {"oid": "5d96ce359b3747acc29134348f29db94e5b37eb8", "url": "https://github.com/zowe/api-layer/commit/5d96ce359b3747acc29134348f29db94e5b37eb8", "message": "fix integration tests\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-08T10:05:08Z", "type": "commit"}, {"oid": "1e68bc40a6447a1a37d37a517205761e3e82ee0f", "url": "https://github.com/zowe/api-layer/commit/1e68bc40a6447a1a37d37a517205761e3e82ee0f", "message": "Merge branch 'master' into protectors/zuulThroughput", "committedDate": "2020-04-08T10:22:31Z", "type": "commit"}, {"oid": "309b10d606f268e0581a0226310fc853f11413c6", "url": "https://github.com/zowe/api-layer/commit/309b10d606f268e0581a0226310fc853f11413c6", "message": "fix merge (imports)\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-08T10:26:40Z", "type": "commit"}, {"oid": "8b059d1c3e436bef87c598399eb73078906890b7", "url": "https://github.com/zowe/api-layer/commit/8b059d1c3e436bef87c598399eb73078906890b7", "message": "fix integration tests\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-08T13:05:40Z", "type": "commit"}, {"oid": "4efdc9885ce58cfb2e59d4375905ce109deb8cac", "url": "https://github.com/zowe/api-layer/commit/4efdc9885ce58cfb2e59d4375905ce109deb8cac", "message": "code coverage improve\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-08T16:01:08Z", "type": "commit"}, {"oid": "0af776381f269f91c2f5bfec66cdac9b2b708c47", "url": "https://github.com/zowe/api-layer/commit/0af776381f269f91c2f5bfec66cdac9b2b708c47", "message": "fix integration tests\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-08T17:07:31Z", "type": "commit"}, {"oid": "d17dfc6414864d4e2661d956541c1afd20200ea9", "url": "https://github.com/zowe/api-layer/commit/d17dfc6414864d4e2661d956541c1afd20200ea9", "message": "fix integration test - revert status on accessServiceWithIncorrectApplId\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-08T20:43:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5NDcxNg==", "url": "https://github.com/zowe/api-layer/pull/596#discussion_r405994716", "bodyText": "What is the current message if not ZWAG102E?", "author": "plavjanik", "createdAt": "2020-04-09T06:59:30Z", "path": "integration-tests/src/test/java/org/zowe/apiml/gatewayservice/ZosmfSsoIntegrationTest.java", "diffHunk": "@@ -126,9 +126,7 @@ public void doZosmfCallWithInvalidToken() {\n         .when()\n             .get(String.format(\"%s://%s:%d%s%s\", scheme, host, port, BASE_PATH, ZOSMF_ENDPOINT))\n         .then()\n-            .statusCode(is(SC_UNAUTHORIZED))", "originalCommit": "d17dfc6414864d4e2661d956541c1afd20200ea9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5NjE3Ng==", "url": "https://github.com/zowe/api-layer/pull/596#discussion_r405996176", "bodyText": "It is same like before issue (with JWTValidationFilter), it is stopped by ServiceAuthenticationFilter. There cannot be a concrete message.", "author": "pj892031", "createdAt": "2020-04-09T07:02:50Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5NDcxNg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAyODk3Ng==", "url": "https://github.com/zowe/api-layer/pull/596#discussion_r406028976", "bodyText": "I see. Thank you", "author": "plavjanik", "createdAt": "2020-04-09T08:08:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTk5NDcxNg=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAyMTk4NQ==", "url": "https://github.com/zowe/api-layer/pull/596#discussion_r406021985", "bodyText": "What is the purpose of this regex?", "author": "plavjanik", "createdAt": "2020-04-09T07:55:44Z", "path": "gateway-service/src/main/java/org/zowe/apiml/gateway/security/config/SecurityConfiguration.java", "diffHunk": "@@ -92,7 +96,10 @@ protected void configure(HttpSecurity http) throws Exception {\n             .authorizeRequests()\n             .antMatchers(HttpMethod.POST, authConfigurationProperties.getGatewayTicketEndpoint()).authenticated()\n             .and()\n-            .x509().userDetailsService(x509UserDetailsService())\n+            .x509()\n+                .x509AuthenticationFilter(apimlX509AuthenticationFilter())\n+                .subjectPrincipalRegex(\"CN=(.*?)(?:,|$)\")", "originalCommit": "d17dfc6414864d4e2661d956541c1afd20200ea9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAyNzc4NA==", "url": "https://github.com/zowe/api-layer/pull/596#discussion_r406027784", "bodyText": "This regex is default one, to extract CN from the certificate. I used it there just because I need custom implementation.", "author": "pj892031", "createdAt": "2020-04-09T08:06:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAyMTk4NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAyOTE4Nw==", "url": "https://github.com/zowe/api-layer/pull/596#discussion_r406029187", "bodyText": "Thank you", "author": "plavjanik", "createdAt": "2020-04-09T08:08:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNjAyMTk4NQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "7fd21de167bbf3507ad2a599800db86eaa7d4ac9", "url": "https://github.com/zowe/api-layer/commit/7fd21de167bbf3507ad2a599800db86eaa7d4ac9", "message": "fix code smells\n\nSigned-off-by: Pavel Jare\u0161 <pavel.jares@broadcom.com>", "committedDate": "2020-04-09T08:15:20Z", "type": "commit"}]}