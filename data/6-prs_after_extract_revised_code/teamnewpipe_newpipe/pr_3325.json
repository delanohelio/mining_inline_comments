{"pr_number": 3325, "pr_title": "Integer overflow fixes in downloader", "pr_createdAt": "2020-04-01T18:17:45Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/3325", "timeline": [{"oid": "96086b7733fac4bc982c4ad77a7c0c1b823b637a", "url": "https://github.com/TeamNewPipe/NewPipe/commit/96086b7733fac4bc982c4ad77a7c0c1b823b637a", "message": "code cleanup", "committedDate": "2020-04-01T18:30:32Z", "type": "commit"}, {"oid": "62d934dd8e89cc751c90e0c6a9ec36ea606cfbee", "url": "https://github.com/TeamNewPipe/NewPipe/commit/62d934dd8e89cc751c90e0c6a9ec36ea606cfbee", "message": "fix integer overflows\n\n* available() method in ChunkFileInputStream.java\n* free \"ahead space\" calculation in CircularFileWriter.java", "committedDate": "2020-04-01T18:30:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMDk4Nw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3325#discussion_r401830987", "bodyText": "Was it a bug that it had readInt() instead of readUnsignedInt() here? Or did you somehow accidentally change this? Other than this, this PR looks good, but I haven't tested it yet.", "author": "wb9688", "createdAt": "2020-04-01T18:43:07Z", "path": "app/src/main/java/org/schabi/newpipe/streams/Mp4DashReader.java", "diffHunk": "@@ -317,7 +313,7 @@ private String boxName(int type) {\n     private Box readBox() throws IOException {\r\n         Box b = new Box();\r\n         b.offset = stream.position();\r\n-        b.size = stream.readInt();\r\n+        b.size = stream.readUnsignedInt();\r", "originalCommit": "62d934dd8e89cc751c90e0c6a9ec36ea606cfbee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg1MzQzNw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3325#discussion_r401853437", "bodyText": "no, the fix is here 62d934d", "author": "kapodamy", "createdAt": "2020-04-01T19:22:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMDk4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg1NDEyNw==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3325#discussion_r401854127", "bodyText": "I understand that, but why did you change this line?\nEdit: hmm\u2026 a size can't be negative, right?", "author": "wb9688", "createdAt": "2020-04-01T19:23:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMDk4Nw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTg1OTI0MA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3325#discussion_r401859240", "bodyText": "in somewhere was an overflow (the file was to big), so i discarded every possible overflow. Also, in mp4 box sizes are unsigned values, but since in DASH streams, bigger boxes llike mdat never reachs 2GB\nyes, size cannot be negative", "author": "kapodamy", "createdAt": "2020-04-01T19:32:59Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMTgzMDk4Nw=="}], "type": "inlineReview", "revised_code": null}]}