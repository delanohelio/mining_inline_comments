{"pr_number": 3613, "pr_title": "Fix download dialog freeze", "pr_createdAt": "2020-05-18T09:47:30Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/3613", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUxNTIwOQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3613#discussion_r426515209", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                static int getMostCompactAudioIndex(MediaFormat format, final List<AudioStream> audioStreams) {\n          \n          \n            \n                static int getMostCompactAudioIndex(@Nullable MediaFormat format, final List<AudioStream> audioStreams) {", "author": "Stypox", "createdAt": "2020-05-18T10:07:55Z", "path": "app/src/main/java/org/schabi/newpipe/util/ListHelper.java", "diffHunk": "@@ -293,30 +292,28 @@ static int getHighestQualityAudioIndex(final MediaFormat format,\n                 if (result == -1 && format == null) {\n                     break;\n                 }\n-                hasOneFormat = true;\n+                format = null;\n             }\n         }\n         return result;\n     }\n \n     /**\n-     * Get the audio from the list with the lowest bitrate and efficient format. Format will be\n-     * ignored if it yields no results.\n+     * Get the audio from the list with the lowest bitrate and most efficient format.\n+     * Format will be ignored if it yields no results.\n      *\n      * @param format       The target format type or null if it doesn't matter\n      * @param audioStreams List of audio streams\n-     * @return Index of audio stream that can produce the most compact results or -1 if not found\n+     * @return Index of audio stream that produces the most compact results or -1 if not found\n      */\n-    static int getMostCompactAudioIndex(final MediaFormat format,\n-                                        final List<AudioStream> audioStreams) {\n+    static int getMostCompactAudioIndex(MediaFormat format, final List<AudioStream> audioStreams) {", "originalCommit": "02f804b3535187aae8f91a8a40c04ac0fbb58477", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "93ba7510e16ad51941eae02e48fd1e47446f9f3c", "chunk": "diff --git a/app/src/main/java/org/schabi/newpipe/util/ListHelper.java b/app/src/main/java/org/schabi/newpipe/util/ListHelper.java\nindex 59f0d42e8..189b6823e 100644\n--- a/app/src/main/java/org/schabi/newpipe/util/ListHelper.java\n+++ b/app/src/main/java/org/schabi/newpipe/util/ListHelper.java\n\n@@ -306,7 +307,8 @@ public final class ListHelper {\n      * @param audioStreams List of audio streams\n      * @return Index of audio stream that produces the most compact results or -1 if not found\n      */\n-    static int getMostCompactAudioIndex(MediaFormat format, final List<AudioStream> audioStreams) {\n+    static int getMostCompactAudioIndex(@Nullable MediaFormat format,\n+                                        final List<AudioStream> audioStreams) {\n         int result = -1;\n         if (audioStreams != null) {\n             while (result == -1) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUxNTU3MQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3613#discussion_r426515571", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                static int getHighestQualityAudioIndex(MediaFormat format,\n          \n          \n            \n                static int getHighestQualityAudioIndex(@Nullable MediaFormat format,", "author": "Stypox", "createdAt": "2020-05-18T10:08:35Z", "path": "app/src/main/java/org/schabi/newpipe/util/ListHelper.java", "diffHunk": "@@ -267,23 +267,22 @@ private static void sortStreamList(final List<VideoStream> videoStreams,\n     }\n \n     /**\n-     * Get the audio from the list with the highest quality. Format will be ignored if it yields\n-     * no results.\n+     * Get the audio from the list with the highest quality.\n+     * Format will be ignored if it yields no results.\n      *\n-     * @param format       the format to look for\n-     * @param audioStreams list the audio streams\n-     * @return index of the audio with the highest average bitrate of the default format\n+     * @param format       The target format type or null if it doesn't matter\n+     * @param audioStreams List of audio streams\n+     * @return Index of audio stream that produces the most compact results or -1 if not found\n      */\n-    static int getHighestQualityAudioIndex(final MediaFormat format,\n+    static int getHighestQualityAudioIndex(MediaFormat format,", "originalCommit": "02f804b3535187aae8f91a8a40c04ac0fbb58477", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "93ba7510e16ad51941eae02e48fd1e47446f9f3c", "chunk": "diff --git a/app/src/main/java/org/schabi/newpipe/util/ListHelper.java b/app/src/main/java/org/schabi/newpipe/util/ListHelper.java\nindex 59f0d42e8..189b6823e 100644\n--- a/app/src/main/java/org/schabi/newpipe/util/ListHelper.java\n+++ b/app/src/main/java/org/schabi/newpipe/util/ListHelper.java\n\n@@ -274,7 +275,7 @@ public final class ListHelper {\n      * @param audioStreams List of audio streams\n      * @return Index of audio stream that produces the most compact results or -1 if not found\n      */\n-    static int getHighestQualityAudioIndex(MediaFormat format,\n+    static int getHighestQualityAudioIndex(@Nullable MediaFormat format,\n                                            final List<AudioStream> audioStreams) {\n         int result = -1;\n         if (audioStreams != null) {\n"}}, {"oid": "93ba7510e16ad51941eae02e48fd1e47446f9f3c", "url": "https://github.com/TeamNewPipe/NewPipe/commit/93ba7510e16ad51941eae02e48fd1e47446f9f3c", "message": "Fix ListHelper ANR", "committedDate": "2020-05-18T11:40:01Z", "type": "commit"}, {"oid": "8968081e7744a2a5053aaa34ee4884870ca8fb7f", "url": "https://github.com/TeamNewPipe/NewPipe/commit/8968081e7744a2a5053aaa34ee4884870ca8fb7f", "message": "Remove not needed Checkstyle stuff", "committedDate": "2020-05-18T11:40:01Z", "type": "commit"}]}