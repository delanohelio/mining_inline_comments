{"pr_number": 3772, "pr_title": "Copy video title", "pr_createdAt": "2020-06-10T21:44:25Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/3772", "timeline": [{"oid": "e34f666b70f49a89f5b3b89dff84513233e519de", "url": "https://github.com/TeamNewPipe/NewPipe/commit/e34f666b70f49a89f5b3b89dff84513233e519de", "message": "set an OnLongClickListener", "committedDate": "2020-06-10T21:11:06Z", "type": "commit"}, {"oid": "b5375396d27ec72baf448dc7733f2e5c32a2b38b", "url": "https://github.com/TeamNewPipe/NewPipe/commit/b5375396d27ec72baf448dc7733f2e5c32a2b38b", "message": "allowed user to copy video title to clipboard (from detail screen)", "committedDate": "2020-06-10T21:17:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyNzA1NQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438427055", "bodyText": "Move this call up and thus remove this otherwise pointless function. You probably also shouldn't depend on stuff in GigaGet (also because we want to remove GigaGet in the future). Not sure if we have any util like this in NewPipe, or even have a copy to clipboard feature anywhere in NewPipe.", "author": "wb9688", "createdAt": "2020-06-10T21:47:59Z", "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -1422,4 +1428,8 @@ private void updateProgressInfo(@NonNull final StreamInfo info) {\n                     animateView(detailPositionView, false, 500);\n                 });\n     }\n+\n+    private void copyTitleText() {\n+        Utility.copyToClipboard(getContext(), videoTitleTextView.getText().toString());", "originalCommit": "b5375396d27ec72baf448dc7733f2e5c32a2b38b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyODI5NQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438428295", "bodyText": "We have copy to clipboard when we long press comments #3053", "author": "B0pol", "createdAt": "2020-06-10T21:51:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyNzA1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzMDI2MQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438430261", "bodyText": "In that case, could you move the code starting at https://github.com/TeamNewPipe/NewPipe/blob/dev/app/src/main/java/org/schabi/newpipe/info_list/holder/CommentsMiniInfoItemHolder.java#L133 to a separate function in the most appropriate util class in NewPipe (I guess ShareUtils, though it isn't really sharing) and use that here as well?", "author": "wb9688", "createdAt": "2020-06-10T21:55:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyNzA1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzNDQzOQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438434439", "bodyText": "It isn't really sharing, but then open in browser isn't too. I think the ShareUtils name is a good fit, since it contains functions to export pieces of information outside of the app in order to interact with it differently (i.e. sharing to a different app/platform/usage method)", "author": "Stypox", "createdAt": "2020-06-10T22:06:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyNzA1NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQzNzk3Mg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438437972", "bodyText": "Ok I added copyToClipboard() to ShareUtils, which is now called for copying comments and for copying the video title", "author": "adinilfeld", "createdAt": "2020-06-10T22:16:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODQyNzA1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "267e114354ba2d1ee210cfa2d3526665b5470469", "chunk": "diff --git a/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java b/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java\nindex a8b007bf4..44f18a4ea 100644\n--- a/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java\n+++ b/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java\n\n@@ -1428,8 +1427,4 @@ public class VideoDetailFragment extends BaseStateFragment<StreamInfo>\n                     animateView(detailPositionView, false, 500);\n                 });\n     }\n-\n-    private void copyTitleText() {\n-        Utility.copyToClipboard(getContext(), videoTitleTextView.getText().toString());\n-    }\n }\n"}}, {"oid": "267e114354ba2d1ee210cfa2d3526665b5470469", "url": "https://github.com/TeamNewPipe/NewPipe/commit/267e114354ba2d1ee210cfa2d3526665b5470469", "message": "added a copyToClipboard method to ShareUtils, and modified CommentsMiniInfoItemHolder and VideoDetailFragment to use the new method.", "committedDate": "2020-06-10T22:14:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODcyMjkzOQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438722939", "bodyText": "I don't think this line is needed, as setOnLongClickListener already makes the view long clickable: https://developer.android.com/reference/android/view/View#setOnLongClickListener(android.view.View.OnLongClickListener)", "author": "Stypox", "createdAt": "2020-06-11T11:40:27Z", "path": "app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java", "diffHunk": "@@ -583,6 +585,9 @@ protected void initViews(final View rootView, final Bundle savedInstanceState) {\n     protected void initListeners() {\n         super.initListeners();\n \n+        videoTitleRoot.setLongClickable(true);", "originalCommit": "267e114354ba2d1ee210cfa2d3526665b5470469", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0d29e66092ed363266211455a78948508fc22e77", "chunk": "diff --git a/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java b/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java\nindex 44f18a4ea..fff689930 100644\n--- a/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java\n+++ b/app/src/main/java/org/schabi/newpipe/fragments/detail/VideoDetailFragment.java\n\n@@ -585,9 +585,7 @@ public class VideoDetailFragment extends BaseStateFragment<StreamInfo>\n     protected void initListeners() {\n         super.initListeners();\n \n-        videoTitleRoot.setLongClickable(true);\n         videoTitleRoot.setOnLongClickListener(this);\n-\n         uploaderRootLayout.setOnClickListener(this);\n         uploaderRootLayout.setOnLongClickListener(this);\n         videoTitleRoot.setOnClickListener(this);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODcyMzcxNg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438723716", "bodyText": "Even though this is unrelated from your changes, could you invert the two branches of the if, while also removing the ! ?\n\n  \n    \n      \n        Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        if (!AndroidTvUtils.isTv(itemBuilder.getContext())) {\n          \n          \n            \n                            ClipboardManager clipboardManager = (ClipboardManager) itemBuilder.getContext()\n          \n          \n            \n                                    .getSystemService(Context.CLIPBOARD_SERVICE);\n          \n          \n            \n                            clipboardManager.setPrimaryClip(ClipData.newPlainText(null, commentText));\n          \n          \n            \n                            Toast.makeText(itemBuilder.getContext(), R.string.msg_copied, Toast.LENGTH_SHORT)\n          \n          \n            \n                                    .show();\n          \n          \n            \n                            ShareUtils.copyToClipboard(itemBuilder.getContext(), commentText);\n          \n          \n            \n                        } else {\n          \n          \n            \n                            openCommentAuthor(item);\n          \n          \n            \n                        }\n          \n          \n            \n                        if (AndroidTvUtils.isTv(itemBuilder.getContext())) {\n          \n          \n            \n                            openCommentAuthor(item);\n          \n          \n            \n                        } else {\n          \n          \n            \n                            ShareUtils.copyToClipboard(itemBuilder.getContext(), commentText);\n          \n          \n            \n                        }", "author": "Stypox", "createdAt": "2020-06-11T11:42:08Z", "path": "app/src/main/java/org/schabi/newpipe/info_list/holder/CommentsMiniInfoItemHolder.java", "diffHunk": "@@ -130,11 +127,7 @@ public void updateFromItem(final InfoItem infoItem,\n \n         itemView.setOnLongClickListener(view -> {\n             if (!AndroidTvUtils.isTv(itemBuilder.getContext())) {\n-                ClipboardManager clipboardManager = (ClipboardManager) itemBuilder.getContext()\n-                        .getSystemService(Context.CLIPBOARD_SERVICE);\n-                clipboardManager.setPrimaryClip(ClipData.newPlainText(null, commentText));\n-                Toast.makeText(itemBuilder.getContext(), R.string.msg_copied, Toast.LENGTH_SHORT)\n-                        .show();\n+                ShareUtils.copyToClipboard(itemBuilder.getContext(), commentText);\n             } else {\n                 openCommentAuthor(item);\n             }", "originalCommit": "267e114354ba2d1ee210cfa2d3526665b5470469", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODk0ODQwNQ==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438948405", "bodyText": "I made that code, the logic behind it was that non-TV is more common", "author": "wb9688", "createdAt": "2020-06-11T17:24:12Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODcyMzcxNg=="}], "type": "inlineReview", "revised_code": {"commit": "59e0c10c4299742f99bee43a478aca36393a57f1", "chunk": "diff --git a/app/src/main/java/org/schabi/newpipe/info_list/holder/CommentsMiniInfoItemHolder.java b/app/src/main/java/org/schabi/newpipe/info_list/holder/CommentsMiniInfoItemHolder.java\nindex d94762c4d..863273a88 100644\n--- a/app/src/main/java/org/schabi/newpipe/info_list/holder/CommentsMiniInfoItemHolder.java\n+++ b/app/src/main/java/org/schabi/newpipe/info_list/holder/CommentsMiniInfoItemHolder.java\n\n@@ -126,10 +126,10 @@ public class CommentsMiniInfoItemHolder extends InfoItemHolder {\n \n \n         itemView.setOnLongClickListener(view -> {\n-            if (!AndroidTvUtils.isTv(itemBuilder.getContext())) {\n-                ShareUtils.copyToClipboard(itemBuilder.getContext(), commentText);\n-            } else {\n+            if (AndroidTvUtils.isTv(itemBuilder.getContext())) {\n                 openCommentAuthor(item);\n+            } else {\n+                ShareUtils.copyToClipboard(itemBuilder.getContext(), commentText);\n             }\n             return true;\n         });\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODcyNDk0NA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/3772#discussion_r438724944", "bodyText": "This variable could be final", "author": "wb9688", "createdAt": "2020-06-11T11:44:59Z", "path": "app/src/main/java/org/schabi/newpipe/util/ShareUtils.java", "diffHunk": "@@ -78,4 +81,27 @@ public static void shareUrl(final Context context, final String subject, final S\n         context.startActivity(Intent.createChooser(\n                 intent, context.getString(R.string.share_dialog_title)));\n     }\n+\n+    /**\n+     * Copy the text to clipboard, and indicate to the user whether the operation was completed\n+     * successfully using a Toast.\n+     *\n+     * @param context the context to use\n+     * @param text    the text to copy\n+     */\n+    public static void copyToClipboard(final Context context, final String text) {\n+        ClipboardManager clipboardManager =", "originalCommit": "267e114354ba2d1ee210cfa2d3526665b5470469", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "17d1346a8a2fc31e0d35f991194c7097fe2b0c22", "chunk": "diff --git a/app/src/main/java/org/schabi/newpipe/util/ShareUtils.java b/app/src/main/java/org/schabi/newpipe/util/ShareUtils.java\nindex 1b87f4f14..0ec2d571d 100644\n--- a/app/src/main/java/org/schabi/newpipe/util/ShareUtils.java\n+++ b/app/src/main/java/org/schabi/newpipe/util/ShareUtils.java\n\n@@ -90,7 +90,7 @@ public final class ShareUtils {\n      * @param text    the text to copy\n      */\n     public static void copyToClipboard(final Context context, final String text) {\n-        ClipboardManager clipboardManager =\n+        final ClipboardManager clipboardManager =\n                 (ClipboardManager) context.getSystemService(Context.CLIPBOARD_SERVICE);\n \n         if (clipboardManager == null) {\n"}}, {"oid": "0d29e66092ed363266211455a78948508fc22e77", "url": "https://github.com/TeamNewPipe/NewPipe/commit/0d29e66092ed363266211455a78948508fc22e77", "message": "removed unnecessary setLongClickable", "committedDate": "2020-06-11T16:33:05Z", "type": "commit"}, {"oid": "59e0c10c4299742f99bee43a478aca36393a57f1", "url": "https://github.com/TeamNewPipe/NewPipe/commit/59e0c10c4299742f99bee43a478aca36393a57f1", "message": "inverted if-else statement", "committedDate": "2020-06-11T16:36:05Z", "type": "commit"}, {"oid": "17d1346a8a2fc31e0d35f991194c7097fe2b0c22", "url": "https://github.com/TeamNewPipe/NewPipe/commit/17d1346a8a2fc31e0d35f991194c7097fe2b0c22", "message": "made ClipboardManager final", "committedDate": "2020-06-11T16:36:57Z", "type": "commit"}]}