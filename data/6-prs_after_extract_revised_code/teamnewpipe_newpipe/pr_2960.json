{"pr_number": 2960, "pr_title": "Remove dot-menu where not required; Issue #2254", "pr_createdAt": "2020-01-14T20:00:14Z", "pr_url": "https://github.com/TeamNewPipe/NewPipe/pull/2960", "timeline": [{"oid": "9d773d6e8aa892e929439ba62d2a0985f4e8deb4", "url": "https://github.com/TeamNewPipe/NewPipe/commit/9d773d6e8aa892e929439ba62d2a0985f4e8deb4", "message": "removed dot menu where its no longer needed", "committedDate": "2020-01-13T19:28:32Z", "type": "commit"}, {"oid": "a228e702daee7024ac88f3cbfadba031ce5b6951", "url": "https://github.com/TeamNewPipe/NewPipe/commit/a228e702daee7024ac88f3cbfadba031ce5b6951", "message": "menu-item History visibility accordingly to settings", "committedDate": "2020-01-14T18:30:36Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjU1MDA0NA==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/2960#discussion_r366550044", "bodyText": "Are we sure we want to completely remove the main menu?\nI think this is ok, but since you removed the menu inflation, you should also remove the corresponding menu layout xml file.", "author": "Stypox", "createdAt": "2020-01-14T20:13:25Z", "path": "app/src/main/java/org/schabi/newpipe/MainActivity.java", "diffHunk": "@@ -551,8 +561,6 @@ public boolean onCreateOptionsMenu(Menu menu) {\n         if (!(fragment instanceof SearchFragment)) {\n             findViewById(R.id.toolbar).findViewById(R.id.toolbar_search_container).setVisibility(View.GONE);\n \n-            MenuInflater inflater = getMenuInflater();\n-            inflater.inflate(R.menu.main_menu, menu);", "originalCommit": "a228e702daee7024ac88f3cbfadba031ce5b6951", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjU3NjE4Mg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/2960#discussion_r366576182", "bodyText": "Yes. This menu won't be required any more in this activity. I removed main_menu.xml in b965f88. thanks;)", "author": "karkaminski", "createdAt": "2020-01-14T21:16:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NjU1MDA0NA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "b965f88eb206f9f6348018df2a1628985679b95d", "url": "https://github.com/TeamNewPipe/NewPipe/commit/b965f88eb206f9f6348018df2a1628985679b95d", "message": "removed main_menu.xml", "committedDate": "2020-01-14T21:08:07Z", "type": "commit"}, {"oid": "a0ee1b16533c678e79058716b67f7bb0e74d6a48", "url": "https://github.com/TeamNewPipe/NewPipe/commit/a0ee1b16533c678e79058716b67f7bb0e74d6a48", "message": "Merge branch 'dev' into issue-#2254", "committedDate": "2020-01-14T21:23:32Z", "type": "commit"}, {"oid": "266c3d03fc8d2791c0768c3c2b912b3743320a8e", "url": "https://github.com/TeamNewPipe/NewPipe/commit/266c3d03fc8d2791c0768c3c2b912b3743320a8e", "message": "Merge branch 'dev' into issue-#2254", "committedDate": "2020-01-19T11:50:08Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQ1MzgyNg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/2960#discussion_r372453826", "bodyText": "This should not introduce a new field in the Constants file, instead you should get the key with getString(R.string.enable_watch_history_key).\nIt comes from this file, where all the setting key are stored (this is done to avoid bugs so we don't need to hard code every time):\n\n  \n    \n      NewPipe/app/src/main/res/values/settings_keys.xml\n    \n    \n         Line 174\n      in\n      0447e4e\n    \n    \n    \n    \n\n        \n          \n           <string name=\"enable_watch_history_key\" translatable=\"false\">enable_watch_history</string>", "author": "mauriciocolli", "createdAt": "2020-01-29T15:31:32Z", "path": "app/src/main/java/org/schabi/newpipe/MainActivity.java", "diffHunk": "@@ -449,6 +449,16 @@ protected void onResume() {\n             sharedPreferences.edit().putBoolean(Constants.KEY_MAIN_PAGE_CHANGE, false).apply();\n             NavigationHelper.openMainActivity(this);\n         }\n+\n+        if (sharedPreferences.getBoolean(Constants.KEY_ENABLE_WATCH_HISTORY, true)) {", "originalCommit": "266c3d03fc8d2791c0768c3c2b912b3743320a8e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjQ1NTIzNg==", "url": "https://github.com/TeamNewPipe/NewPipe/pull/2960#discussion_r372455236", "bodyText": "This check is just a duplicate from above, a variable here would make much more sense:\nfinal boolean isHistoryEnabled = sharedPreferences.getBoolean(\n        getString(R.string.enable_watch_history_key), true);\ndrawerItems.getMenu().findItem(ITEM_ID_HISTORY).setVisible(isHistoryEnabled);", "author": "mauriciocolli", "createdAt": "2020-01-29T15:33:37Z", "path": "app/src/main/java/org/schabi/newpipe/MainActivity.java", "diffHunk": "@@ -449,6 +449,16 @@ protected void onResume() {\n             sharedPreferences.edit().putBoolean(Constants.KEY_MAIN_PAGE_CHANGE, false).apply();\n             NavigationHelper.openMainActivity(this);\n         }\n+\n+        if (sharedPreferences.getBoolean(Constants.KEY_ENABLE_WATCH_HISTORY, true)) {\n+            if (DEBUG) Log.d(TAG, \"do not show History-menu as its disabled in settings\");\n+            drawerItems.getMenu().findItem(ITEM_ID_HISTORY).setVisible(true);\n+        }\n+\n+        if (!sharedPreferences.getBoolean(Constants.KEY_ENABLE_WATCH_HISTORY, true)) {", "originalCommit": "266c3d03fc8d2791c0768c3c2b912b3743320a8e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}