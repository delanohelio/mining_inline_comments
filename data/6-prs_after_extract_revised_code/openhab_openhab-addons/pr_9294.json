{"pr_number": 9294, "pr_title": "[nikobus] rollershutter position estimator added", "pr_createdAt": "2020-12-08T15:16:07Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/9294", "timeline": [{"oid": "45fb0bfa96b5e94158c878ce6e5af73c662475fb", "url": "https://github.com/openhab/openhab-addons/commit/45fb0bfa96b5e94158c878ce6e5af73c662475fb", "message": "Implemented rollershutter position estimator.\n\nSigned-off-by: Boris Krivonog <boris.krivonog@inova.si>", "committedDate": "2020-12-09T16:05:00Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyNzczMw==", "url": "https://github.com/openhab/openhab-addons/pull/9294#discussion_r539727733", "bodyText": "What runtime exceptions are you trying to catch here?", "author": "cpmeister", "createdAt": "2020-12-09T23:33:39Z", "path": "bundles/org.openhab.binding.nikobus/src/main/java/org/openhab/binding/nikobus/internal/handler/NikobusRollershutterModuleHandler.java", "diffHunk": "@@ -28,10 +42,37 @@\n  */\n @NonNullByDefault\n public class NikobusRollershutterModuleHandler extends NikobusModuleHandler {\n+    private final Logger logger = LoggerFactory.getLogger(NikobusRollershutterModuleHandler.class);\n+    private final List<PositionEstimator> positionEstimators = new CopyOnWriteArrayList<>();\n+\n     public NikobusRollershutterModuleHandler(Thing thing) {\n         super(thing);\n     }\n \n+    @Override\n+    public void initialize() {\n+        super.initialize();\n+\n+        if (thing.getStatus() == ThingStatus.OFFLINE) {\n+            return;\n+        }\n+\n+        positionEstimators.clear();\n+\n+        try {\n+            for (Channel channel : thing.getChannels()) {\n+                PositionEstimatorConfig config = channel.getConfiguration().as(PositionEstimatorConfig.class);\n+                if (config.delay >= 0 && config.duration > 0) {\n+                    positionEstimators.add(new PositionEstimator(channel.getUID(), config));\n+                }\n+            }\n+        } catch (RuntimeException e) {", "originalCommit": "45fb0bfa96b5e94158c878ce6e5af73c662475fb", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTkyMzIzMA==", "url": "https://github.com/openhab/openhab-addons/pull/9294#discussion_r539923230", "bodyText": "You are right, removed. Also removed from NikobusPushButtonHandler", "author": "crnjan", "createdAt": "2020-12-10T07:09:23Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTcyNzczMw=="}], "type": "inlineReview", "revised_code": {"commit": "fd94c361e0674ca3270e26af1d406df856aab96e", "chunk": "diff --git a/bundles/org.openhab.binding.nikobus/src/main/java/org/openhab/binding/nikobus/internal/handler/NikobusRollershutterModuleHandler.java b/bundles/org.openhab.binding.nikobus/src/main/java/org/openhab/binding/nikobus/internal/handler/NikobusRollershutterModuleHandler.java\nindex 6d481bdd52..60f70403a0 100644\n--- a/bundles/org.openhab.binding.nikobus/src/main/java/org/openhab/binding/nikobus/internal/handler/NikobusRollershutterModuleHandler.java\n+++ b/bundles/org.openhab.binding.nikobus/src/main/java/org/openhab/binding/nikobus/internal/handler/NikobusRollershutterModuleHandler.java\n\n@@ -59,15 +58,11 @@ public class NikobusRollershutterModuleHandler extends NikobusModuleHandler {\n \n         positionEstimators.clear();\n \n-        try {\n-            for (Channel channel : thing.getChannels()) {\n-                PositionEstimatorConfig config = channel.getConfiguration().as(PositionEstimatorConfig.class);\n-                if (config.delay >= 0 && config.duration > 0) {\n-                    positionEstimators.add(new PositionEstimator(channel.getUID(), config));\n-                }\n+        for (Channel channel : thing.getChannels()) {\n+            PositionEstimatorConfig config = channel.getConfiguration().as(PositionEstimatorConfig.class);\n+            if (config.delay >= 0 && config.duration > 0) {\n+                positionEstimators.add(new PositionEstimator(channel.getUID(), config));\n             }\n-        } catch (RuntimeException e) {\n-            updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR, e.getMessage());\n         }\n \n         logger.debug(\"Position estimators for {} = {}\", thing.getUID(), positionEstimators);\n"}}, {"oid": "fd94c361e0674ca3270e26af1d406df856aab96e", "url": "https://github.com/openhab/openhab-addons/commit/fd94c361e0674ca3270e26af1d406df856aab96e", "message": "Removed unneeded try-catch.\n\nSigned-off-by: Boris Krivonog <boris.krivonog@inova.si>", "committedDate": "2020-12-10T07:08:13Z", "type": "forcePushed"}, {"oid": "271feed84f90d78376564e1e282a919d3eacb739", "url": "https://github.com/openhab/openhab-addons/commit/271feed84f90d78376564e1e282a919d3eacb739", "message": "Implemented rollershutter position estimator.\n\nSigned-off-by: Boris Krivonog <boris.krivonog@inova.si>", "committedDate": "2020-12-11T12:44:22Z", "type": "commit"}, {"oid": "2d4d2f21e5bbc4dcef11e7a88176bd8298e54e2e", "url": "https://github.com/openhab/openhab-addons/commit/2d4d2f21e5bbc4dcef11e7a88176bd8298e54e2e", "message": "Removed unneeded try-catch.\n\nSigned-off-by: Boris Krivonog <boris.krivonog@inova.si>", "committedDate": "2020-12-11T12:44:22Z", "type": "commit"}, {"oid": "2d4d2f21e5bbc4dcef11e7a88176bd8298e54e2e", "url": "https://github.com/openhab/openhab-addons/commit/2d4d2f21e5bbc4dcef11e7a88176bd8298e54e2e", "message": "Removed unneeded try-catch.\n\nSigned-off-by: Boris Krivonog <boris.krivonog@inova.si>", "committedDate": "2020-12-11T12:44:22Z", "type": "forcePushed"}]}