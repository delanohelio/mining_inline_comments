{"pr_number": 8961, "pr_title": "[meteoalerte] Adressing Issue #8543", "pr_createdAt": "2020-11-05T08:29:52Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8961", "timeline": [{"oid": "72339f290e131da110bda06a9040d44c9c7d17c7", "url": "https://github.com/openhab/openhab-addons/commit/72339f290e131da110bda06a9040d44c9c7d17c7", "message": "[meteoalerte] Adressing Issue #8543\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-11-05T08:27:49Z", "type": "commit"}, {"oid": "43b4034b89aa2fb06d7beb5cf61153dcb0c99668", "url": "https://github.com/openhab/openhab-addons/commit/43b4034b89aa2fb06d7beb5cf61153dcb0c99668", "message": "Small change\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-11-06T09:25:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDAyMjc0OA==", "url": "https://github.com/openhab/openhab-addons/pull/8961#discussion_r520022748", "bodyText": "Please specify the charset used here", "author": "cpmeister", "createdAt": "2020-11-09T18:21:41Z", "path": "bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java", "diffHunk": "@@ -168,12 +165,14 @@ public void updateAlert(String channelId, AlertLevel value) {\n             updateState(channelId, getAlertLevel(value));\n         }\n         if (isLinked(channelIcon)) {\n-            String resource = getResource(String.format(\"picto/%s.svg\", channelId));\n-            if (resource != null) {\n+            State result = UnDefType.UNDEF;\n+            byte[] bytes = getResource(String.format(\"picto/%s.svg\", channelId));\n+            if (bytes != null) {\n+                String resource = new String(bytes);", "originalCommit": "43b4034b89aa2fb06d7beb5cf61153dcb0c99668", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "32032fc832a37b484ed21365262645671cf2e871", "chunk": "diff --git a/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java b/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java\nindex b08d8ed4c8..7dfcc29952 100644\n--- a/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java\n+++ b/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java\n\n@@ -168,9 +169,9 @@ public class MeteoAlerteHandler extends BaseThingHandler {\n             State result = UnDefType.UNDEF;\n             byte[] bytes = getResource(String.format(\"picto/%s.svg\", channelId));\n             if (bytes != null) {\n-                String resource = new String(bytes);\n+                String resource = new String(bytes, StandardCharsets.UTF_8);\n                 resource = resource.replaceAll(UNKNOWN_COLOR, ALERT_COLORS.getOrDefault(value, UNKNOWN_COLOR));\n-                result = new RawType(resource.getBytes(), \"image/svg+xml\");\n+                result = new RawType(resource.getBytes(StandardCharsets.UTF_8), \"image/svg+xml\");\n             }\n             updateState(channelIcon, result);\n         }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDAyMjg4Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8961#discussion_r520022886", "bodyText": "and here as well", "author": "cpmeister", "createdAt": "2020-11-09T18:21:52Z", "path": "bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java", "diffHunk": "@@ -168,12 +165,14 @@ public void updateAlert(String channelId, AlertLevel value) {\n             updateState(channelId, getAlertLevel(value));\n         }\n         if (isLinked(channelIcon)) {\n-            String resource = getResource(String.format(\"picto/%s.svg\", channelId));\n-            if (resource != null) {\n+            State result = UnDefType.UNDEF;\n+            byte[] bytes = getResource(String.format(\"picto/%s.svg\", channelId));\n+            if (bytes != null) {\n+                String resource = new String(bytes);\n                 resource = resource.replaceAll(UNKNOWN_COLOR, ALERT_COLORS.getOrDefault(value, UNKNOWN_COLOR));\n+                result = new RawType(resource.getBytes(), \"image/svg+xml\");", "originalCommit": "43b4034b89aa2fb06d7beb5cf61153dcb0c99668", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "32032fc832a37b484ed21365262645671cf2e871", "chunk": "diff --git a/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java b/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java\nindex b08d8ed4c8..7dfcc29952 100644\n--- a/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java\n+++ b/bundles/org.openhab.binding.meteoalerte/src/main/java/org/openhab/binding/meteoalerte/internal/handler/MeteoAlerteHandler.java\n\n@@ -168,9 +169,9 @@ public class MeteoAlerteHandler extends BaseThingHandler {\n             State result = UnDefType.UNDEF;\n             byte[] bytes = getResource(String.format(\"picto/%s.svg\", channelId));\n             if (bytes != null) {\n-                String resource = new String(bytes);\n+                String resource = new String(bytes, StandardCharsets.UTF_8);\n                 resource = resource.replaceAll(UNKNOWN_COLOR, ALERT_COLORS.getOrDefault(value, UNKNOWN_COLOR));\n-                result = new RawType(resource.getBytes(), \"image/svg+xml\");\n+                result = new RawType(resource.getBytes(StandardCharsets.UTF_8), \"image/svg+xml\");\n             }\n             updateState(channelIcon, result);\n         }\n"}}, {"oid": "32032fc832a37b484ed21365262645671cf2e871", "url": "https://github.com/openhab/openhab-addons/commit/32032fc832a37b484ed21365262645671cf2e871", "message": "Adding charset to byte conversion\n\nSigned-off-by: clinique <gael@lhopital.org>", "committedDate": "2020-11-09T18:39:57Z", "type": "commit"}]}