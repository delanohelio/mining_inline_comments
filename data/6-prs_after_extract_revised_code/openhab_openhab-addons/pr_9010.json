{"pr_number": 9010, "pr_title": "[omnikinverter]fix missing dispose", "pr_createdAt": "2020-11-12T16:28:10Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/9010", "timeline": [{"oid": "6d2eaf3acf0bf1fa74865364411b166325ad2ef6", "url": "https://github.com/openhab/openhab-addons/commit/6d2eaf3acf0bf1fa74865364411b166325ad2ef6", "message": "fix missing dispose\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-11-12T16:26:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMjcwMDI1MA==", "url": "https://github.com/openhab/openhab-addons/pull/9010#discussion_r522700250", "bodyText": "flipping then reversing it?", "author": "cpmeister", "createdAt": "2020-11-13T06:57:34Z", "path": "bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/OmnikInverter.java", "diffHunk": "@@ -54,30 +52,21 @@ public OmnikInverterMessage pullCurrentStats() throws UnknownHostException, IOEx\n         }\n     }\n \n-    private byte[] generateMagicPacket() throws IOException {\n-        byte[] magic = { 0x68, 0x02, 0x40, 0x30 };\n-\n+    private byte[] generateMagicPacket() {\n         ByteBuffer serialByteBuffer = ByteBuffer.allocate(8).putInt(serialNumber).putInt(serialNumber);\n-        byte[] serialBytes = serialByteBuffer.array();\n-        // Reverse serialBytes in a very mutable way.\n+        byte[] serialBytes = serialByteBuffer.flip().array();\n         ArrayUtils.reverse(serialBytes);", "originalCommit": "6d2eaf3acf0bf1fa74865364411b166325ad2ef6", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a50b29c00f0ab8c99cc20bdb0f97599f8c8dd380", "chunk": "diff --git a/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/OmnikInverter.java b/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/OmnikInverter.java\nindex f4dd643eae..8a7894d692 100644\n--- a/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/OmnikInverter.java\n+++ b/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/OmnikInverter.java\n\n@@ -54,7 +54,7 @@ public class OmnikInverter {\n \n     private byte[] generateMagicPacket() {\n         ByteBuffer serialByteBuffer = ByteBuffer.allocate(8).putInt(serialNumber).putInt(serialNumber);\n-        byte[] serialBytes = serialByteBuffer.flip().array();\n+        byte[] serialBytes = serialByteBuffer.array();\n         ArrayUtils.reverse(serialBytes);\n \n         byte checksumCount = 115;\n"}}, {"oid": "a50b29c00f0ab8c99cc20bdb0f97599f8c8dd380", "url": "https://github.com/openhab/openhab-addons/commit/a50b29c00f0ab8c99cc20bdb0f97599f8c8dd380", "message": "address review comment\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-11-13T16:19:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI3ODQzMw==", "url": "https://github.com/openhab/openhab-addons/pull/9010#discussion_r523278433", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                    pollJob = scheduler.scheduleWithFixedDelay(this::updateData, 0, 10, TimeUnit.SECONDS);\n          \n          \n            \n                    updateStatus(ThingStatus.UNKNOWN);\n          \n          \n            \n                    updateStatus(ThingStatus.UNKNOWN);\n          \n          \n            \n                    pollJob = scheduler.scheduleWithFixedDelay(this::updateData, 0, 10, TimeUnit.SECONDS);", "author": "cpmeister", "createdAt": "2020-11-13T23:08:38Z", "path": "bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/handler/OmnikInverterHandler.java", "diffHunk": "@@ -67,14 +69,19 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n     public void initialize() {\n         OmnikInverterConfiguration config = getConfigAs(OmnikInverterConfiguration.class);\n \n-        try {\n-            inverter = new OmnikInverter(config.hostname, config.port, config.serial);\n-            scheduler.scheduleWithFixedDelay(this::updateData, 0, 10, TimeUnit.SECONDS);\n-        } catch (IOException e) {\n-            logger.debug(\"Could not instantiate OmnikInverter object: {}\", e.getMessage());\n-            updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.HANDLER_INITIALIZING_ERROR,\n-                    \"Failed to initialize: \" + e.getMessage());\n+        inverter = new OmnikInverter(config.hostname, config.port, config.serial);\n+        pollJob = scheduler.scheduleWithFixedDelay(this::updateData, 0, 10, TimeUnit.SECONDS);\n+        updateStatus(ThingStatus.UNKNOWN);", "originalCommit": "a50b29c00f0ab8c99cc20bdb0f97599f8c8dd380", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5e646132b747ac68293c5004621c647e6a625f80", "chunk": "diff --git a/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/handler/OmnikInverterHandler.java b/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/handler/OmnikInverterHandler.java\nindex e9b78d9aa3..e0bf649033 100644\n--- a/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/handler/OmnikInverterHandler.java\n+++ b/bundles/org.openhab.binding.omnikinverter/src/main/java/org/openhab/binding/omnikinverter/internal/handler/OmnikInverterHandler.java\n\n@@ -70,8 +70,8 @@ public class OmnikInverterHandler extends BaseThingHandler {\n         OmnikInverterConfiguration config = getConfigAs(OmnikInverterConfiguration.class);\n \n         inverter = new OmnikInverter(config.hostname, config.port, config.serial);\n-        pollJob = scheduler.scheduleWithFixedDelay(this::updateData, 0, 10, TimeUnit.SECONDS);\n         updateStatus(ThingStatus.UNKNOWN);\n+        pollJob = scheduler.scheduleWithFixedDelay(this::updateData, 0, 10, TimeUnit.SECONDS);\n     }\n \n     @Override\n"}}, {"oid": "5e646132b747ac68293c5004621c647e6a625f80", "url": "https://github.com/openhab/openhab-addons/commit/5e646132b747ac68293c5004621c647e6a625f80", "message": "address review comment\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-11-14T07:58:45Z", "type": "commit"}]}