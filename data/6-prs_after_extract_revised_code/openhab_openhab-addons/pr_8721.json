{"pr_number": 8721, "pr_title": "[hue] Added channel to enable / disable a motion sensor", "pr_createdAt": "2020-10-10T19:04:09Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8721", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4ODIxMA==", "url": "https://github.com/openhab/openhab-addons/pull/8721#discussion_r502888210", "bodyText": "For other channels, I think you have to call the parent class (which handle few other channels).", "author": "lolodomo", "createdAt": "2020-10-11T09:08:52Z", "path": "bundles/org.openhab.binding.hue/src/main/java/org/openhab/binding/hue/internal/handler/sensors/PresenceHandler.java", "diffHunk": "@@ -39,10 +45,38 @@\n public class PresenceHandler extends HueSensorHandler {\n     public static final Set<ThingTypeUID> SUPPORTED_THING_TYPES = Collections.singleton(THING_TYPE_PRESENCE_SENSOR);\n \n+    private final Logger logger = LoggerFactory.getLogger(PresenceHandler.class);\n+\n     public PresenceHandler(Thing thing) {\n         super(thing);\n     }\n \n+    @Override\n+    public void handleCommand(String channel, Command command) {\n+        HueClient hueBridge = getHueClient();\n+        if (hueBridge == null) {\n+            logger.warn(\"hue bridge handler not found. Cannot handle command without bridge.\");\n+            return;\n+        }\n+\n+        final FullSensor sensor = lastFullSensor;\n+        if (sensor == null) {\n+            logger.debug(\"hue sensor not known on bridge. Cannot handle command.\");\n+            updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n+                    \"@text/offline.conf-error-wrong-sensor-id\");\n+            return;\n+        }\n+\n+        SensorConfigUpdate configUpdate = new SensorConfigUpdate();\n+        switch (channel) {\n+            case CHANNEL_ENABLED:\n+                configUpdate.setOn(OnOffType.ON.equals(command));\n+                break;\n+        }", "originalCommit": "e074c522568e341d3faa8db2660c81b036282352", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg5MjA3Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8721#discussion_r502892077", "bodyText": "On the first glance, yes, but currently the presence sensor only has read-only channels thus no command has to be handled except this one.", "author": "cweitkamp", "createdAt": "2020-10-11T09:46:38Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4ODIxMA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjg4ODI4Nw==", "url": "https://github.com/openhab/openhab-addons/pull/8721#discussion_r502888287", "bodyText": "It should be moved in your switch case.", "author": "lolodomo", "createdAt": "2020-10-11T09:09:26Z", "path": "bundles/org.openhab.binding.hue/src/main/java/org/openhab/binding/hue/internal/handler/sensors/PresenceHandler.java", "diffHunk": "@@ -39,10 +45,38 @@\n public class PresenceHandler extends HueSensorHandler {\n     public static final Set<ThingTypeUID> SUPPORTED_THING_TYPES = Collections.singleton(THING_TYPE_PRESENCE_SENSOR);\n \n+    private final Logger logger = LoggerFactory.getLogger(PresenceHandler.class);\n+\n     public PresenceHandler(Thing thing) {\n         super(thing);\n     }\n \n+    @Override\n+    public void handleCommand(String channel, Command command) {\n+        HueClient hueBridge = getHueClient();\n+        if (hueBridge == null) {\n+            logger.warn(\"hue bridge handler not found. Cannot handle command without bridge.\");\n+            return;\n+        }\n+\n+        final FullSensor sensor = lastFullSensor;\n+        if (sensor == null) {\n+            logger.debug(\"hue sensor not known on bridge. Cannot handle command.\");\n+            updateStatus(ThingStatus.OFFLINE, ThingStatusDetail.CONFIGURATION_ERROR,\n+                    \"@text/offline.conf-error-wrong-sensor-id\");\n+            return;\n+        }\n+\n+        SensorConfigUpdate configUpdate = new SensorConfigUpdate();\n+        switch (channel) {\n+            case CHANNEL_ENABLED:\n+                configUpdate.setOn(OnOffType.ON.equals(command));\n+                break;\n+        }\n+\n+        hueBridge.updateSensorConfig(sensor, configUpdate);", "originalCommit": "e074c522568e341d3faa8db2660c81b036282352", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "0c2af172a25b4c7ea4fe4a7ba3723facc5a925ad", "url": "https://github.com/openhab/openhab-addons/commit/0c2af172a25b4c7ea4fe4a7ba3723facc5a925ad", "message": "Added channel to activate/deactivate a motion sensor\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>", "committedDate": "2020-10-16T08:40:49Z", "type": "commit"}, {"oid": "91370648be528d8f06c0a260dd21e0bd87490b3a", "url": "https://github.com/openhab/openhab-addons/commit/91370648be528d8f06c0a260dd21e0bd87490b3a", "message": "Applied spotless\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>", "committedDate": "2020-10-16T08:42:05Z", "type": "commit"}, {"oid": "91370648be528d8f06c0a260dd21e0bd87490b3a", "url": "https://github.com/openhab/openhab-addons/commit/91370648be528d8f06c0a260dd21e0bd87490b3a", "message": "Applied spotless\n\nSigned-off-by: Christoph Weitkamp <github@christophweitkamp.de>", "committedDate": "2020-10-16T08:42:05Z", "type": "forcePushed"}]}