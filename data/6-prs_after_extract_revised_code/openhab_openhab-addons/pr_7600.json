{"pr_number": 7600, "pr_title": "[homekit] simplify HomeKit console commands", "pr_createdAt": "2020-05-11T12:04:05Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/7600", "timeline": [{"oid": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc", "url": "https://github.com/openhab/openhab-addons/commit/b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc", "message": "simplify HomeKit console commands\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>", "committedDate": "2020-05-11T11:59:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwNzIwMA==", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427907200", "bodyText": "is required", "author": "lolodomo", "createdAt": "2020-05-20T10:32:20Z", "path": "bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java", "diffHunk": "@@ -68,25 +68,27 @@ public void execute(String[] args, Console console) {\n                     break;\n                 case SUBCMD_PRINT_ACCESSORY:\n                     if (args.length > 1) {\n-                        Integer id = Integer.valueOf(args[1]);\n-                        printAccessory(id, console);\n+                        printAccessory(args[1], console);\n                     } else {\n-                        console.println(\"accessory id is required as an argument\");\n+                        console.println(\"accessory id or name are required as an argument\");", "originalCommit": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1237b463ec418d0918902dfb402e8dec6f846381", "chunk": "diff --git a/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java b/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java\nindex cfb57172bc..b17d3355f3 100644\n--- a/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java\n+++ b/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java\n\n@@ -70,7 +70,7 @@ public class HomekitCommandExtension extends AbstractConsoleCommandExtension {\n                     if (args.length > 1) {\n                         printAccessory(args[1], console);\n                     } else {\n-                        console.println(\"accessory id or name are required as an argument\");\n+                        console.println(\"accessory id or name is required as an argument\");\n                     }\n                     break;\n                 default:\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkwODUyMA==", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427908520", "bodyText": "This is no more a full matching but now a partial matching. Maybe this has to be mentioned in the usage ?", "author": "lolodomo", "createdAt": "2020-05-20T10:34:53Z", "path": "bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java", "diffHunk": "@@ -134,10 +136,11 @@ private void listAccessories(Console console) {\n         });\n     }\n \n-    private void printAccessory(Integer accessory_id, Console console) {\n+    private void printAccessory(String id, Console console) {\n         homekit.getAccessories().forEach(v -> {\n             try {\n-                if (v.getId() == accessory_id) {\n+                if ((\"\" + v.getId()).contains(id) || ((v.getName().get() != null)\n+                        && (v.getName().get().toUpperCase().contains(id.toUpperCase())))) {", "originalCommit": "b8f8efab3c92c5ab9039d6f5c082aa8eba64e8fc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "1237b463ec418d0918902dfb402e8dec6f846381", "url": "https://github.com/openhab/openhab-addons/commit/1237b463ec418d0918902dfb402e8dec6f846381", "message": "incorporate feedback from lolodomo\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>", "committedDate": "2020-05-20T11:00:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkzMTI2Mg==", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427931262", "bodyText": "Please mention the partial matching here too.", "author": "lolodomo", "createdAt": "2020-05-20T11:18:56Z", "path": "bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java", "diffHunk": "@@ -68,25 +68,27 @@ public void execute(String[] args, Console console) {\n                     break;\n                 case SUBCMD_PRINT_ACCESSORY:\n                     if (args.length > 1) {\n-                        Integer id = Integer.valueOf(args[1]);\n-                        printAccessory(id, console);\n+                        printAccessory(args[1], console);\n                     } else {\n-                        console.println(\"accessory id is required as an argument\");\n+                        console.println(\"accessory id or name is required as an argument\");\n                     }\n                     break;\n                 default:\n                     console.println(\"Unknown command '\" + subCommand + \"'\");\n                     printUsage(console);\n                     break;\n             }\n+        } else {\n+            printUsage(console);\n         }\n     }\n \n     @Override\n     public List<String> getUsages() {\n         return Arrays.asList(buildCommandUsage(SUBCMD_LIST_ACCESSORIES, \"list all HomeKit accessories\"),\n-                buildCommandUsage(SUBCMD_PRINT_ACCESSORY + \" <accessory id>\", \"print accessorty details\"),\n-                buildCommandUsage(SUBCMD_CLEAR_PAIRINGS, \"removes all pairings with HomeKit clients\"),\n+                buildCommandUsage(SUBCMD_PRINT_ACCESSORY + \" <accessory id | accessory name>\",\n+                        \"search for accessories and show details. \"),", "originalCommit": "1237b463ec418d0918902dfb402e8dec6f846381", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkzNDc1Mw==", "url": "https://github.com/openhab/openhab-addons/pull/7600#discussion_r427934753", "bodyText": "good point. copied the description from README.", "author": "yfre", "createdAt": "2020-05-20T11:26:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzkzMTI2Mg=="}], "type": "inlineReview", "revised_code": {"commit": "34ad8b479d1c002f9aa6f0fc16de279e169b8813", "chunk": "diff --git a/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java b/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java\nindex b17d3355f3..39052da394 100644\n--- a/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java\n+++ b/bundles/org.openhab.io.homekit/src/main/java/org/openhab/io/homekit/internal/HomekitCommandExtension.java\n\n@@ -87,7 +87,7 @@ public class HomekitCommandExtension extends AbstractConsoleCommandExtension {\n     public List<String> getUsages() {\n         return Arrays.asList(buildCommandUsage(SUBCMD_LIST_ACCESSORIES, \"list all HomeKit accessories\"),\n                 buildCommandUsage(SUBCMD_PRINT_ACCESSORY + \" <accessory id | accessory name>\",\n-                        \"search for accessories and show details. \"),\n+                        \"print additional details of the accessories which partially match provided ID or name.\"),\n                 buildCommandUsage(SUBCMD_CLEAR_PAIRINGS, \"removes all pairings with HomeKit clients.\"),\n                 buildCommandUsage(SUBCMD_ALLOW_UNAUTHENTICATED + \" <boolean>\",\n                         \"enables or disables unauthenticated access to facilitate debugging\"));\n"}}, {"oid": "34ad8b479d1c002f9aa6f0fc16de279e169b8813", "url": "https://github.com/openhab/openhab-addons/commit/34ad8b479d1c002f9aa6f0fc16de279e169b8813", "message": "incorporate feedback from lolodomo\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>", "committedDate": "2020-05-20T11:25:17Z", "type": "commit"}, {"oid": "f28c3ae96d56ab162d9ce900a1850efbc2abfbc1", "url": "https://github.com/openhab/openhab-addons/commit/f28c3ae96d56ab162d9ce900a1850efbc2abfbc1", "message": "add support for old commands\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>", "committedDate": "2020-05-20T22:32:38Z", "type": "commit"}, {"oid": "edbb19a9ae407da690f7894429349620812ea6b6", "url": "https://github.com/openhab/openhab-addons/commit/edbb19a9ae407da690f7894429349620812ea6b6", "message": "remove old commands from readme\n\nSigned-off-by: Eugen Freiter <freiter@gmx.de>", "committedDate": "2020-05-21T09:47:55Z", "type": "commit"}, {"oid": "756d8cb2d45e3d59007d5dada6190688f9632e74", "url": "https://github.com/openhab/openhab-addons/commit/756d8cb2d45e3d59007d5dada6190688f9632e74", "message": "Merge branch '2.5.x' into homekit_commands", "committedDate": "2020-05-21T09:56:29Z", "type": "commit"}]}