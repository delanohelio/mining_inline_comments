{"pr_number": 8025, "pr_title": "[samsungtv] cleanup websocket shutdown", "pr_createdAt": "2020-06-28T08:16:50Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8025", "timeline": [{"oid": "746fa947f24251f3a03ea8b5ecf5d1d0dfd03412", "url": "https://github.com/openhab/openhab-addons/commit/746fa947f24251f3a03ea8b5ecf5d1d0dfd03412", "message": "cleanup shutdown\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-06-26T19:07:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjYyNDY1Ng==", "url": "https://github.com/openhab/openhab-addons/pull/8025#discussion_r446624656", "bodyText": "No need to check that sessionFuture is not null ?", "author": "lolodomo", "createdAt": "2020-06-28T09:14:17Z", "path": "bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/protocol/WebSocketBase.java", "diffHunk": "@@ -89,10 +93,17 @@ public void onWebSocketConnect(@Nullable Session session) {\n \n     void close() {\n         logger.debug(\"{} connection close requested\", this.getClass().getSimpleName());\n+\n         Session session = getSession();\n         if (session != null) {\n             session.close();\n         }\n+\n+        final Future<?> sessionFuture = this.sessionFuture;\n+        logger.trace(\"Closing session Future: {}\", sessionFuture);\n+        if (!sessionFuture.isDone()) {", "originalCommit": "746fa947f24251f3a03ea8b5ecf5d1d0dfd03412", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjYzMjc1MQ==", "url": "https://github.com/openhab/openhab-addons/pull/8025#discussion_r446632751", "bodyText": "Good point. I think this is merely for the codestyle as close is never called before connect, but yes.", "author": "J-N-K", "createdAt": "2020-06-28T10:32:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjYyNDY1Ng=="}], "type": "inlineReview", "revised_code": {"commit": "b0ac829a0e299dea36b969d97060f2ec323fc94f", "chunk": "diff --git a/bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/protocol/WebSocketBase.java b/bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/protocol/WebSocketBase.java\nindex 84bbcc4af5..5659440f1b 100644\n--- a/bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/protocol/WebSocketBase.java\n+++ b/bundles/org.openhab.binding.samsungtv/src/main/java/org/openhab/binding/samsungtv/internal/protocol/WebSocketBase.java\n\n@@ -101,7 +101,7 @@ class WebSocketBase extends WebSocketAdapter {\n \n         final Future<?> sessionFuture = this.sessionFuture;\n         logger.trace(\"Closing session Future: {}\", sessionFuture);\n-        if (!sessionFuture.isDone()) {\n+        if (sessionFuture!= null && !sessionFuture.isDone()) {\n             sessionFuture.cancel(true);\n         }\n     }\n"}}, {"oid": "b0ac829a0e299dea36b969d97060f2ec323fc94f", "url": "https://github.com/openhab/openhab-addons/commit/b0ac829a0e299dea36b969d97060f2ec323fc94f", "message": "add null check\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-06-28T10:31:48Z", "type": "commit"}, {"oid": "b134a7e76400acceab49a9c07fc9aefcb0fa4095", "url": "https://github.com/openhab/openhab-addons/commit/b134a7e76400acceab49a9c07fc9aefcb0fa4095", "message": "fix codestyle\n\nSigned-off-by: Jan N. Klug <jan.n.klug@rub.de>", "committedDate": "2020-06-28T15:30:52Z", "type": "commit"}]}