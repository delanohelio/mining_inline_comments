{"pr_number": 8303, "pr_title": "[gree] Add channel for temperature sensor", "pr_createdAt": "2020-08-16T16:14:51Z", "pr_url": "https://github.com/openhab/openhab-addons/pull/8303", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjI2OQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473946269", "bodyText": "please make the -40.0 a constant (not hard coded)\npublic static int ...", "author": "markus7017", "createdAt": "2020-08-20T12:53:28Z", "path": "bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/GreeConfiguration.java", "diffHunk": "@@ -25,9 +26,10 @@\n     public String ipAddress = \"\";\n     public String broadcastAddress = \"\";\n     public int refresh = 60;\n+    public BigDecimal currentTemperatureOffset = new BigDecimal(-40.0);", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDEwNg==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474690106", "bodyText": "Moved to a BigDecimal constant in GreeBindingConstants.", "author": "taboneclayton", "createdAt": "2020-08-21T13:17:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjI2OQ=="}], "type": "inlineReview", "revised_code": {"commit": "30bd20546fd04b90b91f8cca02992aec6d956f55", "chunk": "diff --git a/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/GreeConfiguration.java b/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/GreeConfiguration.java\nindex a3a14e893c..bfd0f5a010 100644\n--- a/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/GreeConfiguration.java\n+++ b/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/GreeConfiguration.java\n\n@@ -26,7 +28,10 @@ public class GreeConfiguration {\n     public String ipAddress = \"\";\n     public String broadcastAddress = \"\";\n     public int refresh = 60;\n-    public BigDecimal currentTemperatureOffset = new BigDecimal(-40.0);\n+    /**\n+     * The currentTemperatureOffset is configureable in case the user wants to offset this temperature for calibration of the temperature sensor.\n+     */\n+    public BigDecimal currentTemperatureOffset = CURRENT_TEMP_OFFSET_DEFAULT;\n \n     @Override\n     public String toString() {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjcxNA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473946714", "bodyText": "I'm fine to mark it explicit as TARGET_TEMP, makes sense", "author": "markus7017", "createdAt": "2020-08-20T12:54:16Z", "path": "bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java", "diffHunk": "@@ -153,7 +153,7 @@ public void handleCommand(ChannelUID channelUID, Command command) {\n                     case LIGHT_CHANNEL:\n                         device.setDeviceLight(socket, getOnOff(command));\n                         break;\n-                    case TEMP_CHANNEL:\n+                    case TARGET_TEMP_CHANNEL:", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY3MTcxNw==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474671717", "bodyText": "All the other constants which refer to channel names have the _CHANNEL suffix. Would you like me to drop the suffix from this constant name by renaming TARGET_TEMP_CHANNEL to TARGET_TEMP? Just wanted to make sure I understood before renaming this constant.", "author": "taboneclayton", "createdAt": "2020-08-21T12:42:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjcxNA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTI1MDQxOQ==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r475250419", "bodyText": "TARGET_TEMP_CHANNEL", "author": "markus7017", "createdAt": "2020-08-23T18:30:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NjcxNA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NzI5NA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r473947294", "bodyText": "maybe name it GREE_PROP_CURRENT_TEMP_SENSOR - then it's clear", "author": "markus7017", "createdAt": "2020-08-20T12:55:09Z", "path": "bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java", "diffHunk": "@@ -514,6 +517,13 @@ private void publishChannel(ChannelUID channelUID) {\n         return null;\n     }\n \n+    private @Nullable State updateCurrentTemp() throws GreeException {\n+        if (device.hasStatusValChanged(GREE_PROP_TEMP_SENSOR)) {", "originalCommit": "71901224d8ccd3e92467591c11ce91b1cc01a12e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDI5NA==", "url": "https://github.com/openhab/openhab-addons/pull/8303#discussion_r474690294", "bodyText": "Renamed as suggested", "author": "taboneclayton", "createdAt": "2020-08-21T13:18:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mzk0NzI5NA=="}], "type": "inlineReview", "revised_code": {"commit": "30bd20546fd04b90b91f8cca02992aec6d956f55", "chunk": "diff --git a/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java b/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java\nindex d9df765303..b6d0881306 100644\n--- a/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java\n+++ b/bundles/org.openhab.binding.gree/src/main/java/org/openhab/binding/gree/internal/handler/GreeHandler.java\n\n@@ -518,8 +518,8 @@ public class GreeHandler extends BaseThingHandler {\n     }\n \n     private @Nullable State updateCurrentTemp() throws GreeException {\n-        if (device.hasStatusValChanged(GREE_PROP_TEMP_SENSOR)) {\n-            return new DecimalType(device.getIntStatusVal(GREE_PROP_TEMP_SENSOR) + config.currentTemperatureOffset.doubleValue());\n+        if (device.hasStatusValChanged(GREE_PROP_CURRENT_TEMP_SENSOR)) {\n+            return new DecimalType(device.getIntStatusVal(GREE_PROP_CURRENT_TEMP_SENSOR) + config.currentTemperatureOffset.doubleValue());\n         }\n         return null;\n     }\n"}}, {"oid": "30bd20546fd04b90b91f8cca02992aec6d956f55", "url": "https://github.com/openhab/openhab-addons/commit/30bd20546fd04b90b91f8cca02992aec6d956f55", "message": "Reverted value for thing-type.gree.airconditioner.label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-08-23T21:09:03Z", "type": "forcePushed"}, {"oid": "d880546257c3ea52ffc74559caf6ff024f195b70", "url": "https://github.com/openhab/openhab-addons/commit/d880546257c3ea52ffc74559caf6ff024f195b70", "message": "Reverted value for thing-type.gree.airconditioner.label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-08-29T13:28:57Z", "type": "forcePushed"}, {"oid": "4be725800635e1c2ef0c08d0db406b94cc6dcce6", "url": "https://github.com/openhab/openhab-addons/commit/4be725800635e1c2ef0c08d0db406b94cc6dcce6", "message": "Hiding the -40 implementation detail from the user. This offset is now an internal constant within the plugin and the external config parameter defaults to 0 degrees celsius. The sensor reading is then being added to the internal offset and the config parameter offset to come up with the final value.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T20:05:29Z", "type": "forcePushed"}, {"oid": "93fb64deca5eebd5f08bb1734be2a7318ebd99dd", "url": "https://github.com/openhab/openhab-addons/commit/93fb64deca5eebd5f08bb1734be2a7318ebd99dd", "message": "Added channel for reading temperature for the temperature sensor which is available on GREE AC devices. New channel name is  currentTemperature. To avoid confusion between target and current temperature, the old channel has been renamed from temperature to targetTemperature.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:06:59Z", "type": "commit"}, {"oid": "e928f0b5ea639efbdb4332020b8a75522eafbfc7", "url": "https://github.com/openhab/openhab-addons/commit/e928f0b5ea639efbdb4332020b8a75522eafbfc7", "message": "Fixed character encoding, removed duplicated il8n strings and re-ordered to match placement of strings between DE and EN.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:07:23Z", "type": "commit"}, {"oid": "df43258729574079dd4f71e2cba8a5f1fc99b01c", "url": "https://github.com/openhab/openhab-addons/commit/df43258729574079dd4f71e2cba8a5f1fc99b01c", "message": "Reverted channel name from \"targetTemperature\" to \"temperature\"\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:23Z", "type": "commit"}, {"oid": "fe32ab8a76b6bfc59d3d8ce5eda619487459073f", "url": "https://github.com/openhab/openhab-addons/commit/fe32ab8a76b6bfc59d3d8ce5eda619487459073f", "message": "Reacting to PR comments:\n- Moved developer-related information from README to code.\n- Moved hardcoded default value for current temperature offset to a constant value\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:28Z", "type": "commit"}, {"oid": "3d4752249712c057df136de8d59c1d9116e43a2b", "url": "https://github.com/openhab/openhab-addons/commit/3d4752249712c057df136de8d59c1d9116e43a2b", "message": "Reacting to PR comments:\n- Renaming GREE_PROP_TEMP_SENSOR to GREE_PROP_CURRENT_TEMP_SENSOR\n- Simplified description for currentTemperatureOffset label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:28Z", "type": "commit"}, {"oid": "47cc8d8d530da6705e1bea0b7709740b8bf8c02a", "url": "https://github.com/openhab/openhab-addons/commit/47cc8d8d530da6705e1bea0b7709740b8bf8c02a", "message": "Pushing an additional minor changes which were not staged by mistake\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:28Z", "type": "commit"}, {"oid": "f15e30e2d9694f7d316f9acae7b82484796c0c60", "url": "https://github.com/openhab/openhab-addons/commit/f15e30e2d9694f7d316f9acae7b82484796c0c60", "message": "Added a step value of 0.5 for the currentTemperatureOffset config parameter\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "ed501c68324069cf1c78f968e4ad09e537fb9fef", "url": "https://github.com/openhab/openhab-addons/commit/ed501c68324069cf1c78f968e4ad09e537fb9fef", "message": "Reverted files to the original version from upstream\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "6050bc8e02398ef213c26598c2bc2947d69e3baf", "url": "https://github.com/openhab/openhab-addons/commit/6050bc8e02398ef213c26598c2bc2947d69e3baf", "message": "Switched incoding to ISO 8859-1\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "d3d3d5672976fb848542f680ca337485cf632e08", "url": "https://github.com/openhab/openhab-addons/commit/d3d3d5672976fb848542f680ca337485cf632e08", "message": "Reverted value for thing-type.gree.airconditioner.label\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "6d367d737ddb4e604568f923f15217c33f2509d3", "url": "https://github.com/openhab/openhab-addons/commit/6d367d737ddb4e604568f923f15217c33f2509d3", "message": "Hiding the -40 implementation detail from the user. This offset is now an internal constant within the plugin and the external config parameter defaults to 0 degrees celsius. The sensor reading is then being added to the internal offset and the config parameter offset to come up with the final value.\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "b817f4c6a8e6bb558b79275f6353eb23d19088c0", "url": "https://github.com/openhab/openhab-addons/commit/b817f4c6a8e6bb558b79275f6353eb23d19088c0", "message": "Updated Javadoc for the internal binding constant INTERNAL_TEMP_SENSOR_OFFSET\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:08:29Z", "type": "commit"}, {"oid": "c009648a073dd1602ca36c59ba75a5e624480612", "url": "https://github.com/openhab/openhab-addons/commit/c009648a073dd1602ca36c59ba75a5e624480612", "message": "Applied spotless formatting", "committedDate": "2020-09-10T21:13:36Z", "type": "forcePushed"}, {"oid": "50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "url": "https://github.com/openhab/openhab-addons/commit/50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "message": "Applied spotless formatting\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:16:53Z", "type": "commit"}, {"oid": "50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "url": "https://github.com/openhab/openhab-addons/commit/50bf3e4dd7e1e180ef02af25af2301bc5cbbe41d", "message": "Applied spotless formatting\n\nSigned-off-by: Clayton Tabone <taboneclayton@gmail.com>", "committedDate": "2020-09-10T21:16:53Z", "type": "forcePushed"}]}