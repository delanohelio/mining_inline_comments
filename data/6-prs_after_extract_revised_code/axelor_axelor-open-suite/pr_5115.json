{"pr_number": 5115, "pr_title": "RM20115 default language is based on application.ppties for users created automatically", "pr_createdAt": "2020-03-12T13:21:52Z", "pr_url": "https://github.com/axelor/axelor-open-suite/pull/5115", "timeline": [{"oid": "d87a89d96c6e9b53eb06e7dd69397b46c2605add", "url": "https://github.com/axelor/axelor-open-suite/commit/d87a89d96c6e9b53eb06e7dd69397b46c2605add", "message": "RM20115 default language is based on application.ppties even if created automatically from java process", "committedDate": "2020-03-12T13:20:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODAyNTExMw==", "url": "https://github.com/axelor/axelor-open-suite/pull/5115#discussion_r398025113", "bodyText": "Please check if language is not already set here. Else if the user creates a new user from the form view and sets manually a language, this language will be overwritten on save.", "author": "ale-axelor", "createdAt": "2020-03-25T17:10:34Z", "path": "axelor-base/src/main/java/com/axelor/apps/base/db/repo/UserBaseRepository.java", "diffHunk": "@@ -31,6 +32,10 @@\n   @Override\n   public User save(User user) {\n     try {\n+      if (user.getId() == null || (user.getId() != null && user.getVersion() == 0)) {", "originalCommit": "d87a89d96c6e9b53eb06e7dd69397b46c2605add", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "207a9c5244efb4b9a9412f7c281c4cfc40348a5f", "chunk": "diff --git a/axelor-base/src/main/java/com/axelor/apps/base/db/repo/UserBaseRepository.java b/axelor-base/src/main/java/com/axelor/apps/base/db/repo/UserBaseRepository.java\nindex 3fb6ec7c0e..11ca9877a2 100644\n--- a/axelor-base/src/main/java/com/axelor/apps/base/db/repo/UserBaseRepository.java\n+++ b/axelor-base/src/main/java/com/axelor/apps/base/db/repo/UserBaseRepository.java\n\n@@ -32,7 +32,7 @@ public class UserBaseRepository extends UserRepository {\n   @Override\n   public User save(User user) {\n     try {\n-      if (user.getId() == null || (user.getId() != null && user.getVersion() == 0)) {\n+      if (user.getId() == null ) {\n         AppSettings appSettings = AppSettings.get();\n         user.setLanguage(appSettings.get(\"application.locale\"));\n       }\n"}}, {"oid": "207a9c5244efb4b9a9412f7c281c4cfc40348a5f", "url": "https://github.com/axelor/axelor-open-suite/commit/207a9c5244efb4b9a9412f7c281c4cfc40348a5f", "message": "changed to avoid overwritting of form", "committedDate": "2020-03-26T10:29:33Z", "type": "commit"}, {"oid": "c503feb1c21f404fd1c649372f0872ec95b96298", "url": "https://github.com/axelor/axelor-open-suite/commit/c503feb1c21f404fd1c649372f0872ec95b96298", "message": "RM20115 check if application.locale is empty or null", "committedDate": "2020-07-09T11:24:39Z", "type": "commit"}, {"oid": "6b4ae8f10b2f7181292b5af539e4c32589b7cfa9", "url": "https://github.com/axelor/axelor-open-suite/commit/6b4ae8f10b2f7181292b5af539e4c32589b7cfa9", "message": "spotlessApply", "committedDate": "2020-07-09T11:27:38Z", "type": "commit"}, {"oid": "da2d34503aa1855de101bd0f165b2e240698de4d", "url": "https://github.com/axelor/axelor-open-suite/commit/da2d34503aa1855de101bd0f165b2e240698de4d", "message": "Changed condition", "committedDate": "2020-07-28T07:29:59Z", "type": "commit"}, {"oid": "5106c9001293eee4f937561834a2b34aaff131fb", "url": "https://github.com/axelor/axelor-open-suite/commit/5106c9001293eee4f937561834a2b34aaff131fb", "message": "SpotlessApply", "committedDate": "2020-07-28T07:31:35Z", "type": "commit"}]}