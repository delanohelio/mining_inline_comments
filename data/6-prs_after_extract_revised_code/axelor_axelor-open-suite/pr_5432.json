{"pr_number": 5432, "pr_title": "Anomaly #28104: CONTRACT : unit price null on invoice", "pr_createdAt": "2020-05-13T08:17:06Z", "pr_url": "https://github.com/axelor/axelor-open-suite/pull/5432", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDMzNTQxNw==", "url": "https://github.com/axelor/axelor-open-suite/pull/5432#discussion_r424335417", "bodyText": "Pass the value in constructor\nd032b00#diff-62529bae7a3a9407ffbb20654177f778R535", "author": "rch-axelor", "createdAt": "2020-05-13T10:28:41Z", "path": "axelor-contract/src/main/java/com/axelor/apps/contract/service/ContractServiceImpl.java", "diffHunk": "@@ -583,6 +583,8 @@ public InvoiceLine generate(Invoice invoice, ContractLine line) throws AxelorExc\n       this.copyAnalyticMoveLines(line.getAnalyticMoveLineList(), invoiceLine);\n     }\n \n+    invoiceLine.setPriceDiscounted(\n+        invoice.getInAti() ? invoiceLine.getInTaxPrice() : invoiceLine.getPrice());", "originalCommit": "d032b0018ae7bfb0e1dfc35fb50a501bc42db19c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "dd51538a738b6421eb0c4fd96726771e74c0ab1d", "chunk": "diff --git a/axelor-contract/src/main/java/com/axelor/apps/contract/service/ContractServiceImpl.java b/axelor-contract/src/main/java/com/axelor/apps/contract/service/ContractServiceImpl.java\nindex 056062fbd9..ea7a1ca430 100644\n--- a/axelor-contract/src/main/java/com/axelor/apps/contract/service/ContractServiceImpl.java\n+++ b/axelor-contract/src/main/java/com/axelor/apps/contract/service/ContractServiceImpl.java\n\n@@ -583,8 +586,6 @@ public class ContractServiceImpl extends ContractRepository implements ContractS\n       this.copyAnalyticMoveLines(line.getAnalyticMoveLineList(), invoiceLine);\n     }\n \n-    invoiceLine.setPriceDiscounted(\n-        invoice.getInAti() ? invoiceLine.getInTaxPrice() : invoiceLine.getPrice());\n     invoice.addInvoiceLineListItem(invoiceLine);\n \n     return Beans.get(InvoiceLineRepository.class).save(invoiceLine);\n"}}, {"oid": "dd51538a738b6421eb0c4fd96726771e74c0ab1d", "url": "https://github.com/axelor/axelor-open-suite/commit/dd51538a738b6421eb0c4fd96726771e74c0ab1d", "message": "Anomaly #28104: CONTRACT : unit price null on invoice", "committedDate": "2020-05-13T10:50:43Z", "type": "commit"}, {"oid": "dd51538a738b6421eb0c4fd96726771e74c0ab1d", "url": "https://github.com/axelor/axelor-open-suite/commit/dd51538a738b6421eb0c4fd96726771e74c0ab1d", "message": "Anomaly #28104: CONTRACT : unit price null on invoice", "committedDate": "2020-05-13T10:50:43Z", "type": "forcePushed"}, {"oid": "e5ce9148d27e470044959ff2dae8fb949c371585", "url": "https://github.com/axelor/axelor-open-suite/commit/e5ce9148d27e470044959ff2dae8fb949c371585", "message": "Merge branch 'dev' into dev-28104", "committedDate": "2020-05-13T12:50:24Z", "type": "commit"}]}