{"pr_number": 5142, "pr_title": "RM#25898 : Manuf. order bugfix, no longer diplay unavaible tracking numbers", "pr_createdAt": "2020-03-17T12:55:42Z", "pr_url": "https://github.com/axelor/axelor-open-suite/pull/5142", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY1MjM2Mg==", "url": "https://github.com/axelor/axelor-open-suite/pull/5142#discussion_r395652362", "bodyText": "\ud83d\udc4d", "author": "ale-axelor", "createdAt": "2020-03-20T13:55:58Z", "path": "axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java", "diffHunk": "@@ -1195,14 +1195,14 @@ public void setAvailableStatus(StockMoveLine stockMoveLine) {\n \n   public List<TrackingNumber> getAvailableTrackingNumbers(\n       StockMoveLine stockMoveLine, StockMove stockMove) {\n-    List<TrackingNumber> trackingNumbers = null;\n     String domain =\n         \"self.product.id = \"\n             + stockMoveLine.getProduct().getId()\n-            + \" AND self.id in (select stockLocationLine.trackingNumber.id from StockLocationLine stockLocationLine join StockLocation sl on sl.id = stockLocationLine.detailsStockLocation.id WHERE sl.id = \"\n+            + \" AND self.id in (select stockLocationLine.trackingNumber.id from StockLocationLine stockLocationLine\"\n+            + \" join StockLocation sl on sl.id = stockLocationLine.detailsStockLocation.id WHERE sl.id = \"", "originalCommit": "df6259557b193799a2aee02532d823948a25a2ad", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7c84abfb7783c4ffa917b0da9c7f5824c84711b2", "chunk": "diff --git a/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java b/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java\nindex 172bc1e8e8..9766f0a195 100644\n--- a/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java\n+++ b/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java\n\n@@ -1202,8 +1202,7 @@ public class StockMoveLineServiceImpl implements StockMoveLineService {\n             + \" join StockLocation sl on sl.id = stockLocationLine.detailsStockLocation.id WHERE sl.id = \"\n             + stockMove.getFromStockLocation().getId()\n             + \" AND coalesce(stockLocationLine.currentQty, 0) != 0)\";\n-    List<TrackingNumber> trackingNumbers = trackingNumberRepo.all().filter(domain).fetch();\n-    return trackingNumbers;\n+    return trackingNumberRepo.all().filter(domain).fetch();\n   }\n \n   public void fillRealizeWapPrice(StockMoveLine stockMoveLine) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTY1Mjk2OQ==", "url": "https://github.com/axelor/axelor-open-suite/pull/5142#discussion_r395652969", "bodyText": "Small nitpick but you don't have to create a trackingNumbers variable and you can instead return trackingNumberRepo.all().filter(domain).fetch();", "author": "ale-axelor", "createdAt": "2020-03-20T13:56:53Z", "path": "axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java", "diffHunk": "@@ -1195,14 +1195,14 @@ public void setAvailableStatus(StockMoveLine stockMoveLine) {\n \n   public List<TrackingNumber> getAvailableTrackingNumbers(\n       StockMoveLine stockMoveLine, StockMove stockMove) {\n-    List<TrackingNumber> trackingNumbers = null;\n     String domain =\n         \"self.product.id = \"\n             + stockMoveLine.getProduct().getId()\n-            + \" AND self.id in (select stockLocationLine.trackingNumber.id from StockLocationLine stockLocationLine join StockLocation sl on sl.id = stockLocationLine.detailsStockLocation.id WHERE sl.id = \"\n+            + \" AND self.id in (select stockLocationLine.trackingNumber.id from StockLocationLine stockLocationLine\"\n+            + \" join StockLocation sl on sl.id = stockLocationLine.detailsStockLocation.id WHERE sl.id = \"\n             + stockMove.getFromStockLocation().getId()\n-            + \" )\";\n-    trackingNumbers = trackingNumberRepo.all().filter(domain).fetch();\n+            + \" AND coalesce(stockLocationLine.currentQty, 0) != 0)\";\n+    List<TrackingNumber> trackingNumbers = trackingNumberRepo.all().filter(domain).fetch();", "originalCommit": "df6259557b193799a2aee02532d823948a25a2ad", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "7c84abfb7783c4ffa917b0da9c7f5824c84711b2", "chunk": "diff --git a/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java b/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java\nindex 172bc1e8e8..9766f0a195 100644\n--- a/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java\n+++ b/axelor-stock/src/main/java/com/axelor/apps/stock/service/StockMoveLineServiceImpl.java\n\n@@ -1202,8 +1202,7 @@ public class StockMoveLineServiceImpl implements StockMoveLineService {\n             + \" join StockLocation sl on sl.id = stockLocationLine.detailsStockLocation.id WHERE sl.id = \"\n             + stockMove.getFromStockLocation().getId()\n             + \" AND coalesce(stockLocationLine.currentQty, 0) != 0)\";\n-    List<TrackingNumber> trackingNumbers = trackingNumberRepo.all().filter(domain).fetch();\n-    return trackingNumbers;\n+    return trackingNumberRepo.all().filter(domain).fetch();\n   }\n \n   public void fillRealizeWapPrice(StockMoveLine stockMoveLine) {\n"}}, {"oid": "7c84abfb7783c4ffa917b0da9c7f5824c84711b2", "url": "https://github.com/axelor/axelor-open-suite/commit/7c84abfb7783c4ffa917b0da9c7f5824c84711b2", "message": "Manuf. order bugfix : no longer diplay unavaible tracking numbers\n\nOn manuf-order-form > consumedProductsPanel > consumedStockMoveLineList > \"split by tracking numbers\" button\nNo longer displays tracknig numbers when avaibleQty equals 0\n\nRM#25898", "committedDate": "2020-03-23T12:47:39Z", "type": "forcePushed"}, {"oid": "b42caa7ee63c58b0174de6b7db7c4579a114e32e", "url": "https://github.com/axelor/axelor-open-suite/commit/b42caa7ee63c58b0174de6b7db7c4579a114e32e", "message": "Manuf. order bugfix : no longer diplay unavaible tracking numbers\n\nOn manuf-order-form > consumedProductsPanel > consumedStockMoveLineList > \"split by tracking numbers\" button\nNo longer displays tracknig numbers when avaibleQty equals 0\n\nRM#25898", "committedDate": "2020-03-23T12:49:06Z", "type": "forcePushed"}, {"oid": "1d5a8239daab4fde2feafd751e4691392fc6529c", "url": "https://github.com/axelor/axelor-open-suite/commit/1d5a8239daab4fde2feafd751e4691392fc6529c", "message": "Manuf. order bugfix : no longer diplay unavaible tracking numbers\n\nOn manuf-order-form > consumedProductsPanel > consumedStockMoveLineList > \"split by tracking numbers\" button\nNo longer displays tracknig numbers when avaibleQty equals 0\n\nRM#25898", "committedDate": "2020-03-27T13:33:24Z", "type": "commit"}, {"oid": "1d5a8239daab4fde2feafd751e4691392fc6529c", "url": "https://github.com/axelor/axelor-open-suite/commit/1d5a8239daab4fde2feafd751e4691392fc6529c", "message": "Manuf. order bugfix : no longer diplay unavaible tracking numbers\n\nOn manuf-order-form > consumedProductsPanel > consumedStockMoveLineList > \"split by tracking numbers\" button\nNo longer displays tracknig numbers when avaibleQty equals 0\n\nRM#25898", "committedDate": "2020-03-27T13:33:24Z", "type": "forcePushed"}, {"oid": "f3987e9d180f6c87a70561233f3db906a0a0cd2d", "url": "https://github.com/axelor/axelor-open-suite/commit/f3987e9d180f6c87a70561233f3db906a0a0cd2d", "message": "Merge branch '5.2-dev' into 5.2-dev-25898", "committedDate": "2020-03-27T14:44:12Z", "type": "commit"}]}