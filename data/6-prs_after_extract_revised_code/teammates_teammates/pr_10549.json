{"pr_number": 10549, "pr_title": "[#9536] Feedback Submit Page E2E Test", "pr_createdAt": "2020-08-04T14:26:20Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10549", "timeline": [{"oid": "88c8fcece06933e59369847446e8abf3f6d3b010", "url": "https://github.com/TEAMMATES/teammates/commit/88c8fcece06933e59369847446e8abf3f6d3b010", "message": "Add methods for email comparison", "committedDate": "2020-08-04T14:13:37Z", "type": "commit"}, {"oid": "e1300932373bb08a8d44a8ed157faa48348fb85e", "url": "https://github.com/TEAMMATES/teammates/commit/e1300932373bb08a8d44a8ed157faa48348fb85e", "message": "Add backdoor method to get student key", "committedDate": "2020-08-04T14:14:09Z", "type": "commit"}, {"oid": "0152cdd1eb6188d3d0918ccf3d00faafe24615fb", "url": "https://github.com/TEAMMATES/teammates/commit/0152cdd1eb6188d3d0918ccf3d00faafe24615fb", "message": "Add FeedbackSubmitPageE2ETest", "committedDate": "2020-08-04T14:15:32Z", "type": "commit"}, {"oid": "14475eb8a64d268a251f080233053248151af541", "url": "https://github.com/TEAMMATES/teammates/commit/14475eb8a64d268a251f080233053248151af541", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/web/app/components/comment-box/comment-row/comment-row.component.html\n#\tsrc/web/app/components/question-submission-form/question-submission-form.component.html\n#\tsrc/web/app/pages-session/session-submission-page/session-submission-page.component.html", "committedDate": "2020-08-04T14:18:16Z", "type": "commit"}, {"oid": "bbb51451680d350d3049feb2d3edb28c156d1347", "url": "https://github.com/TEAMMATES/teammates/commit/bbb51451680d350d3049feb2d3edb28c156d1347", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/web/app/components/question-submission-form/question-submission-form.component.html", "committedDate": "2020-08-09T03:35:46Z", "type": "forcePushed"}, {"oid": "65a398063ec761ed6f806ac5cc4d30ddc4728362", "url": "https://github.com/TEAMMATES/teammates/commit/65a398063ec761ed6f806ac5cc4d30ddc4728362", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/web/app/components/question-submission-form/question-submission-form.component.html", "committedDate": "2020-08-09T05:07:03Z", "type": "commit"}, {"oid": "af3b1dff1fe01e234811bf2122d07a05bb0de48c", "url": "https://github.com/TEAMMATES/teammates/commit/af3b1dff1fe01e234811bf2122d07a05bb0de48c", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-09T05:07:33Z", "type": "forcePushed"}, {"oid": "98a6ed947429864c73f0739f864b245a00b8cee0", "url": "https://github.com/TEAMMATES/teammates/commit/98a6ed947429864c73f0739f864b245a00b8cee0", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-09T05:53:15Z", "type": "forcePushed"}, {"oid": "cb94dd5fc31db31c8586da8bbf4638d2115c9d1f", "url": "https://github.com/TEAMMATES/teammates/commit/cb94dd5fc31db31c8586da8bbf4638d2115c9d1f", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-09T07:30:28Z", "type": "forcePushed"}, {"oid": "322921348e07879a5d08076bbc5ad624fa51439c", "url": "https://github.com/TEAMMATES/teammates/commit/322921348e07879a5d08076bbc5ad624fa51439c", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-09T08:03:44Z", "type": "commit"}, {"oid": "322921348e07879a5d08076bbc5ad624fa51439c", "url": "https://github.com/TEAMMATES/teammates/commit/322921348e07879a5d08076bbc5ad624fa51439c", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-09T08:03:44Z", "type": "forcePushed"}, {"oid": "6b342949032d3622e13515facd7ab0918442116b", "url": "https://github.com/TEAMMATES/teammates/commit/6b342949032d3622e13515facd7ab0918442116b", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e", "committedDate": "2020-08-11T07:42:29Z", "type": "commit"}, {"oid": "b0f97cd5eae0a84c97ba938afd2a2486bec3f9be", "url": "https://github.com/TEAMMATES/teammates/commit/b0f97cd5eae0a84c97ba938afd2a2486bec3f9be", "message": "Scroll editor into view before writing to it", "committedDate": "2020-08-11T08:53:19Z", "type": "commit"}, {"oid": "695cce8e230067a4ebef1d8b48c0a5f27a98ffe5", "url": "https://github.com/TEAMMATES/teammates/commit/695cce8e230067a4ebef1d8b48c0a5f27a98ffe5", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-11T10:01:18Z", "type": "forcePushed"}, {"oid": "6b65d445feb454b9e6326d1e5092e814638100cc", "url": "https://github.com/TEAMMATES/teammates/commit/6b65d445feb454b9e6326d1e5092e814638100cc", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-11T10:27:45Z", "type": "commit"}, {"oid": "6b65d445feb454b9e6326d1e5092e814638100cc", "url": "https://github.com/TEAMMATES/teammates/commit/6b65d445feb454b9e6326d1e5092e814638100cc", "message": "Fix writeToRichTextEditor method", "committedDate": "2020-08-11T10:27:45Z", "type": "forcePushed"}, {"oid": "b5c1327d1dd1d8cde9c33661658a80e06e1a9817", "url": "https://github.com/TEAMMATES/teammates/commit/b5c1327d1dd1d8cde9c33661658a80e06e1a9817", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/e2e/java/teammates/e2e/pageobjects/AppPage.java\n#\tsrc/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\n#\tsrc/e2e/resources/testng-e2e.xml", "committedDate": "2020-08-13T17:12:29Z", "type": "forcePushed"}, {"oid": "7cf9e5808a34745e7a23a17943266b8a39db32fc", "url": "https://github.com/TEAMMATES/teammates/commit/7cf9e5808a34745e7a23a17943266b8a39db32fc", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/e2e/java/teammates/e2e/pageobjects/AppPage.java\n#\tsrc/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\n#\tsrc/e2e/resources/testng-e2e.xml", "committedDate": "2020-08-13T17:24:50Z", "type": "forcePushed"}, {"oid": "76fa0423103bfff05239f59137ac59543d08d2f4", "url": "https://github.com/TEAMMATES/teammates/commit/76fa0423103bfff05239f59137ac59543d08d2f4", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java\n#\tsrc/e2e/java/teammates/e2e/pageobjects/AppPage.java\n#\tsrc/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\n#\tsrc/e2e/resources/testng-e2e.xml", "committedDate": "2020-08-20T03:20:18Z", "type": "commit"}, {"oid": "76fa0423103bfff05239f59137ac59543d08d2f4", "url": "https://github.com/TEAMMATES/teammates/commit/76fa0423103bfff05239f59137ac59543d08d2f4", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e\n\n# Conflicts:\n#\tsrc/e2e/java/teammates/e2e/cases/e2e/BaseE2ETestCase.java\n#\tsrc/e2e/java/teammates/e2e/pageobjects/AppPage.java\n#\tsrc/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\n#\tsrc/e2e/resources/testng-e2e.xml", "committedDate": "2020-08-20T03:20:18Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY4OTI1MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r474689250", "bodyText": "Not harmful, but be careful of this", "author": "wkurniawan07", "createdAt": "2020-08-21T13:16:10Z", "path": "src/e2e/java/teammates/e2e/pageobjects/AppPage.java", "diffHunk": "@@ -378,6 +376,8 @@ protected void fillFileBox(RemoteWebElement fileBoxElement, String fileName) {\n     }\n \n     /**\n+<<<<<<< HEAD\n+=======", "originalCommit": "76fa0423103bfff05239f59137ac59543d08d2f4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "000c8b80cff8fed8488b87ec7a66d3e081d15d56", "chunk": "diff --git a/src/e2e/java/teammates/e2e/pageobjects/AppPage.java b/src/e2e/java/teammates/e2e/pageobjects/AppPage.java\nindex 58f753c776..7da5f4a30f 100644\n--- a/src/e2e/java/teammates/e2e/pageobjects/AppPage.java\n+++ b/src/e2e/java/teammates/e2e/pageobjects/AppPage.java\n\n@@ -376,8 +376,6 @@ public abstract class AppPage {\n     }\n \n     /**\n-<<<<<<< HEAD\n-=======\n      * Get rich text from editor.\n      */\n     protected String getEditorRichText(WebElement editor) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY4OTMxMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r474689310", "bodyText": "And this", "author": "wkurniawan07", "createdAt": "2020-08-21T13:16:17Z", "path": "src/e2e/java/teammates/e2e/pageobjects/AppPage.java", "diffHunk": "@@ -392,6 +392,7 @@ protected String getEditorRichText(WebElement editor) {\n     }\n \n     /**\n+>>>>>>> 5c2f44f0c69a6abac594ba5c03ef90c162b336f3", "originalCommit": "76fa0423103bfff05239f59137ac59543d08d2f4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "000c8b80cff8fed8488b87ec7a66d3e081d15d56", "chunk": "diff --git a/src/e2e/java/teammates/e2e/pageobjects/AppPage.java b/src/e2e/java/teammates/e2e/pageobjects/AppPage.java\nindex 58f753c776..7da5f4a30f 100644\n--- a/src/e2e/java/teammates/e2e/pageobjects/AppPage.java\n+++ b/src/e2e/java/teammates/e2e/pageobjects/AppPage.java\n\n@@ -392,7 +390,6 @@ public abstract class AppPage {\n     }\n \n     /**\n->>>>>>> 5c2f44f0c69a6abac594ba5c03ef90c162b336f3\n      * Write rich text to editor.\n      */\n     protected void writeToRichTextEditor(WebElement editor, String text) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDMxMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r474690310", "bodyText": "Is there another way to verify this that doesn't involve reloading?", "author": "wkurniawan07", "createdAt": "2020-08-21T13:18:12Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/FeedbackSubmitPageE2ETest.java", "diffHunk": "@@ -0,0 +1,175 @@\n+package teammates.e2e.cases.e2e;\n+\n+import java.time.Instant;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.stream.Collectors;\n+\n+import org.testng.annotations.Test;\n+\n+import teammates.common.datatransfer.attributes.FeedbackSessionAttributes;\n+import teammates.common.datatransfer.attributes.StudentAttributes;\n+import teammates.common.util.AppUrl;\n+import teammates.common.util.Const;\n+import teammates.common.util.StringHelper;\n+import teammates.e2e.pageobjects.AppPage;\n+import teammates.e2e.pageobjects.FeedbackSubmitPage;\n+import teammates.e2e.util.TestProperties;\n+\n+/**\n+ * SUT: {@link Const.WebPageURIs#SESSION_SUBMISSION_PAGE}.\n+ */\n+public class FeedbackSubmitPageE2ETest extends BaseE2ETestCase {\n+    private StudentAttributes student;\n+\n+    private FeedbackSessionAttributes openSession;\n+    private FeedbackSessionAttributes closedSession;\n+    private FeedbackSessionAttributes gracePeriodSession;\n+\n+    @Override\n+    protected void prepareTestData() {\n+        testData = loadDataBundle(\"/FeedbackSubmitPageE2ETest.json\");\n+        testData.feedbackSessions.get(\"Grace Period Session\").setEndTime(Instant.now());\n+        student = testData.students.get(\"Alice\");\n+        if (!TestProperties.isDevServer()) {\n+            student.email = TestProperties.TEST_STUDENT1_ACCOUNT;\n+        }\n+        removeAndRestoreDataBundle(testData);\n+\n+        openSession = testData.feedbackSessions.get(\"Open Session\");\n+        closedSession = testData.feedbackSessions.get(\"Closed Session\");\n+        gracePeriodSession = testData.feedbackSessions.get(\"Grace Period Session\");\n+    }\n+\n+    @Test\n+    public void testAll() {\n+        AppUrl url = createUrl(Const.WebPageURIs.INSTRUCTOR_SESSION_SUBMISSION_PAGE)\n+                .withUserId(testData.instructors.get(\"SFSubmitE2eT.instr\").googleId)\n+                .withCourseId(openSession.getCourseId())\n+                .withSessionName(openSession.getFeedbackSessionName());\n+        FeedbackSubmitPage submitPage = loginAdminToPage(url, FeedbackSubmitPage.class);\n+        submitPage.waitForPageToLoad();\n+\n+        ______TS(\"verify loaded session data\");\n+        submitPage.verifyFeedbackSessionDetails(openSession);\n+\n+        ______TS(\"questions with giver type instructor\");\n+        submitPage.verifyNumQuestions(1);\n+        submitPage.verifyQuestionDetails(1, testData.feedbackQuestions.get(\"qn5InSession1\"));\n+\n+        ______TS(\"questions with giver type students\");\n+        submitPage = loginAdminToPage(getStudentSubmitPageUrl(student, openSession), FeedbackSubmitPage.class);\n+        submitPage.waitForPageToLoad();\n+\n+        submitPage.verifyNumQuestions(4);\n+        submitPage.verifyQuestionDetails(1, testData.feedbackQuestions.get(\"qn1InSession1\"));\n+        submitPage.verifyQuestionDetails(2, testData.feedbackQuestions.get(\"qn2InSession1\"));\n+        submitPage.verifyQuestionDetails(3, testData.feedbackQuestions.get(\"qn3InSession1\"));\n+        submitPage.verifyQuestionDetails(4, testData.feedbackQuestions.get(\"qn4InSession1\"));\n+\n+        ______TS(\"verify recipients: students\");\n+        submitPage.verifyLimitedRecipients(1, 3, getOtherStudents(student));\n+\n+        ______TS(\"verify recipients: instructors\");\n+        submitPage.verifyRecipients(2, getInstructors(), \"Instructor\");\n+\n+        ______TS(\"verify recipients: team mates\");\n+        submitPage.verifyRecipients(3, getTeammates(student), \"Student\");\n+\n+        ______TS(\"verify recipients: teams\");\n+        submitPage.verifyRecipients(4, getOtherTeams(student), \"Team\");\n+\n+        ______TS(\"submit partial response\");\n+        int[] unansweredQuestions = { 1, 2, 3, 4 };\n+        submitPage.verifyWarningMessageForPartialResponse(unansweredQuestions);\n+\n+        ______TS(\"cannot submit in closed session\");\n+        AppUrl closedSessionUrl = getStudentSubmitPageUrl(student, closedSession);\n+        submitPage = AppPage.getNewPageInstance(browser, closedSessionUrl, FeedbackSubmitPage.class);\n+        submitPage.verifyCannotSubmit();\n+\n+        ______TS(\"can submit in grace period\");\n+        AppUrl gracePeriodSessionUrl = getStudentSubmitPageUrl(student, gracePeriodSession);\n+        submitPage = AppPage.getNewPageInstance(browser, gracePeriodSessionUrl, FeedbackSubmitPage.class);\n+        submitPage.waitForPageToLoad();\n+\n+        int[] gracePeriodUnansweredQuestions = { 1 };\n+        submitPage.verifyWarningMessageForPartialResponse(gracePeriodUnansweredQuestions);\n+\n+        ______TS(\"confirmation email\");\n+        submitPage.selectMultipleChoiceOption(1, 1, 1);\n+        submitPage.markWithConfirmationEmail();\n+\n+        submitPage.verifyWarningMessageForPartialResponse(gracePeriodUnansweredQuestions);\n+        verifyEmailSent(student.getEmail(), \"TEAMMATES: Feedback responses successfully recorded\"\n+                + \" [Course: \" + testData.courses.get(\"SFSubmitE2eT.CS2104\").getName() + \"][Feedback Session: \"\n+                + gracePeriodSession.getFeedbackSessionName() + \"]\");\n+\n+        ______TS(\"add comment\");\n+        int qnToComment = 1;\n+        int recipientToComment = 1;\n+        String comment = \"<p>new comment</p>\";\n+        submitPage.addComment(qnToComment, recipientToComment, comment);\n+\n+        submitPage.verifyWarningMessageForPartialResponse(gracePeriodUnansweredQuestions);\n+        // Reload page to verify comment persists in datastore", "originalCommit": "76fa0423103bfff05239f59137ac59543d08d2f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NzI5NjYyOQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r477296629", "bodyText": "Added methods to use the existing verifyPresentInDatastore", "author": "jtankw3", "createdAt": "2020-08-26T13:24:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDY5MDMxMA=="}], "type": "inlineReview", "revised_code": {"commit": "000c8b80cff8fed8488b87ec7a66d3e081d15d56", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/FeedbackSubmitPageE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/FeedbackSubmitPageE2ETest.java\nindex 9350d2d533..7548753fd6 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/FeedbackSubmitPageE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/FeedbackSubmitPageE2ETest.java\n\n@@ -7,8 +7,13 @@ import java.util.stream.Collectors;\n \n import org.testng.annotations.Test;\n \n+import teammates.common.datatransfer.attributes.FeedbackQuestionAttributes;\n+import teammates.common.datatransfer.attributes.FeedbackResponseAttributes;\n+import teammates.common.datatransfer.attributes.FeedbackResponseCommentAttributes;\n import teammates.common.datatransfer.attributes.FeedbackSessionAttributes;\n+import teammates.common.datatransfer.attributes.InstructorAttributes;\n import teammates.common.datatransfer.attributes.StudentAttributes;\n+import teammates.common.datatransfer.questions.FeedbackMcqResponseDetails;\n import teammates.common.util.AppUrl;\n import teammates.common.util.Const;\n import teammates.common.util.StringHelper;\n"}}, {"oid": "b007e337c6dbd48195647e23737f6ea8d873e8d8", "url": "https://github.com/TEAMMATES/teammates/commit/b007e337c6dbd48195647e23737f6ea8d873e8d8", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e", "committedDate": "2020-08-26T01:56:58Z", "type": "commit"}, {"oid": "77b782d2dcc8a3350aef0aa5924b6d3dcb23536e", "url": "https://github.com/TEAMMATES/teammates/commit/77b782d2dcc8a3350aef0aa5924b6d3dcb23536e", "message": "Add backdoor methods to get FeedbackResponseComment", "committedDate": "2020-08-26T13:11:22Z", "type": "commit"}, {"oid": "000c8b80cff8fed8488b87ec7a66d3e081d15d56", "url": "https://github.com/TEAMMATES/teammates/commit/000c8b80cff8fed8488b87ec7a66d3e081d15d56", "message": "Improve verifications in FeedbackSubmitPageE2ETest", "committedDate": "2020-08-26T13:50:38Z", "type": "commit"}, {"oid": "5bff2f9ffe0b4a06fbe001cc28d52395a1c13b91", "url": "https://github.com/TEAMMATES/teammates/commit/5bff2f9ffe0b4a06fbe001cc28d52395a1c13b91", "message": "Add test case for preview and moderation", "committedDate": "2020-08-26T13:51:03Z", "type": "forcePushed"}, {"oid": "259125a046dcd7e3a2819e524f38b761ffd86ed1", "url": "https://github.com/TEAMMATES/teammates/commit/259125a046dcd7e3a2819e524f38b761ffd86ed1", "message": "Add test case for preview and moderation", "committedDate": "2020-08-26T14:02:17Z", "type": "forcePushed"}, {"oid": "e273204c380fe12960657f8d2ade470ff6bc3c0c", "url": "https://github.com/TEAMMATES/teammates/commit/e273204c380fe12960657f8d2ade470ff6bc3c0c", "message": "Add test case for preview and moderation", "committedDate": "2020-08-26T14:04:40Z", "type": "forcePushed"}, {"oid": "d530677f148813ecd8c5cbfdef1d084d10ac75ed", "url": "https://github.com/TEAMMATES/teammates/commit/d530677f148813ecd8c5cbfdef1d084d10ac75ed", "message": "Add test case for preview and moderation", "committedDate": "2020-08-26T14:24:12Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTQ1MjM2MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r479452360", "bodyText": "I think instead of this, we can just check for admin privilege?", "author": "wkurniawan07", "createdAt": "2020-08-28T17:51:37Z", "path": "src/main/java/teammates/ui/webapi/action/GetStudentAction.java", "diffHunk": "@@ -80,6 +80,9 @@ public ActionResult execute() {\n         }\n \n         StudentData studentData = new StudentData(student);\n+        if (isBackdoor()) {", "originalCommit": "82dbb15e7ff58415b1a50ed2ac770ec7dd495444", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0a81ed908af316a5742a6c14027a5129bccbffd6", "chunk": "diff --git a/src/main/java/teammates/ui/webapi/action/GetStudentAction.java b/src/main/java/teammates/ui/webapi/action/GetStudentAction.java\nindex 5a31e9b846..b8fba8939e 100644\n--- a/src/main/java/teammates/ui/webapi/action/GetStudentAction.java\n+++ b/src/main/java/teammates/ui/webapi/action/GetStudentAction.java\n\n@@ -80,7 +80,7 @@ public class GetStudentAction extends Action {\n         }\n \n         StudentData studentData = new StudentData(student);\n-        if (isBackdoor()) {\n+        if (userInfo != null && userInfo.isAdmin) {\n             studentData.setKey(student.getKey());\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE0MTEzNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r480141136", "bodyText": "Need to check that userInfo is not null", "author": "wkurniawan07", "createdAt": "2020-08-31T13:45:19Z", "path": "src/main/java/teammates/ui/webapi/action/GetStudentAction.java", "diffHunk": "@@ -80,6 +80,9 @@ public ActionResult execute() {\n         }\n \n         StudentData studentData = new StudentData(student);\n+        if (userInfo.isAdmin) {", "originalCommit": "4130c7382103ebbc52770ea1082d797aa5bfcd66", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f24d5df57d61895956c13ec2094092c7555feba6", "chunk": "diff --git a/src/main/java/teammates/ui/webapi/action/GetStudentAction.java b/src/main/java/teammates/ui/webapi/action/GetStudentAction.java\nindex 7550e4c275..5a31e9b846 100644\n--- a/src/main/java/teammates/ui/webapi/action/GetStudentAction.java\n+++ b/src/main/java/teammates/ui/webapi/action/GetStudentAction.java\n\n@@ -80,7 +80,7 @@ public class GetStudentAction extends Action {\n         }\n \n         StudentData studentData = new StudentData(student);\n-        if (userInfo.isAdmin) {\n+        if (isBackdoor()) {\n             studentData.setKey(student.getKey());\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDE0MTI0NA==", "url": "https://github.com/TEAMMATES/teammates/pull/10549#discussion_r480141244", "bodyText": "This change is no longer necessary, I believe", "author": "wkurniawan07", "createdAt": "2020-08-31T13:45:32Z", "path": "src/main/java/teammates/ui/webapi/action/Action.java", "diffHunk": "@@ -95,7 +99,7 @@ public void checkAccessControl() {\n     }\n \n     private void initAuthInfo() {\n-        if (Config.BACKDOOR_KEY.equals(req.getHeader(\"Backdoor-Key\"))) {\n+        if (isBackdoor()) {", "originalCommit": "4130c7382103ebbc52770ea1082d797aa5bfcd66", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "fd10a840772f5bc79135f3d1089aaec4b341920d", "chunk": "diff --git a/src/main/java/teammates/ui/webapi/action/Action.java b/src/main/java/teammates/ui/webapi/action/Action.java\nindex f0e781865e..5668a109c2 100644\n--- a/src/main/java/teammates/ui/webapi/action/Action.java\n+++ b/src/main/java/teammates/ui/webapi/action/Action.java\n\n@@ -99,7 +95,7 @@ public abstract class Action {\n     }\n \n     private void initAuthInfo() {\n-        if (isBackdoor()) {\n+        if (Config.BACKDOOR_KEY.equals(req.getHeader(\"Backdoor-Key\"))) {\n             authType = AuthType.ALL_ACCESS;\n             userInfo = new UserInfo(getRequestParamValue(Const.ParamsNames.USER_ID));\n             userInfo.isAdmin = true;\n"}}, {"oid": "f24d5df57d61895956c13ec2094092c7555feba6", "url": "https://github.com/TEAMMATES/teammates/commit/f24d5df57d61895956c13ec2094092c7555feba6", "message": "Add test case for preview and moderation", "committedDate": "2020-08-31T14:02:48Z", "type": "commit"}, {"oid": "0a81ed908af316a5742a6c14027a5129bccbffd6", "url": "https://github.com/TEAMMATES/teammates/commit/0a81ed908af316a5742a6c14027a5129bccbffd6", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e", "committedDate": "2020-08-31T14:03:59Z", "type": "forcePushed"}, {"oid": "fd10a840772f5bc79135f3d1089aaec4b341920d", "url": "https://github.com/TEAMMATES/teammates/commit/fd10a840772f5bc79135f3d1089aaec4b341920d", "message": "Change getStudentAction to check for admin privilege for student key", "committedDate": "2020-08-31T14:09:26Z", "type": "commit"}, {"oid": "1bee73550a52dfc9a8e2840e1e26659291ba2daf", "url": "https://github.com/TEAMMATES/teammates/commit/1bee73550a52dfc9a8e2840e1e26659291ba2daf", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e", "committedDate": "2020-08-31T14:09:35Z", "type": "commit"}, {"oid": "1bee73550a52dfc9a8e2840e1e26659291ba2daf", "url": "https://github.com/TEAMMATES/teammates/commit/1bee73550a52dfc9a8e2840e1e26659291ba2daf", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into session-submission-e2e", "committedDate": "2020-08-31T14:09:35Z", "type": "forcePushed"}, {"oid": "3959c233a8b5364778c86536e63d2e149b35556b", "url": "https://github.com/TEAMMATES/teammates/commit/3959c233a8b5364778c86536e63d2e149b35556b", "message": "Merge branch 'master' into session-submission-e2e", "committedDate": "2020-09-01T03:26:50Z", "type": "commit"}]}