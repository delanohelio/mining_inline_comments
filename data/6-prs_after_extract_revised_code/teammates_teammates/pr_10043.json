{"pr_number": 10043, "pr_title": "[#10041] Add builder pattern to LNPSpecification class", "pr_createdAt": "2020-05-12T05:12:10Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10043", "timeline": [{"oid": "c0174b6a0eb1d25cf352a308299c930cea8fd2c8", "url": "https://github.com/TEAMMATES/teammates/commit/c0174b6a0eb1d25cf352a308299c930cea8fd2c8", "message": "added builder pattern to LNPSpecification class", "committedDate": "2020-05-12T04:57:21Z", "type": "commit"}, {"oid": "a4f40abb7d8f8fc038c7a900f82c1a39a66c8efb", "url": "https://github.com/TEAMMATES/teammates/commit/a4f40abb7d8f8fc038c7a900f82c1a39a66c8efb", "message": "fixed syntax", "committedDate": "2020-05-12T04:57:21Z", "type": "commit"}, {"oid": "06b07713d0ce6f7faec5f8ee0adf2bae43f51850", "url": "https://github.com/TEAMMATES/teammates/commit/06b07713d0ce6f7faec5f8ee0adf2bae43f51850", "message": "updated the static analysis suppression", "committedDate": "2020-05-12T07:44:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjM1OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426216358", "bodyText": "I think the rule suppression should be specific to the file rather than to the whole package. Take a look at ResourceEndpoints to see how to do this.", "author": "xpdavid", "createdAt": "2020-05-17T04:36:38Z", "path": "src/e2e/java/teammates/e2e/util/LNPSpecification.java", "diffHunk": "@@ -60,4 +54,37 @@ private void checkErrorLimit(double errorPct) {\n                     + \"% higher than the specified threshold. \";\n         }\n     }\n+\n+    /**\n+     * Returns a builder for {@link LNPSpecification}.\n+     */\n+    public static Builder builder() {\n+        return new Builder();\n+    }\n+\n+    /**\n+     * A builder class for {@link LNPSpecification}.\n+     */\n+    public static class Builder {", "originalCommit": "06b07713d0ce6f7faec5f8ee0adf2bae43f51850", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMzNDgyMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426334821", "bodyText": "updated the suppression to file-level", "author": "Derek-Hardy", "createdAt": "2020-05-18T01:49:21Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjM1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM0Mjg1MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426342851", "bodyText": "I think using //CHECKSTYLE.OFF:MissingJavadocMethod (and later turn it on //CHECKSTYLE.ON:MissingJavadocMethod) is better than put it in the suppression file.", "author": "xpdavid", "createdAt": "2020-05-18T02:36:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjM1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM0ODU0MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426348541", "bodyText": "Agree. But I find this will result inconsistency in suppression style with other existing Builder class. (specifically in teammates/common/datatransfer/).\nI feel it might be better to have another PR to improve suppression style for Builder across board?", "author": "Derek-Hardy", "createdAt": "2020-05-18T03:07:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjM1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM0OTEwOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426349108", "bodyText": "Please note that the suppression for those datatransfer has <!-- To be implemented slowly --> comment. It is not a convention. It is just we do not have time to add those Javadoc :P", "author": "xpdavid", "createdAt": "2020-05-18T03:10:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjM1OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM1NTc4OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426355789", "bodyText": "Alright! Updated.", "author": "Derek-Hardy", "createdAt": "2020-05-18T03:47:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjM1OA=="}], "type": "inlineReview", "revised_code": {"commit": "17bbf2b64fe12dcc9ee2ef3c8832f494f5abf1c9", "chunk": "diff --git a/src/e2e/java/teammates/e2e/util/LNPSpecification.java b/src/e2e/java/teammates/e2e/util/LNPSpecification.java\nindex c955028cf0..311f031994 100644\n--- a/src/e2e/java/teammates/e2e/util/LNPSpecification.java\n+++ b/src/e2e/java/teammates/e2e/util/LNPSpecification.java\n\n@@ -73,6 +73,7 @@ public class LNPSpecification {\n             specification = new LNPSpecification();\n         }\n \n+        //CHECKSTYLE.OFF:MissingJavadocMethod\n         public Builder withErrorRateLimit(double errorRateLimit) {\n             specification.errorRateLimit = errorRateLimit;\n             return this;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjQ4MA==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426216480", "bodyText": "Ideally, the method should be overridden by child class and the child class will call the builder to return a  LNPSpecification instance (in any way they want). Therefore, the method should not specify what variables to pass (i.e., we should not have the two arguments in the method).", "author": "xpdavid", "createdAt": "2020-05-17T04:39:19Z", "path": "src/e2e/java/teammates/e2e/cases/lnp/BaseLNPTestCase.java", "diffHunk": "@@ -76,7 +76,10 @@\n      *                          (in seconds) for the test endpoint.\n      */\n     protected void setupSpecification(double errorRateLimit, double meanRespTimeLimit) {", "originalCommit": "06b07713d0ce6f7faec5f8ee0adf2bae43f51850", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMzNTMzMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426335330", "bodyText": "refactored the setupSpecification method to abstract and involve no argument. This leads to some changes in child test classes (override & update method call).", "author": "Derek-Hardy", "createdAt": "2020-05-18T01:52:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjIxNjQ4MA=="}], "type": "inlineReview", "revised_code": {"commit": "76770b46c4b7c711be94a6454678819f8d4a9fa9", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/lnp/BaseLNPTestCase.java b/src/e2e/java/teammates/e2e/cases/lnp/BaseLNPTestCase.java\nindex 113f9c07ca..04f55a2f35 100644\n--- a/src/e2e/java/teammates/e2e/cases/lnp/BaseLNPTestCase.java\n+++ b/src/e2e/java/teammates/e2e/cases/lnp/BaseLNPTestCase.java\n\n@@ -70,17 +70,8 @@ public abstract class BaseLNPTestCase extends BaseTestCase {\n \n     /**\n      * Sets up the specification for this L&P test case.\n-     * @param errorRateLimit Maximum allowable threshold for the percentage of failed requests\n-     *                       (0 to 100) to the test endpoint.\n-     * @param meanRespTimeLimit Maximum allowable threshold for the mean response time\n-     *                          (in seconds) for the test endpoint.\n      */\n-    protected void setupSpecification(double errorRateLimit, double meanRespTimeLimit) {\n-        this.specification = LNPSpecification.builder()\n-                                             .withErrorRateLimit(errorRateLimit)\n-                                             .withMeanRespTimeLimit(meanRespTimeLimit)\n-                                             .build();\n-    }\n+    protected abstract void setupSpecification();\n \n     /**\n      * Returns the path to the generated JSON data bundle file.\n"}}, {"oid": "76770b46c4b7c711be94a6454678819f8d4a9fa9", "url": "https://github.com/TEAMMATES/teammates/commit/76770b46c4b7c711be94a6454678819f8d4a9fa9", "message": "refactored setupSpecification method to abstract and overridden by child classes", "committedDate": "2020-05-18T01:32:48Z", "type": "commit"}, {"oid": "ae0d6793135bb318fdb738467b4f243d0b17e812", "url": "https://github.com/TEAMMATES/teammates/commit/ae0d6793135bb318fdb738467b4f243d0b17e812", "message": "updated rule suppression to file-level", "committedDate": "2020-05-18T01:37:18Z", "type": "commit"}, {"oid": "17bbf2b64fe12dcc9ee2ef3c8832f494f5abf1c9", "url": "https://github.com/TEAMMATES/teammates/commit/17bbf2b64fe12dcc9ee2ef3c8832f494f5abf1c9", "message": "added Javadoc method suppression comments", "committedDate": "2020-05-18T03:29:18Z", "type": "commit"}, {"oid": "fa3edffb0c81d10391a92fcd8fff30e17f8c2502", "url": "https://github.com/TEAMMATES/teammates/commit/fa3edffb0c81d10391a92fcd8fff30e17f8c2502", "message": "removed suppression from .xml file", "committedDate": "2020-05-18T03:29:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM3NzYxMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426377611", "bodyText": "This should be proper Javadoc format instead of code comment.\n/**\n * Maximum allowable threshold for the ratio of failed request\n * (between 0 and 1) to the test endpoint.\n */\nI modified the wordings a bit because the number is clearly a ratio, not percentage.", "author": "wkurniawan07", "createdAt": "2020-05-18T05:32:22Z", "path": "src/e2e/java/teammates/e2e/util/LNPSpecification.java", "diffHunk": "@@ -5,24 +5,18 @@\n  */\n public class LNPSpecification {\n \n-    /*\n-        Note: Consider applying the builder pattern if this class gets more complicated.\n-    */\n-\n+    // Maximum allowable threshold for the percentage of failed requests\n+    // (0 to 100) to the test endpoint", "originalCommit": "fa3edffb0c81d10391a92fcd8fff30e17f8c2502", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "aa07f5700ea5fcec05c359a1351eee477bbc9140", "chunk": "diff --git a/src/e2e/java/teammates/e2e/util/LNPSpecification.java b/src/e2e/java/teammates/e2e/util/LNPSpecification.java\nindex 311f031994..a461cb5246 100644\n--- a/src/e2e/java/teammates/e2e/util/LNPSpecification.java\n+++ b/src/e2e/java/teammates/e2e/util/LNPSpecification.java\n\n@@ -5,12 +5,16 @@ package teammates.e2e.util;\n  */\n public class LNPSpecification {\n \n-    // Maximum allowable threshold for the percentage of failed requests\n-    // (0 to 100) to the test endpoint\n+    /**\n+     * Maximum allowable threshold for the ratio of failed request\n+     * (between 0 and 1) to the test endpoint.\n+     */\n     private double errorRateLimit;\n \n-    // Maximum allowable threshold for the mean response time\n-    // (in seconds) for the test endpoint\n+    /**\n+     * Maximum allowable threshold for the mean response time\n+     * (in seconds) for the test endpoint\n+     */\n     private double meanResTimeLimit;\n \n     private String resultsErrorMessage = \"\";\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM3ODI5OA==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426378298", "bodyText": "Try not to have this kind of custom indentation. The intention may be good (e.g. to align with the dots at the previous line), but if any of the previous line changes (e.g. the LNPSpecification class name's change), these lines will be affected as well.\nIt should just be simple 8-space indentation, i.e. 2 steps (where 1 step is 4-space indentation).\n        this.specification = LNPSpecification.builder()\n                .withErrorRateLimit(ERROR_RATE_LIMIT)\n                .withMeanRespTimeLimit(MEAN_RESP_TIME_LIMIT)\n                .build();", "author": "wkurniawan07", "createdAt": "2020-05-18T05:35:04Z", "path": "src/e2e/java/teammates/e2e/cases/lnp/FeedbackSessionSubmitLNPTest.java", "diffHunk": "@@ -252,11 +256,19 @@ protected ListedHashTree getLnpTestPlan() {\n         return testPlan;\n     }\n \n+    @Override\n+    protected void setupSpecification() {\n+        this.specification = LNPSpecification.builder()\n+                                             .withErrorRateLimit(ERROR_RATE_LIMIT)\n+                                             .withMeanRespTimeLimit(MEAN_RESP_TIME_LIMIT)\n+                                             .build();", "originalCommit": "fa3edffb0c81d10391a92fcd8fff30e17f8c2502", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzAyOTgxMQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r427029811", "bodyText": "Thanks for the advice! All styles are updated as suggested.", "author": "Derek-Hardy", "createdAt": "2020-05-19T04:55:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM3ODI5OA=="}], "type": "inlineReview", "revised_code": {"commit": "aa07f5700ea5fcec05c359a1351eee477bbc9140", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/lnp/FeedbackSessionSubmitLNPTest.java b/src/e2e/java/teammates/e2e/cases/lnp/FeedbackSessionSubmitLNPTest.java\nindex 26a1f72894..f251dfe91c 100644\n--- a/src/e2e/java/teammates/e2e/cases/lnp/FeedbackSessionSubmitLNPTest.java\n+++ b/src/e2e/java/teammates/e2e/cases/lnp/FeedbackSessionSubmitLNPTest.java\n\n@@ -259,9 +259,9 @@ public class FeedbackSessionSubmitLNPTest extends BaseLNPTestCase {\n     @Override\n     protected void setupSpecification() {\n         this.specification = LNPSpecification.builder()\n-                                             .withErrorRateLimit(ERROR_RATE_LIMIT)\n-                                             .withMeanRespTimeLimit(MEAN_RESP_TIME_LIMIT)\n-                                             .build();\n+                .withErrorRateLimit(ERROR_RATE_LIMIT)\n+                .withMeanRespTimeLimit(MEAN_RESP_TIME_LIMIT)\n+                .build();\n     }\n \n     @BeforeClass\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjM4MzMxMw==", "url": "https://github.com/TEAMMATES/teammates/pull/10043#discussion_r426383313", "bodyText": "Similarly here.", "author": "wkurniawan07", "createdAt": "2020-05-18T05:53:19Z", "path": "src/e2e/java/teammates/e2e/util/LNPSpecification.java", "diffHunk": "@@ -5,24 +5,18 @@\n  */\n public class LNPSpecification {\n \n-    /*\n-        Note: Consider applying the builder pattern if this class gets more complicated.\n-    */\n-\n+    // Maximum allowable threshold for the percentage of failed requests\n+    // (0 to 100) to the test endpoint\n     private double errorRateLimit;\n+\n+    // Maximum allowable threshold for the mean response time\n+    // (in seconds) for the test endpoint", "originalCommit": "fa3edffb0c81d10391a92fcd8fff30e17f8c2502", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "aa07f5700ea5fcec05c359a1351eee477bbc9140", "chunk": "diff --git a/src/e2e/java/teammates/e2e/util/LNPSpecification.java b/src/e2e/java/teammates/e2e/util/LNPSpecification.java\nindex 311f031994..a461cb5246 100644\n--- a/src/e2e/java/teammates/e2e/util/LNPSpecification.java\n+++ b/src/e2e/java/teammates/e2e/util/LNPSpecification.java\n\n@@ -5,12 +5,16 @@ package teammates.e2e.util;\n  */\n public class LNPSpecification {\n \n-    // Maximum allowable threshold for the percentage of failed requests\n-    // (0 to 100) to the test endpoint\n+    /**\n+     * Maximum allowable threshold for the ratio of failed request\n+     * (between 0 and 1) to the test endpoint.\n+     */\n     private double errorRateLimit;\n \n-    // Maximum allowable threshold for the mean response time\n-    // (in seconds) for the test endpoint\n+    /**\n+     * Maximum allowable threshold for the mean response time\n+     * (in seconds) for the test endpoint\n+     */\n     private double meanResTimeLimit;\n \n     private String resultsErrorMessage = \"\";\n"}}, {"oid": "aa07f5700ea5fcec05c359a1351eee477bbc9140", "url": "https://github.com/TEAMMATES/teammates/commit/aa07f5700ea5fcec05c359a1351eee477bbc9140", "message": "updated coding style", "committedDate": "2020-05-19T03:48:32Z", "type": "commit"}, {"oid": "382f674ba3bbf9b19d6dc94811ac40cc257fd612", "url": "https://github.com/TEAMMATES/teammates/commit/382f674ba3bbf9b19d6dc94811ac40cc257fd612", "message": "added missing period for Javadoc", "committedDate": "2020-05-19T04:18:07Z", "type": "commit"}, {"oid": "3085fd71e944e5838a6dc6822ffb4a3e7fe58faf", "url": "https://github.com/TEAMMATES/teammates/commit/3085fd71e944e5838a6dc6822ffb4a3e7fe58faf", "message": "Merge branch 'master' into 10041-add-builder-pattern", "committedDate": "2020-05-19T04:21:48Z", "type": "commit"}]}