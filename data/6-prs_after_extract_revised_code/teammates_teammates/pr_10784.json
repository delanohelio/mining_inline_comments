{"pr_number": 10784, "pr_title": "[#9536] Migrate remaining Admin E2E tests", "pr_createdAt": "2020-10-14T16:25:16Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10784", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNDgxNDc0OQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r504814749", "bodyText": "Aware that there is verifyEmailSent method. However currently there are places whereby even verifyEmailSent will not work due to wrongly configured email (i.e. forget to append @gmail.com), so we might as well fix this together when fixing the above.", "author": "wkurniawan07", "createdAt": "2020-10-14T16:29:55Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/AutomatedSessionRemindersTest.java", "diffHunk": "@@ -1,43 +1,40 @@\n-package teammates.test.cases.browsertests;\n+package teammates.e2e.cases.e2e;\n \n import org.testng.annotations.Test;\n \n import teammates.common.datatransfer.attributes.FeedbackSessionAttributes;\n import teammates.common.util.AppUrl;\n-import teammates.common.util.Config;\n import teammates.common.util.Const;\n import teammates.common.util.TimeHelper;\n import teammates.common.util.TimeHelperExtension;\n-import teammates.e2e.util.Priority;\n-import teammates.test.pageobjects.GenericAppPage;\n+import teammates.e2e.pageobjects.GenericAppPage;\n+import teammates.e2e.util.TestProperties;\n \n /**\n  * SUT: {@link Const.CronJobURIs#AUTOMATED_FEEDBACK_OPENING_REMINDERS},\n  *      {@link Const.CronJobURIs#AUTOMATED_FEEDBACK_CLOSING_REMINDERS},\n  *      {@link Const.CronJobURIs#AUTOMATED_FEEDBACK_CLOSED_REMINDERS},\n  *      {@link Const.CronJobURIs#AUTOMATED_FEEDBACK_PUBLISHED_REMINDERS}.\n  */\n-@Priority(5)\n-public class AutomatedSessionRemindersTest extends BaseLegacyUiTestCase {\n+public class AutomatedSessionRemindersTest extends BaseE2ETestCase {\n \n     @Override\n     protected void prepareTestData() {\n         testData = loadDataBundle(\"/AutomatedSessionRemindersTest.json\");\n \n-        /*\n-         * In this test, we set the email address of the accounts to be the same as the\n-         * support email address. When running the test against a production server,\n-         * email alerts will be sent to the specified support email address.\n-         * The tester should manually check the email box after running the test suite.\n-         */\n-\n-        testData.accounts.get(\"instructorWithEvals\").email = Config.SUPPORT_EMAIL;\n-        testData.instructors.get(\"AutSessRem.instructor\").email = Config.SUPPORT_EMAIL;\n-        testData.students.get(\"alice.tmms@AutSessRem.course\").email = Config.SUPPORT_EMAIL;\n-        testData.feedbackSessions.get(\"closedSession\").setCreatorEmail(Config.SUPPORT_EMAIL);\n-        testData.feedbackSessions.get(\"closingSession\").setCreatorEmail(Config.SUPPORT_EMAIL);\n-        testData.feedbackSessions.get(\"openingSession\").setCreatorEmail(Config.SUPPORT_EMAIL);\n-        testData.feedbackSessions.get(\"publishedSession\").setCreatorEmail(Config.SUPPORT_EMAIL);\n+        // When running the test against a production server, email alerts will be sent\n+        // to the specified email address\n+        // The tester should manually check the email box after running the test suite\n+        // TODO check if we can automate this checking process", "originalCommit": "19a148650beac33a322fb47a422045d5427c279f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDA1Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506790057", "bodyText": "I believe interactions with Backdoor are abstracted in BaseTestCaseWithBackDoorApiAccess so it may be better to add a getAccount() method there.", "author": "jtankw3", "createdAt": "2020-10-17T03:55:55Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java", "diffHunk": "@@ -0,0 +1,85 @@\n+package teammates.e2e.cases.e2e;\n+\n+import org.testng.annotations.Test;\n+\n+import teammates.common.datatransfer.attributes.AccountAttributes;\n+import teammates.common.util.AppUrl;\n+import teammates.common.util.Const;\n+import teammates.e2e.pageobjects.AdminAccountsPage;\n+import teammates.e2e.util.BackDoor;\n+\n+/**\n+ * SUT: {@link Const.WebPageURIs#ADMIN_ACCOUNTS_PAGE}.\n+ */\n+public class AdminAccountsPageE2ETest extends BaseE2ETestCase {\n+\n+    @Override\n+    protected void prepareTestData() {\n+        testData = loadDataBundle(\"/AdminAccountsPageE2ETest.json\");\n+        removeAndRestoreDataBundle(testData);\n+    }\n+\n+    @Test\n+    public void testAll() {\n+\n+        String googleId = \"AAMgtE2eT.instr2\";\n+\n+        ______TS(\"verify loaded data\");\n+\n+        AppUrl accountsPageUrl = createUrl(Const.WebPageURIs.ADMIN_ACCOUNTS_PAGE)\n+                .withParam(Const.ParamsNames.INSTRUCTOR_ID, googleId);\n+        AdminAccountsPage accountsPage = loginAdminToPage(accountsPageUrl, AdminAccountsPage.class);\n+\n+        AccountAttributes account = BackDoor.getAccount(googleId);", "originalCommit": "3936c91b552a4a368192f8119c7d241f4d797c14", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00e9352bf71f91ac4d9c14035b8510361747ee46", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\nindex 978cbc04a9..9c9f457785 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n\n@@ -30,7 +30,7 @@ public class AdminAccountsPageE2ETest extends BaseE2ETestCase {\n                 .withParam(Const.ParamsNames.INSTRUCTOR_ID, googleId);\n         AdminAccountsPage accountsPage = loginAdminToPage(accountsPageUrl, AdminAccountsPage.class);\n \n-        AccountAttributes account = BackDoor.getAccount(googleId);\n+        AccountAttributes account = getAccount(googleId);\n         accountsPage.verifyAccountDetails(account);\n \n         ______TS(\"action: remove instructor from course\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MDI3MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506790271", "bodyText": "Can consider using the existing verifyPresentInDatastore and verifyAbsentInDatastore which has the retry functionality", "author": "jtankw3", "createdAt": "2020-10-17T03:59:25Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java", "diffHunk": "@@ -0,0 +1,85 @@\n+package teammates.e2e.cases.e2e;\n+\n+import org.testng.annotations.Test;\n+\n+import teammates.common.datatransfer.attributes.AccountAttributes;\n+import teammates.common.util.AppUrl;\n+import teammates.common.util.Const;\n+import teammates.e2e.pageobjects.AdminAccountsPage;\n+import teammates.e2e.util.BackDoor;\n+\n+/**\n+ * SUT: {@link Const.WebPageURIs#ADMIN_ACCOUNTS_PAGE}.\n+ */\n+public class AdminAccountsPageE2ETest extends BaseE2ETestCase {\n+\n+    @Override\n+    protected void prepareTestData() {\n+        testData = loadDataBundle(\"/AdminAccountsPageE2ETest.json\");\n+        removeAndRestoreDataBundle(testData);\n+    }\n+\n+    @Test\n+    public void testAll() {\n+\n+        String googleId = \"AAMgtE2eT.instr2\";\n+\n+        ______TS(\"verify loaded data\");\n+\n+        AppUrl accountsPageUrl = createUrl(Const.WebPageURIs.ADMIN_ACCOUNTS_PAGE)\n+                .withParam(Const.ParamsNames.INSTRUCTOR_ID, googleId);\n+        AdminAccountsPage accountsPage = loginAdminToPage(accountsPageUrl, AdminAccountsPage.class);\n+\n+        AccountAttributes account = BackDoor.getAccount(googleId);\n+        accountsPage.verifyAccountDetails(account);\n+\n+        ______TS(\"action: remove instructor from course\");\n+\n+        String courseId = \"AAMgtE2eT.CS2103\";\n+        String email = \"AAMgtE2eT.instr2@gmail.tmt\";\n+\n+        assertNotNull(BackDoor.getInstructor(courseId, email));\n+        accountsPage.clickRemoveInstructorFromCourse(courseId);\n+        assertNull(BackDoor.getInstructor(courseId, email));", "originalCommit": "3936c91b552a4a368192f8119c7d241f4d797c14", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00e9352bf71f91ac4d9c14035b8510361747ee46", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\nindex 978cbc04a9..9c9f457785 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n\n@@ -30,7 +30,7 @@ public class AdminAccountsPageE2ETest extends BaseE2ETestCase {\n                 .withParam(Const.ParamsNames.INSTRUCTOR_ID, googleId);\n         AdminAccountsPage accountsPage = loginAdminToPage(accountsPageUrl, AdminAccountsPage.class);\n \n-        AccountAttributes account = BackDoor.getAccount(googleId);\n+        AccountAttributes account = getAccount(googleId);\n         accountsPage.verifyAccountDetails(account);\n \n         ______TS(\"action: remove instructor from course\");\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MTE0NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506791145", "bodyText": "Might be better to have verifyStatusMessage in AdminAccountsPageE2ETest instead as it does not feel like it belongs to these action related methods.", "author": "jtankw3", "createdAt": "2020-10-17T04:10:21Z", "path": "src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java", "diffHunk": "@@ -0,0 +1,116 @@\n+package teammates.e2e.pageobjects;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.fail;\n+\n+import java.util.List;\n+\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.WebElement;\n+import org.openqa.selenium.support.FindBy;\n+\n+import teammates.common.datatransfer.attributes.AccountAttributes;\n+\n+/**\n+ * Page Object Model for the admin accounts page.\n+ */\n+public class AdminAccountsPage extends AppPage {\n+\n+    @FindBy(id = \"account-google-id\")\n+    private WebElement accountId;\n+\n+    @FindBy(id = \"account-name\")\n+    private WebElement accountName;\n+\n+    @FindBy(id = \"account-email\")\n+    private WebElement accountEmail;\n+\n+    @FindBy(id = \"account-institute\")\n+    private WebElement accountInstitute;\n+\n+    @FindBy(id = \"account-is-instructor\")\n+    private WebElement accountIsInstructor;\n+\n+    @FindBy(id = \"instructor-table\")\n+    private WebElement instructorTable;\n+\n+    @FindBy(id = \"student-table\")\n+    private WebElement studentTable;\n+\n+    @FindBy(id = \"btn-downgrade-account\")\n+    private WebElement downgradeAccountButton;\n+\n+    @FindBy(id = \"btn-delete-account\")\n+    private WebElement deleteAccountButton;\n+\n+    public AdminAccountsPage(Browser browser) {\n+        super(browser);\n+    }\n+\n+    @Override\n+    protected boolean containsExpectedPageContents() {\n+        return getPageSource().contains(\"Account Details\");\n+    }\n+\n+    public void verifyAccountDetails(AccountAttributes account) {\n+        assertEquals(account.getGoogleId(), accountId.getText());\n+        assertEquals(account.getName(), accountName.getText());\n+        assertEquals(account.getEmail(), accountEmail.getText());\n+        assertEquals(account.getInstitute(), accountInstitute.getText());\n+        assertEquals(account.isInstructor(), Boolean.parseBoolean(accountIsInstructor.getText()));\n+    }\n+\n+    public void clickRemoveInstructorFromCourse(String courseId) {\n+        List<WebElement> instructorRows =\n+                instructorTable.findElement(By.tagName(\"tbody\")).findElements(By.tagName(\"tr\"));\n+\n+        WebElement deleteButton = null;\n+        for (WebElement instructorRow : instructorRows) {\n+            List<WebElement> cells = instructorRow.findElements(By.tagName(\"td\"));\n+            if (cells.get(0).getText().startsWith(\"[\" + courseId + \"]\")) {\n+                deleteButton = cells.get(1).findElement(By.className(\"btn-danger\"));\n+            }\n+        }\n+\n+        if (deleteButton == null) {\n+            fail(\"Instructor to be deleted is not found\");\n+        }\n+        click(deleteButton);\n+        waitForPageToLoad(true);\n+        verifyStatusMessage(\"Instructor is successfully deleted from course \\\"\" + courseId + \"\\\"\");", "originalCommit": "3936c91b552a4a368192f8119c7d241f4d797c14", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00e9352bf71f91ac4d9c14035b8510361747ee46", "chunk": "diff --git a/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java b/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java\nindex 8f4d663a64..e9091d9ced 100644\n--- a/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java\n+++ b/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java\n\n@@ -77,16 +77,15 @@ public class AdminAccountsPage extends AppPage {\n         }\n         click(deleteButton);\n         waitForPageToLoad(true);\n-        verifyStatusMessage(\"Instructor is successfully deleted from course \\\"\" + courseId + \"\\\"\");\n     }\n \n     public void clickRemoveStudentFromCourse(String courseId) {\n-        List<WebElement> instructorRows =\n+        List<WebElement> studentRows =\n                 studentTable.findElement(By.tagName(\"tbody\")).findElements(By.tagName(\"tr\"));\n \n         WebElement deleteButton = null;\n-        for (WebElement instructorRow : instructorRows) {\n-            List<WebElement> cells = instructorRow.findElements(By.tagName(\"td\"));\n+        for (WebElement studentRow : studentRows) {\n+            List<WebElement> cells = studentRow.findElements(By.tagName(\"td\"));\n             if (cells.get(0).getText().startsWith(\"[\" + courseId + \"]\")) {\n                 deleteButton = cells.get(1).findElement(By.className(\"btn-danger\"));\n             }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MTE2NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506791165", "bodyText": "Should be studentRows here.", "author": "jtankw3", "createdAt": "2020-10-17T04:10:48Z", "path": "src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java", "diffHunk": "@@ -0,0 +1,116 @@\n+package teammates.e2e.pageobjects;\n+\n+import static org.junit.Assert.assertEquals;\n+import static org.junit.Assert.fail;\n+\n+import java.util.List;\n+\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.WebElement;\n+import org.openqa.selenium.support.FindBy;\n+\n+import teammates.common.datatransfer.attributes.AccountAttributes;\n+\n+/**\n+ * Page Object Model for the admin accounts page.\n+ */\n+public class AdminAccountsPage extends AppPage {\n+\n+    @FindBy(id = \"account-google-id\")\n+    private WebElement accountId;\n+\n+    @FindBy(id = \"account-name\")\n+    private WebElement accountName;\n+\n+    @FindBy(id = \"account-email\")\n+    private WebElement accountEmail;\n+\n+    @FindBy(id = \"account-institute\")\n+    private WebElement accountInstitute;\n+\n+    @FindBy(id = \"account-is-instructor\")\n+    private WebElement accountIsInstructor;\n+\n+    @FindBy(id = \"instructor-table\")\n+    private WebElement instructorTable;\n+\n+    @FindBy(id = \"student-table\")\n+    private WebElement studentTable;\n+\n+    @FindBy(id = \"btn-downgrade-account\")\n+    private WebElement downgradeAccountButton;\n+\n+    @FindBy(id = \"btn-delete-account\")\n+    private WebElement deleteAccountButton;\n+\n+    public AdminAccountsPage(Browser browser) {\n+        super(browser);\n+    }\n+\n+    @Override\n+    protected boolean containsExpectedPageContents() {\n+        return getPageSource().contains(\"Account Details\");\n+    }\n+\n+    public void verifyAccountDetails(AccountAttributes account) {\n+        assertEquals(account.getGoogleId(), accountId.getText());\n+        assertEquals(account.getName(), accountName.getText());\n+        assertEquals(account.getEmail(), accountEmail.getText());\n+        assertEquals(account.getInstitute(), accountInstitute.getText());\n+        assertEquals(account.isInstructor(), Boolean.parseBoolean(accountIsInstructor.getText()));\n+    }\n+\n+    public void clickRemoveInstructorFromCourse(String courseId) {\n+        List<WebElement> instructorRows =\n+                instructorTable.findElement(By.tagName(\"tbody\")).findElements(By.tagName(\"tr\"));\n+\n+        WebElement deleteButton = null;\n+        for (WebElement instructorRow : instructorRows) {\n+            List<WebElement> cells = instructorRow.findElements(By.tagName(\"td\"));\n+            if (cells.get(0).getText().startsWith(\"[\" + courseId + \"]\")) {\n+                deleteButton = cells.get(1).findElement(By.className(\"btn-danger\"));\n+            }\n+        }\n+\n+        if (deleteButton == null) {\n+            fail(\"Instructor to be deleted is not found\");\n+        }\n+        click(deleteButton);\n+        waitForPageToLoad(true);\n+        verifyStatusMessage(\"Instructor is successfully deleted from course \\\"\" + courseId + \"\\\"\");\n+    }\n+\n+    public void clickRemoveStudentFromCourse(String courseId) {\n+        List<WebElement> instructorRows =", "originalCommit": "3936c91b552a4a368192f8119c7d241f4d797c14", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00e9352bf71f91ac4d9c14035b8510361747ee46", "chunk": "diff --git a/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java b/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java\nindex 8f4d663a64..e9091d9ced 100644\n--- a/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java\n+++ b/src/e2e/java/teammates/e2e/pageobjects/AdminAccountsPage.java\n\n@@ -77,16 +77,15 @@ public class AdminAccountsPage extends AppPage {\n         }\n         click(deleteButton);\n         waitForPageToLoad(true);\n-        verifyStatusMessage(\"Instructor is successfully deleted from course \\\"\" + courseId + \"\\\"\");\n     }\n \n     public void clickRemoveStudentFromCourse(String courseId) {\n-        List<WebElement> instructorRows =\n+        List<WebElement> studentRows =\n                 studentTable.findElement(By.tagName(\"tbody\")).findElements(By.tagName(\"tr\"));\n \n         WebElement deleteButton = null;\n-        for (WebElement instructorRow : instructorRows) {\n-            List<WebElement> cells = instructorRow.findElements(By.tagName(\"td\"));\n+        for (WebElement studentRow : studentRows) {\n+            List<WebElement> cells = studentRow.findElements(By.tagName(\"td\"));\n             if (cells.get(0).getText().startsWith(\"[\" + courseId + \"]\")) {\n                 deleteButton = cells.get(1).findElement(By.className(\"btn-danger\"));\n             }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MjA1MQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506792051", "bodyText": "Is it possible to shift this verification into AdminSessionsPage as I believe all interaction with WebElements should be hidden in the page object and we should avoid having getters for any WebElements. It can also be reused for the below testcase.", "author": "jtankw3", "createdAt": "2020-10-17T04:22:37Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/AdminSessionsPageE2ETest.java", "diffHunk": "@@ -0,0 +1,181 @@\n+package teammates.e2e.cases.e2e;\n+\n+import java.time.Instant;\n+import java.time.ZoneId;\n+import java.time.format.DateTimeFormatter;\n+import java.util.List;\n+\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.WebElement;\n+import org.testng.annotations.Test;\n+\n+import teammates.common.datatransfer.attributes.FeedbackSessionAttributes;\n+import teammates.common.util.AppUrl;\n+import teammates.common.util.Const;\n+import teammates.common.util.TimeHelper;\n+import teammates.e2e.pageobjects.AdminSessionsPage;\n+\n+/**\n+ * SUT: {@link Const.WebPageURIs#ADMIN_SESSIONS_PAGE}.\n+ */\n+public class AdminSessionsPageE2ETest extends BaseE2ETestCase {\n+    private FeedbackSessionAttributes openFeedbackSession;\n+    private FeedbackSessionAttributes awaitingFeedbackSession;\n+    private FeedbackSessionAttributes futureFeedbackSession;\n+    private Instant instant3DaysAgo = TimeHelper.getInstantDaysOffsetFromNow(-3);\n+    private Instant instantTomorrow = TimeHelper.getInstantDaysOffsetFromNow(1);\n+    private Instant instant3DaysLater = TimeHelper.getInstantDaysOffsetFromNow(3);\n+    private Instant instantNextWeek = TimeHelper.getInstantDaysOffsetFromNow(7);\n+    private Instant instant10DaysLater = TimeHelper.getInstantDaysOffsetFromNow(10);\n+    private Instant instant14DaysLater = TimeHelper.getInstantDaysOffsetFromNow(14);\n+    private Instant instant24DaysLater = TimeHelper.getInstantDaysOffsetFromNow(24);\n+\n+    private String formatDateTime(Instant instant, String timeZone) {\n+        return DateTimeFormatter\n+                .ofPattern(\"EEE, dd MMM YYYY, hh:mm a\")\n+                .format(instant.atZone(ZoneId.of(timeZone)))\n+                .replaceFirst(\" AM$\", \" am\")\n+                .replaceFirst(\" PM$\", \" pm\");\n+    }\n+\n+    @Override\n+    protected void prepareTestData() {\n+        testData = loadDataBundle(\"/AdminSessionsPageE2ETest.json\");\n+\n+        // To guarantee that there will always be some \"ongoing sessions\" listed,\n+        // the test data is injected with date/time values relative to the time where the test takes place\n+\n+        openFeedbackSession = testData.feedbackSessions.get(\"session1InCourse1\");\n+        openFeedbackSession.setStartTime(instant3DaysAgo);\n+        openFeedbackSession.setCreatedTime(instant3DaysAgo);\n+        openFeedbackSession.setSessionVisibleFromTime(instant3DaysAgo);\n+        openFeedbackSession.setEndTime(instant3DaysLater);\n+        openFeedbackSession.setResultsVisibleFromTime(instant3DaysLater);\n+\n+        awaitingFeedbackSession = testData.feedbackSessions.get(\"session2InCourse1\");\n+        awaitingFeedbackSession.setStartTime(instantTomorrow);\n+        awaitingFeedbackSession.setCreatedTime(instant3DaysAgo);\n+        awaitingFeedbackSession.setSessionVisibleFromTime(instantTomorrow);\n+        awaitingFeedbackSession.setEndTime(instant3DaysLater);\n+        awaitingFeedbackSession.setResultsVisibleFromTime(instant3DaysLater);\n+\n+        futureFeedbackSession = testData.feedbackSessions.get(\"session3InCourse1\");\n+        futureFeedbackSession.setStartTime(instant10DaysLater);\n+        futureFeedbackSession.setCreatedTime(instant3DaysAgo);\n+        futureFeedbackSession.setSessionVisibleFromTime(instant10DaysLater);\n+        futureFeedbackSession.setEndTime(instant24DaysLater);\n+        futureFeedbackSession.setResultsVisibleFromTime(instant24DaysLater);\n+\n+        removeAndRestoreDataBundle(testData);\n+    }\n+\n+    @Test\n+    public void testAll() {\n+\n+        ______TS(\"verify loaded data\");\n+\n+        AppUrl sessionsUrl = createUrl(Const.WebPageURIs.ADMIN_SESSIONS_PAGE);\n+        AdminSessionsPage sessionsPage = loginAdminToPage(sessionsUrl, AdminSessionsPage.class);\n+        sessionsPage.waitUntilAnimationFinish();\n+\n+        String tableTimezone = sessionsPage.getSessionsTableTimezone();\n+\n+        List<WebElement> ongoingSessionRows = sessionsPage.getOngoingSessionsRows();", "originalCommit": "3936c91b552a4a368192f8119c7d241f4d797c14", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00e9352bf71f91ac4d9c14035b8510361747ee46", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/AdminSessionsPageE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/AdminSessionsPageE2ETest.java\nindex 6f83885334..b6345b2f8c 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/AdminSessionsPageE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/AdminSessionsPageE2ETest.java\n\n@@ -3,10 +3,7 @@ package teammates.e2e.cases.e2e;\n import java.time.Instant;\n import java.time.ZoneId;\n import java.time.format.DateTimeFormatter;\n-import java.util.List;\n \n-import org.openqa.selenium.By;\n-import org.openqa.selenium.WebElement;\n import org.testng.annotations.Test;\n \n import teammates.common.datatransfer.attributes.FeedbackSessionAttributes;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjc5MjMxMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506792310", "bodyText": "I think we should avoid returning WebElements as we want to minimize interaction outside of the page object.", "author": "jtankw3", "createdAt": "2020-10-17T04:25:32Z", "path": "src/e2e/java/teammates/e2e/pageobjects/AdminSessionsPage.java", "diffHunk": "@@ -0,0 +1,84 @@\n+package teammates.e2e.pageobjects;\n+\n+import java.time.Instant;\n+import java.time.ZoneId;\n+import java.time.format.DateTimeFormatter;\n+import java.util.List;\n+\n+import org.openqa.selenium.By;\n+import org.openqa.selenium.WebElement;\n+import org.openqa.selenium.support.FindBy;\n+\n+/**\n+ * Page Object Model for the admin sessions page.\n+ */\n+public class AdminSessionsPage extends AppPage {\n+\n+    @FindBy(id = \"btn-toggle-filter\")\n+    private WebElement toggleFilterButton;\n+\n+    @FindBy(id = \"ongoing-sessions-table\")\n+    private WebElement ongoingSessionsTable;\n+\n+    public AdminSessionsPage(Browser browser) {\n+        super(browser);\n+    }\n+\n+    @Override\n+    protected boolean containsExpectedPageContents() {\n+        return getPageSource().contains(\"Ongoing Sessions\");\n+    }\n+\n+    public List<WebElement> getOngoingSessionsRows() {", "originalCommit": "3936c91b552a4a368192f8119c7d241f4d797c14", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "00e9352bf71f91ac4d9c14035b8510361747ee46", "chunk": "diff --git a/src/e2e/java/teammates/e2e/pageobjects/AdminSessionsPage.java b/src/e2e/java/teammates/e2e/pageobjects/AdminSessionsPage.java\nindex 8cfc09f932..7b8392aed1 100644\n--- a/src/e2e/java/teammates/e2e/pageobjects/AdminSessionsPage.java\n+++ b/src/e2e/java/teammates/e2e/pageobjects/AdminSessionsPage.java\n\n@@ -1,5 +1,7 @@\n package teammates.e2e.pageobjects;\n \n+import static org.junit.Assert.assertEquals;\n+\n import java.time.Instant;\n import java.time.ZoneId;\n import java.time.format.DateTimeFormatter;\n"}}, {"oid": "00e9352bf71f91ac4d9c14035b8510361747ee46", "url": "https://github.com/TEAMMATES/teammates/commit/00e9352bf71f91ac4d9c14035b8510361747ee46", "message": "Abstract out checking of session rows to page object class", "committedDate": "2020-10-17T07:41:24Z", "type": "forcePushed"}, {"oid": "8154021ab829ca217ed19532a531c703282e37a8", "url": "https://github.com/TEAMMATES/teammates/commit/8154021ab829ca217ed19532a531c703282e37a8", "message": "Abstract out checking of session rows to page object class", "committedDate": "2020-10-17T08:32:43Z", "type": "forcePushed"}, {"oid": "8926f4f0b61ef7379bf0cb5750c81a3f4a75b225", "url": "https://github.com/TEAMMATES/teammates/commit/8926f4f0b61ef7379bf0cb5750c81a3f4a75b225", "message": "Move AutomatedSessionRemindersTest to new E2E test package", "committedDate": "2020-10-17T12:52:34Z", "type": "commit"}, {"oid": "cc7b6ee363a954760287e509b0c835ebef743280", "url": "https://github.com/TEAMMATES/teammates/commit/cc7b6ee363a954760287e509b0c835ebef743280", "message": "Add minimum E2E test for admin sessions page", "committedDate": "2020-10-17T12:52:34Z", "type": "commit"}, {"oid": "ecb8ef0f52d0c562848f404e3094d8e87b154032", "url": "https://github.com/TEAMMATES/teammates/commit/ecb8ef0f52d0c562848f404e3094d8e87b154032", "message": "Add test case for querying future session", "committedDate": "2020-10-17T12:52:34Z", "type": "commit"}, {"oid": "4aa04aeaace8f2eb17bd2d2fc4f49534d1848f6d", "url": "https://github.com/TEAMMATES/teammates/commit/4aa04aeaace8f2eb17bd2d2fc4f49534d1848f6d", "message": "Add minimum E2E test for admin accounts page", "committedDate": "2020-10-17T12:52:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk0MTQwOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506941408", "bodyText": "Actually the getInstructor method will get the InstructorAttribute from the datastore so it is not necessary to verify present again after you call getInstructor. I think you can either get the InstructorAttribute from testData instead or you can just skip the verification.", "author": "jtankw3", "createdAt": "2020-10-17T13:04:59Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java", "diffHunk": "@@ -0,0 +1,96 @@\n+package teammates.e2e.cases.e2e;\n+\n+import org.testng.annotations.Test;\n+\n+import teammates.common.datatransfer.attributes.AccountAttributes;\n+import teammates.common.datatransfer.attributes.InstructorAttributes;\n+import teammates.common.datatransfer.attributes.StudentAttributes;\n+import teammates.common.util.AppUrl;\n+import teammates.common.util.Const;\n+import teammates.e2e.pageobjects.AdminAccountsPage;\n+import teammates.e2e.util.BackDoor;\n+\n+/**\n+ * SUT: {@link Const.WebPageURIs#ADMIN_ACCOUNTS_PAGE}.\n+ */\n+public class AdminAccountsPageE2ETest extends BaseE2ETestCase {\n+\n+    @Override\n+    protected void prepareTestData() {\n+        testData = loadDataBundle(\"/AdminAccountsPageE2ETest.json\");\n+        removeAndRestoreDataBundle(testData);\n+    }\n+\n+    @Test\n+    public void testAll() {\n+\n+        String googleId = \"AAMgtE2eT.instr2\";\n+\n+        ______TS(\"verify loaded data\");\n+\n+        AppUrl accountsPageUrl = createUrl(Const.WebPageURIs.ADMIN_ACCOUNTS_PAGE)\n+                .withParam(Const.ParamsNames.INSTRUCTOR_ID, googleId);\n+        AdminAccountsPage accountsPage = loginAdminToPage(accountsPageUrl, AdminAccountsPage.class);\n+\n+        AccountAttributes account = getAccount(googleId);\n+        accountsPage.verifyAccountDetails(account);\n+\n+        ______TS(\"action: remove instructor from course\");\n+\n+        String courseId = \"AAMgtE2eT.CS2103\";\n+        String email = \"AAMgtE2eT.instr2@gmail.tmt\";\n+\n+        InstructorAttributes instructor = getInstructor(courseId, email);\n+        verifyPresentInDatastore(instructor);", "originalCommit": "8154021ab829ca217ed19532a531c703282e37a8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "258427b99b0f9d815af913039fa649c4a1bd4156", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\nindex fcacdb8f37..c68ceb6df7 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n\n@@ -8,7 +8,6 @@ import teammates.common.datatransfer.attributes.StudentAttributes;\n import teammates.common.util.AppUrl;\n import teammates.common.util.Const;\n import teammates.e2e.pageobjects.AdminAccountsPage;\n-import teammates.e2e.util.BackDoor;\n \n /**\n  * SUT: {@link Const.WebPageURIs#ADMIN_ACCOUNTS_PAGE}.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwNjk0MTUxOA==", "url": "https://github.com/TEAMMATES/teammates/pull/10784#discussion_r506941518", "bodyText": "Same for getStudent and actually we do not have to import BackDoor here because of the getStudent method in BaseTestCaseWithBackDoorApiAccess", "author": "jtankw3", "createdAt": "2020-10-17T13:06:16Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java", "diffHunk": "@@ -0,0 +1,96 @@\n+package teammates.e2e.cases.e2e;\n+\n+import org.testng.annotations.Test;\n+\n+import teammates.common.datatransfer.attributes.AccountAttributes;\n+import teammates.common.datatransfer.attributes.InstructorAttributes;\n+import teammates.common.datatransfer.attributes.StudentAttributes;\n+import teammates.common.util.AppUrl;\n+import teammates.common.util.Const;\n+import teammates.e2e.pageobjects.AdminAccountsPage;\n+import teammates.e2e.util.BackDoor;\n+\n+/**\n+ * SUT: {@link Const.WebPageURIs#ADMIN_ACCOUNTS_PAGE}.\n+ */\n+public class AdminAccountsPageE2ETest extends BaseE2ETestCase {\n+\n+    @Override\n+    protected void prepareTestData() {\n+        testData = loadDataBundle(\"/AdminAccountsPageE2ETest.json\");\n+        removeAndRestoreDataBundle(testData);\n+    }\n+\n+    @Test\n+    public void testAll() {\n+\n+        String googleId = \"AAMgtE2eT.instr2\";\n+\n+        ______TS(\"verify loaded data\");\n+\n+        AppUrl accountsPageUrl = createUrl(Const.WebPageURIs.ADMIN_ACCOUNTS_PAGE)\n+                .withParam(Const.ParamsNames.INSTRUCTOR_ID, googleId);\n+        AdminAccountsPage accountsPage = loginAdminToPage(accountsPageUrl, AdminAccountsPage.class);\n+\n+        AccountAttributes account = getAccount(googleId);\n+        accountsPage.verifyAccountDetails(account);\n+\n+        ______TS(\"action: remove instructor from course\");\n+\n+        String courseId = \"AAMgtE2eT.CS2103\";\n+        String email = \"AAMgtE2eT.instr2@gmail.tmt\";\n+\n+        InstructorAttributes instructor = getInstructor(courseId, email);\n+        verifyPresentInDatastore(instructor);\n+        accountsPage.clickRemoveInstructorFromCourse(courseId);\n+        accountsPage.verifyStatusMessage(\"Instructor is successfully deleted from course \\\"\" + courseId + \"\\\"\");\n+        verifyAbsentInDatastore(instructor);\n+\n+        ______TS(\"action: remove student from course\");\n+\n+        StudentAttributes student = BackDoor.getStudent(courseId, email);\n+        verifyPresentInDatastore(student);", "originalCommit": "8154021ab829ca217ed19532a531c703282e37a8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "258427b99b0f9d815af913039fa649c4a1bd4156", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\nindex fcacdb8f37..c68ceb6df7 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/AdminAccountsPageE2ETest.java\n\n@@ -8,7 +8,6 @@ import teammates.common.datatransfer.attributes.StudentAttributes;\n import teammates.common.util.AppUrl;\n import teammates.common.util.Const;\n import teammates.e2e.pageobjects.AdminAccountsPage;\n-import teammates.e2e.util.BackDoor;\n \n /**\n  * SUT: {@link Const.WebPageURIs#ADMIN_ACCOUNTS_PAGE}.\n"}}, {"oid": "258427b99b0f9d815af913039fa649c4a1bd4156", "url": "https://github.com/TEAMMATES/teammates/commit/258427b99b0f9d815af913039fa649c4a1bd4156", "message": "Add test cases for removing/downgrading accounts", "committedDate": "2020-10-17T13:23:36Z", "type": "commit"}, {"oid": "ec864a90bbb691d72a2738d7c4d5558e66b3345b", "url": "https://github.com/TEAMMATES/teammates/commit/ec864a90bbb691d72a2738d7c4d5558e66b3345b", "message": "Add feature to choose time zone for times displayed in sessions table", "committedDate": "2020-10-17T13:23:36Z", "type": "commit"}, {"oid": "d278d62aff7748c79f6f32491cebcc01116545a6", "url": "https://github.com/TEAMMATES/teammates/commit/d278d62aff7748c79f6f32491cebcc01116545a6", "message": "Abstract out checking of session rows to page object class", "committedDate": "2020-10-17T13:23:36Z", "type": "commit"}, {"oid": "d278d62aff7748c79f6f32491cebcc01116545a6", "url": "https://github.com/TEAMMATES/teammates/commit/d278d62aff7748c79f6f32491cebcc01116545a6", "message": "Abstract out checking of session rows to page object class", "committedDate": "2020-10-17T13:23:36Z", "type": "forcePushed"}]}