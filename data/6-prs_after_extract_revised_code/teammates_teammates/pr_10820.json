{"pr_number": 10820, "pr_title": "[#9536] Fix Feedback Question E2E tests problems", "pr_createdAt": "2020-10-26T03:30:09Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10820", "timeline": [{"oid": "b018067205c28ffbe8f4325265cf3e7b64f38e6d", "url": "https://github.com/TEAMMATES/teammates/commit/b018067205c28ffbe8f4325265cf3e7b64f38e6d", "message": "Remove student key from submit page urls", "committedDate": "2020-10-26T03:01:20Z", "type": "commit"}, {"oid": "2830b61a03c240b5e01e284dacf8c497d8f71108", "url": "https://github.com/TEAMMATES/teammates/commit/2830b61a03c240b5e01e284dacf8c497d8f71108", "message": "Add one reload if page is stuck loading", "committedDate": "2020-10-26T03:16:19Z", "type": "commit"}, {"oid": "809aea5001ee844cea9650464dccef62c1c6d942", "url": "https://github.com/TEAMMATES/teammates/commit/809aea5001ee844cea9650464dccef62c1c6d942", "message": "Add waits to submit page object", "committedDate": "2020-10-26T03:16:41Z", "type": "commit"}, {"oid": "35b1e17d964f0de9c334e11486be0384b9b7e280", "url": "https://github.com/TEAMMATES/teammates/commit/35b1e17d964f0de9c334e11486be0384b9b7e280", "message": "Add wait for feedback edit page", "committedDate": "2020-10-26T03:51:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg3NTA1NQ==", "url": "https://github.com/TEAMMATES/teammates/pull/10820#discussion_r511875055", "bodyText": "I don't think this is the right place to put the reload. Although admittedly I'm also drawing a blank as for where to put it.", "author": "wkurniawan07", "createdAt": "2020-10-26T10:57:33Z", "path": "src/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java", "diffHunk": "@@ -57,6 +57,7 @@ protected boolean containsExpectedPageContents() {\n         if (isElementPresent(By.className(\"modal-content\"))) {\n             waitForConfirmationModalAndClickOk();\n         }\n+        reloadPageIfStuckLoading();", "originalCommit": "35b1e17d964f0de9c334e11486be0384b9b7e280", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQ2ODAwMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10820#discussion_r515468000", "bodyText": "Hmm I think the only other possible place would be calling it in the test classes after navigating to the page.\nSince I added the BaseFeedbackQuestionE2ETest it can be added there", "author": "jtankw3", "createdAt": "2020-10-31T07:35:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTg3NTA1NQ=="}], "type": "inlineReview", "revised_code": {"commit": "d245278fbb05fe6efec488e5e3edf8359ac39e7d", "chunk": "diff --git a/src/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java b/src/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\nindex 3ab46c5b68..c935834479 100644\n--- a/src/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\n+++ b/src/e2e/java/teammates/e2e/pageobjects/FeedbackSubmitPage.java\n\n@@ -57,7 +57,6 @@ public class FeedbackSubmitPage extends AppPage {\n         if (isElementPresent(By.className(\"modal-content\"))) {\n             waitForConfirmationModalAndClickOk();\n         }\n-        reloadPageIfStuckLoading();\n         return getPageTitle().contains(\"Submit Feedback\");\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTQ0NDA4Mg==", "url": "https://github.com/TEAMMATES/teammates/pull/10820#discussion_r515444082", "bodyText": "I think you'd agree that the time is ripe now to create a base class for all these Feedback*QuestionE2ETest.", "author": "wkurniawan07", "createdAt": "2020-10-31T02:18:31Z", "path": "src/e2e/java/teammates/e2e/cases/e2e/FeedbackConstSumOptionQuestionE2ETest.java", "diffHunk": "@@ -100,10 +99,8 @@ private void testSubmitPage() {\n         AppUrl url = createUrl(Const.WebPageURIs.SESSION_SUBMISSION_PAGE)\n                 .withUserId(student.googleId)\n                 .withCourseId(student.course)\n-                .withSessionName(feedbackSession.getFeedbackSessionName())\n-                .withRegistrationKey(getKeyForStudent(student));\n+                .withSessionName(feedbackSession.getFeedbackSessionName());", "originalCommit": "35b1e17d964f0de9c334e11486be0384b9b7e280", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "d245278fbb05fe6efec488e5e3edf8359ac39e7d", "chunk": "diff --git a/src/e2e/java/teammates/e2e/cases/e2e/FeedbackConstSumOptionQuestionE2ETest.java b/src/e2e/java/teammates/e2e/cases/e2e/FeedbackConstSumOptionQuestionE2ETest.java\nindex 0f51869010..da1e7aa7a8 100644\n--- a/src/e2e/java/teammates/e2e/cases/e2e/FeedbackConstSumOptionQuestionE2ETest.java\n+++ b/src/e2e/java/teammates/e2e/cases/e2e/FeedbackConstSumOptionQuestionE2ETest.java\n\n@@ -95,12 +81,9 @@ public class FeedbackConstSumOptionQuestionE2ETest extends BaseE2ETestCase {\n         verifyPresentInDatastore(loadedQuestion);\n     }\n \n-    private void testSubmitPage() {\n-        AppUrl url = createUrl(Const.WebPageURIs.SESSION_SUBMISSION_PAGE)\n-                .withUserId(student.googleId)\n-                .withCourseId(student.course)\n-                .withSessionName(feedbackSession.getFeedbackSessionName());\n-        FeedbackSubmitPage feedbackSubmitPage = loginAdminToPage(url, FeedbackSubmitPage.class);\n+    @Override\n+    protected void testSubmitPage() {\n+        FeedbackSubmitPage feedbackSubmitPage = loginToFeedbackSubmitPage();\n \n         ______TS(\"verify loaded question\");\n         FeedbackQuestionAttributes question = testData.feedbackQuestions.get(\"qn1ForFirstSession\");\n"}}, {"oid": "d245278fbb05fe6efec488e5e3edf8359ac39e7d", "url": "https://github.com/TEAMMATES/teammates/commit/d245278fbb05fe6efec488e5e3edf8359ac39e7d", "message": "Add BaseFeedbackQuestionE2ETest", "committedDate": "2020-10-31T08:21:50Z", "type": "commit"}, {"oid": "bc9805957a7b2b813278e4db3a175cfa5ae8e4b8", "url": "https://github.com/TEAMMATES/teammates/commit/bc9805957a7b2b813278e4db3a175cfa5ae8e4b8", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into flaky-submit-page-e2e", "committedDate": "2020-10-31T08:26:00Z", "type": "commit"}, {"oid": "5560125aaa5771492dc1be416146023c7119b764", "url": "https://github.com/TEAMMATES/teammates/commit/5560125aaa5771492dc1be416146023c7119b764", "message": "Exclude all base classes from TestNgXmlTest", "committedDate": "2020-10-31T08:26:20Z", "type": "commit"}, {"oid": "5560125aaa5771492dc1be416146023c7119b764", "url": "https://github.com/TEAMMATES/teammates/commit/5560125aaa5771492dc1be416146023c7119b764", "message": "Exclude all base classes from TestNgXmlTest", "committedDate": "2020-10-31T08:26:20Z", "type": "forcePushed"}, {"oid": "5f66b38e538f351f124ba3615ea77b1692893a50", "url": "https://github.com/TEAMMATES/teammates/commit/5f66b38e538f351f124ba3615ea77b1692893a50", "message": "Fix lint errors", "committedDate": "2020-10-31T08:57:30Z", "type": "commit"}, {"oid": "313ff4b0e42219f9e712dad4a3607461f99ff377", "url": "https://github.com/TEAMMATES/teammates/commit/313ff4b0e42219f9e712dad4a3607461f99ff377", "message": "Merge branch 'master' of https://github.com/TEAMMATES/teammates into flaky-submit-page-e2e\n\n# Conflicts:\n#\tsrc/e2e/java/teammates/e2e/cases/BaseFeedbackQuestionE2ETest.java", "committedDate": "2020-11-01T04:21:16Z", "type": "commit"}]}