{"pr_number": 10300, "pr_title": "[#9474] Change Email Validation to Enforce TLD", "pr_createdAt": "2020-07-12T07:16:09Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10300", "timeline": [{"oid": "bae24d3d1ba650e52e6d3d9f783026fd2ff8d17b", "url": "https://github.com/TEAMMATES/teammates/commit/bae24d3d1ba650e52e6d3d9f783026fd2ff8d17b", "message": "Change email validation to enforce TLD", "committedDate": "2020-07-12T08:21:20Z", "type": "commit"}, {"oid": "38487380df2469482f327126bdbe5006bdd3fe68", "url": "https://github.com/TEAMMATES/teammates/commit/38487380df2469482f327126bdbe5006bdd3fe68", "message": "Fix emails used in other tests", "committedDate": "2020-07-12T08:41:28Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMxNTQwNg==", "url": "https://github.com/TEAMMATES/teammates/pull/10300#discussion_r453315406", "bodyText": "This is unrelated change", "author": "wkurniawan07", "createdAt": "2020-07-12T13:15:56Z", "path": "src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java", "diffHunk": "@@ -42,7 +43,7 @@ public void testExecute() throws Exception {\n     public void testExecute_withNewStudent_shouldBeAddedToDatabase() {\n         String courseId = typicalBundle.students.get(\"student1InCourse1\").getCourse();\n         StudentAttributes newStudent = getTypicalNewStudent(courseId);\n-        StudentsEnrollRequest req = prepareRequest(Arrays.asList(newStudent));\n+        StudentsEnrollRequest req = prepareRequest(Collections.singletonList(newStudent));", "originalCommit": "38487380df2469482f327126bdbe5006bdd3fe68", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "07625aa24d6c82d6a72d5fd777d01b592e8cc884", "chunk": "diff --git a/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java b/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java\nindex 1d7cb921b0..a3b7babcd8 100644\n--- a/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java\n+++ b/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java\n\n@@ -43,7 +42,7 @@ public class EnrollStudentsActionTest extends BaseActionTest<EnrollStudentsActio\n     public void testExecute_withNewStudent_shouldBeAddedToDatabase() {\n         String courseId = typicalBundle.students.get(\"student1InCourse1\").getCourse();\n         StudentAttributes newStudent = getTypicalNewStudent(courseId);\n-        StudentsEnrollRequest req = prepareRequest(Collections.singletonList(newStudent));\n+        StudentsEnrollRequest req = prepareRequest(Arrays.asList(newStudent));\n \n         loginAsInstructor(typicalBundle.instructors.get(\"instructor1OfCourse1\").getGoogleId());\n         List<StudentData> enrolledStudents = executeActionAndReturnResults(courseId, req);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzMxNTQzMA==", "url": "https://github.com/TEAMMATES/teammates/pull/10300#discussion_r453315430", "bodyText": "This is unrelated change", "author": "wkurniawan07", "createdAt": "2020-07-12T13:16:06Z", "path": "src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java", "diffHunk": "@@ -218,18 +219,18 @@ public void testExecute_withNumberOfStudentsMoreThanSectionLimit_shouldThrowInva\n \n         // Enroll one more student to exceed limit.\n         StudentAttributes oneMoreStudentToGoBeyondLimit = StudentAttributes\n-                .builder(courseId, \"email@com\")\n+                .builder(courseId, \"email@test.com\")\n                 .withName(\"Name\")\n                 .withSectionName(randomSectionName)\n                 .withTeamName(\"Team\")\n                 .withComment(\"cmt\")\n                 .build();\n \n-        req = prepareRequest(Arrays.asList(oneMoreStudentToGoBeyondLimit));\n+        req = prepareRequest(Collections.singletonList(oneMoreStudentToGoBeyondLimit));\n         EnrollStudentsAction action = getAction(req, params);\n \n         InvalidHttpRequestBodyException ee = assertThrows(InvalidHttpRequestBodyException.class,\n-                () -> action.execute());\n+                action::execute);", "originalCommit": "38487380df2469482f327126bdbe5006bdd3fe68", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "07625aa24d6c82d6a72d5fd777d01b592e8cc884", "chunk": "diff --git a/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java b/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java\nindex 1d7cb921b0..a3b7babcd8 100644\n--- a/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java\n+++ b/src/test/java/teammates/test/cases/webapi/EnrollStudentsActionTest.java\n\n@@ -226,11 +225,11 @@ public class EnrollStudentsActionTest extends BaseActionTest<EnrollStudentsActio\n                 .withComment(\"cmt\")\n                 .build();\n \n-        req = prepareRequest(Collections.singletonList(oneMoreStudentToGoBeyondLimit));\n+        req = prepareRequest(Arrays.asList(oneMoreStudentToGoBeyondLimit));\n         EnrollStudentsAction action = getAction(req, params);\n \n         InvalidHttpRequestBodyException ee = assertThrows(InvalidHttpRequestBodyException.class,\n-                action::execute);\n+                () -> action.execute());\n \n         String expectedErrorMessage = String.format(\n                 Const.StudentsLogicConst.ERROR_ENROLL_EXCEED_SECTION_LIMIT,\n"}}, {"oid": "07625aa24d6c82d6a72d5fd777d01b592e8cc884", "url": "https://github.com/TEAMMATES/teammates/commit/07625aa24d6c82d6a72d5fd777d01b592e8cc884", "message": "Fix emails used in other tests", "committedDate": "2020-07-12T15:35:30Z", "type": "commit"}, {"oid": "07625aa24d6c82d6a72d5fd777d01b592e8cc884", "url": "https://github.com/TEAMMATES/teammates/commit/07625aa24d6c82d6a72d5fd777d01b592e8cc884", "message": "Fix emails used in other tests", "committedDate": "2020-07-12T15:35:30Z", "type": "forcePushed"}, {"oid": "1cadb9e80cc7f4523edf8279edc22f00ec631813", "url": "https://github.com/TEAMMATES/teammates/commit/1cadb9e80cc7f4523edf8279edc22f00ec631813", "message": "Merge branch 'master' into 9474-email", "committedDate": "2020-07-13T09:02:57Z", "type": "commit"}]}