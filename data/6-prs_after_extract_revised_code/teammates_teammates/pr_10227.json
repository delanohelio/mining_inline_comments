{"pr_number": 10227, "pr_title": "[#10176] Avoid expensive missing responses generation when recipient type is all students", "pr_createdAt": "2020-06-23T21:11:29Z", "pr_url": "https://github.com/TEAMMATES/teammates/pull/10227", "timeline": [{"oid": "8359135e77ce9f7675832a0e5bb83896931f7fc5", "url": "https://github.com/TEAMMATES/teammates/commit/8359135e77ce9f7675832a0e5bb83896931f7fc5", "message": "add check to avoid generating all combinations when recipient type is all other students", "committedDate": "2020-06-23T20:58:42Z", "type": "commit"}, {"oid": "bd18a57892a10f8dde92822cb14e7c6769791419", "url": "https://github.com/TEAMMATES/teammates/commit/bd18a57892a10f8dde92822cb14e7c6769791419", "message": "Merge branch 'master' into 10176-missing-response-improve", "committedDate": "2020-06-24T08:23:00Z", "type": "commit"}, {"oid": "df4e1395bb77154d1f39c03f732d8d53f02d71dc", "url": "https://github.com/TEAMMATES/teammates/commit/df4e1395bb77154d1f39c03f732d8d53f02d71dc", "message": "Merge branch 'master' into 10176-missing-response-improve", "committedDate": "2020-06-24T09:28:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc2ODg4Ng==", "url": "https://github.com/TEAMMATES/teammates/pull/10227#discussion_r444768886", "bodyText": "I think the common code questionCompleteGiverRecipientMap.put() can be extracted out of if-else.", "author": "Derek-Hardy", "createdAt": "2020-06-24T09:34:16Z", "path": "src/main/java/teammates/logic/core/FeedbackSessionsLogic.java", "diffHunk": "@@ -1651,13 +1651,20 @@ private void addCommentVisibilityToTable(\n             List<FeedbackResponseAttributes> existingResponses, CourseRoster courseRoster, @Nullable String section) {\n \n         // first get all possible giver recipient pairs\n-        Map<String, Map<String, Set<String>>> completeGiverRecipientMap =\n-                fqLogic.buildCompleteGiverRecipientMap(feedbackSession, relatedQuestionsMap.values(), courseRoster);\n+        Map<String, Map<String, Set<String>>> questionCompleteGiverRecipientMap = new HashMap<>();\n+        for (FeedbackQuestionAttributes feedbackQuestion : relatedQuestionsMap.values()) {\n+            if (feedbackQuestion.getQuestionDetails().shouldGenerateMissingResponses(feedbackQuestion)) {\n+                questionCompleteGiverRecipientMap.put(feedbackQuestion.getId(),\n+                        fqLogic.buildCompleteGiverRecipientMap(feedbackSession, feedbackQuestion, courseRoster));\n+            } else {\n+                questionCompleteGiverRecipientMap.put(feedbackQuestion.getId(), new HashMap<>());\n+            }", "originalCommit": "df4e1395bb77154d1f39c03f732d8d53f02d71dc", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDgzMTc4Nw==", "url": "https://github.com/TEAMMATES/teammates/pull/10227#discussion_r444831787", "bodyText": "Can I check if you're requesting for a change? Cause if not I was gonna merge this PR haha", "author": "madanalogy", "createdAt": "2020-06-24T11:38:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc2ODg4Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDg0MzcyNw==", "url": "https://github.com/TEAMMATES/teammates/pull/10227#discussion_r444843727", "bodyText": "Not big issue, can merge.", "author": "Derek-Hardy", "createdAt": "2020-06-24T12:02:09Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDc2ODg4Ng=="}], "type": "inlineReview", "revised_code": null}]}