{"pr_number": 2995, "pr_title": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API", "pr_createdAt": "2020-12-09T17:52:38Z", "pr_url": "https://github.com/uyuni-project/uyuni/pull/2995", "timeline": [{"oid": "89e021b6246bd4e3611bef56a576a4af7e680ea8", "url": "https://github.com/uyuni-project/uyuni/commit/89e021b6246bd4e3611bef56a576a4af7e680ea8", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-09T18:00:02Z", "type": "forcePushed"}, {"oid": "dabc6aa60f93ede0ff4d44bb9ac7451a99be5934", "url": "https://github.com/uyuni-project/uyuni/commit/dabc6aa60f93ede0ff4d44bb9ac7451a99be5934", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-09T18:04:17Z", "type": "forcePushed"}, {"oid": "979e9bfb3b2879ee37cf143f0c54841a5c077c98", "url": "https://github.com/uyuni-project/uyuni/commit/979e9bfb3b2879ee37cf143f0c54841a5c077c98", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-09T18:06:10Z", "type": "forcePushed"}, {"oid": "c948e2f405eaa26bbf104ad00eebed2ea50a2bab", "url": "https://github.com/uyuni-project/uyuni/commit/c948e2f405eaa26bbf104ad00eebed2ea50a2bab", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-09T19:27:36Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NjQ2MQ==", "url": "https://github.com/uyuni-project/uyuni/pull/2995#discussion_r539956461", "bodyText": "What are the pros and cons to add this as a field in this map rather than a full new parameter?", "author": "moio", "createdAt": "2020-12-10T08:07:31Z", "path": "java/code/src/com/redhat/rhn/frontend/xmlrpc/configchannel/ConfigChannelHandler.java", "diffHunk": "@@ -389,6 +389,7 @@ public ConfigChannel update(User loggedInUser, String label,\n      *  #struct_begin(\"path info\")\n      *      #prop_desc(\"string\",\"contents\", \"Contents of the init.sls file\")\n      *      #prop_desc(\"boolean\",\"contents_enc64\", \"Identifies base64 encoded content(default: disabled)\")\n+     *      #prop_desc(\"int\", \"revision\", \"next revision number, auto increment for null\")", "originalCommit": "c948e2f405eaa26bbf104ad00eebed2ea50a2bab", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDAxOTM2MA==", "url": "https://github.com/uyuni-project/uyuni/pull/2995#discussion_r540019360", "bodyText": "PROS\n\nConsistency with the syntax already used on configchannel.createOrUpdatePath, which is the equivalent method for updating \"files\" (instead of \"states\")\nNo need to overload this method to guarantee that we are not breaking the current method signature\nDo not pollute method signature with optional parameters\nSince contents is a required field, and lives inside the map, It doesn't seem right to keep the required contents field in the map and the optional revision field as a new parameter (since revision is less important and less used)\n\nCONS\n\nField is not explicitly declared, so we have to rely on documentation to check which \"fields\" are accepted, but unfortunately Java does not have a great way to deal with optional parameters (requires method overload for that)\n\nLet me know if you prefer a new parameter, so I can update the PR accordingly.", "author": "ricardoasmarques", "createdAt": "2020-12-10T09:42:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NjQ2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MDE3MzI4Nw==", "url": "https://github.com/uyuni-project/uyuni/pull/2995#discussion_r540173287", "bodyText": "PROS\n* Consistency with the syntax already used on `configchannel.createOrUpdatePath`, which is the equivalent method for updating \"files\" (instead of \"states\")\n\n\nGood point.\n\n* No need to overload this method to guarantee that we are not breaking the current method signature\n\n\nOverloading is not a problem with Java and XMLRPC, so that is not a concern I would say.\n\n* Do not pollute method signature with optional parameters\n\n* Since `contents` is a required field, and lives inside the map, It doesn't seem right to keep the **required** `contents` field in the map and the **optional** `revision` field as a new parameter (since `revision` is less important and less used)\n\nCONS\n* Field is not explicitly declared, so we have to rely on documentation to check which \"fields\" are accepted, but unfortunately Java does not have a great way to deal with optional parameters (requires method overload for that)\n\nLet me know if you prefer a new parameter, so I can update the PR accordingly.\n\nI am convinced about the pros, OK with the current direction \ud83d\udc4d", "author": "moio", "createdAt": "2020-12-10T13:36:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzOTk1NjQ2MQ=="}], "type": "inlineReview", "revised_code": null}, {"oid": "2ac219b21bd45fe7e4f6b6b5be8c7ab208c70969", "url": "https://github.com/uyuni-project/uyuni/commit/2ac219b21bd45fe7e4f6b6b5be8c7ab208c70969", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-11T09:30:03Z", "type": "forcePushed"}, {"oid": "d6fc02e37d149f716fcf6de2e6b4f7c0d72f5229", "url": "https://github.com/uyuni-project/uyuni/commit/d6fc02e37d149f716fcf6de2e6b4f7c0d72f5229", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-11T19:51:10Z", "type": "forcePushed"}, {"oid": "ad8e9722849cc0a4ff5596d7b2c595bfef99d95d", "url": "https://github.com/uyuni-project/uyuni/commit/ad8e9722849cc0a4ff5596d7b2c595bfef99d95d", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://bugzilla.suse.com/show_bug.cgi?id=1179566\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-15T14:35:47Z", "type": "forcePushed"}, {"oid": "9b2917cfe68d6a87e934f2dcee12b1e69429b7c3", "url": "https://github.com/uyuni-project/uyuni/commit/9b2917cfe68d6a87e934f2dcee12b1e69429b7c3", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://github.com/SUSE/spacewalk/issues/13345\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-15T14:46:13Z", "type": "commit"}, {"oid": "9b2917cfe68d6a87e934f2dcee12b1e69429b7c3", "url": "https://github.com/uyuni-project/uyuni/commit/9b2917cfe68d6a87e934f2dcee12b1e69429b7c3", "message": "Allow to specify 'Revision' when updating 'init.sls' via CLI or API\n\nThis is already supported by the WebUI, so we are now adapting the\nCLI and API accordingly:\n\n  (CLI) spacecmd > configchannel_updateinitsls ... -r <revision>\n  (API) configchannel.updateInitSls(..., <revision>)\n\nFixes: https://github.com/SUSE/spacewalk/issues/13345\n\nSigned-off-by: Ricardo Marques <rimarques@suse.com>", "committedDate": "2020-12-15T14:46:13Z", "type": "forcePushed"}]}