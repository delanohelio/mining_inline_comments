{"pr_number": 1503, "pr_title": "OWLS-80522 Domain status ordering, OWLS-80144 Ordered rolling upgrade", "pr_createdAt": "2020-03-26T20:38:41Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1503", "timeline": [{"oid": "dc0e6e48f9acb7bb6028d46f5d1d850b9d13770a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dc0e6e48f9acb7bb6028d46f5d1d850b9d13770a", "message": "Domain.getServers() should return servers in order", "committedDate": "2020-03-23T21:10:38Z", "type": "commit"}, {"oid": "88a210afad28040901c70588f22fcceaa1807d53", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/88a210afad28040901c70588f22fcceaa1807d53", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into develop", "committedDate": "2020-03-24T17:47:12Z", "type": "commit"}, {"oid": "e9a5ce9d9332205da800fe4302c05119dad6cab3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e9a5ce9d9332205da800fe4302c05119dad6cab3", "message": "ordered rolling upgrade", "committedDate": "2020-03-24T19:21:32Z", "type": "commit"}, {"oid": "4a25519fa7d8b153d9a2a1270cdeeb304aca0096", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4a25519fa7d8b153d9a2a1270cdeeb304aca0096", "message": "Merge branch 'develop' of https://github.com/oracle/weblogic-kubernetes-operator into develop", "committedDate": "2020-03-25T16:43:30Z", "type": "commit"}, {"oid": "1785163a5332c836762855def3bbbbc174b96120", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1785163a5332c836762855def3bbbbc174b96120", "message": "Merge branch 'develop' into owls-80522", "committedDate": "2020-03-25T16:44:27Z", "type": "commit"}, {"oid": "95492386d80c783014633644093a765d8f1225f7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/95492386d80c783014633644093a765d8f1225f7", "message": "minor test fix", "committedDate": "2020-03-25T17:13:34Z", "type": "commit"}, {"oid": "ad202fff4209fe47802458584589fd49e9df6811", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ad202fff4209fe47802458584589fd49e9df6811", "message": "new RollingHelperTest", "committedDate": "2020-03-25T23:24:39Z", "type": "commit"}, {"oid": "1d28da93bc40b6949e258dde5892adab395a7661", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1d28da93bc40b6949e258dde5892adab395a7661", "message": "Merge branch 'develop' into owls-80522", "committedDate": "2020-03-26T20:58:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkxMzMwNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1503#discussion_r398913307", "bodyText": "How about something more generous than 6 - like 20?  The numbers we're padding come from the customer and there's not much need to be stingy here.", "author": "tbarnes-us", "createdAt": "2020-03-26T21:48:32Z", "path": "operator/src/main/java/oracle/kubernetes/utils/OperatorUtils.java", "diffHunk": "@@ -19,4 +19,62 @@ public static String joinListGrammatically(final List<String> list) {\n             .concat(list.get(list.size() - 1))\n         : list.get(0);\n   }\n+\n+  /**\n+   * Compare the 'numero lexi sorting name' as defined in {@link #getSortingString(String)} of the\n+   * given 2 Strings.\n+   *\n+   * @param str1 First string for comparison\n+   * @param str2 Second string for comparison\n+   * @return a negative integer, zero, or a positive integer as the sorting name of str1 * is less\n+   *     than, equal to, or greater than the sorting name of str2.\n+   */\n+  public static int compareSortingStrings(String str1, String str2) {\n+    if (str1 == null || str2 == null) {\n+      if (str2 != null) {\n+        return -1;\n+      } else if (str1 != null) {\n+        return 1;\n+      }\n+      return 0;\n+    }\n+    return getSortingString(str1).compareTo(getSortingString(str2));\n+  }\n+\n+  /**\n+   * The 'numero lexi sorting name' is a munged version of a\n+   * string that 'zero fills' its numeric portions. This can\n+   * be used to ensure \"member2foo\" sorts before \"member12foo\"\n+   * as these would munge to \"member000002foo\" and \"member000012foo\".\n+   *\n+   * <p>Handles up to 6 digits... - otherwise it doesn't zero fill...\n+   */\n+  public static String getSortingString(String orig) {\n+    String ret = \"\";\n+    String word = \"\";\n+    char lastCh = 0;\n+    for (char ch : orig.toCharArray()) {\n+      if (word.length() != 0\n+          && Character.isDigit(ch) ^ Character.isDigit(lastCh)) {\n+        ret += getSortingWord(word);\n+        word = \"\";\n+      }\n+      word += ch;\n+      lastCh = ch;\n+    }\n+    ret += getSortingWord(word);\n+    return ret;\n+  }\n+\n+  private static String getSortingWord(String word) {\n+    if (word.length() == 0) {\n+      return word;\n+    }\n+    if (Character.isDigit(word.charAt(0))) {\n+      for (int i = word.length(); i < 6; i++) {", "originalCommit": "1d28da93bc40b6949e258dde5892adab395a7661", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU5Mjc2MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1503#discussion_r399592761", "bodyText": "done. Yes, we should be more generous.", "author": "alai8", "createdAt": "2020-03-28T00:24:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODkxMzMwNw=="}], "type": "inlineReview", "revised_code": {"commit": "020e9314aeb07f0b9bbf6ef3f048a835459a568c", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/utils/OperatorUtils.java b/operator/src/main/java/oracle/kubernetes/utils/OperatorUtils.java\nindex be99c8072f..caf9829b9c 100644\n--- a/operator/src/main/java/oracle/kubernetes/utils/OperatorUtils.java\n+++ b/operator/src/main/java/oracle/kubernetes/utils/OperatorUtils.java\n\n@@ -47,7 +47,7 @@ public class OperatorUtils {\n    * be used to ensure \"member2foo\" sorts before \"member12foo\"\n    * as these would munge to \"member000002foo\" and \"member000012foo\".\n    *\n-   * <p>Handles up to 6 digits... - otherwise it doesn't zero fill...\n+   * <p>Handles up to 20 digits... - otherwise it doesn't zero fill...\n    */\n   public static String getSortingString(String orig) {\n     String ret = \"\";\n"}}, {"oid": "020e9314aeb07f0b9bbf6ef3f048a835459a568c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/020e9314aeb07f0b9bbf6ef3f048a835459a568c", "message": "update getSortingString to handle up to 20 digits", "committedDate": "2020-03-26T22:54:49Z", "type": "commit"}, {"oid": "7c3d239103641a07507ecf9516cd7f952838a84a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7c3d239103641a07507ecf9516cd7f952838a84a", "message": "rolling upgrade clusters sorted by cluster names", "committedDate": "2020-03-26T22:55:40Z", "type": "commit"}, {"oid": "0d9aec022924f69a39d88cf71ee328f7f970805d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0d9aec022924f69a39d88cf71ee328f7f970805d", "message": "add isAdminServer to ServerStatus", "committedDate": "2020-03-27T00:11:43Z", "type": "commit"}, {"oid": "3c6967c72841e7ad39bec12f29dae159428ead22", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3c6967c72841e7ad39bec12f29dae159428ead22", "message": "ServerStatus isAdminServer excluded from json schema", "committedDate": "2020-03-27T21:51:10Z", "type": "commit"}, {"oid": "7c08e916f8503619facd267f9578e8082af7fce1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7c08e916f8503619facd267f9578e8082af7fce1", "message": "ClusterStatus sorted by sorting name", "committedDate": "2020-03-27T21:51:53Z", "type": "commit"}, {"oid": "ef880558f4b560646f50bbb0ccc76f5a569af486", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ef880558f4b560646f50bbb0ccc76f5a569af486", "message": "getClusters returning sorted clusters", "committedDate": "2020-03-27T21:52:55Z", "type": "commit"}, {"oid": "d50be42259413e51b35dfe694e5dc929c99bd62d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d50be42259413e51b35dfe694e5dc929c99bd62d", "message": "add unit tests", "committedDate": "2020-03-27T22:39:39Z", "type": "commit"}, {"oid": "b7947b7658428f6cb836186230f192e1f9c8ea90", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b7947b7658428f6cb836186230f192e1f9c8ea90", "message": "handle null map", "committedDate": "2020-03-27T22:40:32Z", "type": "commit"}]}