{"pr_number": 1558, "pr_title": "Log level review and change status from using patch to using endpoint", "pr_createdAt": "2020-04-13T14:58:04Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1558", "timeline": [{"oid": "7e084909bc767d5da0c33071105f9f99b1bb5eb7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7e084909bc767d5da0c33071105f9f99b1bb5eb7", "message": "Review log message levels and include details about request when an async call fails", "committedDate": "2020-04-11T12:32:53Z", "type": "commit"}, {"oid": "8a241b63a408d91c12d9462988ad257f37729824", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8a241b63a408d91c12d9462988ad257f37729824", "message": "Use status endpoint rather than patch", "committedDate": "2020-04-12T17:16:03Z", "type": "commit"}, {"oid": "dfbf6a6e20d968b7e86a57730335d116ed383f3b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dfbf6a6e20d968b7e86a57730335d116ed383f3b", "message": "Record work for other PR's", "committedDate": "2020-04-13T11:32:42Z", "type": "commit"}, {"oid": "8acf186cb23baa1897adc159d3d784d4fc7ee26d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8acf186cb23baa1897adc159d3d784d4fc7ee26d", "message": "Continue adjusting log levels", "committedDate": "2020-04-13T12:39:20Z", "type": "commit"}, {"oid": "6d0fe3cb7f40ab2c6f5f0ca3703b8e9081e8a467", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6d0fe3cb7f40ab2c6f5f0ca3703b8e9081e8a467", "message": "Fix exception display and retry on domain status", "committedDate": "2020-04-13T14:15:51Z", "type": "commit"}, {"oid": "8db2d46f9cd0548f773c95078df321273bd5f8de", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8db2d46f9cd0548f773c95078df321273bd5f8de", "message": "Update FailureStatusSourceException.java", "committedDate": "2020-04-13T15:01:20Z", "type": "commit"}, {"oid": "26a9421ed1d9daf4117c9b710dac2b26613e1840", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/26a9421ed1d9daf4117c9b710dac2b26613e1840", "message": "Update OtherUnrecoverableErrorBuilder.java", "committedDate": "2020-04-13T15:02:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU2NzE2Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1558#discussion_r407567166", "bodyText": "There is a getFormattedMessage() method in the same class that does the same thing, but with less error checking. We can get rid of that method and replace usages with this new method instead.", "author": "alai8", "createdAt": "2020-04-13T16:21:32Z", "path": "operator/src/main/java/oracle/kubernetes/operator/logging/LoggingFacade.java", "diffHunk": "@@ -651,6 +652,36 @@ public String getFormattedMessage(String msg, Object... args) {\n     }\n   }\n \n+  /**\n+   * Accessor for the resource bundle backing this logger.\n+   * @return the bundle\n+   */\n+  public ResourceBundle getResourceBundle() {\n+    for (Logger l = getUnderlyingLogger(); l != null; l = l.getParent()) {\n+      ResourceBundle rb = l.getResourceBundle();\n+      if (rb != null) {\n+        return rb;\n+      }\n+    }\n+    throw new AssertionError(formatMessage(MessageKeys.RESOURCE_BUNDLE_NOT_FOUND));\n+  }\n+\n+  /**\n+   * Formats message based on string loaded from the resource bundle backing this logger.\n+   * @param msgId Message id\n+   * @param params Parameters to message formatting\n+   * @return Formatted message\n+   */\n+  public String formatMessage(String msgId, Object... params) {", "originalCommit": "26a9421ed1d9daf4117c9b710dac2b26613e1840", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU2NzkzMg==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1558#discussion_r407567932", "bodyText": "Oh, thanks!  I missed it.  Let me check.", "author": "rjeberhard", "createdAt": "2020-04-13T16:22:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU2NzE2Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU3NTY4Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1558#discussion_r407575687", "bodyText": "I've decided to keep the formatMessage() method and remove the existing getFormattedMessage() method.", "author": "rjeberhard", "createdAt": "2020-04-13T16:36:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzU2NzE2Ng=="}], "type": "inlineReview", "revised_code": {"commit": "802dc1609e14f1588e8c9d86396295859a61729d", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/operator/logging/LoggingFacade.java b/operator/src/main/java/oracle/kubernetes/operator/logging/LoggingFacade.java\nindex 5615c6cd35..ab5d5385b3 100644\n--- a/operator/src/main/java/oracle/kubernetes/operator/logging/LoggingFacade.java\n+++ b/operator/src/main/java/oracle/kubernetes/operator/logging/LoggingFacade.java\n\n@@ -637,21 +637,6 @@ public class LoggingFacade {\n     finer(TRACE + msg, args);\n   }\n \n-  /**\n-   * Returns a formatted message.\n-   *\n-   * @param msg the message to be formatted, which is key to the resource bundle\n-   * @param args parameters to the message\n-   * @return A formatted message\n-   */\n-  public String getFormattedMessage(String msg, Object... args) {\n-    try {\n-      return MessageFormat.format(logger.getResourceBundle().getString(msg), args);\n-    } catch (Exception ex) {\n-      return msg;\n-    }\n-  }\n-\n   /**\n    * Accessor for the resource bundle backing this logger.\n    * @return the bundle\n"}}, {"oid": "802dc1609e14f1588e8c9d86396295859a61729d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/802dc1609e14f1588e8c9d86396295859a61729d", "message": "Reconcile logger change", "committedDate": "2020-04-13T16:35:48Z", "type": "commit"}, {"oid": "6f195c51a59804113f6268ad754db042938a4db3", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6f195c51a59804113f6268ad754db042938a4db3", "message": "Merge branch 'log-review2' of https://github.com/oracle/weblogic-kubernetes-operator into log-review2", "committedDate": "2020-04-13T16:36:14Z", "type": "commit"}, {"oid": "4d426b905673543f4db918629776bcfd88d81801", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4d426b905673543f4db918629776bcfd88d81801", "message": "Merge remote-tracking branch 'origin/develop' into log-review2", "committedDate": "2020-04-13T21:22:53Z", "type": "commit"}, {"oid": "915cdd93021744a71845daf35e5a3e30c8880f1d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/915cdd93021744a71845daf35e5a3e30c8880f1d", "message": "Merge remote-tracking branch 'origin/develop' into log-review2", "committedDate": "2020-04-15T09:38:25Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODc3ODE3Ng==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1558#discussion_r408778176", "bodyText": "what does this mean? which is evaluated first the or, or the elvis?\nis that what you intended?\nseems like some parens here would help future generations greatly", "author": "markxnelson", "createdAt": "2020-04-15T11:41:53Z", "path": "operator/src/main/java/oracle/kubernetes/operator/calls/RequestParams.java", "diffHunk": "@@ -46,4 +51,31 @@ public RequestParams(\n   public String getLabelSelector() {\n     return callParams.getLabelSelector();\n   }\n+\n+  public String toString() {\n+    return toString(true);\n+  }\n+\n+  /**\n+   * Create readable details of request, optionally including the request body.\n+   * @param includeBody true if request body should be included\n+   * @return readable details of the request\n+   */\n+  public String toString(boolean includeBody) {\n+    StringBuilder sb = new StringBuilder();\n+    sb.append(call);\n+    if (namespace != null) {\n+      sb.append(' ');\n+      sb.append(LOGGER.formatMessage(MessageKeys.REQUEST_PARAMS_IN_NS, namespace));\n+    }\n+    if (name != null) {\n+      sb.append(namespace != null ? \", \" : \" \");\n+      sb.append(LOGGER.formatMessage(MessageKeys.REQUEST_PARAMS_FOR_NAME, name));\n+    }\n+    if (includeBody && body != null) {\n+      sb.append(namespace != null || name != null ? \", \" : \" \");", "originalCommit": "915cdd93021744a71845daf35e5a3e30c8880f1d", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "a6a3843f3623a518e62876b3a53be1bd09724238", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/operator/calls/RequestParams.java b/operator/src/main/java/oracle/kubernetes/operator/calls/RequestParams.java\nindex a19c904e77..c0650e7bcc 100644\n--- a/operator/src/main/java/oracle/kubernetes/operator/calls/RequestParams.java\n+++ b/operator/src/main/java/oracle/kubernetes/operator/calls/RequestParams.java\n\n@@ -69,11 +69,11 @@ public final class RequestParams {\n       sb.append(LOGGER.formatMessage(MessageKeys.REQUEST_PARAMS_IN_NS, namespace));\n     }\n     if (name != null) {\n-      sb.append(namespace != null ? \", \" : \" \");\n+      sb.append((namespace != null) ? \", \" : \" \");\n       sb.append(LOGGER.formatMessage(MessageKeys.REQUEST_PARAMS_FOR_NAME, name));\n     }\n     if (includeBody && body != null) {\n-      sb.append(namespace != null || name != null ? \", \" : \" \");\n+      sb.append((namespace != null || name != null) ? \", \" : \" \");\n       sb.append(LOGGER.formatMessage(MessageKeys.REQUEST_PARAMS_WITH, LoggingFactory.getJson().serialize(body)));\n     }\n     return sb.toString();\n"}}, {"oid": "a6a3843f3623a518e62876b3a53be1bd09724238", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a6a3843f3623a518e62876b3a53be1bd09724238", "message": "Review comments", "committedDate": "2020-04-15T13:31:58Z", "type": "commit"}]}