{"pr_number": 1689, "pr_title": "Istio productization Owls 81599", "pr_createdAt": "2020-05-29T13:09:22Z", "pr_url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689", "timeline": [{"oid": "f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "message": "fix protocol", "committedDate": "2020-06-16T17:41:42Z", "type": "commit"}, {"oid": "09de534a510c7f87cd234c3aead3545bef7ea31d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/09de534a510c7f87cd234c3aead3545bef7ea31d", "message": "Merge remote-tracking branch 'origin/develop' into owls-81599", "committedDate": "2020-06-17T14:25:01Z", "type": "commit"}, {"oid": "d65843da91661b4a035ec162947a5f43c526c158", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d65843da91661b4a035ec162947a5f43c526c158", "message": "Rebuild schemas", "committedDate": "2020-06-17T14:33:05Z", "type": "commit"}, {"oid": "2ab91695e2d53ac29f3820fe053b5a3991fd73dd", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2ab91695e2d53ac29f3820fe053b5a3991fd73dd", "message": "remove ISTIO_ENVOY_PORT", "committedDate": "2020-06-17T14:49:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MTY0NTYyOQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r441645629", "bodyText": "Istio has a capital I", "author": "markxnelson", "createdAt": "2020-06-17T15:44:09Z", "path": "operator/src/main/java/oracle/kubernetes/weblogic/domain/DomainConfigurator.java", "diffHunk": "@@ -469,6 +469,13 @@ public abstract DomainConfigurator withPodSecurityContext(\n    */\n   public abstract DomainConfigurator withOpssWalletFileSecret(String secret);\n \n+  /**\n+   * Add istio for the domain resource.", "originalCommit": "2ab91695e2d53ac29f3820fe053b5a3991fd73dd", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "739d371c834fb7c9fcf30fb88e3cb164f3616d24", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/weblogic/domain/DomainConfigurator.java b/operator/src/main/java/oracle/kubernetes/weblogic/domain/DomainConfigurator.java\nindex 1a7ed21241..baa9d178e3 100644\n--- a/operator/src/main/java/oracle/kubernetes/weblogic/domain/DomainConfigurator.java\n+++ b/operator/src/main/java/oracle/kubernetes/weblogic/domain/DomainConfigurator.java\n\n@@ -470,7 +470,7 @@ public abstract class DomainConfigurator {\n   public abstract DomainConfigurator withOpssWalletFileSecret(String secret);\n \n   /**\n-   * Add istio for the domain resource.\n+   * Add Istio for the domain resource.\n    *\n    * @return this object\n    */\n"}}, {"oid": "6ea46a0dc0b3464375b12ac202ef1a1400899904", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/6ea46a0dc0b3464375b12ac202ef1a1400899904", "message": "update doc", "committedDate": "2020-06-17T16:55:20Z", "type": "commit"}, {"oid": "739d371c834fb7c9fcf30fb88e3cb164f3616d24", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/739d371c834fb7c9fcf30fb88e3cb164f3616d24", "message": "doc updates", "committedDate": "2020-06-17T17:27:21Z", "type": "commit"}, {"oid": "09b21a592c4a3ec58079bd0ac933f792074f36f8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/09b21a592c4a3ec58079bd0ac933f792074f36f8", "message": "doc update", "committedDate": "2020-06-17T17:30:54Z", "type": "commit"}, {"oid": "f370aa928417c53186c8dadfd838c146125bcdfd", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f370aa928417c53186c8dadfd838c146125bcdfd", "message": "final review/edits", "committedDate": "2020-06-18T14:59:47Z", "type": "commit"}, {"oid": "325bf524dbf5fc4646386835287d16ff3e3b6041", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/325bf524dbf5fc4646386835287d16ff3e3b6041", "message": "Rebuild domain documentation", "committedDate": "2020-06-18T15:20:16Z", "type": "commit"}, {"oid": "55d621adf322a481d9cc75710f872883ab3c759b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/55d621adf322a481d9cc75710f872883ab3c759b", "message": "add istio support", "committedDate": "2020-05-20T22:40:49Z", "type": "commit"}, {"oid": "64031a84f1aa037fd0f62b1af2be91846f114688", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/64031a84f1aa037fd0f62b1af2be91846f114688", "message": "update script", "committedDate": "2020-05-21T13:03:13Z", "type": "commit"}, {"oid": "ab74114405e12885bc95b4dbc0700ea44d651427", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ab74114405e12885bc95b4dbc0700ea44d651427", "message": "update sample for istio", "committedDate": "2020-05-21T15:07:39Z", "type": "commit"}, {"oid": "00031fc18d744a05e64dfbeddf8cd02a647b813e", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/00031fc18d744a05e64dfbeddf8cd02a647b813e", "message": "restore deleted token", "committedDate": "2020-05-21T15:21:23Z", "type": "commit"}, {"oid": "9220c9109252bc7a72660291496c9f668b7dd058", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9220c9109252bc7a72660291496c9f668b7dd058", "message": "formatting", "committedDate": "2020-05-21T15:23:24Z", "type": "commit"}, {"oid": "a23d80eef69bbaecb45f910fc29e7bd87d99e1fe", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a23d80eef69bbaecb45f910fc29e7bd87d99e1fe", "message": "add envoyPort to Istio and change nap override logic", "committedDate": "2020-05-21T23:02:20Z", "type": "commit"}, {"oid": "a9aff2c1889dd187721aad2b55d21649bf9dbcc4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a9aff2c1889dd187721aad2b55d21649bf9dbcc4", "message": "update add/replace action", "committedDate": "2020-05-22T00:41:36Z", "type": "commit"}, {"oid": "7c5a878bfc10502f95ec695aa59032459b5a1924", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7c5a878bfc10502f95ec695aa59032459b5a1924", "message": "fix override logic", "committedDate": "2020-05-22T14:57:52Z", "type": "commit"}, {"oid": "3070b20cc2a375349f81b03d017433af17cf8961", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3070b20cc2a375349f81b03d017433af17cf8961", "message": "Fix add and replace logic", "committedDate": "2020-05-22T16:09:16Z", "type": "commit"}, {"oid": "c62317c900fe63d987b11a6e60c4bcbaf9b49731", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/c62317c900fe63d987b11a6e60c4bcbaf9b49731", "message": "Update doc for Istio", "committedDate": "2020-05-22T16:22:34Z", "type": "commit"}, {"oid": "61589aa6e8c18eaf8344f47a806d32949c401f04", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/61589aa6e8c18eaf8344f47a806d32949c401f04", "message": "minor refactoring", "committedDate": "2020-05-26T19:04:38Z", "type": "commit"}, {"oid": "b050b5bfe010a8445da7ac444502c541d5ca3f15", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b050b5bfe010a8445da7ac444502c541d5ca3f15", "message": "update doc", "committedDate": "2020-05-27T00:52:47Z", "type": "commit"}, {"oid": "f3d1ccd953a4a63d4a1b2b406d4c270137600823", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f3d1ccd953a4a63d4a1b2b406d4c270137600823", "message": "doc update", "committedDate": "2020-05-27T00:58:30Z", "type": "commit"}, {"oid": "58469de9de2317b2bf7cf04f4fff92486a23914b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/58469de9de2317b2bf7cf04f4fff92486a23914b", "message": "correct spelling", "committedDate": "2020-05-27T01:01:03Z", "type": "commit"}, {"oid": "692c5de1f487ba258823db61dedd5ffed843faa9", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/692c5de1f487ba258823db61dedd5ffed843faa9", "message": "remove 'experimental'", "committedDate": "2020-05-27T01:04:04Z", "type": "commit"}, {"oid": "5cc5253413dced8ebcd5122352b927494b7e8f90", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5cc5253413dced8ebcd5122352b927494b7e8f90", "message": "doc update", "committedDate": "2020-05-27T01:15:17Z", "type": "commit"}, {"oid": "d7dec22ffe8020462a89407e3ff55e54df928121", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d7dec22ffe8020462a89407e3ff55e54df928121", "message": "fix typo", "committedDate": "2020-05-28T03:23:48Z", "type": "commit"}, {"oid": "1df43c753f60f2f8ff007aaf90bd915935cea941", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/1df43c753f60f2f8ff007aaf90bd915935cea941", "message": "add simple test for istio network channels", "committedDate": "2020-05-28T03:34:48Z", "type": "commit"}, {"oid": "e080e5269011d326eea616ce14a465cd59bb0381", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/e080e5269011d326eea616ce14a465cd59bb0381", "message": "correct side effect of cd", "committedDate": "2020-05-28T22:03:40Z", "type": "commit"}, {"oid": "16a91b8e98edddef9f2cf3a89b7cb00f9eba8199", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/16a91b8e98edddef9f2cf3a89b7cb00f9eba8199", "message": "add protocol check", "committedDate": "2020-05-29T00:02:08Z", "type": "commit"}, {"oid": "86ebe093a225dea5e5eea3dca0f15082b191bd3a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/86ebe093a225dea5e5eea3dca0f15082b191bd3a", "message": "remove working file", "committedDate": "2020-05-29T00:18:18Z", "type": "commit"}, {"oid": "393c40ed11ec798fae17d92e4f51b308fa74c3b8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/393c40ed11ec798fae17d92e4f51b308fa74c3b8", "message": "restore istio fix python but remove all standard istio protocols leaving user external channel", "committedDate": "2020-05-29T01:28:33Z", "type": "commit"}, {"oid": "edbd4f348d6bc650580dc31cb15878fb6dccf400", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/edbd4f348d6bc650580dc31cb15878fb6dccf400", "message": "update test data", "committedDate": "2020-05-29T02:46:57Z", "type": "commit"}, {"oid": "0b5fc210f076cddaa719ca1bbb4a969296414635", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0b5fc210f076cddaa719ca1bbb4a969296414635", "message": "Merge branch 'develop' into owls-81599", "committedDate": "2020-05-29T12:14:50Z", "type": "commit"}, {"oid": "dd6c57e1dd0d005ccdeb8089589a1b7e534469d0", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dd6c57e1dd0d005ccdeb8089589a1b7e534469d0", "message": "doc changes", "committedDate": "2020-05-29T14:10:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUzMDQ4Nw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r432530487", "bodyText": "Let's put this on the next line.", "author": "rjeberhard", "createdAt": "2020-05-29T14:36:55Z", "path": "operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java", "diffHunk": "@@ -113,7 +131,7 @@ public String toString() {\n   public int hashCode() {\n     HashCodeBuilder builder = new HashCodeBuilder()\n         .append(model).append(opss).append(secrets).append(overridesConfigMap)\n-        .append(introspectorJobActiveDeadlineSeconds);\n+        .append(introspectorJobActiveDeadlineSeconds).append(istio);", "originalCommit": "dd6c57e1dd0d005ccdeb8089589a1b7e534469d0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java\nindex dda899e1b0..7634eda755 100644\n--- a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java\n+++ b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java\n\n@@ -130,8 +121,13 @@ public class Configuration {\n   @Override\n   public int hashCode() {\n     HashCodeBuilder builder = new HashCodeBuilder()\n-        .append(model).append(opss).append(secrets).append(overridesConfigMap)\n-        .append(introspectorJobActiveDeadlineSeconds).append(istio);\n+          .append(model)\n+          .append(opss)\n+          .append(secrets)\n+          .append(overrideDistributionStrategy)\n+          .append(overridesConfigMap)\n+          .append(introspectorJobActiveDeadlineSeconds)\n+          .append(istio);\n \n     return builder.toHashCode();\n   }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjUzMTM5NA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r432531394", "bodyText": "It's probably easiest for our Verrazzano friends if we keep Istio under Experimental and then add it under Configuration as you've done. If the value under Configuration is present then that is normative -- no merging if Istio is present at both places.", "author": "rjeberhard", "createdAt": "2020-05-29T14:38:22Z", "path": "operator/src/main/java/oracle/kubernetes/weblogic/domain/model/DomainSpec.java", "diffHunk": "@@ -655,8 +655,8 @@ public void setConfigOverrideSecrets(@Nullable List<String> overridesSecretNames\n    * @return istioEnabled\n    */\n   boolean isIstioEnabled() {\n-    return Optional.ofNullable(experimental)\n-        .map(Experimental::getIstio)\n+    return Optional.ofNullable(configuration)", "originalCommit": "dd6c57e1dd0d005ccdeb8089589a1b7e534469d0", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/DomainSpec.java b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/DomainSpec.java\nindex 03794effc8..cc9fbf692a 100644\n--- a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/DomainSpec.java\n+++ b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/DomainSpec.java\n\n@@ -649,6 +641,20 @@ public class DomainSpec extends BaseConfiguration {\n     this.configOverrideSecrets = overridesSecretNames;\n   }\n \n+  /**\n+   * Returns the strategy used for distributing changed config overrides.\n+   * @return the set or computed strategy\n+   */\n+  public OverrideDistributionStrategy getOverrideDistributionStrategy() {\n+    return Optional.ofNullable(configuration)\n+          .map(Configuration::getOverrideDistributionStrategy)\n+          .orElse(OverrideDistributionStrategy.DEFAULT);\n+  }\n+\n+  Model getModel() {\n+    return Optional.ofNullable(configuration).map(Configuration::getModel).orElse(null);\n+  }\n+\n   /**\n    * Test if the domain is deployed under Istio environment.\n    *\n"}}, {"oid": "f99c20b74ea02fa24251e2be6908f97d5b4f2ddf", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f99c20b74ea02fa24251e2be6908f97d5b4f2ddf", "message": "Restore Experimental and other updates", "committedDate": "2020-05-29T16:15:25Z", "type": "commit"}, {"oid": "a5a96373b77a378e0a02703a40799b590a761c87", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a5a96373b77a378e0a02703a40799b590a761c87", "message": "refactor and add ports to pod", "committedDate": "2020-05-30T03:06:50Z", "type": "commit"}, {"oid": "fad16b45c10eab53570c4c43834ff1c5ca74367d", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/fad16b45c10eab53570c4c43834ff1c5ca74367d", "message": "some refactoring", "committedDate": "2020-05-30T15:09:37Z", "type": "commit"}, {"oid": "72174579bcfc3e116890f7883daa9059518a3cdc", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/72174579bcfc3e116890f7883daa9059518a3cdc", "message": "Merge branch 'develop' into owls-81599", "committedDate": "2020-06-01T15:41:02Z", "type": "commit"}, {"oid": "2c8725c986d03af4ce47d2c38f34ba74dbbcd5e2", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/2c8725c986d03af4ce47d2c38f34ba74dbbcd5e2", "message": "fix script to append istio- for generated channel names", "committedDate": "2020-06-01T20:20:30Z", "type": "commit"}, {"oid": "540c49a531cbc72f85d0d38fa802f5d277f5498a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/540c49a531cbc72f85d0d38fa802f5d277f5498a", "message": "make sure the istio-* overrides channel ports are also created by the pod", "committedDate": "2020-06-02T16:01:23Z", "type": "commit"}, {"oid": "47be10f66a07d5102611031f8a92dd29ae9e93af", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/47be10f66a07d5102611031f8a92dd29ae9e93af", "message": "update sample for external channel port", "committedDate": "2020-06-04T17:04:24Z", "type": "commit"}, {"oid": "ecb8b08488287422d82597288b83e2273aca3104", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/ecb8b08488287422d82597288b83e2273aca3104", "message": "undo the changes", "committedDate": "2020-06-04T18:30:01Z", "type": "commit"}, {"oid": "9b8f48d0a903a56c49a005bad18eeadfa82269f8", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/9b8f48d0a903a56c49a005bad18eeadfa82269f8", "message": "replace token when istioEnabled = false", "committedDate": "2020-06-05T16:41:36Z", "type": "commit"}, {"oid": "f58816c3c0588342f474e3c7850489d6b11005f7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f58816c3c0588342f474e3c7850489d6b11005f7", "message": "correct external channel name when istio is enabled for sample", "committedDate": "2020-06-07T20:46:44Z", "type": "commit"}, {"oid": "bcc0796a4b489041b455cbc236ca1cc975ea419c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/bcc0796a4b489041b455cbc236ca1cc975ea419c", "message": "disable expose channel as service when in istio, let the mesh handle it.", "committedDate": "2020-06-08T22:57:11Z", "type": "commit"}, {"oid": "8b2dc1b2b215c1f27623428a28e1c5db8b7e9e1c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8b2dc1b2b215c1f27623428a28e1c5db8b7e9e1c", "message": "Merge branch 'develop' into owls-81599", "committedDate": "2020-06-11T05:05:30Z", "type": "commit"}, {"oid": "791c41ff292fdd1b2214644c46012ea237e09360", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/791c41ff292fdd1b2214644c46012ea237e09360", "message": "fix merge", "committedDate": "2020-06-11T05:06:28Z", "type": "commit"}, {"oid": "87b5b2ffacb12dd9e34a7d64ce316c313c493a54", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/87b5b2ffacb12dd9e34a7d64ce316c313c493a54", "message": "Change naming convention I.", "committedDate": "2020-06-12T00:02:11Z", "type": "commit"}, {"oid": "4ba9465a3c3fefbd04d1891a935e64376d6e6d1c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4ba9465a3c3fefbd04d1891a935e64376d6e6d1c", "message": "add admin port support", "committedDate": "2020-06-12T01:49:52Z", "type": "commit"}, {"oid": "4ee759a6d37d37bd6eabbbbd1c23a3422c57c00b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4ee759a6d37d37bd6eabbbbd1c23a3422c57c00b", "message": "added comments for TODO", "committedDate": "2020-06-12T04:37:51Z", "type": "commit"}, {"oid": "0ebe1b6cf3c93baff702065644b1ec35e0f74ce4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/0ebe1b6cf3c93baff702065644b1ec35e0f74ce4", "message": "update doc", "committedDate": "2020-06-12T13:09:26Z", "type": "commit"}, {"oid": "4b49282bf1d9c72c346d45b486a321019da69b88", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/4b49282bf1d9c72c346d45b486a321019da69b88", "message": "update doc and add additional protocols ports for default", "committedDate": "2020-06-12T15:28:08Z", "type": "commit"}, {"oid": "b8d8f5aeeb5e05f20d84b8244fa0184e9100ec30", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b8d8f5aeeb5e05f20d84b8244fa0184e9100ec30", "message": "Add support for channel name search when creating ports", "committedDate": "2020-06-12T19:22:37Z", "type": "commit"}, {"oid": "65838547ebf14fe7364bf2679af46bcd5361f4cb", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/65838547ebf14fe7364bf2679af46bcd5361f4cb", "message": "add domain validation against exposing default channel when istio is enabled", "committedDate": "2020-06-12T20:59:55Z", "type": "commit"}, {"oid": "d27d41dc3468749887f794ef4ae429392a1650e7", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/d27d41dc3468749887f794ef4ae429392a1650e7", "message": "minor fix", "committedDate": "2020-06-12T21:32:21Z", "type": "commit"}, {"oid": "a03826415d4fc4d9d046be5bace35ab9629c18a5", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a03826415d4fc4d9d046be5bace35ab9629c18a5", "message": "refactoring", "committedDate": "2020-06-12T23:50:15Z", "type": "commit"}, {"oid": "b67be431ded4bac9f3b0f835ce01780d2b6b378f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b67be431ded4bac9f3b0f835ce01780d2b6b378f", "message": "doc update", "committedDate": "2020-06-13T01:01:30Z", "type": "commit"}, {"oid": "82661afc9a4a483826591f2485e4344d16e438be", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/82661afc9a4a483826591f2485e4344d16e438be", "message": "fix introspectorTest", "committedDate": "2020-06-13T07:55:08Z", "type": "commit"}, {"oid": "3731663bedd7decba910d1e74b2b941835528c09", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/3731663bedd7decba910d1e74b2b941835528c09", "message": "doc update", "committedDate": "2020-06-14T14:13:24Z", "type": "commit"}, {"oid": "7d4f19a6f91104f9bbb9b6c94e83fdc8b7ec6f06", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/7d4f19a6f91104f9bbb9b6c94e83fdc8b7ec6f06", "message": "doc update", "committedDate": "2020-06-14T14:18:52Z", "type": "commit"}, {"oid": "a0036b2b47f81b20a018fc35ccb7a4753e518811", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a0036b2b47f81b20a018fc35ccb7a4753e518811", "message": "doc update", "committedDate": "2020-06-14T14:22:17Z", "type": "commit"}, {"oid": "a8e757fae13055658bdb97ce89e2b3a9a7a91c9a", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/a8e757fae13055658bdb97ce89e2b3a9a7a91c9a", "message": "update sample", "committedDate": "2020-06-14T23:51:47Z", "type": "commit"}, {"oid": "8b44d7162179f366a86ea4090ae289d3ea511035", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8b44d7162179f366a86ea4090ae289d3ea511035", "message": "doc update", "committedDate": "2020-06-15T17:40:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MDUzNA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440340534", "bodyText": "Extra newline", "author": "rjeberhard", "createdAt": "2020-06-15T17:41:25Z", "path": "new-integration-tests/src/test/java/oracle/weblogic/domain/Configuration.java", "diffHunk": "@@ -34,6 +34,10 @@\n           + \" it overrides the Operator's config map data.introspectorJobActiveDeadlineSeconds value.\")\n   private Long introspectorJobActiveDeadlineSeconds;\n \n+  @ApiModelProperty(\"Istio property\")\n+  private Istio istio;\n+\n+", "originalCommit": "a8e757fae13055658bdb97ce89e2b3a9a7a91c9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxMDI3MA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440410270", "bodyText": "removed", "author": "jshum2479", "createdAt": "2020-06-15T19:52:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MDUzNA=="}], "type": "inlineReview", "revised_code": {"commit": "f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "chunk": "diff --git a/new-integration-tests/src/test/java/oracle/weblogic/domain/Configuration.java b/new-integration-tests/src/test/java/oracle/weblogic/domain/Configuration.java\nindex e2fb3999a0..b10e9434b4 100644\n--- a/new-integration-tests/src/test/java/oracle/weblogic/domain/Configuration.java\n+++ b/new-integration-tests/src/test/java/oracle/weblogic/domain/Configuration.java\n\n@@ -34,10 +34,9 @@ public class Configuration {\n           + \" it overrides the Operator's config map data.introspectorJobActiveDeadlineSeconds value.\")\n   private Long introspectorJobActiveDeadlineSeconds;\n \n-  @ApiModelProperty(\"Istio property\")\n+  @ApiModelProperty(\"Istio service mesh integration\")\n   private Istio istio;\n \n-\n   public Configuration model(Model model) {\n     this.model = model;\n     return this;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MzE4MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440343181", "bodyText": "\"Istio service mesh integration\" or something like that", "author": "rjeberhard", "createdAt": "2020-06-15T17:46:18Z", "path": "operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java", "diffHunk": "@@ -39,6 +39,9 @@\n       + \"Legal values are DYNAMIC (the default) and ON_RESTART. See also introspectVersion.\")\n   private OverrideDistributionStrategy overrideDistributionStrategy;\n \n+  @Description(\"Configuration for istio property.\")", "originalCommit": "a8e757fae13055658bdb97ce89e2b3a9a7a91c9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxMTAyNw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440411027", "bodyText": "The Istio service mesh integration settings", "author": "jshum2479", "createdAt": "2020-06-15T19:54:35Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MzE4MQ=="}], "type": "inlineReview", "revised_code": {"commit": "f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java\nindex d595bcec16..7634eda755 100644\n--- a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java\n+++ b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Configuration.java\n\n@@ -39,7 +39,7 @@ public class Configuration {\n       + \"Legal values are DYNAMIC (the default) and ON_RESTART. See also introspectVersion.\")\n   private OverrideDistributionStrategy overrideDistributionStrategy;\n \n-  @Description(\"Configuration for istio property.\")\n+  @Description(\"The Istio service mesh integration settings\")\n   private Istio istio;\n \n   public Model getModel() {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MzU5OA==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440343598", "bodyText": "Shouldn't this be checking for \"default\", \"default-secure\" or \"default-admin\"?", "author": "rjeberhard", "createdAt": "2020-06-15T17:47:08Z", "path": "operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Domain.java", "diffHunk": "@@ -693,6 +702,18 @@ private void addIllegalSitConfigForMii() {\n       }\n     }\n \n+    private void verifyIstioExposingDefaultChannel() {\n+      if (spec.isIstioEnabled()) {\n+        spec.getAdminServer().getAdminService().getChannels().forEach(this::checkForDefaultNameExposed);\n+      }\n+    }\n+\n+    private void checkForDefaultNameExposed(Channel channel) {\n+      if (channel.getChannelName().contains(\"-default\")) {", "originalCommit": "a8e757fae13055658bdb97ce89e2b3a9a7a91c9a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0ODA0MQ==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440348041", "bodyText": "The introspectDomain.py already splitted the channel and passed them to the operator, so the channels are xxx-default filtered in\nprivate void checkForDefaultNameExposed(Channel channel) {\n      if (channel.getChannelName().contains(\"-default\")) {\n        failures.add(DomainValidationMessages.cannotExposeDefaultChannelIstio());\n      }\n    }```\n\nShould we check fo others like *-snmp, *-iiop *-ldap", "author": "jshum2479", "createdAt": "2020-06-15T17:55:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MzU5OA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxMDE1Mw==", "url": "https://github.com/oracle/weblogic-kubernetes-operator/pull/1689#discussion_r440410153", "bodyText": "fixed", "author": "jshum2479", "createdAt": "2020-06-15T19:52:43Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0MzU5OA=="}], "type": "inlineReview", "revised_code": {"commit": "f35d9c7a03ded5e6bbfaa23a6c7772707d2eafb1", "chunk": "diff --git a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Domain.java b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Domain.java\nindex 87a1b62984..0abf3cc398 100644\n--- a/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Domain.java\n+++ b/operator/src/main/java/oracle/kubernetes/weblogic/domain/model/Domain.java\n\n@@ -704,13 +700,18 @@ public class Domain {\n \n     private void verifyIstioExposingDefaultChannel() {\n       if (spec.isIstioEnabled()) {\n-        spec.getAdminServer().getAdminService().getChannels().forEach(this::checkForDefaultNameExposed);\n+        Optional.ofNullable(spec.getAdminServer())\n+            .map(a -> a.getAdminService())\n+            .map(service -> service.getChannels())\n+            .ifPresent(cs -> cs.stream()\n+                              .forEach(this::checkForDefaultNameExposed));\n       }\n     }\n \n     private void checkForDefaultNameExposed(Channel channel) {\n-      if (channel.getChannelName().contains(\"-default\")) {\n-        failures.add(DomainValidationMessages.cannotExposeDefaultChannelIstio());\n+      if (\"default\".equals(channel.getChannelName()) || \"default-admin\".equals(channel.getChannelName())\n+            || \"default-secure\".equals(channel.getChannelName())) {\n+        failures.add(DomainValidationMessages.cannotExposeDefaultChannelIstio(channel.getChannelName()));\n       }\n     }\n \n"}}, {"oid": "b13d4990c84ff5f73544a654d1dd89784a9bdeaf", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b13d4990c84ff5f73544a654d1dd89784a9bdeaf", "message": "PR responses", "committedDate": "2020-06-15T19:22:12Z", "type": "commit"}, {"oid": "b4475a0a8a0cb80e83a0991c0e50f54787f126c4", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/b4475a0a8a0cb80e83a0991c0e50f54787f126c4", "message": "Correct error message text", "committedDate": "2020-06-15T19:29:35Z", "type": "commit"}, {"oid": "385b8384694f21ad1f4f6b6d8b7337b1d3df3193", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/385b8384694f21ad1f4f6b6d8b7337b1d3df3193", "message": "update error message for domain validation", "committedDate": "2020-06-15T19:49:48Z", "type": "commit"}, {"oid": "8078cd6045f0166920e668fec91c2106c3ea8edb", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/8078cd6045f0166920e668fec91c2106c3ea8edb", "message": "remove Experimental from the domain crd.", "committedDate": "2020-06-15T20:54:32Z", "type": "commit"}, {"oid": "5884aa5561bda911d7c6c561091305bd73aa793b", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/5884aa5561bda911d7c6c561091305bd73aa793b", "message": "remove experimental phrase in comment", "committedDate": "2020-06-15T20:57:06Z", "type": "commit"}, {"oid": "068a6c1f777b6ac46c4d8064c4fdb70d99ceef06", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/068a6c1f777b6ac46c4d8064c4fdb70d99ceef06", "message": "update doc", "committedDate": "2020-06-15T21:59:52Z", "type": "commit"}, {"oid": "12ecbb04b5f562f1242b34da536bcb30a9795966", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/12ecbb04b5f562f1242b34da536bcb30a9795966", "message": "Change weight of experimental index and istio md doc", "committedDate": "2020-06-15T22:02:26Z", "type": "commit"}, {"oid": "84b86e8cfe6a6e7f46b8b5f7afcb600fbbbd56c6", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/84b86e8cfe6a6e7f46b8b5f7afcb600fbbbd56c6", "message": "Fixed NPE", "committedDate": "2020-06-16T02:20:50Z", "type": "commit"}, {"oid": "f15a63ce06423bf652bdffe7a2b628068db63a0f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f15a63ce06423bf652bdffe7a2b628068db63a0f", "message": "refactor code", "committedDate": "2020-06-16T02:47:39Z", "type": "commit"}, {"oid": "f55c5e6c6b925dc691363fcbf2f79e92199d370f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/f55c5e6c6b925dc691363fcbf2f79e92199d370f", "message": "doc update", "committedDate": "2020-06-16T13:28:38Z", "type": "commit"}, {"oid": "dc76508312058680eb63d189d204d89627053d8f", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dc76508312058680eb63d189d204d89627053d8f", "message": "restore readinessPort removed by accident", "committedDate": "2020-06-16T15:32:37Z", "type": "commit"}, {"oid": "57535d698e33b3fb7160089f181196a03d1b2b81", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/57535d698e33b3fb7160089f181196a03d1b2b81", "message": "add istio options lines in template", "committedDate": "2020-06-16T15:51:55Z", "type": "commit"}, {"oid": "dee26299663fcbd0cf03ee8a3f75f81ddadd340c", "url": "https://github.com/oracle/weblogic-kubernetes-operator/commit/dee26299663fcbd0cf03ee8a3f75f81ddadd340c", "message": "correct sample script because naming convention changed", "committedDate": "2020-06-16T16:14:55Z", "type": "commit"}]}