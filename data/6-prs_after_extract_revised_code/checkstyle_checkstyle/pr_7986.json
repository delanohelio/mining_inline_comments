{"pr_number": 7986, "pr_title": "Issue #7981: Resolve Pitest Issues - DetectorOptions", "pr_createdAt": "2020-03-29T09:33:46Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/7986", "timeline": [{"oid": "9d18ed844e322329b62d873a1e532b1f8321588f", "url": "https://github.com/checkstyle/checkstyle/commit/9d18ed844e322329b62d873a1e532b1f8321588f", "message": "Issue #7981: Resolve Pitest Issues - DetectorOptions", "committedDate": "2020-03-29T09:43:29Z", "type": "forcePushed"}, {"oid": "2eb4aeb3112050bc62b8a3d9727980875aceb42c", "url": "https://github.com/checkstyle/checkstyle/commit/2eb4aeb3112050bc62b8a3d9727980875aceb42c", "message": "Issue #7981: Resolve Pitest Issues - DetectorOptions", "committedDate": "2020-03-29T09:50:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyMDE1MA==", "url": "https://github.com/checkstyle/checkstyle/pull/7986#discussion_r399820150", "bodyText": "as for me, it looks better in a way like\npattern = Optional.ofNullable(format).map(this::createPattern).orElse(null)", "author": "strkkk", "createdAt": "2020-03-29T16:23:14Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/regexp/DetectorOptions.java", "diffHunk": "@@ -228,9 +220,23 @@ public Builder suppressor(MatchSuppressor val) {\n         public DetectorOptions build() {\n             message = Optional.ofNullable(message).orElse(\"\");\n             suppressor = Optional.ofNullable(suppressor).orElse(NeverSuppress.INSTANCE);\n+            computePattern();", "originalCommit": "2eb4aeb3112050bc62b8a3d9727980875aceb42c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyMDY3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7986#discussion_r399820679", "bodyText": "Much better indeed. I'm refactoring right now. Thanks.", "author": "wilcoln", "createdAt": "2020-03-29T16:27:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyMDE1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyODE4OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/7986#discussion_r399828189", "bodyText": "@strkkk , I had never used Optional class before, so I went to checkout it's api a little bit.\nSeems like an elegant way to avoid null pointer exceptions. Thanks for making me discover this feature. I'm definitely using it from now on :)", "author": "wilcoln", "createdAt": "2020-03-29T17:30:39Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyMDE1MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyOTM5NA==", "url": "https://github.com/checkstyle/checkstyle/pull/7986#discussion_r399829394", "bodyText": "pitest report has been updated, still good.", "author": "wilcoln", "createdAt": "2020-03-29T17:40:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTgyMDE1MA=="}], "type": "inlineReview", "revised_code": {"commit": "7838673dcb16680fb26977e6a1d46c47472f2c8d", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/checks/regexp/DetectorOptions.java b/src/main/java/com/puppycrawl/tools/checkstyle/checks/regexp/DetectorOptions.java\nindex 31df7e32d..1165dfabf 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/checks/regexp/DetectorOptions.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/checks/regexp/DetectorOptions.java\n\n@@ -220,21 +220,21 @@ public final class DetectorOptions {\n         public DetectorOptions build() {\n             message = Optional.ofNullable(message).orElse(\"\");\n             suppressor = Optional.ofNullable(suppressor).orElse(NeverSuppress.INSTANCE);\n-            computePattern();\n+            pattern = Optional.ofNullable(format).map(this::createPattern).orElse(null);\n             return DetectorOptions.this;\n         }\n \n         /**\n-         * Compute the value of pattern member.\n+         * Creates pattern to use by DetectorOptions instance.\n+         * @param formatValue the format to use.\n+         * @return Pattern object.\n          */\n-        private void computePattern() {\n-            if (format != null) {\n-                int options = compileFlags;\n-                if (ignoreCase) {\n-                    options |= Pattern.CASE_INSENSITIVE;\n-                }\n-                pattern = Pattern.compile(format, options);\n+        private Pattern createPattern(String formatValue) {\n+            int options = compileFlags;\n+            if (ignoreCase) {\n+                options |= Pattern.CASE_INSENSITIVE;\n             }\n+            return Pattern.compile(formatValue, options);\n         }\n \n     }\n"}}, {"oid": "7838673dcb16680fb26977e6a1d46c47472f2c8d", "url": "https://github.com/checkstyle/checkstyle/commit/7838673dcb16680fb26977e6a1d46c47472f2c8d", "message": "Issue #7981: Resolve Pitest Issues - DetectorOptions", "committedDate": "2020-03-29T17:30:23Z", "type": "commit"}, {"oid": "7838673dcb16680fb26977e6a1d46c47472f2c8d", "url": "https://github.com/checkstyle/checkstyle/commit/7838673dcb16680fb26977e6a1d46c47472f2c8d", "message": "Issue #7981: Resolve Pitest Issues - DetectorOptions", "committedDate": "2020-03-29T17:30:23Z", "type": "forcePushed"}]}