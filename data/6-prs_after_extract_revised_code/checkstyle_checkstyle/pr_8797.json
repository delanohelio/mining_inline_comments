{"pr_number": 8797, "pr_title": "Pull #8797: bump Saxon-HE from 9.9.1-7 to 10.2", "pr_createdAt": "2020-09-06T14:32:03Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8797", "timeline": [{"oid": "e1abfac2f0dd624c89dd745ddd7d832a213a679a", "url": "https://github.com/checkstyle/checkstyle/commit/e1abfac2f0dd624c89dd745ddd7d832a213a679a", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-06T18:47:40Z", "type": "forcePushed"}, {"oid": "f49a16188d1e139306c6199819f185fc51432b8d", "url": "https://github.com/checkstyle/checkstyle/commit/f49a16188d1e139306c6199819f185fc51432b8d", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-06T21:08:49Z", "type": "forcePushed"}, {"oid": "165777fe915e6c3804d6121e8ff9d47ce49a6ad5", "url": "https://github.com/checkstyle/checkstyle/commit/165777fe915e6c3804d6121e8ff9d47ce49a6ad5", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-06T21:32:17Z", "type": "forcePushed"}, {"oid": "fe9bc4591cc87e558dd9ab0f9c89ed8955c1d885", "url": "https://github.com/checkstyle/checkstyle/commit/fe9bc4591cc87e558dd9ab0f9c89ed8955c1d885", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.2", "committedDate": "2020-09-06T22:13:25Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgwNjk3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r485806979", "bodyText": "This looks confusing. This method should return a closed iterator?\nI understand that this is done to suppress the warning about unclosed resources and that the method EmptyIterator::close() actually does nothing.\nThe violation itself is inappropriate here. If a method returns a closable resource, the resource shouldn't be closed.\nThis approach may cause problems in the future. Some check might once break the build with a \" Hey! You are touching a closed resource!\"\nWhat if we just suppress this warning as here?", "author": "pbludov", "createdAt": "2020-09-09T17:50:58Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -230,7 +230,9 @@ public AxisIterator iterateAxis(byte axisNumber) {\n                     }\n                 }\n                 else {\n-                    result = EmptyIterator.OfNodes.THE_INSTANCE;\n+                    try (AxisIterator iterator = EmptyIterator.ofNodes()) {\n+                        result = iterator;", "originalCommit": "fe9bc4591cc87e558dd9ab0f9c89ed8955c1d885", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg5OTI1Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r485899252", "bodyText": "good point, thanks\nrewrote all try-with-resources statements, please check", "author": "timurt", "createdAt": "2020-09-09T20:21:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTgwNjk3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "7c61db14541bbf9f4b99afbdf3be9a77ad00dce7", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\nindex d471fd70e..375e33cb6 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n\n@@ -204,65 +204,44 @@ public class ElementNode extends AbstractNode {\n      * @return {@code AxisIterator} object\n      */\n     @Override\n+    @SuppressWarnings(\"resource\")\n     public AxisIterator iterateAxis(int axisNumber) {\n         final AxisIterator result;\n         switch (axisNumber) {\n             case AxisInfo.ANCESTOR:\n-                try (AxisIterator iterator = new Navigator.AncestorEnumeration(this, false)) {\n-                    result = iterator;\n-                }\n+                result = new Navigator.AncestorEnumeration(this, false);\n                 break;\n             case AxisInfo.ANCESTOR_OR_SELF:\n-                try (AxisIterator iterator = new Navigator.AncestorEnumeration(this, true)) {\n-                    result = iterator;\n-                }\n+                result = new Navigator.AncestorEnumeration(this, true);\n                 break;\n             case AxisInfo.ATTRIBUTE:\n-                try (AxisIterator iterator = SingleNodeIterator.makeIterator(attributeNode)) {\n-                    result = iterator;\n-                }\n+                result = SingleNodeIterator.makeIterator(attributeNode);\n                 break;\n             case AxisInfo.CHILD:\n                 if (hasChildNodes()) {\n-                    try (AxisIterator iterator = new ArrayIterator.OfNodes(\n-                            getChildren().toArray(EMPTY_ABSTRACT_NODE_ARRAY))) {\n-                        result = iterator;\n-                    }\n+                    result = new ArrayIterator.OfNodes(\n+                            getChildren().toArray(EMPTY_ABSTRACT_NODE_ARRAY));\n                 }\n                 else {\n-                    try (AxisIterator iterator = EmptyIterator.ofNodes()) {\n-                        result = iterator;\n-                    }\n+                    result = EmptyIterator.ofNodes();\n                 }\n                 break;\n             case AxisInfo.DESCENDANT:\n                 if (hasChildNodes()) {\n-                    try (AxisIterator iterator =\n-                                 new Navigator.DescendantEnumeration(this, false, true)) {\n-                        result = iterator;\n-                    }\n+                    result = new Navigator.DescendantEnumeration(this, false, true);\n                 }\n                 else {\n-                    try (AxisIterator iterator = EmptyIterator.ofNodes()) {\n-                        result = iterator;\n-                    }\n+                    result = EmptyIterator.ofNodes();\n                 }\n                 break;\n             case AxisInfo.DESCENDANT_OR_SELF:\n-                try (AxisIterator iterator =\n-                             new Navigator.DescendantEnumeration(this, true, true)) {\n-                    result = iterator;\n-                }\n+                result = new Navigator.DescendantEnumeration(this, true, true);\n                 break;\n             case AxisInfo.PARENT:\n-                try (AxisIterator iterator = SingleNodeIterator.makeIterator(parent)) {\n-                    result = iterator;\n-                }\n+                result = SingleNodeIterator.makeIterator(parent);\n                 break;\n             case AxisInfo.SELF:\n-                try (AxisIterator iterator = SingleNodeIterator.makeIterator(this)) {\n-                    result = iterator;\n-                }\n+                result = SingleNodeIterator.makeIterator(this);\n                 break;\n             case AxisInfo.FOLLOWING_SIBLING:\n                 result = getFollowingSiblingsIterator();\n"}}, {"oid": "7c61db14541bbf9f4b99afbdf3be9a77ad00dce7", "url": "https://github.com/checkstyle/checkstyle/commit/7c61db14541bbf9f4b99afbdf3be9a77ad00dce7", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-09T20:18:53Z", "type": "forcePushed"}, {"oid": "1f785d3476e396875cd3c7f95259f31a8154f2bd", "url": "https://github.com/checkstyle/checkstyle/commit/1f785d3476e396875cd3c7f95259f31a8154f2bd", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-10T05:40:48Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMzNTM5Mg==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r486335392", "bodyText": "Please explain reason of suppression in javadoc", "author": "romani", "createdAt": "2020-09-10T13:27:57Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/RootNode.java", "diffHunk": "@@ -143,9 +143,11 @@ public NodeInfo getRoot() {\n      *\n      * @param axisNumber element from {@code AxisInfo}\n      * @return {@code AxisIterator} object\n+     * @noinspection resource, IOResourceOpenedButNotSafelyClosed", "originalCommit": "1f785d3476e396875cd3c7f95259f31a8154f2bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQwNTEzMA==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487405130", "bodyText": "@timurt there is a bug in the eclipse compiler related to this issue:\nhttps://bugs.eclipse.org/bugs/show_bug.cgi?id=383965\nPlease note this in the method Javadoc.", "author": "pbludov", "createdAt": "2020-09-12T12:32:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMzNTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1MzA0Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487553046", "bodyText": "@romani done", "author": "timurt", "createdAt": "2020-09-13T17:05:27Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMzNTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1MzExNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487553116", "bodyText": "@pbludov do I really need to specify this bug in javadoc, isn't it CI/CD problem?", "author": "timurt", "createdAt": "2020-09-13T17:06:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMzNTM5Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzY3MjYzNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487672634", "bodyText": "My point is that there is no need for suppression. But due to bugs, some ci tools reports a violation here. One day these bugs will be fixed and the suppression will become redundant. So I suggested mentioning the bug here.", "author": "pbludov", "createdAt": "2020-09-14T06:14:13Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjMzNTM5Mg=="}], "type": "inlineReview", "revised_code": {"commit": "7073f991c08acf598f6651fdd927ef91f6187e8e", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/RootNode.java b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/RootNode.java\nindex 34e17c1b3..c88c31653 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/RootNode.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/RootNode.java\n\n@@ -141,6 +141,10 @@ public class RootNode extends AbstractNode {\n      * Determines axis iteration algorithm. Throws {@code UnsupportedOperationException} in case,\n      * when there is no axis iterator for given axisNumber.\n      *\n+     * Suppresses resource, IOResourceOpenedButNotSafelyClosed: {@link AxisIterator} implements\n+     * {@link java.io.Closeable} interface, but none of the subclasses of the {@link AxisIterator}\n+     * class has non-empty {@code close()} method.\n+     *\n      * @param axisNumber element from {@code AxisInfo}\n      * @return {@code AxisIterator} object\n      * @noinspection resource, IOResourceOpenedButNotSafelyClosed\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQwNTE4Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487405183", "bodyText": "same here please", "author": "pbludov", "createdAt": "2020-09-12T12:32:50Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -330,7 +310,9 @@ public DetailAST getUnderlyingNode() {\n     private AxisIterator getPrecedingSiblingsIterator() {\n         final AxisIterator result;\n         if (indexAmongSiblings == 0) {\n-            result = EmptyIterator.OfNodes.THE_INSTANCE;\n+            try (AxisIterator iterator = EmptyIterator.ofNodes()) {", "originalCommit": "1f785d3476e396875cd3c7f95259f31a8154f2bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1MzEzMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487553131", "bodyText": "done", "author": "timurt", "createdAt": "2020-09-13T17:06:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQwNTE4Mw=="}], "type": "inlineReview", "revised_code": {"commit": "7073f991c08acf598f6651fdd927ef91f6187e8e", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\nindex d9f78182d..047a81583 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n\n@@ -310,15 +313,11 @@ public class ElementNode extends AbstractNode {\n     private AxisIterator getPrecedingSiblingsIterator() {\n         final AxisIterator result;\n         if (indexAmongSiblings == 0) {\n-            try (AxisIterator iterator = EmptyIterator.ofNodes()) {\n-                result = iterator;\n-            }\n+            result = EmptyIterator.ofNodes();\n         }\n         else {\n-            try (AxisIterator iterator = new ArrayIterator.OfNodes(\n-                    getPrecedingSiblings().toArray(EMPTY_ABSTRACT_NODE_ARRAY))) {\n-                result = iterator;\n-            }\n+            result = new ArrayIterator.OfNodes(\n+                    getPrecedingSiblings().toArray(EMPTY_ABSTRACT_NODE_ARRAY));\n         }\n         return result;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQwNTE5NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487405195", "bodyText": "and here too", "author": "pbludov", "createdAt": "2020-09-12T12:33:07Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -349,7 +331,9 @@ private AxisIterator getPrecedingSiblingsIterator() {\n     private AxisIterator getFollowingSiblingsIterator() {\n         final AxisIterator result;\n         if (indexAmongSiblings == parent.getChildren().size() - 1) {\n-            result = EmptyIterator.OfNodes.THE_INSTANCE;\n+            try (AxisIterator iterator = EmptyIterator.ofNodes()) {\n+                result = iterator;", "originalCommit": "1f785d3476e396875cd3c7f95259f31a8154f2bd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzU1MzEzNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487553136", "bodyText": "done", "author": "timurt", "createdAt": "2020-09-13T17:06:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQwNTE5NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7073f991c08acf598f6651fdd927ef91f6187e8e", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\nindex d9f78182d..047a81583 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n\n@@ -331,15 +330,11 @@ public class ElementNode extends AbstractNode {\n     private AxisIterator getFollowingSiblingsIterator() {\n         final AxisIterator result;\n         if (indexAmongSiblings == parent.getChildren().size() - 1) {\n-            try (AxisIterator iterator = EmptyIterator.ofNodes()) {\n-                result = iterator;\n-            }\n+            result = EmptyIterator.ofNodes();\n         }\n         else {\n-            try (AxisIterator iterator = new ArrayIterator.OfNodes(\n-                    getFollowingSiblings().toArray(EMPTY_ABSTRACT_NODE_ARRAY))) {\n-                result = iterator;\n-            }\n+            result = new ArrayIterator.OfNodes(\n+                    getFollowingSiblings().toArray(EMPTY_ABSTRACT_NODE_ARRAY));\n         }\n         return result;\n     }\n"}}, {"oid": "7073f991c08acf598f6651fdd927ef91f6187e8e", "url": "https://github.com/checkstyle/checkstyle/commit/7073f991c08acf598f6651fdd927ef91f6187e8e", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-13T17:04:47Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk2MzI5Ng==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r487963296", "bodyText": "on this method we do not suppress anything, please remove this comment.", "author": "romani", "createdAt": "2020-09-14T14:15:24Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java", "diffHunk": "@@ -200,65 +200,51 @@ public NodeInfo getRoot() {\n      * Determines axis iteration algorithm. Throws {@code UnsupportedOperationException} in case,\n      * when there is no axis iterator for given axisNumber.\n      *\n+     * Suppresses resource, IOResourceOpenedButNotSafelyClosed: {@link AxisIterator} implements\n+     * {@link java.io.Closeable} interface, but none of the subclasses of the {@link AxisIterator}\n+     * class has non-empty {@code close()} method.", "originalCommit": "7073f991c08acf598f6651fdd927ef91f6187e8e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTA3NzUyNA==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r491077524", "bodyText": "done,\nI was referring to your previous comment \"Please explain reason of suppression in javadoc\", how should I explain this IDEA suppressions?", "author": "timurt", "createdAt": "2020-09-18T16:59:17Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk2MzI5Ng=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5MTQ2ODQxNg==", "url": "https://github.com/checkstyle/checkstyle/pull/8797#discussion_r491468416", "bodyText": "I pushed a change", "author": "romani", "createdAt": "2020-09-19T16:00:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4Nzk2MzI5Ng=="}], "type": "inlineReview", "revised_code": {"commit": "881d169692b7ac193505b1bac88d8d215e5f04de", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\nindex 047a81583..57509ee59 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/xpath/ElementNode.java\n\n@@ -200,10 +200,6 @@ public class ElementNode extends AbstractNode {\n      * Determines axis iteration algorithm. Throws {@code UnsupportedOperationException} in case,\n      * when there is no axis iterator for given axisNumber.\n      *\n-     * Suppresses resource, IOResourceOpenedButNotSafelyClosed: {@link AxisIterator} implements\n-     * {@link java.io.Closeable} interface, but none of the subclasses of the {@link AxisIterator}\n-     * class has non-empty {@code close()} method.\n-     *\n      * @param axisNumber element from {@code AxisInfo}\n      * @return {@code AxisIterator} object\n      */\n"}}, {"oid": "881d169692b7ac193505b1bac88d8d215e5f04de", "url": "https://github.com/checkstyle/checkstyle/commit/881d169692b7ac193505b1bac88d8d215e5f04de", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-18T16:57:58Z", "type": "forcePushed"}, {"oid": "1f9ce64b4dbbd5a96786d31c7979cd079f97287d", "url": "https://github.com/checkstyle/checkstyle/commit/1f9ce64b4dbbd5a96786d31c7979cd079f97287d", "message": "dependency: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-18T17:16:30Z", "type": "forcePushed"}, {"oid": "8889e8e05646f9b92dc01d4ed0e1fdb1fd108d93", "url": "https://github.com/checkstyle/checkstyle/commit/8889e8e05646f9b92dc01d4ed0e1fdb1fd108d93", "message": "Pull #8797: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-19T15:55:25Z", "type": "forcePushed"}, {"oid": "f7cad1db2269d4b7ba31195ba09cc04cf4758aec", "url": "https://github.com/checkstyle/checkstyle/commit/f7cad1db2269d4b7ba31195ba09cc04cf4758aec", "message": "Pull #8797: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-19T16:00:24Z", "type": "forcePushed"}, {"oid": "956a7fbed44e7cfc9c01b727a7fd66584de87296", "url": "https://github.com/checkstyle/checkstyle/commit/956a7fbed44e7cfc9c01b727a7fd66584de87296", "message": "Pull #8797: bump Saxon-HE from 9.9.1-7 to 10.2", "committedDate": "2020-09-19T17:04:35Z", "type": "forcePushed"}, {"oid": "f662515a904abfd940aed30f1db4c69aa3767dd6", "url": "https://github.com/checkstyle/checkstyle/commit/f662515a904abfd940aed30f1db4c69aa3767dd6", "message": "Pull #8797: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-19T19:34:56Z", "type": "commit"}, {"oid": "f662515a904abfd940aed30f1db4c69aa3767dd6", "url": "https://github.com/checkstyle/checkstyle/commit/f662515a904abfd940aed30f1db4c69aa3767dd6", "message": "Pull #8797: bump Saxon-HE from 9.9.1-7 to 10.0", "committedDate": "2020-09-19T19:34:56Z", "type": "forcePushed"}]}