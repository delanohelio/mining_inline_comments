{"pr_number": 8317, "pr_title": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath - Generate Xpath Query", "pr_createdAt": "2020-06-15T11:40:55Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8317", "timeline": [{"oid": "9d6a223832c3ec22b0dcaeeb29e5b508930a5ac6", "url": "https://github.com/checkstyle/checkstyle/commit/9d6a223832c3ec22b0dcaeeb29e5b508930a5ac6", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-06-16T05:13:20Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDU5Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r443154593", "bodyText": "fix typo, Travis complain about this.", "author": "romani", "createdAt": "2020-06-20T19:35:26Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -143,6 +155,32 @@ private void makeCodeSelection() {\n         new CodeSelector(tree.getLastSelectedPathComponent(), editor, linePositionMap).select();\n     }\n \n+    /**\n+     * Generate Xpath.\n+     */\n+    private void generateXpath() {\n+        if (tree.getLastSelectedPathComponent() instanceof DetailAST) {\n+            try {\n+                final FileText fileText = new FileText(file, StandardCharsets.UTF_8.name());\n+                final DetailAST rootAST = (DetailAST) tree.getModel().getRoot();\n+                final DetailAST ast = (DetailAST) tree.getLastSelectedPathComponent();\n+                final int defaultTabWidth = 4;\n+\n+                final XpathQueryGenerator queryGenerator = new XpathQueryGenerator(rootAST,\n+                    ast.getLineNo(), ast.getColumnNo(),\n+                    fileText, defaultTabWidth);\n+\n+                xpathEditor.setText(queryGenerator.generateXpathQuery(ast));\n+            }\n+            catch (IOException ex) {\n+                xpathEditor.setText(ex.getMessage());\n+            }\n+        }\n+        else {\n+            xpathEditor.setText(\"Xpath is not supported yet forr javadoc nodes\");", "originalCommit": "9d6a223832c3ec22b0dcaeeb29e5b508930a5ac6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE4NTYxNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r443185617", "bodyText": "Done", "author": "developerhb", "createdAt": "2020-06-21T06:09:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDU5Mw=="}], "type": "inlineReview", "revised_code": {"commit": "f45aee7c172361e97426acf52fe86221d2e4e1db", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java b/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\nindex 783dea31e..ab64f82fb 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\n\n@@ -172,12 +171,12 @@ public final class TreeTable extends JTable {\n \n                 xpathEditor.setText(queryGenerator.generateXpathQuery(ast));\n             }\n-            catch (IOException ex) {\n+            catch (Exception ex) {\n                 xpathEditor.setText(ex.getMessage());\n             }\n         }\n         else {\n-            xpathEditor.setText(\"Xpath is not supported yet forr javadoc nodes\");\n+            xpathEditor.setText(\"Xpath is not supported yet for javadoc nodes\");\n         }\n     }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDY0OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r443154649", "bodyText": "please catch all exceptions here, we should print problem if any exception happen.", "author": "romani", "createdAt": "2020-06-20T19:36:18Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -143,6 +155,32 @@ private void makeCodeSelection() {\n         new CodeSelector(tree.getLastSelectedPathComponent(), editor, linePositionMap).select();\n     }\n \n+    /**\n+     * Generate Xpath.\n+     */\n+    private void generateXpath() {\n+        if (tree.getLastSelectedPathComponent() instanceof DetailAST) {\n+            try {\n+                final FileText fileText = new FileText(file, StandardCharsets.UTF_8.name());\n+                final DetailAST rootAST = (DetailAST) tree.getModel().getRoot();\n+                final DetailAST ast = (DetailAST) tree.getLastSelectedPathComponent();\n+                final int defaultTabWidth = 4;\n+\n+                final XpathQueryGenerator queryGenerator = new XpathQueryGenerator(rootAST,\n+                    ast.getLineNo(), ast.getColumnNo(),\n+                    fileText, defaultTabWidth);\n+\n+                xpathEditor.setText(queryGenerator.generateXpathQuery(ast));\n+            }\n+            catch (IOException ex) {", "originalCommit": "9d6a223832c3ec22b0dcaeeb29e5b508930a5ac6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE4NTYxOQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r443185619", "bodyText": "Done", "author": "developerhb", "createdAt": "2020-06-21T06:09:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzE1NDY0OQ=="}], "type": "inlineReview", "revised_code": {"commit": "f45aee7c172361e97426acf52fe86221d2e4e1db", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java b/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\nindex 783dea31e..ab64f82fb 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\n\n@@ -172,12 +171,12 @@ public final class TreeTable extends JTable {\n \n                 xpathEditor.setText(queryGenerator.generateXpathQuery(ast));\n             }\n-            catch (IOException ex) {\n+            catch (Exception ex) {\n                 xpathEditor.setText(ex.getMessage());\n             }\n         }\n         else {\n-            xpathEditor.setText(\"Xpath is not supported yet forr javadoc nodes\");\n+            xpathEditor.setText(\"Xpath is not supported yet for javadoc nodes\");\n         }\n     }\n \n"}}, {"oid": "f45aee7c172361e97426acf52fe86221d2e4e1db", "url": "https://github.com/checkstyle/checkstyle/commit/f45aee7c172361e97426acf52fe86221d2e4e1db", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-06-20T23:08:14Z", "type": "forcePushed"}, {"oid": "1eae4e8780dde70305a1e71563074304e7f6ede6", "url": "https://github.com/checkstyle/checkstyle/commit/1eae4e8780dde70305a1e71563074304e7f6ede6", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-06-24T02:57:32Z", "type": "forcePushed"}, {"oid": "48a74f00806165f76b77b5ae5d72c7d78185785b", "url": "https://github.com/checkstyle/checkstyle/commit/48a74f00806165f76b77b5ae5d72c7d78185785b", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-06-26T13:03:24Z", "type": "forcePushed"}, {"oid": "62598e5ec362ec0a9b20d31a7e322c9fa277aa1b", "url": "https://github.com/checkstyle/checkstyle/commit/62598e5ec362ec0a9b20d31a7e322c9fa277aa1b", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-06-27T17:23:01Z", "type": "forcePushed"}, {"oid": "8a9463e63b3913621f5d89510eb00559387d3ee2", "url": "https://github.com/checkstyle/checkstyle/commit/8a9463e63b3913621f5d89510eb00559387d3ee2", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-06-28T14:22:43Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r446716245", "bodyText": "it is better to make new ctor\nfinal XpathQueryGenerator queryGenerator = new XpathQueryGenerator(rootAST);\nas we need only root AST to do queryGenerator.generateXpathQuery(ast)", "author": "romani", "createdAt": "2020-06-29T00:07:55Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java", "diffHunk": "@@ -143,6 +154,33 @@ private void makeCodeSelection() {\n         new CodeSelector(tree.getLastSelectedPathComponent(), editor, linePositionMap).select();\n     }\n \n+    /**\n+     * Generate Xpath.\n+     */\n+    private void generateXpath() {\n+        if (tree.getLastSelectedPathComponent() instanceof DetailAST) {\n+            try {\n+                final FileText fileText = new FileText(file, StandardCharsets.UTF_8.name());\n+                final DetailAST rootAST = (DetailAST) tree.getModel().getRoot();\n+                final DetailAST ast = (DetailAST) tree.getLastSelectedPathComponent();\n+                final int defaultTabWidth = 4;\n+\n+                final XpathQueryGenerator queryGenerator = new XpathQueryGenerator(rootAST,\n+                    ast.getLineNo(), ast.getColumnNo(),\n+                    fileText, defaultTabWidth);", "originalCommit": "8a9463e63b3913621f5d89510eb00559387d3ee2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Njc0Njc0MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r446746741", "bodyText": "I don't think it will work because, the function I have used is generateXpathQuery(ast). This function uses a number of other methods from the class XpathQueryGenerator. It might happen that those method use the other member variables from the existing constructor.", "author": "developerhb", "createdAt": "2020-06-29T03:00:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODM2OTU4MQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r448369581", "bodyText": "private static String generateXpathQuery(DetailAST ast) it is static, it means it does not use fields of class, please try.", "author": "romani", "createdAt": "2020-07-01T13:38:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc0NTUzNw==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r448745537", "bodyText": "@romani\nThank you for drawing my attention to this. We don't even need the rootAST, since the method is static. We just need the node of which we want to find the xpath.\nSo, we don't need new constructor.\nI have made the method generateXpathQuery static again.", "author": "developerhb", "createdAt": "2020-07-02T04:43:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODc2NjU4NQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r448766585", "bodyText": "@romani\nI would also like to ask that I introduced try catch block as I was using FileText class constructor which throws an IO exception. Now that it is removed I think I should also remove try catch block. Should I remove it?", "author": "developerhb", "createdAt": "2020-07-02T06:03:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTYwOTAyMQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r449609021", "bodyText": "yes, please remove non required code. The less code the better.", "author": "romani", "createdAt": "2020-07-03T14:24:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTk2MzE5OA==", "url": "https://github.com/checkstyle/checkstyle/pull/8317#discussion_r449963198", "bodyText": "Done", "author": "developerhb", "createdAt": "2020-07-06T03:10:16Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NjcxNjI0NQ=="}], "type": "inlineReview", "revised_code": {"commit": "abcf937751cb775f20c08b801977070e43126269", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java b/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\nindex 91bcbdcb5..87e9e7b1e 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/gui/TreeTable.java\n\n@@ -160,16 +155,8 @@ public final class TreeTable extends JTable {\n     private void generateXpath() {\n         if (tree.getLastSelectedPathComponent() instanceof DetailAST) {\n             try {\n-                final FileText fileText = new FileText(file, StandardCharsets.UTF_8.name());\n-                final DetailAST rootAST = (DetailAST) tree.getModel().getRoot();\n                 final DetailAST ast = (DetailAST) tree.getLastSelectedPathComponent();\n-                final int defaultTabWidth = 4;\n-\n-                final XpathQueryGenerator queryGenerator = new XpathQueryGenerator(rootAST,\n-                    ast.getLineNo(), ast.getColumnNo(),\n-                    fileText, defaultTabWidth);\n-\n-                xpathEditor.setText(queryGenerator.generateXpathQuery(ast));\n+                xpathEditor.setText(XpathQueryGenerator.generateXpathQuery(ast));\n             }\n             // -@cs[IllegalCatch] no proper logging ability so we print all to UI textarea\n             catch (Exception ex) {\n"}}, {"oid": "b6aacbf326bd738d808447f37744b588b1702d84", "url": "https://github.com/checkstyle/checkstyle/commit/b6aacbf326bd738d808447f37744b588b1702d84", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-01T03:06:47Z", "type": "forcePushed"}, {"oid": "28ebc6eaa035fe4fbbbe4c10526c5871b4de571f", "url": "https://github.com/checkstyle/checkstyle/commit/28ebc6eaa035fe4fbbbe4c10526c5871b4de571f", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-01T07:45:08Z", "type": "forcePushed"}, {"oid": "abcf937751cb775f20c08b801977070e43126269", "url": "https://github.com/checkstyle/checkstyle/commit/abcf937751cb775f20c08b801977070e43126269", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-02T04:37:18Z", "type": "forcePushed"}, {"oid": "94d49161e1820e828bc0ea8d7ff92dc0cba7f958", "url": "https://github.com/checkstyle/checkstyle/commit/94d49161e1820e828bc0ea8d7ff92dc0cba7f958", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-05T06:23:32Z", "type": "forcePushed"}, {"oid": "e321d3d867a258771413d7129bcabad712bf68e0", "url": "https://github.com/checkstyle/checkstyle/commit/e321d3d867a258771413d7129bcabad712bf68e0", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-07T03:04:50Z", "type": "forcePushed"}, {"oid": "98e2adb435b4c49cee89e3b2d7cc0da3204c2d83", "url": "https://github.com/checkstyle/checkstyle/commit/98e2adb435b4c49cee89e3b2d7cc0da3204c2d83", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-08T17:28:46Z", "type": "forcePushed"}, {"oid": "8a868b79d7cac5f900c3559dc549b52a82d50d66", "url": "https://github.com/checkstyle/checkstyle/commit/8a868b79d7cac5f900c3559dc549b52a82d50d66", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-08T18:06:17Z", "type": "commit"}, {"oid": "8a868b79d7cac5f900c3559dc549b52a82d50d66", "url": "https://github.com/checkstyle/checkstyle/commit/8a868b79d7cac5f900c3559dc549b52a82d50d66", "message": "Issue #4944: Extend Checkstyle GUI tool to work with Xpath", "committedDate": "2020-07-08T18:06:17Z", "type": "forcePushed"}]}