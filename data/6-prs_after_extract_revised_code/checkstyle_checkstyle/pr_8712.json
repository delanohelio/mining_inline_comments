{"pr_number": 8712, "pr_title": "Issue #8618: Text Blocks syntax check update for UnnecessaryParentheses", "pr_createdAt": "2020-08-18T19:29:10Z", "pr_url": "https://github.com/checkstyle/checkstyle/pull/8712", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQzMjM3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8712#discussion_r472432379", "bodyText": "@pbludov @esilkensen I'm not sure whether we want to use the new utility introduced at #8705 to modify the string here, but I would still need to replace the newline control characters with the text \"\\n\" to keep the error message to one line (like in our AST).  Let me know if we should do this or not, I can make the changes.", "author": "nmancus1", "createdAt": "2020-08-18T19:33:06Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java", "diffHunk": "@@ -332,6 +349,13 @@ else if (surrounded && isInTokenList(type, LITERALS)) {\n                     log(ast, MSG_STRING,\n                         chopString(ast.getText()));\n                 }\n+                else if (type == TokenTypes.TEXT_BLOCK_LITERAL_BEGIN) {\n+                    // Strip newline control characters to keep message as single line.\n+                    final String logString = NEWLINE.matcher(\n+                        ast.getFirstChild().getText()).replaceAll(\"\\\\\\\\n\");\n+                    // Add quotes so that log message is consistent with STRING_LITERAL\n+                    log(ast, MSG_STRING, QUOTE + logString + QUOTE);", "originalCommit": "eb9772b099c27b1912dd0b566900806eec9ca632", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3Mjc2OTA1NA==", "url": "https://github.com/checkstyle/checkstyle/pull/8712#discussion_r472769054", "bodyText": "In addition, the text should be truncated. Please note the chopString method in this check.", "author": "pbludov", "createdAt": "2020-08-19T06:45:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQzMjM3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "cbdc1e0204fc606074537c7fa6881c518ecffab9", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java b/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java\nindex cef1235e4..6dd10e27f 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java\n\n@@ -350,11 +350,13 @@ public class UnnecessaryParenthesesCheck extends AbstractCheck {\n                         chopString(ast.getText()));\n                 }\n                 else if (type == TokenTypes.TEXT_BLOCK_LITERAL_BEGIN) {\n-                    // Strip newline control characters to keep message as single line.\n-                    final String logString = NEWLINE.matcher(\n-                        ast.getFirstChild().getText()).replaceAll(\"\\\\\\\\n\");\n-                    // Add quotes so that log message is consistent with STRING_LITERAL\n-                    log(ast, MSG_STRING, QUOTE + logString + QUOTE);\n+                    // Strip newline control characters to keep message as single line, add\n+                    // quotes to make string consistent with STRING_LITERAL\n+                    final String logString = QUOTE\n+                        + NEWLINE.matcher(\n+                            ast.getFirstChild().getText()).replaceAll(\"\\\\\\\\n\")\n+                        + QUOTE;\n+                    log(ast, MSG_STRING, chopString(logString));\n                 }\n                 else {\n                     log(ast, MSG_LITERAL, ast.getText());\n"}}, {"oid": "cbdc1e0204fc606074537c7fa6881c518ecffab9", "url": "https://github.com/checkstyle/checkstyle/commit/cbdc1e0204fc606074537c7fa6881c518ecffab9", "message": "Issue #8618: Text Blocks syntax check update for UnnecessaryParentheses", "committedDate": "2020-08-19T13:30:16Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgxMzM3OQ==", "url": "https://github.com/checkstyle/checkstyle/pull/8712#discussion_r473813379", "bodyText": "Should this use \\R?", "author": "esilkensen", "createdAt": "2020-08-20T09:31:22Z", "path": "src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java", "diffHunk": "@@ -205,6 +209,16 @@\n      */\n     public static final String MSG_LAMBDA = \"unnecessary.paren.lambda\";\n \n+    /**\n+     * Compiled pattern used to match newline control characters, for replacement.\n+     */\n+    private static final Pattern NEWLINE = Pattern.compile(\"\\n\");", "originalCommit": "cbdc1e0204fc606074537c7fa6881c518ecffab9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzkxNjg2Mw==", "url": "https://github.com/checkstyle/checkstyle/pull/8712#discussion_r473916863", "bodyText": "Yes, that seems like it always a good idea. I will do this from now on.", "author": "nmancus1", "createdAt": "2020-08-20T12:01:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MzgxMzM3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "2bd0c56a4f4bef60d9cb8f3270e88f83ceca90e0", "chunk": "diff --git a/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java b/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java\nindex 6dd10e27f..cc779ed26 100644\n--- a/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java\n+++ b/src/main/java/com/puppycrawl/tools/checkstyle/checks/coding/UnnecessaryParenthesesCheck.java\n\n@@ -212,7 +212,7 @@ public class UnnecessaryParenthesesCheck extends AbstractCheck {\n     /**\n      * Compiled pattern used to match newline control characters, for replacement.\n      */\n-    private static final Pattern NEWLINE = Pattern.compile(\"\\n\");\n+    private static final Pattern NEWLINE = Pattern.compile(\"\\\\R\");\n \n     /**\n      * String used to amend TEXT_BLOCK_CONTENT so that it matches STRING_LITERAL.\n"}}, {"oid": "2bd0c56a4f4bef60d9cb8f3270e88f83ceca90e0", "url": "https://github.com/checkstyle/checkstyle/commit/2bd0c56a4f4bef60d9cb8f3270e88f83ceca90e0", "message": "Issue #8618: Text Blocks syntax check update for UnnecessaryParentheses", "committedDate": "2020-08-20T12:00:49Z", "type": "commit"}, {"oid": "2bd0c56a4f4bef60d9cb8f3270e88f83ceca90e0", "url": "https://github.com/checkstyle/checkstyle/commit/2bd0c56a4f4bef60d9cb8f3270e88f83ceca90e0", "message": "Issue #8618: Text Blocks syntax check update for UnnecessaryParentheses", "committedDate": "2020-08-20T12:00:49Z", "type": "forcePushed"}]}