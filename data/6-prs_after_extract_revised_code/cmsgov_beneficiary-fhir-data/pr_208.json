{"pr_number": 208, "pr_title": "BLUEBUTTON-1737 Throw ResourceNotFoundException (404) for ID multiple matches ", "pr_createdAt": "2020-01-29T17:10:35Z", "pr_url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/208", "timeline": [{"oid": "7c1f4972abe883ec4a8cdb0aa74ed84ee2cd1410", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/7c1f4972abe883ec4a8cdb0aa74ed84ee2cd1410", "message": "Change 500 exception to 404", "committedDate": "2020-01-29T17:03:43Z", "type": "commit"}, {"oid": "b5c1f6d522fd24e5bbfdbc4990b7fba03dc5375f", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/b5c1f6d522fd24e5bbfdbc4990b7fba03dc5375f", "message": "Refactor IT tests for new hash search behavior", "committedDate": "2020-01-29T17:05:07Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY0OTkzMw==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/208#discussion_r372649933", "bodyText": "Typo... BENI_ID", "author": "RickHawesUSDS", "createdAt": "2020-01-29T21:50:01Z", "path": "apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java", "diffHunk": "@@ -423,7 +423,9 @@ private Patient queryDatabaseByHash(\n     if (distinctBeneIds <= 0) {\n       throw new NoResultException();\n     } else if (distinctBeneIds > 1) {\n-      throw new NonUniqueResultException();\n+      MDC.put(\"database_query.by_hash.collision.distinct_bene_ids\", Long.toString(distinctBeneIds));\n+      throw new ResourceNotFoundException(\n+          \"By hash query found more than one distinct BENI_ID: \" + Long.toString(distinctBeneIds));", "originalCommit": "b5c1f6d522fd24e5bbfdbc4990b7fba03dc5375f", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY1MjkxOQ==", "url": "https://github.com/CMSgov/beneficiary-fhir-data/pull/208#discussion_r372652919", "bodyText": "Yikes :-)  Will update that.", "author": "dtisza1", "createdAt": "2020-01-29T21:56:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY0OTkzMw=="}], "type": "inlineReview", "revised_code": {"commit": "e551846fa3fd67907880e81da2f44347aa1379d4", "chunk": "diff --git a/apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java b/apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java\nindex b68da8286..69b02e77a 100644\n--- a/apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java\n+++ b/apps/bfd-server/bfd-server-war/src/main/java/gov/cms/bfd/server/war/stu3/providers/PatientResourceProvider.java\n\n@@ -425,7 +425,7 @@ public final class PatientResourceProvider implements IResourceProvider {\n     } else if (distinctBeneIds > 1) {\n       MDC.put(\"database_query.by_hash.collision.distinct_bene_ids\", Long.toString(distinctBeneIds));\n       throw new ResourceNotFoundException(\n-          \"By hash query found more than one distinct BENI_ID: \" + Long.toString(distinctBeneIds));\n+          \"By hash query found more than one distinct BENE_ID: \" + Long.toString(distinctBeneIds));\n     } else if (distinctBeneIds == 1) {\n       beneficiary = matchingBenes.get(0);\n     }\n"}}, {"oid": "e551846fa3fd67907880e81da2f44347aa1379d4", "url": "https://github.com/CMSgov/beneficiary-fhir-data/commit/e551846fa3fd67907880e81da2f44347aa1379d4", "message": "Fix typo", "committedDate": "2020-01-29T22:00:12Z", "type": "commit"}]}