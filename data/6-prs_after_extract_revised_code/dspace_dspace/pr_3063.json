{"pr_number": 3063, "pr_title": "Fix many warnings from errorprone", "pr_createdAt": "2020-11-25T14:33:35Z", "pr_url": "https://github.com/DSpace/DSpace/pull/3063", "timeline": [{"oid": "65f04fcec9390c6b4678039c63f535e0ed18e59d", "url": "https://github.com/DSpace/DSpace/commit/65f04fcec9390c6b4678039c63f535e0ed18e59d", "message": "First batch of errorprone fixes. #3061", "committedDate": "2020-11-24T15:55:08Z", "type": "commit"}, {"oid": "f6112babc3685a2eb84ee55e50215835e43c260d", "url": "https://github.com/DSpace/DSpace/commit/f6112babc3685a2eb84ee55e50215835e43c260d", "message": "More errorprone warnings.  #3061", "committedDate": "2020-11-25T01:22:06Z", "type": "commit"}, {"oid": "ce4ca33346d879f6e65424409eec7eed4435fdfe", "url": "https://github.com/DSpace/DSpace/commit/ce4ca33346d879f6e65424409eec7eed4435fdfe", "message": "Merge branch 'main' of github.com:mwoodiupui/DSpace into 3061", "committedDate": "2020-11-25T21:55:08Z", "type": "commit"}, {"oid": "a036b99f1c3483bc26d6c7660925f537d5f41f7e", "url": "https://github.com/DSpace/DSpace/commit/a036b99f1c3483bc26d6c7660925f537d5f41f7e", "message": "Catch correct error for replaced class, to fix test errors.  Satisfy checkstyle.  #3061", "committedDate": "2020-11-30T21:21:01Z", "type": "commit"}, {"oid": "ac29b3ec50a0314ea19b48ae8d658ebbe1c2e71f", "url": "https://github.com/DSpace/DSpace/commit/ac29b3ec50a0314ea19b48ae8d658ebbe1c2e71f", "message": "Merge branch 'main' into 3061", "committedDate": "2020-12-07T15:50:58Z", "type": "commit"}, {"oid": "c2c08b31094c9fdfc80a86c37eace5e782d4d48b", "url": "https://github.com/DSpace/DSpace/commit/c2c08b31094c9fdfc80a86c37eace5e782d4d48b", "message": "Restore thread-safety to see if it is needed.  #3061", "committedDate": "2020-12-08T13:07:54Z", "type": "commit"}, {"oid": "f3175d56d5c5be68f83761940b1e9392f95c9a22", "url": "https://github.com/DSpace/DSpace/commit/f3175d56d5c5be68f83761940b1e9392f95c9a22", "message": "Merge branch 'main' into 3061", "committedDate": "2021-09-07T18:30:20Z", "type": "commit"}, {"oid": "35e280019fbb91be697287d757b5b321d11f0485", "url": "https://github.com/DSpace/DSpace/commit/35e280019fbb91be697287d757b5b321d11f0485", "message": "Collections.EMPTY_LIST is immutable, possibly causing addBitstream to throw exception.", "committedDate": "2021-09-08T17:35:46Z", "type": "commit"}, {"oid": "20816f945e228a2f66c87a0dc90ef47afc5eaabd", "url": "https://github.com/DSpace/DSpace/commit/20816f945e228a2f66c87a0dc90ef47afc5eaabd", "message": "Log and continue instead of throwing exception when caller stack is empty.", "committedDate": "2021-09-08T17:40:53Z", "type": "commit"}, {"oid": "948014646af8716a8104b0e3960f65f183e52675", "url": "https://github.com/DSpace/DSpace/commit/948014646af8716a8104b0e3960f65f183e52675", "message": "Mention bitstream ID in exception for better debugging.  (3061)", "committedDate": "2021-09-08T19:40:44Z", "type": "commit"}, {"oid": "4b96106ea3103275a6c8aae05309deea410431ba", "url": "https://github.com/DSpace/DSpace/commit/4b96106ea3103275a6c8aae05309deea410431ba", "message": "Merge remote-tracking branch 'upstream/main' into 3061", "committedDate": "2021-09-08T19:52:33Z", "type": "commit"}, {"oid": "384d46348aec6c63ac3d4e141a8a91e6944d87e5", "url": "https://github.com/DSpace/DSpace/commit/384d46348aec6c63ac3d4e141a8a91e6944d87e5", "message": "Another batch of Error Prone fixes.  (#3061)", "committedDate": "2021-09-10T15:32:58Z", "type": "commit"}, {"oid": "edd310f536f676e9e239e6eac19285f19bcbb34f", "url": "https://github.com/DSpace/DSpace/commit/edd310f536f676e9e239e6eac19285f19bcbb34f", "message": "Address Error Prone complaints about tests.  (#3061)", "committedDate": "2021-09-10T16:51:24Z", "type": "commit"}, {"oid": "6013062a0836157f151e1b051eb0b12565ed372f", "url": "https://github.com/DSpace/DSpace/commit/6013062a0836157f151e1b051eb0b12565ed372f", "message": "Merge remote-tracking branch 'upstream/main' into 3061", "committedDate": "2021-09-15T20:18:18Z", "type": "commit"}, {"oid": "106d37404b3c5fa8278f864c95f550c79aed4710", "url": "https://github.com/DSpace/DSpace/commit/106d37404b3c5fa8278f864c95f550c79aed4710", "message": "Fix incorrect merge.  (#3061)", "committedDate": "2021-09-16T12:41:42Z", "type": "commit"}, {"oid": "9f463239d2eed66ad78d4ec5db31cb523332e989", "url": "https://github.com/DSpace/DSpace/commit/9f463239d2eed66ad78d4ec5db31cb523332e989", "message": "Address new LGTM alert for removed parameter. (#3061)", "committedDate": "2021-09-16T17:23:48Z", "type": "commit"}, {"id": "PRRC_kwDOADkekM4qZdkr", "url": "https://github.com/DSpace/DSpace/pull/3063#discussion_r711317803", "bodyText": "Should this be && !element.isEmpty() like other changes above in this same class?", "author": "tdonohue", "createdAt": "2021-09-17T19:59:13Z", "path": "dspace-api/src/main/java/org/dspace/app/bulkedit/DSpaceCSV.java", "diffHunk": "@@ -577,7 +577,7 @@ public final void addItem(String line) throws Exception {\n                 csvLine.add(headings.get(i - 1), null);\n                 String[] elements = part.split(escapedValueSeparator);\n                 for (String element : elements) {\n-                    if ((element != null) && (!\"\".equals(element))) {\n+                    if ((element != null) && !\"\".equals(element)) {", "originalCommit": "9f463239d2eed66ad78d4ec5db31cb523332e989", "replyToReviewId": null, "replies": [{"id": "PRRC_kwDOADkekM4qclGq", "url": "https://github.com/DSpace/DSpace/pull/3063#discussion_r712135082", "bodyText": "Yes, well caught.", "author": "mwoodiupui", "createdAt": "2021-09-20T12:50:12Z", "replyToReviewId": "PRRC_kwDOADkekM4qZdkr"}], "type": "inlineReview", "revised_code": {"commit": "1b366f8b7429947eecceb3b7daeec29f03605d64", "chunk": "diff --git a/dspace-api/src/main/java/org/dspace/app/bulkedit/DSpaceCSV.java b/dspace-api/src/main/java/org/dspace/app/bulkedit/DSpaceCSV.java\nindex 64be0196b..cbc052b55 100644\n--- a/dspace-api/src/main/java/org/dspace/app/bulkedit/DSpaceCSV.java\n+++ b/dspace-api/src/main/java/org/dspace/app/bulkedit/DSpaceCSV.java\n\n@@ -577,7 +577,7 @@ public class DSpaceCSV implements Serializable {\n                 csvLine.add(headings.get(i - 1), null);\n                 String[] elements = part.split(escapedValueSeparator);\n                 for (String element : elements) {\n-                    if ((element != null) && !\"\".equals(element)) {\n+                    if ((element != null) && !element.isEmpty()) {\n                         csvLine.add(headings.get(i - 1), element);\n                     }\n                 }\n"}}, {"id": "PRRC_kwDOADkekM4qZfVq", "url": "https://github.com/DSpace/DSpace/pull/3063#discussion_r711325034", "bodyText": "Again, this line and 4 lines above.  Should this both be turned into an ![variable].isEmpty()?", "author": "tdonohue", "createdAt": "2021-09-17T20:13:44Z", "path": "dspace-api/src/main/java/org/dspace/core/I18nUtil.java", "diffHunk": "@@ -316,18 +314,17 @@ private static String getFilename(Locale locale, String fileName, String fileTyp\n         // with Language, Country\n         String fileNameLC = null;\n         // with Language\n-        String fileNameL = null;\n-        fileNameL = fileName + \"_\" + locale.getLanguage();\n+        String fileNameL = fileName + \"_\" + locale.getLanguage();\n \n         if (fileType == null) {\n             fileType = \"\";\n         }\n \n-        if (!(\"\".equals(locale.getCountry()))) {\n+        if (!\"\".equals(locale.getCountry())) {\n             fileNameLC = fileName + \"_\" + locale.getLanguage() + \"_\"\n                 + locale.getCountry();\n \n-            if (!(\"\".equals(locale.getVariant()))) {\n+            if (!\"\".equals(locale.getVariant())) {", "originalCommit": "9f463239d2eed66ad78d4ec5db31cb523332e989", "replyToReviewId": null, "replies": [{"id": "PRRC_kwDOADkekM4qclH4", "url": "https://github.com/DSpace/DSpace/pull/3063#discussion_r712135160", "bodyText": "Yes.", "author": "mwoodiupui", "createdAt": "2021-09-20T12:50:19Z", "replyToReviewId": "PRRC_kwDOADkekM4qZfVq"}], "type": "inlineReview", "revised_code": {"commit": "1b366f8b7429947eecceb3b7daeec29f03605d64", "chunk": "diff --git a/dspace-api/src/main/java/org/dspace/core/I18nUtil.java b/dspace-api/src/main/java/org/dspace/core/I18nUtil.java\nindex 8c101a8f0..a853c3597 100644\n--- a/dspace-api/src/main/java/org/dspace/core/I18nUtil.java\n+++ b/dspace-api/src/main/java/org/dspace/core/I18nUtil.java\n\n@@ -320,11 +320,11 @@ public class I18nUtil {\n             fileType = \"\";\n         }\n \n-        if (!\"\".equals(locale.getCountry())) {\n+        if (!locale.getCountry().isEmpty()) {\n             fileNameLC = fileName + \"_\" + locale.getLanguage() + \"_\"\n                 + locale.getCountry();\n \n-            if (!\"\".equals(locale.getVariant())) {\n+            if (!locale.getVariant().isEmpty()) {\n                 fileNameLCV = fileName + \"_\" + locale.getLanguage() + \"_\"\n                     + locale.getCountry() + \"_\" + locale.getVariant();\n             }\n"}}, {"oid": "1b366f8b7429947eecceb3b7daeec29f03605d64", "url": "https://github.com/DSpace/DSpace/commit/1b366f8b7429947eecceb3b7daeec29f03605d64", "message": "Address review comments:  missed some isEmpty fixes.  [#3061]", "committedDate": "2021-09-20T12:55:11Z", "type": "commit"}]}