{"pr_number": 2925, "pr_title": "72450: AdministratorOfFeature: fixes", "pr_createdAt": "2020-08-10T15:39:12Z", "pr_url": "https://github.com/DSpace/DSpace/pull/2925", "timeline": [{"oid": "9fa1b78e2efc9847397bb64122d416fce8e279c7", "url": "https://github.com/DSpace/DSpace/commit/9fa1b78e2efc9847397bb64122d416fce8e279c7", "message": "72450: AdministratorOfFeature: fixes", "committedDate": "2020-08-10T13:51:04Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NTc1ODg3NQ==", "url": "https://github.com/DSpace/DSpace/pull/2925#discussion_r475758875", "bodyText": "As this is used heavily in ITs, I don't think we should have a log.info here.  I'd recommend we remove it, or change to a log.debug if you feel it's needed for debugging issues.", "author": "tdonohue", "createdAt": "2020-08-24T16:56:48Z", "path": "dspace-api/src/test/java/org/dspace/builder/AbstractDSpaceObjectBuilder.java", "diffHunk": "@@ -146,6 +146,33 @@ protected AbstractDSpaceObjectBuilder(Context context) {\n         }\n         return (B) this;\n     }\n+    /**\n+     * Support method to grant the {@link Constants#READ} permission over an object only to a specific group. Any other\n+     * READ permissions will be removed\n+     *\n+     * @param dso\n+     *            the DSpaceObject on which grant the permission\n+     * @param eperson\n+     *            the eperson that will be granted of the permission\n+     * @return the builder properly configured to build the object with the additional admin permission\n+     */\n+    protected <B extends AbstractDSpaceObjectBuilder<T>> B setAdminPermission(DSpaceObject dso, EPerson eperson,\n+                                                                                 Date startDate) {\n+        try {\n+\n+            ResourcePolicy rp = authorizeService.createOrModifyPolicy(null, context, null, null,\n+                                                                      eperson, startDate, Constants.ADMIN,\n+                                                                      \"Integration Test\", dso);\n+            if (rp != null) {\n+                log.info(\"Updating resource policy with REMOVE for eperson: \" + eperson.getEmail());", "originalCommit": "9fa1b78e2efc9847397bb64122d416fce8e279c7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "5718d78ab59b325778a3440cdc645d80c9424243", "chunk": "diff --git a/dspace-api/src/test/java/org/dspace/builder/AbstractDSpaceObjectBuilder.java b/dspace-api/src/test/java/org/dspace/builder/AbstractDSpaceObjectBuilder.java\nindex 075a53327..69cfd0e13 100644\n--- a/dspace-api/src/test/java/org/dspace/builder/AbstractDSpaceObjectBuilder.java\n+++ b/dspace-api/src/test/java/org/dspace/builder/AbstractDSpaceObjectBuilder.java\n\n@@ -164,7 +164,6 @@ public abstract class AbstractDSpaceObjectBuilder<T extends DSpaceObject>\n                                                                       eperson, startDate, Constants.ADMIN,\n                                                                       \"Integration Test\", dso);\n             if (rp != null) {\n-                log.info(\"Updating resource policy with REMOVE for eperson: \" + eperson.getEmail());\n                 resourcePolicyService.update(context, rp);\n             }\n         } catch (Exception e) {\n"}}, {"oid": "5718d78ab59b325778a3440cdc645d80c9424243", "url": "https://github.com/DSpace/DSpace/commit/5718d78ab59b325778a3440cdc645d80c9424243", "message": "72751: Remove log.info line from builder", "committedDate": "2020-08-27T13:09:44Z", "type": "commit"}]}