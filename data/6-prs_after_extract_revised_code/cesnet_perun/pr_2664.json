{"pr_number": 2664, "pr_title": "Use reactivation of member for group trigger", "pr_createdAt": "2020-04-09T05:57:04Z", "pr_url": "https://github.com/CESNET/perun/pull/2664", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk5ODY0OA==", "url": "https://github.com/CESNET/perun/pull/2664#discussion_r407998648", "bodyText": "Nit: missing space between \"if\" and \"(\"", "author": "balcirakpeter", "createdAt": "2020-04-14T09:33:22Z", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java", "diffHunk": "@@ -1084,9 +1084,13 @@ private void addMemberToGroupsFromTriggerAttribute(PerunSession sess, Group grou\n \t\tfor (String groupId : groupsForAddition) {\n \t\t\ttry {\n \t\t\t\tGroup groupForAddition = getGroupById(sess, Integer.parseInt(groupId));\n-\t\t\t\taddDirectMember(sess, groupForAddition, member);\n-\t\t\t} catch (InternalErrorException | WrongReferenceAttributeValueException | AlreadyMemberException | WrongAttributeValueException | GroupNotExistsException e) {\n-\t\t\t\tlog.error(\"Member could not be added to the group, Exception message: \" + e.toString());\n+\t\t\t\tif(isDirectGroupMember(sess, groupForAddition, member)) {", "originalCommit": "8f8d45ab807011a1821f422794f1ec227bb4de2e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODAyNTkxNg==", "url": "https://github.com/CESNET/perun/pull/2664#discussion_r408025916", "bodyText": "Fixed.", "author": "stavamichal", "createdAt": "2020-04-14T10:17:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNzk5ODY0OA=="}], "type": "inlineReview", "revised_code": {"commit": "7d1d332df62233e4108d7bd641f8ea45ded5e96a", "chunk": "diff --git a/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java b/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java\nindex 99bc9c0fc..640157ec0 100644\n--- a/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java\n+++ b/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java\n\n@@ -1084,7 +1084,7 @@ public class GroupsManagerBlImpl implements GroupsManagerBl {\n \t\tfor (String groupId : groupsForAddition) {\n \t\t\ttry {\n \t\t\t\tGroup groupForAddition = getGroupById(sess, Integer.parseInt(groupId));\n-\t\t\t\tif(isDirectGroupMember(sess, groupForAddition, member)) {\n+\t\t\t\tif (isDirectGroupMember(sess, groupForAddition, member)) {\n \t\t\t\t\treactivateMember(sess, member, groupForAddition);\n \t\t\t\t} else {\n \t\t\t\t\taddDirectMember(sess, groupForAddition, member);\n"}}, {"oid": "7d1d332df62233e4108d7bd641f8ea45ded5e96a", "url": "https://github.com/CESNET/perun/commit/7d1d332df62233e4108d7bd641f8ea45ded5e96a", "message": "Use reactivation of member for group trigger\n\n - if member is already direct member of any group in trigger, we need\n to reactivate him (set him valid, reset his expiration) to set his\n status as he was newly added to the group", "committedDate": "2020-04-14T10:17:02Z", "type": "commit"}, {"oid": "7d1d332df62233e4108d7bd641f8ea45ded5e96a", "url": "https://github.com/CESNET/perun/commit/7d1d332df62233e4108d7bd641f8ea45ded5e96a", "message": "Use reactivation of member for group trigger\n\n - if member is already direct member of any group in trigger, we need\n to reactivate him (set him valid, reset his expiration) to set his\n status as he was newly added to the group", "committedDate": "2020-04-14T10:17:02Z", "type": "forcePushed"}]}