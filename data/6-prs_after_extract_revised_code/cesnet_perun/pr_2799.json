{"pr_number": 2799, "pr_title": "Core - search users optimizations", "pr_createdAt": "2020-07-21T08:51:42Z", "pr_url": "https://github.com/CESNET/perun/pull/2799", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk1OTU1Nw==", "url": "https://github.com/CESNET/perun/pull/2799#discussion_r457959557", "bodyText": "Same optimization can be done for findRichUsersWithAttributesByExactMatch() below.\nAlso I wonder, if we can optimize implementation of convertRichUsersToRichUsersWithAttributes() itself, which retrieves user by id. We can easily pass RichUser instead of User into getAttributes() method, but I'm not sure that some code doesn't rely on the exact class to be used.", "author": "zlamalp", "createdAt": "2020-07-21T09:23:57Z", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/UsersManagerBlImpl.java", "diffHunk": "@@ -1729,7 +1729,7 @@ public RichUser convertUserToRichUserWithAttributesByNames(PerunSession sess, Us\n \tpublic List<RichUser> findRichUsersWithAttributes(PerunSession sess, String searchString, List<String> attrsName) throws UserNotExistsException {\n \n \t\tif(attrsName == null || attrsName.isEmpty()) {\n-\t\t\treturn convertRichUsersToRichUsersWithAttributes(sess, findRichUsers(sess, searchString));\n+\t\t\treturn findRichUsers(sess, searchString);", "originalCommit": "5f42d39f9d1584e2c70404d2f06549747fed2384", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1OTQ4MzQ0Mw==", "url": "https://github.com/CESNET/perun/pull/2799#discussion_r459483443", "bodyText": "Same optimization can be done for findRichUsersWithAttributesByExactMatch() below.\n\nDone.\n\nAlso I wonder, if we can optimize implementation of convertRichUsersToRichUsersWithAttributes() itself, which retrieves user by id. We can easily pass RichUser instead of User into getAttributes() method, but I'm not sure that some code doesn't rely on the exact class to be used.\n\nI have noticed this as well. I took a look at it and I think this should not cause any problems. So I have added also this optimization.", "author": "Vojtech-Sassmann", "createdAt": "2020-07-23T14:16:34Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzk1OTU1Nw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "97ab8d5ec25147efcb750fefb81fd557e1f0cffb", "url": "https://github.com/CESNET/perun/commit/97ab8d5ec25147efcb750fefb81fd557e1f0cffb", "message": "Core - search users optimizations\n\n* The most expensive operation when searching users as a Perun Admin was\nchecking, if the attribute definition passed to the authorization method\nis correct. This doesn't need to be performed here, because this is\nusually verified in earlier calls or to this method are passed only\ndefinitions retrieved from the database.\n* Also removed duplicit conversion of richUsers to\nrichUsersWithAttributes.", "committedDate": "2020-07-23T14:15:44Z", "type": "commit"}, {"oid": "97ab8d5ec25147efcb750fefb81fd557e1f0cffb", "url": "https://github.com/CESNET/perun/commit/97ab8d5ec25147efcb750fefb81fd557e1f0cffb", "message": "Core - search users optimizations\n\n* The most expensive operation when searching users as a Perun Admin was\nchecking, if the attribute definition passed to the authorization method\nis correct. This doesn't need to be performed here, because this is\nusually verified in earlier calls or to this method are passed only\ndefinitions retrieved from the database.\n* Also removed duplicit conversion of richUsers to\nrichUsersWithAttributes.", "committedDate": "2020-07-23T14:15:44Z", "type": "forcePushed"}]}