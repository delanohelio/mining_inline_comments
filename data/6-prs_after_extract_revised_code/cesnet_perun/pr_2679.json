{"pr_number": 2679, "pr_title": "CORE,RPC: Unified password manager modules logic", "pr_createdAt": "2020-04-28T09:46:35Z", "pr_url": "https://github.com/CESNET/perun/pull/2679", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNzE5ODIzMA==", "url": "https://github.com/CESNET/perun/pull/2679#discussion_r417198230", "bodyText": "I would use this String as constant.", "author": "stavamichal", "createdAt": "2020-04-29T09:56:21Z", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/UsersManagerBlImpl.java", "diffHunk": "@@ -2345,8 +2036,22 @@ public int getUsersCount(PerunSession sess) throws InternalErrorException {\n \t\treturn getUsersManagerImpl().getSponsors(sess, sponsoredMember);\n \t}\n \n-\tprivate PasswordManagerModule getPasswordManagerModule(PerunSession session, String namespace) throws InternalErrorException {\n-\t\treturn getUsersManagerImpl().getPasswordManagerModule(session, namespace);\n+\t@Override\n+\tpublic PasswordManagerModule getPasswordManagerModule(PerunSession session, String namespace) throws InternalErrorException {\n+\t\tPasswordManagerModule module = getUsersManagerImpl().getPasswordManagerModule(session, namespace);\n+\t\tif (module == null) {\n+\t\t\tlog.info(\"Password manager module for '{}' not found. Loading 'generic' password manager module instead.\", namespace);\n+\t\t\tmodule = getUsersManagerImpl().getPasswordManagerModule(session, \"generic\");", "originalCommit": "71a5f84e4027bf18c98f38492605774b3ca557c2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "f4bad4ee85d5ac4f29882ffbecfe7ec2e38656f5", "url": "https://github.com/CESNET/perun/commit/f4bad4ee85d5ac4f29882ffbecfe7ec2e38656f5", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-04T12:19:28Z", "type": "forcePushed"}, {"oid": "03be05e8c6e4643e0b15dfec3ec3fe64c00c36d1", "url": "https://github.com/CESNET/perun/commit/03be05e8c6e4643e0b15dfec3ec3fe64c00c36d1", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-04T13:58:48Z", "type": "forcePushed"}, {"oid": "68efd63f7d628b395ea9c8d9bb5658924157c8f2", "url": "https://github.com/CESNET/perun/commit/68efd63f7d628b395ea9c8d9bb5658924157c8f2", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-05T12:24:47Z", "type": "forcePushed"}, {"oid": "07ada366a67c9ac2278bbc19b4608971858002ac", "url": "https://github.com/CESNET/perun/commit/07ada366a67c9ac2278bbc19b4608971858002ac", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-06T06:01:42Z", "type": "forcePushed"}, {"oid": "a2ff16a1d70494d875a3c72d6c9a1817bb12df2c", "url": "https://github.com/CESNET/perun/commit/a2ff16a1d70494d875a3c72d6c9a1817bb12df2c", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-06T13:05:39Z", "type": "forcePushed"}, {"oid": "3ac5918e95942a97f7e7340786baf06d39850c6c", "url": "https://github.com/CESNET/perun/commit/3ac5918e95942a97f7e7340786baf06d39850c6c", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-08T17:32:40Z", "type": "forcePushed"}, {"oid": "6b88b4bd5155abbf2c3ac8153341e8ac3d951b12", "url": "https://github.com/CESNET/perun/commit/6b88b4bd5155abbf2c3ac8153341e8ac3d951b12", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-11T07:43:44Z", "type": "forcePushed"}, {"oid": "943b7ac88ea22acd574e930ca487a91ca7795ce4", "url": "https://github.com/CESNET/perun/commit/943b7ac88ea22acd574e930ca487a91ca7795ce4", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-12T06:12:29Z", "type": "forcePushed"}, {"oid": "b5bb12cbb80d383c7054d9b19d6aa87a96b4cdeb", "url": "https://github.com/CESNET/perun/commit/b5bb12cbb80d383c7054d9b19d6aa87a96b4cdeb", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-12T10:42:54Z", "type": "forcePushed"}, {"oid": "bac4f68f32380b8ef984336784bf0e1d2268feb6", "url": "https://github.com/CESNET/perun/commit/bac4f68f32380b8ef984336784bf0e1d2268feb6", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-12T11:42:46Z", "type": "forcePushed"}, {"oid": "41b187321be67bb109ea144ecb9a13a82ad51d18", "url": "https://github.com/CESNET/perun/commit/41b187321be67bb109ea144ecb9a13a82ad51d18", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-12T12:14:23Z", "type": "forcePushed"}, {"oid": "ed6a7fd90f6b82a14b1c63c489cbdaafcf0ab21f", "url": "https://github.com/CESNET/perun/commit/ed6a7fd90f6b82a14b1c63c489cbdaafcf0ab21f", "message": "CORE: Simplified exit code handling of alt password managers\n\n- We have simpler scripts for alternative passwords and they\n  exit 1 on any error. They log locally and return no info\n  back to the perun. Hence we can simply throw proper\n  exception on any non zero exit code based on triggered\n  action.\n- Temporarily disable appending \".einfra\" to standard password\n  manager script name, to ease up deployment. We don't have\n  updated scripts on production yet.", "committedDate": "2020-05-13T11:21:43Z", "type": "forcePushed"}, {"oid": "32a1770a209f5a91a4d903c3e46f2933d07a7b32", "url": "https://github.com/CESNET/perun/commit/32a1770a209f5a91a4d903c3e46f2933d07a7b32", "message": "CORE: Simplified exit code handling of alt password managers\n\n- We have simpler scripts for alternative passwords and they\n  exit 1 on any error. They log locally and return no info\n  back to the perun. Hence we can simply throw proper\n  exception on any non zero exit code based on triggered\n  action.\n- Temporarily disable appending \".einfra\" to standard password\n  manager script name, to ease up deployment. We don't have\n  updated scripts on production yet.", "committedDate": "2020-05-13T14:04:01Z", "type": "forcePushed"}, {"oid": "bb5102dad0fa5d9edfbf78b4f5b64c593bcdd9bc", "url": "https://github.com/CESNET/perun/commit/bb5102dad0fa5d9edfbf78b4f5b64c593bcdd9bc", "message": "CORE,RPC: Unified password manager modules logic\n\n- Added GenericPasswordManagerModule as default implementation\n  for password manager logic replacing former implementation\n  from inside of managePassword(), which was removed.\n- Each outer API method to manage password now calls proper\n  module / implementation.\n- Method UsersManagerBl.getPasswordManagerModule() is now public\n  and always returns module for namespace or generic implementation.\n  If instantiation fails, then exception is thrown.\n- Removed generateAccount() from UsersManagerImpl, it is now\n  only in Bl, reusing bl method to get module.\n- Removed long time deprecated createPassword() methods from all APIs.\n- Removed unnecessary and incomplete javadoc from bl methods.", "committedDate": "2020-05-21T05:56:12Z", "type": "commit"}, {"oid": "a9d2ff9e94aa01e765d8f9871b78a66ff7f0a7d1", "url": "https://github.com/CESNET/perun/commit/a9d2ff9e94aa01e765d8f9871b78a66ff7f0a7d1", "message": "CORE: Alternative passwords logic moved to PasswordManagerModule\n\n- Added createAlternativePassword() and deleteAlternativePassword()\n  to PasswordManagerModule.\n- Modified logic in UsersManagerBlImpl to use modules instead of\n  shared manageAlternativePassword().\n- Added generic implementation for alternative passwords inside\n  GenericPasswordManagerModule.", "committedDate": "2020-05-21T05:56:13Z", "type": "commit"}, {"oid": "c13f4f1b1a43464c8e98e3062afbda12ea50083b", "url": "https://github.com/CESNET/perun/commit/c13f4f1b1a43464c8e98e3062afbda12ea50083b", "message": "CORE: Added stub module for einfra namespace\n\n- Added EinfraPasswordManagerModule, which is extending standard\n  GenericPasswordManagerModule. It will perform custom checks\n  on login format and password strength.\n- It modifies default password manager script path by appending\n  \".einfra\" to the script name, so that each namespace can\n  have custom implementation.", "committedDate": "2020-05-21T05:56:14Z", "type": "commit"}, {"oid": "118f234d816be1fe216c5f3216c6999bfc20035c", "url": "https://github.com/CESNET/perun/commit/118f234d816be1fe216c5f3216c6999bfc20035c", "message": "CORE: Implemented password manager module for du-samba\n\n- New DusambaPasswordManagerModule will pass necessary data as ENV\n  variables for the new pwd manager script, avoiding STDIN.\n- We will do the same for einfra later.", "committedDate": "2020-05-21T05:56:14Z", "type": "commit"}, {"oid": "69cb862dbd7ecea96428b690ca96ce683d530af6", "url": "https://github.com/CESNET/perun/commit/69cb862dbd7ecea96428b690ca96ce683d530af6", "message": "CORE: Custom implementation of alt password manager in einfra\n\n- Only create/delete param is passed to the command directly\n- We now pass all other necessary properties as ENV variables,\n  so the script doesn't have to ask perun for additional data.\n- We do not set empty env variables.", "committedDate": "2020-05-21T05:56:14Z", "type": "commit"}, {"oid": "706b3a82bf8a8ea96650eb3242a7dfdc1d4cd61e", "url": "https://github.com/CESNET/perun/commit/706b3a82bf8a8ea96650eb3242a7dfdc1d4cd61e", "message": "CORE: Fixed samba-du namespace name\n\n- Fixed all \"du-samba\" to \"samba-du\", including module name.", "committedDate": "2020-05-21T05:56:15Z", "type": "commit"}, {"oid": "96e92274078391033d17b7592e76d1ecee26fe07", "url": "https://github.com/CESNET/perun/commit/96e92274078391033d17b7592e76d1ecee26fe07", "message": "CORE: Simplified exit code handling of alt password managers\n\n- We have simpler scripts for alternative passwords and they\n  exit 1 on any error. They log locally and return no info\n  back to the perun. Hence we can simply throw proper\n  exception on any non zero exit code based on triggered\n  action.\n- Temporarily disable appending \".einfra\" to standard password\n  manager script name, to ease up deployment. We don't have\n  updated scripts on production yet.", "committedDate": "2020-05-21T05:56:15Z", "type": "commit"}, {"oid": "96e92274078391033d17b7592e76d1ecee26fe07", "url": "https://github.com/CESNET/perun/commit/96e92274078391033d17b7592e76d1ecee26fe07", "message": "CORE: Simplified exit code handling of alt password managers\n\n- We have simpler scripts for alternative passwords and they\n  exit 1 on any error. They log locally and return no info\n  back to the perun. Hence we can simply throw proper\n  exception on any non zero exit code based on triggered\n  action.\n- Temporarily disable appending \".einfra\" to standard password\n  manager script name, to ease up deployment. We don't have\n  updated scripts on production yet.", "committedDate": "2020-05-21T05:56:15Z", "type": "forcePushed"}]}