{"pr_number": 2775, "pr_title": "New method forceAllSubGroupsSynchronization", "pr_createdAt": "2020-07-02T13:16:21Z", "pr_url": "https://github.com/CESNET/perun/pull/2775", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ0OTk1Mg==", "url": "https://github.com/CESNET/perun/pull/2775#discussion_r449449952", "bodyText": "This attribute is not boolean but String so I do not think you can cast it to boolean like that.", "author": "balcirakpeter", "createdAt": "2020-07-03T08:27:09Z", "path": "perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java", "diffHunk": "@@ -1739,20 +1740,27 @@ protected boolean hasCandidateExistingMember(Candidate candidate, RichMember ric\n \t\treturn skippedGroups;\n \t}\n \n-\t/**\n-\t * Adds the group on the first place to the queue of groups waiting for synchronization.\n-\t *\n-\t * @param group the group to be forced this way\n-\t *\n-\t * @throws GroupSynchronizationAlreadyRunningException when group synchronization is already running at this moment\n-\t */\n \t@Override\n-\tpublic void forceGroupSynchronization(PerunSession sess, Group group) throws GroupSynchronizationAlreadyRunningException {\n-\t\t//Check if the group is not currently in synchronization process\n-\t\tif(poolOfSynchronizations.putGroupToPoolOfWaitingGroups(group, true)) {\n-\t\t\tlog.debug(\"Scheduling synchronization for the group {} by force!\", group);\n+\tpublic void forceGroupSynchronization(PerunSession sess, Group group) throws GroupSynchronizationAlreadyRunningException, GroupSynchronizationNotEnabledException {\n+\t\t//Check if the group should be synchronized (attribute synchronizationEnabled is set to 'true')\n+\t\tBoolean syncEnabled = false;\n+\t\ttry {\n+\t\t\tAttribute syncEnabledAttr = getPerunBl().getAttributesManagerBl().getAttribute(sess, group, GroupsManager.GROUPSYNCHROENABLED_ATTRNAME);\n+\t\t\tif(syncEnabledAttr.getValue() != null) syncEnabled = syncEnabledAttr.valueAsBoolean();", "originalCommit": "e76e45e6aabba8116a788b58fcb815dcebe1df37", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDc3ODc4Mg==", "url": "https://github.com/CESNET/perun/pull/2775#discussion_r450778782", "bodyText": "You are right, fixed.", "author": "stavamichal", "createdAt": "2020-07-07T10:55:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTQ0OTk1Mg=="}], "type": "inlineReview", "revised_code": {"commit": "501811ca28f68bb42001019f52944467f7b3926e", "chunk": "diff --git a/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java b/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java\nindex 6093be020..dc68b74dd 100644\n--- a/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java\n+++ b/perun-core/src/main/java/cz/metacentrum/perun/core/blImpl/GroupsManagerBlImpl.java\n\n@@ -1746,7 +1746,7 @@ public class GroupsManagerBlImpl implements GroupsManagerBl {\n \t\tBoolean syncEnabled = false;\n \t\ttry {\n \t\t\tAttribute syncEnabledAttr = getPerunBl().getAttributesManagerBl().getAttribute(sess, group, GroupsManager.GROUPSYNCHROENABLED_ATTRNAME);\n-\t\t\tif(syncEnabledAttr.getValue() != null) syncEnabled = syncEnabledAttr.valueAsBoolean();\n+\t\t\tif(syncEnabledAttr.getValue() != null) syncEnabled = \"true\".equals(syncEnabledAttr.valueAsString());\n \t\t} catch (WrongAttributeAssignmentException | AttributeNotExistsException ex) {\n \t\t\t//attribute is wrongly set in database\n \t\t\tthrow new InternalErrorException(\"Can't force \" + group + \" because we can't find \", ex);\n"}}, {"oid": "501811ca28f68bb42001019f52944467f7b3926e", "url": "https://github.com/CESNET/perun/commit/501811ca28f68bb42001019f52944467f7b3926e", "message": "New method forceAllSubGroupsSynchronization\n\n - to be able to force synchronization of all subgroups (whole tree) of\n any base group, we need to add new method for it\n - in forcing group process we need to also check if group is enabled to\n be synchronized, if not, new exception should be thrown. For this\n reason GroupSynchronizationNotEnabledException was created\n - add new method also to rpc and openapi", "committedDate": "2020-07-07T10:53:28Z", "type": "commit"}, {"oid": "501811ca28f68bb42001019f52944467f7b3926e", "url": "https://github.com/CESNET/perun/commit/501811ca28f68bb42001019f52944467f7b3926e", "message": "New method forceAllSubGroupsSynchronization\n\n - to be able to force synchronization of all subgroups (whole tree) of\n any base group, we need to add new method for it\n - in forcing group process we need to also check if group is enabled to\n be synchronized, if not, new exception should be thrown. For this\n reason GroupSynchronizationNotEnabledException was created\n - add new method also to rpc and openapi", "committedDate": "2020-07-07T10:53:28Z", "type": "forcePushed"}]}