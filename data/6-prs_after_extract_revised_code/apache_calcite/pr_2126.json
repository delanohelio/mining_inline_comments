{"pr_number": 2126, "pr_title": "[CALCITE-4203] RelMdUniqueKeys should not return empty when meeting Intersect and Minus if its input has unique keys", "pr_createdAt": "2020-09-01T03:58:44Z", "pr_url": "https://github.com/apache/calcite/pull/2126", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTAwMDY2MA==", "url": "https://github.com/apache/calcite/pull/2126#discussion_r481000660", "bodyText": "is a => is an", "author": "danny0405", "createdAt": "2020-09-01T09:30:29Z", "path": "core/src/main/java/org/apache/calcite/rel/metadata/RelMdUniqueKeys.java", "diffHunk": "@@ -256,6 +259,35 @@ private RelMdUniqueKeys() {}\n     return ImmutableSet.of();\n   }\n \n+  /**\n+   * Any unique key of any input of Intersect is a unique key of the Intersect.\n+   */", "originalCommit": "49d136a4efba422d7c277c04056d4254a007e5f4", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MjY5Mjg2OA==", "url": "https://github.com/apache/calcite/pull/2126#discussion_r482692868", "bodyText": "Done.", "author": "chunweilei", "createdAt": "2020-09-03T04:14:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTAwMDY2MA=="}], "type": "inlineReview", "revised_code": {"commit": "9fca6c7627fd36b2b28308998c739ed746ad837e", "chunk": "diff --git a/core/src/main/java/org/apache/calcite/rel/metadata/RelMdUniqueKeys.java b/core/src/main/java/org/apache/calcite/rel/metadata/RelMdUniqueKeys.java\nindex 6fc7e7489..1969d311d 100644\n--- a/core/src/main/java/org/apache/calcite/rel/metadata/RelMdUniqueKeys.java\n+++ b/core/src/main/java/org/apache/calcite/rel/metadata/RelMdUniqueKeys.java\n\n@@ -260,11 +260,12 @@ private RelMdUniqueKeys() {}\n   }\n \n   /**\n-   * Any unique key of any input of Intersect is a unique key of the Intersect.\n+   * Any unique key of any input of Intersect is an unique key of the Intersect.\n    */\n-  public Set<ImmutableBitSet> getUniqueKeys(Intersect r, RelMetadataQuery mq, boolean ignoreNulls) {\n+  public Set<ImmutableBitSet> getUniqueKeys(Intersect rel,\n+      RelMetadataQuery mq, boolean ignoreNulls) {\n     Set<ImmutableBitSet> keys = new LinkedHashSet<>();\n-    for (RelNode input : r.getInputs()) {\n+    for (RelNode input : rel.getInputs()) {\n       Set<ImmutableBitSet> uniqueKeys = mq.getUniqueKeys(input, ignoreNulls);\n       if (uniqueKeys != null) {\n         keys.addAll(uniqueKeys);\n"}}, {"oid": "9fca6c7627fd36b2b28308998c739ed746ad837e", "url": "https://github.com/apache/calcite/commit/9fca6c7627fd36b2b28308998c739ed746ad837e", "message": "address comments", "committedDate": "2020-09-02T02:58:04Z", "type": "forcePushed"}, {"oid": "397906c2f615409f4891815e3befd9eddae1e00f", "url": "https://github.com/apache/calcite/commit/397906c2f615409f4891815e3befd9eddae1e00f", "message": "[CALCITE-4203] RelMdUniqueKeys should not return empty when meeting Intersect and Minus if its input has unique keys", "committedDate": "2020-09-02T06:36:34Z", "type": "commit"}, {"oid": "397906c2f615409f4891815e3befd9eddae1e00f", "url": "https://github.com/apache/calcite/commit/397906c2f615409f4891815e3befd9eddae1e00f", "message": "[CALCITE-4203] RelMdUniqueKeys should not return empty when meeting Intersect and Minus if its input has unique keys", "committedDate": "2020-09-02T06:36:34Z", "type": "forcePushed"}]}