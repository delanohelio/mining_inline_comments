{"pr_number": 818, "pr_title": "Adds indexes to MongoBlob", "pr_createdAt": "2020-07-08T05:46:37Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/818", "timeline": [{"oid": "c0aa6ff750b06f28b02a5d053078dbb30acee87b", "url": "https://github.com/scireum/sirius-biz/commit/c0aa6ff750b06f28b02a5d053078dbb30acee87b", "message": "Adds indexes to MongoBlob", "committedDate": "2020-07-08T05:45:55Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMwMDY0NA==", "url": "https://github.com/scireum/sirius-biz/pull/818#discussion_r451300644", "bodyText": "Hochz\u00e4hlendes Suffix da es zu viele Spalten sind um diese im Indexnamen unterzubringen?", "author": "bwiedmann", "createdAt": "2020-07-08T05:57:46Z", "path": "src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java", "diffHunk": "@@ -45,6 +47,23 @@\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n+@Index(name = \"blob_lookup_1\",", "originalCommit": "c0aa6ff750b06f28b02a5d053078dbb30acee87b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "947cf27fe27754573f3e030a16841cb49c8ec8b2", "chunk": "diff --git a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\nindex 27f231a3..b417eae0 100644\n--- a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n+++ b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n\n@@ -47,21 +47,21 @@ import java.util.Optional;\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n-@Index(name = \"blob_lookup_1\",\n+@Index(name = \"blob_normalized_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"normalizedFilename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_2\",\n+@Index(name = \"blob_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"filename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_3\",\n+@Index(name = \"blob_reference_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"reference\", \"referenceDesignator\"},\n         columnSettings = {Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING})\n public class MongoBlob extends MongoEntity implements Blob, OptimisticCreate {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMxNTQ4OQ==", "url": "https://github.com/scireum/sirius-biz/pull/818#discussion_r451315489", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            @Index(name = \"blob_lookup_3\",\n          \n          \n            \n            @Index(name = \"blob_reference_lookup\",", "author": "sabieber", "createdAt": "2020-07-08T06:39:16Z", "path": "src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java", "diffHunk": "@@ -45,6 +47,23 @@\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n+@Index(name = \"blob_lookup_1\",\n+        columns = {\"spaceName\", \"deleted\", \"normalizedFilename\", \"parent\", \"committed\"},\n+        columnSettings = {Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING})\n+@Index(name = \"blob_lookup_2\",\n+        columns = {\"spaceName\", \"deleted\", \"filename\", \"parent\", \"committed\"},\n+        columnSettings = {Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING})\n+@Index(name = \"blob_lookup_3\",", "originalCommit": "c0aa6ff750b06f28b02a5d053078dbb30acee87b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "947cf27fe27754573f3e030a16841cb49c8ec8b2", "chunk": "diff --git a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\nindex 27f231a3..b417eae0 100644\n--- a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n+++ b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n\n@@ -47,21 +47,21 @@ import java.util.Optional;\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n-@Index(name = \"blob_lookup_1\",\n+@Index(name = \"blob_normalized_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"normalizedFilename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_2\",\n+@Index(name = \"blob_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"filename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_3\",\n+@Index(name = \"blob_reference_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"reference\", \"referenceDesignator\"},\n         columnSettings = {Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING})\n public class MongoBlob extends MongoEntity implements Blob, OptimisticCreate {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMxNTY0OQ==", "url": "https://github.com/scireum/sirius-biz/pull/818#discussion_r451315649", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            @Index(name = \"blob_lookup_1\",\n          \n          \n            \n            @Index(name = \"blob_normalized_filename_lookup\",", "author": "sabieber", "createdAt": "2020-07-08T06:39:39Z", "path": "src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java", "diffHunk": "@@ -45,6 +47,23 @@\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n+@Index(name = \"blob_lookup_1\",", "originalCommit": "c0aa6ff750b06f28b02a5d053078dbb30acee87b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "947cf27fe27754573f3e030a16841cb49c8ec8b2", "chunk": "diff --git a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\nindex 27f231a3..b417eae0 100644\n--- a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n+++ b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n\n@@ -47,21 +47,21 @@ import java.util.Optional;\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n-@Index(name = \"blob_lookup_1\",\n+@Index(name = \"blob_normalized_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"normalizedFilename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_2\",\n+@Index(name = \"blob_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"filename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_3\",\n+@Index(name = \"blob_reference_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"reference\", \"referenceDesignator\"},\n         columnSettings = {Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING})\n public class MongoBlob extends MongoEntity implements Blob, OptimisticCreate {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTMxNTczNw==", "url": "https://github.com/scireum/sirius-biz/pull/818#discussion_r451315737", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n            @Index(name = \"blob_lookup_2\",\n          \n          \n            \n            @Index(name = \"blob_filename_lookup\",", "author": "sabieber", "createdAt": "2020-07-08T06:39:54Z", "path": "src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java", "diffHunk": "@@ -45,6 +47,23 @@\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n+@Index(name = \"blob_lookup_1\",\n+        columns = {\"spaceName\", \"deleted\", \"normalizedFilename\", \"parent\", \"committed\"},\n+        columnSettings = {Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING,\n+                          Mango.INDEX_ASCENDING})\n+@Index(name = \"blob_lookup_2\",", "originalCommit": "c0aa6ff750b06f28b02a5d053078dbb30acee87b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "947cf27fe27754573f3e030a16841cb49c8ec8b2", "chunk": "diff --git a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\nindex 27f231a3..b417eae0 100644\n--- a/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n+++ b/src/main/java/sirius/biz/storage/layer2/mongo/MongoBlob.java\n\n@@ -47,21 +47,21 @@ import java.util.Optional;\n  */\n @Framework(MongoBlobStorage.FRAMEWORK_MONGO_BLOB_STORAGE)\n @ComplexDelete(false)\n-@Index(name = \"blob_lookup_1\",\n+@Index(name = \"blob_normalized_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"normalizedFilename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_2\",\n+@Index(name = \"blob_filename_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"filename\", \"parent\", \"committed\"},\n         columnSettings = {Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING,\n                           Mango.INDEX_ASCENDING})\n-@Index(name = \"blob_lookup_3\",\n+@Index(name = \"blob_reference_lookup\",\n         columns = {\"spaceName\", \"deleted\", \"reference\", \"referenceDesignator\"},\n         columnSettings = {Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING, Mango.INDEX_ASCENDING})\n public class MongoBlob extends MongoEntity implements Blob, OptimisticCreate {\n"}}, {"oid": "947cf27fe27754573f3e030a16841cb49c8ec8b2", "url": "https://github.com/scireum/sirius-biz/commit/947cf27fe27754573f3e030a16841cb49c8ec8b2", "message": "Renames indexes according to PR review", "committedDate": "2020-07-08T06:53:20Z", "type": "commit"}, {"oid": "9bcf6426c53040f4d1b381b4c4b78a92dcd89f1c", "url": "https://github.com/scireum/sirius-biz/commit/9bcf6426c53040f4d1b381b4c4b78a92dcd89f1c", "message": "Adds indexes to MongoDirectory", "committedDate": "2020-07-08T07:00:05Z", "type": "commit"}, {"oid": "d4a253027587fb5923185b1e6938200d95e02268", "url": "https://github.com/scireum/sirius-biz/commit/d4a253027587fb5923185b1e6938200d95e02268", "message": "Adds indices to SQLBlob + SQLDirectory\n\naccording to the mongo variants", "committedDate": "2020-07-08T07:29:14Z", "type": "commit"}]}