{"pr_number": 697, "pr_title": "Adds VirtualFile.download and uses it in the FileImportJob", "pr_createdAt": "2020-03-04T14:08:08Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/697", "timeline": [{"oid": "2d51be02755762e439d6dfb9158e4760791de9a7", "url": "https://github.com/scireum/sirius-biz/commit/2d51be02755762e439d6dfb9158e4760791de9a7", "message": "Provides VirtualFile.download()\n\nThis will yield a FileHandle to directly access the contents of the\nwrapped file. By default a temporary file will be created and\nand used. However, some roots might provide a direct way\nof accessing a file (e.g. when working on local files already).", "committedDate": "2020-03-04T13:56:39Z", "type": "commit"}, {"oid": "0d47f237bf9d011a1c85b0105aa3ff139e507009", "url": "https://github.com/scireum/sirius-biz/commit/0d47f237bf9d011a1c85b0105aa3ff139e507009", "message": "Adds an additional method for attaching a file.\n\nIf the contents of a file are already available as FileHandle,\nwe can directly use this. Using a remote storage like S3\nthis might save us from downloading the same file twice.", "committedDate": "2020-03-04T14:03:32Z", "type": "commit"}, {"oid": "77e5c349b589b743b5fa18cb310277d3898839f4", "url": "https://github.com/scireum/sirius-biz/commit/77e5c349b589b743b5fa18cb310277d3898839f4", "message": "BREAKING: Uses a FileHandle to prevent duplicate downloads of the file being processed.\n\nIf we're using a remote storage we previously downloaded the same file twice\n(first to attach it, then to process it). We're now making a local copy and use\nthis for both steps.\n\nThis is a breaking change as the internal API changed for subclasses.", "committedDate": "2020-03-04T14:06:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MjkwOTQ2Nw==", "url": "https://github.com/scireum/sirius-biz/pull/697#discussion_r392909467", "bodyText": "not required?", "author": "tbiScireum", "createdAt": "2020-03-16T10:17:29Z", "path": "src/main/java/sirius/biz/storage/layer3/uplink/sftp/SFTPUplink.java", "diffHunk": "@@ -8,6 +8,7 @@\n \n package sirius.biz.storage.layer3.uplink.sftp;\n \n+import com.google.common.io.BaseEncoding;", "originalCommit": "77e5c349b589b743b5fa18cb310277d3898839f4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "542757e8494c91b22d8d9f380da4c0492757fcf2", "chunk": "diff --git a/src/main/java/sirius/biz/storage/layer3/uplink/sftp/SFTPUplink.java b/src/main/java/sirius/biz/storage/layer3/uplink/sftp/SFTPUplink.java\nindex a716f424..91d8617c 100644\n--- a/src/main/java/sirius/biz/storage/layer3/uplink/sftp/SFTPUplink.java\n+++ b/src/main/java/sirius/biz/storage/layer3/uplink/sftp/SFTPUplink.java\n\n@@ -8,7 +8,6 @@\n \n package sirius.biz.storage.layer3.uplink.sftp;\n \n-import com.google.common.io.BaseEncoding;\n import org.apache.sshd.client.subsystem.sftp.SftpClient;\n import org.apache.sshd.common.subsystem.sftp.SftpConstants;\n import org.apache.sshd.common.subsystem.sftp.SftpException;\n"}}, {"oid": "542757e8494c91b22d8d9f380da4c0492757fcf2", "url": "https://github.com/scireum/sirius-biz/commit/542757e8494c91b22d8d9f380da4c0492757fcf2", "message": "Organizes imports.", "committedDate": "2020-03-16T10:43:22Z", "type": "commit"}, {"oid": "69075fc8ea0b3f8f614ccfa54e2a45ad55dd06c8", "url": "https://github.com/scireum/sirius-biz/commit/69075fc8ea0b3f8f614ccfa54e2a45ad55dd06c8", "message": "Merge remote-tracking branch 'origin/master' into aha/vfs-download", "committedDate": "2020-03-16T10:43:58Z", "type": "commit"}]}