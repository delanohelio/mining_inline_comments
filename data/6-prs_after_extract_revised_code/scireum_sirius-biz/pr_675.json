{"pr_number": 675, "pr_title": "Makes the required check aware of the automatic trim performed by mos\u2026", "pr_createdAt": "2020-01-27T10:56:41Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/675", "timeline": [{"oid": "3fc1c4bfa50935b141bab0429dccf4b16fb54262", "url": "https://github.com/scireum/sirius-biz/commit/3fc1c4bfa50935b141bab0429dccf4b16fb54262", "message": "BREAKING CHANGE: Makes the required check aware of the automatic trim performed by most of the frameworks around it.\n\nThis is a breaking change as we kind of flipped the default. We now trim by\ndefault, which can be disabled - previously the check was conducted without\ntrimming.", "committedDate": "2020-01-27T12:16:04Z", "type": "commit"}, {"oid": "3fc1c4bfa50935b141bab0429dccf4b16fb54262", "url": "https://github.com/scireum/sirius-biz/commit/3fc1c4bfa50935b141bab0429dccf4b16fb54262", "message": "BREAKING CHANGE: Makes the required check aware of the automatic trim performed by most of the frameworks around it.\n\nThis is a breaking change as we kind of flipped the default. We now trim by\ndefault, which can be disabled - previously the check was conducted without\ntrimming.", "committedDate": "2020-01-27T12:16:04Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTIyNDYxNw==", "url": "https://github.com/scireum/sirius-biz/pull/675#discussion_r371224617", "bodyText": "fetch the raw value", "author": "sabieber", "createdAt": "2020-01-27T12:56:43Z", "path": "src/main/java/sirius/biz/importer/format/RequiredCheck.java", "diffHunk": "@@ -8,21 +8,45 @@\n \n package sirius.biz.importer.format;\n \n+import sirius.kernel.commons.Strings;\n import sirius.kernel.commons.Value;\n import sirius.kernel.nls.NLS;\n \n /**\n  * Enforces the presence of a value for the associated field.\n+ * <p>\n+ * Note, as most of the {@link Value} methods will perform an automatic <tt>trim</tt>, we also trim the contents before\n+ * checking for a non-empty value. (Thus \" \" would be considered empty and yield an error).\n+ * <p>\n+ * Use {@link #checkUntrimmed()} in order to suppress this behaviour.\n  */\n public class RequiredCheck implements ValueCheck {\n \n+    private boolean trim = true;\n+\n     @Override\n     public void perform(Value value) {\n-        if (value.isEmptyString()) {\n+        String effectiveValue = value.asString();", "originalCommit": "3fc1c4bfa50935b141bab0429dccf4b16fb54262", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "0bd5c307da395e0f56e3294c82256b0e9ef0df70", "chunk": "diff --git a/src/main/java/sirius/biz/importer/format/RequiredCheck.java b/src/main/java/sirius/biz/importer/format/RequiredCheck.java\nindex 56d762d0..f27526eb 100644\n--- a/src/main/java/sirius/biz/importer/format/RequiredCheck.java\n+++ b/src/main/java/sirius/biz/importer/format/RequiredCheck.java\n\n@@ -26,11 +26,7 @@ public class RequiredCheck implements ValueCheck {\n \n     @Override\n     public void perform(Value value) {\n-        String effectiveValue = value.asString();\n-\n-        if (trim) {\n-            effectiveValue = effectiveValue.trim();\n-        }\n+        String effectiveValue = trim ? value.getString() : value.getRawString();\n \n         if (Strings.isEmpty(effectiveValue)) {\n             throw new IllegalArgumentException(NLS.get(\"RequiredCheck.errorMsg\"));\n"}}, {"oid": "b9ed66ab283aded04159270b56e3a41f256602da", "url": "https://github.com/scireum/sirius-biz/commit/b9ed66ab283aded04159270b56e3a41f256602da", "message": "Updates to the latest sirius dependencies.", "committedDate": "2020-01-27T15:18:46Z", "type": "commit"}, {"oid": "0bd5c307da395e0f56e3294c82256b0e9ef0df70", "url": "https://github.com/scireum/sirius-biz/commit/0bd5c307da395e0f56e3294c82256b0e9ef0df70", "message": "Performs the check on the proper value.\n\nUses the proper method to either check the raw (untimmed) string\r\nor the trimmed version (getString performs an automatic trim).", "committedDate": "2020-01-28T08:06:03Z", "type": "commit"}, {"oid": "3671b5d190771af0b2c8f85580c2e01e10673197", "url": "https://github.com/scireum/sirius-biz/commit/3671b5d190771af0b2c8f85580c2e01e10673197", "message": "Updates to the latest sirius-db", "committedDate": "2020-01-28T08:26:55Z", "type": "commit"}]}