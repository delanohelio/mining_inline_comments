{"pr_number": 653, "pr_title": "Uses createNowOrUpdateInBatch as default way of updating entities.", "pr_createdAt": "2020-01-02T08:51:38Z", "pr_url": "https://github.com/scireum/sirius-biz/pull/653", "timeline": [{"oid": "bbcf20238618c88fa196c17872a296c94660b5f7", "url": "https://github.com/scireum/sirius-biz/commit/bbcf20238618c88fa196c17872a296c94660b5f7", "message": "Uses createNowOrUpdateInBatch as default way of updating entities.\n\nOtherwise \"unique\" checks might fail (at the database level) as the inserts are queued in the batch\nand therefore not enforced by the framework. This adds too much trouble for outweight the performance improvements\nof a batched insert.\n\nIf an entity is known to not have any unique constraints / such conflicts - which is probably very rare - this method\ncan be overwritten and changed back to a batched insert.", "committedDate": "2020-01-02T08:49:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQyNTgyNA==", "url": "https://github.com/scireum/sirius-biz/pull/653#discussion_r362425824", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                 * Creates the entity immediatelly or updates the given entity in the underlying database using a batch update.\n          \n          \n            \n                 * Creates the entity immediately or updates the given entity in the underlying database using a batch update.", "author": "meg1502", "createdAt": "2020-01-02T10:21:48Z", "path": "src/main/java/sirius/biz/importer/Importer.java", "diffHunk": "@@ -219,15 +222,39 @@ public ImportDictionary getExportDictionary(Class<? extends BaseEntity<?>> type)\n      * <p>\n      * Using a batch update will most probably yield substantial performance benefits with the downside, that the updated\n      * entity cannot be returned by this method.\n+     * <p>\n+     * Note that {@link #createNowOrUpdateInBatch(BaseEntity)} is most probably a better choice, as it makes the entity\n+     * immediatelly visible to the database and all internal consistency checks and still provides optimal performance\n+     * when updating many objects.\n      *\n      * @param entity the entity to update or create\n      * @param <E>    the generic type of the entity\n+     * @see #createNowOrUpdateInBatch(BaseEntity)\n+     * @see ImportHandler#createOrUpdateInBatch(BaseEntity)\n      */\n     @SuppressWarnings(\"unchecked\")\n     public <E extends BaseEntity<?>> void createOrUpdateInBatch(E entity) {\n         context.findHandler((Class<E>) entity.getClass()).createOrUpdateInBatch(entity);\n     }\n \n+    /**\n+     * Creates the entity immediatelly or updates the given entity in the underlying database using a batch update.", "originalCommit": "bbcf20238618c88fa196c17872a296c94660b5f7", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "af44657ede9ae49a0e00da4499ab26e9c5e80e7d", "chunk": "diff --git a/src/main/java/sirius/biz/importer/Importer.java b/src/main/java/sirius/biz/importer/Importer.java\nindex 4d20c2b8..78fd84f5 100644\n--- a/src/main/java/sirius/biz/importer/Importer.java\n+++ b/src/main/java/sirius/biz/importer/Importer.java\n\n@@ -238,7 +238,7 @@ public class Importer implements Closeable {\n     }\n \n     /**\n-     * Creates the entity immediatelly or updates the given entity in the underlying database using a batch update.\n+     * Creates the entity immediately or updates the given entity in the underlying database using a batch update.\n      * <p>\n      * Uses the appropriate {@link ImportHandler} to determine if the entity already exists and then either updates\n      * the entity or creates a new one.\n"}}, {"oid": "af44657ede9ae49a0e00da4499ab26e9c5e80e7d", "url": "https://github.com/scireum/sirius-biz/commit/af44657ede9ae49a0e00da4499ab26e9c5e80e7d", "message": "Update src/main/java/sirius/biz/importer/Importer.java\n\nCo-Authored-By: meg1502 <meg@scireum.de>", "committedDate": "2020-01-02T10:43:19Z", "type": "commit"}]}