{"pr_number": 668, "pr_title": "Improve freeze alert broadcast", "pr_createdAt": "2020-10-01T06:32:45Z", "pr_url": "https://github.com/PGMDev/PGM/pull/668", "timeline": [{"oid": "a3fd684c67c74df591a426c9da86484532e579d9", "url": "https://github.com/PGMDev/PGM/commit/a3fd684c67c74df591a426c9da86484532e579d9", "message": "Improve freeze alert broadcast\n* Adds an interactive click to reverse freeze action\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-10-01T05:53:00Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI5MTc4Mg==", "url": "https://github.com/PGMDev/PGM/pull/668#discussion_r498291782", "bodyText": "Is this mixed up?\nConstuctor calls for senderName, targetName. Seems like you are sending targetName and then senderName rn\nAlso considered just having a constructor MatchPlayer sender, MatchPlayer target, boolean frozen ?\nso a method Component createInteractiveFreezeBroadcast could be something like\n return TextComponent.builder()\n.append(\n              TranslatableComponent.of(\n                  String.format(\"moderation.freeze.broadcast.%s\", frozen ? \"frozen\" : \"thaw\"),\n                  TextColor.GRAY,\n                  sender.getName(NameStyle.CONCISE),\n                  target.getName(NameStyle.CONCISE))\n          .hoverEvent(\n              HoverEvent.showText(\n                  TranslatableComponent.of(\"moderation.freeze.broadcast.hover\", TextColor.GRAY)))\n          .clickEvent(ClickEvent.runCommand(\"/f \" + target.getBukkit().getName())\n          .build();\nThe thing i think is weird is passing a targetName and a username", "author": "KingOfSquares", "createdAt": "2020-10-01T14:32:43Z", "path": "core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java", "diffHunk": "@@ -369,14 +368,27 @@ private void thaw(MatchPlayer freezee, Component senderName, boolean silent) {\n       freezee.sendMessage(thawedTitle.color(TextColor.GREEN).build());\n \n       ChatDispatcher.broadcastAdminChatMessage(\n-          TranslatableComponent.of(\n-              \"moderation.freeze.broadcast.thaw\",\n-              TextColor.GRAY,\n-              senderName,\n-              freezee.getName(NameStyle.CONCISE)),\n+          createInteractiveBroadcast(\n+              freezee.getName(NameStyle.CONCISE), senderName, freezee.getBukkit().getName(), false),\n           match);\n     }\n \n+    private Component createInteractiveBroadcast(\n+        Component senderName, Component targetName, String username, boolean frozen) {\n+      return TextComponent.builder()", "originalCommit": "a3fd684c67c74df591a426c9da86484532e579d9", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2MTMxOQ==", "url": "https://github.com/PGMDev/PGM/pull/668#discussion_r498461319", "bodyText": "Hey Simon!\nThanks for the feedback, I see what I did xD I'll be making some changes later in the day to make this method more precise. Thanks!", "author": "applenick", "createdAt": "2020-10-01T19:14:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI5MTc4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "c18f54a20b4272334abce029d5d4686fd430469f", "chunk": "diff --git a/core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java b/core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java\nindex 81445924..0d145cfb 100644\n--- a/core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java\n+++ b/core/src/main/java/tc/oc/pgm/community/modules/FreezeMatchModule.java\n\n@@ -368,24 +366,22 @@ public class FreezeMatchModule implements MatchModule, Listener {\n       freezee.sendMessage(thawedTitle.color(TextColor.GREEN).build());\n \n       ChatDispatcher.broadcastAdminChatMessage(\n-          createInteractiveBroadcast(\n-              freezee.getName(NameStyle.CONCISE), senderName, freezee.getBukkit().getName(), false),\n-          match);\n+          createInteractiveBroadcast(senderName, freezee, false), match);\n     }\n \n     private Component createInteractiveBroadcast(\n-        Component senderName, Component targetName, String username, boolean frozen) {\n+        Component senderName, MatchPlayer freezee, boolean frozen) {\n       return TextComponent.builder()\n           .append(\n               TranslatableComponent.of(\n                   String.format(\"moderation.freeze.broadcast.%s\", frozen ? \"frozen\" : \"thaw\"),\n                   TextColor.GRAY,\n                   senderName,\n-                  targetName))\n+                  freezee.getName(NameStyle.CONCISE)))\n           .hoverEvent(\n               HoverEvent.showText(\n                   TranslatableComponent.of(\"moderation.freeze.broadcast.hover\", TextColor.GRAY)))\n-          .clickEvent(ClickEvent.runCommand(\"/f \" + username))\n+          .clickEvent(ClickEvent.runCommand(\"/f \" + freezee.getBukkit().getName()))\n           .build();\n     }\n \n"}}, {"oid": "c18f54a20b4272334abce029d5d4686fd430469f", "url": "https://github.com/PGMDev/PGM/commit/c18f54a20b4272334abce029d5d4686fd430469f", "message": "Clean up interactive broadcast method\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-10-02T22:47:47Z", "type": "commit"}]}