{"pr_number": 666, "pr_title": "Add /votebook command", "pr_createdAt": "2020-10-01T06:31:02Z", "pr_url": "https://github.com/PGMDev/PGM/pull/666", "timeline": [{"oid": "2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b", "url": "https://github.com/PGMDev/PGM/commit/2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b", "message": "Add /votebook command\n* Allows users to spawn a new vote book if lost or joining after vote has begun\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-10-01T00:02:42Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI3NTc2Nw==", "url": "https://github.com/PGMDev/PGM/pull/666#discussion_r498275767", "bodyText": "Maybe a message if you try to do /votebook during a match? We should have a generic You can not use this command while the match is running anyway IMO.", "author": "KingOfSquares", "createdAt": "2020-10-01T14:12:10Z", "path": "core/src/main/java/tc/oc/pgm/command/MapPoolCommand.java", "diffHunk": "@@ -284,21 +284,36 @@ public static void voteNext(\n       @Switch('o') boolean forceOpen,\n       @Text MapInfo map)\n       throws CommandException {\n+    MapPoll poll = getVotingPool(player, sender, mapOrder);\n+    if (poll != null) {\n+      boolean voteResult = poll.toggleVote(map, ((Player) sender).getUniqueId());\n+      Component voteAction =\n+          TranslatableComponent.of(\n+              voteResult ? \"vote.for\" : \"vote.abstain\",\n+              voteResult ? TextColor.GREEN : TextColor.RED,\n+              map.getStyledName(MapNameStyle.COLOR));\n+      player.sendMessage(voteAction);\n+      poll.sendBook(player, forceOpen);\n+    }\n+  }\n+\n+  @Command(aliases = \"votebook\", desc = \"Spawn a vote book\")\n+  public void voteBook(MatchPlayer player, CommandSender sender, MapOrder mapOrder)\n+      throws CommandException {\n+    MapPoll poll = getVotingPool(player, sender, mapOrder);\n+    if (poll != null) {", "originalCommit": "2b514437bac3cc2cf8cd91f90243f8f5c8b1a55b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODQ2Mjk4Ng==", "url": "https://github.com/PGMDev/PGM/pull/666#discussion_r498462986", "bodyText": "The sendBook method already does that, it says something like There is nothing to vote for at this time, so no need to add an additional message to the command \ud83d\ude04", "author": "applenick", "createdAt": "2020-10-01T19:17:58Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5ODI3NTc2Nw=="}], "type": "inlineReview", "revised_code": null}]}