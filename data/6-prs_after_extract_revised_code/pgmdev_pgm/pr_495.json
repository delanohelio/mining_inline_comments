{"pr_number": 495, "pr_title": "Hide vanished players from server ping and other fixes", "pr_createdAt": "2020-05-18T00:21:11Z", "pr_url": "https://github.com/PGMDev/PGM/pull/495", "timeline": [{"oid": "7c106e9b3be147aabf90905bf925474396b844dd", "url": "https://github.com/PGMDev/PGM/commit/7c106e9b3be147aabf90905bf925474396b844dd", "message": "Hide vanished players from server ping\nAlong with:\n* Disallow /report being used on vanished players\n* Fix a NPE with AntiGriefListener\n* Adjust /setnext staff broadcast\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-05-18T00:10:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMjYwOQ==", "url": "https://github.com/PGMDev/PGM/pull/495#discussion_r426322609", "bodyText": "Let me know if you want this translated. I was unsure since the matching text error comes from Intake, I did not believe it would matter since other languages most likely see the English warning no matter what.\nMaybe I should add a note in case we ever switch command frameworks?\nSee here for details.", "author": "applenick", "createdAt": "2020-05-18T00:23:34Z", "path": "core/src/main/java/tc/oc/pgm/community/commands/ReportCommands.java", "diffHunk": "@@ -84,6 +84,15 @@ public void report(MatchPlayer sender, Match match, Player player, @Text String\n     }\n \n     MatchPlayer accused = match.getPlayer(player);\n+\n+    // Don't allow reports of vanished players\n+    if (accused.isVanished()) {\n+      sender.sendWarning(\n+          TextComponent.of(\n+              \"Could not find player named '\" + player.getName() + \"'\", TextColor.RED));", "originalCommit": "7c106e9b3be147aabf90905bf925474396b844dd", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMzODI1OQ==", "url": "https://github.com/PGMDev/PGM/pull/495#discussion_r426338259", "bodyText": "Yes, add a note.", "author": "Electroid", "createdAt": "2020-05-18T02:10:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjMyMjYwOQ=="}], "type": "inlineReview", "revised_code": {"commit": "4a790d8bb259775e8e1080247374349b51cfa051", "chunk": "diff --git a/core/src/main/java/tc/oc/pgm/community/commands/ReportCommands.java b/core/src/main/java/tc/oc/pgm/community/commands/ReportCommands.java\nindex 4e22450c..2b85f4d5 100644\n--- a/core/src/main/java/tc/oc/pgm/community/commands/ReportCommands.java\n+++ b/core/src/main/java/tc/oc/pgm/community/commands/ReportCommands.java\n\n@@ -87,6 +87,9 @@ public class ReportCommands {\n \n     // Don't allow reports of vanished players\n     if (accused.isVanished()) {\n+      // Due to Intake not accounting for player locale, this message matches what is sent when no\n+      // player is found.\n+      // TODO: Please upgrade if command framework uses locale\n       sender.sendWarning(\n           TextComponent.of(\n               \"Could not find player named '\" + player.getName() + \"'\", TextColor.RED));\n"}}, {"oid": "4a790d8bb259775e8e1080247374349b51cfa051", "url": "https://github.com/PGMDev/PGM/commit/4a790d8bb259775e8e1080247374349b51cfa051", "message": "Add notice regarding intake message\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-05-18T05:59:39Z", "type": "commit"}]}