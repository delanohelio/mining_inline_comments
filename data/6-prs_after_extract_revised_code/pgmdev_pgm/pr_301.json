{"pr_number": 301, "pr_title": "Fire more transform events", "pr_createdAt": "2020-02-08T20:08:49Z", "pr_url": "https://github.com/PGMDev/PGM/pull/301", "timeline": [{"oid": "1ca682a07d3fa369811ef524f99b73bcec5ad979", "url": "https://github.com/PGMDev/PGM/commit/1ca682a07d3fa369811ef524f99b73bcec5ad979", "message": "Create transform events for structure grows\n\nSigned-off-by: Austin Mayes <austin@avicus.net>", "committedDate": "2020-02-08T20:06:47Z", "type": "commit"}, {"oid": "7765ceea8b55e831a3a5cfcb94e1c4c4e145f7bf", "url": "https://github.com/PGMDev/PGM/commit/7765ceea8b55e831a3a5cfcb94e1c4c4e145f7bf", "message": "Take into account block height when doing calculations\n\nSigned-off-by: Austin Mayes <austin@avicus.net>", "committedDate": "2020-02-08T20:23:52Z", "type": "commit"}, {"oid": "2e8f7825a2b569c0a3930e40d3ec0abf7c60e0ee", "url": "https://github.com/PGMDev/PGM/commit/2e8f7825a2b569c0a3930e40d3ec0abf7c60e0ee", "message": "Use a less garbage height check\n\nSigned-off-by: Austin Mayes <austin@avicus.net>", "committedDate": "2020-02-08T20:33:12Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczMzc2MQ==", "url": "https://github.com/PGMDev/PGM/pull/301#discussion_r376733761", "bodyText": "Can we put this in a util? Also, BlockTransformEvent is a very, very hot part of the code: Can we optimize this with enums and switches?\nI would even check have two checks, so this will be short-circuited.\nif (event.getNewState().getY() < this.buildHeight - 1) return;\nif (event.getNewState().getY()\n    + getExtraHeight(event.getNewState().getMaterial()) < this.buildHeight) return;\n// setCancelled", "author": "Electroid", "createdAt": "2020-02-08T20:54:22Z", "path": "src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java", "diffHunk": "@@ -33,4 +34,10 @@ public void checkBuildHeight(BlockTransformEvent event) {\n       }\n     }\n   }\n+\n+  private int getExtraHeight(Material material) {\n+    if (material.name().contains(\"DOOR\") && !material.name().contains(\"TRAP\")) return 1;", "originalCommit": "2e8f7825a2b569c0a3930e40d3ec0abf7c60e0ee", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczMzgwNA==", "url": "https://github.com/PGMDev/PGM/pull/301#discussion_r376733804", "bodyText": "Also, this isn't just an issue with MaxBuildHeightMatchModule, right? The bug will still happen for RegionMatchModule, can we fix it for both?", "author": "Electroid", "createdAt": "2020-02-08T20:55:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczMzc2MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczNjU5MA==", "url": "https://github.com/PGMDev/PGM/pull/301#discussion_r376736590", "bodyText": "Code changed in latest commit, re-review", "author": "AustinLMayes", "createdAt": "2020-02-08T21:46:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjczMzc2MQ=="}], "type": "inlineReview", "revised_code": {"commit": "06ffd2e37acc7c0676dcb39b8ac2a19eb48afa71", "chunk": "diff --git a/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java b/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java\nindex 3a00fa88..5147e249 100644\n--- a/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java\n+++ b/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java\n\n@@ -34,10 +33,4 @@ public class MaxBuildHeightMatchModule implements MatchModule, Listener {\n       }\n     }\n   }\n-\n-  private int getExtraHeight(Material material) {\n-    if (material.name().contains(\"DOOR\") && !material.name().contains(\"TRAP\")) return 1;\n-\n-    return 0;\n-  }\n }\n"}}, {"oid": "06ffd2e37acc7c0676dcb39b8ac2a19eb48afa71", "url": "https://github.com/PGMDev/PGM/commit/06ffd2e37acc7c0676dcb39b8ac2a19eb48afa71", "message": "Fire two transform events for 2-high blocks\n\nSigned-off-by: Austin Mayes <austin@avicus.net>", "committedDate": "2020-02-08T21:44:38Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1MDExMA==", "url": "https://github.com/PGMDev/PGM/pull/301#discussion_r376750110", "bodyText": "getMaterialHeight maybe? Should return 1 or 2.", "author": "TheMolkaPL", "createdAt": "2020-02-09T02:48:30Z", "path": "src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java", "diffHunk": "@@ -33,4 +34,23 @@ public void checkBuildHeight(BlockTransformEvent event) {\n       }\n     }\n   }\n+\n+  private int getExtraHeight(Material material) {", "originalCommit": "7765ceea8b55e831a3a5cfcb94e1c4c4e145f7bf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1MzExMQ==", "url": "https://github.com/PGMDev/PGM/pull/301#discussion_r376753111", "bodyText": "This is old code, review the latest commit only", "author": "AustinLMayes", "createdAt": "2020-02-09T04:04:06Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Njc1MDExMA=="}], "type": "inlineReview", "revised_code": {"commit": "8de317b7779ca472eab28cb8ac8ea10c6addb966", "chunk": "diff --git a/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java b/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java\nindex 0725a2b4..5147e249 100644\n--- a/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java\n+++ b/src/main/java/tc/oc/pgm/modules/MaxBuildHeightMatchModule.java\n\n@@ -34,23 +33,4 @@ public class MaxBuildHeightMatchModule implements MatchModule, Listener {\n       }\n     }\n   }\n-\n-  private int getExtraHeight(Material material) {\n-    switch (material) {\n-      case DARK_OAK_DOOR:\n-      case ACACIA_DOOR:\n-      case BIRCH_DOOR:\n-      case IRON_DOOR:\n-      case JUNGLE_DOOR:\n-      case SPRUCE_DOOR:\n-      case WOOD_DOOR:\n-      case WOODEN_DOOR:\n-      case STANDING_BANNER:\n-      case WALL_BANNER:\n-      case BANNER:\n-        return 1;\n-      default:\n-        return 0;\n-    }\n-  }\n }\n"}}, {"oid": "8de317b7779ca472eab28cb8ac8ea10c6addb966", "url": "https://github.com/PGMDev/PGM/commit/8de317b7779ca472eab28cb8ac8ea10c6addb966", "message": "Merge branch 'master' into fix/handle-trees", "committedDate": "2020-02-09T15:41:16Z", "type": "commit"}]}