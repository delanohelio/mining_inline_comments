{"pr_number": 517, "pr_title": "Changes to /setpool and mutes", "pr_createdAt": "2020-05-29T07:34:46Z", "pr_url": "https://github.com/PGMDev/PGM/pull/517", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjY0NzkwMA==", "url": "https://github.com/PGMDev/PGM/pull/517#discussion_r432647900", "bodyText": "Tracking who queued the restart isn't really needed.", "author": "Electroid", "createdAt": "2020-05-29T17:57:18Z", "path": "core/src/main/java/tc/oc/pgm/command/RestartCommand.java", "diffHunk": "@@ -21,10 +24,12 @@\n       perms = Permissions.STOP)\n   public void restart(\n       Audience audience,\n+      CommandSender sender,", "originalCommit": "421fa2a2aaf9e66e49cc055755434b7732000c62", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "e7d2392d2cf88ad3a323eceff9510daf6b283ef8", "chunk": "diff --git a/core/src/main/java/tc/oc/pgm/command/RestartCommand.java b/core/src/main/java/tc/oc/pgm/command/RestartCommand.java\nindex 775af84f..bae2537d 100644\n--- a/core/src/main/java/tc/oc/pgm/command/RestartCommand.java\n+++ b/core/src/main/java/tc/oc/pgm/command/RestartCommand.java\n\n@@ -28,8 +28,7 @@ public final class RestartCommand {\n       Match match,\n       @Default(\"30s\") Duration duration,\n       @Switch('f') boolean force) {\n-    RestartManager.queueRestart(\n-        \"Restart requested via /queuerestart command\", duration, sender.getName());\n+    RestartManager.queueRestart(\"Restart requested via /queuerestart command\", duration);\n \n     if (force && match.isRunning()) {\n       match.finish();\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1Mjc0Mg==", "url": "https://github.com/PGMDev/PGM/pull/517#discussion_r432952742", "bodyText": "I think this is over-verbosity on messages, we already have restart message.", "author": "Electroid", "createdAt": "2020-05-31T14:29:32Z", "path": "core/src/main/java/tc/oc/pgm/command/CancelCommand.java", "diffHunk": "@@ -18,11 +21,15 @@\n       aliases = {\"cancel\", \"cancelrestart\", \"cr\"},\n       desc = \"Cancels all countdowns\",\n       perms = Permissions.STOP)\n-  public void cancel(Audience audience, Match match) {\n+  public void cancel(Audience audience, CommandSender sender, Match match) {\n     if (RestartManager.isQueued()) {\n       match.callEvent(new CancelRestartEvent());\n       audience.sendMessage(\n           TranslatableComponent.of(\"admin.cancelRestart.restartUnqueued\", TextColor.RED));\n+      ChatDispatcher.broadcastAdminChatMessage(\n+          TranslatableComponent.of(\"admin.cancelRestart.broadcast\", TextColor.GRAY)\n+              .args(UsernameFormatUtils.formatStaffName(sender, match)),\n+          match);", "originalCommit": "5fcb62a4e4f1546ebcf8f29eb902d6aadaa100b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk2NTc3OA==", "url": "https://github.com/PGMDev/PGM/pull/517#discussion_r432965778", "bodyText": "Just to clarify, are you referring to the /queuerestart broadcast as well or should both be removed?\nUpdate: I removed the /cancelrestart broadcast, though the /queuerestart broadcast is still there. I believe it will be useful, however if you want it removed just say so.", "author": "applenick", "createdAt": "2020-05-31T17:08:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk1Mjc0Mg=="}], "type": "inlineReview", "revised_code": {"commit": "b9e9865db6b3dbfa01c49d2fffb95e1331f8c38d", "chunk": "diff --git a/core/src/main/java/tc/oc/pgm/command/CancelCommand.java b/core/src/main/java/tc/oc/pgm/command/CancelCommand.java\nindex 619c62c8..9f78e06f 100644\n--- a/core/src/main/java/tc/oc/pgm/command/CancelCommand.java\n+++ b/core/src/main/java/tc/oc/pgm/command/CancelCommand.java\n\n@@ -21,15 +18,11 @@ public final class CancelCommand {\n       aliases = {\"cancel\", \"cancelrestart\", \"cr\"},\n       desc = \"Cancels all countdowns\",\n       perms = Permissions.STOP)\n-  public void cancel(Audience audience, CommandSender sender, Match match) {\n+  public void cancel(Audience audience, Match match) {\n     if (RestartManager.isQueued()) {\n       match.callEvent(new CancelRestartEvent());\n       audience.sendMessage(\n           TranslatableComponent.of(\"admin.cancelRestart.restartUnqueued\", TextColor.RED));\n-      ChatDispatcher.broadcastAdminChatMessage(\n-          TranslatableComponent.of(\"admin.cancelRestart.broadcast\", TextColor.GRAY)\n-              .args(UsernameFormatUtils.formatStaffName(sender, match)),\n-          match);\n       return;\n     }\n \n"}}, {"oid": "b9e9865db6b3dbfa01c49d2fffb95e1331f8c38d", "url": "https://github.com/PGMDev/PGM/commit/b9e9865db6b3dbfa01c49d2fffb95e1331f8c38d", "message": "Add a match limit flag to /setpool command\n* Added staff broadcast to restart command\n* Provide mute reason in blocked chat messages\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T16:32:11Z", "type": "commit"}, {"oid": "b32800a6536e870012f4832fa9a23d3f77e88cdd", "url": "https://github.com/PGMDev/PGM/commit/b32800a6536e870012f4832fa9a23d3f77e88cdd", "message": "Add a broadcast to /cancelrestart\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T16:32:12Z", "type": "commit"}, {"oid": "7178b0970978fa3072bc573fc20466d04221fc42", "url": "https://github.com/PGMDev/PGM/commit/7178b0970978fa3072bc573fc20466d04221fc42", "message": "Improve /cancelrestart broadcast message\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T16:32:12Z", "type": "commit"}, {"oid": "e7d2392d2cf88ad3a323eceff9510daf6b283ef8", "url": "https://github.com/PGMDev/PGM/commit/e7d2392d2cf88ad3a323eceff9510daf6b283ef8", "message": "Remove restart source and /cancelrestart\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T16:32:13Z", "type": "commit"}, {"oid": "b034761055f4fcb4b84cbdf40c6342134c4666f7", "url": "https://github.com/PGMDev/PGM/commit/b034761055f4fcb4b84cbdf40c6342134c4666f7", "message": "Remove restart broadcast and cleanup /setpool\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T18:40:04Z", "type": "commit"}, {"oid": "b034761055f4fcb4b84cbdf40c6342134c4666f7", "url": "https://github.com/PGMDev/PGM/commit/b034761055f4fcb4b84cbdf40c6342134c4666f7", "message": "Remove restart broadcast and cleanup /setpool\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T18:40:04Z", "type": "forcePushed"}, {"oid": "4b892ae13dce870aab89066837e54520d60e55c5", "url": "https://github.com/PGMDev/PGM/commit/4b892ae13dce870aab89066837e54520d60e55c5", "message": "Cleanup some unused parameters\n\nSigned-off-by: applenick <applenick@users.noreply.github.com>", "committedDate": "2020-06-09T19:26:48Z", "type": "commit"}]}