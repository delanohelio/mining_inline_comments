{"pr_number": 2301, "pr_title": "[ISSUE #2300] Enhancement: Benchmark support acl and msg trace", "pr_createdAt": "2020-09-15T08:41:25Z", "pr_url": "https://github.com/apache/rocketmq/pull/2301", "timeline": [{"oid": "7c9920684681897516bfefdb08d2552cb1875b0f", "url": "https://github.com/apache/rocketmq/commit/7c9920684681897516bfefdb08d2552cb1875b0f", "message": "[Benchmark]Support acl, add msgTraceEnable option for producer and consumer, fix Algorithm HmacSHA1 not available using openjdk", "committedDate": "2020-09-15T08:36:58Z", "type": "commit"}, {"oid": "b31aa7403b5587cb406f50beb514eafa3c6cb4ba", "url": "https://github.com/apache/rocketmq/commit/b31aa7403b5587cb406f50beb514eafa3c6cb4ba", "message": "add apache header", "committedDate": "2020-09-15T09:19:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE4NDkzOA==", "url": "https://github.com/apache/rocketmq/pull/2301#discussion_r489184938", "bodyText": "You need to maintain compatibility and let users choose whether to use ACL instead of forcing users to use ACL.", "author": "RongtongJin", "createdAt": "2020-09-16T06:07:56Z", "path": "example/src/main/java/org/apache/rocketmq/example/benchmark/Consumer.java", "diffHunk": "@@ -111,7 +113,7 @@ public void run() {\n             }\n         }, 10000, 10000);\n \n-        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(group);\n+        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(group, AclClient.getAclRPCHook(), new AllocateMessageQueueAveragely(), msgTraceEnable, null);", "originalCommit": "b31aa7403b5587cb406f50beb514eafa3c6cb4ba", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE5NzE2Mw==", "url": "https://github.com/apache/rocketmq/pull/2301#discussion_r489197163", "bodyText": "OK, I will fix it ASAP.", "author": "maixiaohai", "createdAt": "2020-09-16T06:38:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE4NDkzOA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTMxNTM1MA==", "url": "https://github.com/apache/rocketmq/pull/2301#discussion_r489315350", "bodyText": "@RongtongJin  I\u2018ve fixed it, pls review it~", "author": "maixiaohai", "createdAt": "2020-09-16T09:57:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTE4NDkzOA=="}], "type": "inlineReview", "revised_code": {"commit": "9105d620504d5e274d396675565e27598ddc34e7", "chunk": "diff --git a/example/src/main/java/org/apache/rocketmq/example/benchmark/Consumer.java b/example/src/main/java/org/apache/rocketmq/example/benchmark/Consumer.java\nindex 68ddf12e..c0a2a8b5 100644\n--- a/example/src/main/java/org/apache/rocketmq/example/benchmark/Consumer.java\n+++ b/example/src/main/java/org/apache/rocketmq/example/benchmark/Consumer.java\n\n@@ -113,7 +117,8 @@ public class Consumer {\n             }\n         }, 10000, 10000);\n \n-        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(group, AclClient.getAclRPCHook(), new AllocateMessageQueueAveragely(), msgTraceEnable, null);\n+        RPCHook rpcHook = aclEnable ? AclClient.getAclRPCHook() : null;\n+        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer(group, rpcHook, new AllocateMessageQueueAveragely(), msgTraceEnable, null);\n         if (commandLine.hasOption('n')) {\n             String ns = commandLine.getOptionValue('n');\n             consumer.setNamesrvAddr(ns);\n"}}, {"oid": "9105d620504d5e274d396675565e27598ddc34e7", "url": "https://github.com/apache/rocketmq/commit/9105d620504d5e274d396675565e27598ddc34e7", "message": "add aclEnable option", "committedDate": "2020-09-16T09:42:22Z", "type": "commit"}]}