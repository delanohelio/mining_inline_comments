{"pr_number": 2116, "pr_title": "[ISSUE #2067] Add logs when collecting disk space usage", "pr_createdAt": "2020-06-23T02:26:35Z", "pr_url": "https://github.com/apache/rocketmq/pull/2116", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDYzMDA0OA==", "url": "https://github.com/apache/rocketmq/pull/2116#discussion_r444630048", "bodyText": "It would be better to write as log.error(\"xxxxxxxxxxx\", e)", "author": "RongtongJin", "createdAt": "2020-06-24T03:55:00Z", "path": "common/src/main/java/org/apache/rocketmq/common/UtilAll.java", "diffHunk": "@@ -218,6 +224,8 @@ public static double getDiskPartitionSpaceUsedPercent(final String path) {\n                 return usedSpace / (double) totalSpace;\n             }\n         } catch (Exception e) {\n+            log.error(\"Error when measuring disk space usage, got exception: \");\n+            e.printStackTrace();\n             return -1;", "originalCommit": "b32dbc47ffcf613ed046a2be9b683e66fd186e0f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c3e29587eec1424ebf1ba7919b7c063fd93773c1", "chunk": "diff --git a/common/src/main/java/org/apache/rocketmq/common/UtilAll.java b/common/src/main/java/org/apache/rocketmq/common/UtilAll.java\nindex 289933d6..639a2009 100644\n--- a/common/src/main/java/org/apache/rocketmq/common/UtilAll.java\n+++ b/common/src/main/java/org/apache/rocketmq/common/UtilAll.java\n\n@@ -224,8 +224,7 @@ public class UtilAll {\n                 return usedSpace / (double) totalSpace;\n             }\n         } catch (Exception e) {\n-            log.error(\"Error when measuring disk space usage, got exception: \");\n-            e.printStackTrace();\n+            log.error(\"Error when measuring disk space usage, got exception: :\", e);\n             return -1;\n         }\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0NDYzMDM0OQ==", "url": "https://github.com/apache/rocketmq/pull/2116#discussion_r444630349", "bodyText": "It would be better to use placeholder instead of string concatenation.", "author": "RongtongJin", "createdAt": "2020-06-24T03:56:12Z", "path": "common/src/main/java/org/apache/rocketmq/common/UtilAll.java", "diffHunk": "@@ -200,14 +200,20 @@ public static String timeMillisToHumanString3(final long t) {\n     }\n \n     public static double getDiskPartitionSpaceUsedPercent(final String path) {\n-        if (null == path || path.isEmpty())\n+        if (null == path || path.isEmpty()) {\n+            log.error(\"Error when measuring disk space usage, path is null or empty, path :\" + path);\n             return -1;\n+        }\n+\n \n         try {\n             File file = new File(path);\n \n-            if (!file.exists())\n+            if (!file.exists()) {\n+                log.error(\"Error when measuring disk space usage, file doesn't exist on this path: \" + path);", "originalCommit": "b32dbc47ffcf613ed046a2be9b683e66fd186e0f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c3e29587eec1424ebf1ba7919b7c063fd93773c1", "chunk": "diff --git a/common/src/main/java/org/apache/rocketmq/common/UtilAll.java b/common/src/main/java/org/apache/rocketmq/common/UtilAll.java\nindex 289933d6..639a2009 100644\n--- a/common/src/main/java/org/apache/rocketmq/common/UtilAll.java\n+++ b/common/src/main/java/org/apache/rocketmq/common/UtilAll.java\n\n@@ -201,7 +201,7 @@ public class UtilAll {\n \n     public static double getDiskPartitionSpaceUsedPercent(final String path) {\n         if (null == path || path.isEmpty()) {\n-            log.error(\"Error when measuring disk space usage, path is null or empty, path :\" + path);\n+            log.error(\"Error when measuring disk space usage, path is null or empty, path : {}\", path);\n             return -1;\n         }\n \n"}}, {"oid": "c3e29587eec1424ebf1ba7919b7c063fd93773c1", "url": "https://github.com/apache/rocketmq/commit/c3e29587eec1424ebf1ba7919b7c063fd93773c1", "message": "feat:#2067 add logs when collecting disk spacE USAGE, this method should be more robust and should fail or throw exception", "committedDate": "2020-06-24T04:07:12Z", "type": "commit"}, {"oid": "c3e29587eec1424ebf1ba7919b7c063fd93773c1", "url": "https://github.com/apache/rocketmq/commit/c3e29587eec1424ebf1ba7919b7c063fd93773c1", "message": "feat:#2067 add logs when collecting disk spacE USAGE, this method should be more robust and should fail or throw exception", "committedDate": "2020-06-24T04:07:12Z", "type": "forcePushed"}]}