{"pr_number": 7495, "pr_title": "interop-testing: Avoid alts incompatibility with netty", "pr_createdAt": "2020-10-08T17:39:53Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7495", "timeline": [{"oid": "3d184afdf4e70c86536aff4975236923b3fcb007", "url": "https://github.com/grpc/grpc-java/commit/3d184afdf4e70c86536aff4975236923b3fcb007", "message": "interop-testing: Avoid alts incompatibility with netty\n\nalts requires netty-shaded, not netty.", "committedDate": "2020-10-08T17:39:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg5OTQzOQ==", "url": "https://github.com/grpc/grpc-java/pull/7495#discussion_r501899439", "bodyText": "Just checking - is the comment still relevant with this change?", "author": "sergiitk", "createdAt": "2020-10-08T17:42:47Z", "path": "interop-testing/src/main/java/io/grpc/testing/integration/TestServiceClient.java", "diffHunk": "@@ -396,9 +396,10 @@ private void runTest(TestCases testCase) throws Exception {\n   private class Tester extends AbstractInteropTest {\n     @Override\n     protected ManagedChannelBuilder<?> createChannelBuilder() {\n+      boolean useGeneric = false;\n       ChannelCredentials channelCredentials;\n       if (customCredentialsType != null) {\n-        useOkHttp = false; // Retain old behavior; avoids erroring if incompatible\n+        useGeneric = true; // Retain old behavior; avoids erroring if incompatible", "originalCommit": "3d184afdf4e70c86536aff4975236923b3fcb007", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMDQwOQ==", "url": "https://github.com/grpc/grpc-java/pull/7495#discussion_r501900409", "bodyText": "Yes. The useOkHttp = false was to enable Netty, to work with these credentials. But it enabled the wrong Netty and so failed at runtime. With this change we now enable the other (shaded) Netty to guarantee the credentials and channel type are compatible.", "author": "ejona86", "createdAt": "2020-10-08T17:44:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg5OTQzOQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTkwMTUwNw==", "url": "https://github.com/grpc/grpc-java/pull/7495#discussion_r501901507", "bodyText": "Thanks for the explanation.", "author": "sergiitk", "createdAt": "2020-10-08T17:46:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTg5OTQzOQ=="}], "type": "inlineReview", "revised_code": null}]}