{"pr_number": 7347, "pr_title": "xds: not to use insecure DSA crypto", "pr_createdAt": "2020-08-21T17:09:48Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7347", "timeline": [{"oid": "f8da86deba4e295f8aa5778878c89bf4272df292", "url": "https://github.com/grpc/grpc-java/commit/f8da86deba4e295f8aa5778878c89bf4272df292", "message": "xds: not to use insecure DSA crypto\n\nAlthough DSA is only used in tests so it's totally no security concern, it's annoying we need some workaround for internal checks to import. So removing the usage.", "committedDate": "2020-08-21T17:09:13Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyNDYzNw==", "url": "https://github.com/grpc/grpc-java/pull/7347#discussion_r474824637", "bodyText": "My suggestion was to only remove the \"DSA\" case if that was the offending line. So something like:\n    try {\n      return KeyFactory.getInstance(\"RSA\").generatePrivate(spec);\n    } catch (InvalidKeySpecException ignore) {\n      try {\n        return KeyFactory.getInstance(\"EC\").generatePrivate(spec);\n      } catch (InvalidKeySpecException ignore2) {\n       throw new InvalidKeySpecException(\"Neither RSA, nor EC worked\", e);\n      }\n    }\n\nBut if \"EC\" is also going to cause problems I am okay with this change. Could you confirm?", "author": "sanjaypujare", "createdAt": "2020-08-21T17:14:15Z", "path": "xds/src/test/java/io/grpc/xds/internal/certprovider/CommonCertProviderTestUtils.java", "diffHunk": "@@ -103,19 +103,7 @@ static PrivateKey getPrivateKey(String resourceName)\n     byte[] encodedKey = new byte[encodedKeyBuf.readableBytes()];\n     encodedKeyBuf.readBytes(encodedKey).release();\n     PKCS8EncodedKeySpec spec = new PKCS8EncodedKeySpec(encodedKey);\n-    try {\n-      return KeyFactory.getInstance(\"RSA\").generatePrivate(spec);\n-    } catch (InvalidKeySpecException ignore) {\n-      try {\n-        return KeyFactory.getInstance(\"DSA\").generatePrivate(spec);\n-      } catch (InvalidKeySpecException ignore2) {\n-        try {\n-          return KeyFactory.getInstance(\"EC\").generatePrivate(spec);\n-        } catch (InvalidKeySpecException e) {\n-          throw new InvalidKeySpecException(\"Neither RSA, DSA nor EC worked\", e);\n-        }\n-      }\n-    }\n+    return KeyFactory.getInstance(\"RSA\").generatePrivate(spec);", "originalCommit": "f8da86deba4e295f8aa5778878c89bf4272df292", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyNzQ2MQ==", "url": "https://github.com/grpc/grpc-java/pull/7347#discussion_r474827461", "bodyText": "EC is not disallowed. I also removed EC because you said \"it might be okay to remove both DSA and EC since none of the tests is using those AFAIK\" So we can delete unused code, if we do have EC case later we can add it back.", "author": "dapengzhang0", "createdAt": "2020-08-21T17:20:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyNDYzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyOTk1NA==", "url": "https://github.com/grpc/grpc-java/pull/7347#discussion_r474829954", "bodyText": "Yes, I remember saying that but I was thinking we just make the minimal change necessary to unblock the import. Anyway we can add \"EC\" back if we ever need it (doubtful).", "author": "sanjaypujare", "createdAt": "2020-08-21T17:25:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NDgyNDYzNw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "bf96f532becaa7cac9c3a8bff37bdd0e55734f3b", "url": "https://github.com/grpc/grpc-java/commit/bf96f532becaa7cac9c3a8bff37bdd0e55734f3b", "message": "remove unused import", "committedDate": "2020-08-21T17:30:16Z", "type": "commit"}]}