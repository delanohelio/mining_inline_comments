{"pr_number": 7424, "pr_title": "core: Inline AbstractManagedChannelImplBuilder", "pr_createdAt": "2020-09-14T22:41:46Z", "pr_url": "https://github.com/grpc/grpc-java/pull/7424", "timeline": [{"oid": "ae19c86c7ac6d6280ab876c9f73d6bbc63e4e57f", "url": "https://github.com/grpc/grpc-java/commit/ae19c86c7ac6d6280ab876c9f73d6bbc63e4e57f", "message": "core: Inline AbstractManagedChannelImplBuilder", "committedDate": "2020-09-15T18:52:39Z", "type": "forcePushed"}, {"oid": "1802defb9b22e420f9bb935e54e4d2518311a5a2", "url": "https://github.com/grpc/grpc-java/commit/1802defb9b22e420f9bb935e54e4d2518311a5a2", "message": "core: Inline AbstractManagedChannelImplBuilder", "committedDate": "2020-09-15T18:54:51Z", "type": "forcePushed"}, {"oid": "04d0ec3c8d52877e4e1e894799f992152d0ab711", "url": "https://github.com/grpc/grpc-java/commit/04d0ec3c8d52877e4e1e894799f992152d0ab711", "message": "temporary: return the old order to make the review easier", "committedDate": "2020-09-15T20:25:39Z", "type": "forcePushed"}, {"oid": "3024e3c8b5726cf2ebfba645e9abad48fb8ac4f0", "url": "https://github.com/grpc/grpc-java/commit/3024e3c8b5726cf2ebfba645e9abad48fb8ac4f0", "message": "temporary: return the old order to make the review easier", "committedDate": "2020-09-15T20:29:28Z", "type": "forcePushed"}, {"oid": "75cccde21fd8f45fd52c62a5bb014a44a725e58b", "url": "https://github.com/grpc/grpc-java/commit/75cccde21fd8f45fd52c62a5bb014a44a725e58b", "message": "core: Inline AbstractManagedChannelImplBuilder", "committedDate": "2020-09-15T21:56:27Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUxNjA0MQ==", "url": "https://github.com/grpc/grpc-java/pull/7424#discussion_r489516041", "bodyText": "Use UnsupportedClientTransportFactoryBuilder directly?", "author": "ejona86", "createdAt": "2020-09-16T15:12:10Z", "path": "core/src/main/java/io/grpc/internal/ManagedChannelImpl.java", "diffHunk": "@@ -1446,28 +1449,30 @@ public void run() {\n     @Override\n     public ManagedChannelBuilder<?> createResolvingOobChannelBuilder(String target) {\n       final class ResolvingOobChannelBuilder\n-          extends AbstractManagedChannelImplBuilder<ResolvingOobChannelBuilder> {\n-        int defaultPort = -1;\n+          extends ForwardingChannelBuilder<ResolvingOobChannelBuilder> {\n+        private final ManagedChannelImplBuilder managedChannelImplBuilder;\n \n         ResolvingOobChannelBuilder(String target) {\n-          super(target);\n+          final class ResolvingOobUnsupportedClientTransportFactoryBuilder extends\n+              UnsupportedClientTransportFactoryBuilder {}\n+\n+          managedChannelImplBuilder = new ManagedChannelImplBuilder(target,\n+              new ResolvingOobUnsupportedClientTransportFactoryBuilder(),", "originalCommit": "a944c59c8f76f260ab9cb2163de4960dec96c1b6", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUzOTAxNA==", "url": "https://github.com/grpc/grpc-java/pull/7424#discussion_r489539014", "bodyText": "The idea was to make it explicit in stack traces. Is it unnecessary?", "author": "sergiitk", "createdAt": "2020-09-16T15:42:57Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUxNjA0MQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTU3MzYxNw==", "url": "https://github.com/grpc/grpc-java/pull/7424#discussion_r489573617", "bodyText": "Since it should never be used, that seems of limited value, also because it seems it would be easy to debug as the OOB channel is used in very different circumstances.", "author": "ejona86", "createdAt": "2020-09-16T16:36:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTUxNjA0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "c1d6a09261805bb568fbe076fdb04bcbeeb60cb4", "chunk": "diff --git a/core/src/main/java/io/grpc/internal/ManagedChannelImpl.java b/core/src/main/java/io/grpc/internal/ManagedChannelImpl.java\nindex c629bf0bd..d2bc87cdd 100644\n--- a/core/src/main/java/io/grpc/internal/ManagedChannelImpl.java\n+++ b/core/src/main/java/io/grpc/internal/ManagedChannelImpl.java\n\n@@ -1453,11 +1453,8 @@ final class ManagedChannelImpl extends ManagedChannel implements\n         private final ManagedChannelImplBuilder managedChannelImplBuilder;\n \n         ResolvingOobChannelBuilder(String target) {\n-          final class ResolvingOobUnsupportedClientTransportFactoryBuilder extends\n-              UnsupportedClientTransportFactoryBuilder {}\n-\n           managedChannelImplBuilder = new ManagedChannelImplBuilder(target,\n-              new ResolvingOobUnsupportedClientTransportFactoryBuilder(),\n+              new UnsupportedClientTransportFactoryBuilder(),\n               new FixedPortProvider(nameResolverArgs.getDefaultPort()));\n           managedChannelImplBuilder.executorPool = executorPool;\n           managedChannelImplBuilder.offloadExecutorPool = offloadExecutorHolder.pool;\n"}}, {"oid": "c1d6a09261805bb568fbe076fdb04bcbeeb60cb4", "url": "https://github.com/grpc/grpc-java/commit/c1d6a09261805bb568fbe076fdb04bcbeeb60cb4", "message": "core: Inline AbstractManagedChannelImplBuilder", "committedDate": "2020-09-18T19:18:18Z", "type": "commit"}, {"oid": "c1d6a09261805bb568fbe076fdb04bcbeeb60cb4", "url": "https://github.com/grpc/grpc-java/commit/c1d6a09261805bb568fbe076fdb04bcbeeb60cb4", "message": "core: Inline AbstractManagedChannelImplBuilder", "committedDate": "2020-09-18T19:18:18Z", "type": "forcePushed"}, {"oid": "51359b8b52025c9d722dfafb7e6469b753d93078", "url": "https://github.com/grpc/grpc-java/commit/51359b8b52025c9d722dfafb7e6469b753d93078", "message": "fixup! Fix Python habits", "committedDate": "2020-09-18T22:03:40Z", "type": "commit"}]}