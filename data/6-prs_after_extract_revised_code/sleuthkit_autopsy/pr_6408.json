{"pr_number": 6408, "pr_title": "6774 6780 downloads and cache discovery details viewer", "pr_createdAt": "2020-10-23T16:33:07Z", "pr_url": "https://github.com/sleuthkit/autopsy/pull/6408", "timeline": [{"oid": "421b5972977784d5420cd76ae667bb997ef23e14", "url": "https://github.com/sleuthkit/autopsy/commit/421b5972977784d5420cd76ae667bb997ef23e14", "message": "6774 add content viewer artifact details area for downloads and cache artifacts", "committedDate": "2020-10-23T14:48:23Z", "type": "commit"}, {"oid": "bd3ea83ada6308647ea89440863a5b3226959e6b", "url": "https://github.com/sleuthkit/autopsy/commit/bd3ea83ada6308647ea89440863a5b3226959e6b", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-23T16:31:59Z", "type": "commit"}, {"oid": "676529684c34cf3f8454cdb1a239ed690093b2f8", "url": "https://github.com/sleuthkit/autopsy/commit/676529684c34cf3f8454cdb1a239ed690093b2f8", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-23T19:02:48Z", "type": "commit"}, {"oid": "1ad5703dab22866c8274a7ede92a5e03d066311b", "url": "https://github.com/sleuthkit/autopsy/commit/1ad5703dab22866c8274a7ede92a5e03d066311b", "message": "6774 change downloads and cache to have file name in title column instead of url", "committedDate": "2020-10-23T19:21:45Z", "type": "commit"}, {"oid": "50d28ecd3fbf5632310b05e5ef63a5fe548585ea", "url": "https://github.com/sleuthkit/autopsy/commit/50d28ecd3fbf5632310b05e5ef63a5fe548585ea", "message": "6774 toggle sort order", "committedDate": "2020-10-23T19:27:42Z", "type": "commit"}, {"oid": "98f30bfc72e4cdd226f993c60992df6425d2f015", "url": "https://github.com/sleuthkit/autopsy/commit/98f30bfc72e4cdd226f993c60992df6425d2f015", "message": "6774 convert row index to model", "committedDate": "2020-10-23T19:42:46Z", "type": "commit"}, {"oid": "5d71dee1556122bfa0e94db23fa11142b4b8a4d6", "url": "https://github.com/sleuthkit/autopsy/commit/5d71dee1556122bfa0e94db23fa11142b4b8a4d6", "message": "6774 fix indexing for getting artifact", "committedDate": "2020-10-23T20:29:13Z", "type": "commit"}, {"oid": "52c0dbfe3060c5ba8074d72c1dd54c5de280eeb6", "url": "https://github.com/sleuthkit/autopsy/commit/52c0dbfe3060c5ba8074d72c1dd54c5de280eeb6", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-23T20:32:25Z", "type": "commit"}, {"oid": "34850bf7596693992e44219512c762f7a9fc0e36", "url": "https://github.com/sleuthkit/autopsy/commit/34850bf7596693992e44219512c762f7a9fc0e36", "message": "6774 remove unused code", "committedDate": "2020-10-23T20:33:21Z", "type": "commit"}, {"oid": "1192967b6065725de3c5ac6e4486905a1aee0d51", "url": "https://github.com/sleuthkit/autopsy/commit/1192967b6065725de3c5ac6e4486905a1aee0d51", "message": "6774 resolve merge conflicts", "committedDate": "2020-10-26T12:35:09Z", "type": "commit"}, {"oid": "fd7c802c46cae56a6b6842946f9f7958a3d593d6", "url": "https://github.com/sleuthkit/autopsy/commit/fd7c802c46cae56a6b6842946f9f7958a3d593d6", "message": "6774 address feedback regarding mime type display", "committedDate": "2020-10-26T14:28:45Z", "type": "commit"}, {"oid": "2192288b09e3bc9e35323b1819a74e01b0eef672", "url": "https://github.com/sleuthkit/autopsy/commit/2192288b09e3bc9e35323b1819a74e01b0eef672", "message": "6774 fix fields for download and cache in table", "committedDate": "2020-10-26T16:38:28Z", "type": "commit"}, {"oid": "f892a2d2e74f9df2fed7532f3fff5a1a4df5bbe7", "url": "https://github.com/sleuthkit/autopsy/commit/f892a2d2e74f9df2fed7532f3fff5a1a4df5bbe7", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-26T18:00:20Z", "type": "commit"}, {"oid": "75acecd2dfdc931b9aad744c7d2422e7f72c947d", "url": "https://github.com/sleuthkit/autopsy/commit/75acecd2dfdc931b9aad744c7d2422e7f72c947d", "message": "6774 remove print lines", "committedDate": "2020-10-26T18:02:04Z", "type": "commit"}, {"oid": "18546e6a8897dcc374c004bfa8b6879f64bfce65", "url": "https://github.com/sleuthkit/autopsy/commit/18546e6a8897dcc374c004bfa8b6879f64bfce65", "message": "6774 update name column for TSK_WEB_CACHE in discovery", "committedDate": "2020-10-26T18:09:31Z", "type": "commit"}, {"oid": "38f804e504f3166d1ce1f1d5c09e8c9cb3cdf5c5", "url": "https://github.com/sleuthkit/autopsy/commit/38f804e504f3166d1ce1f1d5c09e8c9cb3cdf5c5", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-26T18:29:18Z", "type": "commit"}, {"oid": "7e54d3fa278b94ee5e4a8d8502fa4ee11ddaf864", "url": "https://github.com/sleuthkit/autopsy/commit/7e54d3fa278b94ee5e4a8d8502fa4ee11ddaf864", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-26T19:05:29Z", "type": "commit"}, {"oid": "aabea84939330481b58ae3b639d4a4f6ba63c30e", "url": "https://github.com/sleuthkit/autopsy/commit/aabea84939330481b58ae3b639d4a4f6ba63c30e", "message": "6774 fix file name", "committedDate": "2020-10-26T19:07:05Z", "type": "commit"}, {"oid": "cda0a04878f04aa074e29fdcb303a9962df0bec8", "url": "https://github.com/sleuthkit/autopsy/commit/cda0a04878f04aa074e29fdcb303a9962df0bec8", "message": "6774 use file for content viewers when artifact type is TSK_WEB_CACHE", "committedDate": "2020-10-26T20:40:51Z", "type": "commit"}, {"oid": "6b5443cc34deef7c20c0595fe18d0dc097a6c0ef", "url": "https://github.com/sleuthkit/autopsy/commit/6b5443cc34deef7c20c0595fe18d0dc097a6c0ef", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-26T20:42:19Z", "type": "commit"}, {"oid": "555c9037556af9e8f2e09cb0c8e7d53ed6e87497", "url": "https://github.com/sleuthkit/autopsy/commit/555c9037556af9e8f2e09cb0c8e7d53ed6e87497", "message": "6774 get content for lookup for downloads and caches based on path id", "committedDate": "2020-10-27T16:06:11Z", "type": "commit"}, {"oid": "2dd79d668cbd71cbcdc46f9a35fdac5b83bf6d87", "url": "https://github.com/sleuthkit/autopsy/commit/2dd79d668cbd71cbcdc46f9a35fdac5b83bf6d87", "message": "6774 remove changes for path id from discovery", "committedDate": "2020-10-27T16:47:19Z", "type": "commit"}, {"oid": "3d77c8d1eb57926f1cea0d58547d163a0cb39a3c", "url": "https://github.com/sleuthkit/autopsy/commit/3d77c8d1eb57926f1cea0d58547d163a0cb39a3c", "message": "Merge branch '6773-WebHistoryDiscoveryDetailsViewer' of https://github.com/wschaeferB/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-10-27T17:08:44Z", "type": "commit"}, {"oid": "71696390a094fe2f75a5e63f2a77e64ae6a7f20a", "url": "https://github.com/sleuthkit/autopsy/commit/71696390a094fe2f75a5e63f2a77e64ae6a7f20a", "message": "6774 attempt to address codacy issues", "committedDate": "2020-10-27T17:14:21Z", "type": "commit"}, {"oid": "634a2bbdbbcbf5c8e348400725abeb62ba586f9e", "url": "https://github.com/sleuthkit/autopsy/commit/634a2bbdbbcbf5c8e348400725abeb62ba586f9e", "message": "6774 fix assignment to static variable in constructor", "committedDate": "2020-10-27T17:23:11Z", "type": "commit"}, {"oid": "b198b9e31afb89346765433a7041e5b90b63041c", "url": "https://github.com/sleuthkit/autopsy/commit/b198b9e31afb89346765433a7041e5b90b63041c", "message": "6774 attempt to lower cyclomatic complexity", "committedDate": "2020-10-27T17:43:04Z", "type": "commit"}, {"oid": "f45f4e72c9517ad4752124c91ec97c1a50253eb0", "url": "https://github.com/sleuthkit/autopsy/commit/f45f4e72c9517ad4752124c91ec97c1a50253eb0", "message": "6774 attempt to lower cyclomatic complexity", "committedDate": "2020-10-27T17:54:03Z", "type": "commit"}, {"oid": "c050f52087c3b8faab904876478c22683e7a977a", "url": "https://github.com/sleuthkit/autopsy/commit/c050f52087c3b8faab904876478c22683e7a977a", "message": "6774 attempt to lower cyclomatic complexity", "committedDate": "2020-10-27T18:04:54Z", "type": "commit"}, {"oid": "f773075767b3404ddd1d10127b1997c97c8c943a", "url": "https://github.com/sleuthkit/autopsy/commit/f773075767b3404ddd1d10127b1997c97c8c943a", "message": "6774 attempt to lower cyclomatic complexity", "committedDate": "2020-10-27T18:13:49Z", "type": "commit"}, {"oid": "69635cbe7327f91d15aa4b951411340a6d1b23fc", "url": "https://github.com/sleuthkit/autopsy/commit/69635cbe7327f91d15aa4b951411340a6d1b23fc", "message": "6774 fix resultsviewer priority and source for cache and downloads", "committedDate": "2020-11-03T18:48:08Z", "type": "commit"}, {"oid": "6d5389b9ec4cd235e423da51e9a99ffa71fde691", "url": "https://github.com/sleuthkit/autopsy/commit/6d5389b9ec4cd235e423da51e9a99ffa71fde691", "message": "6774 resolve merge conflicts", "committedDate": "2020-11-05T20:42:10Z", "type": "commit"}, {"oid": "d61550c76319254a66d0878cf4131ef42659048b", "url": "https://github.com/sleuthkit/autopsy/commit/d61550c76319254a66d0878cf4131ef42659048b", "message": "6774 fix merge conflict", "committedDate": "2020-11-05T20:45:52Z", "type": "commit"}, {"oid": "74d64056663efd4cfde89d86fe675c43ad98fe8a", "url": "https://github.com/sleuthkit/autopsy/commit/74d64056663efd4cfde89d86fe675c43ad98fe8a", "message": "6774 fix merge conflict", "committedDate": "2020-11-05T20:53:15Z", "type": "commit"}, {"oid": "087d91d3f8ab5510d719f891fb5bb26d530728eb", "url": "https://github.com/sleuthkit/autopsy/commit/087d91d3f8ab5510d719f891fb5bb26d530728eb", "message": "6774 fix error resolving merge conflict", "committedDate": "2020-11-05T21:11:15Z", "type": "commit"}, {"oid": "7038bd9f73d249a6b6c02d5d6245e798d069eb8f", "url": "https://github.com/sleuthkit/autopsy/commit/7038bd9f73d249a6b6c02d5d6245e798d069eb8f", "message": "6774 fix saving of perviously selected tab", "committedDate": "2020-11-05T21:24:07Z", "type": "commit"}, {"oid": "efb1e9f62ffe14c016340071177f7112038dfe7c", "url": "https://github.com/sleuthkit/autopsy/commit/efb1e9f62ffe14c016340071177f7112038dfe7c", "message": "Merge branch 'develop' of https://github.com/sleuthkit/autopsy into 6774-DownloadsDiscoveryDetailsViewer", "committedDate": "2020-11-13T14:17:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzExMDA5Mw==", "url": "https://github.com/sleuthkit/autopsy/pull/6408#discussion_r523110093", "bodyText": "\"which content\" => \"for which content\"", "author": "rcordovano", "createdAt": "2020-11-13T17:29:27Z", "path": "Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java", "diffHunk": "@@ -284,17 +284,50 @@ public BlackboardArtifactNode(BlackboardArtifact artifact) {\n      */\n     private static Lookup createLookup(BlackboardArtifact artifact) {\n         final long objectID = artifact.getObjectID();\n+        Content content = null;\n         try {\n-            Content content = contentCache.get(objectID, () -> artifact.getSleuthkitCase().getContentById(objectID));\n+            if (artifact.getArtifactTypeID() == BlackboardArtifact.ARTIFACT_TYPE.TSK_WEB_DOWNLOAD.getTypeID() || artifact.getArtifactTypeID() == BlackboardArtifact.ARTIFACT_TYPE.TSK_WEB_CACHE.getTypeID()) {\n+                content = getPathIdFile(artifact);\n+            }\n             if (content == null) {\n-                return Lookups.fixed(artifact);\n-            } else {\n-                return Lookups.fixed(artifact, content);\n+                content = contentCache.get(objectID, () -> artifact.getSleuthkitCase().getContentById(objectID));\n             }\n         } catch (ExecutionException ex) {\n             logger.log(Level.SEVERE, MessageFormat.format(\"Error getting source content (artifact objID={0}\", artifact.getId()), ex); //NON-NLS\n+            content = null;\n+        }\n+        if (content == null) {\n             return Lookups.fixed(artifact);\n+        } else {\n+            return Lookups.fixed(artifact, content);\n+        }\n+\n+    }\n+\n+    /**\n+     * Private helper method to allow content specified in a path id attribute\n+     * to be retrieved.\n+     *\n+     * @param artifact The artifact which content may be specified as a tsk path", "originalCommit": "efb1e9f62ffe14c016340071177f7112038dfe7c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEzMDc4Mw==", "url": "https://github.com/sleuthkit/autopsy/pull/6408#discussion_r523130783", "bodyText": "Thank you.", "author": "wschaeferB", "createdAt": "2020-11-13T18:03:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzExMDA5Mw=="}], "type": "inlineReview", "revised_code": {"commit": "8457cecff7919051b741fc1e4ed778a4d6452987", "chunk": "diff --git a/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java b/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java\nindex 51e9991eb0..34a6859292 100644\n--- a/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java\n+++ b/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java\n\n@@ -308,8 +308,8 @@ private static Lookup createLookup(BlackboardArtifact artifact) {\n      * Private helper method to allow content specified in a path id attribute\n      * to be retrieved.\n      *\n-     * @param artifact The artifact which content may be specified as a tsk path\n-     *                 attribute.\n+     * @param artifact The artifact for which content may be specified as a tsk\n+     *                 path attribute.\n      *\n      * @return The Content specified by the artifact's path id attribute or null\n      *         if there was no content available.\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzExNTcxNw==", "url": "https://github.com/sleuthkit/autopsy/pull/6408#discussion_r523115717", "bodyText": "I think that we can simplify this code slightly by taking advantage of this BlackboardArtifact method:\nBlackboardAttribute getAttribute(BlackboardAttribute.Type attributeType).", "author": "rcordovano", "createdAt": "2020-11-13T17:36:00Z", "path": "Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java", "diffHunk": "@@ -284,17 +284,50 @@ public BlackboardArtifactNode(BlackboardArtifact artifact) {\n      */\n     private static Lookup createLookup(BlackboardArtifact artifact) {\n         final long objectID = artifact.getObjectID();\n+        Content content = null;\n         try {\n-            Content content = contentCache.get(objectID, () -> artifact.getSleuthkitCase().getContentById(objectID));\n+            if (artifact.getArtifactTypeID() == BlackboardArtifact.ARTIFACT_TYPE.TSK_WEB_DOWNLOAD.getTypeID() || artifact.getArtifactTypeID() == BlackboardArtifact.ARTIFACT_TYPE.TSK_WEB_CACHE.getTypeID()) {\n+                content = getPathIdFile(artifact);\n+            }\n             if (content == null) {\n-                return Lookups.fixed(artifact);\n-            } else {\n-                return Lookups.fixed(artifact, content);\n+                content = contentCache.get(objectID, () -> artifact.getSleuthkitCase().getContentById(objectID));\n             }\n         } catch (ExecutionException ex) {\n             logger.log(Level.SEVERE, MessageFormat.format(\"Error getting source content (artifact objID={0}\", artifact.getId()), ex); //NON-NLS\n+            content = null;\n+        }\n+        if (content == null) {\n             return Lookups.fixed(artifact);\n+        } else {\n+            return Lookups.fixed(artifact, content);\n+        }\n+\n+    }\n+\n+    /**\n+     * Private helper method to allow content specified in a path id attribute\n+     * to be retrieved.\n+     *\n+     * @param artifact The artifact which content may be specified as a tsk path\n+     *                 attribute.\n+     *\n+     * @return The Content specified by the artifact's path id attribute or null\n+     *         if there was no content available.\n+     *\n+     * @throws ExecutionException Error retrieving the file specified by the\n+     *                            path id from the cache.\n+     */\n+    private static Content getPathIdFile(BlackboardArtifact artifact) throws ExecutionException {\n+        try {\n+            for (BlackboardAttribute attribute : artifact.getAttributes()) {\n+                if (attribute.getAttributeType().getTypeID() == BlackboardAttribute.ATTRIBUTE_TYPE.TSK_PATH_ID.getTypeID()) {\n+                    return contentCache.get(attribute.getValueLong(), () -> artifact.getSleuthkitCase().getContentById(attribute.getValueLong()));\n+                }\n+            }\n+        } catch (TskCoreException ex) {\n+            logger.log(Level.WARNING, MessageFormat.format(\"Error getting content for path id attrbiute for artifact: \", artifact.getId()), ex); //NON-NLS", "originalCommit": "efb1e9f62ffe14c016340071177f7112038dfe7c", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzEzMTA4MA==", "url": "https://github.com/sleuthkit/autopsy/pull/6408#discussion_r523131080", "bodyText": "Good catch. Thank you.", "author": "wschaeferB", "createdAt": "2020-11-13T18:04:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzExNTcxNw=="}], "type": "inlineReview", "revised_code": {"commit": "8457cecff7919051b741fc1e4ed778a4d6452987", "chunk": "diff --git a/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java b/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java\nindex 51e9991eb0..34a6859292 100644\n--- a/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java\n+++ b/Core/src/org/sleuthkit/autopsy/datamodel/BlackboardArtifactNode.java\n\n@@ -308,8 +308,8 @@ private static Lookup createLookup(BlackboardArtifact artifact) {\n      * Private helper method to allow content specified in a path id attribute\n      * to be retrieved.\n      *\n-     * @param artifact The artifact which content may be specified as a tsk path\n-     *                 attribute.\n+     * @param artifact The artifact for which content may be specified as a tsk\n+     *                 path attribute.\n      *\n      * @return The Content specified by the artifact's path id attribute or null\n      *         if there was no content available.\n"}}, {"oid": "8457cecff7919051b741fc1e4ed778a4d6452987", "url": "https://github.com/sleuthkit/autopsy/commit/8457cecff7919051b741fc1e4ed778a4d6452987", "message": "6774 simplify getPathIdFile code and fix comment", "committedDate": "2020-11-13T18:02:00Z", "type": "commit"}]}