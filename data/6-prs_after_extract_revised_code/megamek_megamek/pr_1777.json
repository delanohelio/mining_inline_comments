{"pr_number": 1777, "pr_title": "Add save game prompt when closing MM via Window \"X\"", "pr_createdAt": "2020-03-19T16:00:13Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1777", "timeline": [{"oid": "1d0e2a0955a144ffc1804d789af4af18c33c7c94", "url": "https://github.com/MegaMek/megamek/commit/1d0e2a0955a144ffc1804d789af4af18c33c7c94", "message": "Add save game prompt when closing MM via X", "committedDate": "2020-03-19T15:36:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE5Njc4OA==", "url": "https://github.com/MegaMek/megamek/pull/1777#discussion_r395196788", "bodyText": "Maybe \"before quitting MegaMek\"?", "author": "NickAragua", "createdAt": "2020-03-19T17:26:00Z", "path": "megamek/src/megamek/client/ui/swing/ClientGUI.java", "diffHunk": "@@ -460,12 +461,29 @@ public void initialize() {\n \n         layoutFrame();\n         menuBar.addActionListener(this);\n+        frame.setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);\n         frame.addWindowListener(new WindowAdapter() {\n             @Override\n             public void windowClosing(WindowEvent e) {\n-                frame.setVisible(false);\n-                saveSettings();\n-                die();\n+                ignoreHotKeys = true;\n+                int savePrompt = JOptionPane.showConfirmDialog(null,\n+                        \"Do you want to save the game before quitting MekHQ?\",", "originalCommit": "1d0e2a0955a144ffc1804d789af4af18c33c7c94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIyOTUxMw==", "url": "https://github.com/MegaMek/megamek/pull/1777#discussion_r395229513", "bodyText": "Ah, now everyone knows I just copied it from MekHQ... ok changed it and changed the icon to a warning icon.", "author": "SJuliez", "createdAt": "2020-03-19T18:18:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE5Njc4OA=="}], "type": "inlineReview", "revised_code": {"commit": "ab6b80f18e87f86070be7b30586a4c9b0f5f76c4", "chunk": "diff --git a/megamek/src/megamek/client/ui/swing/ClientGUI.java b/megamek/src/megamek/client/ui/swing/ClientGUI.java\nindex 92eb00eb86..9ac8eb8c38 100644\n--- a/megamek/src/megamek/client/ui/swing/ClientGUI.java\n+++ b/megamek/src/megamek/client/ui/swing/ClientGUI.java\n\n@@ -467,10 +467,10 @@ public class ClientGUI extends JPanel implements WindowListener, BoardViewListen\n             public void windowClosing(WindowEvent e) {\n                 ignoreHotKeys = true;\n                 int savePrompt = JOptionPane.showConfirmDialog(null,\n-                        \"Do you want to save the game before quitting MekHQ?\",\n-                        \"Save?\",\n+                        \"Do you want to save the game before quitting MegaMek?\",\n+                        \"Save First?\",\n                         JOptionPane.YES_NO_CANCEL_OPTION,\n-                        JOptionPane.QUESTION_MESSAGE);\n+                        JOptionPane.WARNING_MESSAGE);\n                 ignoreHotKeys = false;\n                 if (savePrompt == JOptionPane.YES_OPTION) {\n                     if (!saveGame()) {\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE5NzI4MA==", "url": "https://github.com/MegaMek/megamek/pull/1777#discussion_r395197280", "bodyText": "I'm surprised we don't already have a save game dialog.", "author": "NickAragua", "createdAt": "2020-03-19T17:26:45Z", "path": "megamek/src/megamek/client/ui/swing/ClientGUI.java", "diffHunk": "@@ -1641,6 +1641,30 @@ public void deleteAllUnits(Client c) {\n         }\n         c.sendDeleteEntities(ids);\n     }\n+    \n+    private boolean saveGame() {", "originalCommit": "1d0e2a0955a144ffc1804d789af4af18c33c7c94", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTIyOTA0Mg==", "url": "https://github.com/MegaMek/megamek/pull/1777#discussion_r395229042", "bodyText": "Couldn't find a class for it. The menu bar command also routes to ClientGUI. I just moved it to its own method because I needed it twice.", "author": "SJuliez", "createdAt": "2020-03-19T18:18:08Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NTE5NzI4MA=="}], "type": "inlineReview", "revised_code": null}, {"oid": "ab6b80f18e87f86070be7b30586a4c9b0f5f76c4", "url": "https://github.com/MegaMek/megamek/commit/ab6b80f18e87f86070be7b30586a4c9b0f5f76c4", "message": "Small dialog change", "committedDate": "2020-03-19T18:14:31Z", "type": "commit"}]}