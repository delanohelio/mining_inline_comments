{"pr_number": 1591, "pr_title": "Ba mines", "pr_createdAt": "2020-01-10T20:41:53Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1591", "timeline": [{"oid": "3abf6549567a8392e479a21268609fe6e0549665", "url": "https://github.com/MegaMek/megamek/commit/3abf6549567a8392e479a21268609fe6e0549665", "message": "Switch BA to jump mode when starting a turn laying a mine.", "committedDate": "2020-01-10T20:12:23Z", "type": "commit"}, {"oid": "ebb307fdc298c1a85bd872692c0cabe364bda5d3", "url": "https://github.com/MegaMek/megamek/commit/ebb307fdc298c1a85bd872692c0cabe364bda5d3", "message": "Disable \"Lay Mine\" button for BA that has used walking movement.", "committedDate": "2020-01-10T20:34:03Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQyMjY3OA==", "url": "https://github.com/MegaMek/megamek/pull/1591#discussion_r365422678", "bodyText": "This looks like, if the current entity can't lay a mine and isn't battle armor, the lay mine button will become enabled. Maybe you want a return after line 2946?", "author": "apokrovski", "createdAt": "2020-01-10T20:43:47Z", "path": "megamek/src/megamek/client/ui/swing/MovementDisplay.java", "diffHunk": "@@ -2934,6 +2936,24 @@ private synchronized void updateLoadButtons() {\n         } // End ce-hasn't-moved\n     } // private void updateLoadButtons\n \n+    private void updateLayMineButton() {\n+        final Entity ce = ce();\n+        if (null == ce) {\n+            return;\n+        }\n+\n+        if (!ce.canLayMine()) {\n+            setLayMineEnabled(false);\n+        }\n+        if (ce instanceof BattleArmor) {\n+            setLayMineEnabled(cmd.getLastStep() == null\n+                || cmd.isJumping()\n+                || cmd.getLastStepMovementType().equals(EntityMovementType.MOVE_VTOL_WALK));\n+        } else {", "originalCommit": "ebb307fdc298c1a85bd872692c0cabe364bda5d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQyNDEwMw==", "url": "https://github.com/MegaMek/megamek/pull/1591#discussion_r365424103", "bodyText": "Yup", "author": "neoancient", "createdAt": "2020-01-10T20:48:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NTQyMjY3OA=="}], "type": "inlineReview", "revised_code": {"commit": "6ad61b796245c9b3089e6571f022e3e156399611", "chunk": "diff --git a/megamek/src/megamek/client/ui/swing/MovementDisplay.java b/megamek/src/megamek/client/ui/swing/MovementDisplay.java\nindex c01362dfc4..79ded7f9f3 100644\n--- a/megamek/src/megamek/client/ui/swing/MovementDisplay.java\n+++ b/megamek/src/megamek/client/ui/swing/MovementDisplay.java\n\n@@ -2944,8 +2944,7 @@ public class MovementDisplay extends StatusBarPhaseDisplay {\n \n         if (!ce.canLayMine()) {\n             setLayMineEnabled(false);\n-        }\n-        if (ce instanceof BattleArmor) {\n+        } else if (ce instanceof BattleArmor) {\n             setLayMineEnabled(cmd.getLastStep() == null\n                 || cmd.isJumping()\n                 || cmd.getLastStepMovementType().equals(EntityMovementType.MOVE_VTOL_WALK));\n"}}, {"oid": "6ad61b796245c9b3089e6571f022e3e156399611", "url": "https://github.com/MegaMek/megamek/commit/6ad61b796245c9b3089e6571f022e3e156399611", "message": "Fixed lay mine button enabling.", "committedDate": "2020-01-10T20:49:12Z", "type": "commit"}, {"oid": "381305689e8080313658c65bc8392a8f66d2ec3c", "url": "https://github.com/MegaMek/megamek/commit/381305689e8080313658c65bc8392a8f66d2ec3c", "message": "Added a check for first step before declaring lay mine step illegal.\n\nNeeded for VTOL BA.", "committedDate": "2020-01-10T20:51:07Z", "type": "commit"}]}