{"pr_number": 1986, "pr_title": "Lobby: Allow saving quirks override for units reduced to no quirks", "pr_createdAt": "2020-06-02T21:19:15Z", "pr_url": "https://github.com/MegaMek/megamek/pull/1986", "timeline": [{"oid": "d1c14ce8043155dce0506753907276d02bce2107", "url": "https://github.com/MegaMek/megamek/commit/d1c14ce8043155dce0506753907276d02bce2107", "message": "Allow saving quirks override for units with no quirks", "committedDate": "2020-06-02T20:57:06Z", "type": "commit"}, {"oid": "1b3286852e7364e1b4c3d38bbeefc31923fe7490", "url": "https://github.com/MegaMek/megamek/commit/1b3286852e7364e1b4c3d38bbeefc31923fe7490", "message": "Revert unitQuirksOverride.xml to standard", "committedDate": "2020-06-02T21:16:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNjI5MQ==", "url": "https://github.com/MegaMek/megamek/pull/1986#discussion_r434206291", "bodyText": "I know this is a bit superfluous, but would this be best placed in an else statement for future readability?", "author": "Windchild292", "createdAt": "2020-06-02T22:18:40Z", "path": "megamek/src/megamek/common/QuirksHandler.java", "diffHunk": "@@ -446,6 +448,11 @@ public static void saveCustomQuirksList() throws IOException {\n \n                 // Write out quirks\n                 List<QuirkEntry> quirks = customQuirkMap.get(unitId);\n+                if (quirks.isEmpty()) {\n+                    output.write(\"\\t\\t\" + getOpenTag(QUIRK));\n+                    output.write(NO_QUIRKS);\n+                    output.write(getCloseTag(QUIRK) + \"\\n\");\n+                }\n                 for (QuirkEntry quirk : quirks) {", "originalCommit": "1b3286852e7364e1b4c3d38bbeefc31923fe7490", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDYxOTQwMQ==", "url": "https://github.com/MegaMek/megamek/pull/1986#discussion_r434619401", "bodyText": "Sounds right, yes", "author": "SJuliez", "createdAt": "2020-06-03T14:39:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDIwNjI5MQ=="}], "type": "inlineReview", "revised_code": {"commit": "909789f5dd3d996d6b9eed5865c2bc1d9afbdb55", "chunk": "diff --git a/megamek/src/megamek/common/QuirksHandler.java b/megamek/src/megamek/common/QuirksHandler.java\nindex 372afd822f..aea74d2400 100644\n--- a/megamek/src/megamek/common/QuirksHandler.java\n+++ b/megamek/src/megamek/common/QuirksHandler.java\n\n@@ -452,35 +452,36 @@ public class QuirksHandler {\n                     output.write(\"\\t\\t\" + getOpenTag(QUIRK));\n                     output.write(NO_QUIRKS);\n                     output.write(getCloseTag(QUIRK) + \"\\n\");\n-                }\n-                for (QuirkEntry quirk : quirks) {\n-                    // Write Weapon Quirk\n-                    if (quirk.isWeaponQuirk()) {\n-                        output.write(\"\\t\\t\" + getOpenTag(WEAPON_QUIRK) + \"\\n\");\n-                        // Quirk Name\n-                        output.write(\"\\t\\t\\t\" + getOpenTag(WEAPON_QUIRK_NAME));\n-                        output.write(quirk.getQuirk());\n-                        output.write(getCloseTag(WEAPON_QUIRK_NAME) + \"\\n\");\n-                        // Location\n-                        output.write(\"\\t\\t\\t\" + getOpenTag(LOCATION));\n-                        output.write(quirk.getLocation());\n-                        output.write(getCloseTag(LOCATION) + \"\\n\");\n-                        // Slot\n-                        output.write(\"\\t\\t\\t\" + getOpenTag(SLOT));\n-                        output.write(quirk.getSlot() + \"\");\n-                        output.write(getCloseTag(SLOT) + \"\\n\");\n-                        // Weapon Name\n-                        output.write(\"\\t\\t\\t\" + getOpenTag(WEAPON_NAME));\n-                        output.write(quirk.getWeaponName());\n-                        output.write(getCloseTag(WEAPON_NAME) + \"\\n\");\n-                        // Close Tag\n-                        output.write(\"\\t\\t\" + getCloseTag(WEAPON_QUIRK) + \"\\n\");\n-                    } else { // Write normal quirk\n-                        output.write(\"\\t\\t\" + getOpenTag(QUIRK));\n-                        output.write(quirk.getQuirk());\n-                        output.write(getCloseTag(QUIRK) + \"\\n\");\n-                    }\n-                }               \n+                } else {\n+                    for (QuirkEntry quirk : quirks) {\n+                        // Write Weapon Quirk\n+                        if (quirk.isWeaponQuirk()) {\n+                            output.write(\"\\t\\t\" + getOpenTag(WEAPON_QUIRK) + \"\\n\");\n+                            // Quirk Name\n+                            output.write(\"\\t\\t\\t\" + getOpenTag(WEAPON_QUIRK_NAME));\n+                            output.write(quirk.getQuirk());\n+                            output.write(getCloseTag(WEAPON_QUIRK_NAME) + \"\\n\");\n+                            // Location\n+                            output.write(\"\\t\\t\\t\" + getOpenTag(LOCATION));\n+                            output.write(quirk.getLocation());\n+                            output.write(getCloseTag(LOCATION) + \"\\n\");\n+                            // Slot\n+                            output.write(\"\\t\\t\\t\" + getOpenTag(SLOT));\n+                            output.write(quirk.getSlot() + \"\");\n+                            output.write(getCloseTag(SLOT) + \"\\n\");\n+                            // Weapon Name\n+                            output.write(\"\\t\\t\\t\" + getOpenTag(WEAPON_NAME));\n+                            output.write(quirk.getWeaponName());\n+                            output.write(getCloseTag(WEAPON_NAME) + \"\\n\");\n+                            // Close Tag\n+                            output.write(\"\\t\\t\" + getCloseTag(WEAPON_QUIRK) + \"\\n\");\n+                        } else { // Write normal quirk\n+                            output.write(\"\\t\\t\" + getOpenTag(QUIRK));\n+                            output.write(quirk.getQuirk());\n+                            output.write(getCloseTag(QUIRK) + \"\\n\");\n+                        }\n+                    }   \n+                }            \n                 output.write(\"\\t\" + getCloseTag(UNIT) + \"\\n\\n\");\n             }\n             \n"}}, {"oid": "909789f5dd3d996d6b9eed5865c2bc1d9afbdb55", "url": "https://github.com/MegaMek/megamek/commit/909789f5dd3d996d6b9eed5865c2bc1d9afbdb55", "message": "Small refactor", "committedDate": "2020-06-03T14:36:50Z", "type": "commit"}]}