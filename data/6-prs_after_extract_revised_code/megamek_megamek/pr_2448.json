{"pr_number": 2448, "pr_title": "2348: Game summary images", "pr_createdAt": "2020-11-29T01:17:10Z", "pr_url": "https://github.com/MegaMek/megamek/pull/2448", "timeline": [{"oid": "f565e85d0969aa43588828390ca088d449eb8601", "url": "https://github.com/MegaMek/megamek/commit/f565e85d0969aa43588828390ca088d449eb8601", "message": "Added UUID to Game\n\nThis will be used to uniquely identify a game, which in term will be used to\ndetermine where to save the summary images to.", "committedDate": "2016-12-04T20:08:19Z", "type": "commit"}, {"oid": "ac5ffe046d2bd698b472619ffad2f1ff9889ef30", "url": "https://github.com/MegaMek/megamek/commit/ac5ffe046d2bd698b472619ffad2f1ff9889ef30", "message": "Added GUIPrefs for BV and Minimap summary imgs\n\nThese will be what determine whether the summary images should be saved.", "committedDate": "2016-12-04T20:19:40Z", "type": "commit"}, {"oid": "b85347345eb6c9cd3088716b373e5f00f1b3f4f6", "url": "https://github.com/MegaMek/megamek/commit/b85347345eb6c9cd3088716b373e5f00f1b3f4f6", "message": "Fixed bug with List type in CommonSettignsDialog\n\nI had been trying to add elements to a List created with Arrays.asList, and\nit didn't work out so well.", "committedDate": "2016-12-04T20:36:36Z", "type": "commit"}, {"oid": "9a1ec57aecf4c90541b97053d64e8e62976c24dc", "url": "https://github.com/MegaMek/megamek/commit/9a1ec57aecf4c90541b97053d64e8e62976c24dc", "message": "Fix issue with how userdata tilesets are added\n\nWould cause NPEs if no tilesets were present in the userdata directory.", "committedDate": "2016-12-04T21:02:01Z", "type": "commit"}, {"oid": "39ce5e5e8a1e7badaf2fd8ef8a0230cbfb08a3c1", "url": "https://github.com/MegaMek/megamek/commit/39ce5e5e8a1e7badaf2fd8ef8a0230cbfb08a3c1", "message": "Configuration stores locs to game summary imgs", "committedDate": "2016-12-04T21:02:50Z", "type": "commit"}, {"oid": "a148fa9929f516b265e4694d0f2806bc3de508da", "url": "https://github.com/MegaMek/megamek/commit/a148fa9929f516b265e4694d0f2806bc3de508da", "message": "Added game summary img options to Client Settings", "committedDate": "2016-12-04T21:03:15Z", "type": "commit"}, {"oid": "369950127ee6fa420df8b91a1ea7cd42a71d3123", "url": "https://github.com/MegaMek/megamek/commit/369950127ee6fa420df8b91a1ea7cd42a71d3123", "message": "Added UUID accessor to interface", "committedDate": "2016-12-04T23:06:45Z", "type": "commit"}, {"oid": "70c45cfdce65f16c1f9d323f4b459d1b3906ea8c", "url": "https://github.com/MegaMek/megamek/commit/70c45cfdce65f16c1f9d323f4b459d1b3906ea8c", "message": "Generate new Game UUID when reset", "committedDate": "2016-12-04T23:07:03Z", "type": "commit"}, {"oid": "8ca301223e218c74f009258be0d0d2eb109aadc8", "url": "https://github.com/MegaMek/megamek/commit/8ca301223e218c74f009258be0d0d2eb109aadc8", "message": "Implement game summary images for minimap\n\nWhen the phase is changed from deployment, movement, firing, targeting or\nphysical, the current minimap image is saved to a file.", "committedDate": "2016-12-04T23:07:42Z", "type": "commit"}, {"oid": "8ea77af70f5bd5a64d5324e501d148181decd7ef", "url": "https://github.com/MegaMek/megamek/commit/8ea77af70f5bd5a64d5324e501d148181decd7ef", "message": "Implement game summary images for board view\n\nWhen the phase is changed from deployment, movement, firing, targeting or\nphysical, the current board image is saved to a file.", "committedDate": "2016-12-04T23:08:28Z", "type": "commit"}, {"oid": "67ea6c049d20528353979a01f7115558f10cac32", "url": "https://github.com/MegaMek/megamek/commit/67ea6c049d20528353979a01f7115558f10cac32", "message": "Merge branch 'post-stable' into gameSummaryImages", "committedDate": "2016-12-05T15:21:02Z", "type": "commit"}, {"oid": "c9504c0801c0ec5b36c77b43ea7fdf18a6b4c5e3", "url": "https://github.com/MegaMek/megamek/commit/c9504c0801c0ec5b36c77b43ea7fdf18a6b4c5e3", "message": "Merge branch 'master' into gameSummaryImages", "committedDate": "2017-03-26T15:40:25Z", "type": "commit"}, {"oid": "f1f9fa4c3951078528894ea07aa0ccbda2c300ca", "url": "https://github.com/MegaMek/megamek/commit/f1f9fa4c3951078528894ea07aa0ccbda2c300ca", "message": "Merge branch 'master' into gameSummaryImages", "committedDate": "2020-11-27T18:42:10Z", "type": "commit"}, {"oid": "ccac3efcc6ec82963b0de9d9ea9e1448ca102fd2", "url": "https://github.com/MegaMek/megamek/commit/ccac3efcc6ec82963b0de9d9ea9e1448ca102fd2", "message": "Added minimap game summary option\n\nLooks like this got removed during the latest merge with master.", "committedDate": "2020-11-27T20:12:25Z", "type": "commit"}, {"oid": "c206c7fbd6e98e4489a6796ff1b9161781a2e834", "url": "https://github.com/MegaMek/megamek/commit/c206c7fbd6e98e4489a6796ff1b9161781a2e834", "message": "Add phase name to summary image filename\n\nto make it easier for users to distinguish phases.  I left in the\nordinal so that files sort properly.  This should make it easier to\ncombine images into gifs or videos.", "committedDate": "2020-11-27T20:13:08Z", "type": "commit"}, {"oid": "86e81407fb5127063c7c7e72215356e6351bf61f", "url": "https://github.com/MegaMek/megamek/commit/86e81407fb5127063c7c7e72215356e6351bf61f", "message": "Update shadow map when creating board image\n\nI noticed some inconsistencies with shadows.  This makes\nIBoardView.getEntireBoardImage match IBoardView.paintComponents.", "committedDate": "2020-11-27T20:27:32Z", "type": "commit"}, {"oid": "27187c341388d78a7c752be0ed1768db5364f40a", "url": "https://github.com/MegaMek/megamek/commit/27187c341388d78a7c752be0ed1768db5364f40a", "message": "Set zoom to 1 before saving board image\n\nThis makes it consistent in terms of what gets saved, otherwise the\noutput image is dependent upon the current zoom level.", "committedDate": "2020-11-27T21:42:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzMzkwMA==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532133900", "bodyText": "Is this property related? It appears unused.", "author": "sixlettervariables", "createdAt": "2020-11-29T02:46:37Z", "path": "megamek/src/megamek/client/ui/swing/GUIPreferences.java", "diffHunk": "@@ -115,6 +115,9 @@\n     public static final String DISPLAY_POS_Y = \"DisplayPosY\";\n     public static final String DISPLAY_SIZE_HEIGHT = \"DisplaySizeHeight\";\n     public static final String DISPLAY_SIZE_WIDTH = \"DisplaySizeWidth\";\n+    public static final String GAME_SUMMARY_BOARD_VIEW = \"GameSummaryBoardView\";\n+    public static final String GAME_SUMMARY_MINI_MAP = \"GameSummaryMiniMap\";\n+    public static final String ENTITY_OWNER_LABEL_COLOR = \"EntityOwnerLabelColor\";", "originalCommit": "27187c341388d78a7c752be0ed1768db5364f40a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIzMTUwOA==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532231508", "bodyText": "ENTITY_OWNER_LABEL_COLOR comes from the merge: I assume it was a property that was added at line 118, the same line I added for the two properties related to game summary.  As far as I can tell, all three of those properties are referenced in the code.  I don't see anything in this addition that is unused.", "author": "arlith", "createdAt": "2020-11-29T16:17:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzMzkwMA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIzNDQzNw==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532234437", "bodyText": "Gotcha, weird that GH marked it as an addition!", "author": "sixlettervariables", "createdAt": "2020-11-29T16:40:51Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzMzkwMA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzMzkzNw==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532133937", "bodyText": "Whitespace is off starting here it looks.", "author": "sixlettervariables", "createdAt": "2020-11-29T02:47:09Z", "path": "megamek/src/megamek/client/ui/swing/boardview/BoardView1.java", "diffHunk": "@@ -2451,8 +2464,12 @@ public BufferedImage getEntireBoardImage(boolean ignoreUnits) {\n                 }\n             }\n         }\n-\n         boardGraph.dispose();\n+\n+        // Restore the zoom setting\n+        zoomIndex = oldZoom;\n+    \tzoom();", "originalCommit": "27187c341388d78a7c752be0ed1768db5364f40a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIzMjA4OA==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532232088", "bodyText": "My code formatter was improperly configured and it was inserting some tabs.  I saw this during the commit and I should've fixed it then.  I've fixed it now (there were a few other places too besides this one).", "author": "arlith", "createdAt": "2020-11-29T16:22:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzMzkzNw=="}], "type": "inlineReview", "revised_code": {"commit": "59ed4ae7dde4a0ef8a2d3247f4863966240937d6", "chunk": "diff --git a/megamek/src/megamek/client/ui/swing/boardview/BoardView1.java b/megamek/src/megamek/client/ui/swing/boardview/BoardView1.java\nindex e7fc8062de..6b7a0be823 100644\n--- a/megamek/src/megamek/client/ui/swing/boardview/BoardView1.java\n+++ b/megamek/src/megamek/client/ui/swing/boardview/BoardView1.java\n\n@@ -2468,7 +2468,7 @@ public class BoardView1 extends JPanel implements IBoardView, Scrollable,\n \n         // Restore the zoom setting\n         zoomIndex = oldZoom;\n-    \tzoom();\n+        zoom();\n \n         return (BufferedImage) entireBoard;\n     }\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzNDAwMg==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532134002", "bodyText": "Curious: when would uuid be null?", "author": "sixlettervariables", "createdAt": "2020-11-29T02:48:28Z", "path": "megamek/src/megamek/common/Game.java", "diffHunk": "@@ -3651,4 +3659,17 @@ private void checkPositionCacheConsistency() {\n         }\n     }\n \n+    /**\n+     * Get a string representation of the UUId for this game.\n+     *\n+     * @return\n+     */\n+    public String getUUIDString() {\n+        if (uuid == null) {", "originalCommit": "27187c341388d78a7c752be0ed1768db5364f40a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIzMjU5Nw==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532232597", "bodyText": "It wouldn't be.  As the code is written now, it can't be (the constructor initializes it and there's no setter).  I'm pretty sure I wrote this just to be defensive.\nActually, I think I was thinking about saved games from previous versions, but those might just fail to deserialize.\nIt's easy enough to remove the condition if you want, but I also don't really think it harms anything.  Maybe it would be better to log a message at that point, since it's a condition we'd expect not to happen.", "author": "arlith", "createdAt": "2020-11-29T16:26:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzNDAwMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjIzNDM3OQ==", "url": "https://github.com/MegaMek/megamek/pull/2448#discussion_r532234379", "bodyText": "I'm okay as is. We also don't guarantee save games across versions so no worries there.", "author": "sixlettervariables", "createdAt": "2020-11-29T16:40:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMjEzNDAwMg=="}], "type": "inlineReview", "revised_code": null}, {"oid": "59ed4ae7dde4a0ef8a2d3247f4863966240937d6", "url": "https://github.com/MegaMek/megamek/commit/59ed4ae7dde4a0ef8a2d3247f4863966240937d6", "message": "Replaces tabs with spaces", "committedDate": "2020-11-29T16:21:49Z", "type": "commit"}]}