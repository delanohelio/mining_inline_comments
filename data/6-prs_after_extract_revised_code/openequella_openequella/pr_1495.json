{"pr_number": 1495, "pr_title": "Fix \"no tree for xxx\" error caused by favourite search links", "pr_createdAt": "2020-02-20T02:25:38Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/1495", "timeline": [{"oid": "68082be7b7c89235d8ace1595323ecaadef27e40", "url": "https://github.com/openequella/openEQUELLA/commit/68082be7b7c89235d8ace1595323ecaadef27e40", "message": "Fix \"no tree for xxx\" error caused by favourite search links", "committedDate": "2020-02-20T02:11:30Z", "type": "commit"}, {"oid": "49ae6050c8930cb9652703bb2732034ce00bd9d8", "url": "https://github.com/openequella/openEQUELLA/commit/49ae6050c8930cb9652703bb2732034ce00bd9d8", "message": "Only rewrite the url when the favourite search is added from the Search page", "committedDate": "2020-02-20T04:00:14Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwMDc3OQ==", "url": "https://github.com/openequella/openEQUELLA/pull/1495#discussion_r382300779", "bodyText": "The beans should really just be basic getters and setters.  I would move this logic into FavouriteSearchServiceImpl.executeSearch (the only place getUrl is called)", "author": "abidingotter", "createdAt": "2020-02-20T22:44:39Z", "path": "Source/Plugins/Core/com.equella.core/src/com/tle/core/favourites/bean/FavouriteSearch.java", "diffHunk": "@@ -86,6 +87,13 @@ public void setName(String name) {\n   }\n \n   public String getUrl() {\n+    // The value of 'url' starts with '/access' if the fav search was added in old oEQ versions,", "originalCommit": "49ae6050c8930cb9652703bb2732034ce00bd9d8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwMzQ0OA==", "url": "https://github.com/openequella/openEQUELLA/pull/1495#discussion_r382303448", "bodyText": "Also note that WebConstants.CLOUDSEARCH_PAGE and WebConstants.HIERARCHY_PAGE need to be checked too, since you can favourite those as well.", "author": "abidingotter", "createdAt": "2020-02-20T22:51:36Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MjMwMDc3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "1194644b889f4fb4f58905cb2cffd77df2dca26b", "chunk": "diff --git a/Source/Plugins/Core/com.equella.core/src/com/tle/core/favourites/bean/FavouriteSearch.java b/Source/Plugins/Core/com.equella.core/src/com/tle/core/favourites/bean/FavouriteSearch.java\nindex 92494559f..f8ef8e5b2 100644\n--- a/Source/Plugins/Core/com.equella.core/src/com/tle/core/favourites/bean/FavouriteSearch.java\n+++ b/Source/Plugins/Core/com.equella.core/src/com/tle/core/favourites/bean/FavouriteSearch.java\n\n@@ -87,13 +86,6 @@ public class FavouriteSearch {\n   }\n \n   public String getUrl() {\n-    // The value of 'url' starts with '/access' if the fav search was added in old oEQ versions,\n-    // which results in \"no tree for xxx\" error. Hence, remove \"/access\" if it exists.\n-    if (url != null\n-        && url.startsWith(WebConstants.ACCESS_PATH)\n-        && url.contains(WebConstants.SEARCHING_PAGE)) {\n-      url = \"/\" + url.replaceFirst(WebConstants.ACCESS_PATH, \"\");\n-    }\n     return url;\n   }\n \n"}}, {"oid": "1194644b889f4fb4f58905cb2cffd77df2dca26b", "url": "https://github.com/openequella/openEQUELLA/commit/1194644b889f4fb4f58905cb2cffd77df2dca26b", "message": "Also check favourite Hierarchy searcj and Cloud search", "committedDate": "2020-02-20T23:28:03Z", "type": "commit"}, {"oid": "11e960181db02b496a98a8869771ea92e34ecc71", "url": "https://github.com/openequella/openEQUELLA/commit/11e960181db02b496a98a8869771ea92e34ecc71", "message": "Rewrite comments.", "committedDate": "2020-02-20T23:31:23Z", "type": "commit"}]}