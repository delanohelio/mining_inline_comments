{"pr_number": 2167, "pr_title": "Make date range end inclusive in searches", "pr_createdAt": "2020-08-11T05:25:05Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2167", "timeline": [{"oid": "d7fd6a03087ede4d8fac6b308274a1a0db2d417a", "url": "https://github.com/openequella/openEQUELLA/commit/d7fd6a03087ede4d8fac6b308274a1a0db2d417a", "message": "Make the end of date range inclusive in searches.\n\nFirstly, change the time of start to '00:00:00' and that of end to\n'23:59:59'. Secondly, to ensure the old Search page keeps unchanged, add a\nnew boolean variable to flag if a search is performed by 'Search2' API.\nAnd then in the function that prepares Lucine queries, use proper timezone\nbased on the flag.", "committedDate": "2020-08-11T05:12:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM5MzEzOA==", "url": "https://github.com/openequella/openEQUELLA/pull/2167#discussion_r468393138", "bodyText": "Two things:\n\nCould we use a better name for this? From what I can gather, it only does one thing - control whether or not to include a timezone in the DateFilter. So maybe a name like useServerTimeZone?\nLike we've started doing in all our TS code, let's add a JavaDoc comment to any new bits we add - especially here at the interface level.", "author": "edalex-ian", "createdAt": "2020-08-11T07:53:14Z", "path": "Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java", "diffHunk": "@@ -86,4 +86,6 @@ public SortField getSortField(boolean reverseTheDefault) {\n   String getPrivilegeToCollect();\n \n   Collection<DateFilter> getDateFilters();\n+\n+  boolean isFromSearch2API();", "originalCommit": "d7fd6a03087ede4d8fac6b308274a1a0db2d417a", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODkyNjY5Mw==", "url": "https://github.com/openequella/openEQUELLA/pull/2167#discussion_r468926693", "bodyText": "I actually came up with this name when I was working on the multiple Dynamic Collections because I wanted to indicate some code is only written for the new Search page. However, as we won't do multiple Dynamic Collections, perhaps this feature becomes the only one that requires changes on legacy code. So I am happy to rename the variable to useServerTimeZone.", "author": "PenghaiZhang", "createdAt": "2020-08-11T23:49:45Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODM5MzEzOA=="}], "type": "inlineReview", "revised_code": {"commit": "12120bd516e381d7d5d42d1ae7b0f55bbdf6ee66", "chunk": "diff --git a/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java b/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java\nindex cb949436d..a80693301 100644\n--- a/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java\n+++ b/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java\n\n@@ -87,5 +87,10 @@ public interface Search {\n \n   Collection<DateFilter> getDateFilters();\n \n-  boolean isFromSearch2API();\n+  /**\n+   * Indicate if the server time zone is needed in searches.\n+   *\n+   * @return True if server time zone is used or otherwise false.\n+   */\n+  boolean useServerTimeZone();\n }\n"}}, {"oid": "8c96f1862d00c65ae0ff9e098a4d6e87a3d0c659", "url": "https://github.com/openequella/openEQUELLA/commit/8c96f1862d00c65ae0ff9e098a4d6e87a3d0c659", "message": "Simplify SearchHelper's method 'handleModifiedDate'.", "committedDate": "2020-08-12T00:13:02Z", "type": "commit"}, {"oid": "12120bd516e381d7d5d42d1ae7b0f55bbdf6ee66", "url": "https://github.com/openequella/openEQUELLA/commit/12120bd516e381d7d5d42d1ae7b0f55bbdf6ee66", "message": "Rename variable 'isFromSearch2API' to 'useServerTimeZone' and add JavaDoc.", "committedDate": "2020-08-12T00:14:43Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2OTAyMzUxOA==", "url": "https://github.com/openequella/openEQUELLA/pull/2167#discussion_r469023518", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n               * Indicate if the server time zone is needed in searches.\n          \n          \n            \n               * Indicates if the server time zone should be included in searches.", "author": "edalex-ian", "createdAt": "2020-08-12T06:03:04Z", "path": "Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java", "diffHunk": "@@ -87,5 +87,10 @@ public SortField getSortField(boolean reverseTheDefault) {\n \n   Collection<DateFilter> getDateFilters();\n \n-  boolean isFromSearch2API();\n+  /**\n+   * Indicate if the server time zone is needed in searches.", "originalCommit": "12120bd516e381d7d5d42d1ae7b0f55bbdf6ee66", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "3489e5b52972d129912004de67d8b092ccb80bee", "chunk": "diff --git a/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java b/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java\nindex a80693301..56e85a10a 100644\n--- a/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java\n+++ b/Source/Plugins/Core/com.equella.base/src/com/tle/common/searching/Search.java\n\n@@ -88,7 +88,7 @@ public interface Search {\n   Collection<DateFilter> getDateFilters();\n \n   /**\n-   * Indicate if the server time zone is needed in searches.\n+   * Indicates if the server time zone should be included in searches.\n    *\n    * @return True if server time zone is used or otherwise false.\n    */\n"}}, {"oid": "3489e5b52972d129912004de67d8b092ccb80bee", "url": "https://github.com/openequella/openEQUELLA/commit/3489e5b52972d129912004de67d8b092ccb80bee", "message": "Two tweaks for JavaDoc.\n\nCo-authored-by: edalex-ian <43919233+edalex-ian@users.noreply.github.com>", "committedDate": "2020-08-12T06:14:27Z", "type": "commit"}]}