{"pr_number": 2346, "pr_title": "bugfix(rest-api): Should return a 404 if MIME type not found", "pr_createdAt": "2020-09-29T07:05:24Z", "pr_url": "https://github.com/openequella/openEQUELLA/pull/2346", "timeline": [{"oid": "c56c9fc9f7ed2a457dcfbd27005baf8eb0718089", "url": "https://github.com/openequella/openEQUELLA/commit/c56c9fc9f7ed2a457dcfbd27005baf8eb0718089", "message": "bugfix(rest-api): Should return a 404 if MIME type not found", "committedDate": "2020-09-29T07:00:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NDUxMg==", "url": "https://github.com/openequella/openEQUELLA/pull/2346#discussion_r497194512", "bodyText": "\"/viewerconfig/\" is repeated in this file. Should be a constant.", "author": "SammyIsConfused", "createdAt": "2020-09-30T01:32:48Z", "path": "autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java", "diffHunk": "@@ -38,6 +38,14 @@ public void testRetrieveMimeTypeConfiguration() throws Exception {\n     }\n   }\n \n+  @Test\n+  public void testMimeTypeConfigurationNotFoundHandling() throws IOException {\n+    final String noSuchMimeType = \"blah/blah\";\n+    final HttpMethod method =\n+        new GetMethod(MIMETYPE_API_ENDPOINT + \"/viewerconfig/\" + noSuchMimeType);", "originalCommit": "c56c9fc9f7ed2a457dcfbd27005baf8eb0718089", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NzIzNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2346#discussion_r497197236", "bodyText": "Ah yes! Thank you. There was one, now there are two. I'll rework.", "author": "edalex-ian", "createdAt": "2020-09-30T01:44:07Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NDUxMg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzIwNTEwNQ==", "url": "https://github.com/openequella/openEQUELLA/pull/2346#discussion_r497205105", "bodyText": "Doneski.", "author": "edalex-ian", "createdAt": "2020-09-30T02:16:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NDUxMg=="}], "type": "inlineReview", "revised_code": {"commit": "b222814a81b4f60a32d3d93007775dfc6c9f1d1c", "chunk": "diff --git a/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java b/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java\nindex a363ff3be..00d3a2508 100644\n--- a/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java\n+++ b/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java\n\n@@ -30,8 +30,7 @@ public class MimeTypeApiTest extends AbstractRestApiTest {\n   public void testRetrieveMimeTypeConfiguration() throws Exception {\n     // Let's process all the known mimetypes to ensure we can\n     for (MimeTypeDetail detail : getMimeTypes()) {\n-      final HttpMethod method =\n-          new GetMethod(MIMETYPE_API_ENDPOINT + \"/viewerconfig/\" + detail.getMimeType());\n+      final HttpMethod method = new GetMethod(buildViewerConfigPath(detail.getMimeType()));\n       assertEquals(HttpStatus.SC_OK, makeClientRequest(method));\n       JsonNode viewConfig = mapper.readTree(method.getResponseBodyAsString());\n       assertNotNull(viewConfig.findValue(\"defaultViewer\"));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NDk1Mg==", "url": "https://github.com/openequella/openEQUELLA/pull/2346#discussion_r497194952", "bodyText": "I'm assuming that it also handles the same for an empty string MIME type? Have you tested that?", "author": "SammyIsConfused", "createdAt": "2020-09-30T01:34:47Z", "path": "autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java", "diffHunk": "@@ -38,6 +38,14 @@ public void testRetrieveMimeTypeConfiguration() throws Exception {\n     }\n   }\n \n+  @Test\n+  public void testMimeTypeConfigurationNotFoundHandling() throws IOException {", "originalCommit": "c56c9fc9f7ed2a457dcfbd27005baf8eb0718089", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NzcwNg==", "url": "https://github.com/openequella/openEQUELLA/pull/2346#discussion_r497197706", "bodyText": "I'll have a play. I am/was hoping the framework looks after that - as swagger shows them as mandatory, so I'm thinking it should know what's going on. But... not confident in that. \ud83d\ude09", "author": "edalex-ian", "createdAt": "2020-09-30T01:46:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NDk1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzIwMTEyOA==", "url": "https://github.com/openequella/openEQUELLA/pull/2346#discussion_r497201128", "bodyText": "I have now tested, and yes. Seeing it's path vars, if you start dropping some etc then it triggers the 404. So all good.", "author": "edalex-ian", "createdAt": "2020-09-30T01:59:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NzE5NDk1Mg=="}], "type": "inlineReview", "revised_code": {"commit": "b222814a81b4f60a32d3d93007775dfc6c9f1d1c", "chunk": "diff --git a/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java b/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java\nindex a363ff3be..00d3a2508 100644\n--- a/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java\n+++ b/autotest/OldTests/src/test/java/io/github/openequella/rest/MimeTypeApiTest.java\n\n@@ -30,8 +30,7 @@ public class MimeTypeApiTest extends AbstractRestApiTest {\n   public void testRetrieveMimeTypeConfiguration() throws Exception {\n     // Let's process all the known mimetypes to ensure we can\n     for (MimeTypeDetail detail : getMimeTypes()) {\n-      final HttpMethod method =\n-          new GetMethod(MIMETYPE_API_ENDPOINT + \"/viewerconfig/\" + detail.getMimeType());\n+      final HttpMethod method = new GetMethod(buildViewerConfigPath(detail.getMimeType()));\n       assertEquals(HttpStatus.SC_OK, makeClientRequest(method));\n       JsonNode viewConfig = mapper.readTree(method.getResponseBodyAsString());\n       assertNotNull(viewConfig.findValue(\"defaultViewer\"));\n"}}, {"oid": "b222814a81b4f60a32d3d93007775dfc6c9f1d1c", "url": "https://github.com/openequella/openEQUELLA/commit/b222814a81b4f60a32d3d93007775dfc6c9f1d1c", "message": "chore(rest-api): Keep MimeTypeApiTest DRY\n\nFeedback from PR #2346", "committedDate": "2020-09-30T02:15:12Z", "type": "commit"}]}