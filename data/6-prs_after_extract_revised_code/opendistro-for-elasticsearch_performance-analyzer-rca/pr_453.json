{"pr_number": 453, "pr_title": "Resolve json parse error", "pr_createdAt": "2020-10-05T16:16:28Z", "pr_url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/453", "timeline": [{"oid": "170b80720b2ee7a830f5282b7c13fa3f6a09528c", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/170b80720b2ee7a830f5282b7c13fa3f6a09528c", "message": "Resolve json parse error", "committedDate": "2020-10-05T16:15:17Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTcyMDI3OQ==", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/453#discussion_r499720279", "bodyText": "Can we have a static JsonParser that is allocated once in a separate Util class and reused by both these Action classes?", "author": "sidheart", "createdAt": "2020-10-05T16:21:00Z", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/actions/ModifyCacheMaxSizeAction.java", "diffHunk": "@@ -120,7 +120,8 @@ public String summary() {\n \n   // Generates action from summary. Passing in appContext because it contains dynamic settings\n   public static ModifyCacheMaxSizeAction fromSummary(String jsonRepr, AppContext appContext) {\n-    final JsonObject jsonObject = JsonParser.parseString(jsonRepr).getAsJsonObject();\n+    final JsonParser jsonParser = new JsonParser();\n+    final JsonObject jsonObject = jsonParser.parse(jsonRepr).getAsJsonObject();", "originalCommit": "170b80720b2ee7a830f5282b7c13fa3f6a09528c", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "92b7cffc9ee16d09c6ab39cd0cd7491bcd26215b", "chunk": "diff --git a/src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/actions/ModifyCacheMaxSizeAction.java b/src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/actions/ModifyCacheMaxSizeAction.java\nindex 1392352b..4dbeba1b 100644\n--- a/src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/actions/ModifyCacheMaxSizeAction.java\n+++ b/src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/actions/ModifyCacheMaxSizeAction.java\n\n@@ -120,8 +120,7 @@ public class ModifyCacheMaxSizeAction extends SuppressibleAction {\n \n   // Generates action from summary. Passing in appContext because it contains dynamic settings\n   public static ModifyCacheMaxSizeAction fromSummary(String jsonRepr, AppContext appContext) {\n-    final JsonParser jsonParser = new JsonParser();\n-    final JsonObject jsonObject = jsonParser.parse(jsonRepr).getAsJsonObject();\n+    final JsonObject jsonObject = JSON_PARSER.parse(jsonRepr).getAsJsonObject();\n     NodeKey esNode = new NodeKey(new InstanceDetails.Id(jsonObject.get(\"Id\").getAsString()),\n             new InstanceDetails.Ip(jsonObject.get(\"Ip\").getAsString()));\n     ResourceEnum cacheType = ResourceEnum.forNumber(jsonObject.get(\"resource\").getAsInt());\n"}}, {"oid": "92b7cffc9ee16d09c6ab39cd0cd7491bcd26215b", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/commit/92b7cffc9ee16d09c6ab39cd0cd7491bcd26215b", "message": "Make jsonparser static", "committedDate": "2020-10-05T17:46:51Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ3ODA3NQ==", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/453#discussion_r500478075", "bodyText": "I can see why you want to put this single static parser in one place. Is this the right class for it though? Should we move it to some util?", "author": "vigyasharma", "createdAt": "2020-10-06T17:36:48Z", "path": "src/main/java/com/amazon/opendistro/elasticsearch/performanceanalyzer/decisionmaker/DecisionMakerConsts.java", "diffHunk": "@@ -15,6 +15,10 @@\n \n package com.amazon.opendistro.elasticsearch.performanceanalyzer.decisionmaker;\n \n+import com.google.gson.JsonParser;\n+\n public class DecisionMakerConsts {\n     public static final String CACHE_MAX_WEIGHT = \"maximumWeight\";\n+\n+    public static final JsonParser JSON_PARSER = new JsonParser();", "originalCommit": "92b7cffc9ee16d09c6ab39cd0cd7491bcd26215b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ4MTMxMg==", "url": "https://github.com/opendistro-for-elasticsearch/performance-analyzer-rca/pull/453#discussion_r500481312", "bodyText": "Right. Moving it to util is a good idea. Will merge this (unblock other build issues) and address this as a part of my next PR.\nThis issue will be resolved once we upgrade the dependency version.", "author": "sruti1312", "createdAt": "2020-10-06T17:42:32Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDQ3ODA3NQ=="}], "type": "inlineReview", "revised_code": null}]}