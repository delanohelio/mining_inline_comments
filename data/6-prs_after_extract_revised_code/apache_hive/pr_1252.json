{"pr_number": 1252, "pr_title": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "pr_createdAt": "2020-07-15T07:04:40Z", "pr_url": "https://github.com/apache/hive/pull/1252", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2OTU2Mw==", "url": "https://github.com/apache/hive/pull/1252#discussion_r454869563", "bodyText": "I think instead of making it a \"multi file\" stuff; we can just add it to the shader in ql/pom.xml", "author": "kgyrtkirk", "createdAt": "2020-07-15T08:08:16Z", "path": "ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java", "diffHunk": "@@ -109,7 +112,7 @@\n \n   private final HiveConf conf;\n   private Path tezScratchDir;\n-  private LocalResource appJarLr;\n+  private Collection<LocalResource> appJarLrs;", "originalCommit": "a1cdb7a62eb3ea00556e3f80d41b47697f3ef8b0", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTEyMjQ0OQ==", "url": "https://github.com/apache/hive/pull/1252#discussion_r455122449", "bodyText": "Thanks for the suggestion. Unfortunately it seems that the generated HiveParser.class has some huge methods, which causes the shade plugin to fail.\nError creating shaded jar: Problem shading JAR /home/antals/.m2/repository/org/apache/hive/hive-parser/4.0.0-SNAPSHOT/hive-parser-4.0.0-SNAPSHOT.jar entry org/apache/hadoop/hive/ql/parse/HiveParser.class: java.lang.RuntimeException: Method code too large!", "author": "asinkovits", "createdAt": "2020-07-15T15:02:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2OTU2Mw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTU0MzMwMQ==", "url": "https://github.com/apache/hive/pull/1252#discussion_r455543301", "bodyText": "HIVE-23857 fixed the Method code too large! issue.", "author": "asinkovits", "createdAt": "2020-07-16T06:40:49Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NDg2OTU2Mw=="}], "type": "inlineReview", "revised_code": {"commit": "9c444ca16a3651274d589814083bb0cb57b431d1", "chunk": "diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java\nindex f3b7745d80..ee88b18bbb 100644\n--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java\n+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java\n\n@@ -112,7 +109,7 @@\n \n   private final HiveConf conf;\n   private Path tezScratchDir;\n-  private Collection<LocalResource> appJarLrs;\n+  private LocalResource appJarLr;\n   private TezClient session;\n   private Future<TezClient> sessionFuture;\n   /** Console used for user feedback during async session opening. */\n"}}, {"oid": "e93169f5039aa8b116ac5e0b0a742f7bfda99664", "url": "https://github.com/apache/hive/commit/e93169f5039aa8b116ac5e0b0a742f7bfda99664", "message": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "committedDate": "2020-07-15T16:03:48Z", "type": "forcePushed"}, {"oid": "9c444ca16a3651274d589814083bb0cb57b431d1", "url": "https://github.com/apache/hive/commit/9c444ca16a3651274d589814083bb0cb57b431d1", "message": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "committedDate": "2020-07-16T06:38:57Z", "type": "forcePushed"}, {"oid": "61951dfe698e639516d539fbdd51c2e20d660d41", "url": "https://github.com/apache/hive/commit/61951dfe698e639516d539fbdd51c2e20d660d41", "message": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "committedDate": "2020-07-16T06:58:49Z", "type": "forcePushed"}, {"oid": "43c772183448b1730c7538373e6c6bfbf3d420db", "url": "https://github.com/apache/hive/commit/43c772183448b1730c7538373e6c6bfbf3d420db", "message": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "committedDate": "2020-07-23T07:26:49Z", "type": "forcePushed"}, {"oid": "802a44718ac086c829014d47846a50261a69fa2c", "url": "https://github.com/apache/hive/commit/802a44718ac086c829014d47846a50261a69fa2c", "message": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "committedDate": "2020-07-27T12:39:32Z", "type": "commit"}, {"oid": "802a44718ac086c829014d47846a50261a69fa2c", "url": "https://github.com/apache/hive/commit/802a44718ac086c829014d47846a50261a69fa2c", "message": "HIVE-23847: Extracting hive-parser module broke exec jar upload in tez", "committedDate": "2020-07-27T12:39:32Z", "type": "forcePushed"}]}