{"pr_number": 12549, "pr_title": "Bratseth/system info", "pr_createdAt": "2020-03-12T12:53:22Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12549", "timeline": [{"oid": "288ce8de5f5ee49c8c91340a86252b38b16ce6f2", "url": "https://github.com/vespa-engine/vespa/commit/288ce8de5f5ee49c8c91340a86252b38b16ce6f2", "message": "Add SystemInfo", "committedDate": "2020-03-10T10:08:08Z", "type": "commit"}, {"oid": "85e39e75026b09a936516c6234b438069b8b1859", "url": "https://github.com/vespa-engine/vespa/commit/85e39e75026b09a936516c6234b438069b8b1859", "message": "Zone information for containers to replace com.yahoo.config.provision", "committedDate": "2020-03-12T12:51:47Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0Mzg0MQ==", "url": "https://github.com/vespa-engine/vespa/pull/12549#discussion_r391643841", "bodyText": "Suppressing \"unused\" should be unnecessary when you have the Inject annotation.", "author": "gjoranv", "createdAt": "2020-03-12T14:06:01Z", "path": "container-core/src/main/java/ai/vespa/cloud/SystemInfo.java", "diffHunk": "@@ -1,5 +1,32 @@\n // Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n package ai.vespa.cloud;\n \n+import com.google.inject.Inject;\n+import com.yahoo.cloud.config.ConfigserverConfig;\n+\n+/**\n+ * Provides information about the system in which this container is running.\n+ * This is available and can be injected when running in a cloud environment.\n+ *\n+ * @author bratseth\n+ */\n public class SystemInfo {\n+\n+    private final Zone zone;\n+\n+    /** Do not use */\n+    @SuppressWarnings(\"unused\")", "originalCommit": "85e39e75026b09a936516c6234b438069b8b1859", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY3NTgwOQ==", "url": "https://github.com/vespa-engine/vespa/pull/12549#discussion_r391675809", "bodyText": "IntelliJ don't think so, but I guess it's clear enough with the annotation anyway.", "author": "bratseth", "createdAt": "2020-03-12T14:52:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0Mzg0MQ=="}], "type": "inlineReview", "revised_code": {"commit": "31fc598c5d1384c3fb93a2aff7c953fd161d31f3", "chunk": "diff --git a/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java b/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java\nindex 6fc0e7e8e8..0524ae072c 100644\n--- a/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java\n+++ b/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java\n\n@@ -15,7 +15,6 @@ public class SystemInfo {\n     private final Zone zone;\n \n     /** Do not use */\n-    @SuppressWarnings(\"unused\")\n     @Inject\n     public SystemInfo(ConfigserverConfig config) {\n         this.zone = new Zone(Environment.valueOf(config.environment()), config.region());\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0NDQ5Nw==", "url": "https://github.com/vespa-engine/vespa/pull/12549#discussion_r391644497", "bodyText": "I suggest to skip this comment. What does it mean?", "author": "gjoranv", "createdAt": "2020-03-12T14:07:00Z", "path": "container-core/src/main/java/ai/vespa/cloud/SystemInfo.java", "diffHunk": "@@ -1,5 +1,32 @@\n // Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n package ai.vespa.cloud;\n \n+import com.google.inject.Inject;\n+import com.yahoo.cloud.config.ConfigserverConfig;\n+\n+/**\n+ * Provides information about the system in which this container is running.\n+ * This is available and can be injected when running in a cloud environment.\n+ *\n+ * @author bratseth\n+ */\n public class SystemInfo {\n+\n+    private final Zone zone;\n+\n+    /** Do not use */", "originalCommit": "85e39e75026b09a936516c6234b438069b8b1859", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY3NjI5MQ==", "url": "https://github.com/vespa-engine/vespa/pull/12549#discussion_r391676291", "bodyText": "It means to not use it ... I probably want to switch to another config later which will break any who use this method.", "author": "bratseth", "createdAt": "2020-03-12T14:52:46Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0NDQ5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "31fc598c5d1384c3fb93a2aff7c953fd161d31f3", "chunk": "diff --git a/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java b/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java\nindex 6fc0e7e8e8..0524ae072c 100644\n--- a/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java\n+++ b/container-core/src/main/java/ai/vespa/cloud/SystemInfo.java\n\n@@ -15,7 +15,6 @@ public class SystemInfo {\n     private final Zone zone;\n \n     /** Do not use */\n-    @SuppressWarnings(\"unused\")\n     @Inject\n     public SystemInfo(ConfigserverConfig config) {\n         this.zone = new Zone(Environment.valueOf(config.environment()), config.region());\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0NTM1Nw==", "url": "https://github.com/vespa-engine/vespa/pull/12549#discussion_r391645357", "bodyText": "Perhaps this should be e.g. \u00b4stringValue()\u00b4, and return a String that is less tempting to parse from toString.", "author": "gjoranv", "createdAt": "2020-03-12T14:08:17Z", "path": "container-core/src/main/java/ai/vespa/cloud/Zone.java", "diffHunk": "@@ -0,0 +1,61 @@\n+// Copyright Verizon Media. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.\n+package ai.vespa.cloud;\n+\n+import java.util.Objects;\n+\n+/**\n+ * The zone in which a cloud deployment may be running.\n+ * A zone is a combination of an environment and a region.\n+ *\n+ * @author bratseth\n+ */\n+public class Zone {\n+\n+    private final Environment environment;\n+\n+    private final String region;\n+\n+    public Zone(Environment environment, String region) {\n+        this.environment = environment;\n+        this.region = region;\n+    }\n+\n+    public Environment environment() { return environment; }\n+    public String region() { return region; }\n+\n+    /** Returns the string environment.region */\n+    @Override\n+    public String toString() { return environment + \".\" + region; }", "originalCommit": "85e39e75026b09a936516c6234b438069b8b1859", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY3NjgwNg==", "url": "https://github.com/vespa-engine/vespa/pull/12549#discussion_r391676806", "bodyText": "I would agree if this was further in but I think this is fine for an \"edge API\" class.", "author": "bratseth", "createdAt": "2020-03-12T14:53:26Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTY0NTM1Nw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "31fc598c5d1384c3fb93a2aff7c953fd161d31f3", "url": "https://github.com/vespa-engine/vespa/commit/31fc598c5d1384c3fb93a2aff7c953fd161d31f3", "message": "Remove SuppressWarning", "committedDate": "2020-03-12T14:55:10Z", "type": "commit"}, {"oid": "2b67e1f8234dc0914c43d56e76dadc2b5ae3e9dc", "url": "https://github.com/vespa-engine/vespa/commit/2b67e1f8234dc0914c43d56e76dadc2b5ae3e9dc", "message": "Update ABI spec", "committedDate": "2020-03-12T14:59:36Z", "type": "commit"}]}