{"pr_number": 14532, "pr_title": "Use DaemonThreadFactory and make sure to shutdown executors", "pr_createdAt": "2020-09-24T13:20:46Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14532", "timeline": [{"oid": "5fd7195145a2ab4c5c57cfe7d770b228e0d8ea48", "url": "https://github.com/vespa-engine/vespa/commit/5fd7195145a2ab4c5c57cfe7d770b228e0d8ea48", "message": "Use DaemonThreadFactory and make sure to shutdown executors", "committedDate": "2020-09-24T13:20:15Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMyMDc4Mg==", "url": "https://github.com/vespa-engine/vespa/pull/14532#discussion_r494320782", "bodyText": "\"file server pull\"", "author": "baldersheim", "createdAt": "2020-09-24T13:34:18Z", "path": "configserver/src/main/java/com/yahoo/vespa/config/server/filedistribution/FileServer.java", "diffHunk": "@@ -79,8 +80,10 @@ public FileServer(File rootDir) {\n     private FileServer(ConnectionPool connectionPool, File rootDir) {\n         this.downloader = new FileDownloader(connectionPool);\n         this.root = new FileDirectory(rootDir);\n-        this.pushExecutor = Executors.newFixedThreadPool(Math.max(8, Runtime.getRuntime().availableProcessors()));\n-        this.pullExecutor = Executors.newFixedThreadPool(Math.max(8, Runtime.getRuntime().availableProcessors()));\n+        this.pushExecutor = Executors.newFixedThreadPool(Math.max(8, Runtime.getRuntime().availableProcessors()),\n+                                                         new DaemonThreadFactory(\"file server push\"));\n+        this.pullExecutor = Executors.newFixedThreadPool(Math.max(8, Runtime.getRuntime().availableProcessors()),\n+                                                         new DaemonThreadFactory(\"file server push\"));", "originalCommit": "5fd7195145a2ab4c5c57cfe7d770b228e0d8ea48", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMyMjQxNQ==", "url": "https://github.com/vespa-engine/vespa/pull/14532#discussion_r494322415", "bodyText": "Fixed", "author": "hmusum", "createdAt": "2020-09-24T13:36:25Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5NDMyMDc4Mg=="}], "type": "inlineReview", "revised_code": {"commit": "fb7bceeb2537d57e4ce6543201d8ed8afe400d4c", "chunk": "diff --git a/configserver/src/main/java/com/yahoo/vespa/config/server/filedistribution/FileServer.java b/configserver/src/main/java/com/yahoo/vespa/config/server/filedistribution/FileServer.java\nindex 0be91c2d5e..31294faad0 100644\n--- a/configserver/src/main/java/com/yahoo/vespa/config/server/filedistribution/FileServer.java\n+++ b/configserver/src/main/java/com/yahoo/vespa/config/server/filedistribution/FileServer.java\n\n@@ -83,7 +83,7 @@ public class FileServer {\n         this.pushExecutor = Executors.newFixedThreadPool(Math.max(8, Runtime.getRuntime().availableProcessors()),\n                                                          new DaemonThreadFactory(\"file server push\"));\n         this.pullExecutor = Executors.newFixedThreadPool(Math.max(8, Runtime.getRuntime().availableProcessors()),\n-                                                         new DaemonThreadFactory(\"file server push\"));\n+                                                         new DaemonThreadFactory(\"file server pull\"));\n     }\n \n     boolean hasFile(String fileReference) {\n"}}, {"oid": "fb7bceeb2537d57e4ce6543201d8ed8afe400d4c", "url": "https://github.com/vespa-engine/vespa/commit/fb7bceeb2537d57e4ce6543201d8ed8afe400d4c", "message": "Fix name", "committedDate": "2020-09-24T13:36:11Z", "type": "commit"}]}