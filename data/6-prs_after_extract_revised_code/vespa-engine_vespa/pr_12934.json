{"pr_number": 12934, "pr_title": "Unset IP addresses on deprovisioning ", "pr_createdAt": "2020-04-15T21:40:34Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12934", "timeline": [{"oid": "4ef8a387ec9af4aa436089a5118c88d5fd1e0e90", "url": "https://github.com/vespa-engine/vespa/commit/4ef8a387ec9af4aa436089a5118c88d5fd1e0e90", "message": "Unset IP addresses on deprovisioning", "committedDate": "2020-04-15T21:39:47Z", "type": "commit"}, {"oid": "394d5ac7d2f154791f4516bf5d66e495b50214c2", "url": "https://github.com/vespa-engine/vespa/commit/394d5ac7d2f154791f4516bf5d66e495b50214c2", "message": "Removed unnecessary method", "committedDate": "2020-04-16T08:56:21Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTQzNTY3MA==", "url": "https://github.com/vespa-engine/vespa/pull/12934#discussion_r409435670", "bodyText": "Consider extending one of the deprovision tests in NodeRepositoryTest to test this behaviour.", "author": "mpolden", "createdAt": "2020-04-16T10:02:49Z", "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/NodeRepository.java", "diffHunk": "@@ -629,8 +629,10 @@ public Node markNodeAvailableForNewAllocation(String hostname, Agent agent, Stri\n                 List<Node> removed = new ArrayList<>(children);\n                 if (zone.cloud().value().equals(\"aws\"))\n                     db.removeNodes(List.of(node));\n-                else\n+                else {\n+                    node = node.with(IP.Config.EMPTY);", "originalCommit": "394d5ac7d2f154791f4516bf5d66e495b50214c2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "488ef28b5bb2ff54b10783b0712cc56bcd8eb438", "url": "https://github.com/vespa-engine/vespa/commit/488ef28b5bb2ff54b10783b0712cc56bcd8eb438", "message": "Testing for reset of IP Config", "committedDate": "2020-04-16T11:40:33Z", "type": "commit"}]}