{"pr_number": 12506, "pr_title": "Jonmv/compile version on separate path", "pr_createdAt": "2020-03-09T08:52:37Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12506", "timeline": [{"oid": "1871cb38829dcf43d64141ce4747a8b984a83397", "url": "https://github.com/vespa-engine/vespa/commit/1871cb38829dcf43d64141ce4747a8b984a83397", "message": "Expose compile version on separate path", "committedDate": "2020-03-09T08:52:09Z", "type": "commit"}, {"oid": "152bbcc34a406ce3746bbc352addbc807e1de252", "url": "https://github.com/vespa-engine/vespa/commit/152bbcc34a406ce3746bbc352addbc807e1de252", "message": "Use new path for compile version", "committedDate": "2020-03-09T08:52:18Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTYyMTI5OA==", "url": "https://github.com/vespa-engine/vespa/pull/12506#discussion_r389621298", "bodyText": "Good.", "author": "mpolden", "createdAt": "2020-03-09T12:12:11Z", "path": "controller-server/src/main/java/com/yahoo/vespa/hosted/controller/restapi/application/ApplicationApiHandler.java", "diffHunk": "@@ -1176,20 +1186,21 @@ private URI monitoringSystemUri(DeploymentId deploymentId) {\n      */\n     private Version compileVersion(TenantAndApplicationId id) {\n         Version oldestPlatform = controller.applications().oldestInstalledPlatform(id);\n-        return controller.versionStatus().versions().stream()\n-                         .filter(version -> version.confidence().equalOrHigherThan(VespaVersion.Confidence.low))\n-                         .filter(VespaVersion::isReleased)\n-                         .map(VespaVersion::versionNumber)\n-                         .filter(version -> ! version.isAfter(oldestPlatform))\n-                         .max(Comparator.naturalOrder())\n-                         .orElseGet(() -> controller.mavenRepository().metadata().versions().stream()\n-                                                    .filter(version -> ! version.isAfter(oldestPlatform))\n-                                                    .filter(version -> ! controller.versionStatus().versions().stream()\n-                                                                                   .map(VespaVersion::versionNumber)\n-                                                                                   .collect(Collectors.toSet()).contains(version))\n-                                                    .max(Comparator.naturalOrder())\n-                                                    .orElseThrow(() -> new IllegalStateException(\"No available releases of \" +\n-                                                                                                 controller.mavenRepository().artifactId())));\n+        VersionStatus versionStatus = controller.versionStatus();", "originalCommit": "1871cb38829dcf43d64141ce4747a8b984a83397", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}