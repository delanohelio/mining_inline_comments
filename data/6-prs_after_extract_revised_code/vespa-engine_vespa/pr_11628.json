{"pr_number": 11628, "pr_title": "Normalized vcpu capping", "pr_createdAt": "2020-01-02T12:23:29Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/11628", "timeline": [{"oid": "eb7c0d96095c820ff811a3cba11e3c2564acbdd9", "url": "https://github.com/vespa-engine/vespa/commit/eb7c0d96095c820ff811a3cba11e3c2564acbdd9", "message": "NodeSpec::vcpus -> vcpu", "committedDate": "2020-01-02T11:04:23Z", "type": "commit"}, {"oid": "dd2362306f4edb773138ad9d6e0e7c99a6b1467e", "url": "https://github.com/vespa-engine/vespa/commit/dd2362306f4edb773138ad9d6e0e7c99a6b1467e", "message": "Add NodeAgentContext:normalizedVcpu", "committedDate": "2020-01-02T11:53:28Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2MjQ2NjAwNw==", "url": "https://github.com/vespa-engine/vespa/pull/11628#discussion_r362466007", "bodyText": "The \"normalizedVcpu\" and \"vcpu\" methods should swap names.", "author": "hakonhall", "createdAt": "2020-01-02T13:05:18Z", "path": "node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/nodeagent/NodeAgentContext.java", "diffHunk": "@@ -42,6 +42,14 @@ default NodeType nodeType() {\n \n     String vespaUserOnHost();\n \n+    /**\n+     * The vcpu value in NodeSpec is multiplied by the speedup factor per cpu core compared to a historical baseline", "originalCommit": "dd2362306f4edb773138ad9d6e0e7c99a6b1467e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "6a7bd6bbba185d7033d0e86faae8c369ed04c59f", "chunk": "diff --git a/node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/nodeagent/NodeAgentContext.java b/node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/nodeagent/NodeAgentContext.java\nindex 33baed7b83..ecf451b255 100644\n--- a/node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/nodeagent/NodeAgentContext.java\n+++ b/node-admin/src/main/java/com/yahoo/vespa/hosted/node/admin/nodeagent/NodeAgentContext.java\n\n@@ -48,7 +48,7 @@ public interface NodeAgentContext extends TaskContext {\n      *\n      * @return node vcpu without the cpu speedup factor.\n      */\n-    double normalizedVcpu();\n+    double unscaledVcpu();\n \n     /**\n      * This method is the inverse of {@link #pathInNodeFromPathOnHost(Path)}}\n"}}, {"oid": "6a7bd6bbba185d7033d0e86faae8c369ed04c59f", "url": "https://github.com/vespa-engine/vespa/commit/6a7bd6bbba185d7033d0e86faae8c369ed04c59f", "message": "normalizedVcpu() -> unscaledVcpu()", "committedDate": "2020-01-02T13:14:52Z", "type": "commit"}]}