{"pr_number": 12877, "pr_title": "Hold config lock when modifying load balancers", "pr_createdAt": "2020-04-08T12:53:19Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12877", "timeline": [{"oid": "bc3b0922b32eafbff64391654fdf64d2fd74ffa4", "url": "https://github.com/vespa-engine/vespa/commit/bc3b0922b32eafbff64391654fdf64d2fd74ffa4", "message": "Hold config lock when modifying load balancers", "committedDate": "2020-04-08T12:52:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwNTUzMTI3NA==", "url": "https://github.com/vespa-engine/vespa/pull/12877#discussion_r405531274", "bodyText": "Let's just call that the application lock and use it everywhere?\n\nYes, that's this TODO, but baby steps... :)", "author": "mpolden", "createdAt": "2020-04-08T13:38:01Z", "path": "node-repository/src/main/java/com/yahoo/vespa/hosted/provision/NodeRepository.java", "diffHunk": "@@ -761,6 +762,7 @@ else if (node.flavor().getType() == Flavor.Type.DOCKER_CONTAINER) { // removing\n     public Zone zone() { return zone; }\n \n     /** Create a lock which provides exclusive rights to making changes to the given application */\n+    // TODO(mpolden): Make this delegate to CuratorDatabaseClient#lockConfig instead", "originalCommit": "bc3b0922b32eafbff64391654fdf64d2fd74ffa4", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}