{"pr_number": 12129, "pr_title": "Config cleanup 5", "pr_createdAt": "2020-02-10T07:03:59Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12129", "timeline": [{"oid": "10a1c3d262d6fea9925cb50e239712727963f924", "url": "https://github.com/vespa-engine/vespa/commit/10a1c3d262d6fea9925cb50e239712727963f924", "message": "Remove unused map of requesters", "committedDate": "2020-02-09T20:38:37Z", "type": "commit"}, {"oid": "ac2b4174ed619b80f346d40d8b042761f1f723ed", "url": "https://github.com/vespa-engine/vespa/commit/ac2b4174ed619b80f346d40d8b042761f1f723ed", "message": "No need for a static method and constructor that are equal", "committedDate": "2020-02-09T20:42:59Z", "type": "commit"}, {"oid": "741b069e8aa00a4dde1f596103eb78beadac174e", "url": "https://github.com/vespa-engine/vespa/commit/741b069e8aa00a4dde1f596103eb78beadac174e", "message": "Remove constructor only used in tests", "committedDate": "2020-02-09T21:07:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyMTMzNw==", "url": "https://github.com/vespa-engine/vespa/pull/12129#discussion_r376921337", "bodyText": "It's never null?", "author": "freva", "createdAt": "2020-02-10T08:34:03Z", "path": "config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java", "diffHunk": "@@ -183,15 +171,14 @@ public void shutdownSourceConnections() {\n             activeSubscribers.clear();\n         }\n         exec.shutdown();\n-        for (JRTConfigRequester requester : requesterPool.values()) {\n+        if (requester != null)", "originalCommit": "741b069e8aa00a4dde1f596103eb78beadac174e", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkzMjEwMQ==", "url": "https://github.com/vespa-engine/vespa/pull/12129#discussion_r376932101", "bodyText": "Yes, thanks, fixed", "author": "hmusum", "createdAt": "2020-02-10T08:58:54Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjkyMTMzNw=="}], "type": "inlineReview", "revised_code": {"commit": "60a8b3893dd283b9fe9cb804c21a23e7d27d530f", "chunk": "diff --git a/config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java b/config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java\nindex b5669820d1..865bb2472c 100644\n--- a/config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java\n+++ b/config-proxy/src/main/java/com/yahoo/vespa/config/proxy/RpcConfigSourceClient.java\n\n@@ -171,26 +171,17 @@ class RpcConfigSourceClient implements ConfigSourceClient {\n             activeSubscribers.clear();\n         }\n         exec.shutdown();\n-        if (requester != null)\n-            requester.close();\n+        requester.close();\n     }\n \n     @Override\n     public String getActiveSourceConnection() {\n-        if (requester != null) {\n-            return requester.getConnectionPool().getCurrent().getAddress();\n-        } else {\n-            return \"\";\n-        }\n+        return requester.getConnectionPool().getCurrent().getAddress();\n     }\n \n     @Override\n     public List<String> getSourceConnections() {\n-        ArrayList<String> ret = new ArrayList<>();\n-        if (requester != null) {\n-            ret.addAll(configSourceSet.getSources());\n-        }\n-        return ret;\n+        return new ArrayList<>(configSourceSet.getSources());\n     }\n \n     /**\n"}}, {"oid": "60a8b3893dd283b9fe9cb804c21a23e7d27d530f", "url": "https://github.com/vespa-engine/vespa/commit/60a8b3893dd283b9fe9cb804c21a23e7d27d530f", "message": "requester is never null, remove guards", "committedDate": "2020-02-10T08:58:23Z", "type": "commit"}]}