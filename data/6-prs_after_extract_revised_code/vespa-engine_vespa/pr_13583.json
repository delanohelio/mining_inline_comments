{"pr_number": 13583, "pr_title": "Add local session to session cache", "pr_createdAt": "2020-06-15T09:53:44Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/13583", "timeline": [{"oid": "be48fcf39b281641203f369ee8d3cf16528c2927", "url": "https://github.com/vespa-engine/vespa/commit/be48fcf39b281641203f369ee8d3cf16528c2927", "message": "Add local session to session cache\n\nIf we managed to created a local session, add it to the session cache", "committedDate": "2020-06-15T09:52:53Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY4MzMxMg==", "url": "https://github.com/vespa-engine/vespa/pull/13583#discussion_r440683312", "bodyText": "Intentional that already existing session no longer causes an exception ?", "author": "baldersheim", "createdAt": "2020-06-16T08:38:52Z", "path": "configserver/src/main/java/com/yahoo/vespa/config/server/session/SessionCache.java", "diffHunk": "@@ -16,9 +16,7 @@\n     private final HashMap<Long, SESSIONTYPE> sessions = new HashMap<>();\n \n     public synchronized void addSession(SESSIONTYPE session) {\n-        if (sessions.containsKey(session.getSessionId()))\n-            throw new IllegalArgumentException(\"There already exists a session with id '\" + session.getSessionId() + \"'\");\n-        sessions.put(session.getSessionId(), session);\n+        sessions.putIfAbsent(session.getSessionId(), session);", "originalCommit": "be48fcf39b281641203f369ee8d3cf16528c2927", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY5MTYxOQ==", "url": "https://github.com/vespa-engine/vespa/pull/13583#discussion_r440691619", "bodyText": "Yes, I could not find any issues with changing this", "author": "hmusum", "createdAt": "2020-06-16T08:51:44Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDY4MzMxMg=="}], "type": "inlineReview", "revised_code": null}]}