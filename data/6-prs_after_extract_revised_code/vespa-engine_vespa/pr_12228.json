{"pr_number": 12228, "pr_title": "[VESPA-15448] Add metrics for client side failures", "pr_createdAt": "2020-02-17T15:17:46Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/12228", "timeline": [{"oid": "a0c2be494ed90cead7a55a1926dec15dffd685a2", "url": "https://github.com/vespa-engine/vespa/commit/a0c2be494ed90cead7a55a1926dec15dffd685a2", "message": "[VESPA-15448] Add metrics for client side failures", "committedDate": "2020-02-17T15:17:11Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI0MTMzOQ==", "url": "https://github.com/vespa-engine/vespa/pull/12228#discussion_r380241339", "bodyText": "Visitors operate on bucket granularities and notfound is a document-level metric, so this should never be nonzero. I.e. this can be removed.", "author": "vekterli", "createdAt": "2020-02-17T15:21:12Z", "path": "config-model/src/main/java/com/yahoo/vespa/model/admin/monitoring/VespaMetricSet.java", "diffHunk": "@@ -636,12 +642,14 @@\n         metrics.add(new Metric(\"vds.distributor.gets.sum.latency.average\")); // TODO: Remove in Vespa 8\n         metrics.add(new Metric(\"vds.distributor.gets.sum.ok.rate\"));\n         metrics.add(new Metric(\"vds.distributor.gets.sum.failures.total.rate\"));\n+        metrics.add(new Metric(\"vds.distributor.gets.sum.failures.notfound.rate\"));\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.latency.max\"));\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.latency.sum\"));\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.latency.count\"));\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.latency.average\")); // TODO: Remove in Vespa 8\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.ok.rate\"));\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.failures.total.rate\"));\n+        metrics.add(new Metric(\"vds.distributor.visitor.sum.failures.notfound.rate\"));", "originalCommit": "a0c2be494ed90cead7a55a1926dec15dffd685a2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI2MTQwMg==", "url": "https://github.com/vespa-engine/vespa/pull/12228#discussion_r380261402", "bodyText": "Thanks! Removed.", "author": "yngveaasheim", "createdAt": "2020-02-17T15:58:52Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4MDI0MTMzOQ=="}], "type": "inlineReview", "revised_code": {"commit": "ea52671a181ef1f4d5f82896859e6559a465ffe4", "chunk": "diff --git a/config-model/src/main/java/com/yahoo/vespa/model/admin/monitoring/VespaMetricSet.java b/config-model/src/main/java/com/yahoo/vespa/model/admin/monitoring/VespaMetricSet.java\nindex 94fc8c4d9c..e8a30bfb35 100644\n--- a/config-model/src/main/java/com/yahoo/vespa/model/admin/monitoring/VespaMetricSet.java\n+++ b/config-model/src/main/java/com/yahoo/vespa/model/admin/monitoring/VespaMetricSet.java\n\n@@ -649,7 +649,6 @@ public class VespaMetricSet {\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.latency.average\")); // TODO: Remove in Vespa 8\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.ok.rate\"));\n         metrics.add(new Metric(\"vds.distributor.visitor.sum.failures.total.rate\"));\n-        metrics.add(new Metric(\"vds.distributor.visitor.sum.failures.notfound.rate\"));\n \n         metrics.add(new Metric(\"vds.distributor.docsstored.average\"));\n         metrics.add(new Metric(\"vds.distributor.bytesstored.average\"));\n"}}, {"oid": "ea52671a181ef1f4d5f82896859e6559a465ffe4", "url": "https://github.com/vespa-engine/vespa/commit/ea52671a181ef1f4d5f82896859e6559a465ffe4", "message": "Update per feedback.", "committedDate": "2020-02-17T15:58:13Z", "type": "commit"}]}