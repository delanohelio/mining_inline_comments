{"pr_number": 14004, "pr_title": "keep which user created a tenant", "pr_createdAt": "2020-08-06T12:01:01Z", "pr_url": "https://github.com/vespa-engine/vespa/pull/14004", "timeline": [{"oid": "6dea664f2f36a773f53ee975c9aea8b0f78095cc", "url": "https://github.com/vespa-engine/vespa/commit/6dea664f2f36a773f53ee975c9aea8b0f78095cc", "message": "keep which user created a tenant", "committedDate": "2020-08-06T12:00:05Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjM3NTIwMA==", "url": "https://github.com/vespa-engine/vespa/pull/14004#discussion_r466375200", "bodyText": "Pretty sure there's some optionalString somewhere, perhaps in SlimeUtils.", "author": "jonmv", "createdAt": "2020-08-06T12:27:20Z", "path": "controller-server/src/main/java/com/yahoo/vespa/hosted/controller/persistence/TenantSerializer.java", "diffHunk": "@@ -128,8 +131,13 @@ private AthenzTenant athenzTenantFrom(Inspector tenantObject) {\n \n     private CloudTenant cloudTenantFrom(Inspector tenantObject) {\n         TenantName name = TenantName.from(tenantObject.field(nameField).asString());\n+\n+        Optional<Principal> creator = tenantObject.field(creatorField).valid() ?", "originalCommit": "6dea664f2f36a773f53ee975c9aea8b0f78095cc", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "78d6797fc7a2ca768e2303f4eeba5050e4dc7593", "chunk": "diff --git a/controller-server/src/main/java/com/yahoo/vespa/hosted/controller/persistence/TenantSerializer.java b/controller-server/src/main/java/com/yahoo/vespa/hosted/controller/persistence/TenantSerializer.java\nindex 3f25fd9ae1..2ed71b9185 100644\n--- a/controller-server/src/main/java/com/yahoo/vespa/hosted/controller/persistence/TenantSerializer.java\n+++ b/controller-server/src/main/java/com/yahoo/vespa/hosted/controller/persistence/TenantSerializer.java\n\n@@ -131,11 +131,7 @@ public class TenantSerializer {\n \n     private CloudTenant cloudTenantFrom(Inspector tenantObject) {\n         TenantName name = TenantName.from(tenantObject.field(nameField).asString());\n-\n-        Optional<Principal> creator = tenantObject.field(creatorField).valid() ?\n-                Optional.of(new SimplePrincipal(tenantObject.field(creatorField).asString())) :\n-                Optional.empty();\n-\n+        Optional<Principal> creator = SlimeUtils.optionalString(tenantObject.field(creatorField)).map(SimplePrincipal::new);\n         BiMap<PublicKey, Principal> developerKeys = developerKeysFromSlime(tenantObject.field(pemDeveloperKeysField));\n         return new CloudTenant(name, creator, developerKeys);\n     }\n"}}, {"oid": "78d6797fc7a2ca768e2303f4eeba5050e4dc7593", "url": "https://github.com/vespa-engine/vespa/commit/78d6797fc7a2ca768e2303f4eeba5050e4dc7593", "message": "Use SlimeUtils.optionalString", "committedDate": "2020-08-06T12:40:58Z", "type": "commit"}]}