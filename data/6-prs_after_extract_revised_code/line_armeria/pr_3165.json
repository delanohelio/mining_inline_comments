{"pr_number": 3165, "pr_title": "Clean up cacheSpec and backoffSpec documentation", "pr_createdAt": "2020-11-09T11:52:34Z", "pr_url": "https://github.com/line/armeria/pull/3165", "timeline": [{"oid": "b69444d54e0885a920e3bec62f98f754d33a7ece", "url": "https://github.com/line/armeria/commit/b69444d54e0885a920e3bec62f98f754d33a7ece", "message": "Clean up cacheSpec and backoffSpec documentation\n\nMotivation:\n\nThe descriptions of `*cacheSpec` and `defaultBackoffSpec` flags do not\nexplain what they do exactly in their first sentence.\n\nModifications:\n\n- Update the Javadoc of the methods that returns or accepts a Caffeine\n  specification string or backoff specification string so that it's more\n  user-friendly.\n\nResult:\n\n- Hopefully easier to understand that these flags do actually.", "committedDate": "2020-11-09T11:49:33Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc2Njc5NQ==", "url": "https://github.com/line/armeria/pull/3165#discussion_r519766795", "bodyText": "Don't we need to specify message for requireNonNull such as requireNonNull(..., name)?", "author": "ikhoon", "createdAt": "2020-11-09T12:21:00Z", "path": "core/src/main/java/com/linecorp/armeria/common/Flags.java", "diffHunk": "@@ -1087,27 +1089,37 @@ public static boolean validateHeaders() {\n \n     @Nullable\n     private static String nullableCaffeineSpec(String name, String defaultValue) {\n-        return getCaffeineSpec(name, defaultValue, true);\n+        return caffeineSpec(name, defaultValue, true);\n     }\n \n-    private static String caffeineSpec(String name, String defaultValue) {\n-        return requireNonNull(getCaffeineSpec(name, defaultValue, false), \"caffeineSpec\");\n+    private static String nonnullCaffeineSpec(String name, String defaultValue) {\n+        return requireNonNull(caffeineSpec(name, defaultValue, false));", "originalCommit": "b69444d54e0885a920e3bec62f98f754d33a7ece", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc2NzQ5MA==", "url": "https://github.com/line/armeria/pull/3165#discussion_r519767490", "bodyText": "It never returns null when allowOff is false. requireNonNull here is just to make the static analysis happy.", "author": "trustin", "createdAt": "2020-11-09T12:22:19Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc2Njc5NQ=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc2ODUyMA==", "url": "https://github.com/line/armeria/pull/3165#discussion_r519768520", "bodyText": "Changed to use assert", "author": "trustin", "createdAt": "2020-11-09T12:24:22Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxOTc2Njc5NQ=="}], "type": "inlineReview", "revised_code": {"commit": "7eb87c8d24ab907257820fa4559b176032543449", "chunk": "diff --git a/core/src/main/java/com/linecorp/armeria/common/Flags.java b/core/src/main/java/com/linecorp/armeria/common/Flags.java\nindex 7cc13c2dcb..21846fe7a4 100644\n--- a/core/src/main/java/com/linecorp/armeria/common/Flags.java\n+++ b/core/src/main/java/com/linecorp/armeria/common/Flags.java\n\n@@ -1093,7 +1093,9 @@ public final class Flags {\n     }\n \n     private static String nonnullCaffeineSpec(String name, String defaultValue) {\n-        return requireNonNull(caffeineSpec(name, defaultValue, false));\n+        final String spec = caffeineSpec(name, defaultValue, false);\n+        assert spec != null; // Can never be null if allowOff is false.\n+        return spec;\n     }\n \n     @Nullable\n"}}, {"oid": "7eb87c8d24ab907257820fa4559b176032543449", "url": "https://github.com/line/armeria/commit/7eb87c8d24ab907257820fa4559b176032543449", "message": "Use assert instead of requireNonNull", "committedDate": "2020-11-09T12:24:02Z", "type": "commit"}, {"oid": "1bf634e0599cbe13197502bdea86816a79b11eb7", "url": "https://github.com/line/armeria/commit/1bf634e0599cbe13197502bdea86816a79b11eb7", "message": "Fix checkstyle", "committedDate": "2020-11-16T02:13:23Z", "type": "commit"}]}