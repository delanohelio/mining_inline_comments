{"pr_number": 1991, "pr_title": "Avro: Schema conversions should preserve field docs", "pr_createdAt": "2020-12-27T23:49:06Z", "pr_url": "https://github.com/apache/iceberg/pull/1991", "timeline": [{"oid": "d7c6ef6be56f68492eb0bb480dada3bf262f6b1d", "url": "https://github.com/apache/iceberg/commit/d7c6ef6be56f68492eb0bb480dada3bf262f6b1d", "message": "Handle field level doc comments when converting between avro and iceberg types", "committedDate": "2020-12-27T22:18:36Z", "type": "commit"}, {"oid": "fc851c9f77ad6be8e695c0c035c346f7e95ad12e", "url": "https://github.com/apache/iceberg/commit/fc851c9f77ad6be8e695c0c035c346f7e95ad12e", "message": "Add in test to ensure field docs are preserved in roundtrip iceberg-avro schema conversions", "committedDate": "2020-12-27T23:21:29Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIyNjczNw==", "url": "https://github.com/apache/iceberg/pull/1991#discussion_r549226737", "bodyText": "Technically this limit needs to be at least 12817 bytes.\nThat's one byte larger than the number of bins used in the tests * the size of the largest manifest file in either test run (v1 or v2, v2 is slightly larger) for the set of operations defined in the test to meet their assertions, but I chose a value slightly larger / rounded value to match somewhat how the test was previously set up.\nFeel free to suggest a different value.", "author": "kbendick", "createdAt": "2020-12-28T06:07:36Z", "path": "core/src/test/java/org/apache/iceberg/TestMergeAppend.java", "diffHunk": "@@ -239,8 +239,10 @@ public void testMergeWithExistingManifest() {\n   public void testManifestMergeMinCount() throws IOException {\n     Assert.assertEquals(\"Table should start empty\", 0, listManifestFiles().size());\n     table.updateProperties().set(TableProperties.MANIFEST_MIN_MERGE_COUNT, \"2\")\n-        // each manifest file is 5227 bytes, so 12000 bytes limit will give us 2 bins with 3 manifest/data files.\n-        .set(TableProperties.MANIFEST_TARGET_SIZE_BYTES, \"12000\")\n+        // Each initial v1/v2 ManifestFile is 5661/6397 bytes respectively. Merging two of the given\n+        // manifests make one v1/v2 ManifestFile of 5672/6408 bytes respectively, so 12850 bytes\n+        // limit will give us two bins with three manifest/data files.\n+        .set(TableProperties.MANIFEST_TARGET_SIZE_BYTES, \"12850\")", "originalCommit": "9e99c2e17b190aae09c0939338231ca3874cfaf7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ1MDE5Nw==", "url": "https://github.com/apache/iceberg/pull/1991#discussion_r549450197", "bodyText": "3x the smaller size would be around 17k, and we need it to be at least about 13k, which is 2x the larger size. I'd probably set this to 15k to split the difference and hopefully avoid needing to update this again as tests change. This is minor, though.", "author": "rdblue", "createdAt": "2020-12-28T18:46:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIyNjczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ3NzkyMA==", "url": "https://github.com/apache/iceberg/pull/1991#discussion_r549477920", "bodyText": "I'll open a patch to up this to 15k \ud83d\udc4d", "author": "kbendick", "createdAt": "2020-12-28T20:30:11Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIyNjczNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTQ4MTQxMQ==", "url": "https://github.com/apache/iceberg/pull/1991#discussion_r549481411", "bodyText": "Opened a PR for the suggested 15k value: #1999", "author": "kbendick", "createdAt": "2020-12-28T20:44:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0OTIyNjczNw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "fa3ba3cdaadeb570124609997ec05476a82fc7b5", "url": "https://github.com/apache/iceberg/commit/fa3ba3cdaadeb570124609997ec05476a82fc7b5", "message": "Update table test that uses outdated manifest file size to configure the target to merge to account for increase in manifest file header size", "committedDate": "2020-12-28T06:24:55Z", "type": "commit"}, {"oid": "fa3ba3cdaadeb570124609997ec05476a82fc7b5", "url": "https://github.com/apache/iceberg/commit/fa3ba3cdaadeb570124609997ec05476a82fc7b5", "message": "Update table test that uses outdated manifest file size to configure the target to merge to account for increase in manifest file header size", "committedDate": "2020-12-28T06:24:55Z", "type": "forcePushed"}]}