{"pr_number": 1276, "pr_title": "Spark: Provide better error message on using SparkSessionCatalog without replacing default spark catalog", "pr_createdAt": "2020-07-30T14:03:39Z", "pr_url": "https://github.com/apache/iceberg/pull/1276", "timeline": [{"oid": "bfe433b0477145abdf782462d7b87a95f7b5dbfa", "url": "https://github.com/apache/iceberg/commit/bfe433b0477145abdf782462d7b87a95f7b5dbfa", "message": "Spark: Provide better error message on using SparkSessionCatalog without replacing default spark catalog", "committedDate": "2020-07-30T13:58:16Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg2NjE5Nw==", "url": "https://github.com/apache/iceberg/pull/1276#discussion_r463866197", "bodyText": "How about adding the name of the session catalog, like this: \"Please make sure your are replacing Spark's default catalog, named 'spark_catalog'\".\nAlso, the first line makes it sound like Spark did something wrong when this is probably a misconfiguration. For that, what about changing it to \"Delegated SessionCatalog is missing\" rather that \"not provided by Spark\"?", "author": "rdblue", "createdAt": "2020-07-31T22:04:58Z", "path": "spark3/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java", "diffHunk": "@@ -280,4 +282,10 @@ private boolean useIceberg(String provider) {\n \n     return false;\n   }\n+\n+  private T getSessionCatalog() {\n+    Preconditions.checkNotNull(sessionCatalog, \"Delegated SessionCatalog is not provided by Spark. \" +\n+        \"Please make sure you are replacing Spark's default catalog.\");", "originalCommit": "bfe433b0477145abdf782462d7b87a95f7b5dbfa", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg5NjQxMg==", "url": "https://github.com/apache/iceberg/pull/1276#discussion_r463896412", "bodyText": "Ah right. I agree that's not something Spark is doing wrong and the sentence may leads misunderstanding. Thanks for the suggestion!", "author": "HeartSaVioR", "createdAt": "2020-08-01T00:31:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzg2NjE5Nw=="}], "type": "inlineReview", "revised_code": {"commit": "21ef3f0d2beb78e09f07b7803ed52736b3f3b2ef", "chunk": "diff --git a/spark3/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java b/spark3/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java\nindex 269e469ea..a1d112640 100644\n--- a/spark3/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java\n+++ b/spark3/src/main/java/org/apache/iceberg/spark/SparkSessionCatalog.java\n\n@@ -284,8 +283,8 @@ public class SparkSessionCatalog<T extends TableCatalog & SupportsNamespaces>\n   }\n \n   private T getSessionCatalog() {\n-    Preconditions.checkNotNull(sessionCatalog, \"Delegated SessionCatalog is not provided by Spark. \" +\n-        \"Please make sure you are replacing Spark's default catalog.\");\n+    Preconditions.checkNotNull(sessionCatalog, \"Delegated SessionCatalog is missing. \" +\n+        \"Please make sure your are replacing Spark's default catalog, named 'spark_catalog'.\");\n     return sessionCatalog;\n   }\n }\n"}}, {"oid": "21ef3f0d2beb78e09f07b7803ed52736b3f3b2ef", "url": "https://github.com/apache/iceberg/commit/21ef3f0d2beb78e09f07b7803ed52736b3f3b2ef", "message": "Reflect review comments", "committedDate": "2020-08-01T00:40:17Z", "type": "commit"}]}