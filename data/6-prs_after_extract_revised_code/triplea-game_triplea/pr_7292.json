{"pr_number": 7292, "pr_title": "Fix monotonic sequence issue", "pr_createdAt": "2020-08-01T15:58:02Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7292", "timeline": [{"oid": "3b7c1715f6f1290ec006a27d3c7eb522a9a6a447", "url": "https://github.com/triplea-game/triplea/commit/3b7c1715f6f1290ec006a27d3c7eb522a9a6a447", "message": "Fix monotonic sequence issue", "committedDate": "2020-08-01T15:46:25Z", "type": "commit"}, {"oid": "e20dcc018169cb961c81c492c698797792e90271", "url": "https://github.com/triplea-game/triplea/commit/e20dcc018169cb961c81c492c698797792e90271", "message": "Rename variable", "committedDate": "2020-08-01T15:50:02Z", "type": "commit"}, {"oid": "3b6446594502b4405889422f449750e85054de1b", "url": "https://github.com/triplea-game/triplea/commit/3b6446594502b4405889422f449750e85054de1b", "message": "Extend tests", "committedDate": "2020-08-01T15:54:48Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk5NzE2OA==", "url": "https://github.com/triplea-game/triplea/pull/7292#discussion_r463997168", "bodyText": "References are good, 'required references' are not. What would happen if every test case required you to go to a different issue to understand why the test case was there? I think duplicating some of the details from the issue will be enough so that you don't have to look at the issue to understand this (though the reference being there is good nonetheless so if someone wants even more details, they can get them).", "author": "DanVanAtta", "createdAt": "2020-08-01T20:25:37Z", "path": "game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java", "diffHunk": "@@ -101,4 +107,17 @@ void testCorrectParameterHandling() {\n     verify(dummyRouteDescription, times(2)).getRoute();\n     verify(dummyRouteDescription.getRoute(), atLeastOnce()).getAllTerritories();\n   }\n+\n+  /** Regression test for https://github.com/triplea-game/triplea/issues/7112 */", "originalCommit": "3b6446594502b4405889422f449750e85054de1b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1711ca6d1fff0c901116ec640f4356c1636293aa", "chunk": "diff --git a/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java b/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java\nindex 7d60134d45..1f74f133b7 100644\n--- a/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java\n+++ b/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java\n\n@@ -108,7 +108,11 @@ final class MapRouteDrawerTest {\n     verify(dummyRouteDescription.getRoute(), atLeastOnce()).getAllTerritories();\n   }\n \n-  /** Regression test for https://github.com/triplea-game/triplea/issues/7112 */\n+  /**\n+   * Regression test for https://github.com/triplea-game/triplea/issues/7112 Previously it could\n+   * happen that {@link MapRouteDrawer#newParameterizedIndex(Point2D[])} returned an array with\n+   * duplicate values, violating the monotonic sequence requirement for the spline interpolation.\n+   */\n   @Test\n   void verifySequenceIsTrulyMonotonic() {\n     final MapRouteDrawer routeDrawer = new MapRouteDrawer(mock(MapPanel.class), dummyMapData);\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Mzk5NzcyNA==", "url": "https://github.com/triplea-game/triplea/pull/7292#discussion_r463997724", "bodyText": "I think we might want to make this test parameterized and include more inputs. In this case we can assert that the output array is always equal in length to the input array and second the index checks can be converted to a simple for loop that verifies each element is less than the next.\nSome interesting test cases to consider:\n\nzero length array\nsingleton array (with zero)\nsingleton array with negative\nsingleton array with positive\nduplicate values other than zero\nout of order values\nmixture of positive and then negative values and then positive values (IE: -1, 1, -1, 1, 0, 1, -1, 0, -1)", "author": "DanVanAtta", "createdAt": "2020-08-01T20:32:19Z", "path": "game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java", "diffHunk": "@@ -101,4 +107,17 @@ void testCorrectParameterHandling() {\n     verify(dummyRouteDescription, times(2)).getRoute();\n     verify(dummyRouteDescription.getRoute(), atLeastOnce()).getAllTerritories();\n   }\n+\n+  /** Regression test for https://github.com/triplea-game/triplea/issues/7112 */\n+  @Test\n+  void verifySequenceIsTrulyMonotonic() {\n+    final MapRouteDrawer routeDrawer = new MapRouteDrawer(mock(MapPanel.class), dummyMapData);\n+    final double[] index =\n+        routeDrawer.newParameterizedIndex(\n+            new Point2D[] {new Double(0, 0), new Double(0, 0), new Double(0, 0)});", "originalCommit": "3b6446594502b4405889422f449750e85054de1b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "1711ca6d1fff0c901116ec640f4356c1636293aa", "chunk": "diff --git a/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java b/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java\nindex 7d60134d45..1f74f133b7 100644\n--- a/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java\n+++ b/game-core/src/test/java/games/strategy/triplea/ui/panels/map/MapRouteDrawerTest.java\n\n@@ -108,7 +108,11 @@ final class MapRouteDrawerTest {\n     verify(dummyRouteDescription.getRoute(), atLeastOnce()).getAllTerritories();\n   }\n \n-  /** Regression test for https://github.com/triplea-game/triplea/issues/7112 */\n+  /**\n+   * Regression test for https://github.com/triplea-game/triplea/issues/7112 Previously it could\n+   * happen that {@link MapRouteDrawer#newParameterizedIndex(Point2D[])} returned an array with\n+   * duplicate values, violating the monotonic sequence requirement for the spline interpolation.\n+   */\n   @Test\n   void verifySequenceIsTrulyMonotonic() {\n     final MapRouteDrawer routeDrawer = new MapRouteDrawer(mock(MapPanel.class), dummyMapData);\n"}}, {"oid": "1711ca6d1fff0c901116ec640f4356c1636293aa", "url": "https://github.com/triplea-game/triplea/commit/1711ca6d1fff0c901116ec640f4356c1636293aa", "message": "Update javadoc", "committedDate": "2020-08-01T23:25:48Z", "type": "commit"}, {"oid": "7bf36af110ee5efaf4680a874b19fb456a3bd3e9", "url": "https://github.com/triplea-game/triplea/commit/7bf36af110ee5efaf4680a874b19fb456a3bd3e9", "message": "Add some different parameters", "committedDate": "2020-08-02T00:16:04Z", "type": "commit"}]}