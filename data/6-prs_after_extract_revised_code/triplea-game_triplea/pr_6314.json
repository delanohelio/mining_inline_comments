{"pr_number": 6314, "pr_title": "Fix stacktrace", "pr_createdAt": "2020-04-22T21:16:38Z", "pr_url": "https://github.com/triplea-game/triplea/pull/6314", "timeline": [{"oid": "d9833bbcb38c060687ba6f22ce13ec3b151cf837", "url": "https://github.com/triplea-game/triplea/commit/d9833bbcb38c060687ba6f22ce13ec3b151cf837", "message": "Use default Stacktrace formatting", "committedDate": "2020-04-22T20:40:07Z", "type": "commit"}, {"oid": "9d303fd6795506d737482f0faf49dfb33a0fd1a8", "url": "https://github.com/triplea-game/triplea/commit/9d303fd6795506d737482f0faf49dfb33a0fd1a8", "message": "Errorprone", "committedDate": "2020-04-22T21:00:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzQxNTgzNw==", "url": "https://github.com/triplea-game/triplea/pull/6314#discussion_r413415837", "bodyText": "How do you know this works @RoiEXLab ? Are you going off of Stack Overflow, are there other examples in the code, or is this a pattern you just know?\nCan you simulate an exception going through this and give an example? Perhaps better yet, a test to do that would be excellent. It could be readily done by elavating this methodto a strategy object and then testing it. (EG:  this method becomes a class that implements Function, then testing the new class you can do a string contains assertion to verify that key words from a nested exception are all present/printed)", "author": "DanVanAtta", "createdAt": "2020-04-23T00:07:29Z", "path": "game-core/src/main/java/org/triplea/debug/error/reporting/StackTraceErrorReportFormatter.java", "diffHunk": "@@ -91,18 +92,15 @@ private String buildBody(@Nullable final String userDescription, final LogRecord\n   }\n \n   private static String throwableToString(final Throwable e) {\n+    final var outputStream = new ByteArrayOutputStream();\n+    try (PrintWriter printWriter = new PrintWriter(outputStream, false, StandardCharsets.UTF_8)) {", "originalCommit": "9d303fd6795506d737482f0faf49dfb33a0fd1a8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzYwOTI2NA==", "url": "https://github.com/triplea-game/triplea/pull/6314#discussion_r413609264", "bodyText": "It's just a pattern I know. Basically I just looked at the overloads of Throwable#printStackTrace, checked the PrintWriter constructor and added the ByteArrayOutputStream that would store it in a string for me.\nThere are already test cases in place that check for the existence of some lines:\n\n  \n    \n      triplea/game-core/src/test/java/org/triplea/debug/error/reporting/StackTraceErrorReportFormatterTest.java\n    \n    \n        Lines 137 to 150\n      in\n      b133fd9\n    \n    \n    \n    \n\n        \n          \n           @Test \n        \n\n        \n          \n           void containsStackTraceData() { \n        \n\n        \n          \n             when(logRecord.getThrown()).thenReturn(EXCEPTION_WITH_NO_MESSAGE); \n        \n\n        \n          \n             final ErrorReportRequest errorReportResult = \n        \n\n        \n          \n                 new StackTraceErrorReportFormatter().apply(SAMPLE_USER_DESCRIPTION, logRecord); \n        \n\n        \n          \n            \n        \n\n        \n          \n             Arrays.stream(EXCEPTION_WITH_NO_MESSAGE.getStackTrace()) \n        \n\n        \n          \n                 .forEach( \n        \n\n        \n          \n                     trace -> \n        \n\n        \n          \n                         assertThat( \n        \n\n        \n          \n                             \"should contain each element of stack trace\", \n        \n\n        \n          \n                             errorReportResult.getBody(), \n        \n\n        \n          \n                             containsString(trace.toString()))); \n        \n\n        \n          \n           } \n        \n    \n  \n\n\nI just realized I should maybe extend this test case so it verifies the causes are also checked", "author": "RoiEXLab", "createdAt": "2020-04-23T08:16:47Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzQxNTgzNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDMwMzQ4NA==", "url": "https://github.com/triplea-game/triplea/pull/6314#discussion_r414303484", "bodyText": "Thanks, good work @RoiEXLab", "author": "DanVanAtta", "createdAt": "2020-04-24T05:28:31Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzQxNTgzNw=="}], "type": "inlineReview", "revised_code": null}, {"oid": "256a38015bf6710394697e4e237f957de362e21b", "url": "https://github.com/triplea-game/triplea/commit/256a38015bf6710394697e4e237f957de362e21b", "message": "Extend test case", "committedDate": "2020-04-23T08:27:05Z", "type": "commit"}]}