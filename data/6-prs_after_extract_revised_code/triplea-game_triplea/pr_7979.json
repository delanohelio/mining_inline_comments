{"pr_number": 7979, "pr_title": "Throw exception when 10,000 rounds are hit in a battle", "pr_createdAt": "2020-10-28T14:57:34Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7979", "timeline": [{"oid": "84b3425ca0e597c9be7d8ad6588fb554bf0f818e", "url": "https://github.com/triplea-game/triplea/commit/84b3425ca0e597c9be7d8ad6588fb554bf0f818e", "message": "Throw exception when 10,000 rounds are hit in a battle", "committedDate": "2020-10-28T03:04:32Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzkzMTMxNw==", "url": "https://github.com/triplea-game/triplea/pull/7979#discussion_r513931317", "bodyText": "What do you think of naming this MAX_ROUNDS instead?\n\"max infinite\" does not quite grok well for me.", "author": "DanVanAtta", "createdAt": "2020-10-29T03:47:09Z", "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java", "diffHunk": "@@ -106,6 +106,8 @@\n \n   private static final long serialVersionUID = 5879502298361231540L;\n \n+  private static final long MAX_INFINITE_ROUNDS = 10000;", "originalCommit": "84b3425ca0e597c9be7d8ad6588fb554bf0f818e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f4105cf2f055d0ddc98d4239c9924a6cc488d692", "chunk": "diff --git a/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java b/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java\nindex 5068a0f1e..5858a644f 100644\n--- a/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java\n+++ b/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java\n\n@@ -106,7 +106,7 @@ public class MustFightBattle extends DependentBattle\n \n   private static final long serialVersionUID = 5879502298361231540L;\n \n-  private static final long MAX_INFINITE_ROUNDS = 10000;\n+  private static final long MAX_ROUNDS = 10000;\n \n   private final Collection<Unit> attackingWaitingToDie = new ArrayList<>();\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMzkzMTkyMQ==", "url": "https://github.com/triplea-game/triplea/pull/7979#discussion_r513931921", "bodyText": "What do you think of adding to the message \"Please report this to TripleA\"?\nA line break between this first line and the unit listing could make it an easier message to read as well.", "author": "DanVanAtta", "createdAt": "2020-10-29T03:47:42Z", "path": "game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java", "diffHunk": "@@ -1699,6 +1701,25 @@ public void execute(final ExecutionStack stack, final IDelegateBridge bridge) {\n           public void execute(final ExecutionStack stack, final IDelegateBridge bridge) {\n             if (!isOver) {\n               round++;\n+              if (round > MAX_INFINITE_ROUNDS) {\n+                // the battle appears to be in an infinite loop\n+                throw new IllegalStateException(\n+                    \"Round 10,000 reached in a battle. Something must be wrong.\"", "originalCommit": "84b3425ca0e597c9be7d8ad6588fb554bf0f818e", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "f4105cf2f055d0ddc98d4239c9924a6cc488d692", "chunk": "diff --git a/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java b/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java\nindex 5068a0f1e..5858a644f 100644\n--- a/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java\n+++ b/game-core/src/main/java/games/strategy/triplea/delegate/battle/MustFightBattle.java\n\n@@ -1701,10 +1701,12 @@ public class MustFightBattle extends DependentBattle\n           public void execute(final ExecutionStack stack, final IDelegateBridge bridge) {\n             if (!isOver) {\n               round++;\n-              if (round > MAX_INFINITE_ROUNDS) {\n+              if (round > MAX_ROUNDS) {\n                 // the battle appears to be in an infinite loop\n                 throw new IllegalStateException(\n                     \"Round 10,000 reached in a battle. Something must be wrong.\"\n+                        + \" Please report this to TripleA.\"\n+\n                         + \" Attacking unit types: \"\n                         + attackingUnits.stream()\n                             .map(Unit::getType)\n"}}, {"oid": "f4105cf2f055d0ddc98d4239c9924a6cc488d692", "url": "https://github.com/triplea-game/triplea/commit/f4105cf2f055d0ddc98d4239c9924a6cc488d692", "message": "Review feedback", "committedDate": "2020-10-29T04:01:48Z", "type": "commit"}, {"oid": "4d0732b87661d43d376e5030291fd7f0c8df4275", "url": "https://github.com/triplea-game/triplea/commit/4d0732b87661d43d376e5030291fd7f0c8df4275", "message": "Auto-Formatting", "committedDate": "2020-10-29T04:03:59Z", "type": "commit"}, {"oid": "e12649d738d2a97455f7032d953db574c050828b", "url": "https://github.com/triplea-game/triplea/commit/e12649d738d2a97455f7032d953db574c050828b", "message": "Add newline separator", "committedDate": "2020-10-29T04:20:30Z", "type": "commit"}]}