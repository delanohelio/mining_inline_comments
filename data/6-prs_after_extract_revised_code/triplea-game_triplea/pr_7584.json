{"pr_number": 7584, "pr_title": "Update: PerfTimer use throwing functions and unify timing method names to 'time'", "pr_createdAt": "2020-09-09T09:50:54Z", "pr_url": "https://github.com/triplea-game/triplea/pull/7584", "timeline": [{"oid": "d1e81eb34b062d8bd638e44553b2656dd393d2f5", "url": "https://github.com/triplea-game/triplea/commit/d1e81eb34b062d8bd638e44553b2656dd393d2f5", "message": "Update: PerfTimer use throwing functions and unify timing method names to 'time'\n\nHaving throwing functions makes using PerfTimer easier, the inner code executed\nby the function can throw without needing to be explicitly wrapped with a\nnew try/catch.", "committedDate": "2020-09-09T09:49:45Z", "type": "commit"}, {"oid": "ff50b9a90f9486d25e66a35a7d4d1d5226669857", "url": "https://github.com/triplea-game/triplea/commit/ff50b9a90f9486d25e66a35a7d4d1d5226669857", "message": "Re-order methods (fixes checkstyle), group method overloads together", "committedDate": "2020-09-09T10:07:57Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzQyMjQ0MQ==", "url": "https://github.com/triplea-game/triplea/pull/7584#discussion_r487422441", "bodyText": "In order to re-use code I would've done something like this:\ntime(() -> {\n  functionToTime.run();\n  return null;\n})", "author": "RoiEXLab", "createdAt": "2020-09-12T15:52:37Z", "path": "java-extras/src/main/java/org/triplea/performance/PerfTimer.java", "diffHunk": "@@ -61,10 +57,37 @@ public static PerfTimer startTimer(final String title) {\n    * @return the perf timer object\n    */\n   @SuppressWarnings(\"unused\")\n-  public static PerfTimer startTimer(final String title, final int reportingFrequency) {\n+  public static PerfTimer time(final String title, final int reportingFrequency) {\n     return new PerfTimer(title, reportingFrequency);\n   }\n \n+  @SuppressWarnings(\"unused\")\n+  public static PerfTimer time(final String title) {\n+    return time(title, 1);\n+  }\n+\n+  public static <T> T time(final String title, final ThrowingSupplier<T, ?> functionToTime) {\n+    final T value;\n+    try (PerfTimer timer = time(title)) {\n+      value = functionToTime.get();\n+    } catch (final Throwable throwable) {\n+      throw new IllegalStateException(\n+          \"Unexpected throwable in timed method: \" + throwable.getMessage(), throwable);\n+    }\n+    return value;\n+  }\n+\n+  public static void time(final String title, final ThrowingRunnable<?> functionToTime) {\n+    try (PerfTimer timer = time(title)) {\n+      try {\n+        functionToTime.run();\n+      } catch (final Throwable throwable) {\n+        throw new IllegalStateException(\n+            \"Unexpected throwable in timed method: \" + throwable.getMessage(), throwable);\n+      }\n+    }\n+  }", "originalCommit": "ff50b9a90f9486d25e66a35a7d4d1d5226669857", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}