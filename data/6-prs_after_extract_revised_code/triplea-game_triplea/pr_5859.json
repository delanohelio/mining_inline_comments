{"pr_number": 5859, "pr_title": "Simplify child classes of  AbstractForumPoster", "pr_createdAt": "2020-01-20T05:15:02Z", "pr_url": "https://github.com/triplea-game/triplea/pull/5859", "timeline": [{"oid": "f60d13b21a33d0470ca70c1803223a4e5452cf99", "url": "https://github.com/triplea-game/triplea/commit/f60d13b21a33d0470ca70c1803223a4e5452cf99", "message": "Refactor, consolidate unncessary method overrides into abstract class and inline.", "committedDate": "2020-01-20T03:01:28Z", "type": "commit"}, {"oid": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "url": "https://github.com/triplea-game/triplea/commit/50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "message": "Consolidate abstract methods, fix data clump code smell.\n\nThe two abstract classes EndTurnPanel and MoveForumPosterPanel override\n4 boolean returning methods and each returns the same value for each\nmethod override. These 4 methods can be replaced with a single method.", "committedDate": "2020-01-20T03:01:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3MjkwNw==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368372907", "bodyText": "This is a consolidation of the 4 parameters to one, each child class was uniform in returning a true or false, so we only need one value here.", "author": "DanVanAtta", "createdAt": "2020-01-20T05:17:17Z", "path": "game-core/src/main/java/games/strategy/engine/pbem/ForumPosterComponent.java", "diffHunk": "@@ -90,10 +90,7 @@ public ForumPosterComponent layoutComponents(\n       final IAbstractForumPosterDelegate forumPosterDelegate,\n       final TripleAFrame frame,\n       final boolean hasPosted,\n-      final boolean allowIncludeTerritorySummary,\n-      final boolean allowIncludeProductionSummary,\n-      final boolean allowDiceBattleDetails,\n-      final boolean allowDiceStatistics) {\n+      final boolean includeDetailsAndSummary) {", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3Mjk3NQ==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368372975", "bodyText": "Small simplification, change from a method reference to qualifier.", "author": "DanVanAtta", "createdAt": "2020-01-20T05:17:38Z", "path": "game-core/src/main/java/games/strategy/engine/pbem/ForumPosterComponent.java", "diffHunk": "@@ -126,7 +117,7 @@ public ForumPosterComponent layoutComponents(\n     add(\n         new JButtonBuilder()\n             .title(\"Done\")\n-            .actionListener(doneAction::run)\n+            .actionListener(doneAction)", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3MzEzNQ==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368373135", "bodyText": "Both child classes instatiated and set the parent 'forumPosterComponent' exactly the same way in their constructors. Consolidated this to the parent class here.", "author": "DanVanAtta", "createdAt": "2020-01-20T05:18:42Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/AbstractForumPosterPanel.java", "diffHunk": "@@ -17,13 +17,14 @@\n \n   IPlayerBridge playerBridge;\n   PbemMessagePoster pbemMessagePoster;\n-  ForumPosterComponent forumPosterComponent;\n+  final ForumPosterComponent forumPosterComponent;\n   private final JLabel actionLabel;\n   private TripleAFrame tripleAFrame;\n \n   AbstractForumPosterPanel(final GameData data, final MapPanel map) {\n     super(data, map);\n     actionLabel = new JLabel();\n+    forumPosterComponent = new ForumPosterComponent(data, this::performDone, getTitle());", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3MzIwOQ==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368373209", "bodyText": "Inlined this method, used to be an abstract, both child classes had the same implementation.", "author": "DanVanAtta", "createdAt": "2020-01-20T05:19:14Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/AbstractForumPosterPanel.java", "diffHunk": "@@ -78,21 +66,21 @@ protected void waitForDone(final TripleAFrame frame, final IPlayerBridge bridge)\n     if (skipPosting() || GameStepPropertiesHelper.isSkipPosting(getData())) {\n       return;\n     }\n-    final boolean hasPosted = getHasPostedTurnSummary();\n+\n+    final boolean hasPosted =\n+        ((IAbstractForumPosterDelegate) playerBridge.getRemoteDelegate()).getHasPostedTurnSummary();", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3MzI1MA==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368373250", "bodyText": "Ditto on inline of duplicate implementations.", "author": "DanVanAtta", "createdAt": "2020-01-20T05:19:29Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/AbstractForumPosterPanel.java", "diffHunk": "@@ -78,21 +66,21 @@ protected void waitForDone(final TripleAFrame frame, final IPlayerBridge bridge)\n     if (skipPosting() || GameStepPropertiesHelper.isSkipPosting(getData())) {\n       return;\n     }\n-    final boolean hasPosted = getHasPostedTurnSummary();\n+\n+    final boolean hasPosted =\n+        ((IAbstractForumPosterDelegate) playerBridge.getRemoteDelegate()).getHasPostedTurnSummary();\n+\n     SwingUtilities.invokeLater(\n         () -> {\n           removeAll();\n           add(actionLabel);\n           add(\n               forumPosterComponent.layoutComponents(\n                   pbemMessagePoster,\n-                  getForumPosterDelegate(),\n+                  (IAbstractForumPosterDelegate) playerBridge.getRemoteDelegate(),", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3MzM0Nw==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368373347", "bodyText": "'waitForEndTurn' just calls 'waitForDone'. The child implementations in both cases just called their parent class. So we can remove the 'waitForEndturn' method, and remove the 'waitForDone' overrides on the child classes.", "author": "DanVanAtta", "createdAt": "2020-01-20T05:20:10Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/ActionButtons.java", "diffHunk": "@@ -253,7 +253,7 @@ public PlaceData waitForPlace(final boolean bid, final IPlayerBridge bridge) {\n \n   /** Blocks until the user selects an end-of-turn action. */\n   public void waitForEndTurn(final TripleAFrame frame, final IPlayerBridge bridge) {\n-    endTurnPanel.waitForEndTurn(frame, bridge);\n+    endTurnPanel.waitForDone(frame, bridge);", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODM3NDk5Mg==", "url": "https://github.com/triplea-game/triplea/pull/5859#discussion_r368374992", "bodyText": "This is really odd code, I don't think there is an effect here to the override. Until the 'play' button is fixed, should probably wait on manual verification of the component before removing.\nThe 'toString' gets passed as a constraints object (ActionButtons.java):\n add(battlePanel, battlePanel.toString());\n    add(this.movePanel, this.movePanel.toString());\n    add(repairPanel, repairPanel.toString());\n    add(purchasePanel, purchasePanel.toString());\n    add(placePanel, placePanel.toString());\n    add(techPanel, techPanel.toString());\n    add(endTurnPanel, endTurnPanel.toString());\n    add(moveForumPosterPanel, moveForumPosterPanel.toString());\n    add(politicsPanel, politicsPanel.toString());\n    add(userActionPanel, userActionPanel.toString());\n    add(pickTerritoryAndUnitsPanel, pickTerritoryAndUnitsPanel.toString()); \n\nIn Container.java:\n                } else if (constraints instanceof String) {\n                    layoutMgr.addLayoutComponent((String)constraints, comp);\n                }", "author": "DanVanAtta", "createdAt": "2020-01-20T05:29:48Z", "path": "game-core/src/main/java/games/strategy/triplea/ui/AbstractForumPosterPanel.java", "diffHunk": "@@ -47,26 +48,13 @@ public void display(final GamePlayer gamePlayer) {\n         });\n   }\n \n-  protected abstract boolean allowIncludeTerritorySummary();\n-\n-  protected abstract boolean allowIncludeProductionSummary();\n-\n-  protected abstract boolean allowDiceBattleDetails();\n-\n-  protected abstract boolean allowDiceStatistics();\n-\n-  protected abstract IAbstractForumPosterDelegate getForumPosterDelegate();\n-\n-  protected abstract boolean getHasPostedTurnSummary();\n+  protected abstract boolean includeDetailsAndSummary();\n \n   protected abstract boolean skipPosting();\n \n   protected abstract String getTitle();\n \n-  @Override\n-  public abstract String toString();", "originalCommit": "50404931a0974bd5f4f89a01bfcf95fa5c5c34d8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "a7b6e8d6b8fb6922d75ec8093a45e7e2a57917d1", "url": "https://github.com/triplea-game/triplea/commit/a7b6e8d6b8fb6922d75ec8093a45e7e2a57917d1", "message": "Restore toString overrides until it can be sure it is safe to remove", "committedDate": "2020-01-20T05:30:52Z", "type": "commit"}]}