{"pr_number": 12540, "pr_title": "[BEAM-10620] Eliminate nullability errors from :sdks:java:extensions:sql:perf-tests", "pr_createdAt": "2020-08-12T06:52:08Z", "pr_url": "https://github.com/apache/beam/pull/12540", "timeline": [{"oid": "965716e7b018ecc80b561f9f17dd76f50746a838", "url": "https://github.com/apache/beam/commit/965716e7b018ecc80b561f9f17dd76f50746a838", "message": "[BEAM-10620] Eliminate nullability errors from :sdks:java:extensions:sql:perf-tests", "committedDate": "2020-08-12T06:50:23Z", "type": "commit"}, {"oid": "da9737272e801fa24a126713bb0c37e60faccebe", "url": "https://github.com/apache/beam/commit/da9737272e801fa24a126713bb0c37e60faccebe", "message": "fixing checkstyle error", "committedDate": "2020-08-12T07:10:30Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg4MjgwMw==", "url": "https://github.com/apache/beam/pull/12540#discussion_r485882803", "bodyText": "This change is curious. The setInfluxDatabase method accepts null, so this value should also be nullable. Should you change the setter as well? Or is there something else going on?", "author": "kennknowles", "createdAt": "2020-09-09T19:55:09Z", "path": "sdks/java/io/common/src/test/java/org/apache/beam/sdk/io/common/IOTestPipelineOptions.java", "diffHunk": "@@ -45,19 +45,16 @@\n   void setBigQueryTable(@Nullable String tableName);\n \n   @Description(\"InfluxDB measurement to publish results to.\")\n-  @Nullable\n   String getInfluxMeasurement();\n \n   void setInfluxMeasurement(@Nullable String measurement);\n \n   @Description(\"InfluxDB host.\")\n-  @Nullable\n   String getInfluxHost();\n \n   void setInfluxHost(@Nullable String host);\n \n   @Description(\"InfluxDB database.\")\n-  @Nullable", "originalCommit": "da9737272e801fa24a126713bb0c37e60faccebe", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NzM1MzkyOA==", "url": "https://github.com/apache/beam/pull/12540#discussion_r487353928", "bodyText": "I removed those nullable as it was expecting these fields non-null here via, this. I removed the Nullable from here thinking of it as a test code and InfluxDBSettings.java as a non-test code.\nAnnotating the corresponding fields at InfluxDBSettings.java as Nullable also should work.\nShould I go with that?", "author": "jayendra13", "createdAt": "2020-09-12T02:04:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg4MjgwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODEwNDY4OQ==", "url": "https://github.com/apache/beam/pull/12540#discussion_r488104689", "bodyText": "Ah that makes sense. What you should do, I think, is alter setInfluxDatabase so the parameter is non-nullable. Otherwise somehow the pipeline options would be magically turning null into non-null.", "author": "kennknowles", "createdAt": "2020-09-14T17:30:18Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg4MjgwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4ODY5MDQwNA==", "url": "https://github.com/apache/beam/pull/12540#discussion_r488690404", "bodyText": "So these three getters (for measurements, host and database) are fine, and we should also change these three setters to take non-null arguments. Correct me if I am wrong.", "author": "jayendra13", "createdAt": "2020-09-15T13:58:48Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg4MjgwMw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4OTgwODYwMQ==", "url": "https://github.com/apache/beam/pull/12540#discussion_r489808601", "bodyText": "Yes, exactly. I wonder if we can alter the core PipelineOptions code that generates the proxy objects to ensure that the nullability matches... (if you want an extra fun follow up project...)", "author": "kennknowles", "createdAt": "2020-09-16T23:29:30Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NTg4MjgwMw=="}], "type": "inlineReview", "revised_code": {"commit": "73f572f609a7cad5958cede4e5d3720724bbdf1c", "chunk": "diff --git a/sdks/java/io/common/src/test/java/org/apache/beam/sdk/io/common/IOTestPipelineOptions.java b/sdks/java/io/common/src/test/java/org/apache/beam/sdk/io/common/IOTestPipelineOptions.java\nindex 260a67202e..cc66fb9771 100644\n--- a/sdks/java/io/common/src/test/java/org/apache/beam/sdk/io/common/IOTestPipelineOptions.java\n+++ b/sdks/java/io/common/src/test/java/org/apache/beam/sdk/io/common/IOTestPipelineOptions.java\n\n@@ -47,15 +47,15 @@ public interface IOTestPipelineOptions extends TestPipelineOptions {\n   @Description(\"InfluxDB measurement to publish results to.\")\n   String getInfluxMeasurement();\n \n-  void setInfluxMeasurement(@Nullable String measurement);\n+  void setInfluxMeasurement(String measurement);\n \n   @Description(\"InfluxDB host.\")\n   String getInfluxHost();\n \n-  void setInfluxHost(@Nullable String host);\n+  void setInfluxHost(String host);\n \n   @Description(\"InfluxDB database.\")\n   String getInfluxDatabase();\n \n-  void setInfluxDatabase(@Nullable String database);\n+  void setInfluxDatabase(String database);\n }\n"}}, {"oid": "73f572f609a7cad5958cede4e5d3720724bbdf1c", "url": "https://github.com/apache/beam/commit/73f572f609a7cad5958cede4e5d3720724bbdf1c", "message": "removing nullable annotations for setters", "committedDate": "2020-09-17T12:44:40Z", "type": "commit"}]}