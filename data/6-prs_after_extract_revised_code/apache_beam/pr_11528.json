{"pr_number": 11528, "pr_title": "[BEAM-9821] Populate all SpannerIO batching parameters in display data.", "pr_createdAt": "2020-04-26T16:31:25Z", "pr_url": "https://github.com/apache/beam/pull/11528", "timeline": [{"oid": "3105f6edf22a45d0b6f62bdcb8521d5ede7c797c", "url": "https://github.com/apache/beam/commit/3105f6edf22a45d0b6f62bdcb8521d5ede7c797c", "message": "Populate all SpannerIO batching parameters in display data.\n\nAdd all the grouping/batching parameters in SpannerIO\npopulateDisplayData().", "committedDate": "2020-04-27T11:08:31Z", "type": "forcePushed"}, {"oid": "89c24f3aafc2d4c6855f8ea1074969bb98ddcdc0", "url": "https://github.com/apache/beam/commit/89c24f3aafc2d4c6855f8ea1074969bb98ddcdc0", "message": "Populate all SpannerIO batching parameters in display data.\n\nAdd all the grouping/batching parameters in SpannerIO\npopulateDisplayData().", "committedDate": "2020-05-01T11:19:11Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NTI2MA==", "url": "https://github.com/apache/beam/pull/11528#discussion_r425385260", "bodyText": "I added some commits to tweak these descriptions a bit. @nielm can you confirm that they're still correct?\nAlso I wonder if you can re-use the implementation in Write by calling spec.populateDisplayData(builder) here instead?", "author": "TheNeuralBit", "createdAt": "2020-05-14T19:40:07Z", "path": "sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/spanner/SpannerIO.java", "diffHunk": "@@ -991,6 +1001,24 @@ public WriteGrouped(Write spec) {\n       this.spec = spec;\n     }\n \n+    @Override\n+    public void populateDisplayData(DisplayData.Builder builder) {\n+      super.populateDisplayData(builder);\n+      spec.getSpannerConfig().populateDisplayData(builder);\n+      builder.add(\n+          DisplayData.item(\"batchSizeBytes\", spec.getBatchSizeBytes())\n+              .withLabel(\"Max batch size in sytes\"));\n+      builder.add(\n+          DisplayData.item(\"maxNumMutations\", spec.getMaxNumMutations())\n+              .withLabel(\"Max number of mutated cells in each batch\"));\n+      builder.add(\n+          DisplayData.item(\"maxNumRows\", spec.getMaxNumRows())\n+              .withLabel(\"Max number of rows in each batch\"));\n+      builder.add(\n+          DisplayData.item(\"groupingFactor\", spec.getGroupingFactor())\n+              .withLabel(\"Number of batches to sort over\"));\n+    }\n+", "originalCommit": "9da28e7e9c06332c52446385801539be7b6842b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjkyNjYzOQ==", "url": "https://github.com/apache/beam/pull/11528#discussion_r426926639", "bodyText": "LGTM.\nI extracted a single method in Write to populate the displayData with parameters to avoid repeating code.", "author": "nielm", "createdAt": "2020-05-18T22:29:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTM4NTI2MA=="}], "type": "inlineReview", "revised_code": {"commit": "7c81b93fc980b985e91c88203088f8222684bd2b", "chunk": "diff --git a/sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/spanner/SpannerIO.java b/sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/spanner/SpannerIO.java\nindex c113b495b3..9e6fee8e9f 100644\n--- a/sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/spanner/SpannerIO.java\n+++ b/sdks/java/io/google-cloud-platform/src/main/java/org/apache/beam/sdk/io/gcp/spanner/SpannerIO.java\n\n@@ -1007,13 +1008,13 @@ public class SpannerIO {\n       spec.getSpannerConfig().populateDisplayData(builder);\n       builder.add(\n           DisplayData.item(\"batchSizeBytes\", spec.getBatchSizeBytes())\n-              .withLabel(\"Max batch size in sytes\"));\n+              .withLabel(\"Max batch Size in Bytes\"));\n       builder.add(\n           DisplayData.item(\"maxNumMutations\", spec.getMaxNumMutations())\n-              .withLabel(\"Max number of mutated cells in each batch\"));\n+              .withLabel(\"Max number of mutated cells in batches\"));\n       builder.add(\n           DisplayData.item(\"maxNumRows\", spec.getMaxNumRows())\n-              .withLabel(\"Max number of rows in each batch\"));\n+              .withLabel(\"Max number of rows in Batches\"));\n       builder.add(\n           DisplayData.item(\"groupingFactor\", spec.getGroupingFactor())\n               .withLabel(\"Number of batches to sort over\"));\n"}}, {"oid": "7c81b93fc980b985e91c88203088f8222684bd2b", "url": "https://github.com/apache/beam/commit/7c81b93fc980b985e91c88203088f8222684bd2b", "message": "Populate all SpannerIO batching parameters in display data.\n\nAdd all the grouping/batching parameters in SpannerIO\npopulateDisplayData().", "committedDate": "2020-05-18T23:41:56Z", "type": "commit"}, {"oid": "9ded9e299b4ffe662437f17315aea6477ff4bcd7", "url": "https://github.com/apache/beam/commit/9ded9e299b4ffe662437f17315aea6477ff4bcd7", "message": "Fix capitalization, clarify descriptions", "committedDate": "2020-05-18T23:41:56Z", "type": "commit"}, {"oid": "192e9ad146779c7ec5dd2ec6e3ffcbb94ff1f8aa", "url": "https://github.com/apache/beam/commit/192e9ad146779c7ec5dd2ec6e3ffcbb94ff1f8aa", "message": "fix capitalization, clarify description Grouped", "committedDate": "2020-05-18T23:41:57Z", "type": "commit"}, {"oid": "30a68f57ab7803560d2e079479de161165ba08c8", "url": "https://github.com/apache/beam/commit/30a68f57ab7803560d2e079479de161165ba08c8", "message": "Refactor to extract single method for popuplating displayData", "committedDate": "2020-05-18T23:41:57Z", "type": "commit"}, {"oid": "30a68f57ab7803560d2e079479de161165ba08c8", "url": "https://github.com/apache/beam/commit/30a68f57ab7803560d2e079479de161165ba08c8", "message": "Refactor to extract single method for popuplating displayData", "committedDate": "2020-05-18T23:41:57Z", "type": "forcePushed"}]}