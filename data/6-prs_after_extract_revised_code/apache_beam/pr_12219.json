{"pr_number": 12219, "pr_title": "Refactor time functions test out of giant ZetaSqlDialectSpecTest", "pr_createdAt": "2020-07-10T18:27:22Z", "pr_url": "https://github.com/apache/beam/pull/12219", "timeline": [{"oid": "e00ba4427d0cbe81ac822953b433089cf18140d3", "url": "https://github.com/apache/beam/commit/e00ba4427d0cbe81ac822953b433089cf18140d3", "message": "Refactor time functions test out of giant ZetaSqlDialectSpecTest", "committedDate": "2020-07-10T18:16:35Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA2NDU2NA==", "url": "https://github.com/apache/beam/pull/12219#discussion_r453064564", "bodyText": "Can you explain the scope of this test class in the Javadoc comment? i.e. list the types covered (DATE, TIME, ...)", "author": "ibzib", "createdAt": "2020-07-10T20:33:50Z", "path": "sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSqlTimeFunctionsTest.java", "diffHunk": "@@ -0,0 +1,1214 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.beam.sdk.extensions.sql.zetasql;\n+\n+import static org.apache.beam.sdk.extensions.sql.zetasql.DateTimeUtils.parseDateToValue;\n+import static org.apache.beam.sdk.extensions.sql.zetasql.DateTimeUtils.parseTimeToValue;\n+import static org.apache.beam.sdk.extensions.sql.zetasql.DateTimeUtils.parseTimestampWithTZToValue;\n+import static org.apache.beam.sdk.extensions.sql.zetasql.DateTimeUtils.parseTimestampWithTimeZone;\n+import static org.apache.beam.sdk.extensions.sql.zetasql.DateTimeUtils.parseTimestampWithUTCTimeZone;\n+\n+import com.google.zetasql.SqlException;\n+import com.google.zetasql.Value;\n+import com.google.zetasql.ZetaSQLType.TypeKind;\n+import java.time.LocalDate;\n+import java.time.LocalTime;\n+import org.apache.beam.sdk.extensions.sql.impl.BeamSqlPipelineOptions;\n+import org.apache.beam.sdk.extensions.sql.impl.rel.BeamRelNode;\n+import org.apache.beam.sdk.extensions.sql.impl.rel.BeamSqlRelUtils;\n+import org.apache.beam.sdk.schemas.Schema;\n+import org.apache.beam.sdk.schemas.Schema.FieldType;\n+import org.apache.beam.sdk.schemas.logicaltypes.SqlTypes;\n+import org.apache.beam.sdk.testing.PAssert;\n+import org.apache.beam.sdk.testing.TestPipeline;\n+import org.apache.beam.sdk.values.PCollection;\n+import org.apache.beam.sdk.values.Row;\n+import org.apache.beam.vendor.guava.v26_0_jre.com.google.common.collect.ImmutableMap;\n+import org.joda.time.Duration;\n+import org.junit.Before;\n+import org.junit.Ignore;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ExpectedException;\n+import org.junit.runner.RunWith;\n+import org.junit.runners.JUnit4;\n+\n+/** ZetaSqlTimeFunctionsTest. */", "originalCommit": "e00ba4427d0cbe81ac822953b433089cf18140d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3OTg1Mw==", "url": "https://github.com/apache/beam/pull/12219#discussion_r453079853", "bodyText": "Thanks for pointing this out. Updated several class comments.", "author": "robinyqiu", "createdAt": "2020-07-10T21:13:24Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA2NDU2NA=="}], "type": "inlineReview", "revised_code": {"commit": "a3cd4736160a4619c7a7b860e2f6c52e192a245c", "chunk": "diff --git a/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSqlTimeFunctionsTest.java b/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSqlTimeFunctionsTest.java\nindex 2059efbc2c..5f8e008782 100644\n--- a/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSqlTimeFunctionsTest.java\n+++ b/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/ZetaSqlTimeFunctionsTest.java\n\n@@ -48,7 +48,7 @@ import org.junit.rules.ExpectedException;\n import org.junit.runner.RunWith;\n import org.junit.runners.JUnit4;\n \n-/** ZetaSqlTimeFunctionsTest. */\n+/** Tests for ZetaSQL time functions (DATE, TIME, DATETIME, and TIMESTAMP functions). */\n @RunWith(JUnit4.class)\n public class ZetaSqlTimeFunctionsTest extends ZetaSqlTestBase {\n \n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA2NjU3OQ==", "url": "https://github.com/apache/beam/pull/12219#discussion_r453066579", "bodyText": "I know it isn't new, but this comment should be more descriptive. (Maybe Tests for ZetaSQL windowing functions (TUMBLE, HOP, and SESSION).)", "author": "ibzib", "createdAt": "2020-07-10T20:39:15Z", "path": "sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/StreamingSqlTest.java", "diffHunk": "@@ -39,16 +39,15 @@\n import org.junit.runner.RunWith;\n import org.junit.runners.JUnit4;\n \n-/** StreamingSQLTest. */\n+/** StreamingSqlTest. */", "originalCommit": "e00ba4427d0cbe81ac822953b433089cf18140d3", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA3OTkwNA==", "url": "https://github.com/apache/beam/pull/12219#discussion_r453079904", "bodyText": "Done.", "author": "robinyqiu", "createdAt": "2020-07-10T21:13:33Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzA2NjU3OQ=="}], "type": "inlineReview", "revised_code": {"commit": "a3cd4736160a4619c7a7b860e2f6c52e192a245c", "chunk": "diff --git a/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/StreamingSqlTest.java b/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/StreamingSqlTest.java\nindex 0304086780..4f985ee9af 100644\n--- a/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/StreamingSqlTest.java\n+++ b/sdks/java/extensions/sql/zetasql/src/test/java/org/apache/beam/sdk/extensions/sql/zetasql/StreamingSqlTest.java\n\n@@ -39,7 +39,7 @@ import org.junit.rules.ExpectedException;\n import org.junit.runner.RunWith;\n import org.junit.runners.JUnit4;\n \n-/** StreamingSqlTest. */\n+/** Tests for ZetaSQL windowing functions (TUMBLE, HOP, and SESSION). */\n @RunWith(JUnit4.class)\n public class StreamingSqlTest extends ZetaSqlTestBase {\n   @Rule public transient TestPipeline pipeline = TestPipeline.create();\n"}}, {"oid": "a3cd4736160a4619c7a7b860e2f6c52e192a245c", "url": "https://github.com/apache/beam/commit/a3cd4736160a4619c7a7b860e2f6c52e192a245c", "message": "Update javadoc", "committedDate": "2020-07-10T21:12:34Z", "type": "commit"}]}