{"pr_number": 13294, "pr_title": "[BEAM-11193]: Fix KeyedTimerData in Samza Runner", "pr_createdAt": "2020-11-10T19:14:26Z", "pr_url": "https://github.com/apache/beam/pull/13294", "timeline": [{"oid": "a5b58fc540f63158a79af0e8c271266b8fba063d", "url": "https://github.com/apache/beam/commit/a5b58fc540f63158a79af0e8c271266b8fba063d", "message": "BEAM-11193: Fix KeyedTimerData\n\noutputTimestamp is a new field added to KeyedTimerData recently, which should be encoded/decoded at last.", "committedDate": "2020-11-10T19:12:43Z", "type": "commit"}, {"oid": "fc274f60f464aa6f1678c53e5de16c5cfbf6ec3f", "url": "https://github.com/apache/beam/commit/fc274f60f464aa6f1678c53e5de16c5cfbf6ec3f", "message": "Fix style", "committedDate": "2020-11-10T19:18:49Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyMjYxNQ==", "url": "https://github.com/apache/beam/pull/13294#discussion_r521522615", "bodyText": "Ideally, this field should be put immediately after \"timestamp\" field so that when perform a range query, the earliest entries will be processed first.  The assumption for this fix is that the outputTimestamp will not contribute to the order of range query.", "author": "dengpanyin", "createdAt": "2020-11-11T17:32:37Z", "path": "runners/samza/src/main/java/org/apache/beam/runners/samza/runtime/KeyedTimerData.java", "diffHunk": "@@ -170,13 +170,13 @@ public void encode(KeyedTimerData<K> value, OutputStream outStream)\n       }\n \n       STRING_CODER.encode(timer.getTimerFamilyId(), outStream);\n+      INSTANT_CODER.encode(timer.getOutputTimestamp(), outStream);", "originalCommit": "fc274f60f464aa6f1678c53e5de16c5cfbf6ec3f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUyMzI0MA==", "url": "https://github.com/apache/beam/pull/13294#discussion_r521523240", "bodyText": "Maybe add a comment saying this condition is used for version upgrade, can be cleaned up later.", "author": "dengpanyin", "createdAt": "2020-11-11T17:33:49Z", "path": "runners/samza/src/main/java/org/apache/beam/runners/samza/runtime/KeyedTimerData.java", "diffHunk": "@@ -197,6 +197,8 @@ public void encode(KeyedTimerData<K> value, OutputStream outStream)\n       }\n \n       final String timerFamilyId = inStream.available() > 0 ? STRING_CODER.decode(inStream) : \"\";\n+      final Instant outputTimestamp =", "originalCommit": "fc274f60f464aa6f1678c53e5de16c5cfbf6ec3f", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}