{"pr_number": 11405, "pr_title": "[BEAM-9747] Deprecate RedisIO.readAll() and add RedisIO.readKeyPatterns as a replacement", "pr_createdAt": "2020-04-13T19:57:12Z", "pr_url": "https://github.com/apache/beam/pull/11405", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0OTcxNw==", "url": "https://github.com/apache/beam/pull/11405#discussion_r440349717", "bodyText": "There is API breakage here since some users could rely on the fact that readAll() returns ReadAll. I think we should keep the same signature for now but just deprecate it. Then remove it after 3 releases or change it to make consistent with all other ReadAll patterns that take PCollection<Read> as an input.\nIn the same time, we still can add a new transform ReadKeyPatterns, available through readKeyPatterns(), and ask users to use it instead.", "author": "aromanenko-dev", "createdAt": "2020-06-15T17:58:09Z", "path": "sdks/java/io/redis/src/main/java/org/apache/beam/sdk/io/redis/RedisIO.java", "diffHunk": "@@ -123,8 +123,24 @@ public static Read read() {\n    * Like {@link #read()} but executes multiple instances of the Redis query substituting each\n    * element of a {@link PCollection} as key pattern.\n    */\n-  public static ReadAll readAll() {\n-    return new AutoValue_RedisIO_ReadAll.Builder()\n+  public static ReadKeyPatterns readKeyPatterns() {\n+    return new AutoValue_RedisIO_ReadKeyPatterns.Builder()\n+        .setConnectionConfiguration(RedisConnectionConfiguration.create())\n+        .setBatchSize(1000)\n+        .setOutputParallelization(true)\n+        .build();\n+  }\n+\n+  /**\n+   * Like {@link #read()} but executes multiple instances of the Redis query substituting each\n+   * element of a {@link PCollection} as key pattern.\n+   *\n+   * @deprecated This method is not consistent with the readAll pattern of other transforms and will\n+   *     be remove soon. Please update you code to use {@link #readKeyPatterns()} instead.\n+   */\n+  @Deprecated\n+  public static ReadKeyPatterns readAll() {", "originalCommit": "8ff459eaaf30b706f07a09d95f58ed154afffe47", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDkzNjI1OQ==", "url": "https://github.com/apache/beam/pull/11405#discussion_r440936259", "bodyText": "Yes I will adjust it. Thanks", "author": "iemejia", "createdAt": "2020-06-16T15:20:37Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0OTcxNw=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODAxNDcyNQ==", "url": "https://github.com/apache/beam/pull/11405#discussion_r448014725", "bodyText": "Hello! how can I to use this version ?? I cant' see how to compile and to use with an development which I have problems using RedisIO.readAll(), as I see this versi\u00f3n solved this issue. Please your help, All the best!", "author": "n3lsok", "createdAt": "2020-06-30T22:28:56Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDM0OTcxNw=="}], "type": "inlineReview", "revised_code": {"commit": "cf1d32d356149c9e3882103bd1a99cfb2537f558", "chunk": "diff --git a/sdks/java/io/redis/src/main/java/org/apache/beam/sdk/io/redis/RedisIO.java b/sdks/java/io/redis/src/main/java/org/apache/beam/sdk/io/redis/RedisIO.java\nindex 77fbb6aa10..af958ca26d 100644\n--- a/sdks/java/io/redis/src/main/java/org/apache/beam/sdk/io/redis/RedisIO.java\n+++ b/sdks/java/io/redis/src/main/java/org/apache/beam/sdk/io/redis/RedisIO.java\n\n@@ -122,9 +122,13 @@ public class RedisIO {\n   /**\n    * Like {@link #read()} but executes multiple instances of the Redis query substituting each\n    * element of a {@link PCollection} as key pattern.\n+   *\n+   * @deprecated This method is not consistent with the readAll pattern of other transforms and will\n+   *     be remove soon. Please update you code to use {@link #readKeyPatterns()} instead.\n    */\n-  public static ReadKeyPatterns readKeyPatterns() {\n-    return new AutoValue_RedisIO_ReadKeyPatterns.Builder()\n+  @Deprecated\n+  public static ReadAll readAll() {\n+    return new AutoValue_RedisIO_ReadAll.Builder()\n         .setConnectionConfiguration(RedisConnectionConfiguration.create())\n         .setBatchSize(1000)\n         .setOutputParallelization(true)\n"}}, {"oid": "cf1d32d356149c9e3882103bd1a99cfb2537f558", "url": "https://github.com/apache/beam/commit/cf1d32d356149c9e3882103bd1a99cfb2537f558", "message": "[BEAM-9747] Deprecate RedisIO.readAll() and add RedisIO.readKeyPatterns as a replacement", "committedDate": "2020-06-20T20:45:56Z", "type": "forcePushed"}, {"oid": "c37efb737d3607ec395831cbf0553368cb3ac92b", "url": "https://github.com/apache/beam/commit/c37efb737d3607ec395831cbf0553368cb3ac92b", "message": "[BEAM-9747] Deprecate RedisIO.readAll() and add RedisIO.readKeyPatterns as a replacement", "committedDate": "2020-06-20T20:51:10Z", "type": "commit"}, {"oid": "c37efb737d3607ec395831cbf0553368cb3ac92b", "url": "https://github.com/apache/beam/commit/c37efb737d3607ec395831cbf0553368cb3ac92b", "message": "[BEAM-9747] Deprecate RedisIO.readAll() and add RedisIO.readKeyPatterns as a replacement", "committedDate": "2020-06-20T20:51:10Z", "type": "forcePushed"}]}