{"pr_number": 3596, "pr_title": "Fix a possible NPE", "pr_createdAt": "2020-05-07T14:19:15Z", "pr_url": "https://github.com/kitodo/kitodo-production/pull/3596", "timeline": [{"oid": "8a53739d40bace57ad346ef0187cbeb464627dcb", "url": "https://github.com/kitodo/kitodo-production/commit/8a53739d40bace57ad346ef0187cbeb464627dcb", "message": "Fix a possible NPE", "committedDate": "2020-05-07T14:18:50Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTYzODUzMA==", "url": "https://github.com/kitodo/kitodo-production/pull/3596#discussion_r421638530", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                            .parse(Objects.nonNull(metadataLanguage) && !metadataLanguage.isEmpty() ? metadataLanguage : \"en\");\n          \n          \n            \n                            .parse(StringUtils.isBlank(metadataLanguage) ? metadataLanguage : \"en\");", "author": "Kathrin-Huber", "createdAt": "2020-05-07T16:33:06Z", "path": "Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java", "diffHunk": "@@ -227,7 +227,8 @@ private ValidationResult checkTheIdentifier(Workpiece workpiece) throws DAOExcep\n         User user = ServiceManager.getUserService().getAuthenticatedUser();\n         String metadataLanguage = user != null ? user.getMetadataLanguage()\n                 : Helper.getRequestParameter(\"Accept-Language\");\n-        return LanguageRange.parse(! metadataLanguage.isEmpty() ? metadataLanguage : \"en\");\n+        return LanguageRange\n+                .parse(Objects.nonNull(metadataLanguage) && !metadataLanguage.isEmpty() ? metadataLanguage : \"en\");", "originalCommit": "8a53739d40bace57ad346ef0187cbeb464627dcb", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "c8e2c16e558f84757b5e6df95c042ef6238c16b7", "chunk": "diff --git a/Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java b/Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java\nindex b5164da70..b705a9f14 100644\n--- a/Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java\n+++ b/Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java\n\n@@ -228,7 +228,7 @@ public class MetadataValidationService {\n         String metadataLanguage = user != null ? user.getMetadataLanguage()\n                 : Helper.getRequestParameter(\"Accept-Language\");\n         return LanguageRange\n-                .parse(Objects.nonNull(metadataLanguage) && !metadataLanguage.isEmpty() ? metadataLanguage : \"en\");\n+                .parse(StringUtils.isBlank(metadataLanguage) ? metadataLanguage : \"en\");\n     }\n \n     private Map<String, String> getTranslations() {\n"}}, {"oid": "c8e2c16e558f84757b5e6df95c042ef6238c16b7", "url": "https://github.com/kitodo/kitodo-production/commit/c8e2c16e558f84757b5e6df95c042ef6238c16b7", "message": "Update Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java\n\nCo-authored-by: Kathrin Huber <kathrin.huber@slub-dresden.de>", "committedDate": "2020-05-08T08:25:45Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjAxNzA5Mg==", "url": "https://github.com/kitodo/kitodo-production/pull/3596#discussion_r422017092", "bodyText": "Should `StringUtils.isBlank\" call not inverted or the values switched?", "author": "henning-gerhardt", "createdAt": "2020-05-08T08:29:45Z", "path": "Kitodo/src/main/java/org/kitodo/production/services/validation/MetadataValidationService.java", "diffHunk": "@@ -228,7 +228,7 @@ private ValidationResult checkTheIdentifier(Workpiece workpiece) throws DAOExcep\n         String metadataLanguage = user != null ? user.getMetadataLanguage()\n                 : Helper.getRequestParameter(\"Accept-Language\");\n         return LanguageRange\n-                .parse(Objects.nonNull(metadataLanguage) && !metadataLanguage.isEmpty() ? metadataLanguage : \"en\");\n+                .parse(StringUtils.isBlank(metadataLanguage) ? metadataLanguage : \"en\");", "originalCommit": "c8e2c16e558f84757b5e6df95c042ef6238c16b7", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjA0MDkyNg==", "url": "https://github.com/kitodo/kitodo-production/pull/3596#discussion_r422040926", "bodyText": "StringUtils isn't even imported, is it? \ud83d\ude27\nMetadataValidationService.java:[231,36] cannot find symbol", "author": "solth", "createdAt": "2020-05-08T09:23:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjAxNzA5Mg=="}], "type": "inlineReview", "revised_code": null}]}