{"pr_number": 3679, "pr_title": "Delay selecting current task until creating a correction comment", "pr_createdAt": "2020-05-20T14:31:51Z", "pr_url": "https://github.com/kitodo/kitodo-production/pull/3679", "timeline": [{"oid": "af1f605994b9b87f16910b9fc2d07e9bbfc4b723", "url": "https://github.com/kitodo/kitodo-production/commit/af1f605994b9b87f16910b9fc2d07e9bbfc4b723", "message": "Delay selecting current task until creating a correction comment", "committedDate": "2020-05-20T14:23:39Z", "type": "commit"}, {"oid": "deec2ddff6ae124b70d3e171b20d00c6b08e87ea", "url": "https://github.com/kitodo/kitodo-production/commit/deec2ddff6ae124b70d3e171b20d00c6b08e87ea", "message": "Fix indentation level", "committedDate": "2020-05-20T14:36:56Z", "type": "commit"}, {"oid": "5b4e63d4a756a4c13e98e1d1968813cc86fc5ee2", "url": "https://github.com/kitodo/kitodo-production/commit/5b4e63d4a756a4c13e98e1d1968813cc86fc5ee2", "message": "Remove redundant 'edit metadata' message from metadata header", "committedDate": "2020-05-25T12:24:58Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxNTgxMg==", "url": "https://github.com/kitodo/kitodo-production/pull/3679#discussion_r429915812", "bodyText": "There is no tooltip, when it's the first task", "author": "Kathrin-Huber", "createdAt": "2020-05-25T12:45:07Z", "path": "Kitodo/src/main/java/org/kitodo/production/forms/CommentForm.java", "diffHunk": "@@ -309,7 +328,7 @@ public boolean isConcurrentTaskInWork() {\n      * @return concurrent task in work tooltip\n      */\n     public String getConcurrentTaskInWorkTooltip() {\n-        List<Task> concurrentTasks = getConcurrentTasksInWork();\n+        List<Task> concurrentTasks = TaskService.getListOfConcurrentTasksInWork(this.process, this.currentTask);", "originalCommit": "5b4e63d4a756a4c13e98e1d1968813cc86fc5ee2", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkyMjIwNA==", "url": "https://github.com/kitodo/kitodo-production/pull/3679#discussion_r429922204", "bodyText": "Furthermore the tooltipe is \"parallelTaskInWork\" even if there is only one task,  but assigned to a different user. Not a dealbreaker, but maybe confusing.", "author": "Kathrin-Huber", "createdAt": "2020-05-25T13:00:10Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTkxNTgxMg=="}], "type": "inlineReview", "revised_code": {"commit": "a2cf94ba25b4754d848588e86a985504cb597da2", "chunk": "diff --git a/Kitodo/src/main/java/org/kitodo/production/forms/CommentForm.java b/Kitodo/src/main/java/org/kitodo/production/forms/CommentForm.java\nindex fde7d27eb..1c253c4ba 100644\n--- a/Kitodo/src/main/java/org/kitodo/production/forms/CommentForm.java\n+++ b/Kitodo/src/main/java/org/kitodo/production/forms/CommentForm.java\n\n@@ -319,22 +318,17 @@ public class CommentForm extends BaseForm {\n      * @return whether there are concurrent tasks in work or not\n      */\n     public boolean isConcurrentTaskInWork() {\n-        return !TaskService.getListOfConcurrentTasksInWork(this.process, this.currentTask).isEmpty();\n+        return !TaskService.getTasksInWorkByOtherUsers(\n+                TaskService.getConcurrentTasksOpenOrInWork(this.process, this.currentTask)).isEmpty();\n     }\n \n     /**\n-     * Create a tooltip explaining that there are concurrent tasks to the current task.\n+     * Create and return a tooltip for the correction message switch.\n      *\n-     * @return concurrent task in work tooltip\n+     * @return tooltip for correction message switch\n      */\n-    public String getConcurrentTaskInWorkTooltip() {\n-        List<Task> concurrentTasks = TaskService.getListOfConcurrentTasksInWork(this.process, this.currentTask);\n-        if (concurrentTasks.isEmpty()) {\n-            return \"\";\n-        } else {\n-            return MessageFormat.format(Helper.getTranslation(\"dataEditor.comment.parallelTaskInWorkText\"),\n-                    concurrentTasks.get(0).getTitle(), concurrentTasks.get(0).getProcessingUser().getFullName());\n-        }\n+    public String getCorrectionMessageSwitchTooltip() {\n+        return TaskService.getCorrectionMessageSwitchTooltip(this.process, this.currentTask);\n     }\n \n     /**\n"}}, {"oid": "a2cf94ba25b4754d848588e86a985504cb597da2", "url": "https://github.com/kitodo/kitodo-production/commit/a2cf94ba25b4754d848588e86a985504cb597da2", "message": "Refactor tooltip creation and add tooltip for first task in workflow", "committedDate": "2020-05-25T21:25:07Z", "type": "commit"}]}