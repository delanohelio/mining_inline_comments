{"pr_number": 3064, "pr_title": "fix condition", "pr_createdAt": "2020-01-17T13:29:31Z", "pr_url": "https://github.com/kitodo/kitodo-production/pull/3064", "timeline": [{"oid": "41c1c8056f740d5f91206ad160147e7a1510c328", "url": "https://github.com/kitodo/kitodo-production/commit/41c1c8056f740d5f91206ad160147e7a1510c328", "message": "fix condition", "committedDate": "2020-01-17T13:28:24Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODQ4ODk0MA==", "url": "https://github.com/kitodo/kitodo-production/pull/3064#discussion_r368488940", "bodyText": "You also have to replace anyMatch with allMatch here, otherwise there is only a validator error if none of the media are in the physical structure tree. However, there should already be an error message if only one is not in the physical tree.", "author": "matthias-ronge", "createdAt": "2020-01-20T11:02:34Z", "path": "Kitodo-Validation/src/main/java/org/kitodo/validation/metadata/MetadataValidation.java", "diffHunk": "@@ -179,7 +179,7 @@ private static ValidationResult checkForStructuresWithoutMedia(Workpiece workpie\n             warning = true;\n         }\n \n-        if (treeStream(workpiece.getRootElement(), IncludedStructuralElement::getChildren)\n+        if (!treeStream(workpiece.getRootElement(), IncludedStructuralElement::getChildren)\n                 .flatMap(structure -> structure.getViews().stream()).map(View::getMediaUnit)\n                 .anyMatch(workpiece.getMediaUnits()::contains)) {", "originalCommit": "41c1c8056f740d5f91206ad160147e7a1510c328", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "b46f975f2808f59c912f4e9641562b2633817e89", "chunk": "diff --git a/Kitodo-Validation/src/main/java/org/kitodo/validation/metadata/MetadataValidation.java b/Kitodo-Validation/src/main/java/org/kitodo/validation/metadata/MetadataValidation.java\nindex 80608e2fc..cdecdbeb5 100644\n--- a/Kitodo-Validation/src/main/java/org/kitodo/validation/metadata/MetadataValidation.java\n+++ b/Kitodo-Validation/src/main/java/org/kitodo/validation/metadata/MetadataValidation.java\n\n@@ -181,7 +181,7 @@ public class MetadataValidation implements MetadataValidationInterface {\n \n         if (!treeStream(workpiece.getRootElement(), IncludedStructuralElement::getChildren)\n                 .flatMap(structure -> structure.getViews().stream()).map(View::getMediaUnit)\n-                .anyMatch(workpiece.getMediaUnits()::contains)) {\n+                .allMatch(workpiece.getMediaUnits()::contains)) {\n             messages.add(translations.get(MESSAGE_MEDIA_MISSING));\n             error = true;\n         }\n"}}, {"oid": "b46f975f2808f59c912f4e9641562b2633817e89", "url": "https://github.com/kitodo/kitodo-production/commit/b46f975f2808f59c912f4e9641562b2633817e89", "message": "use allMatch", "committedDate": "2020-01-21T09:58:38Z", "type": "commit"}]}