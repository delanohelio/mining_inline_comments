{"pr_number": 3454, "pr_title": "redirect after massimport", "pr_createdAt": "2020-04-15T20:37:09Z", "pr_url": "https://github.com/kitodo/kitodo-production/pull/3454", "timeline": [{"oid": "746bc708f8b439f4023c0f0b25944f6738e3b1c2", "url": "https://github.com/kitodo/kitodo-production/commit/746bc708f8b439f4023c0f0b25944f6738e3b1c2", "message": "redirect after massimport", "committedDate": "2020-04-15T20:36:37Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM0MDY4OQ==", "url": "https://github.com/kitodo/kitodo-production/pull/3454#discussion_r409340689", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                private final String processListPath = \"/pages/processes.jsf?faces-redirect=true\";\n          \n          \n            \n                private static final String PROCESS_LIST_PATH = \"/pages/processes.jsf?faces-redirect=true\";", "author": "oliver-stoehr", "createdAt": "2020-04-16T07:31:34Z", "path": "Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java", "diffHunk": "@@ -39,6 +40,8 @@\n     private String ppnString;\n     private MassImportService massImportService = ServiceManager.getMassImportService();\n \n+    private final String processListPath = \"/pages/processes.jsf?faces-redirect=true\";", "originalCommit": "746bc708f8b439f4023c0f0b25944f6738e3b1c2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "12da18ee79046b03057a7845ccf6c0be04027017", "chunk": "diff --git a/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java b/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\nindex fa1222fcf..1204fff09 100644\n--- a/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\n+++ b/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\n\n@@ -40,7 +40,7 @@ public class MassImportForm extends BaseForm {\n     private String ppnString;\n     private MassImportService massImportService = ServiceManager.getMassImportService();\n \n-    private final String processListPath = \"/pages/processes.jsf?faces-redirect=true\";\n+    private static final String PROCESS_LIST_PATH = \"/pages/processes.jsf?faces-redirect=true\";\n \n     public void prepareMassImport(int templateId, int projectId) {\n         this.projectId = projectId;\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM0NDczMg==", "url": "https://github.com/kitodo/kitodo-production/pull/3454#discussion_r409344732", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        String path = context.getExternalContext().getRequestContextPath() + processListPath;\n          \n          \n            \n                        String path = context.getExternalContext().getRequestContextPath() + PROCESS_LIST_PATH;", "author": "oliver-stoehr", "createdAt": "2020-04-16T07:38:48Z", "path": "Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java", "diffHunk": "@@ -54,6 +57,9 @@ public void handleFileUpload(FileUploadEvent event) {\n         UploadedFile file = event.getFile();\n         try {\n             massImportService.importFromCSV(selectedCatalog, file, projectId, templateId);\n+            FacesContext context = FacesContext.getCurrentInstance();\n+            String path = context.getExternalContext().getRequestContextPath() + processListPath;", "originalCommit": "746bc708f8b439f4023c0f0b25944f6738e3b1c2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "12da18ee79046b03057a7845ccf6c0be04027017", "chunk": "diff --git a/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java b/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\nindex fa1222fcf..1204fff09 100644\n--- a/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\n+++ b/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\n\n@@ -58,7 +58,7 @@ public class MassImportForm extends BaseForm {\n         try {\n             massImportService.importFromCSV(selectedCatalog, file, projectId, templateId);\n             FacesContext context = FacesContext.getCurrentInstance();\n-            String path = context.getExternalContext().getRequestContextPath() + processListPath;\n+            String path = context.getExternalContext().getRequestContextPath() + PROCESS_LIST_PATH;\n             context.getExternalContext().redirect(path);\n         } catch (IOException e) {\n             Helper.setErrorMessage(Helper.getTranslation(\"errorReading\", file.getFileName()));\n"}}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTM0NDk2NQ==", "url": "https://github.com/kitodo/kitodo-production/pull/3454#discussion_r409344965", "bodyText": "Suggested change\n        \n          \n    \n\n        \n      \n    \n    \n      \n          \n            \n                        return processListPath;\n          \n          \n            \n                        return PROCESS_LIST_PATH;", "author": "oliver-stoehr", "createdAt": "2020-04-16T07:39:10Z", "path": "Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java", "diffHunk": "@@ -64,12 +70,14 @@ public void handleFileUpload(FileUploadEvent event) {\n     /**\n      * Import processes from textField.\n      */\n-    public void importFromText() {\n+    public String importFromText() {\n         try {\n             massImportService.importFromText(selectedCatalog, ppnString, projectId, templateId);\n+            return processListPath;", "originalCommit": "746bc708f8b439f4023c0f0b25944f6738e3b1c2", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": {"commit": "12da18ee79046b03057a7845ccf6c0be04027017", "chunk": "diff --git a/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java b/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\nindex fa1222fcf..1204fff09 100644\n--- a/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\n+++ b/Kitodo/src/main/java/org/kitodo/production/forms/MassImportForm.java\n\n@@ -73,7 +73,7 @@ public class MassImportForm extends BaseForm {\n     public String importFromText() {\n         try {\n             massImportService.importFromText(selectedCatalog, ppnString, projectId, templateId);\n-            return processListPath;\n+            return PROCESS_LIST_PATH;\n         } catch (ImportException e) {\n             Helper.setErrorMessage(e.getLocalizedMessage(), logger, e);\n         }\n"}}, {"oid": "12da18ee79046b03057a7845ccf6c0be04027017", "url": "https://github.com/kitodo/kitodo-production/commit/12da18ee79046b03057a7845ccf6c0be04027017", "message": "Apply suggestions from code review\n\nCo-Authored-By: Oliver St\u00f6hr <32509444+oliver-stoehr@users.noreply.github.com>", "committedDate": "2020-04-16T10:45:52Z", "type": "commit"}]}