{"pr_number": 12467, "pr_title": "Log Some Job Failure Stacktraces with sampling logger", "pr_createdAt": "2020-11-06T00:09:29Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/12467", "timeline": [{"oid": "bccda9a36c0e95fed996d74f8d6c60958450543b", "url": "https://github.com/Alluxio/alluxio/commit/bccda9a36c0e95fed996d74f8d6c60958450543b", "message": "Sample stacktrace logs", "committedDate": "2020-11-10T23:01:30Z", "type": "commit"}, {"oid": "bccda9a36c0e95fed996d74f8d6c60958450543b", "url": "https://github.com/Alluxio/alluxio/commit/bccda9a36c0e95fed996d74f8d6c60958450543b", "message": "Sample stacktrace logs", "committedDate": "2020-11-10T23:01:30Z", "type": "forcePushed"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk2NjEwMg==", "url": "https://github.com/Alluxio/alluxio/pull/12467#discussion_r520966102", "bodyText": "I think this message should have taskId and jobId, so we know what the stack is for?\nSomething like:\nSAMPLING_LOGGER.info(\"Stack trace for taskId: {} jobId: {} : {}\", taskId, jobId, Throwables.getStackTraceAsString(t));```", "author": "gpang", "createdAt": "2020-11-11T00:45:49Z", "path": "job/server/src/main/java/alluxio/worker/job/task/TaskExecutorManager.java", "diffHunk": "@@ -201,6 +203,7 @@ public synchronized void notifyTaskFailure(long jobId, long taskId, Throwable t)\n     }\n     finishTask(id);\n     LOG.info(\"Task {} for job {} failed: {}\", taskId, jobId, errorMessage);\n+    SAMPLING_LOGGER.info(Throwables.getStackTraceAsString(t));", "originalCommit": "bccda9a36c0e95fed996d74f8d6c60958450543b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMTUxNDM4Mg==", "url": "https://github.com/Alluxio/alluxio/pull/12467#discussion_r521514382", "bodyText": "Thanks. Done.", "author": "bradyoo", "createdAt": "2020-11-11T17:19:20Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMDk2NjEwMg=="}], "type": "inlineReview", "revised_code": {"commit": "e219a8410837255a826df62530c5fbcf3ba57610", "chunk": "diff --git a/job/server/src/main/java/alluxio/worker/job/task/TaskExecutorManager.java b/job/server/src/main/java/alluxio/worker/job/task/TaskExecutorManager.java\nindex 984a206951..97e1f7ce15 100644\n--- a/job/server/src/main/java/alluxio/worker/job/task/TaskExecutorManager.java\n+++ b/job/server/src/main/java/alluxio/worker/job/task/TaskExecutorManager.java\n\n@@ -203,7 +203,8 @@ public class TaskExecutorManager {\n     }\n     finishTask(id);\n     LOG.info(\"Task {} for job {} failed: {}\", taskId, jobId, errorMessage);\n-    SAMPLING_LOGGER.info(Throwables.getStackTraceAsString(t));\n+    SAMPLING_LOGGER.info(\"Stack trace for taskId: {} jobId: {} : {}\", taskId, jobId,\n+        Throwables.getStackTraceAsString(t));\n   }\n \n   /**\n"}}, {"oid": "e219a8410837255a826df62530c5fbcf3ba57610", "url": "https://github.com/Alluxio/alluxio/commit/e219a8410837255a826df62530c5fbcf3ba57610", "message": "feedback", "committedDate": "2020-11-11T17:19:01Z", "type": "commit"}]}