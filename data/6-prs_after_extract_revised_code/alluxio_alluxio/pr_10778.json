{"pr_number": 10778, "pr_title": "Add relogin on connect", "pr_createdAt": "2020-01-22T00:49:13Z", "pr_url": "https://github.com/Alluxio/alluxio/pull/10778", "timeline": [{"oid": "60e0eeb648a06b14695dda4accd463beedc4d4e0", "url": "https://github.com/Alluxio/alluxio/commit/60e0eeb648a06b14695dda4accd463beedc4d4e0", "message": "Add relogin on connect", "committedDate": "2020-01-22T00:46:31Z", "type": "commit"}, {"oid": "56670bb1bbf5fd4c9ab8eb5cc8fafd94be378d3b", "url": "https://github.com/Alluxio/alluxio/commit/56670bb1bbf5fd4c9ab8eb5cc8fafd94be378d3b", "message": "Mock UserState to pass test", "committedDate": "2020-01-23T21:26:53Z", "type": "commit"}, {"oid": "3c830acc9e4de479e77728d49b465ffe031dc055", "url": "https://github.com/Alluxio/alluxio/commit/3c830acc9e4de479e77728d49b465ffe031dc055", "message": "Add import and remove fully qualified class name", "committedDate": "2020-01-23T21:29:40Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2OTE1Mg==", "url": "https://github.com/Alluxio/alluxio/pull/10778#discussion_r370369152", "bodyText": "Can you put this to beforeConnect() ?", "author": "ggezer", "createdAt": "2020-01-23T21:39:53Z", "path": "core/common/src/main/java/alluxio/AbstractClient.java", "diffHunk": "@@ -199,6 +199,7 @@ public synchronized void connect() throws AlluxioStatusException {\n     disconnect();\n     Preconditions.checkState(!mClosed, \"Client is closed, will not try to connect.\");\n \n+    mContext.getUserState().relogin();", "originalCommit": "3c830acc9e4de479e77728d49b465ffe031dc055", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM3NzU1OQ==", "url": "https://github.com/Alluxio/alluxio/pull/10778#discussion_r370377559", "bodyText": "beforeConnect() would be too late. The relogin() must happen before getAddress() which is called in the try block before the beforeConnect().", "author": "ns1123", "createdAt": "2020-01-23T21:59:55Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDM2OTE1Mg=="}], "type": "inlineReview", "revised_code": null}]}