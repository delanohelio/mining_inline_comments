{"pr_number": 18922, "pr_title": "#18901 save point", "pr_createdAt": "2020-07-20T21:49:44Z", "pr_url": "https://github.com/dotCMS/core/pull/18922", "timeline": [{"oid": "0219f99b0d9d3c0225ce545c40f11b4ca656c5aa", "url": "https://github.com/dotCMS/core/commit/0219f99b0d9d3c0225ce545c40f11b4ca656c5aa", "message": "#18901 save point", "committedDate": "2020-07-20T21:49:00Z", "type": "commit"}, {"oid": "971fcdfc90db9ee3f0992eb1f0254d88192b35d8", "url": "https://github.com/dotCMS/core/commit/971fcdfc90db9ee3f0992eb1f0254d88192b35d8", "message": "#18901 serialization  testcase", "committedDate": "2020-07-21T03:21:15Z", "type": "commit"}, {"oid": "80ac0ac7f4ced1d05b565d9739085b205550592c", "url": "https://github.com/dotCMS/core/commit/80ac0ac7f4ced1d05b565d9739085b205550592c", "message": "Merge branch 'master' into issue-18901-testcase", "committedDate": "2020-07-21T03:27:31Z", "type": "commit"}, {"oid": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "url": "https://github.com/dotCMS/core/commit/e77ff825d34117eb3059d4e5c348908e1c81bcb8", "message": "#18901 doc test", "committedDate": "2020-07-21T04:15:34Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQwOQ==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827409", "bodyText": "Codacy found an issue: A method/constructor should not explicitly throw java.lang.Exception", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:12Z", "path": "dotCMS/src/integration-test/java/com/dotcms/datagen/TestDataUtils.java", "diffHunk": "@@ -948,25 +942,44 @@ public static Contentlet getFileAssetContent(Boolean persist, long languageId) {\n \n             //Test file\n             final String testImagePath = \"com/dotmarketing/portlets/contentlet/business/test_files/test_image1.jpg\";\n-            final File originalTestImage = new File(\n-                    ConfigTestHelper.getUrlToTestResource(testImagePath).toURI());\n-            final File testImage = new File(Files.createTempDir(),\n-                    \"test_image1\" + System.currentTimeMillis() + \".jpg\");\n-            FileUtil.copyFile(originalTestImage, testImage);\n+            return createFileAsset(testImagePath, folder, languageId, persist);\n+        } catch (Exception e) {\n+            throw new DotRuntimeException(e);\n+        }\n+    }\n \n-            ContentletDataGen fileAssetDataGen = new FileAssetDataGen(folder, testImage)\n-                    .languageId(languageId);\n+    public static Contentlet getFileAssetSVGContent(Boolean persist, long languageId) {\n \n-            if (persist) {\n-                return ContentletDataGen.publish(fileAssetDataGen.nextPersisted());\n-            } else {\n-                return fileAssetDataGen.next();\n-            }\n+        try {\n+            final Folder folder = new FolderDataGen().nextPersisted();\n+\n+            //Test file\n+            final String testImagePath = \"com/dotmarketing/portlets/contentlet/business/test_files/test_image.svg\";\n+            return createFileAsset(testImagePath, folder, languageId, persist);\n         } catch (Exception e) {\n             throw new DotRuntimeException(e);\n         }\n     }\n \n+    private static Contentlet createFileAsset(final String testImagePath, final Folder folder, final long languageId, final boolean persist) throws Exception{", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQxNA==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827414", "bodyText": "Codacy found an issue: A method/constructor should not explicitly throw java.lang.Exception", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:13Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQxOQ==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827419", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:14Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQyMw==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827423", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:15Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQyNQ==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827425", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:16Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);\n+        Assert.assertEquals(height, height2);\n+    };\n+\n+    private static final AssertionStrategy pageValidation = (original, copy) -> {\n+        final HTMLPageAsset htmlPageAsset1 = (HTMLPageAsset) original;\n+        final HTMLPageAsset htmlPageAsset2 = (HTMLPageAsset) copy;\n+        Assert.assertEquals(htmlPageAsset1.getPageUrl(),htmlPageAsset2.getPageUrl());\n+        Assert.assertEquals(htmlPageAsset1.getRedirect(),htmlPageAsset2.getRedirect());\n+        Assert.assertEquals(htmlPageAsset1.getURI(),htmlPageAsset2.getURI());", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQyOQ==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827429", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:17Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);\n+        Assert.assertEquals(height, height2);\n+    };\n+\n+    private static final AssertionStrategy pageValidation = (original, copy) -> {\n+        final HTMLPageAsset htmlPageAsset1 = (HTMLPageAsset) original;\n+        final HTMLPageAsset htmlPageAsset2 = (HTMLPageAsset) copy;\n+        Assert.assertEquals(htmlPageAsset1.getPageUrl(),htmlPageAsset2.getPageUrl());\n+        Assert.assertEquals(htmlPageAsset1.getRedirect(),htmlPageAsset2.getRedirect());", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQzNw==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827437", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:18Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);\n+        Assert.assertEquals(height, height2);", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQ0Nw==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827447", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:19Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQ1NQ==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827455", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:19Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);\n+        Assert.assertEquals(height, height2);\n+    };\n+\n+    private static final AssertionStrategy pageValidation = (original, copy) -> {\n+        final HTMLPageAsset htmlPageAsset1 = (HTMLPageAsset) original;\n+        final HTMLPageAsset htmlPageAsset2 = (HTMLPageAsset) copy;\n+        Assert.assertEquals(htmlPageAsset1.getPageUrl(),htmlPageAsset2.getPageUrl());\n+        Assert.assertEquals(htmlPageAsset1.getRedirect(),htmlPageAsset2.getRedirect());\n+        Assert.assertEquals(htmlPageAsset1.getURI(),htmlPageAsset2.getURI());\n+    };\n+\n+\n+    /**\n+     * This will serialize a contentlet to disk\n+     * @param contentlet\n+     * @param file\n+     * @throws IOException\n+     */\n+    private void serializeContentlet(final Contentlet contentlet, final File file)\n+            throws IOException {\n+\n+        try (FileOutputStream fileOutputStream = new FileOutputStream(file)) {", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODM1ODgxMw==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r458358813", "bodyText": "Agree with Codacy!", "author": "wezell", "createdAt": "2020-07-21T20:11:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQ1NQ=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQ2NQ==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827465", "bodyText": "Codacy found an issue: Unnecessary use of fully qualified name 'Assert.assertEquals' due to existing static import 'org.junit.Assert.assertEquals'", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:20Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);\n+        Assert.assertEquals(height, height2);\n+    };\n+\n+    private static final AssertionStrategy pageValidation = (original, copy) -> {\n+        final HTMLPageAsset htmlPageAsset1 = (HTMLPageAsset) original;\n+        final HTMLPageAsset htmlPageAsset2 = (HTMLPageAsset) copy;\n+        Assert.assertEquals(htmlPageAsset1.getPageUrl(),htmlPageAsset2.getPageUrl());", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NzgyNzQ2Nw==", "url": "https://github.com/dotCMS/core/pull/18922#discussion_r457827467", "bodyText": "Codacy found an issue: Avoid instantiating FileInputStream, FileOutputStream, FileReader, or FileWriter", "author": "dev-dotcms", "createdAt": "2020-07-21T04:22:21Z", "path": "dotCMS/src/integration-test/java/com/dotmarketing/portlets/contentlet/transform/ContentletTransformerTest.java", "diffHunk": "@@ -604,5 +622,128 @@ public String getUrl(Contentlet contentlet) {\n \n     }\n \n+    /**\n+     * Given Scenario: This takes samples of content transforms the original then serialize it the recovers the serialized content and transforms the result then compares the two contentlet\n+     * Expected Result: Both results must match\n+     * @param serializationTestCase\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     * @throws DotDataException\n+     */\n+    @Test\n+    @UseDataProvider(\"listSerializeTestCases\")\n+    public void Test_Serialize_Contentlet_Then_Recover_Then_Transform(final SerializationTestCase serializationTestCase)\n+            throws IOException, ClassNotFoundException, DotDataException {\n+\n+        final File file = new File(directory,String.format(\"%s.serialized\",System.currentTimeMillis()));\n+        file.createNewFile();\n+\n+        final Contentlet original = serializationTestCase.contentlet;\n+        serializeContentlet(serializationTestCase.contentlet, file);\n+        final Contentlet copy = readSerializedContentlet(file);\n+        validateTransformation(original, copy);\n+        final AssertionStrategy assertionStrategy = serializationTestCase.assertionStrategy;\n+        if(null != assertionStrategy) {\n+            assertionStrategy.apply(original, copy);\n+        }\n+    }\n+\n+    private static class SerializationTestCase {\n+\n+        final Contentlet contentlet;\n+        final AssertionStrategy assertionStrategy;\n+\n+        SerializationTestCase(final Contentlet contentlet,\n+                final AssertionStrategy assertionStrategy) {\n+            this.contentlet = contentlet;\n+            this.assertionStrategy = assertionStrategy;\n+        }\n+    }\n+\n+    @DataProvider\n+    public static Object[] listSerializeTestCases() throws Exception {\n+\n+        final FileAssetAPI assetAPI = APILocator.getFileAssetAPI();\n+        final HTMLPageAssetAPI pageAssetAPI = APILocator.getHTMLPageAssetAPI();\n+\n+        return new Object[]{\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetSVGContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getFileAssetContent(true, langId);\n+                    return assetAPI.fromContentlet(contentlet);\n+                }).get(), fileAssetValidation),\n+                new SerializationTestCase(((Supplier<Contentlet>) () -> {\n+                    final Contentlet contentlet = TestDataUtils.getPageContent(true, langId);\n+                    return pageAssetAPI.fromContentlet(contentlet);\n+                }).get(), pageValidation),\n+                new SerializationTestCase(TestDataUtils.getDotAssetLikeContentlet(), null),\n+                new SerializationTestCase(TestDataUtils.getBlogContent(true, langId), null)\n+        };\n+    }\n+\n+    private void validateTransformation(final Contentlet original, final Contentlet copy){\n+        final DotContentletTransformer transformer1 = new DotTransformerBuilder().defaultOptions().content(original).build();\n+        final Map<String, Object> preSerializationMap = transformer1.toMaps().get(0);\n+\n+        final DotContentletTransformer transformer2 = new DotTransformerBuilder().defaultOptions().content(copy).build();\n+        final Map<String, Object> postSerializationMap = transformer2.toMaps().get(0);\n+        Assert.assertEquals(preSerializationMap, postSerializationMap);\n+\n+        Assert.assertEquals(transformer1.hydrate().get(0), transformer2.hydrate().get(0));\n+    }\n+\n+    private static final AssertionStrategy fileAssetValidation = (original, copy) -> {\n+        final FileAsset fileAsset1 = (FileAsset) original;\n+        final int width = fileAsset1.getWidth();\n+        final int height = fileAsset1.getHeight();\n+        final FileAsset fileAsset2 = (FileAsset) copy;\n+        final int width2 = fileAsset2.getWidth();\n+        final int height2 = fileAsset2.getHeight();\n+        Assert.assertEquals(width, width2);\n+        Assert.assertEquals(height, height2);\n+    };\n+\n+    private static final AssertionStrategy pageValidation = (original, copy) -> {\n+        final HTMLPageAsset htmlPageAsset1 = (HTMLPageAsset) original;\n+        final HTMLPageAsset htmlPageAsset2 = (HTMLPageAsset) copy;\n+        Assert.assertEquals(htmlPageAsset1.getPageUrl(),htmlPageAsset2.getPageUrl());\n+        Assert.assertEquals(htmlPageAsset1.getRedirect(),htmlPageAsset2.getRedirect());\n+        Assert.assertEquals(htmlPageAsset1.getURI(),htmlPageAsset2.getURI());\n+    };\n+\n+\n+    /**\n+     * This will serialize a contentlet to disk\n+     * @param contentlet\n+     * @param file\n+     * @throws IOException\n+     */\n+    private void serializeContentlet(final Contentlet contentlet, final File file)\n+            throws IOException {\n+\n+        try (FileOutputStream fileOutputStream = new FileOutputStream(file)) {\n+            try (ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream)) {\n+                objectOutputStream.writeObject(contentlet);\n+            }\n+        }\n+    }\n+\n+    /**\n+     * This will deserialize a contentlet from disk\n+     * @param file\n+     * @return\n+     * @throws IOException\n+     * @throws ClassNotFoundException\n+     */\n+    private Contentlet readSerializedContentlet(final File file) throws IOException, ClassNotFoundException{\n+        try(FileInputStream fileInputStream = new FileInputStream(file)){", "originalCommit": "e77ff825d34117eb3059d4e5c348908e1c81bcb8", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}