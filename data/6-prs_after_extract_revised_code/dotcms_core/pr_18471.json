{"pr_number": 18471, "pr_title": "#18316 Removing duplicates from query", "pr_createdAt": "2020-05-11T21:36:36Z", "pr_url": "https://github.com/dotCMS/core/pull/18471", "timeline": [{"oid": "613d07424cc53380bd51cd8c73822f08b694f84b", "url": "https://github.com/dotCMS/core/commit/613d07424cc53380bd51cd8c73822f08b694f84b", "message": "#18316 Removing duplicates from query", "committedDate": "2020-05-11T21:28:44Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc5NTczOA==", "url": "https://github.com/dotCMS/core/pull/18471#discussion_r423795738", "bodyText": "all the 'searchContentletsByUser' method code should go into a API", "author": "freddyucv", "createdAt": "2020-05-12T14:49:16Z", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/ajax/ContentletAjax.java", "diffHunk": "@@ -892,10 +895,12 @@ else if( fieldbcontentname.startsWith(\"date\") ){\n \t\t\t\t\t\t\t        if(\"catchall\".equals(fieldName)) {\r\n \t\t\t\t\t\t\t           \r\n \t\t\t\t\t\t\t            luceneQuery.append(\" title:'\" + fieldValueStr + \"'^15 \");\r\n-\t\t\t\t\t\t\t            for(String x : fieldValueStr.split(\"[,|\\\\s+]\")) {\r\n-\t\t\t\t\t\t\t                luceneQuery.append(\" title:\" + x + \"^5 \");\r\n-\t\t\t\t\t\t\t                \r\n-\t\t\t\t\t\t\t            }\r\n+                                        final String[] titleSplit = fieldValueStr.split(\"[,|\\\\s+]\");\r\n+                                        if (titleSplit.length > 1) {\r\n+                                            for (final String term : titleSplit) {\r\n+                                                luceneQuery.append(\" title:\" + term + \"^5 \");\r\n+                                            }\r\n+                                        }\r", "originalCommit": "613d07424cc53380bd51cd8c73822f08b694f84b", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzNjczMA==", "url": "https://github.com/dotCMS/core/pull/18471#discussion_r428836730", "bodyText": "I agree but the logic on this Ajax is heavy to refactor", "author": "nollymar", "createdAt": "2020-05-21T18:32:04Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc5NTczOA=="}], "type": "inlineReview", "revised_code": null}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzc5NTkxMQ==", "url": "https://github.com/dotCMS/core/pull/18471#discussion_r423795911", "bodyText": "any test?", "author": "freddyucv", "createdAt": "2020-05-12T14:49:29Z", "path": "dotCMS/src/main/java/com/dotmarketing/portlets/contentlet/ajax/ContentletAjax.java", "diffHunk": "@@ -892,10 +895,12 @@ else if( fieldbcontentname.startsWith(\"date\") ){\n \t\t\t\t\t\t\t        if(\"catchall\".equals(fieldName)) {\r\n \t\t\t\t\t\t\t           \r\n \t\t\t\t\t\t\t            luceneQuery.append(\" title:'\" + fieldValueStr + \"'^15 \");\r\n-\t\t\t\t\t\t\t            for(String x : fieldValueStr.split(\"[,|\\\\s+]\")) {\r\n-\t\t\t\t\t\t\t                luceneQuery.append(\" title:\" + x + \"^5 \");\r\n-\t\t\t\t\t\t\t                \r\n-\t\t\t\t\t\t\t            }\r\n+                                        final String[] titleSplit = fieldValueStr.split(\"[,|\\\\s+]\");\r\n+                                        if (titleSplit.length > 1) {\r\n+                                            for (final String term : titleSplit) {\r\n+                                                luceneQuery.append(\" title:\" + term + \"^5 \");\r\n+                                            }\r\n+                                        }\r\n \t\t\t\t\t\t\t            luceneQuery.append(\" title_dotraw:*\" + fieldValueStr + \"*^5 \");\r\n \t\t\t\t\t\t\t        }\r\n \t\t\t\t\t\t\t        \r", "originalCommit": "613d07424cc53380bd51cd8c73822f08b694f84b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}, {"oid": "7de434b39ad662f3cb34e56fd10baba1455a3216", "url": "https://github.com/dotCMS/core/commit/7de434b39ad662f3cb34e56fd10baba1455a3216", "message": "Merge branch 'master' of https://github.com/dotCMS/core into issue-18316-content-search-query-builder-improvements", "committedDate": "2020-05-21T18:07:06Z", "type": "commit"}, {"oid": "9b06126f06568d35233ff55b13e11d74ee45ed14", "url": "https://github.com/dotCMS/core/commit/9b06126f06568d35233ff55b13e11d74ee45ed14", "message": "#18316 Moving logic to filter content types by license level was moved to the ESContentFactoryImpl", "committedDate": "2020-05-21T18:26:37Z", "type": "commit"}, {"oid": "ac7dd762a8759c0bd2c1b669dfdff7967e6ab067", "url": "https://github.com/dotCMS/core/commit/ac7dd762a8759c0bd2c1b669dfdff7967e6ab067", "message": "#18316 Adding ITs", "committedDate": "2020-05-21T19:06:06Z", "type": "commit"}]}