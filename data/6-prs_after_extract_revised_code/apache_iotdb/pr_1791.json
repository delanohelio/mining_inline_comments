{"pr_number": 1791, "pr_title": "[IOTDB-912] Implement wasNull method in AbstractIoTDBJDBCResultSet", "pr_createdAt": "2020-10-02T11:11:52Z", "pr_url": "https://github.com/apache/iotdb/pull/1791", "timeline": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4ODE1Mg==", "url": "https://github.com/apache/iotdb/pull/1791#discussion_r499988152", "bodyText": "Actually, we don't support short type of data yet...", "author": "HTHou", "createdAt": "2020-10-06T03:39:08Z", "path": "service-rpc/src/main/java/org/apache/iotdb/rpc/IoTDBRpcDataSet.java", "diffHunk": "@@ -312,9 +317,23 @@ public float getFloat(String columnName) throws StatementExecutionException {\n     checkRecord();\n     int index = columnOrdinalMap.get(columnName) - START_INDEX;\n     if (!isNull(index, rowsIndex - 1)) {\n+      lastReadWasNull = false;\n       return BytesUtils.bytesToFloat(values[index]);\n     } else {\n-      throw new StatementExecutionException(String.format(VALUE_IS_NULL, columnName));\n+      lastReadWasNull = true;\n+      return 0;\n+    }\n+  }\n+\n+  public short getShort(String columnName) throws StatementExecutionException {\n+    checkRecord();", "originalCommit": "c2c5302bf25fb114b6f9156666d0d0597234a414", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEwNjY5OA==", "url": "https://github.com/apache/iotdb/pull/1791#discussion_r500106698", "bodyText": "I think so, too. I felt weird that why it was implemented before. How about just throwing exception while it has been used?", "author": "jack870131", "createdAt": "2020-10-06T08:44:05Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4ODE1Mg=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDEzMzE1OA==", "url": "https://github.com/apache/iotdb/pull/1791#discussion_r500133158", "bodyText": "Yes, look good to me. \ud83d\udc4d", "author": "HTHou", "createdAt": "2020-10-06T09:26:00Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTk4ODE1Mg=="}], "type": "inlineReview", "revised_code": {"commit": "03e2dcee458b1345cccf53b3d2dd8b000f8b69cf", "chunk": "diff --git a/service-rpc/src/main/java/org/apache/iotdb/rpc/IoTDBRpcDataSet.java b/service-rpc/src/main/java/org/apache/iotdb/rpc/IoTDBRpcDataSet.java\nindex b84231d94..95b91282a 100644\n--- a/service-rpc/src/main/java/org/apache/iotdb/rpc/IoTDBRpcDataSet.java\n+++ b/service-rpc/src/main/java/org/apache/iotdb/rpc/IoTDBRpcDataSet.java\n\n@@ -325,18 +325,6 @@ public class IoTDBRpcDataSet {\n     }\n   }\n \n-  public short getShort(String columnName) throws StatementExecutionException {\n-    checkRecord();\n-    int index = columnOrdinalMap.get(columnName) - START_INDEX;\n-    if (!isNull(index, rowsIndex - 1)) {\n-      lastReadWasNull = false;\n-      return BytesUtils.bytesToShort(values[index]);\n-    } else {\n-      lastReadWasNull = true;\n-      return 0;\n-    }\n-  }\n-\n   public int getInt(int columnIndex) throws StatementExecutionException {\n     return getInt(findColumnNameByIndex(columnIndex));\n   }\n"}}, {"oid": "03e2dcee458b1345cccf53b3d2dd8b000f8b69cf", "url": "https://github.com/apache/iotdb/commit/03e2dcee458b1345cccf53b3d2dd8b000f8b69cf", "message": "[IOTDB-912] Implement wasNull method in AbstractIoTDBJDBCResultSet", "committedDate": "2020-10-06T08:48:59Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgzMzA4MA==", "url": "https://github.com/apache/iotdb/pull/1791#discussion_r500833080", "bodyText": "Maybe throw an exception is better? which can help users find bugs in client", "author": "qiaojialin", "createdAt": "2020-10-07T08:32:31Z", "path": "service-rpc/src/main/java/org/apache/iotdb/rpc/IoTDBRpcDataSet.java", "diffHunk": "@@ -343,9 +352,11 @@ public long getLong(String columnName) throws StatementExecutionException {\n     }\n     int index = columnOrdinalMap.get(columnName) - START_INDEX;\n     if (!isNull(index, rowsIndex - 1)) {\n+      lastReadWasNull = false;\n       return BytesUtils.bytesToLong(values[index]);\n     } else {\n-      throw new StatementExecutionException(String.format(VALUE_IS_NULL, columnName));", "originalCommit": "03e2dcee458b1345cccf53b3d2dd8b000f8b69cf", "replyToReviewId": null, "replies": [{"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMjgwMTUxMA==", "url": "https://github.com/apache/iotdb/pull/1791#discussion_r502801510", "bodyText": "@qiaojialin The reason why I remove the exception here is that it was not consistent with JDBC specification as we discussed in IOTDB-912.", "author": "jack870131", "createdAt": "2020-10-10T15:24:02Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgzMzA4MA=="}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTI1ODUyNQ==", "url": "https://github.com/apache/iotdb/pull/1791#discussion_r509258525", "bodyText": "ok thanks!", "author": "qiaojialin", "createdAt": "2020-10-21T13:03:01Z", "replyToReviewId": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDgzMzA4MA=="}], "type": "inlineReview", "revised_code": null}]}