{"pr_number": 2173, "pr_title": "[To rel/0.11] [Mem control] Move one of the insert check out from the sg lock", "pr_createdAt": "2020-12-03T03:27:10Z", "pr_url": "https://github.com/apache/iotdb/pull/2173", "timeline": [{"oid": "1ce8b79c8a9bd87911245069f6bf90bcf0851aa4", "url": "https://github.com/apache/iotdb/commit/1ce8b79c8a9bd87911245069f6bf90bcf0851aa4", "message": "more one insert check out of the sg lock", "committedDate": "2020-12-03T02:58:52Z", "type": "commit"}, {"oid": "da3547f03a9265a439cfd13dc55e9d680d2be98d", "url": "https://github.com/apache/iotdb/commit/da3547f03a9265a439cfd13dc55e9d680d2be98d", "message": "fix review", "committedDate": "2020-12-03T02:59:07Z", "type": "commit"}, {"oid": "82313f4de915a338a5fecd03a2721f9c8b867d49", "url": "https://github.com/apache/iotdb/commit/82313f4de915a338a5fecd03a2721f9c8b867d49", "message": "fix status code error", "committedDate": "2020-12-03T02:59:22Z", "type": "commit"}, {"oid": "47207858eed34692af39257c5f5000b83fa52252", "url": "https://github.com/apache/iotdb/commit/47207858eed34692af39257c5f5000b83fa52252", "message": "fix error", "committedDate": "2020-12-03T03:17:07Z", "type": "commit"}, {"oid": "59085e0b9f97f75d2f0a21dd26be4cee0f5e8266", "url": "https://github.com/apache/iotdb/commit/59085e0b9f97f75d2f0a21dd26be4cee0f5e8266", "message": "change a config name", "committedDate": "2020-12-03T03:23:33Z", "type": "commit"}, {"oid": "858957e667ffe4a190069960344abbc9b3d57f82", "url": "https://github.com/apache/iotdb/commit/858957e667ffe4a190069960344abbc9b3d57f82", "message": "reduce duplicate lines", "committedDate": "2020-12-03T06:31:24Z", "type": "commit"}, {"oid": "f82a8569054c7ea7ad26a9543a06113451320966", "url": "https://github.com/apache/iotdb/commit/f82a8569054c7ea7ad26a9543a06113451320966", "message": "unify reject error code", "committedDate": "2020-12-03T06:31:50Z", "type": "commit"}, {"oid": "cd2b26307d62178f8c6e120a5df3a984930cc7fe", "url": "https://github.com/apache/iotdb/commit/cd2b26307d62178f8c6e120a5df3a984930cc7fe", "message": "reduce duplicate lines", "committedDate": "2020-12-03T06:32:20Z", "type": "commit"}, {"oid": "d75f3dfc78b089ee3800f01bf63ee0e1e2ec4b0b", "url": "https://github.com/apache/iotdb/commit/d75f3dfc78b089ee3800f01bf63ee0e1e2ec4b0b", "message": "fix code smell", "committedDate": "2020-12-03T07:52:48Z", "type": "commit"}, {"oid": "d6cb4823cca20e415f32cba74459daaa6971bab4", "url": "https://github.com/apache/iotdb/commit/d6cb4823cca20e415f32cba74459daaa6971bab4", "message": "fix review", "committedDate": "2020-12-03T08:05:54Z", "type": "commit"}, {"id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNDg2NjI3Nw==", "url": "https://github.com/apache/iotdb/pull/2173#discussion_r534866277", "bodyText": "add a new ErrorCode", "author": "qiaojialin", "createdAt": "2020-12-03T08:03:52Z", "path": "server/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java", "diffHunk": "@@ -692,6 +696,15 @@ public void insert(InsertRowPlan insertRowPlan) throws WriteProcessException {\n    */\n   @SuppressWarnings(\"squid:S3776\") // Suppress high Cognitive Complexity warning\n   public void insertTablet(InsertTabletPlan insertTabletPlan) throws BatchInsertionException {\n+    if (enableMemControl) {\n+      try {\n+        StorageEngine.blockInsertionIfReject();\n+      } catch (WriteProcessException e) {\n+        TSStatus[] results = new TSStatus[insertTabletPlan.getRowCount()];\n+        Arrays.fill(results, RpcUtils.getStatus(TSStatusCode.INTERNAL_SERVER_ERROR));", "originalCommit": "d75f3dfc78b089ee3800f01bf63ee0e1e2ec4b0b", "replyToReviewId": null, "replies": null, "type": "inlineReview", "revised_code": null}]}